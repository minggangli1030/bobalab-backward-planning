(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Gm={exports:{}},Bl={},Qm={exports:{}},pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wo=Symbol.for("react.element"),r_=Symbol.for("react.portal"),s_=Symbol.for("react.fragment"),i_=Symbol.for("react.strict_mode"),o_=Symbol.for("react.profiler"),a_=Symbol.for("react.provider"),l_=Symbol.for("react.context"),u_=Symbol.for("react.forward_ref"),c_=Symbol.for("react.suspense"),d_=Symbol.for("react.memo"),h_=Symbol.for("react.lazy"),Of=Symbol.iterator;function f_(t){return t===null||typeof t!="object"?null:(t=Of&&t[Of]||t["@@iterator"],typeof t=="function"?t:null)}var Km={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ym=Object.assign,Xm={};function vi(t,e,n){this.props=t,this.context=e,this.refs=Xm,this.updater=n||Km}vi.prototype.isReactComponent={};vi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Jm(){}Jm.prototype=vi.prototype;function Nd(t,e,n){this.props=t,this.context=e,this.refs=Xm,this.updater=n||Km}var jd=Nd.prototype=new Jm;jd.constructor=Nd;Ym(jd,vi.prototype);jd.isPureReactComponent=!0;var Ff=Array.isArray,Zm=Object.prototype.hasOwnProperty,Vd={current:null},eg={key:!0,ref:!0,__self:!0,__source:!0};function tg(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)Zm.call(e,r)&&!eg.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Wo,type:t,key:i,ref:a,props:s,_owner:Vd.current}}function p_(t,e){return{$$typeof:Wo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Md(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wo}function m_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var zf=/\/+/g;function Ru(t,e){return typeof t=="object"&&t!==null&&t.key!=null?m_(""+t.key):e.toString(36)}function Ua(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Wo:case r_:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+Ru(a,0):r,Ff(s)?(n="",t!=null&&(n=t.replace(zf,"$&/")+"/"),Ua(s,e,n,"",function(h){return h})):s!=null&&(Md(s)&&(s=p_(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(zf,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",Ff(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Ru(i,l);a+=Ua(i,e,n,u,s)}else if(u=f_(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Ru(i,l++),a+=Ua(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function wa(t,e,n){if(t==null)return t;var r=[],s=0;return Ua(t,r,"","",function(i){return e.call(n,i,s++)}),r}function g_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Lt={current:null},$a={transition:null},y_={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:$a,ReactCurrentOwner:Vd};function ng(){throw Error("act(...) is not supported in production builds of React.")}pe.Children={map:wa,forEach:function(t,e,n){wa(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return wa(t,function(){e++}),e},toArray:function(t){return wa(t,function(e){return e})||[]},only:function(t){if(!Md(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};pe.Component=vi;pe.Fragment=s_;pe.Profiler=o_;pe.PureComponent=Nd;pe.StrictMode=i_;pe.Suspense=c_;pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=y_;pe.act=ng;pe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Ym({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Vd.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Zm.call(e,u)&&!eg.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:Wo,type:t.type,key:s,ref:i,props:r,_owner:a}};pe.createContext=function(t){return t={$$typeof:l_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:a_,_context:t},t.Consumer=t};pe.createElement=tg;pe.createFactory=function(t){var e=tg.bind(null,t);return e.type=t,e};pe.createRef=function(){return{current:null}};pe.forwardRef=function(t){return{$$typeof:u_,render:t}};pe.isValidElement=Md;pe.lazy=function(t){return{$$typeof:h_,_payload:{_status:-1,_result:t},_init:g_}};pe.memo=function(t,e){return{$$typeof:d_,type:t,compare:e===void 0?null:e}};pe.startTransition=function(t){var e=$a.transition;$a.transition={};try{t()}finally{$a.transition=e}};pe.unstable_act=ng;pe.useCallback=function(t,e){return Lt.current.useCallback(t,e)};pe.useContext=function(t){return Lt.current.useContext(t)};pe.useDebugValue=function(){};pe.useDeferredValue=function(t){return Lt.current.useDeferredValue(t)};pe.useEffect=function(t,e){return Lt.current.useEffect(t,e)};pe.useId=function(){return Lt.current.useId()};pe.useImperativeHandle=function(t,e,n){return Lt.current.useImperativeHandle(t,e,n)};pe.useInsertionEffect=function(t,e){return Lt.current.useInsertionEffect(t,e)};pe.useLayoutEffect=function(t,e){return Lt.current.useLayoutEffect(t,e)};pe.useMemo=function(t,e){return Lt.current.useMemo(t,e)};pe.useReducer=function(t,e,n){return Lt.current.useReducer(t,e,n)};pe.useRef=function(t){return Lt.current.useRef(t)};pe.useState=function(t){return Lt.current.useState(t)};pe.useSyncExternalStore=function(t,e,n){return Lt.current.useSyncExternalStore(t,e,n)};pe.useTransition=function(){return Lt.current.useTransition()};pe.version="18.3.1";Qm.exports=pe;var D=Qm.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v_=D,__=Symbol.for("react.element"),x_=Symbol.for("react.fragment"),w_=Object.prototype.hasOwnProperty,S_=v_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,E_={key:!0,ref:!0,__self:!0,__source:!0};function rg(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)w_.call(e,r)&&!E_.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:__,type:t,key:i,ref:a,props:s,_owner:S_.current}}Bl.Fragment=x_;Bl.jsx=rg;Bl.jsxs=rg;Gm.exports=Bl;var d=Gm.exports,sg={exports:{}},an={},ig={exports:{}},og={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,O){var G=N.length;N.push(O);e:for(;0<G;){var ee=G-1>>>1,te=N[ee];if(0<s(te,O))N[ee]=O,N[G]=te,G=ee;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var O=N[0],G=N.pop();if(G!==O){N[0]=G;e:for(var ee=0,te=N.length,le=te>>>1;ee<le;){var ke=2*(ee+1)-1,we=N[ke],fe=ke+1,de=N[fe];if(0>s(we,G))fe<te&&0>s(de,we)?(N[ee]=de,N[fe]=G,ee=fe):(N[ee]=we,N[ke]=G,ee=ke);else if(fe<te&&0>s(de,G))N[ee]=de,N[fe]=G,ee=fe;else break e}}return O}function s(N,O){var G=N.sortIndex-O.sortIndex;return G!==0?G:N.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],h=[],p=1,g=null,y=3,E=!1,A=!1,P=!1,F=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(N){for(var O=n(h);O!==null;){if(O.callback===null)r(h);else if(O.startTime<=N)r(h),O.sortIndex=O.expirationTime,e(u,O);else break;O=n(h)}}function V(N){if(P=!1,C(N),!A)if(n(u)!==null)A=!0,ie(L);else{var O=n(h);O!==null&&$(V,O.startTime-N)}}function L(N,O){A=!1,P&&(P=!1,I(m),m=-1),E=!0;var G=y;try{for(C(O),g=n(u);g!==null&&(!(g.expirationTime>O)||N&&!k());){var ee=g.callback;if(typeof ee=="function"){g.callback=null,y=g.priorityLevel;var te=ee(g.expirationTime<=O);O=t.unstable_now(),typeof te=="function"?g.callback=te:g===n(u)&&r(u),C(O)}else r(u);g=n(u)}if(g!==null)var le=!0;else{var ke=n(h);ke!==null&&$(V,ke.startTime-O),le=!1}return le}finally{g=null,y=G,E=!1}}var M=!1,v=null,m=-1,x=5,w=-1;function k(){return!(t.unstable_now()-w<x)}function R(){if(v!==null){var N=t.unstable_now();w=N;var O=!0;try{O=v(!0,N)}finally{O?T():(M=!1,v=null)}}else M=!1}var T;if(typeof S=="function")T=function(){S(R)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,re=oe.port2;oe.port1.onmessage=R,T=function(){re.postMessage(null)}}else T=function(){F(R,0)};function ie(N){v=N,M||(M=!0,T())}function $(N,O){m=F(function(){N(t.unstable_now())},O)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){A||E||(A=!0,ie(L))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(N){switch(y){case 1:case 2:case 3:var O=3;break;default:O=y}var G=y;y=O;try{return N()}finally{y=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,O){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var G=y;y=N;try{return O()}finally{y=G}},t.unstable_scheduleCallback=function(N,O,G){var ee=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?ee+G:ee):G=ee,N){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=G+te,N={id:p++,callback:O,priorityLevel:N,startTime:G,expirationTime:te,sortIndex:-1},G>ee?(N.sortIndex=G,e(h,N),n(u)===null&&N===n(h)&&(P?(I(m),m=-1):P=!0,$(V,G-ee))):(N.sortIndex=te,e(u,N),A||E||(A=!0,ie(L))),N},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(N){var O=y;return function(){var G=y;y=O;try{return N.apply(this,arguments)}finally{y=G}}}})(og);ig.exports=og;var T_=ig.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I_=D,on=T_;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ag=new Set,go={};function _s(t,e){si(t,e),si(t+"Capture",e)}function si(t,e){for(go[t]=e,t=0;t<e.length;t++)ag.add(e[t])}var nr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pc=Object.prototype.hasOwnProperty,C_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bf={},Uf={};function A_(t){return pc.call(Uf,t)?!0:pc.call(Bf,t)?!1:C_.test(t)?Uf[t]=!0:(Bf[t]=!0,!1)}function k_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function R_(t,e,n,r){if(e===null||typeof e>"u"||k_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ot(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){wt[t]=new Ot(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];wt[e]=new Ot(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){wt[t]=new Ot(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){wt[t]=new Ot(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){wt[t]=new Ot(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){wt[t]=new Ot(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){wt[t]=new Ot(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){wt[t]=new Ot(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){wt[t]=new Ot(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ld=/[\-:]([a-z])/g;function Od(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ld,Od);wt[e]=new Ot(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ld,Od);wt[e]=new Ot(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ld,Od);wt[e]=new Ot(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){wt[t]=new Ot(t,1,!1,t.toLowerCase(),null,!1,!1)});wt.xlinkHref=new Ot("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){wt[t]=new Ot(t,1,!1,t.toLowerCase(),null,!0,!0)});function Fd(t,e,n,r){var s=wt.hasOwnProperty(e)?wt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(R_(e,n,s,r)&&(n=null),r||s===null?A_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var cr=I_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sa=Symbol.for("react.element"),Fs=Symbol.for("react.portal"),zs=Symbol.for("react.fragment"),zd=Symbol.for("react.strict_mode"),mc=Symbol.for("react.profiler"),lg=Symbol.for("react.provider"),ug=Symbol.for("react.context"),Bd=Symbol.for("react.forward_ref"),gc=Symbol.for("react.suspense"),yc=Symbol.for("react.suspense_list"),Ud=Symbol.for("react.memo"),Er=Symbol.for("react.lazy"),cg=Symbol.for("react.offscreen"),$f=Symbol.iterator;function Fi(t){return t===null||typeof t!="object"?null:(t=$f&&t[$f]||t["@@iterator"],typeof t=="function"?t:null)}var We=Object.assign,Pu;function Qi(t){if(Pu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Pu=e&&e[1]||""}return`
`+Pu+t}var bu=!1;function Du(t,e){if(!t||bu)return"";bu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{bu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Qi(t):""}function P_(t){switch(t.tag){case 5:return Qi(t.type);case 16:return Qi("Lazy");case 13:return Qi("Suspense");case 19:return Qi("SuspenseList");case 0:case 2:case 15:return t=Du(t.type,!1),t;case 11:return t=Du(t.type.render,!1),t;case 1:return t=Du(t.type,!0),t;default:return""}}function vc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zs:return"Fragment";case Fs:return"Portal";case mc:return"Profiler";case zd:return"StrictMode";case gc:return"Suspense";case yc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ug:return(t.displayName||"Context")+".Consumer";case lg:return(t._context.displayName||"Context")+".Provider";case Bd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ud:return e=t.displayName||null,e!==null?e:vc(t.type)||"Memo";case Er:e=t._payload,t=t._init;try{return vc(t(e))}catch{}}return null}function b_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vc(e);case 8:return e===zd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ur(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function dg(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function D_(t){var e=dg(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ea(t){t._valueTracker||(t._valueTracker=D_(t))}function hg(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=dg(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function il(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function _c(t,e){var n=e.checked;return We({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Wf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ur(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function fg(t,e){e=e.checked,e!=null&&Fd(t,"checked",e,!1)}function xc(t,e){fg(t,e);var n=Ur(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?wc(t,e.type,n):e.hasOwnProperty("defaultValue")&&wc(t,e.type,Ur(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Hf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function wc(t,e,n){(e!=="number"||il(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ki=Array.isArray;function Xs(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ur(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Sc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return We({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function qf(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if(Ki(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ur(n)}}function pg(t,e){var n=Ur(e.value),r=Ur(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Gf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function mg(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ec(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?mg(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ta,gg=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ta=Ta||document.createElement("div"),Ta.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ta.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function yo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var no={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},N_=["Webkit","ms","Moz","O"];Object.keys(no).forEach(function(t){N_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),no[e]=no[t]})});function yg(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||no.hasOwnProperty(t)&&no[t]?(""+e).trim():e+"px"}function vg(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=yg(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var j_=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Tc(t,e){if(e){if(j_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function Ic(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cc=null;function $d(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ac=null,Js=null,Zs=null;function Qf(t){if(t=Go(t)){if(typeof Ac!="function")throw Error(H(280));var e=t.stateNode;e&&(e=ql(e),Ac(t.stateNode,t.type,e))}}function _g(t){Js?Zs?Zs.push(t):Zs=[t]:Js=t}function xg(){if(Js){var t=Js,e=Zs;if(Zs=Js=null,Qf(t),e)for(t=0;t<e.length;t++)Qf(e[t])}}function wg(t,e){return t(e)}function Sg(){}var Nu=!1;function Eg(t,e,n){if(Nu)return t(e,n);Nu=!0;try{return wg(t,e,n)}finally{Nu=!1,(Js!==null||Zs!==null)&&(Sg(),xg())}}function vo(t,e){var n=t.stateNode;if(n===null)return null;var r=ql(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var kc=!1;if(nr)try{var zi={};Object.defineProperty(zi,"passive",{get:function(){kc=!0}}),window.addEventListener("test",zi,zi),window.removeEventListener("test",zi,zi)}catch{kc=!1}function V_(t,e,n,r,s,i,a,l,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var ro=!1,ol=null,al=!1,Rc=null,M_={onError:function(t){ro=!0,ol=t}};function L_(t,e,n,r,s,i,a,l,u){ro=!1,ol=null,V_.apply(M_,arguments)}function O_(t,e,n,r,s,i,a,l,u){if(L_.apply(this,arguments),ro){if(ro){var h=ol;ro=!1,ol=null}else throw Error(H(198));al||(al=!0,Rc=h)}}function xs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Tg(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Kf(t){if(xs(t)!==t)throw Error(H(188))}function F_(t){var e=t.alternate;if(!e){if(e=xs(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Kf(s),t;if(i===r)return Kf(s),e;i=i.sibling}throw Error(H(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function Ig(t){return t=F_(t),t!==null?Cg(t):null}function Cg(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Cg(t);if(e!==null)return e;t=t.sibling}return null}var Ag=on.unstable_scheduleCallback,Yf=on.unstable_cancelCallback,z_=on.unstable_shouldYield,B_=on.unstable_requestPaint,Xe=on.unstable_now,U_=on.unstable_getCurrentPriorityLevel,Wd=on.unstable_ImmediatePriority,kg=on.unstable_UserBlockingPriority,ll=on.unstable_NormalPriority,$_=on.unstable_LowPriority,Rg=on.unstable_IdlePriority,Ul=null,Vn=null;function W_(t){if(Vn&&typeof Vn.onCommitFiberRoot=="function")try{Vn.onCommitFiberRoot(Ul,t,void 0,(t.current.flags&128)===128)}catch{}}var Tn=Math.clz32?Math.clz32:G_,H_=Math.log,q_=Math.LN2;function G_(t){return t>>>=0,t===0?32:31-(H_(t)/q_|0)|0}var Ia=64,Ca=4194304;function Yi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ul(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Yi(l):(i&=a,i!==0&&(r=Yi(i)))}else a=n&~s,a!==0?r=Yi(a):i!==0&&(r=Yi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Tn(e),s=1<<n,r|=t[n],e&=~s;return r}function Q_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function K_(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Tn(i),l=1<<a,u=s[a];u===-1?(!(l&n)||l&r)&&(s[a]=Q_(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Pc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Pg(){var t=Ia;return Ia<<=1,!(Ia&4194240)&&(Ia=64),t}function ju(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ho(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Tn(e),t[e]=n}function Y_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Tn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Hd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Tn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ee=0;function bg(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Dg,qd,Ng,jg,Vg,bc=!1,Aa=[],Pr=null,br=null,Dr=null,_o=new Map,xo=new Map,Ir=[],X_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Xf(t,e){switch(t){case"focusin":case"focusout":Pr=null;break;case"dragenter":case"dragleave":br=null;break;case"mouseover":case"mouseout":Dr=null;break;case"pointerover":case"pointerout":_o.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":xo.delete(e.pointerId)}}function Bi(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Go(e),e!==null&&qd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function J_(t,e,n,r,s){switch(e){case"focusin":return Pr=Bi(Pr,t,e,n,r,s),!0;case"dragenter":return br=Bi(br,t,e,n,r,s),!0;case"mouseover":return Dr=Bi(Dr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return _o.set(i,Bi(_o.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,xo.set(i,Bi(xo.get(i)||null,t,e,n,r,s)),!0}return!1}function Mg(t){var e=ss(t.target);if(e!==null){var n=xs(e);if(n!==null){if(e=n.tag,e===13){if(e=Tg(n),e!==null){t.blockedOn=e,Vg(t.priority,function(){Ng(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Wa(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Dc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Cc=r,n.target.dispatchEvent(r),Cc=null}else return e=Go(n),e!==null&&qd(e),t.blockedOn=n,!1;e.shift()}return!0}function Jf(t,e,n){Wa(t)&&n.delete(e)}function Z_(){bc=!1,Pr!==null&&Wa(Pr)&&(Pr=null),br!==null&&Wa(br)&&(br=null),Dr!==null&&Wa(Dr)&&(Dr=null),_o.forEach(Jf),xo.forEach(Jf)}function Ui(t,e){t.blockedOn===e&&(t.blockedOn=null,bc||(bc=!0,on.unstable_scheduleCallback(on.unstable_NormalPriority,Z_)))}function wo(t){function e(s){return Ui(s,t)}if(0<Aa.length){Ui(Aa[0],t);for(var n=1;n<Aa.length;n++){var r=Aa[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Pr!==null&&Ui(Pr,t),br!==null&&Ui(br,t),Dr!==null&&Ui(Dr,t),_o.forEach(e),xo.forEach(e),n=0;n<Ir.length;n++)r=Ir[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ir.length&&(n=Ir[0],n.blockedOn===null);)Mg(n),n.blockedOn===null&&Ir.shift()}var ei=cr.ReactCurrentBatchConfig,cl=!0;function ex(t,e,n,r){var s=Ee,i=ei.transition;ei.transition=null;try{Ee=1,Gd(t,e,n,r)}finally{Ee=s,ei.transition=i}}function tx(t,e,n,r){var s=Ee,i=ei.transition;ei.transition=null;try{Ee=4,Gd(t,e,n,r)}finally{Ee=s,ei.transition=i}}function Gd(t,e,n,r){if(cl){var s=Dc(t,e,n,r);if(s===null)Wu(t,e,r,dl,n),Xf(t,r);else if(J_(s,t,e,n,r))r.stopPropagation();else if(Xf(t,r),e&4&&-1<X_.indexOf(t)){for(;s!==null;){var i=Go(s);if(i!==null&&Dg(i),i=Dc(t,e,n,r),i===null&&Wu(t,e,r,dl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Wu(t,e,r,null,n)}}var dl=null;function Dc(t,e,n,r){if(dl=null,t=$d(r),t=ss(t),t!==null)if(e=xs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Tg(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return dl=t,null}function Lg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(U_()){case Wd:return 1;case kg:return 4;case ll:case $_:return 16;case Rg:return 536870912;default:return 16}default:return 16}}var Ar=null,Qd=null,Ha=null;function Og(){if(Ha)return Ha;var t,e=Qd,n=e.length,r,s="value"in Ar?Ar.value:Ar.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Ha=s.slice(t,1<r?1-r:void 0)}function qa(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ka(){return!0}function Zf(){return!1}function ln(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ka:Zf,this.isPropagationStopped=Zf,this}return We(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ka)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ka)},persist:function(){},isPersistent:ka}),e}var _i={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kd=ln(_i),qo=We({},_i,{view:0,detail:0}),nx=ln(qo),Vu,Mu,$i,$l=We({},qo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==$i&&($i&&t.type==="mousemove"?(Vu=t.screenX-$i.screenX,Mu=t.screenY-$i.screenY):Mu=Vu=0,$i=t),Vu)},movementY:function(t){return"movementY"in t?t.movementY:Mu}}),ep=ln($l),rx=We({},$l,{dataTransfer:0}),sx=ln(rx),ix=We({},qo,{relatedTarget:0}),Lu=ln(ix),ox=We({},_i,{animationName:0,elapsedTime:0,pseudoElement:0}),ax=ln(ox),lx=We({},_i,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ux=ln(lx),cx=We({},_i,{data:0}),tp=ln(cx),dx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function px(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=fx[t])?!!e[t]:!1}function Yd(){return px}var mx=We({},qo,{key:function(t){if(t.key){var e=dx[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=qa(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?hx[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yd,charCode:function(t){return t.type==="keypress"?qa(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?qa(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),gx=ln(mx),yx=We({},$l,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),np=ln(yx),vx=We({},qo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yd}),_x=ln(vx),xx=We({},_i,{propertyName:0,elapsedTime:0,pseudoElement:0}),wx=ln(xx),Sx=We({},$l,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ex=ln(Sx),Tx=[9,13,27,32],Xd=nr&&"CompositionEvent"in window,so=null;nr&&"documentMode"in document&&(so=document.documentMode);var Ix=nr&&"TextEvent"in window&&!so,Fg=nr&&(!Xd||so&&8<so&&11>=so),rp=" ",sp=!1;function zg(t,e){switch(t){case"keyup":return Tx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bg(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Bs=!1;function Cx(t,e){switch(t){case"compositionend":return Bg(e);case"keypress":return e.which!==32?null:(sp=!0,rp);case"textInput":return t=e.data,t===rp&&sp?null:t;default:return null}}function Ax(t,e){if(Bs)return t==="compositionend"||!Xd&&zg(t,e)?(t=Og(),Ha=Qd=Ar=null,Bs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Fg&&e.locale!=="ko"?null:e.data;default:return null}}var kx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ip(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!kx[t.type]:e==="textarea"}function Ug(t,e,n,r){_g(r),e=hl(e,"onChange"),0<e.length&&(n=new Kd("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var io=null,So=null;function Rx(t){Zg(t,0)}function Wl(t){var e=Ws(t);if(hg(e))return t}function Px(t,e){if(t==="change")return e}var $g=!1;if(nr){var Ou;if(nr){var Fu="oninput"in document;if(!Fu){var op=document.createElement("div");op.setAttribute("oninput","return;"),Fu=typeof op.oninput=="function"}Ou=Fu}else Ou=!1;$g=Ou&&(!document.documentMode||9<document.documentMode)}function ap(){io&&(io.detachEvent("onpropertychange",Wg),So=io=null)}function Wg(t){if(t.propertyName==="value"&&Wl(So)){var e=[];Ug(e,So,t,$d(t)),Eg(Rx,e)}}function bx(t,e,n){t==="focusin"?(ap(),io=e,So=n,io.attachEvent("onpropertychange",Wg)):t==="focusout"&&ap()}function Dx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Wl(So)}function Nx(t,e){if(t==="click")return Wl(e)}function jx(t,e){if(t==="input"||t==="change")return Wl(e)}function Vx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var An=typeof Object.is=="function"?Object.is:Vx;function Eo(t,e){if(An(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!pc.call(e,s)||!An(t[s],e[s]))return!1}return!0}function lp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function up(t,e){var n=lp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=lp(n)}}function Hg(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Hg(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function qg(){for(var t=window,e=il();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=il(t.document)}return e}function Jd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Mx(t){var e=qg(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Hg(n.ownerDocument.documentElement,n)){if(r!==null&&Jd(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=up(n,i);var a=up(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Lx=nr&&"documentMode"in document&&11>=document.documentMode,Us=null,Nc=null,oo=null,jc=!1;function cp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;jc||Us==null||Us!==il(r)||(r=Us,"selectionStart"in r&&Jd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),oo&&Eo(oo,r)||(oo=r,r=hl(Nc,"onSelect"),0<r.length&&(e=new Kd("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Us)))}function Ra(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var $s={animationend:Ra("Animation","AnimationEnd"),animationiteration:Ra("Animation","AnimationIteration"),animationstart:Ra("Animation","AnimationStart"),transitionend:Ra("Transition","TransitionEnd")},zu={},Gg={};nr&&(Gg=document.createElement("div").style,"AnimationEvent"in window||(delete $s.animationend.animation,delete $s.animationiteration.animation,delete $s.animationstart.animation),"TransitionEvent"in window||delete $s.transitionend.transition);function Hl(t){if(zu[t])return zu[t];if(!$s[t])return t;var e=$s[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Gg)return zu[t]=e[n];return t}var Qg=Hl("animationend"),Kg=Hl("animationiteration"),Yg=Hl("animationstart"),Xg=Hl("transitionend"),Jg=new Map,dp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gr(t,e){Jg.set(t,e),_s(e,[t])}for(var Bu=0;Bu<dp.length;Bu++){var Uu=dp[Bu],Ox=Uu.toLowerCase(),Fx=Uu[0].toUpperCase()+Uu.slice(1);Gr(Ox,"on"+Fx)}Gr(Qg,"onAnimationEnd");Gr(Kg,"onAnimationIteration");Gr(Yg,"onAnimationStart");Gr("dblclick","onDoubleClick");Gr("focusin","onFocus");Gr("focusout","onBlur");Gr(Xg,"onTransitionEnd");si("onMouseEnter",["mouseout","mouseover"]);si("onMouseLeave",["mouseout","mouseover"]);si("onPointerEnter",["pointerout","pointerover"]);si("onPointerLeave",["pointerout","pointerover"]);_s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_s("onBeforeInput",["compositionend","keypress","textInput","paste"]);_s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xi));function hp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,O_(r,e,void 0,t),t.currentTarget=null}function Zg(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],u=l.instance,h=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;hp(s,l,h),i=u}else for(a=0;a<r.length;a++){if(l=r[a],u=l.instance,h=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;hp(s,l,h),i=u}}}if(al)throw t=Rc,al=!1,Rc=null,t}function je(t,e){var n=e[Fc];n===void 0&&(n=e[Fc]=new Set);var r=t+"__bubble";n.has(r)||(ey(e,t,2,!1),n.add(r))}function $u(t,e,n){var r=0;e&&(r|=4),ey(n,t,r,e)}var Pa="_reactListening"+Math.random().toString(36).slice(2);function To(t){if(!t[Pa]){t[Pa]=!0,ag.forEach(function(n){n!=="selectionchange"&&(zx.has(n)||$u(n,!1,t),$u(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Pa]||(e[Pa]=!0,$u("selectionchange",!1,e))}}function ey(t,e,n,r){switch(Lg(e)){case 1:var s=ex;break;case 4:s=tx;break;default:s=Gd}n=s.bind(null,e,n,t),s=void 0,!kc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Wu(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;l!==null;){if(a=ss(l),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}l=l.parentNode}}r=r.return}Eg(function(){var h=i,p=$d(n),g=[];e:{var y=Jg.get(t);if(y!==void 0){var E=Kd,A=t;switch(t){case"keypress":if(qa(n)===0)break e;case"keydown":case"keyup":E=gx;break;case"focusin":A="focus",E=Lu;break;case"focusout":A="blur",E=Lu;break;case"beforeblur":case"afterblur":E=Lu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=ep;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=sx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=_x;break;case Qg:case Kg:case Yg:E=ax;break;case Xg:E=wx;break;case"scroll":E=nx;break;case"wheel":E=Ex;break;case"copy":case"cut":case"paste":E=ux;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=np}var P=(e&4)!==0,F=!P&&t==="scroll",I=P?y!==null?y+"Capture":null:y;P=[];for(var S=h,C;S!==null;){C=S;var V=C.stateNode;if(C.tag===5&&V!==null&&(C=V,I!==null&&(V=vo(S,I),V!=null&&P.push(Io(S,V,C)))),F)break;S=S.return}0<P.length&&(y=new E(y,A,null,n,p),g.push({event:y,listeners:P}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",y&&n!==Cc&&(A=n.relatedTarget||n.fromElement)&&(ss(A)||A[rr]))break e;if((E||y)&&(y=p.window===p?p:(y=p.ownerDocument)?y.defaultView||y.parentWindow:window,E?(A=n.relatedTarget||n.toElement,E=h,A=A?ss(A):null,A!==null&&(F=xs(A),A!==F||A.tag!==5&&A.tag!==6)&&(A=null)):(E=null,A=h),E!==A)){if(P=ep,V="onMouseLeave",I="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(P=np,V="onPointerLeave",I="onPointerEnter",S="pointer"),F=E==null?y:Ws(E),C=A==null?y:Ws(A),y=new P(V,S+"leave",E,n,p),y.target=F,y.relatedTarget=C,V=null,ss(p)===h&&(P=new P(I,S+"enter",A,n,p),P.target=C,P.relatedTarget=F,V=P),F=V,E&&A)t:{for(P=E,I=A,S=0,C=P;C;C=Vs(C))S++;for(C=0,V=I;V;V=Vs(V))C++;for(;0<S-C;)P=Vs(P),S--;for(;0<C-S;)I=Vs(I),C--;for(;S--;){if(P===I||I!==null&&P===I.alternate)break t;P=Vs(P),I=Vs(I)}P=null}else P=null;E!==null&&fp(g,y,E,P,!1),A!==null&&F!==null&&fp(g,F,A,P,!0)}}e:{if(y=h?Ws(h):window,E=y.nodeName&&y.nodeName.toLowerCase(),E==="select"||E==="input"&&y.type==="file")var L=Px;else if(ip(y))if($g)L=jx;else{L=Dx;var M=bx}else(E=y.nodeName)&&E.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(L=Nx);if(L&&(L=L(t,h))){Ug(g,L,n,p);break e}M&&M(t,y,h),t==="focusout"&&(M=y._wrapperState)&&M.controlled&&y.type==="number"&&wc(y,"number",y.value)}switch(M=h?Ws(h):window,t){case"focusin":(ip(M)||M.contentEditable==="true")&&(Us=M,Nc=h,oo=null);break;case"focusout":oo=Nc=Us=null;break;case"mousedown":jc=!0;break;case"contextmenu":case"mouseup":case"dragend":jc=!1,cp(g,n,p);break;case"selectionchange":if(Lx)break;case"keydown":case"keyup":cp(g,n,p)}var v;if(Xd)e:{switch(t){case"compositionstart":var m="onCompositionStart";break e;case"compositionend":m="onCompositionEnd";break e;case"compositionupdate":m="onCompositionUpdate";break e}m=void 0}else Bs?zg(t,n)&&(m="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(m="onCompositionStart");m&&(Fg&&n.locale!=="ko"&&(Bs||m!=="onCompositionStart"?m==="onCompositionEnd"&&Bs&&(v=Og()):(Ar=p,Qd="value"in Ar?Ar.value:Ar.textContent,Bs=!0)),M=hl(h,m),0<M.length&&(m=new tp(m,t,null,n,p),g.push({event:m,listeners:M}),v?m.data=v:(v=Bg(n),v!==null&&(m.data=v)))),(v=Ix?Cx(t,n):Ax(t,n))&&(h=hl(h,"onBeforeInput"),0<h.length&&(p=new tp("onBeforeInput","beforeinput",null,n,p),g.push({event:p,listeners:h}),p.data=v))}Zg(g,e)})}function Io(t,e,n){return{instance:t,listener:e,currentTarget:n}}function hl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=vo(t,n),i!=null&&r.unshift(Io(t,i,s)),i=vo(t,e),i!=null&&r.push(Io(t,i,s))),t=t.return}return r}function Vs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function fp(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,u=l.alternate,h=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&h!==null&&(l=h,s?(u=vo(n,i),u!=null&&a.unshift(Io(n,u,l))):s||(u=vo(n,i),u!=null&&a.push(Io(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var Bx=/\r\n?/g,Ux=/\u0000|\uFFFD/g;function pp(t){return(typeof t=="string"?t:""+t).replace(Bx,`
`).replace(Ux,"")}function ba(t,e,n){if(e=pp(e),pp(t)!==e&&n)throw Error(H(425))}function fl(){}var Vc=null,Mc=null;function Lc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Oc=typeof setTimeout=="function"?setTimeout:void 0,$x=typeof clearTimeout=="function"?clearTimeout:void 0,mp=typeof Promise=="function"?Promise:void 0,Wx=typeof queueMicrotask=="function"?queueMicrotask:typeof mp<"u"?function(t){return mp.resolve(null).then(t).catch(Hx)}:Oc;function Hx(t){setTimeout(function(){throw t})}function Hu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),wo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);wo(e)}function Nr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function gp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var xi=Math.random().toString(36).slice(2),jn="__reactFiber$"+xi,Co="__reactProps$"+xi,rr="__reactContainer$"+xi,Fc="__reactEvents$"+xi,qx="__reactListeners$"+xi,Gx="__reactHandles$"+xi;function ss(t){var e=t[jn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[rr]||n[jn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=gp(t);t!==null;){if(n=t[jn])return n;t=gp(t)}return e}t=n,n=t.parentNode}return null}function Go(t){return t=t[jn]||t[rr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ws(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function ql(t){return t[Co]||null}var zc=[],Hs=-1;function Qr(t){return{current:t}}function Me(t){0>Hs||(t.current=zc[Hs],zc[Hs]=null,Hs--)}function be(t,e){Hs++,zc[Hs]=t.current,t.current=e}var $r={},Dt=Qr($r),qt=Qr(!1),ds=$r;function ii(t,e){var n=t.type.contextTypes;if(!n)return $r;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Gt(t){return t=t.childContextTypes,t!=null}function pl(){Me(qt),Me(Dt)}function yp(t,e,n){if(Dt.current!==$r)throw Error(H(168));be(Dt,e),be(qt,n)}function ty(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(H(108,b_(t)||"Unknown",s));return We({},n,r)}function ml(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||$r,ds=Dt.current,be(Dt,t),be(qt,qt.current),!0}function vp(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=ty(t,e,ds),r.__reactInternalMemoizedMergedChildContext=t,Me(qt),Me(Dt),be(Dt,t)):Me(qt),be(qt,n)}var Kn=null,Gl=!1,qu=!1;function ny(t){Kn===null?Kn=[t]:Kn.push(t)}function Qx(t){Gl=!0,ny(t)}function Kr(){if(!qu&&Kn!==null){qu=!0;var t=0,e=Ee;try{var n=Kn;for(Ee=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Kn=null,Gl=!1}catch(s){throw Kn!==null&&(Kn=Kn.slice(t+1)),Ag(Wd,Kr),s}finally{Ee=e,qu=!1}}return null}var qs=[],Gs=0,gl=null,yl=0,cn=[],dn=0,hs=null,Xn=1,Jn="";function ts(t,e){qs[Gs++]=yl,qs[Gs++]=gl,gl=t,yl=e}function ry(t,e,n){cn[dn++]=Xn,cn[dn++]=Jn,cn[dn++]=hs,hs=t;var r=Xn;t=Jn;var s=32-Tn(r)-1;r&=~(1<<s),n+=1;var i=32-Tn(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Xn=1<<32-Tn(e)+s|n<<s|r,Jn=i+t}else Xn=1<<i|n<<s|r,Jn=t}function Zd(t){t.return!==null&&(ts(t,1),ry(t,1,0))}function eh(t){for(;t===gl;)gl=qs[--Gs],qs[Gs]=null,yl=qs[--Gs],qs[Gs]=null;for(;t===hs;)hs=cn[--dn],cn[dn]=null,Jn=cn[--dn],cn[dn]=null,Xn=cn[--dn],cn[dn]=null}var sn=null,nn=null,Oe=!1,Sn=null;function sy(t,e){var n=hn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function _p(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,sn=t,nn=Nr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,sn=t,nn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=hs!==null?{id:Xn,overflow:Jn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=hn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,sn=t,nn=null,!0):!1;default:return!1}}function Bc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Uc(t){if(Oe){var e=nn;if(e){var n=e;if(!_p(t,e)){if(Bc(t))throw Error(H(418));e=Nr(n.nextSibling);var r=sn;e&&_p(t,e)?sy(r,n):(t.flags=t.flags&-4097|2,Oe=!1,sn=t)}}else{if(Bc(t))throw Error(H(418));t.flags=t.flags&-4097|2,Oe=!1,sn=t}}}function xp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;sn=t}function Da(t){if(t!==sn)return!1;if(!Oe)return xp(t),Oe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Lc(t.type,t.memoizedProps)),e&&(e=nn)){if(Bc(t))throw iy(),Error(H(418));for(;e;)sy(t,e),e=Nr(e.nextSibling)}if(xp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){nn=Nr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}nn=null}}else nn=sn?Nr(t.stateNode.nextSibling):null;return!0}function iy(){for(var t=nn;t;)t=Nr(t.nextSibling)}function oi(){nn=sn=null,Oe=!1}function th(t){Sn===null?Sn=[t]:Sn.push(t)}var Kx=cr.ReactCurrentBatchConfig;function Wi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function Na(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function wp(t){var e=t._init;return e(t._payload)}function oy(t){function e(I,S){if(t){var C=I.deletions;C===null?(I.deletions=[S],I.flags|=16):C.push(S)}}function n(I,S){if(!t)return null;for(;S!==null;)e(I,S),S=S.sibling;return null}function r(I,S){for(I=new Map;S!==null;)S.key!==null?I.set(S.key,S):I.set(S.index,S),S=S.sibling;return I}function s(I,S){return I=Lr(I,S),I.index=0,I.sibling=null,I}function i(I,S,C){return I.index=C,t?(C=I.alternate,C!==null?(C=C.index,C<S?(I.flags|=2,S):C):(I.flags|=2,S)):(I.flags|=1048576,S)}function a(I){return t&&I.alternate===null&&(I.flags|=2),I}function l(I,S,C,V){return S===null||S.tag!==6?(S=Zu(C,I.mode,V),S.return=I,S):(S=s(S,C),S.return=I,S)}function u(I,S,C,V){var L=C.type;return L===zs?p(I,S,C.props.children,V,C.key):S!==null&&(S.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Er&&wp(L)===S.type)?(V=s(S,C.props),V.ref=Wi(I,S,C),V.return=I,V):(V=Za(C.type,C.key,C.props,null,I.mode,V),V.ref=Wi(I,S,C),V.return=I,V)}function h(I,S,C,V){return S===null||S.tag!==4||S.stateNode.containerInfo!==C.containerInfo||S.stateNode.implementation!==C.implementation?(S=ec(C,I.mode,V),S.return=I,S):(S=s(S,C.children||[]),S.return=I,S)}function p(I,S,C,V,L){return S===null||S.tag!==7?(S=us(C,I.mode,V,L),S.return=I,S):(S=s(S,C),S.return=I,S)}function g(I,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Zu(""+S,I.mode,C),S.return=I,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Sa:return C=Za(S.type,S.key,S.props,null,I.mode,C),C.ref=Wi(I,null,S),C.return=I,C;case Fs:return S=ec(S,I.mode,C),S.return=I,S;case Er:var V=S._init;return g(I,V(S._payload),C)}if(Ki(S)||Fi(S))return S=us(S,I.mode,C,null),S.return=I,S;Na(I,S)}return null}function y(I,S,C,V){var L=S!==null?S.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return L!==null?null:l(I,S,""+C,V);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Sa:return C.key===L?u(I,S,C,V):null;case Fs:return C.key===L?h(I,S,C,V):null;case Er:return L=C._init,y(I,S,L(C._payload),V)}if(Ki(C)||Fi(C))return L!==null?null:p(I,S,C,V,null);Na(I,C)}return null}function E(I,S,C,V,L){if(typeof V=="string"&&V!==""||typeof V=="number")return I=I.get(C)||null,l(S,I,""+V,L);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Sa:return I=I.get(V.key===null?C:V.key)||null,u(S,I,V,L);case Fs:return I=I.get(V.key===null?C:V.key)||null,h(S,I,V,L);case Er:var M=V._init;return E(I,S,C,M(V._payload),L)}if(Ki(V)||Fi(V))return I=I.get(C)||null,p(S,I,V,L,null);Na(S,V)}return null}function A(I,S,C,V){for(var L=null,M=null,v=S,m=S=0,x=null;v!==null&&m<C.length;m++){v.index>m?(x=v,v=null):x=v.sibling;var w=y(I,v,C[m],V);if(w===null){v===null&&(v=x);break}t&&v&&w.alternate===null&&e(I,v),S=i(w,S,m),M===null?L=w:M.sibling=w,M=w,v=x}if(m===C.length)return n(I,v),Oe&&ts(I,m),L;if(v===null){for(;m<C.length;m++)v=g(I,C[m],V),v!==null&&(S=i(v,S,m),M===null?L=v:M.sibling=v,M=v);return Oe&&ts(I,m),L}for(v=r(I,v);m<C.length;m++)x=E(v,I,m,C[m],V),x!==null&&(t&&x.alternate!==null&&v.delete(x.key===null?m:x.key),S=i(x,S,m),M===null?L=x:M.sibling=x,M=x);return t&&v.forEach(function(k){return e(I,k)}),Oe&&ts(I,m),L}function P(I,S,C,V){var L=Fi(C);if(typeof L!="function")throw Error(H(150));if(C=L.call(C),C==null)throw Error(H(151));for(var M=L=null,v=S,m=S=0,x=null,w=C.next();v!==null&&!w.done;m++,w=C.next()){v.index>m?(x=v,v=null):x=v.sibling;var k=y(I,v,w.value,V);if(k===null){v===null&&(v=x);break}t&&v&&k.alternate===null&&e(I,v),S=i(k,S,m),M===null?L=k:M.sibling=k,M=k,v=x}if(w.done)return n(I,v),Oe&&ts(I,m),L;if(v===null){for(;!w.done;m++,w=C.next())w=g(I,w.value,V),w!==null&&(S=i(w,S,m),M===null?L=w:M.sibling=w,M=w);return Oe&&ts(I,m),L}for(v=r(I,v);!w.done;m++,w=C.next())w=E(v,I,m,w.value,V),w!==null&&(t&&w.alternate!==null&&v.delete(w.key===null?m:w.key),S=i(w,S,m),M===null?L=w:M.sibling=w,M=w);return t&&v.forEach(function(R){return e(I,R)}),Oe&&ts(I,m),L}function F(I,S,C,V){if(typeof C=="object"&&C!==null&&C.type===zs&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case Sa:e:{for(var L=C.key,M=S;M!==null;){if(M.key===L){if(L=C.type,L===zs){if(M.tag===7){n(I,M.sibling),S=s(M,C.props.children),S.return=I,I=S;break e}}else if(M.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Er&&wp(L)===M.type){n(I,M.sibling),S=s(M,C.props),S.ref=Wi(I,M,C),S.return=I,I=S;break e}n(I,M);break}else e(I,M);M=M.sibling}C.type===zs?(S=us(C.props.children,I.mode,V,C.key),S.return=I,I=S):(V=Za(C.type,C.key,C.props,null,I.mode,V),V.ref=Wi(I,S,C),V.return=I,I=V)}return a(I);case Fs:e:{for(M=C.key;S!==null;){if(S.key===M)if(S.tag===4&&S.stateNode.containerInfo===C.containerInfo&&S.stateNode.implementation===C.implementation){n(I,S.sibling),S=s(S,C.children||[]),S.return=I,I=S;break e}else{n(I,S);break}else e(I,S);S=S.sibling}S=ec(C,I.mode,V),S.return=I,I=S}return a(I);case Er:return M=C._init,F(I,S,M(C._payload),V)}if(Ki(C))return A(I,S,C,V);if(Fi(C))return P(I,S,C,V);Na(I,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,S!==null&&S.tag===6?(n(I,S.sibling),S=s(S,C),S.return=I,I=S):(n(I,S),S=Zu(C,I.mode,V),S.return=I,I=S),a(I)):n(I,S)}return F}var ai=oy(!0),ay=oy(!1),vl=Qr(null),_l=null,Qs=null,nh=null;function rh(){nh=Qs=_l=null}function sh(t){var e=vl.current;Me(vl),t._currentValue=e}function $c(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ti(t,e){_l=t,nh=Qs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ht=!0),t.firstContext=null)}function pn(t){var e=t._currentValue;if(nh!==t)if(t={context:t,memoizedValue:e,next:null},Qs===null){if(_l===null)throw Error(H(308));Qs=t,_l.dependencies={lanes:0,firstContext:t}}else Qs=Qs.next=t;return e}var is=null;function ih(t){is===null?is=[t]:is.push(t)}function ly(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,ih(e)):(n.next=s.next,s.next=n),e.interleaved=n,sr(t,r)}function sr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Tr=!1;function oh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uy(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function jr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,sr(t,n)}return s=r.interleaved,s===null?(e.next=e,ih(r)):(e.next=s.next,s.next=e),r.interleaved=e,sr(t,n)}function Ga(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Hd(t,n)}}function Sp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function xl(t,e,n,r){var s=t.updateQueue;Tr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,h=u.next;u.next=null,a===null?i=h:a.next=h,a=u;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==a&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;a=0,p=h=u=null,l=i;do{var y=l.lane,E=l.eventTime;if((r&y)===y){p!==null&&(p=p.next={eventTime:E,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var A=t,P=l;switch(y=e,E=n,P.tag){case 1:if(A=P.payload,typeof A=="function"){g=A.call(E,g,y);break e}g=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=P.payload,y=typeof A=="function"?A.call(E,g,y):A,y==null)break e;g=We({},g,y);break e;case 2:Tr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[l]:y.push(l))}else E={eventTime:E,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=E,u=g):p=p.next=E,a|=y;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;y=l,l=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(p===null&&(u=g),s.baseState=u,s.firstBaseUpdate=h,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ps|=a,t.lanes=a,t.memoizedState=g}}function Ep(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var Qo={},Mn=Qr(Qo),Ao=Qr(Qo),ko=Qr(Qo);function os(t){if(t===Qo)throw Error(H(174));return t}function ah(t,e){switch(be(ko,e),be(Ao,t),be(Mn,Qo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ec(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ec(e,t)}Me(Mn),be(Mn,e)}function li(){Me(Mn),Me(Ao),Me(ko)}function cy(t){os(ko.current);var e=os(Mn.current),n=Ec(e,t.type);e!==n&&(be(Ao,t),be(Mn,n))}function lh(t){Ao.current===t&&(Me(Mn),Me(Ao))}var Ue=Qr(0);function wl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Gu=[];function uh(){for(var t=0;t<Gu.length;t++)Gu[t]._workInProgressVersionPrimary=null;Gu.length=0}var Qa=cr.ReactCurrentDispatcher,Qu=cr.ReactCurrentBatchConfig,fs=0,$e=null,ot=null,ct=null,Sl=!1,ao=!1,Ro=0,Yx=0;function Ct(){throw Error(H(321))}function ch(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!An(t[n],e[n]))return!1;return!0}function dh(t,e,n,r,s,i){if(fs=i,$e=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Qa.current=t===null||t.memoizedState===null?e1:t1,t=n(r,s),ao){i=0;do{if(ao=!1,Ro=0,25<=i)throw Error(H(301));i+=1,ct=ot=null,e.updateQueue=null,Qa.current=n1,t=n(r,s)}while(ao)}if(Qa.current=El,e=ot!==null&&ot.next!==null,fs=0,ct=ot=$e=null,Sl=!1,e)throw Error(H(300));return t}function hh(){var t=Ro!==0;return Ro=0,t}function Nn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ct===null?$e.memoizedState=ct=t:ct=ct.next=t,ct}function mn(){if(ot===null){var t=$e.alternate;t=t!==null?t.memoizedState:null}else t=ot.next;var e=ct===null?$e.memoizedState:ct.next;if(e!==null)ct=e,ot=t;else{if(t===null)throw Error(H(310));ot=t,t={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},ct===null?$e.memoizedState=ct=t:ct=ct.next=t}return ct}function Po(t,e){return typeof e=="function"?e(t):e}function Ku(t){var e=mn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=ot,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,u=null,h=i;do{var p=h.lane;if((fs&p)===p)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var g={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(l=u=g,a=r):u=u.next=g,$e.lanes|=p,ps|=p}h=h.next}while(h!==null&&h!==i);u===null?a=r:u.next=l,An(r,e.memoizedState)||(Ht=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,$e.lanes|=i,ps|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Yu(t){var e=mn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);An(i,e.memoizedState)||(Ht=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function dy(){}function hy(t,e){var n=$e,r=mn(),s=e(),i=!An(r.memoizedState,s);if(i&&(r.memoizedState=s,Ht=!0),r=r.queue,fh(my.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ct!==null&&ct.memoizedState.tag&1){if(n.flags|=2048,bo(9,py.bind(null,n,r,s,e),void 0,null),dt===null)throw Error(H(349));fs&30||fy(n,e,s)}return s}function fy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function py(t,e,n,r){e.value=n,e.getSnapshot=r,gy(e)&&yy(t)}function my(t,e,n){return n(function(){gy(e)&&yy(t)})}function gy(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!An(t,n)}catch{return!0}}function yy(t){var e=sr(t,1);e!==null&&In(e,t,1,-1)}function Tp(t){var e=Nn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Po,lastRenderedState:t},e.queue=t,t=t.dispatch=Zx.bind(null,$e,t),[e.memoizedState,t]}function bo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function vy(){return mn().memoizedState}function Ka(t,e,n,r){var s=Nn();$e.flags|=t,s.memoizedState=bo(1|e,n,void 0,r===void 0?null:r)}function Ql(t,e,n,r){var s=mn();r=r===void 0?null:r;var i=void 0;if(ot!==null){var a=ot.memoizedState;if(i=a.destroy,r!==null&&ch(r,a.deps)){s.memoizedState=bo(e,n,i,r);return}}$e.flags|=t,s.memoizedState=bo(1|e,n,i,r)}function Ip(t,e){return Ka(8390656,8,t,e)}function fh(t,e){return Ql(2048,8,t,e)}function _y(t,e){return Ql(4,2,t,e)}function xy(t,e){return Ql(4,4,t,e)}function wy(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Sy(t,e,n){return n=n!=null?n.concat([t]):null,Ql(4,4,wy.bind(null,e,t),n)}function ph(){}function Ey(t,e){var n=mn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ch(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ty(t,e){var n=mn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ch(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Iy(t,e,n){return fs&21?(An(n,e)||(n=Pg(),$e.lanes|=n,ps|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ht=!0),t.memoizedState=n)}function Xx(t,e){var n=Ee;Ee=n!==0&&4>n?n:4,t(!0);var r=Qu.transition;Qu.transition={};try{t(!1),e()}finally{Ee=n,Qu.transition=r}}function Cy(){return mn().memoizedState}function Jx(t,e,n){var r=Mr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ay(t))ky(e,n);else if(n=ly(t,e,n,r),n!==null){var s=Vt();In(n,t,r,s),Ry(n,e,r)}}function Zx(t,e,n){var r=Mr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ay(t))ky(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,An(l,a)){var u=e.interleaved;u===null?(s.next=s,ih(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=ly(t,e,s,r),n!==null&&(s=Vt(),In(n,t,r,s),Ry(n,e,r))}}function Ay(t){var e=t.alternate;return t===$e||e!==null&&e===$e}function ky(t,e){ao=Sl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ry(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Hd(t,n)}}var El={readContext:pn,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useInsertionEffect:Ct,useLayoutEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useMutableSource:Ct,useSyncExternalStore:Ct,useId:Ct,unstable_isNewReconciler:!1},e1={readContext:pn,useCallback:function(t,e){return Nn().memoizedState=[t,e===void 0?null:e],t},useContext:pn,useEffect:Ip,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ka(4194308,4,wy.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ka(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ka(4,2,t,e)},useMemo:function(t,e){var n=Nn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Nn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Jx.bind(null,$e,t),[r.memoizedState,t]},useRef:function(t){var e=Nn();return t={current:t},e.memoizedState=t},useState:Tp,useDebugValue:ph,useDeferredValue:function(t){return Nn().memoizedState=t},useTransition:function(){var t=Tp(!1),e=t[0];return t=Xx.bind(null,t[1]),Nn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=$e,s=Nn();if(Oe){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),dt===null)throw Error(H(349));fs&30||fy(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Ip(my.bind(null,r,i,t),[t]),r.flags|=2048,bo(9,py.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Nn(),e=dt.identifierPrefix;if(Oe){var n=Jn,r=Xn;n=(r&~(1<<32-Tn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ro++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Yx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},t1={readContext:pn,useCallback:Ey,useContext:pn,useEffect:fh,useImperativeHandle:Sy,useInsertionEffect:_y,useLayoutEffect:xy,useMemo:Ty,useReducer:Ku,useRef:vy,useState:function(){return Ku(Po)},useDebugValue:ph,useDeferredValue:function(t){var e=mn();return Iy(e,ot.memoizedState,t)},useTransition:function(){var t=Ku(Po)[0],e=mn().memoizedState;return[t,e]},useMutableSource:dy,useSyncExternalStore:hy,useId:Cy,unstable_isNewReconciler:!1},n1={readContext:pn,useCallback:Ey,useContext:pn,useEffect:fh,useImperativeHandle:Sy,useInsertionEffect:_y,useLayoutEffect:xy,useMemo:Ty,useReducer:Yu,useRef:vy,useState:function(){return Yu(Po)},useDebugValue:ph,useDeferredValue:function(t){var e=mn();return ot===null?e.memoizedState=t:Iy(e,ot.memoizedState,t)},useTransition:function(){var t=Yu(Po)[0],e=mn().memoizedState;return[t,e]},useMutableSource:dy,useSyncExternalStore:hy,useId:Cy,unstable_isNewReconciler:!1};function xn(t,e){if(t&&t.defaultProps){e=We({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Wc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:We({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Kl={isMounted:function(t){return(t=t._reactInternals)?xs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Vt(),s=Mr(t),i=Zn(r,s);i.payload=e,n!=null&&(i.callback=n),e=jr(t,i,s),e!==null&&(In(e,t,s,r),Ga(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Vt(),s=Mr(t),i=Zn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=jr(t,i,s),e!==null&&(In(e,t,s,r),Ga(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Vt(),r=Mr(t),s=Zn(n,r);s.tag=2,e!=null&&(s.callback=e),e=jr(t,s,r),e!==null&&(In(e,t,r,n),Ga(e,t,r))}};function Cp(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!Eo(n,r)||!Eo(s,i):!0}function Py(t,e,n){var r=!1,s=$r,i=e.contextType;return typeof i=="object"&&i!==null?i=pn(i):(s=Gt(e)?ds:Dt.current,r=e.contextTypes,i=(r=r!=null)?ii(t,s):$r),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Kl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Ap(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Kl.enqueueReplaceState(e,e.state,null)}function Hc(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},oh(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=pn(i):(i=Gt(e)?ds:Dt.current,s.context=ii(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Wc(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Kl.enqueueReplaceState(s,s.state,null),xl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ui(t,e){try{var n="",r=e;do n+=P_(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Xu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function qc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var r1=typeof WeakMap=="function"?WeakMap:Map;function by(t,e,n){n=Zn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Il||(Il=!0,nd=r),qc(t,e)},n}function Dy(t,e,n){n=Zn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){qc(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){qc(t,e),typeof r!="function"&&(Vr===null?Vr=new Set([this]):Vr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function kp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new r1;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=y1.bind(null,t,e,n),e.then(t,t))}function Rp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Pp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Zn(-1,1),e.tag=2,jr(n,e,1))),n.lanes|=1),t)}var s1=cr.ReactCurrentOwner,Ht=!1;function jt(t,e,n,r){e.child=t===null?ay(e,null,n,r):ai(e,t.child,n,r)}function bp(t,e,n,r,s){n=n.render;var i=e.ref;return ti(e,s),r=dh(t,e,n,r,i,s),n=hh(),t!==null&&!Ht?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ir(t,e,s)):(Oe&&n&&Zd(e),e.flags|=1,jt(t,e,r,s),e.child)}function Dp(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Sh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Ny(t,e,i,r,s)):(t=Za(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Eo,n(a,r)&&t.ref===e.ref)return ir(t,e,s)}return e.flags|=1,t=Lr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Ny(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Eo(i,r)&&t.ref===e.ref)if(Ht=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Ht=!0);else return e.lanes=t.lanes,ir(t,e,s)}return Gc(t,e,n,r,s)}function jy(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},be(Ys,tn),tn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,be(Ys,tn),tn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,be(Ys,tn),tn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,be(Ys,tn),tn|=r;return jt(t,e,s,n),e.child}function Vy(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Gc(t,e,n,r,s){var i=Gt(n)?ds:Dt.current;return i=ii(e,i),ti(e,s),n=dh(t,e,n,r,i,s),r=hh(),t!==null&&!Ht?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ir(t,e,s)):(Oe&&r&&Zd(e),e.flags|=1,jt(t,e,n,s),e.child)}function Np(t,e,n,r,s){if(Gt(n)){var i=!0;ml(e)}else i=!1;if(ti(e,s),e.stateNode===null)Ya(t,e),Py(e,n,r),Hc(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=pn(h):(h=Gt(n)?ds:Dt.current,h=ii(e,h));var p=n.getDerivedStateFromProps,g=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";g||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||u!==h)&&Ap(e,a,r,h),Tr=!1;var y=e.memoizedState;a.state=y,xl(e,r,a,s),u=e.memoizedState,l!==r||y!==u||qt.current||Tr?(typeof p=="function"&&(Wc(e,n,p,r),u=e.memoizedState),(l=Tr||Cp(e,n,l,r,y,u,h))?(g||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,uy(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:xn(e.type,l),a.props=h,g=e.pendingProps,y=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=pn(u):(u=Gt(n)?ds:Dt.current,u=ii(e,u));var E=n.getDerivedStateFromProps;(p=typeof E=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==g||y!==u)&&Ap(e,a,r,u),Tr=!1,y=e.memoizedState,a.state=y,xl(e,r,a,s);var A=e.memoizedState;l!==g||y!==A||qt.current||Tr?(typeof E=="function"&&(Wc(e,n,E,r),A=e.memoizedState),(h=Tr||Cp(e,n,h,r,y,A,u)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,A,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,A,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),a.props=r,a.state=A,a.context=u,r=h):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return Qc(t,e,n,r,i,s)}function Qc(t,e,n,r,s,i){Vy(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&vp(e,n,!1),ir(t,e,i);r=e.stateNode,s1.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=ai(e,t.child,null,i),e.child=ai(e,null,l,i)):jt(t,e,l,i),e.memoizedState=r.state,s&&vp(e,n,!0),e.child}function My(t){var e=t.stateNode;e.pendingContext?yp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&yp(t,e.context,!1),ah(t,e.containerInfo)}function jp(t,e,n,r,s){return oi(),th(s),e.flags|=256,jt(t,e,n,r),e.child}var Kc={dehydrated:null,treeContext:null,retryLane:0};function Yc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ly(t,e,n){var r=e.pendingProps,s=Ue.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),be(Ue,s&1),t===null)return Uc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Jl(a,r,0,null),t=us(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Yc(n),e.memoizedState=Kc,t):mh(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return i1(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Lr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Lr(l,i):(i=us(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?Yc(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=Kc,r}return i=t.child,t=i.sibling,r=Lr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function mh(t,e){return e=Jl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ja(t,e,n,r){return r!==null&&th(r),ai(e,t.child,null,n),t=mh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function i1(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=Xu(Error(H(422))),ja(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Jl({mode:"visible",children:r.children},s,0,null),i=us(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ai(e,t.child,null,a),e.child.memoizedState=Yc(a),e.memoizedState=Kc,i);if(!(e.mode&1))return ja(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(H(419)),r=Xu(i,r,void 0),ja(t,e,a,r)}if(l=(a&t.childLanes)!==0,Ht||l){if(r=dt,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,sr(t,s),In(r,t,s,-1))}return wh(),r=Xu(Error(H(421))),ja(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=v1.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,nn=Nr(s.nextSibling),sn=e,Oe=!0,Sn=null,t!==null&&(cn[dn++]=Xn,cn[dn++]=Jn,cn[dn++]=hs,Xn=t.id,Jn=t.overflow,hs=e),e=mh(e,r.children),e.flags|=4096,e)}function Vp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),$c(t.return,e,n)}function Ju(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Oy(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(jt(t,e,r.children,n),r=Ue.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Vp(t,n,e);else if(t.tag===19)Vp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(be(Ue,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&wl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Ju(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&wl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Ju(e,!0,n,null,i);break;case"together":Ju(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ya(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ir(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ps|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=Lr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Lr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function o1(t,e,n){switch(e.tag){case 3:My(e),oi();break;case 5:cy(e);break;case 1:Gt(e.type)&&ml(e);break;case 4:ah(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;be(vl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(be(Ue,Ue.current&1),e.flags|=128,null):n&e.child.childLanes?Ly(t,e,n):(be(Ue,Ue.current&1),t=ir(t,e,n),t!==null?t.sibling:null);be(Ue,Ue.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Oy(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),be(Ue,Ue.current),r)break;return null;case 22:case 23:return e.lanes=0,jy(t,e,n)}return ir(t,e,n)}var Fy,Xc,zy,By;Fy=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Xc=function(){};zy=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,os(Mn.current);var i=null;switch(n){case"input":s=_c(t,s),r=_c(t,r),i=[];break;case"select":s=We({},s,{value:void 0}),r=We({},r,{value:void 0}),i=[];break;case"textarea":s=Sc(t,s),r=Sc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=fl)}Tc(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(go.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var u=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&u!==l&&(u!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(go.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&je("scroll",t),i||l===u||(i=[])):(i=i||[]).push(h,u))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};By=function(t,e,n,r){n!==r&&(e.flags|=4)};function Hi(t,e){if(!Oe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function At(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function a1(t,e,n){var r=e.pendingProps;switch(eh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(e),null;case 1:return Gt(e.type)&&pl(),At(e),null;case 3:return r=e.stateNode,li(),Me(qt),Me(Dt),uh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Da(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Sn!==null&&(id(Sn),Sn=null))),Xc(t,e),At(e),null;case 5:lh(e);var s=os(ko.current);if(n=e.type,t!==null&&e.stateNode!=null)zy(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return At(e),null}if(t=os(Mn.current),Da(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[jn]=e,r[Co]=i,t=(e.mode&1)!==0,n){case"dialog":je("cancel",r),je("close",r);break;case"iframe":case"object":case"embed":je("load",r);break;case"video":case"audio":for(s=0;s<Xi.length;s++)je(Xi[s],r);break;case"source":je("error",r);break;case"img":case"image":case"link":je("error",r),je("load",r);break;case"details":je("toggle",r);break;case"input":Wf(r,i),je("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},je("invalid",r);break;case"textarea":qf(r,i),je("invalid",r)}Tc(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&ba(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&ba(r.textContent,l,t),s=["children",""+l]):go.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&je("scroll",r)}switch(n){case"input":Ea(r),Hf(r,i,!0);break;case"textarea":Ea(r),Gf(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=fl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=mg(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[jn]=e,t[Co]=r,Fy(t,e,!1,!1),e.stateNode=t;e:{switch(a=Ic(n,r),n){case"dialog":je("cancel",t),je("close",t),s=r;break;case"iframe":case"object":case"embed":je("load",t),s=r;break;case"video":case"audio":for(s=0;s<Xi.length;s++)je(Xi[s],t);s=r;break;case"source":je("error",t),s=r;break;case"img":case"image":case"link":je("error",t),je("load",t),s=r;break;case"details":je("toggle",t),s=r;break;case"input":Wf(t,r),s=_c(t,r),je("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=We({},r,{value:void 0}),je("invalid",t);break;case"textarea":qf(t,r),s=Sc(t,r),je("invalid",t);break;default:s=r}Tc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?vg(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&gg(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&yo(t,u):typeof u=="number"&&yo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(go.hasOwnProperty(i)?u!=null&&i==="onScroll"&&je("scroll",t):u!=null&&Fd(t,i,u,a))}switch(n){case"input":Ea(t),Hf(t,r,!1);break;case"textarea":Ea(t),Gf(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ur(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Xs(t,!!r.multiple,i,!1):r.defaultValue!=null&&Xs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=fl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return At(e),null;case 6:if(t&&e.stateNode!=null)By(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=os(ko.current),os(Mn.current),Da(e)){if(r=e.stateNode,n=e.memoizedProps,r[jn]=e,(i=r.nodeValue!==n)&&(t=sn,t!==null))switch(t.tag){case 3:ba(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ba(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[jn]=e,e.stateNode=r}return At(e),null;case 13:if(Me(Ue),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Oe&&nn!==null&&e.mode&1&&!(e.flags&128))iy(),oi(),e.flags|=98560,i=!1;else if(i=Da(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(H(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[jn]=e}else oi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;At(e),i=!1}else Sn!==null&&(id(Sn),Sn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ue.current&1?at===0&&(at=3):wh())),e.updateQueue!==null&&(e.flags|=4),At(e),null);case 4:return li(),Xc(t,e),t===null&&To(e.stateNode.containerInfo),At(e),null;case 10:return sh(e.type._context),At(e),null;case 17:return Gt(e.type)&&pl(),At(e),null;case 19:if(Me(Ue),i=e.memoizedState,i===null)return At(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Hi(i,!1);else{if(at!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=wl(t),a!==null){for(e.flags|=128,Hi(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return be(Ue,Ue.current&1|2),e.child}t=t.sibling}i.tail!==null&&Xe()>ci&&(e.flags|=128,r=!0,Hi(i,!1),e.lanes=4194304)}else{if(!r)if(t=wl(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Hi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Oe)return At(e),null}else 2*Xe()-i.renderingStartTime>ci&&n!==1073741824&&(e.flags|=128,r=!0,Hi(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Xe(),e.sibling=null,n=Ue.current,be(Ue,r?n&1|2:n&1),e):(At(e),null);case 22:case 23:return xh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?tn&1073741824&&(At(e),e.subtreeFlags&6&&(e.flags|=8192)):At(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function l1(t,e){switch(eh(e),e.tag){case 1:return Gt(e.type)&&pl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return li(),Me(qt),Me(Dt),uh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return lh(e),null;case 13:if(Me(Ue),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));oi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Me(Ue),null;case 4:return li(),null;case 10:return sh(e.type._context),null;case 22:case 23:return xh(),null;case 24:return null;default:return null}}var Va=!1,Rt=!1,u1=typeof WeakSet=="function"?WeakSet:Set,J=null;function Ks(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Qe(t,e,r)}else n.current=null}function Jc(t,e,n){try{n()}catch(r){Qe(t,e,r)}}var Mp=!1;function c1(t,e){if(Vc=cl,t=qg(),Jd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,u=-1,h=0,p=0,g=t,y=null;t:for(;;){for(var E;g!==n||s!==0&&g.nodeType!==3||(l=a+s),g!==i||r!==0&&g.nodeType!==3||(u=a+r),g.nodeType===3&&(a+=g.nodeValue.length),(E=g.firstChild)!==null;)y=g,g=E;for(;;){if(g===t)break t;if(y===n&&++h===s&&(l=a),y===i&&++p===r&&(u=a),(E=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=E}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Mc={focusedElem:t,selectionRange:n},cl=!1,J=e;J!==null;)if(e=J,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,J=t;else for(;J!==null;){e=J;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var P=A.memoizedProps,F=A.memoizedState,I=e.stateNode,S=I.getSnapshotBeforeUpdate(e.elementType===e.type?P:xn(e.type,P),F);I.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(V){Qe(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,J=t;break}J=e.return}return A=Mp,Mp=!1,A}function lo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Jc(e,n,i)}s=s.next}while(s!==r)}}function Yl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Zc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Uy(t){var e=t.alternate;e!==null&&(t.alternate=null,Uy(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[jn],delete e[Co],delete e[Fc],delete e[qx],delete e[Gx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function $y(t){return t.tag===5||t.tag===3||t.tag===4}function Lp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||$y(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ed(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=fl));else if(r!==4&&(t=t.child,t!==null))for(ed(t,e,n),t=t.sibling;t!==null;)ed(t,e,n),t=t.sibling}function td(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(td(t,e,n),t=t.sibling;t!==null;)td(t,e,n),t=t.sibling}var gt=null,wn=!1;function Sr(t,e,n){for(n=n.child;n!==null;)Wy(t,e,n),n=n.sibling}function Wy(t,e,n){if(Vn&&typeof Vn.onCommitFiberUnmount=="function")try{Vn.onCommitFiberUnmount(Ul,n)}catch{}switch(n.tag){case 5:Rt||Ks(n,e);case 6:var r=gt,s=wn;gt=null,Sr(t,e,n),gt=r,wn=s,gt!==null&&(wn?(t=gt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):gt.removeChild(n.stateNode));break;case 18:gt!==null&&(wn?(t=gt,n=n.stateNode,t.nodeType===8?Hu(t.parentNode,n):t.nodeType===1&&Hu(t,n),wo(t)):Hu(gt,n.stateNode));break;case 4:r=gt,s=wn,gt=n.stateNode.containerInfo,wn=!0,Sr(t,e,n),gt=r,wn=s;break;case 0:case 11:case 14:case 15:if(!Rt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Jc(n,e,a),s=s.next}while(s!==r)}Sr(t,e,n);break;case 1:if(!Rt&&(Ks(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Qe(n,e,l)}Sr(t,e,n);break;case 21:Sr(t,e,n);break;case 22:n.mode&1?(Rt=(r=Rt)||n.memoizedState!==null,Sr(t,e,n),Rt=r):Sr(t,e,n);break;default:Sr(t,e,n)}}function Op(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new u1),e.forEach(function(r){var s=_1.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function _n(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:gt=l.stateNode,wn=!1;break e;case 3:gt=l.stateNode.containerInfo,wn=!0;break e;case 4:gt=l.stateNode.containerInfo,wn=!0;break e}l=l.return}if(gt===null)throw Error(H(160));Wy(i,a,s),gt=null,wn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(h){Qe(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Hy(e,t),e=e.sibling}function Hy(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(_n(e,t),Dn(t),r&4){try{lo(3,t,t.return),Yl(3,t)}catch(P){Qe(t,t.return,P)}try{lo(5,t,t.return)}catch(P){Qe(t,t.return,P)}}break;case 1:_n(e,t),Dn(t),r&512&&n!==null&&Ks(n,n.return);break;case 5:if(_n(e,t),Dn(t),r&512&&n!==null&&Ks(n,n.return),t.flags&32){var s=t.stateNode;try{yo(s,"")}catch(P){Qe(t,t.return,P)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&fg(s,i),Ic(l,a);var h=Ic(l,i);for(a=0;a<u.length;a+=2){var p=u[a],g=u[a+1];p==="style"?vg(s,g):p==="dangerouslySetInnerHTML"?gg(s,g):p==="children"?yo(s,g):Fd(s,p,g,h)}switch(l){case"input":xc(s,i);break;case"textarea":pg(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var E=i.value;E!=null?Xs(s,!!i.multiple,E,!1):y!==!!i.multiple&&(i.defaultValue!=null?Xs(s,!!i.multiple,i.defaultValue,!0):Xs(s,!!i.multiple,i.multiple?[]:"",!1))}s[Co]=i}catch(P){Qe(t,t.return,P)}}break;case 6:if(_n(e,t),Dn(t),r&4){if(t.stateNode===null)throw Error(H(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){Qe(t,t.return,P)}}break;case 3:if(_n(e,t),Dn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{wo(e.containerInfo)}catch(P){Qe(t,t.return,P)}break;case 4:_n(e,t),Dn(t);break;case 13:_n(e,t),Dn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(vh=Xe())),r&4&&Op(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(Rt=(h=Rt)||p,_n(e,t),Rt=h):_n(e,t),Dn(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(J=t,p=t.child;p!==null;){for(g=J=p;J!==null;){switch(y=J,E=y.child,y.tag){case 0:case 11:case 14:case 15:lo(4,y,y.return);break;case 1:Ks(y,y.return);var A=y.stateNode;if(typeof A.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(P){Qe(r,n,P)}}break;case 5:Ks(y,y.return);break;case 22:if(y.memoizedState!==null){zp(g);continue}}E!==null?(E.return=y,J=E):zp(g)}p=p.sibling}e:for(p=null,g=t;;){if(g.tag===5){if(p===null){p=g;try{s=g.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=g.stateNode,u=g.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=yg("display",a))}catch(P){Qe(t,t.return,P)}}}else if(g.tag===6){if(p===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(P){Qe(t,t.return,P)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;p===g&&(p=null),g=g.return}p===g&&(p=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:_n(e,t),Dn(t),r&4&&Op(t);break;case 21:break;default:_n(e,t),Dn(t)}}function Dn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if($y(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(yo(s,""),r.flags&=-33);var i=Lp(t);td(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Lp(t);ed(t,l,a);break;default:throw Error(H(161))}}catch(u){Qe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function d1(t,e,n){J=t,qy(t)}function qy(t,e,n){for(var r=(t.mode&1)!==0;J!==null;){var s=J,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Va;if(!a){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Rt;l=Va;var h=Rt;if(Va=a,(Rt=u)&&!h)for(J=s;J!==null;)a=J,u=a.child,a.tag===22&&a.memoizedState!==null?Bp(s):u!==null?(u.return=a,J=u):Bp(s);for(;i!==null;)J=i,qy(i),i=i.sibling;J=s,Va=l,Rt=h}Fp(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,J=i):Fp(t)}}function Fp(t){for(;J!==null;){var e=J;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Rt||Yl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Rt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:xn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Ep(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Ep(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var g=p.dehydrated;g!==null&&wo(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}Rt||e.flags&512&&Zc(e)}catch(y){Qe(e,e.return,y)}}if(e===t){J=null;break}if(n=e.sibling,n!==null){n.return=e.return,J=n;break}J=e.return}}function zp(t){for(;J!==null;){var e=J;if(e===t){J=null;break}var n=e.sibling;if(n!==null){n.return=e.return,J=n;break}J=e.return}}function Bp(t){for(;J!==null;){var e=J;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Yl(4,e)}catch(u){Qe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Qe(e,s,u)}}var i=e.return;try{Zc(e)}catch(u){Qe(e,i,u)}break;case 5:var a=e.return;try{Zc(e)}catch(u){Qe(e,a,u)}}}catch(u){Qe(e,e.return,u)}if(e===t){J=null;break}var l=e.sibling;if(l!==null){l.return=e.return,J=l;break}J=e.return}}var h1=Math.ceil,Tl=cr.ReactCurrentDispatcher,gh=cr.ReactCurrentOwner,fn=cr.ReactCurrentBatchConfig,ve=0,dt=null,nt=null,_t=0,tn=0,Ys=Qr(0),at=0,Do=null,ps=0,Xl=0,yh=0,uo=null,$t=null,vh=0,ci=1/0,Qn=null,Il=!1,nd=null,Vr=null,Ma=!1,kr=null,Cl=0,co=0,rd=null,Xa=-1,Ja=0;function Vt(){return ve&6?Xe():Xa!==-1?Xa:Xa=Xe()}function Mr(t){return t.mode&1?ve&2&&_t!==0?_t&-_t:Kx.transition!==null?(Ja===0&&(Ja=Pg()),Ja):(t=Ee,t!==0||(t=window.event,t=t===void 0?16:Lg(t.type)),t):1}function In(t,e,n,r){if(50<co)throw co=0,rd=null,Error(H(185));Ho(t,n,r),(!(ve&2)||t!==dt)&&(t===dt&&(!(ve&2)&&(Xl|=n),at===4&&Cr(t,_t)),Qt(t,r),n===1&&ve===0&&!(e.mode&1)&&(ci=Xe()+500,Gl&&Kr()))}function Qt(t,e){var n=t.callbackNode;K_(t,e);var r=ul(t,t===dt?_t:0);if(r===0)n!==null&&Yf(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Yf(n),e===1)t.tag===0?Qx(Up.bind(null,t)):ny(Up.bind(null,t)),Wx(function(){!(ve&6)&&Kr()}),n=null;else{switch(bg(r)){case 1:n=Wd;break;case 4:n=kg;break;case 16:n=ll;break;case 536870912:n=Rg;break;default:n=ll}n=e0(n,Gy.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Gy(t,e){if(Xa=-1,Ja=0,ve&6)throw Error(H(327));var n=t.callbackNode;if(ni()&&t.callbackNode!==n)return null;var r=ul(t,t===dt?_t:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Al(t,r);else{e=r;var s=ve;ve|=2;var i=Ky();(dt!==t||_t!==e)&&(Qn=null,ci=Xe()+500,ls(t,e));do try{m1();break}catch(l){Qy(t,l)}while(!0);rh(),Tl.current=i,ve=s,nt!==null?e=0:(dt=null,_t=0,e=at)}if(e!==0){if(e===2&&(s=Pc(t),s!==0&&(r=s,e=sd(t,s))),e===1)throw n=Do,ls(t,0),Cr(t,r),Qt(t,Xe()),n;if(e===6)Cr(t,r);else{if(s=t.current.alternate,!(r&30)&&!f1(s)&&(e=Al(t,r),e===2&&(i=Pc(t),i!==0&&(r=i,e=sd(t,i))),e===1))throw n=Do,ls(t,0),Cr(t,r),Qt(t,Xe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:ns(t,$t,Qn);break;case 3:if(Cr(t,r),(r&130023424)===r&&(e=vh+500-Xe(),10<e)){if(ul(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Vt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Oc(ns.bind(null,t,$t,Qn),e);break}ns(t,$t,Qn);break;case 4:if(Cr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Tn(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=Xe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*h1(r/1960))-r,10<r){t.timeoutHandle=Oc(ns.bind(null,t,$t,Qn),r);break}ns(t,$t,Qn);break;case 5:ns(t,$t,Qn);break;default:throw Error(H(329))}}}return Qt(t,Xe()),t.callbackNode===n?Gy.bind(null,t):null}function sd(t,e){var n=uo;return t.current.memoizedState.isDehydrated&&(ls(t,e).flags|=256),t=Al(t,e),t!==2&&(e=$t,$t=n,e!==null&&id(e)),t}function id(t){$t===null?$t=t:$t.push.apply($t,t)}function f1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!An(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Cr(t,e){for(e&=~yh,e&=~Xl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Tn(e),r=1<<n;t[n]=-1,e&=~r}}function Up(t){if(ve&6)throw Error(H(327));ni();var e=ul(t,0);if(!(e&1))return Qt(t,Xe()),null;var n=Al(t,e);if(t.tag!==0&&n===2){var r=Pc(t);r!==0&&(e=r,n=sd(t,r))}if(n===1)throw n=Do,ls(t,0),Cr(t,e),Qt(t,Xe()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ns(t,$t,Qn),Qt(t,Xe()),null}function _h(t,e){var n=ve;ve|=1;try{return t(e)}finally{ve=n,ve===0&&(ci=Xe()+500,Gl&&Kr())}}function ms(t){kr!==null&&kr.tag===0&&!(ve&6)&&ni();var e=ve;ve|=1;var n=fn.transition,r=Ee;try{if(fn.transition=null,Ee=1,t)return t()}finally{Ee=r,fn.transition=n,ve=e,!(ve&6)&&Kr()}}function xh(){tn=Ys.current,Me(Ys)}function ls(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$x(n)),nt!==null)for(n=nt.return;n!==null;){var r=n;switch(eh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&pl();break;case 3:li(),Me(qt),Me(Dt),uh();break;case 5:lh(r);break;case 4:li();break;case 13:Me(Ue);break;case 19:Me(Ue);break;case 10:sh(r.type._context);break;case 22:case 23:xh()}n=n.return}if(dt=t,nt=t=Lr(t.current,null),_t=tn=e,at=0,Do=null,yh=Xl=ps=0,$t=uo=null,is!==null){for(e=0;e<is.length;e++)if(n=is[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}is=null}return t}function Qy(t,e){do{var n=nt;try{if(rh(),Qa.current=El,Sl){for(var r=$e.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Sl=!1}if(fs=0,ct=ot=$e=null,ao=!1,Ro=0,gh.current=null,n===null||n.return===null){at=1,Do=e,nt=null;break}e:{var i=t,a=n.return,l=n,u=e;if(e=_t,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,p=l,g=p.tag;if(!(p.mode&1)&&(g===0||g===11||g===15)){var y=p.alternate;y?(p.updateQueue=y.updateQueue,p.memoizedState=y.memoizedState,p.lanes=y.lanes):(p.updateQueue=null,p.memoizedState=null)}var E=Rp(a);if(E!==null){E.flags&=-257,Pp(E,a,l,i,e),E.mode&1&&kp(i,h,e),e=E,u=h;var A=e.updateQueue;if(A===null){var P=new Set;P.add(u),e.updateQueue=P}else A.add(u);break e}else{if(!(e&1)){kp(i,h,e),wh();break e}u=Error(H(426))}}else if(Oe&&l.mode&1){var F=Rp(a);if(F!==null){!(F.flags&65536)&&(F.flags|=256),Pp(F,a,l,i,e),th(ui(u,l));break e}}i=u=ui(u,l),at!==4&&(at=2),uo===null?uo=[i]:uo.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var I=by(i,u,e);Sp(i,I);break e;case 1:l=u;var S=i.type,C=i.stateNode;if(!(i.flags&128)&&(typeof S.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Vr===null||!Vr.has(C)))){i.flags|=65536,e&=-e,i.lanes|=e;var V=Dy(i,l,e);Sp(i,V);break e}}i=i.return}while(i!==null)}Xy(n)}catch(L){e=L,nt===n&&n!==null&&(nt=n=n.return);continue}break}while(!0)}function Ky(){var t=Tl.current;return Tl.current=El,t===null?El:t}function wh(){(at===0||at===3||at===2)&&(at=4),dt===null||!(ps&268435455)&&!(Xl&268435455)||Cr(dt,_t)}function Al(t,e){var n=ve;ve|=2;var r=Ky();(dt!==t||_t!==e)&&(Qn=null,ls(t,e));do try{p1();break}catch(s){Qy(t,s)}while(!0);if(rh(),ve=n,Tl.current=r,nt!==null)throw Error(H(261));return dt=null,_t=0,at}function p1(){for(;nt!==null;)Yy(nt)}function m1(){for(;nt!==null&&!z_();)Yy(nt)}function Yy(t){var e=Zy(t.alternate,t,tn);t.memoizedProps=t.pendingProps,e===null?Xy(t):nt=e,gh.current=null}function Xy(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=l1(n,e),n!==null){n.flags&=32767,nt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{at=6,nt=null;return}}else if(n=a1(n,e,tn),n!==null){nt=n;return}if(e=e.sibling,e!==null){nt=e;return}nt=e=t}while(e!==null);at===0&&(at=5)}function ns(t,e,n){var r=Ee,s=fn.transition;try{fn.transition=null,Ee=1,g1(t,e,n,r)}finally{fn.transition=s,Ee=r}return null}function g1(t,e,n,r){do ni();while(kr!==null);if(ve&6)throw Error(H(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Y_(t,i),t===dt&&(nt=dt=null,_t=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ma||(Ma=!0,e0(ll,function(){return ni(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=fn.transition,fn.transition=null;var a=Ee;Ee=1;var l=ve;ve|=4,gh.current=null,c1(t,n),Hy(n,t),Mx(Mc),cl=!!Vc,Mc=Vc=null,t.current=n,d1(n),B_(),ve=l,Ee=a,fn.transition=i}else t.current=n;if(Ma&&(Ma=!1,kr=t,Cl=s),i=t.pendingLanes,i===0&&(Vr=null),W_(n.stateNode),Qt(t,Xe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Il)throw Il=!1,t=nd,nd=null,t;return Cl&1&&t.tag!==0&&ni(),i=t.pendingLanes,i&1?t===rd?co++:(co=0,rd=t):co=0,Kr(),null}function ni(){if(kr!==null){var t=bg(Cl),e=fn.transition,n=Ee;try{if(fn.transition=null,Ee=16>t?16:t,kr===null)var r=!1;else{if(t=kr,kr=null,Cl=0,ve&6)throw Error(H(331));var s=ve;for(ve|=4,J=t.current;J!==null;){var i=J,a=i.child;if(J.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var h=l[u];for(J=h;J!==null;){var p=J;switch(p.tag){case 0:case 11:case 15:lo(8,p,i)}var g=p.child;if(g!==null)g.return=p,J=g;else for(;J!==null;){p=J;var y=p.sibling,E=p.return;if(Uy(p),p===h){J=null;break}if(y!==null){y.return=E,J=y;break}J=E}}}var A=i.alternate;if(A!==null){var P=A.child;if(P!==null){A.child=null;do{var F=P.sibling;P.sibling=null,P=F}while(P!==null)}}J=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,J=a;else e:for(;J!==null;){if(i=J,i.flags&2048)switch(i.tag){case 0:case 11:case 15:lo(9,i,i.return)}var I=i.sibling;if(I!==null){I.return=i.return,J=I;break e}J=i.return}}var S=t.current;for(J=S;J!==null;){a=J;var C=a.child;if(a.subtreeFlags&2064&&C!==null)C.return=a,J=C;else e:for(a=S;J!==null;){if(l=J,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Yl(9,l)}}catch(L){Qe(l,l.return,L)}if(l===a){J=null;break e}var V=l.sibling;if(V!==null){V.return=l.return,J=V;break e}J=l.return}}if(ve=s,Kr(),Vn&&typeof Vn.onPostCommitFiberRoot=="function")try{Vn.onPostCommitFiberRoot(Ul,t)}catch{}r=!0}return r}finally{Ee=n,fn.transition=e}}return!1}function $p(t,e,n){e=ui(n,e),e=by(t,e,1),t=jr(t,e,1),e=Vt(),t!==null&&(Ho(t,1,e),Qt(t,e))}function Qe(t,e,n){if(t.tag===3)$p(t,t,n);else for(;e!==null;){if(e.tag===3){$p(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Vr===null||!Vr.has(r))){t=ui(n,t),t=Dy(e,t,1),e=jr(e,t,1),t=Vt(),e!==null&&(Ho(e,1,t),Qt(e,t));break}}e=e.return}}function y1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Vt(),t.pingedLanes|=t.suspendedLanes&n,dt===t&&(_t&n)===n&&(at===4||at===3&&(_t&130023424)===_t&&500>Xe()-vh?ls(t,0):yh|=n),Qt(t,e)}function Jy(t,e){e===0&&(t.mode&1?(e=Ca,Ca<<=1,!(Ca&130023424)&&(Ca=4194304)):e=1);var n=Vt();t=sr(t,e),t!==null&&(Ho(t,e,n),Qt(t,n))}function v1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Jy(t,n)}function _1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),Jy(t,n)}var Zy;Zy=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||qt.current)Ht=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ht=!1,o1(t,e,n);Ht=!!(t.flags&131072)}else Ht=!1,Oe&&e.flags&1048576&&ry(e,yl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ya(t,e),t=e.pendingProps;var s=ii(e,Dt.current);ti(e,n),s=dh(null,e,r,t,s,n);var i=hh();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Gt(r)?(i=!0,ml(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,oh(e),s.updater=Kl,e.stateNode=s,s._reactInternals=e,Hc(e,r,t,n),e=Qc(null,e,r,!0,i,n)):(e.tag=0,Oe&&i&&Zd(e),jt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ya(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=w1(r),t=xn(r,t),s){case 0:e=Gc(null,e,r,t,n);break e;case 1:e=Np(null,e,r,t,n);break e;case 11:e=bp(null,e,r,t,n);break e;case 14:e=Dp(null,e,r,xn(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Gc(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Np(t,e,r,s,n);case 3:e:{if(My(e),t===null)throw Error(H(387));r=e.pendingProps,i=e.memoizedState,s=i.element,uy(t,e),xl(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ui(Error(H(423)),e),e=jp(t,e,r,n,s);break e}else if(r!==s){s=ui(Error(H(424)),e),e=jp(t,e,r,n,s);break e}else for(nn=Nr(e.stateNode.containerInfo.firstChild),sn=e,Oe=!0,Sn=null,n=ay(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(oi(),r===s){e=ir(t,e,n);break e}jt(t,e,r,n)}e=e.child}return e;case 5:return cy(e),t===null&&Uc(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Lc(r,s)?a=null:i!==null&&Lc(r,i)&&(e.flags|=32),Vy(t,e),jt(t,e,a,n),e.child;case 6:return t===null&&Uc(e),null;case 13:return Ly(t,e,n);case 4:return ah(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ai(e,null,r,n):jt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),bp(t,e,r,s,n);case 7:return jt(t,e,e.pendingProps,n),e.child;case 8:return jt(t,e,e.pendingProps.children,n),e.child;case 12:return jt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,be(vl,r._currentValue),r._currentValue=a,i!==null)if(An(i.value,a)){if(i.children===s.children&&!qt.current){e=ir(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Zn(-1,n&-n),u.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?u.next=u:(u.next=p.next,p.next=u),h.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),$c(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(H(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),$c(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}jt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ti(e,n),s=pn(s),r=r(s),e.flags|=1,jt(t,e,r,n),e.child;case 14:return r=e.type,s=xn(r,e.pendingProps),s=xn(r.type,s),Dp(t,e,r,s,n);case 15:return Ny(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Ya(t,e),e.tag=1,Gt(r)?(t=!0,ml(e)):t=!1,ti(e,n),Py(e,r,s),Hc(e,r,s,n),Qc(null,e,r,!0,t,n);case 19:return Oy(t,e,n);case 22:return jy(t,e,n)}throw Error(H(156,e.tag))};function e0(t,e){return Ag(t,e)}function x1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hn(t,e,n,r){return new x1(t,e,n,r)}function Sh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function w1(t){if(typeof t=="function")return Sh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Bd)return 11;if(t===Ud)return 14}return 2}function Lr(t,e){var n=t.alternate;return n===null?(n=hn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Za(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")Sh(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case zs:return us(n.children,s,i,e);case zd:a=8,s|=8;break;case mc:return t=hn(12,n,e,s|2),t.elementType=mc,t.lanes=i,t;case gc:return t=hn(13,n,e,s),t.elementType=gc,t.lanes=i,t;case yc:return t=hn(19,n,e,s),t.elementType=yc,t.lanes=i,t;case cg:return Jl(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case lg:a=10;break e;case ug:a=9;break e;case Bd:a=11;break e;case Ud:a=14;break e;case Er:a=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=hn(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function us(t,e,n,r){return t=hn(7,t,r,e),t.lanes=n,t}function Jl(t,e,n,r){return t=hn(22,t,r,e),t.elementType=cg,t.lanes=n,t.stateNode={isHidden:!1},t}function Zu(t,e,n){return t=hn(6,t,null,e),t.lanes=n,t}function ec(t,e,n){return e=hn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function S1(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ju(0),this.expirationTimes=ju(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ju(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Eh(t,e,n,r,s,i,a,l,u){return t=new S1(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=hn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},oh(i),t}function E1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function t0(t){if(!t)return $r;t=t._reactInternals;e:{if(xs(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Gt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(Gt(n))return ty(t,n,e)}return e}function n0(t,e,n,r,s,i,a,l,u){return t=Eh(n,r,!0,t,s,i,a,l,u),t.context=t0(null),n=t.current,r=Vt(),s=Mr(n),i=Zn(r,s),i.callback=e??null,jr(n,i,s),t.current.lanes=s,Ho(t,s,r),Qt(t,r),t}function Zl(t,e,n,r){var s=e.current,i=Vt(),a=Mr(s);return n=t0(n),e.context===null?e.context=n:e.pendingContext=n,e=Zn(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=jr(s,e,a),t!==null&&(In(t,s,a,i),Ga(t,s,a)),a}function kl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Wp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Th(t,e){Wp(t,e),(t=t.alternate)&&Wp(t,e)}function T1(){return null}var r0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ih(t){this._internalRoot=t}eu.prototype.render=Ih.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));Zl(t,e,null,null)};eu.prototype.unmount=Ih.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ms(function(){Zl(null,t,null,null)}),e[rr]=null}};function eu(t){this._internalRoot=t}eu.prototype.unstable_scheduleHydration=function(t){if(t){var e=jg();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ir.length&&e!==0&&e<Ir[n].priority;n++);Ir.splice(n,0,t),n===0&&Mg(t)}};function Ch(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function tu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Hp(){}function I1(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=kl(a);i.call(h)}}var a=n0(e,r,t,0,null,!1,!1,"",Hp);return t._reactRootContainer=a,t[rr]=a.current,To(t.nodeType===8?t.parentNode:t),ms(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=kl(u);l.call(h)}}var u=Eh(t,0,!1,null,null,!1,!1,"",Hp);return t._reactRootContainer=u,t[rr]=u.current,To(t.nodeType===8?t.parentNode:t),ms(function(){Zl(e,u,n,r)}),u}function nu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var u=kl(a);l.call(u)}}Zl(e,a,t,s)}else a=I1(n,e,t,s,r);return kl(a)}Dg=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Yi(e.pendingLanes);n!==0&&(Hd(e,n|1),Qt(e,Xe()),!(ve&6)&&(ci=Xe()+500,Kr()))}break;case 13:ms(function(){var r=sr(t,1);if(r!==null){var s=Vt();In(r,t,1,s)}}),Th(t,1)}};qd=function(t){if(t.tag===13){var e=sr(t,134217728);if(e!==null){var n=Vt();In(e,t,134217728,n)}Th(t,134217728)}};Ng=function(t){if(t.tag===13){var e=Mr(t),n=sr(t,e);if(n!==null){var r=Vt();In(n,t,e,r)}Th(t,e)}};jg=function(){return Ee};Vg=function(t,e){var n=Ee;try{return Ee=t,e()}finally{Ee=n}};Ac=function(t,e,n){switch(e){case"input":if(xc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=ql(r);if(!s)throw Error(H(90));hg(r),xc(r,s)}}}break;case"textarea":pg(t,n);break;case"select":e=n.value,e!=null&&Xs(t,!!n.multiple,e,!1)}};wg=_h;Sg=ms;var C1={usingClientEntryPoint:!1,Events:[Go,Ws,ql,_g,xg,_h]},qi={findFiberByHostInstance:ss,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},A1={bundleType:qi.bundleType,version:qi.version,rendererPackageName:qi.rendererPackageName,rendererConfig:qi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ig(t),t===null?null:t.stateNode},findFiberByHostInstance:qi.findFiberByHostInstance||T1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var La=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!La.isDisabled&&La.supportsFiber)try{Ul=La.inject(A1),Vn=La}catch{}}an.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C1;an.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ch(e))throw Error(H(200));return E1(t,e,null,n)};an.createRoot=function(t,e){if(!Ch(t))throw Error(H(299));var n=!1,r="",s=r0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Eh(t,1,!1,null,null,n,!1,r,s),t[rr]=e.current,To(t.nodeType===8?t.parentNode:t),new Ih(e)};an.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=Ig(e),t=t===null?null:t.stateNode,t};an.flushSync=function(t){return ms(t)};an.hydrate=function(t,e,n){if(!tu(e))throw Error(H(200));return nu(null,t,e,!0,n)};an.hydrateRoot=function(t,e,n){if(!Ch(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=r0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=n0(e,null,t,1,n??null,s,!1,i,a),t[rr]=e.current,To(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new eu(e)};an.render=function(t,e,n){if(!tu(e))throw Error(H(200));return nu(null,t,e,!1,n)};an.unmountComponentAtNode=function(t){if(!tu(t))throw Error(H(40));return t._reactRootContainer?(ms(function(){nu(null,null,t,!1,function(){t._reactRootContainer=null,t[rr]=null})}),!0):!1};an.unstable_batchedUpdates=_h;an.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!tu(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return nu(t,e,n,!1,r)};an.version="18.3.1-next-f1338f8080-20240426";function s0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s0)}catch(t){console.error(t)}}s0(),sg.exports=an;var k1=sg.exports,i0,qp=k1;i0=qp.createRoot,qp.hydrateRoot;var Gp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},R1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},a0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,p=i>>2,g=(i&3)<<4|l>>4;let y=(l&15)<<2|h>>6,E=h&63;u||(E=64,a||(y=64)),r.push(n[p],n[g],n[y],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(o0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):R1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||h==null||g==null)throw new P1;const y=i<<2|l>>4;if(r.push(y),h!==64){const E=l<<4&240|h>>2;if(r.push(E),g!==64){const A=h<<6&192|g;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class P1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const b1=function(t){const e=o0(t);return a0.encodeByteArray(e,!0)},l0=function(t){return b1(t).replace(/\./g,"")},D1=function(t){try{return a0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1=()=>N1().__FIREBASE_DEFAULTS__,V1=()=>{if(typeof process>"u"||typeof Gp>"u")return;const t=Gp.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},M1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&D1(t[1]);return e&&JSON.parse(e)},Ah=()=>{try{return j1()||V1()||M1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},L1=t=>{var e,n;return(n=(e=Ah())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},O1=t=>{const e=L1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},u0=()=>{var t;return(t=Ah())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function B1(){var t;const e=(t=Ah())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function U1(){return!B1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $1(){try{return typeof indexedDB=="object"}catch{return!1}}function W1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1="FirebaseError";class wi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=H1,Object.setPrototypeOf(this,wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,c0.prototype.create)}}class c0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?q1(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new wi(s,l,r)}}function q1(t,e){return t.replace(G1,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const G1=/\{\$([^}]+)}/g;function Rl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(Qp(i)&&Qp(a)){if(!Rl(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Qp(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kn(t){return t&&t._delegate?t._delegate:t}class di{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new F1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Y1(e))try{this.getOrInitializeService({instanceIdentifier:rs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=rs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=rs){return this.instances.has(e)}getOptions(e=rs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:K1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=rs){return this.component?this.component.multipleInstances?e:rs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function K1(t){return t===rs?void 0:t}function Y1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Q1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ye||(ye={}));const J1={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},Z1=ye.INFO,ew={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},tw=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=ew[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class d0{constructor(e){this.name=e,this._logLevel=Z1,this._logHandler=tw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?J1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}}const nw=(t,e)=>e.some(n=>t instanceof n);let Kp,Yp;function rw(){return Kp||(Kp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sw(){return Yp||(Yp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const h0=new WeakMap,od=new WeakMap,f0=new WeakMap,tc=new WeakMap,kh=new WeakMap;function iw(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Or(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&h0.set(n,t)}).catch(()=>{}),kh.set(e,t),e}function ow(t){if(od.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});od.set(t,e)}let ad={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return od.get(t);if(e==="objectStoreNames")return t.objectStoreNames||f0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Or(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function aw(t){ad=t(ad)}function lw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(nc(this),e,...n);return f0.set(r,e.sort?e.sort():[e]),Or(r)}:sw().includes(t)?function(...e){return t.apply(nc(this),e),Or(h0.get(this))}:function(...e){return Or(t.apply(nc(this),e))}}function uw(t){return typeof t=="function"?lw(t):(t instanceof IDBTransaction&&ow(t),nw(t,rw())?new Proxy(t,ad):t)}function Or(t){if(t instanceof IDBRequest)return iw(t);if(tc.has(t))return tc.get(t);const e=uw(t);return e!==t&&(tc.set(t,e),kh.set(e,t)),e}const nc=t=>kh.get(t);function cw(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=Or(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Or(a.result),u.oldVersion,u.newVersion,Or(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const dw=["get","getKey","getAll","getAllKeys","count"],hw=["put","add","delete","clear"],rc=new Map;function Xp(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(rc.get(e))return rc.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=hw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||dw.includes(n)))return;const i=async function(a,...l){const u=this.transaction(a,s?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),s&&u.done]))[0]};return rc.set(e,i),i}aw(t=>({...t,get:(e,n,r)=>Xp(e,n)||t.get(e,n,r),has:(e,n)=>!!Xp(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(pw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function pw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ld="@firebase/app",Jp="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const or=new d0("@firebase/app"),mw="@firebase/app-compat",gw="@firebase/analytics-compat",yw="@firebase/analytics",vw="@firebase/app-check-compat",_w="@firebase/app-check",xw="@firebase/auth",ww="@firebase/auth-compat",Sw="@firebase/database",Ew="@firebase/data-connect",Tw="@firebase/database-compat",Iw="@firebase/functions",Cw="@firebase/functions-compat",Aw="@firebase/installations",kw="@firebase/installations-compat",Rw="@firebase/messaging",Pw="@firebase/messaging-compat",bw="@firebase/performance",Dw="@firebase/performance-compat",Nw="@firebase/remote-config",jw="@firebase/remote-config-compat",Vw="@firebase/storage",Mw="@firebase/storage-compat",Lw="@firebase/firestore",Ow="@firebase/vertexai-preview",Fw="@firebase/firestore-compat",zw="firebase",Bw="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ud="[DEFAULT]",Uw={[ld]:"fire-core",[mw]:"fire-core-compat",[yw]:"fire-analytics",[gw]:"fire-analytics-compat",[_w]:"fire-app-check",[vw]:"fire-app-check-compat",[xw]:"fire-auth",[ww]:"fire-auth-compat",[Sw]:"fire-rtdb",[Ew]:"fire-data-connect",[Tw]:"fire-rtdb-compat",[Iw]:"fire-fn",[Cw]:"fire-fn-compat",[Aw]:"fire-iid",[kw]:"fire-iid-compat",[Rw]:"fire-fcm",[Pw]:"fire-fcm-compat",[bw]:"fire-perf",[Dw]:"fire-perf-compat",[Nw]:"fire-rc",[jw]:"fire-rc-compat",[Vw]:"fire-gcs",[Mw]:"fire-gcs-compat",[Lw]:"fire-fst",[Fw]:"fire-fst-compat",[Ow]:"fire-vertex","fire-js":"fire-js",[zw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pl=new Map,$w=new Map,cd=new Map;function Zp(t,e){try{t.container.addComponent(e)}catch(n){or.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function No(t){const e=t.name;if(cd.has(e))return or.debug(`There were multiple attempts to register component ${e}.`),!1;cd.set(e,t);for(const n of Pl.values())Zp(n,t);for(const n of $w.values())Zp(n,t);return!0}function p0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ww={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fr=new c0("app","Firebase",Ww);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new di("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw=Bw;function m0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ud,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Fr.create("bad-app-name",{appName:String(s)});if(n||(n=u0()),!n)throw Fr.create("no-options");const i=Pl.get(s);if(i){if(Rl(n,i.options)&&Rl(r,i.config))return i;throw Fr.create("duplicate-app",{appName:s})}const a=new X1(s);for(const u of cd.values())a.addComponent(u);const l=new Hw(n,r,a);return Pl.set(s,l),l}function Gw(t=ud){const e=Pl.get(t);if(!e&&t===ud&&u0())return m0();if(!e)throw Fr.create("no-app",{appName:t});return e}function zr(t,e,n){var r;let s=(r=Uw[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),or.warn(l.join(" "));return}No(new di(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw="firebase-heartbeat-database",Kw=1,jo="firebase-heartbeat-store";let sc=null;function g0(){return sc||(sc=cw(Qw,Kw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(jo)}catch(n){console.warn(n)}}}}).catch(t=>{throw Fr.create("idb-open",{originalErrorMessage:t.message})})),sc}async function Yw(t){try{const n=(await g0()).transaction(jo),r=await n.objectStore(jo).get(y0(t));return await n.done,r}catch(e){if(e instanceof wi)or.warn(e.message);else{const n=Fr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});or.warn(n.message)}}}async function em(t,e){try{const r=(await g0()).transaction(jo,"readwrite");await r.objectStore(jo).put(e,y0(t)),await r.done}catch(n){if(n instanceof wi)or.warn(n.message);else{const r=Fr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});or.warn(r.message)}}}function y0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw=1024,Jw=30*24*60*60*1e3;class Zw{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new tS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=tm();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=Jw}),this._storage.overwrite(this._heartbeatsCache))}catch(r){or.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=tm(),{heartbeatsToSend:r,unsentEntries:s}=eS(this._heartbeatsCache.heartbeats),i=l0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return or.warn(n),""}}}function tm(){return new Date().toISOString().substring(0,10)}function eS(t,e=Xw){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),nm(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),nm(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class tS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $1()?W1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Yw(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return em(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return em(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function nm(t){return l0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(t){No(new di("platform-logger",e=>new fw(e),"PRIVATE")),No(new di("heartbeat",e=>new Zw(e),"PRIVATE")),zr(ld,Jp,t),zr(ld,Jp,"esm2017"),zr("fire-js","")}nS("");var rS="firebase",sS="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zr(rS,sS,"app");var rm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var cs,v0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(v,m){function x(){}x.prototype=m.prototype,v.D=m.prototype,v.prototype=new x,v.prototype.constructor=v,v.C=function(w,k,R){for(var T=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)T[oe-2]=arguments[oe];return m.prototype[k].apply(w,T)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(v,m,x){x||(x=0);var w=Array(16);if(typeof m=="string")for(var k=0;16>k;++k)w[k]=m.charCodeAt(x++)|m.charCodeAt(x++)<<8|m.charCodeAt(x++)<<16|m.charCodeAt(x++)<<24;else for(k=0;16>k;++k)w[k]=m[x++]|m[x++]<<8|m[x++]<<16|m[x++]<<24;m=v.g[0],x=v.g[1],k=v.g[2];var R=v.g[3],T=m+(R^x&(k^R))+w[0]+3614090360&4294967295;m=x+(T<<7&4294967295|T>>>25),T=R+(k^m&(x^k))+w[1]+3905402710&4294967295,R=m+(T<<12&4294967295|T>>>20),T=k+(x^R&(m^x))+w[2]+606105819&4294967295,k=R+(T<<17&4294967295|T>>>15),T=x+(m^k&(R^m))+w[3]+3250441966&4294967295,x=k+(T<<22&4294967295|T>>>10),T=m+(R^x&(k^R))+w[4]+4118548399&4294967295,m=x+(T<<7&4294967295|T>>>25),T=R+(k^m&(x^k))+w[5]+1200080426&4294967295,R=m+(T<<12&4294967295|T>>>20),T=k+(x^R&(m^x))+w[6]+2821735955&4294967295,k=R+(T<<17&4294967295|T>>>15),T=x+(m^k&(R^m))+w[7]+4249261313&4294967295,x=k+(T<<22&4294967295|T>>>10),T=m+(R^x&(k^R))+w[8]+1770035416&4294967295,m=x+(T<<7&4294967295|T>>>25),T=R+(k^m&(x^k))+w[9]+2336552879&4294967295,R=m+(T<<12&4294967295|T>>>20),T=k+(x^R&(m^x))+w[10]+4294925233&4294967295,k=R+(T<<17&4294967295|T>>>15),T=x+(m^k&(R^m))+w[11]+2304563134&4294967295,x=k+(T<<22&4294967295|T>>>10),T=m+(R^x&(k^R))+w[12]+1804603682&4294967295,m=x+(T<<7&4294967295|T>>>25),T=R+(k^m&(x^k))+w[13]+4254626195&4294967295,R=m+(T<<12&4294967295|T>>>20),T=k+(x^R&(m^x))+w[14]+2792965006&4294967295,k=R+(T<<17&4294967295|T>>>15),T=x+(m^k&(R^m))+w[15]+1236535329&4294967295,x=k+(T<<22&4294967295|T>>>10),T=m+(k^R&(x^k))+w[1]+4129170786&4294967295,m=x+(T<<5&4294967295|T>>>27),T=R+(x^k&(m^x))+w[6]+3225465664&4294967295,R=m+(T<<9&4294967295|T>>>23),T=k+(m^x&(R^m))+w[11]+643717713&4294967295,k=R+(T<<14&4294967295|T>>>18),T=x+(R^m&(k^R))+w[0]+3921069994&4294967295,x=k+(T<<20&4294967295|T>>>12),T=m+(k^R&(x^k))+w[5]+3593408605&4294967295,m=x+(T<<5&4294967295|T>>>27),T=R+(x^k&(m^x))+w[10]+38016083&4294967295,R=m+(T<<9&4294967295|T>>>23),T=k+(m^x&(R^m))+w[15]+3634488961&4294967295,k=R+(T<<14&4294967295|T>>>18),T=x+(R^m&(k^R))+w[4]+3889429448&4294967295,x=k+(T<<20&4294967295|T>>>12),T=m+(k^R&(x^k))+w[9]+568446438&4294967295,m=x+(T<<5&4294967295|T>>>27),T=R+(x^k&(m^x))+w[14]+3275163606&4294967295,R=m+(T<<9&4294967295|T>>>23),T=k+(m^x&(R^m))+w[3]+4107603335&4294967295,k=R+(T<<14&4294967295|T>>>18),T=x+(R^m&(k^R))+w[8]+1163531501&4294967295,x=k+(T<<20&4294967295|T>>>12),T=m+(k^R&(x^k))+w[13]+2850285829&4294967295,m=x+(T<<5&4294967295|T>>>27),T=R+(x^k&(m^x))+w[2]+4243563512&4294967295,R=m+(T<<9&4294967295|T>>>23),T=k+(m^x&(R^m))+w[7]+1735328473&4294967295,k=R+(T<<14&4294967295|T>>>18),T=x+(R^m&(k^R))+w[12]+2368359562&4294967295,x=k+(T<<20&4294967295|T>>>12),T=m+(x^k^R)+w[5]+4294588738&4294967295,m=x+(T<<4&4294967295|T>>>28),T=R+(m^x^k)+w[8]+2272392833&4294967295,R=m+(T<<11&4294967295|T>>>21),T=k+(R^m^x)+w[11]+1839030562&4294967295,k=R+(T<<16&4294967295|T>>>16),T=x+(k^R^m)+w[14]+4259657740&4294967295,x=k+(T<<23&4294967295|T>>>9),T=m+(x^k^R)+w[1]+2763975236&4294967295,m=x+(T<<4&4294967295|T>>>28),T=R+(m^x^k)+w[4]+1272893353&4294967295,R=m+(T<<11&4294967295|T>>>21),T=k+(R^m^x)+w[7]+4139469664&4294967295,k=R+(T<<16&4294967295|T>>>16),T=x+(k^R^m)+w[10]+3200236656&4294967295,x=k+(T<<23&4294967295|T>>>9),T=m+(x^k^R)+w[13]+681279174&4294967295,m=x+(T<<4&4294967295|T>>>28),T=R+(m^x^k)+w[0]+3936430074&4294967295,R=m+(T<<11&4294967295|T>>>21),T=k+(R^m^x)+w[3]+3572445317&4294967295,k=R+(T<<16&4294967295|T>>>16),T=x+(k^R^m)+w[6]+76029189&4294967295,x=k+(T<<23&4294967295|T>>>9),T=m+(x^k^R)+w[9]+3654602809&4294967295,m=x+(T<<4&4294967295|T>>>28),T=R+(m^x^k)+w[12]+3873151461&4294967295,R=m+(T<<11&4294967295|T>>>21),T=k+(R^m^x)+w[15]+530742520&4294967295,k=R+(T<<16&4294967295|T>>>16),T=x+(k^R^m)+w[2]+3299628645&4294967295,x=k+(T<<23&4294967295|T>>>9),T=m+(k^(x|~R))+w[0]+4096336452&4294967295,m=x+(T<<6&4294967295|T>>>26),T=R+(x^(m|~k))+w[7]+1126891415&4294967295,R=m+(T<<10&4294967295|T>>>22),T=k+(m^(R|~x))+w[14]+2878612391&4294967295,k=R+(T<<15&4294967295|T>>>17),T=x+(R^(k|~m))+w[5]+4237533241&4294967295,x=k+(T<<21&4294967295|T>>>11),T=m+(k^(x|~R))+w[12]+1700485571&4294967295,m=x+(T<<6&4294967295|T>>>26),T=R+(x^(m|~k))+w[3]+2399980690&4294967295,R=m+(T<<10&4294967295|T>>>22),T=k+(m^(R|~x))+w[10]+4293915773&4294967295,k=R+(T<<15&4294967295|T>>>17),T=x+(R^(k|~m))+w[1]+2240044497&4294967295,x=k+(T<<21&4294967295|T>>>11),T=m+(k^(x|~R))+w[8]+1873313359&4294967295,m=x+(T<<6&4294967295|T>>>26),T=R+(x^(m|~k))+w[15]+4264355552&4294967295,R=m+(T<<10&4294967295|T>>>22),T=k+(m^(R|~x))+w[6]+2734768916&4294967295,k=R+(T<<15&4294967295|T>>>17),T=x+(R^(k|~m))+w[13]+1309151649&4294967295,x=k+(T<<21&4294967295|T>>>11),T=m+(k^(x|~R))+w[4]+4149444226&4294967295,m=x+(T<<6&4294967295|T>>>26),T=R+(x^(m|~k))+w[11]+3174756917&4294967295,R=m+(T<<10&4294967295|T>>>22),T=k+(m^(R|~x))+w[2]+718787259&4294967295,k=R+(T<<15&4294967295|T>>>17),T=x+(R^(k|~m))+w[9]+3951481745&4294967295,v.g[0]=v.g[0]+m&4294967295,v.g[1]=v.g[1]+(k+(T<<21&4294967295|T>>>11))&4294967295,v.g[2]=v.g[2]+k&4294967295,v.g[3]=v.g[3]+R&4294967295}r.prototype.u=function(v,m){m===void 0&&(m=v.length);for(var x=m-this.blockSize,w=this.B,k=this.h,R=0;R<m;){if(k==0)for(;R<=x;)s(this,v,R),R+=this.blockSize;if(typeof v=="string"){for(;R<m;)if(w[k++]=v.charCodeAt(R++),k==this.blockSize){s(this,w),k=0;break}}else for(;R<m;)if(w[k++]=v[R++],k==this.blockSize){s(this,w),k=0;break}}this.h=k,this.o+=m},r.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var m=1;m<v.length-8;++m)v[m]=0;var x=8*this.o;for(m=v.length-8;m<v.length;++m)v[m]=x&255,x/=256;for(this.u(v),v=Array(16),m=x=0;4>m;++m)for(var w=0;32>w;w+=8)v[x++]=this.g[m]>>>w&255;return v};function i(v,m){var x=l;return Object.prototype.hasOwnProperty.call(x,v)?x[v]:x[v]=m(v)}function a(v,m){this.h=m;for(var x=[],w=!0,k=v.length-1;0<=k;k--){var R=v[k]|0;w&&R==m||(x[k]=R,w=!1)}this.g=x}var l={};function u(v){return-128<=v&&128>v?i(v,function(m){return new a([m|0],0>m?-1:0)}):new a([v|0],0>v?-1:0)}function h(v){if(isNaN(v)||!isFinite(v))return g;if(0>v)return F(h(-v));for(var m=[],x=1,w=0;v>=x;w++)m[w]=v/x|0,x*=4294967296;return new a(m,0)}function p(v,m){if(v.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(v.charAt(0)=="-")return F(p(v.substring(1),m));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var x=h(Math.pow(m,8)),w=g,k=0;k<v.length;k+=8){var R=Math.min(8,v.length-k),T=parseInt(v.substring(k,k+R),m);8>R?(R=h(Math.pow(m,R)),w=w.j(R).add(h(T))):(w=w.j(x),w=w.add(h(T)))}return w}var g=u(0),y=u(1),E=u(16777216);t=a.prototype,t.m=function(){if(P(this))return-F(this).m();for(var v=0,m=1,x=0;x<this.g.length;x++){var w=this.i(x);v+=(0<=w?w:4294967296+w)*m,m*=4294967296}return v},t.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(A(this))return"0";if(P(this))return"-"+F(this).toString(v);for(var m=h(Math.pow(v,6)),x=this,w="";;){var k=V(x,m).g;x=I(x,k.j(m));var R=((0<x.g.length?x.g[0]:x.h)>>>0).toString(v);if(x=k,A(x))return R+w;for(;6>R.length;)R="0"+R;w=R+w}},t.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function A(v){if(v.h!=0)return!1;for(var m=0;m<v.g.length;m++)if(v.g[m]!=0)return!1;return!0}function P(v){return v.h==-1}t.l=function(v){return v=I(this,v),P(v)?-1:A(v)?0:1};function F(v){for(var m=v.g.length,x=[],w=0;w<m;w++)x[w]=~v.g[w];return new a(x,~v.h).add(y)}t.abs=function(){return P(this)?F(this):this},t.add=function(v){for(var m=Math.max(this.g.length,v.g.length),x=[],w=0,k=0;k<=m;k++){var R=w+(this.i(k)&65535)+(v.i(k)&65535),T=(R>>>16)+(this.i(k)>>>16)+(v.i(k)>>>16);w=T>>>16,R&=65535,T&=65535,x[k]=T<<16|R}return new a(x,x[x.length-1]&-2147483648?-1:0)};function I(v,m){return v.add(F(m))}t.j=function(v){if(A(this)||A(v))return g;if(P(this))return P(v)?F(this).j(F(v)):F(F(this).j(v));if(P(v))return F(this.j(F(v)));if(0>this.l(E)&&0>v.l(E))return h(this.m()*v.m());for(var m=this.g.length+v.g.length,x=[],w=0;w<2*m;w++)x[w]=0;for(w=0;w<this.g.length;w++)for(var k=0;k<v.g.length;k++){var R=this.i(w)>>>16,T=this.i(w)&65535,oe=v.i(k)>>>16,re=v.i(k)&65535;x[2*w+2*k]+=T*re,S(x,2*w+2*k),x[2*w+2*k+1]+=R*re,S(x,2*w+2*k+1),x[2*w+2*k+1]+=T*oe,S(x,2*w+2*k+1),x[2*w+2*k+2]+=R*oe,S(x,2*w+2*k+2)}for(w=0;w<m;w++)x[w]=x[2*w+1]<<16|x[2*w];for(w=m;w<2*m;w++)x[w]=0;return new a(x,0)};function S(v,m){for(;(v[m]&65535)!=v[m];)v[m+1]+=v[m]>>>16,v[m]&=65535,m++}function C(v,m){this.g=v,this.h=m}function V(v,m){if(A(m))throw Error("division by zero");if(A(v))return new C(g,g);if(P(v))return m=V(F(v),m),new C(F(m.g),F(m.h));if(P(m))return m=V(v,F(m)),new C(F(m.g),m.h);if(30<v.g.length){if(P(v)||P(m))throw Error("slowDivide_ only works with positive integers.");for(var x=y,w=m;0>=w.l(v);)x=L(x),w=L(w);var k=M(x,1),R=M(w,1);for(w=M(w,2),x=M(x,2);!A(w);){var T=R.add(w);0>=T.l(v)&&(k=k.add(x),R=T),w=M(w,1),x=M(x,1)}return m=I(v,k.j(m)),new C(k,m)}for(k=g;0<=v.l(m);){for(x=Math.max(1,Math.floor(v.m()/m.m())),w=Math.ceil(Math.log(x)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),R=h(x),T=R.j(m);P(T)||0<T.l(v);)x-=w,R=h(x),T=R.j(m);A(R)&&(R=y),k=k.add(R),v=I(v,T)}return new C(k,v)}t.A=function(v){return V(this,v).h},t.and=function(v){for(var m=Math.max(this.g.length,v.g.length),x=[],w=0;w<m;w++)x[w]=this.i(w)&v.i(w);return new a(x,this.h&v.h)},t.or=function(v){for(var m=Math.max(this.g.length,v.g.length),x=[],w=0;w<m;w++)x[w]=this.i(w)|v.i(w);return new a(x,this.h|v.h)},t.xor=function(v){for(var m=Math.max(this.g.length,v.g.length),x=[],w=0;w<m;w++)x[w]=this.i(w)^v.i(w);return new a(x,this.h^v.h)};function L(v){for(var m=v.g.length+1,x=[],w=0;w<m;w++)x[w]=v.i(w)<<1|v.i(w-1)>>>31;return new a(x,v.h)}function M(v,m){var x=m>>5;m%=32;for(var w=v.g.length-x,k=[],R=0;R<w;R++)k[R]=0<m?v.i(R+x)>>>m|v.i(R+x+1)<<32-m:v.i(R+x);return new a(k,v.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,v0=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,cs=a}).apply(typeof rm<"u"?rm:typeof self<"u"?self:typeof window<"u"?window:{});var Oa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _0,Ji,x0,el,dd,w0,S0,E0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,f){return o==Array.prototype||o==Object.prototype||(o[c]=f.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Oa=="object"&&Oa];for(var c=0;c<o.length;++c){var f=o[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(o,c){if(c)e:{var f=r;o=o.split(".");for(var _=0;_<o.length-1;_++){var b=o[_];if(!(b in f))break e;f=f[b]}o=o[o.length-1],_=f[o],c=c(_),c!=_&&c!=null&&e(f,o,{configurable:!0,writable:!0,value:c})}}function i(o,c){o instanceof String&&(o+="");var f=0,_=!1,b={next:function(){if(!_&&f<o.length){var j=f++;return{value:c(j,o[j]),done:!1}}return _=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}s("Array.prototype.values",function(o){return o||function(){return i(this,function(c,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function h(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function p(o,c,f){return o.call.apply(o.bind,arguments)}function g(o,c,f){if(!o)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,_),o.apply(c,b)}}return function(){return o.apply(c,arguments)}}function y(o,c,f){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,y.apply(null,arguments)}function E(o,c){var f=Array.prototype.slice.call(arguments,1);return function(){var _=f.slice();return _.push.apply(_,arguments),o.apply(this,_)}}function A(o,c){function f(){}f.prototype=c.prototype,o.aa=c.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(_,b,j){for(var Q=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)Q[Ae-2]=arguments[Ae];return c.prototype[b].apply(_,Q)}}function P(o){const c=o.length;if(0<c){const f=Array(c);for(let _=0;_<c;_++)f[_]=o[_];return f}return[]}function F(o,c){for(let f=1;f<arguments.length;f++){const _=arguments[f];if(u(_)){const b=o.length||0,j=_.length||0;o.length=b+j;for(let Q=0;Q<j;Q++)o[b+Q]=_[Q]}else o.push(_)}}class I{constructor(c,f){this.i=c,this.j=f,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function S(o){return/^[\s\xa0]*$/.test(o)}function C(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function V(o){return V[" "](o),o}V[" "]=function(){};var L=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function M(o,c,f){for(const _ in o)c.call(f,o[_],_,o)}function v(o,c){for(const f in o)c.call(void 0,o[f],f,o)}function m(o){const c={};for(const f in o)c[f]=o[f];return c}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(o,c){let f,_;for(let b=1;b<arguments.length;b++){_=arguments[b];for(f in _)o[f]=_[f];for(let j=0;j<x.length;j++)f=x[j],Object.prototype.hasOwnProperty.call(_,f)&&(o[f]=_[f])}}function k(o){var c=1;o=o.split(":");const f=[];for(;0<c&&o.length;)f.push(o.shift()),c--;return o.length&&f.push(o.join(":")),f}function R(o){l.setTimeout(()=>{throw o},0)}function T(){var o=O;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class oe{constructor(){this.h=this.g=null}add(c,f){const _=re.get();_.set(c,f),this.h?this.h.next=_:this.g=_,this.h=_}}var re=new I(()=>new ie,o=>o.reset());class ie{constructor(){this.next=this.g=this.h=null}set(c,f){this.h=c,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let $,N=!1,O=new oe,G=()=>{const o=l.Promise.resolve(void 0);$=()=>{o.then(ee)}};var ee=()=>{for(var o;o=T();){try{o.h.call(o.g)}catch(f){R(f)}var c=re;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}N=!1};function te(){this.s=this.s,this.C=this.C}te.prototype.s=!1,te.prototype.ma=function(){this.s||(this.s=!0,this.N())},te.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function le(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}le.prototype.h=function(){this.defaultPrevented=!0};var ke=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};l.addEventListener("test",f,c),l.removeEventListener("test",f,c)}catch{}return o}();function we(o,c){if(le.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,_=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(L){e:{try{V(c.nodeName);var b=!0;break e}catch{}b=!1}b||(c=null)}}else f=="mouseover"?c=o.fromElement:f=="mouseout"&&(c=o.toElement);this.relatedTarget=c,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:fe[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&we.aa.h.call(this)}}A(we,le);var fe={2:"touch",3:"pen",4:"mouse"};we.prototype.h=function(){we.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),Fe=0;function Se(o,c,f,_,b){this.listener=o,this.proxy=null,this.src=c,this.type=f,this.capture=!!_,this.ha=b,this.key=++Fe,this.da=this.fa=!1}function ne(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Ce(o){this.src=o,this.g={},this.h=0}Ce.prototype.add=function(o,c,f,_,b){var j=o.toString();o=this.g[j],o||(o=this.g[j]=[],this.h++);var Q=Re(o,c,_,b);return-1<Q?(c=o[Q],f||(c.fa=!1)):(c=new Se(c,this.src,j,!!_,b),c.fa=f,o.push(c)),c};function ze(o,c){var f=c.type;if(f in o.g){var _=o.g[f],b=Array.prototype.indexOf.call(_,c,void 0),j;(j=0<=b)&&Array.prototype.splice.call(_,b,1),j&&(ne(c),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Re(o,c,f,_){for(var b=0;b<o.length;++b){var j=o[b];if(!j.da&&j.listener==c&&j.capture==!!f&&j.ha==_)return b}return-1}var Et="closure_lm_"+(1e6*Math.random()|0),Kt={};function Yt(o,c,f,_,b){if(Array.isArray(c)){for(var j=0;j<c.length;j++)Yt(o,c[j],f,_,b);return null}return f=ra(f),o&&o[de]?o.K(c,f,h(_)?!!_.capture:!1,b):Xt(o,c,f,!1,_,b)}function Xt(o,c,f,_,b,j){if(!c)throw Error("Invalid event type");var Q=h(b)?!!b.capture:!!b,Ae=Pe(o);if(Ae||(o[Et]=Ae=new Ce(o)),f=Ae.add(c,f,_,Q,j),f.proxy)return f;if(_=Jt(),f.proxy=_,_.src=o,_.listener=f,o.addEventListener)ke||(b=Q),b===void 0&&(b=!1),o.addEventListener(c.toString(),_,b);else if(o.attachEvent)o.attachEvent(Pn(c.toString()),_);else if(o.addListener&&o.removeListener)o.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Jt(){function o(f){return c.call(o.src,o.listener,f)}const c=fr;return o}function dr(o,c,f,_,b){if(Array.isArray(c))for(var j=0;j<c.length;j++)dr(o,c[j],f,_,b);else _=h(_)?!!_.capture:!!_,f=ra(f),o&&o[de]?(o=o.i,c=String(c).toString(),c in o.g&&(j=o.g[c],f=Re(j,f,_,b),-1<f&&(ne(j[f]),Array.prototype.splice.call(j,f,1),j.length==0&&(delete o.g[c],o.h--)))):o&&(o=Pe(o))&&(c=o.g[c.toString()],o=-1,c&&(o=Re(c,f,_,b)),(f=-1<o?c[o]:null)&&hr(f))}function hr(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[de])ze(c.i,o);else{var f=o.type,_=o.proxy;c.removeEventListener?c.removeEventListener(f,_,o.capture):c.detachEvent?c.detachEvent(Pn(f),_):c.addListener&&c.removeListener&&c.removeListener(_),(f=Pe(c))?(ze(f,o),f.h==0&&(f.src=null,c[Et]=null)):ne(o)}}}function Pn(o){return o in Kt?Kt[o]:Kt[o]="on"+o}function fr(o,c){if(o.da)o=!0;else{c=new we(c,this);var f=o.listener,_=o.ha||o.src;o.fa&&hr(o),o=f.call(_,c)}return o}function Pe(o){return o=o[Et],o instanceof Ce?o:null}var Ai="__closure_events_fn_"+(1e9*Math.random()>>>0);function ra(o){return typeof o=="function"?o:(o[Ai]||(o[Ai]=function(c){return o.handleEvent(c)}),o[Ai])}function st(){te.call(this),this.i=new Ce(this),this.M=this,this.F=null}A(st,te),st.prototype[de]=!0,st.prototype.removeEventListener=function(o,c,f,_){dr(this,o,c,f,_)};function Je(o,c){var f,_=o.F;if(_)for(f=[];_;_=_.F)f.push(_);if(o=o.M,_=c.type||c,typeof c=="string")c=new le(c,o);else if(c instanceof le)c.target=c.target||o;else{var b=c;c=new le(_,o),w(c,b)}if(b=!0,f)for(var j=f.length-1;0<=j;j--){var Q=c.g=f[j];b=pr(Q,_,!0,c)&&b}if(Q=c.g=o,b=pr(Q,_,!0,c)&&b,b=pr(Q,_,!1,c)&&b,f)for(j=0;j<f.length;j++)Q=c.g=f[j],b=pr(Q,_,!1,c)&&b}st.prototype.N=function(){if(st.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var f=o.g[c],_=0;_<f.length;_++)ne(f[_]);delete o.g[c],o.h--}}this.F=null},st.prototype.K=function(o,c,f,_){return this.i.add(String(o),c,!1,f,_)},st.prototype.L=function(o,c,f,_){return this.i.add(String(o),c,!0,f,_)};function pr(o,c,f,_){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var b=!0,j=0;j<c.length;++j){var Q=c[j];if(Q&&!Q.da&&Q.capture==f){var Ae=Q.listener,mt=Q.ha||Q.src;Q.fa&&ze(o.i,Q),b=Ae.call(mt,_)!==!1&&b}}return b&&!_.defaultPrevented}function Xr(o,c,f){if(typeof o=="function")f&&(o=y(o,f));else if(o&&typeof o.handleEvent=="function")o=y(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(o,c||0)}function ki(o){o.g=Xr(()=>{o.g=null,o.i&&(o.i=!1,ki(o))},o.l);const c=o.h;o.h=null,o.m.apply(null,c)}class Ie extends te{constructor(c,f){super(),this.m=c,this.l=f,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:ki(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zt(o){te.call(this),this.h=o,this.g={}}A(Zt,te);var Jr=[];function Es(o){M(o.g,function(c,f){this.g.hasOwnProperty(f)&&hr(c)},o),o.g={}}Zt.prototype.N=function(){Zt.aa.N.call(this),Es(this)},Zt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var sa=l.JSON.stringify,ia=l.JSON.parse,hf=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function Ts(){}Ts.prototype.h=null;function Be(o){return o.h||(o.h=o.i())}function oa(){}var Ft={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function zn(){le.call(this,"d")}A(zn,le);function Bn(){le.call(this,"c")}A(Bn,le);var gn={},aa=null;function Is(){return aa=aa||new st}gn.La="serverreachability";function vu(o){le.call(this,gn.La,o)}A(vu,le);function Cs(o){const c=Is();Je(c,new vu(c))}gn.STAT_EVENT="statevent";function la(o,c){le.call(this,gn.STAT_EVENT,o),this.stat=c}A(la,le);function it(o){const c=Is();Je(c,new la(c,o))}gn.Ma="timingevent";function ua(o,c){le.call(this,gn.Ma,o),this.size=c}A(ua,le);function Un(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},c)}function $n(){this.g=!0}$n.prototype.xa=function(){this.g=!1};function _u(o,c,f,_,b,j){o.info(function(){if(o.g)if(j)for(var Q="",Ae=j.split("&"),mt=0;mt<Ae.length;mt++){var _e=Ae[mt].split("=");if(1<_e.length){var Tt=_e[0];_e=_e[1];var It=Tt.split("_");Q=2<=It.length&&It[1]=="type"?Q+(Tt+"="+_e+"&"):Q+(Tt+"=redacted&")}}else Q=null;else Q=j;return"XMLHTTP REQ ("+_+") [attempt "+b+"]: "+c+`
`+f+`
`+Q})}function xu(o,c,f,_,b,j,Q){o.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+b+"]: "+c+`
`+f+`
`+j+" "+Q})}function mr(o,c,f,_){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+Zr(o,f)+(_?" "+_:"")})}function Ri(o,c){o.info(function(){return"TIMEOUT: "+c})}$n.prototype.info=function(){};function Zr(o,c){if(!o.g)return c;if(!c)return null;try{var f=JSON.parse(c);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var _=f[o];if(!(2>_.length)){var b=_[1];if(Array.isArray(b)&&!(1>b.length)){var j=b[0];if(j!="noop"&&j!="stop"&&j!="close")for(var Q=1;Q<b.length;Q++)b[Q]=""}}}}return sa(f)}catch{return c}}var gr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pi={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},bi;function As(){}A(As,Ts),As.prototype.g=function(){return new XMLHttpRequest},As.prototype.i=function(){return{}},bi=new As;function zt(o,c,f,_){this.j=o,this.i=c,this.l=f,this.R=_||1,this.U=new Zt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new yr}function yr(){this.i=null,this.g="",this.h=!1}var ca={},ks={};function Rs(o,c,f){o.L=1,o.v=Le(Ne(c)),o.m=f,o.P=!0,Di(o,null)}function Di(o,c){o.F=Date.now(),vr(o),o.A=Ne(o.v);var f=o.A,_=o.R;Array.isArray(_)||(_=[String(_)]),gf(f.i,"t",_),o.C=0,f=o.j.J,o.h=new yr,o.g=jf(o.j,f?c:null,!o.m),0<o.O&&(o.M=new Ie(y(o.Y,o,o.g),o.O)),c=o.U,f=o.g,_=o.ca;var b="readystatechange";Array.isArray(b)||(b&&(Jr[0]=b.toString()),b=Jr);for(var j=0;j<b.length;j++){var Q=Yt(f,b[j],_||c.handleEvent,!1,c.h||c);if(!Q)break;c.g[Q.key]=Q}c=o.H?m(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),Cs(),_u(o.i,o.u,o.A,o.l,o.R,o.m)}zt.prototype.ca=function(o){o=o.target;const c=this.M;c&&qn(o)==3?c.j():this.Y(o)},zt.prototype.Y=function(o){try{if(o==this.g)e:{const It=qn(this.g);var c=this.g.Ba();const js=this.g.Z();if(!(3>It)&&(It!=3||this.g&&(this.h.h||this.g.oa()||Ef(this.g)))){this.J||It!=4||c==7||(c==8||0>=js?Cs(3):Cs(2)),un(this);var f=this.g.Z();this.X=f;t:if(da(this)){var _=Ef(this.g);o="";var b=_.length,j=qn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Wn(this),bn(this);var Q="";break t}this.h.i=new l.TextDecoder}for(c=0;c<b;c++)this.h.h=!0,o+=this.h.i.decode(_[c],{stream:!(j&&c==b-1)});_.length=0,this.h.g+=o,this.C=0,Q=this.h.g}else Q=this.g.oa();if(this.o=f==200,xu(this.i,this.u,this.A,this.l,this.R,It,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ae,mt=this.g;if((Ae=mt.g?mt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(Ae)){var _e=Ae;break t}}_e=null}if(f=_e)mr(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,yn(this,f);else{this.o=!1,this.s=3,it(12),Wn(this),bn(this);break e}}if(this.P){f=!0;let vn;for(;!this.J&&this.C<Q.length;)if(vn=wu(this,Q),vn==ks){It==4&&(this.s=4,it(14),f=!1),mr(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==ca){this.s=4,it(15),mr(this.i,this.l,Q,"[Invalid Chunk]"),f=!1;break}else mr(this.i,this.l,vn,null),yn(this,vn);if(da(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),It!=4||Q.length!=0||this.h.h||(this.s=1,it(16),f=!1),this.o=this.o&&f,!f)mr(this.i,this.l,Q,"[Invalid Chunked Response]"),Wn(this),bn(this);else if(0<Q.length&&!this.W){this.W=!0;var Tt=this.j;Tt.g==this&&Tt.ba&&!Tt.M&&(Tt.j.info("Great, no buffering proxy detected. Bytes received: "+Q.length),Au(Tt),Tt.M=!0,it(11))}}else mr(this.i,this.l,Q,null),yn(this,Q);It==4&&Wn(this),this.o&&!this.J&&(It==4?Pf(this.j,this):(this.o=!1,vr(this)))}else t_(this.g),f==400&&0<Q.indexOf("Unknown SID")?(this.s=3,it(12)):(this.s=0,it(13)),Wn(this),bn(this)}}}catch{}finally{}};function da(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function wu(o,c){var f=o.C,_=c.indexOf(`
`,f);return _==-1?ks:(f=Number(c.substring(f,_)),isNaN(f)?ca:(_+=1,_+f>c.length?ks:(c=c.slice(_,_+f),o.C=_+f,c)))}zt.prototype.cancel=function(){this.J=!0,Wn(this)};function vr(o){o.S=Date.now()+o.I,Ps(o,o.I)}function Ps(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Un(y(o.ba,o),c)}function un(o){o.B&&(l.clearTimeout(o.B),o.B=null)}zt.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(Ri(this.i,this.A),this.L!=2&&(Cs(),it(17)),Wn(this),this.s=2,bn(this)):Ps(this,this.S-o)};function bn(o){o.j.G==0||o.J||Pf(o.j,o)}function Wn(o){un(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,Es(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function yn(o,c){try{var f=o.j;if(f.G!=0&&(f.g==o||B(f.h,o))){if(!o.K&&B(f.h,o)&&f.G==3){try{var _=f.Da.g.parse(c)}catch{_=null}if(Array.isArray(_)&&_.length==3){var b=_;if(b[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)va(f),ga(f);else break e;Cu(f),it(18)}}else f.za=b[1],0<f.za-f.T&&37500>b[2]&&f.F&&f.v==0&&!f.C&&(f.C=Un(y(f.Za,f),6e3));if(1>=q(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else es(f,11)}else if((o.K||f.g==o)&&va(f),!S(c))for(b=f.Da.g.parse(c),c=0;c<b.length;c++){let _e=b[c];if(f.T=_e[0],_e=_e[1],f.G==2)if(_e[0]=="c"){f.K=_e[1],f.ia=_e[2];const Tt=_e[3];Tt!=null&&(f.la=Tt,f.j.info("VER="+f.la));const It=_e[4];It!=null&&(f.Aa=It,f.j.info("SVER="+f.Aa));const js=_e[5];js!=null&&typeof js=="number"&&0<js&&(_=1.5*js,f.L=_,f.j.info("backChannelRequestTimeoutMs_="+_)),_=f;const vn=o.g;if(vn){const xa=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xa){var j=_.h;j.g||xa.indexOf("spdy")==-1&&xa.indexOf("quic")==-1&&xa.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(W(j,j.h),j.h=null))}if(_.D){const ku=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;ku&&(_.ya=ku,Y(_.I,_.D,ku))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),_=f;var Q=o;if(_.qa=Nf(_,_.J?_.ia:null,_.W),Q.K){K(_.h,Q);var Ae=Q,mt=_.L;mt&&(Ae.I=mt),Ae.B&&(un(Ae),vr(Ae)),_.g=Q}else kf(_);0<f.i.length&&ya(f)}else _e[0]!="stop"&&_e[0]!="close"||es(f,7);else f.G==3&&(_e[0]=="stop"||_e[0]=="close"?_e[0]=="stop"?es(f,7):Iu(f):_e[0]!="noop"&&f.l&&f.l.ta(_e),f.v=0)}}Cs(4)}catch{}}var Su=class{constructor(o,c){this.g=o,this.map=c}};function ha(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ni(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function q(o){return o.h?1:o.g?o.g.size:0}function B(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function W(o,c){o.g?o.g.add(c):o.h=c}function K(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}ha.prototype.cancel=function(){if(this.i=he(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function he(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(const f of o.g.values())c=c.concat(f.D);return c}return P(o.i)}function qe(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var c=[],f=o.length,_=0;_<f;_++)c.push(o[_]);return c}c=[],f=0;for(_ in o)c[f++]=o[_];return c}function De(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var c=[];o=o.length;for(var f=0;f<o;f++)c.push(f);return c}c=[],f=0;for(const _ in o)c[f++]=_;return c}}}function Ke(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var f=De(o),_=qe(o),b=_.length,j=0;j<b;j++)c.call(void 0,_[j],f&&f[j],o)}var ht=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Bt(o,c){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var _=o[f].indexOf("="),b=null;if(0<=_){var j=o[f].substring(0,_);b=o[f].substring(_+1)}else j=o[f];c(j,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function ft(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof ft){this.h=o.h,_r(this,o.j),this.o=o.o,this.g=o.g,Nt(this,o.s),this.l=o.l;var c=o.i,f=new ji;f.i=c.i,c.g&&(f.g=new Map(c.g),f.h=c.h),bs(this,f),this.m=o.m}else o&&(c=String(o).match(ht))?(this.h=!1,_r(this,c[1]||"",!0),this.o=pt(c[2]||""),this.g=pt(c[3]||"",!0),Nt(this,c[4]),this.l=pt(c[5]||"",!0),bs(this,c[6]||"",!0),this.m=pt(c[7]||"")):(this.h=!1,this.i=new ji(null,this.h))}ft.prototype.toString=function(){var o=[],c=this.j;c&&o.push(Hn(c,ff,!0),":");var f=this.g;return(f||c=="file")&&(o.push("//"),(c=this.o)&&o.push(Hn(c,ff,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(Hn(f,f.charAt(0)=="/"?Hv:Wv,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",Hn(f,Gv)),o.join("")};function Ne(o){return new ft(o)}function _r(o,c,f){o.j=f?pt(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function Nt(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function bs(o,c,f){c instanceof ji?(o.i=c,Qv(o.i,o.h)):(f||(c=Hn(c,qv)),o.i=new ji(c,o.h))}function Y(o,c,f){o.i.set(c,f)}function Le(o){return Y(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function pt(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Hn(o,c,f){return typeof o=="string"?(o=encodeURI(o).replace(c,Eu),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Eu(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var ff=/[#\/\?@]/g,Wv=/[#\?:]/g,Hv=/[#\?]/g,qv=/[#\?@]/g,Gv=/#/g;function ji(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function xr(o){o.g||(o.g=new Map,o.h=0,o.i&&Bt(o.i,function(c,f){o.add(decodeURIComponent(c.replace(/\+/g," ")),f)}))}t=ji.prototype,t.add=function(o,c){xr(this),this.i=null,o=Ds(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(c),this.h+=1,this};function pf(o,c){xr(o),c=Ds(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function mf(o,c){return xr(o),c=Ds(o,c),o.g.has(c)}t.forEach=function(o,c){xr(this),this.g.forEach(function(f,_){f.forEach(function(b){o.call(c,b,_,this)},this)},this)},t.na=function(){xr(this);const o=Array.from(this.g.values()),c=Array.from(this.g.keys()),f=[];for(let _=0;_<c.length;_++){const b=o[_];for(let j=0;j<b.length;j++)f.push(c[_])}return f},t.V=function(o){xr(this);let c=[];if(typeof o=="string")mf(this,o)&&(c=c.concat(this.g.get(Ds(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)c=c.concat(o[f])}return c},t.set=function(o,c){return xr(this),this.i=null,o=Ds(this,o),mf(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},t.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function gf(o,c,f){pf(o,c),0<f.length&&(o.i=null,o.g.set(Ds(o,c),P(f)),o.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],c=Array.from(this.g.keys());for(var f=0;f<c.length;f++){var _=c[f];const j=encodeURIComponent(String(_)),Q=this.V(_);for(_=0;_<Q.length;_++){var b=j;Q[_]!==""&&(b+="="+encodeURIComponent(String(Q[_]))),o.push(b)}}return this.i=o.join("&")};function Ds(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function Qv(o,c){c&&!o.j&&(xr(o),o.i=null,o.g.forEach(function(f,_){var b=_.toLowerCase();_!=b&&(pf(this,_),gf(this,b,f))},o)),o.j=c}function Kv(o,c){const f=new $n;if(l.Image){const _=new Image;_.onload=E(wr,f,"TestLoadImage: loaded",!0,c,_),_.onerror=E(wr,f,"TestLoadImage: error",!1,c,_),_.onabort=E(wr,f,"TestLoadImage: abort",!1,c,_),_.ontimeout=E(wr,f,"TestLoadImage: timeout",!1,c,_),l.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=o}else c(!1)}function Yv(o,c){const f=new $n,_=new AbortController,b=setTimeout(()=>{_.abort(),wr(f,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:_.signal}).then(j=>{clearTimeout(b),j.ok?wr(f,"TestPingServer: ok",!0,c):wr(f,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(b),wr(f,"TestPingServer: error",!1,c)})}function wr(o,c,f,_,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),_(f)}catch{}}function Xv(){this.g=new hf}function Jv(o,c,f){const _=f||"";try{Ke(o,function(b,j){let Q=b;h(b)&&(Q=sa(b)),c.push(_+j+"="+encodeURIComponent(Q))})}catch(b){throw c.push(_+"type="+encodeURIComponent("_badmap")),b}}function fa(o){this.l=o.Ub||null,this.j=o.eb||!1}A(fa,Ts),fa.prototype.g=function(){return new pa(this.l,this.j)},fa.prototype.i=function(o){return function(){return o}}({});function pa(o,c){st.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(pa,st),t=pa.prototype,t.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,Mi(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vi(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Mi(this)),this.g&&(this.readyState=3,Mi(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;yf(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function yf(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Vi(this):Mi(this),this.readyState==3&&yf(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,Vi(this))},t.Qa=function(o){this.g&&(this.response=o,Vi(this))},t.ga=function(){this.g&&Vi(this)};function Vi(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Mi(o)}t.setRequestHeader=function(o,c){this.u.append(o,c)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],c=this.h.entries();for(var f=c.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=c.next();return o.join(`\r
`)};function Mi(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(pa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function vf(o){let c="";return M(o,function(f,_){c+=_,c+=":",c+=f,c+=`\r
`}),c}function Tu(o,c,f){e:{for(_ in f){var _=!1;break e}_=!0}_||(f=vf(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):Y(o,c,f))}function Ge(o){st.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(Ge,st);var Zv=/^https?$/i,e_=["POST","PUT"];t=Ge.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,c,f,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():bi.g(),this.v=this.o?Be(this.o):Be(bi),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(j){_f(this,j);return}if(o=f||"",f=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var b in _)f.set(b,_[b]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const j of _.keys())f.set(j,_.get(j));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(f.keys()).find(j=>j.toLowerCase()=="content-type"),b=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(e_,c,void 0))||_||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,Q]of f)this.g.setRequestHeader(j,Q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Sf(this),this.u=!0,this.g.send(o),this.u=!1}catch(j){_f(this,j)}};function _f(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,xf(o),ma(o)}function xf(o){o.A||(o.A=!0,Je(o,"complete"),Je(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Je(this,"complete"),Je(this,"abort"),ma(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ma(this,!0)),Ge.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?wf(this):this.bb())},t.bb=function(){wf(this)};function wf(o){if(o.h&&typeof a<"u"&&(!o.v[1]||qn(o)!=4||o.Z()!=2)){if(o.u&&qn(o)==4)Xr(o.Ea,0,o);else if(Je(o,"readystatechange"),qn(o)==4){o.h=!1;try{const Q=o.Z();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var f;if(!(f=c)){var _;if(_=Q===0){var b=String(o.D).match(ht)[1]||null;!b&&l.self&&l.self.location&&(b=l.self.location.protocol.slice(0,-1)),_=!Zv.test(b?b.toLowerCase():"")}f=_}if(f)Je(o,"complete"),Je(o,"success");else{o.m=6;try{var j=2<qn(o)?o.g.statusText:""}catch{j=""}o.l=j+" ["+o.Z()+"]",xf(o)}}finally{ma(o)}}}}function ma(o,c){if(o.g){Sf(o);const f=o.g,_=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||Je(o,"ready");try{f.onreadystatechange=_}catch{}}}function Sf(o){o.I&&(l.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function qn(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<qn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),ia(c)}};function Ef(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function t_(o){const c={};o=(o.g&&2<=qn(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<o.length;_++){if(S(o[_]))continue;var f=k(o[_]);const b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const j=c[b]||[];c[b]=j,j.push(f)}v(c,function(_){return _.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Li(o,c,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||c}function Tf(o){this.Aa=0,this.i=[],this.j=new $n,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Li("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Li("baseRetryDelayMs",5e3,o),this.cb=Li("retryDelaySeedMs",1e4,o),this.Wa=Li("forwardChannelMaxRetries",2,o),this.wa=Li("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new ha(o&&o.concurrentRequestLimit),this.Da=new Xv,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Tf.prototype,t.la=8,t.G=1,t.connect=function(o,c,f,_){it(0),this.W=o,this.H=c||{},f&&_!==void 0&&(this.H.OSID=f,this.H.OAID=_),this.F=this.X,this.I=Nf(this,null,this.W),ya(this)};function Iu(o){if(If(o),o.G==3){var c=o.U++,f=Ne(o.I);if(Y(f,"SID",o.K),Y(f,"RID",c),Y(f,"TYPE","terminate"),Oi(o,f),c=new zt(o,o.j,c),c.L=2,c.v=Le(Ne(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=c.v,f=!0),f||(c.g=jf(c.j,null),c.g.ea(c.v)),c.F=Date.now(),vr(c)}Df(o)}function ga(o){o.g&&(Au(o),o.g.cancel(),o.g=null)}function If(o){ga(o),o.u&&(l.clearTimeout(o.u),o.u=null),va(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function ya(o){if(!Ni(o.h)&&!o.s){o.s=!0;var c=o.Ga;$||G(),N||($(),N=!0),O.add(c,o),o.B=0}}function n_(o,c){return q(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Un(y(o.Ga,o,c),bf(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const b=new zt(this,this.j,o);let j=this.o;if(this.S&&(j?(j=m(j),w(j,this.S)):j=this.S),this.m!==null||this.O||(b.H=j,j=null),this.P)e:{for(var c=0,f=0;f<this.i.length;f++){t:{var _=this.i[f];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(c+=_,4096<c){c=f;break e}if(c===4096||f===this.i.length-1){c=f+1;break e}}c=1e3}else c=1e3;c=Af(this,b,c),f=Ne(this.I),Y(f,"RID",o),Y(f,"CVER",22),this.D&&Y(f,"X-HTTP-Session-Id",this.D),Oi(this,f),j&&(this.O?c="headers="+encodeURIComponent(String(vf(j)))+"&"+c:this.m&&Tu(f,this.m,j)),W(this.h,b),this.Ua&&Y(f,"TYPE","init"),this.P?(Y(f,"$req",c),Y(f,"SID","null"),b.T=!0,Rs(b,f,null)):Rs(b,f,c),this.G=2}}else this.G==3&&(o?Cf(this,o):this.i.length==0||Ni(this.h)||Cf(this))};function Cf(o,c){var f;c?f=c.l:f=o.U++;const _=Ne(o.I);Y(_,"SID",o.K),Y(_,"RID",f),Y(_,"AID",o.T),Oi(o,_),o.m&&o.o&&Tu(_,o.m,o.o),f=new zt(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),c&&(o.i=c.D.concat(o.i)),c=Af(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),W(o.h,f),Rs(f,_,c)}function Oi(o,c){o.H&&M(o.H,function(f,_){Y(c,_,f)}),o.l&&Ke({},function(f,_){Y(c,_,f)})}function Af(o,c,f){f=Math.min(o.i.length,f);var _=o.l?y(o.l.Na,o.l,o):null;e:{var b=o.i;let j=-1;for(;;){const Q=["count="+f];j==-1?0<f?(j=b[0].g,Q.push("ofs="+j)):j=0:Q.push("ofs="+j);let Ae=!0;for(let mt=0;mt<f;mt++){let _e=b[mt].g;const Tt=b[mt].map;if(_e-=j,0>_e)j=Math.max(0,b[mt].g-100),Ae=!1;else try{Jv(Tt,Q,"req"+_e+"_")}catch{_&&_(Tt)}}if(Ae){_=Q.join("&");break e}}}return o=o.i.splice(0,f),c.D=o,_}function kf(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;$||G(),N||($(),N=!0),O.add(c,o),o.v=0}}function Cu(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Un(y(o.Fa,o),bf(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,Rf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Un(y(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,it(10),ga(this),Rf(this))};function Au(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function Rf(o){o.g=new zt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=Ne(o.qa);Y(c,"RID","rpc"),Y(c,"SID",o.K),Y(c,"AID",o.T),Y(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&Y(c,"TO",o.ja),Y(c,"TYPE","xmlhttp"),Oi(o,c),o.m&&o.o&&Tu(c,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=Le(Ne(c)),f.m=null,f.P=!0,Di(f,o)}t.Za=function(){this.C!=null&&(this.C=null,ga(this),Cu(this),it(19))};function va(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function Pf(o,c){var f=null;if(o.g==c){va(o),Au(o),o.g=null;var _=2}else if(B(o.h,c))f=c.D,K(o.h,c),_=1;else return;if(o.G!=0){if(c.o)if(_==1){f=c.m?c.m.length:0,c=Date.now()-c.F;var b=o.B;_=Is(),Je(_,new ua(_,f)),ya(o)}else kf(o);else if(b=c.s,b==3||b==0&&0<c.X||!(_==1&&n_(o,c)||_==2&&Cu(o)))switch(f&&0<f.length&&(c=o.h,c.i=c.i.concat(f)),b){case 1:es(o,5);break;case 4:es(o,10);break;case 3:es(o,6);break;default:es(o,2)}}}function bf(o,c){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*c}function es(o,c){if(o.j.info("Error code "+c),c==2){var f=y(o.fb,o),_=o.Xa;const b=!_;_=new ft(_||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||_r(_,"https"),Le(_),b?Kv(_.toString(),f):Yv(_.toString(),f)}else it(2);o.G=0,o.l&&o.l.sa(c),Df(o),If(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),it(2)):(this.j.info("Failed to ping google.com"),it(1))};function Df(o){if(o.G=0,o.ka=[],o.l){const c=he(o.h);(c.length!=0||o.i.length!=0)&&(F(o.ka,c),F(o.ka,o.i),o.h.i.length=0,P(o.i),o.i.length=0),o.l.ra()}}function Nf(o,c,f){var _=f instanceof ft?Ne(f):new ft(f);if(_.g!="")c&&(_.g=c+"."+_.g),Nt(_,_.s);else{var b=l.location;_=b.protocol,c=c?c+"."+b.hostname:b.hostname,b=+b.port;var j=new ft(null);_&&_r(j,_),c&&(j.g=c),b&&Nt(j,b),f&&(j.l=f),_=j}return f=o.D,c=o.ya,f&&c&&Y(_,f,c),Y(_,"VER",o.la),Oi(o,_),_}function jf(o,c,f){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new Ge(new fa({eb:f})):new Ge(o.pa),c.Ha(o.J),c}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vf(){}t=Vf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function _a(){}_a.prototype.g=function(o,c){return new en(o,c)};function en(o,c){st.call(this),this.g=new Tf(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!S(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!S(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new Ns(this)}A(en,st),en.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},en.prototype.close=function(){Iu(this.g)},en.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=sa(o),o=f);c.i.push(new Su(c.Ya++,o)),c.G==3&&ya(c)},en.prototype.N=function(){this.g.l=null,delete this.j,Iu(this.g),delete this.g,en.aa.N.call(this)};function Mf(o){zn.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(const f in c){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}A(Mf,zn);function Lf(){Bn.call(this),this.status=1}A(Lf,Bn);function Ns(o){this.g=o}A(Ns,Vf),Ns.prototype.ua=function(){Je(this.g,"a")},Ns.prototype.ta=function(o){Je(this.g,new Mf(o))},Ns.prototype.sa=function(o){Je(this.g,new Lf)},Ns.prototype.ra=function(){Je(this.g,"b")},_a.prototype.createWebChannel=_a.prototype.g,en.prototype.send=en.prototype.o,en.prototype.open=en.prototype.m,en.prototype.close=en.prototype.close,E0=function(){return new _a},S0=function(){return Is()},w0=gn,dd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},gr.NO_ERROR=0,gr.TIMEOUT=8,gr.HTTP_ERROR=6,el=gr,Pi.COMPLETE="complete",x0=Pi,oa.EventType=Ft,Ft.OPEN="a",Ft.CLOSE="b",Ft.ERROR="c",Ft.MESSAGE="d",st.prototype.listen=st.prototype.K,Ji=oa,Ge.prototype.listenOnce=Ge.prototype.L,Ge.prototype.getLastError=Ge.prototype.Ka,Ge.prototype.getLastErrorCode=Ge.prototype.Ba,Ge.prototype.getStatus=Ge.prototype.Z,Ge.prototype.getResponseJson=Ge.prototype.Oa,Ge.prototype.getResponseText=Ge.prototype.oa,Ge.prototype.send=Ge.prototype.ea,Ge.prototype.setWithCredentials=Ge.prototype.Ha,_0=Ge}).apply(typeof Oa<"u"?Oa:typeof self<"u"?self:typeof window<"u"?window:{});const sm="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Si="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs=new d0("@firebase/firestore");function Gi(){return gs.logLevel}function Z(t,...e){if(gs.logLevel<=ye.DEBUG){const n=e.map(Rh);gs.debug(`Firestore (${Si}): ${t}`,...n)}}function ar(t,...e){if(gs.logLevel<=ye.ERROR){const n=e.map(Rh);gs.error(`Firestore (${Si}): ${t}`,...n)}}function Vo(t,...e){if(gs.logLevel<=ye.WARN){const n=e.map(Rh);gs.warn(`Firestore (${Si}): ${t}`,...n)}}function Rh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t="Unexpected state"){const e=`FIRESTORE (${Si}) INTERNAL ASSERTION FAILED: `+t;throw ar(e),new Error(e)}function Te(t,e){t||ae()}function ce(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class X extends wi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ut.UNAUTHENTICATED))}shutdown(){}}class aS{constructor(e){this.t=e,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Te(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new er;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new er,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{Z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(Z("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new er)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Te(typeof r.accessToken=="string"),new iS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Te(e===null||typeof e=="string"),new Ut(e)}}class lS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class uS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new lS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Te(this.o===void 0);const r=i=>{i.error!=null&&Z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,Z("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):Z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Te(typeof n.token=="string"),this.R=n.token,new cS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=hS(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function xe(t,e){return t<e?-1:t>e?1:0}function hi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new X(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new X(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new X(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new X(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return lt.fromMillis(Date.now())}static fromDate(e){return lt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new lt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ue(e)}static min(){return new ue(new lt(0,0))}static max(){return new ue(new lt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(),r===void 0?r=e.length-n:r>e.length-n&&ae(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Mo.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Mo?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ve extends Mo{construct(e,n,r){return new Ve(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new X(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ve(n)}static emptyPath(){return new Ve([])}}const fS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vt extends Mo{construct(e,n,r){return new vt(e,n,r)}static isValidIdentifier(e){return fS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new vt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new X(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new X(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new X(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new X(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new vt(n)}static emptyPath(){return new vt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.path=e}static fromPath(e){return new se(Ve.fromString(e))}static fromName(e){return new se(Ve.fromString(e).popFirst(5))}static empty(){return new se(Ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ve.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ve.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new se(new Ve(e.slice()))}}function pS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ue.fromTimestamp(r===1e9?new lt(n+1,0):new lt(n,r));return new Wr(s,se.empty(),e)}function mS(t){return new Wr(t.readTime,t.key,-1)}class Wr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Wr(ue.min(),se.empty(),-1)}static max(){return new Wr(ue.max(),se.empty(),-1)}}function gS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=se.comparator(t.documentKey,e.documentKey),n!==0?n:xe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ko(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==yS)throw t;Z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let u=0;u<i;u++){const h=u;n(e[h]).next(p=>{a[h]=p,++l,l===i&&r(a)},p=>s(p))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function _S(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Yo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Ph.oe=-1;function ru(t){return t==null}function bl(t){return t===0&&1/t==-1/0}function xS(t){return typeof t=="number"&&Number.isInteger(t)&&!bl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function im(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ws(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function I0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e,n){this.comparator=e,this.root=n||yt.EMPTY}insert(e,n){return new He(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,yt.BLACK,null,null))}remove(e){return new He(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fa(this.root,e,this.comparator,!0)}}class Fa{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class yt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??yt.RED,this.left=s??yt.EMPTY,this.right=i??yt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new yt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return yt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return yt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,yt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,yt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ae();const e=this.left.check();if(e!==this.right.check())throw ae();return e+(this.isRed()?0:1)}}yt.EMPTY=null,yt.RED=!0,yt.BLACK=!1;yt.EMPTY=new class{constructor(){this.size=0}get key(){throw ae()}get value(){throw ae()}get color(){throw ae()}get left(){throw ae()}get right(){throw ae()}copy(e,n,r,s,i){return this}insert(e,n,r){return new yt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.comparator=e,this.data=new He(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new om(this.data.getIterator())}getIteratorFrom(e){return new om(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof xt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new xt(this.comparator);return n.data=e,n}}class om{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.fields=e,e.sort(vt.comparator)}static empty(){return new rn([])}unionWith(e){let n=new xt(vt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new rn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return hi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new C0("Invalid base64 string: "+i):i}}(e);return new St(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new St(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}St.EMPTY_BYTE_STRING=new St("");const wS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hr(t){if(Te(!!t),typeof t=="string"){let e=0;const n=wS.exec(t);if(Te(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ye(t.seconds),nanos:Ye(t.nanos)}}function Ye(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ys(t){return typeof t=="string"?St.fromBase64String(t):St.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Dh(t){const e=t.mapValue.fields.__previous_value__;return bh(e)?Dh(e):e}function Lo(t){const e=Hr(t.mapValue.fields.__local_write_time__.timestampValue);return new lt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,n,r,s,i,a,l,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}}class Oo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Oo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Oo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const za={mapValue:{}};function vs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bh(t)?4:TS(t)?9007199254740991:ES(t)?10:11:ae()}function Fn(t,e){if(t===e)return!0;const n=vs(t);if(n!==vs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Lo(t).isEqual(Lo(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Hr(s.timestampValue),l=Hr(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ys(s.bytesValue).isEqual(ys(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ye(s.geoPointValue.latitude)===Ye(i.geoPointValue.latitude)&&Ye(s.geoPointValue.longitude)===Ye(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ye(s.integerValue)===Ye(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Ye(s.doubleValue),l=Ye(i.doubleValue);return a===l?bl(a)===bl(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return hi(t.arrayValue.values||[],e.arrayValue.values||[],Fn);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(im(a)!==im(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!Fn(a[u],l[u])))return!1;return!0}(t,e);default:return ae()}}function Fo(t,e){return(t.values||[]).find(n=>Fn(n,e))!==void 0}function fi(t,e){if(t===e)return 0;const n=vs(t),r=vs(e);if(n!==r)return xe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xe(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=Ye(i.integerValue||i.doubleValue),u=Ye(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return am(t.timestampValue,e.timestampValue);case 4:return am(Lo(t),Lo(e));case 5:return xe(t.stringValue,e.stringValue);case 6:return function(i,a){const l=ys(i),u=ys(a);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),u=a.split("/");for(let h=0;h<l.length&&h<u.length;h++){const p=xe(l[h],u[h]);if(p!==0)return p}return xe(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=xe(Ye(i.latitude),Ye(a.latitude));return l!==0?l:xe(Ye(i.longitude),Ye(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return lm(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,u,h,p;const g=i.fields||{},y=a.fields||{},E=(l=g.value)===null||l===void 0?void 0:l.arrayValue,A=(u=y.value)===null||u===void 0?void 0:u.arrayValue,P=xe(((h=E==null?void 0:E.values)===null||h===void 0?void 0:h.length)||0,((p=A==null?void 0:A.values)===null||p===void 0?void 0:p.length)||0);return P!==0?P:lm(E,A)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===za.mapValue&&a===za.mapValue)return 0;if(i===za.mapValue)return 1;if(a===za.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),h=a.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let g=0;g<u.length&&g<p.length;++g){const y=xe(u[g],p[g]);if(y!==0)return y;const E=fi(l[u[g]],h[p[g]]);if(E!==0)return E}return xe(u.length,p.length)}(t.mapValue,e.mapValue);default:throw ae()}}function am(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xe(t,e);const n=Hr(t),r=Hr(e),s=xe(n.seconds,r.seconds);return s!==0?s:xe(n.nanos,r.nanos)}function lm(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=fi(n[s],r[s]);if(i)return i}return xe(n.length,r.length)}function pi(t){return hd(t)}function hd(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Hr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ys(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return se.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=hd(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${hd(n.fields[a])}`;return s+"}"}(t.mapValue):ae()}function um(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function fd(t){return!!t&&"integerValue"in t}function Nh(t){return!!t&&"arrayValue"in t}function cm(t){return!!t&&"nullValue"in t}function dm(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function tl(t){return!!t&&"mapValue"in t}function ES(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function ho(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ws(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ho(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ho(t.arrayValue.values[n]);return e}return Object.assign({},t)}function TS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e){this.value=e}static empty(){return new Wt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!tl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ho(n)}setAll(e){let n=vt.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=ho(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());tl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Fn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];tl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ws(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Wt(ho(this.value))}}function A0(t){const e=[];return ws(t.fields,(n,r)=>{const s=new vt([n]);if(tl(r)){const i=A0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new rn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Pt(e,0,ue.min(),ue.min(),ue.min(),Wt.empty(),0)}static newFoundDocument(e,n,r,s){return new Pt(e,1,n,ue.min(),r,s,0)}static newNoDocument(e,n){return new Pt(e,2,n,ue.min(),ue.min(),Wt.empty(),0)}static newUnknownDocument(e,n){return new Pt(e,3,n,ue.min(),ue.min(),Wt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Wt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Wt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Pt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,n){this.position=e,this.inclusive=n}}function hm(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=se.comparator(se.fromName(a.referenceValue),n.key):r=fi(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function fm(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Fn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,n="asc"){this.field=e,this.dir=n}}function IS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{}class rt extends k0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new AS(e,n,r):n==="array-contains"?new PS(e,r):n==="in"?new bS(e,r):n==="not-in"?new DS(e,r):n==="array-contains-any"?new NS(e,r):new rt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new kS(e,r):new RS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(fi(n,this.value)):n!==null&&vs(this.value)===vs(n)&&this.matchesComparison(fi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Rn extends k0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Rn(e,n)}matches(e){return R0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function R0(t){return t.op==="and"}function P0(t){return CS(t)&&R0(t)}function CS(t){for(const e of t.filters)if(e instanceof Rn)return!1;return!0}function pd(t){if(t instanceof rt)return t.field.canonicalString()+t.op.toString()+pi(t.value);if(P0(t))return t.filters.map(e=>pd(e)).join(",");{const e=t.filters.map(n=>pd(n)).join(",");return`${t.op}(${e})`}}function b0(t,e){return t instanceof rt?function(r,s){return s instanceof rt&&r.op===s.op&&r.field.isEqual(s.field)&&Fn(r.value,s.value)}(t,e):t instanceof Rn?function(r,s){return s instanceof Rn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&b0(a,s.filters[l]),!0):!1}(t,e):void ae()}function D0(t){return t instanceof rt?function(n){return`${n.field.canonicalString()} ${n.op} ${pi(n.value)}`}(t):t instanceof Rn?function(n){return n.op.toString()+" {"+n.getFilters().map(D0).join(" ,")+"}"}(t):"Filter"}class AS extends rt{constructor(e,n,r){super(e,n,r),this.key=se.fromName(r.referenceValue)}matches(e){const n=se.comparator(e.key,this.key);return this.matchesComparison(n)}}class kS extends rt{constructor(e,n){super(e,"in",n),this.keys=N0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class RS extends rt{constructor(e,n){super(e,"not-in",n),this.keys=N0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function N0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>se.fromName(r.referenceValue))}class PS extends rt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Nh(n)&&Fo(n.arrayValue,this.value)}}class bS extends rt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Fo(this.value.arrayValue,n)}}class DS extends rt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Fo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Fo(this.value.arrayValue,n)}}class NS extends rt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Nh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Fo(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function pm(t,e=null,n=[],r=[],s=null,i=null,a=null){return new jS(t,e,n,r,s,i,a)}function jh(t){const e=ce(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>pd(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),ru(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>pi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>pi(r)).join(",")),e.ue=n}return e.ue}function Vh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!IS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!b0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!fm(t.startAt,e.startAt)&&fm(t.endAt,e.endAt)}function md(t){return se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function VS(t,e,n,r,s,i,a,l){return new Xo(t,e,n,r,s,i,a,l)}function Mh(t){return new Xo(t)}function mm(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function j0(t){return t.collectionGroup!==null}function fo(t){const e=ce(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new xt(vt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Nl(i,r))}),n.has(vt.keyField().canonicalString())||e.ce.push(new Nl(vt.keyField(),r))}return e.ce}function Ln(t){const e=ce(t);return e.le||(e.le=MS(e,fo(t))),e.le}function MS(t,e){if(t.limitType==="F")return pm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Nl(s.field,i)});const n=t.endAt?new Dl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Dl(t.startAt.position,t.startAt.inclusive):null;return pm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function gd(t,e){const n=t.filters.concat([e]);return new Xo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function yd(t,e,n){return new Xo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function su(t,e){return Vh(Ln(t),Ln(e))&&t.limitType===e.limitType}function V0(t){return`${jh(Ln(t))}|lt:${t.limitType}`}function Ms(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>D0(s)).join(", ")}]`),ru(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>pi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>pi(s)).join(",")),`Target(${r})`}(Ln(t))}; limitType=${t.limitType})`}function iu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):se.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of fo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,u){const h=hm(a,l,u);return a.inclusive?h<=0:h<0}(r.startAt,fo(r),s)||r.endAt&&!function(a,l,u){const h=hm(a,l,u);return a.inclusive?h>=0:h>0}(r.endAt,fo(r),s))}(t,e)}function LS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function M0(t){return(e,n)=>{let r=!1;for(const s of fo(t)){const i=OS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function OS(t,e,n){const r=t.field.isKeyField()?se.comparator(e.key,n.key):function(i,a,l){const u=a.data.field(i),h=l.data.field(i);return u!==null&&h!==null?fi(u,h):ae()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ws(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return I0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS=new He(se.comparator);function lr(){return FS}const L0=new He(se.comparator);function Zi(...t){let e=L0;for(const n of t)e=e.insert(n.key,n);return e}function O0(t){let e=L0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function as(){return po()}function F0(){return po()}function po(){return new Ei(t=>t.toString(),(t,e)=>t.isEqual(e))}const zS=new He(se.comparator),BS=new xt(se.comparator);function me(...t){let e=BS;for(const n of t)e=e.add(n);return e}const US=new xt(xe);function $S(){return US}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bl(e)?"-0":e}}function z0(t){return{integerValue:""+t}}function WS(t,e){return xS(e)?z0(e):Lh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(){this._=void 0}}function HS(t,e,n){return t instanceof zo?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&bh(i)&&(i=Dh(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof Bo?U0(t,e):t instanceof Uo?$0(t,e):function(s,i){const a=B0(s,i),l=gm(a)+gm(s.Pe);return fd(a)&&fd(s.Pe)?z0(l):Lh(s.serializer,l)}(t,e)}function qS(t,e,n){return t instanceof Bo?U0(t,e):t instanceof Uo?$0(t,e):n}function B0(t,e){return t instanceof jl?function(r){return fd(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class zo extends ou{}class Bo extends ou{constructor(e){super(),this.elements=e}}function U0(t,e){const n=W0(e);for(const r of t.elements)n.some(s=>Fn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Uo extends ou{constructor(e){super(),this.elements=e}}function $0(t,e){let n=W0(e);for(const r of t.elements)n=n.filter(s=>!Fn(s,r));return{arrayValue:{values:n}}}class jl extends ou{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function gm(t){return Ye(t.integerValue||t.doubleValue)}function W0(t){return Nh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,n){this.field=e,this.transform=n}}function QS(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Bo&&s instanceof Bo||r instanceof Uo&&s instanceof Uo?hi(r.elements,s.elements,Fn):r instanceof jl&&s instanceof jl?Fn(r.Pe,s.Pe):r instanceof zo&&s instanceof zo}(t.transform,e.transform)}class KS{constructor(e,n){this.version=e,this.transformResults=n}}class Cn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Cn}static exists(e){return new Cn(void 0,e)}static updateTime(e){return new Cn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class au{}function H0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new G0(t.key,Cn.none()):new Jo(t.key,t.data,Cn.none());{const n=t.data,r=Wt.empty();let s=new xt(vt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Yr(t.key,r,new rn(s.toArray()),Cn.none())}}function YS(t,e,n){t instanceof Jo?function(s,i,a){const l=s.value.clone(),u=vm(s.fieldTransforms,i,a.transformResults);l.setAll(u),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Yr?function(s,i,a){if(!nl(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=vm(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(q0(s)),u.setAll(l),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function mo(t,e,n,r){return t instanceof Jo?function(i,a,l,u){if(!nl(i.precondition,a))return l;const h=i.value.clone(),p=_m(i.fieldTransforms,u,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof Yr?function(i,a,l,u){if(!nl(i.precondition,a))return l;const h=_m(i.fieldTransforms,u,a),p=a.data;return p.setAll(q0(i)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,a,l){return nl(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function XS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=B0(r.transform,s||null);i!=null&&(n===null&&(n=Wt.empty()),n.set(r.field,i))}return n||null}function ym(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&hi(r,s,(i,a)=>QS(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Jo extends au{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Yr extends au{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function q0(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function vm(t,e,n){const r=new Map;Te(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,qS(a,l,n[s]))}return r}function _m(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,HS(i,a,e))}return r}class G0 extends au{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class JS extends au{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&YS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=mo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=mo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=F0();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const u=H0(a,l);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(ue.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),me())}isEqual(e){return this.batchId===e.batchId&&hi(this.mutations,e.mutations,(n,r)=>ym(n,r))&&hi(this.baseMutations,e.baseMutations,(n,r)=>ym(n,r))}}class Oh{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Te(e.mutations.length===r.length);let s=function(){return zS}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Oh(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ze,ge;function nE(t){switch(t){default:return ae();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function Q0(t){if(t===void 0)return ar("GRPC error has no .code"),z.UNKNOWN;switch(t){case Ze.OK:return z.OK;case Ze.CANCELLED:return z.CANCELLED;case Ze.UNKNOWN:return z.UNKNOWN;case Ze.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case Ze.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case Ze.INTERNAL:return z.INTERNAL;case Ze.UNAVAILABLE:return z.UNAVAILABLE;case Ze.UNAUTHENTICATED:return z.UNAUTHENTICATED;case Ze.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case Ze.NOT_FOUND:return z.NOT_FOUND;case Ze.ALREADY_EXISTS:return z.ALREADY_EXISTS;case Ze.PERMISSION_DENIED:return z.PERMISSION_DENIED;case Ze.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case Ze.ABORTED:return z.ABORTED;case Ze.OUT_OF_RANGE:return z.OUT_OF_RANGE;case Ze.UNIMPLEMENTED:return z.UNIMPLEMENTED;case Ze.DATA_LOSS:return z.DATA_LOSS;default:return ae()}}(ge=Ze||(Ze={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE=new cs([4294967295,4294967295],0);function xm(t){const e=rE().encode(t),n=new v0;return n.update(e),new Uint8Array(n.digest())}function wm(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new cs([n,r],0),new cs([s,i],0)]}class Fh{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new eo(`Invalid padding: ${n}`);if(r<0)throw new eo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new eo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new eo(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=cs.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(cs.fromNumber(r)));return s.compare(sE)===1&&(s=new cs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=xm(e),[r,s]=wm(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Fh(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=xm(e),[r,s]=wm(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class eo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Zo.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new lu(ue.min(),s,new He(xe),lr(),me())}}class Zo{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Zo(r,n,me(),me(),me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class K0{constructor(e,n){this.targetId=e,this.me=n}}class Y0{constructor(e,n,r=St.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Sm{constructor(){this.fe=0,this.ge=Tm(),this.pe=St.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=me(),n=me(),r=me();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ae()}}),new Zo(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Tm()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class iE{constructor(e){this.Le=e,this.Be=new Map,this.ke=lr(),this.qe=Em(),this.Qe=new He(xe)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ae()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(md(i))if(r===0){const a=new se(i.path);this.Ue(n,a,Pt.newNoDocument(a,ue.min()))}else Te(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),u=l?this.Xe(l,e,a):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=ys(r).toUint8Array()}catch(u){if(u instanceof C0)return Vo("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Fh(a,s,i)}catch(u){return Vo(u instanceof eo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&md(l.target)){const u=new se(l.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,Pt.newNoDocument(u,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=me();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new lu(e,n,this.Qe,this.ke,r);return this.ke=lr(),this.qe=Em(),this.Qe=new He(xe),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Sm,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new xt(xe),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Z("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Sm),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Em(){return new He(se.comparator)}function Tm(){return new He(se.comparator)}const oE={asc:"ASCENDING",desc:"DESCENDING"},aE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lE={and:"AND",or:"OR"};class uE{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function vd(t,e){return t.useProto3Json||ru(e)?e:{value:e}}function Vl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function X0(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function cE(t,e){return Vl(t,e.toTimestamp())}function On(t){return Te(!!t),ue.fromTimestamp(function(n){const r=Hr(n);return new lt(r.seconds,r.nanos)}(t))}function zh(t,e){return _d(t,e).canonicalString()}function _d(t,e){const n=function(s){return new Ve(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function J0(t){const e=Ve.fromString(t);return Te(rv(e)),e}function xd(t,e){return zh(t.databaseId,e.path)}function ic(t,e){const n=J0(e);if(n.get(1)!==t.databaseId.projectId)throw new X(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new X(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new se(ev(n))}function Z0(t,e){return zh(t.databaseId,e)}function dE(t){const e=J0(t);return e.length===4?Ve.emptyPath():ev(e)}function wd(t){return new Ve(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ev(t){return Te(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Im(t,e,n){return{name:xd(t,e),fields:n.value.mapValue.fields}}function hE(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,p){return h.useProto3Json?(Te(p===void 0||typeof p=="string"),St.fromBase64String(p||"")):(Te(p===void 0||p instanceof Buffer||p instanceof Uint8Array),St.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){const p=h.code===void 0?z.UNKNOWN:Q0(h.code);return new X(p,h.message||"")}(a);n=new Y0(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ic(t,r.document.name),i=On(r.document.updateTime),a=r.document.createTime?On(r.document.createTime):ue.min(),l=new Wt({mapValue:{fields:r.document.fields}}),u=Pt.newFoundDocument(s,i,a,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new rl(h,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ic(t,r.document),i=r.readTime?On(r.readTime):ue.min(),a=Pt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new rl([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ic(t,r.document),i=r.removedTargetIds||[];n=new rl([],i,s,null)}else{if(!("filter"in e))return ae();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new tE(s,i),l=r.targetId;n=new K0(l,a)}}return n}function fE(t,e){let n;if(e instanceof Jo)n={update:Im(t,e.key,e.value)};else if(e instanceof G0)n={delete:xd(t,e.key)};else if(e instanceof Yr)n={update:Im(t,e.key,e.data),updateMask:SE(e.fieldMask)};else{if(!(e instanceof JS))return ae();n={verify:xd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof zo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Bo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Uo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof jl)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw ae()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:cE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ae()}(t,e.precondition)),n}function pE(t,e){return t&&t.length>0?(Te(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?On(s.updateTime):On(i);return a.isEqual(ue.min())&&(a=On(i)),new KS(a,s.transformResults||[])}(n,e))):[]}function mE(t,e){return{documents:[Z0(t,e.path)]}}function gE(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Z0(t,s);const i=function(h){if(h.length!==0)return nv(Rn.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(h){if(h.length!==0)return h.map(p=>function(y){return{field:Ls(y.field),direction:_E(y.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=vd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function yE(t){let e=dE(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Te(r===1);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(g){const y=tv(g);return y instanceof Rn&&P0(y)?y.getFilters():[y]}(n.where));let a=[];n.orderBy&&(a=function(g){return g.map(y=>function(A){return new Nl(Os(A.field),function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(y))}(n.orderBy));let l=null;n.limit&&(l=function(g){let y;return y=typeof g=="object"?g.value:g,ru(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(g){const y=!!g.before,E=g.values||[];return new Dl(E,y)}(n.startAt));let h=null;return n.endAt&&(h=function(g){const y=!g.before,E=g.values||[];return new Dl(E,y)}(n.endAt)),VS(e,s,a,i,l,"F",u,h)}function vE(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function tv(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Os(n.unaryFilter.field);return rt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Os(n.unaryFilter.field);return rt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Os(n.unaryFilter.field);return rt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Os(n.unaryFilter.field);return rt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ae()}}(t):t.fieldFilter!==void 0?function(n){return rt.create(Os(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ae()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Rn.create(n.compositeFilter.filters.map(r=>tv(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ae()}}(n.compositeFilter.op))}(t):ae()}function _E(t){return oE[t]}function xE(t){return aE[t]}function wE(t){return lE[t]}function Ls(t){return{fieldPath:t.canonicalString()}}function Os(t){return vt.fromServerFormat(t.fieldPath)}function nv(t){return t instanceof rt?function(n){if(n.op==="=="){if(dm(n.value))return{unaryFilter:{field:Ls(n.field),op:"IS_NAN"}};if(cm(n.value))return{unaryFilter:{field:Ls(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(dm(n.value))return{unaryFilter:{field:Ls(n.field),op:"IS_NOT_NAN"}};if(cm(n.value))return{unaryFilter:{field:Ls(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ls(n.field),op:xE(n.op),value:n.value}}}(t):t instanceof Rn?function(n){const r=n.getFilters().map(s=>nv(s));return r.length===1?r[0]:{compositeFilter:{op:wE(n.op),filters:r}}}(t):ae()}function SE(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function rv(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,n,r,s,i=ue.min(),a=ue.min(),l=St.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Rr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Rr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Rr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Rr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e){this.ct=e}}function TE(t){const e=yE({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?yd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(){this.un=new CE}addToCollectionParentIndex(e,n){return this.un.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(Wr.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(Wr.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class CE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new xt(Ve.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new xt(Ve.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new mi(0)}static kn(){return new mi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(){this.changes=new Ei(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Pt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&mo(r.mutation,s,rn.empty(),lt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,me()).next(()=>r))}getLocalViewOfDocuments(e,n,r=me()){const s=as();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=Zi();return i.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=as();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,me()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=lr();const a=po(),l=function(){return po()}();return n.forEach((u,h)=>{const p=r.get(h.key);s.has(h.key)&&(p===void 0||p.mutation instanceof Yr)?i=i.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),mo(p.mutation,h,p.mutation.getFieldMask(),lt.now())):a.set(h.key,rn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,p)=>a.set(h,p)),n.forEach((h,p)=>{var g;return l.set(h,new kE(p,(g=a.get(h))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=po();let s=new He((a,l)=>a-l),i=me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let p=r.get(u)||rn.empty();p=l.applyToLocalView(h,p),r.set(u,p);const g=(s.get(l.batchId)||me()).add(u);s=s.insert(l.batchId,g)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,p=u.value,g=F0();p.forEach(y=>{if(!i.has(y)){const E=H0(n.get(y),r.get(y));E!==null&&g.set(y,E),i=i.add(y)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return U.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return se.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):j0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(as());let l=-1,u=i;return a.next(h=>U.forEach(h,(p,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),i.get(p)?U.resolve():this.remoteDocumentCache.getEntry(e,p).next(y=>{u=u.insert(p,y)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,me())).next(p=>({batchId:l,changes:O0(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new se(n)).next(r=>{let s=Zi();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=Zi();return this.indexManager.getCollectionParents(e,i).next(l=>U.forEach(l,u=>{const h=function(g,y){return new Xo(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(p=>{p.forEach((g,y)=>{a=a.insert(g,y)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((u,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,Pt.newInvalidDocument(p)))});let l=Zi();return a.forEach((u,h)=>{const p=i.get(u);p!==void 0&&mo(p.mutation,h,rn.empty(),lt.now()),iu(n,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return U.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:On(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:TE(s.bundledQuery),readTime:On(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(){this.overlays=new He(se.comparator),this.Ir=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=as();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=as(),i=n.length+1,a=new se(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new He((h,p)=>h-p);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=i.get(h.largestBatchId);p===null&&(p=as(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=as(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=s)););return U.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new eE(n,r));let i=this.Ir.get(n);i===void 0&&(i=me(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(){this.sessionToken=St.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(){this.Tr=new xt(ut.Er),this.dr=new xt(ut.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new ut(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new ut(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new se(new Ve([])),r=new ut(n,e),s=new ut(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new se(new Ve([])),r=new ut(n,e),s=new ut(n,e+1);let i=me();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new ut(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ut{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return se.comparator(e.key,n.key)||xe(e.wr,n.wr)}static Ar(e,n){return xe(e.wr,n.wr)||se.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new xt(ut.Er)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new ZS(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new ut(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(a)}lookupMutationBatch(e,n){return U.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ut(n,0),s=new ut(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new xt(xe);return n.forEach(s=>{const i=new ut(s,0),a=new ut(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),U.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;se.isDocumentKey(i)||(i=i.child(""));const a=new ut(new se(i),0);let l=new xt(xe);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(l=l.add(u.wr)),!0)},a),U.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Te(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return U.forEach(n.mutations,s=>{const i=new ut(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new ut(n,0),s=this.br.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e){this.Mr=e,this.docs=function(){return new He(se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():Pt.newInvalidDocument(n))}getEntries(e,n){let r=lr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Pt.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=lr();const a=n.path,l=new se(a.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||gS(mS(p),r)<=0||(s.has(p.key)||iu(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ae()}Or(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new VE(this)}getSize(e){return U.resolve(this.size)}}class VE extends AE{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(e){this.persistence=e,this.Nr=new Ei(n=>jh(n),Vh),this.lastRemoteSnapshotVersion=ue.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Bh,this.targetCount=0,this.kr=mi.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),U.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new mi(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Kn(n),U.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Ph(0),this.Kr=!1,this.Kr=!0,this.$r=new DE,this.referenceDelegate=e(this),this.Ur=new ME(this),this.indexManager=new IE,this.remoteDocumentCache=function(s){return new jE(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new EE(n),this.Gr=new PE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new bE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new NE(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){Z("MemoryPersistence","Starting transaction:",e);const s=new OE(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return U.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class OE extends vS{constructor(e){super(),this.currentSequenceNumber=e}}class Uh{constructor(e){this.persistence=e,this.Jr=new Bh,this.Yr=null}static Zr(e){return new Uh(e)}get Xr(){if(this.Yr)return this.Yr;throw ae()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),U.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Xr,r=>{const s=se.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ue.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return U.or([()=>U.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=me(),s=me();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new $h(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return U1()?8:_S(z1())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new FE;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Gi()<=ye.DEBUG&&Z("QueryEngine","SDK will not create cache indexes for query:",Ms(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),U.resolve()):(Gi()<=ye.DEBUG&&Z("QueryEngine","Query:",Ms(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Gi()<=ye.DEBUG&&Z("QueryEngine","The SDK decides to create cache indexes for query:",Ms(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ln(n))):U.resolve())}Yi(e,n){if(mm(n))return U.resolve(null);let r=Ln(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=yd(n,null,"F"),r=Ln(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=me(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,l);return this.ns(n,h,a,u.readTime)?this.Yi(e,yd(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,s){return mm(n)||s.isEqual(ue.min())?U.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?U.resolve(null):(Gi()<=ye.DEBUG&&Z("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ms(n)),this.rs(e,a,n,pS(s,-1)).next(l=>l))})}ts(e,n){let r=new xt(M0(e));return n.forEach((s,i)=>{iu(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Gi()<=ye.DEBUG&&Z("QueryEngine","Using full collection scan to execute query:",Ms(n)),this.Ji.getDocumentsMatchingQuery(e,n,Wr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new He(xe),this._s=new Ei(i=>jh(i),Vh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function UE(t,e,n,r){return new BE(t,e,n,r)}async function sv(t,e){const n=ce(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let u=me();for(const h of s){a.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of i){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:a,addedBatchIds:l}))})})}function $E(t,e){const n=ce(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,h,p){const g=h.batch,y=g.keys();let E=U.resolve();return y.forEach(A=>{E=E.next(()=>p.getEntry(u,A)).next(P=>{const F=h.docVersions.get(A);Te(F!==null),P.version.compareTo(F)<0&&(g.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),p.addEntry(P)))})}),E.next(()=>l.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=me();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function iv(t){const e=ce(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function WE(t,e){const n=ce(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((p,g)=>{const y=s.get(g);if(!y)return;l.push(n.Ur.removeMatchingKeys(i,p.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(i,p.addedDocuments,g)));let E=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?E=E.withResumeToken(St.EMPTY_BYTE_STRING,ue.min()).withLastLimboFreeSnapshotVersion(ue.min()):p.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(p.resumeToken,r)),s=s.insert(g,E),function(P,F,I){return P.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(y,E,p)&&l.push(n.Ur.updateTargetData(i,E))});let u=lr(),h=me();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),l.push(HE(i,a,e.documentUpdates).next(p=>{u=p.Ps,h=p.Is})),!r.isEqual(ue.min())){const p=n.Ur.getLastRemoteSnapshotVersion(i).next(g=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(p)}return U.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(n.os=s,i))}function HE(t,e,n){let r=me(),s=me();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=lr();return n.forEach((l,u)=>{const h=i.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(ue.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):Z("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ps:a,Is:s}})}function qE(t,e){const n=ce(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function GE(t,e){const n=ce(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new Rr(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Sd(t,e,n){const r=ce(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Yo(a))throw a;Z("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Cm(t,e,n){const r=ce(t);let s=ue.min(),i=me();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,p){const g=ce(u),y=g._s.get(p);return y!==void 0?U.resolve(g.os.get(y)):g.Ur.getTargetData(h,p)}(r,a,Ln(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:ue.min(),n?i:me())).next(l=>(QE(r,LS(e),l),{documents:l,Ts:i})))}function QE(t,e,n){let r=t.us.get(e)||ue.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Am{constructor(){this.activeTargetIds=$S()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class KE{constructor(){this.so=new Am,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Am,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Z("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Z("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ba=null;function oc(){return Ba===null?Ba=function(){return 268435456+Math.round(2147483648*Math.random())}():Ba++,"0x"+Ba.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kt="WebChannelConnection";class ZE extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=oc(),u=this.xo(n,r.toUriEncodedString());Z("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,a),this.No(n,u,h,s).then(p=>(Z("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw Vo("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",u,"request:",s),p})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Si}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=XE[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=oc();return new Promise((a,l)=>{const u=new _0;u.setWithCredentials(!0),u.listenOnce(x0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case el.NO_ERROR:const p=u.getResponseJson();Z(kt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(p)),a(p);break;case el.TIMEOUT:Z(kt,`RPC '${e}' ${i} timed out`),l(new X(z.DEADLINE_EXCEEDED,"Request time out"));break;case el.HTTP_ERROR:const g=u.getStatus();if(Z(kt,`RPC '${e}' ${i} failed with status:`,g,"response text:",u.getResponseText()),g>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const E=y==null?void 0:y.error;if(E&&E.status&&E.message){const A=function(F){const I=F.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(I)>=0?I:z.UNKNOWN}(E.status);l(new X(A,E.message))}else l(new X(z.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new X(z.UNAVAILABLE,"Connection failed."));break;default:ae()}}finally{Z(kt,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);Z(kt,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=oc(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=E0(),l=S0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const p=i.join("");Z(kt,`Creating RPC '${e}' stream ${s}: ${p}`,u);const g=a.createWebChannel(p,u);let y=!1,E=!1;const A=new JE({Io:F=>{E?Z(kt,`Not sending because RPC '${e}' stream ${s} is closed:`,F):(y||(Z(kt,`Opening RPC '${e}' stream ${s} transport.`),g.open(),y=!0),Z(kt,`RPC '${e}' stream ${s} sending:`,F),g.send(F))},To:()=>g.close()}),P=(F,I,S)=>{F.listen(I,C=>{try{S(C)}catch(V){setTimeout(()=>{throw V},0)}})};return P(g,Ji.EventType.OPEN,()=>{E||(Z(kt,`RPC '${e}' stream ${s} transport opened.`),A.yo())}),P(g,Ji.EventType.CLOSE,()=>{E||(E=!0,Z(kt,`RPC '${e}' stream ${s} transport closed`),A.So())}),P(g,Ji.EventType.ERROR,F=>{E||(E=!0,Vo(kt,`RPC '${e}' stream ${s} transport errored:`,F),A.So(new X(z.UNAVAILABLE,"The operation could not be completed")))}),P(g,Ji.EventType.MESSAGE,F=>{var I;if(!E){const S=F.data[0];Te(!!S);const C=S,V=C.error||((I=C[0])===null||I===void 0?void 0:I.error);if(V){Z(kt,`RPC '${e}' stream ${s} received error:`,V);const L=V.status;let M=function(x){const w=Ze[x];if(w!==void 0)return Q0(w)}(L),v=V.message;M===void 0&&(M=z.INTERNAL,v="Unknown error status: "+L+" with message "+V.message),E=!0,A.So(new X(M,v)),g.close()}else Z(kt,`RPC '${e}' stream ${s} received:`,S),A.bo(S)}}),P(l,w0.STAT_EVENT,F=>{F.stat===dd.PROXY?Z(kt,`RPC '${e}' stream ${s} detected buffering proxy`):F.stat===dd.NOPROXY&&Z(kt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{A.wo()},0),A}}function ac(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(t){return new uE(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&Z("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,n,r,s,i,a,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new ov(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(ar(n.toString()),ar("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new X(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Z("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Z("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class eT extends av{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=hE(this.serializer,e),r=function(i){if(!("targetChange"in i))return ue.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?ue.min():a.readTime?On(a.readTime):ue.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=wd(this.serializer),n.addTarget=function(i,a){let l;const u=a.target;if(l=md(u)?{documents:mE(i,u)}:{query:gE(i,u)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=X0(i,a.resumeToken);const h=vd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(ue.min())>0){l.readTime=Vl(i,a.snapshotVersion.toTimestamp());const h=vd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=vE(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=wd(this.serializer),n.removeTarget=e,this.a_(n)}}class tT extends av{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Te(!!e.streamToken),this.lastStreamToken=e.streamToken,Te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=pE(e.writeResults,e.commitTime),r=On(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=wd(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>fE(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new X(z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,_d(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new X(z.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,_d(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new X(z.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class rT{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ar(n),this.D_=!1):Z("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{Ss(this)&&(Z("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=ce(u);h.L_.add(4),await ea(h),h.q_.set("Unknown"),h.L_.delete(4),await cu(h)}(this))})}),this.q_=new rT(r,s)}}async function cu(t){if(Ss(t))for(const e of t.B_)await e(!0)}async function ea(t){for(const e of t.B_)await e(!1)}function lv(t,e){const n=ce(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Gh(n)?qh(n):Ti(n).r_()&&Hh(n,e))}function Wh(t,e){const n=ce(t),r=Ti(n);n.N_.delete(e),r.r_()&&uv(n,e),n.N_.size===0&&(r.r_()?r.o_():Ss(n)&&n.q_.set("Unknown"))}function Hh(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ti(t).A_(e)}function uv(t,e){t.Q_.xe(e),Ti(t).R_(e)}function qh(t){t.Q_=new iE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ti(t).start(),t.q_.v_()}function Gh(t){return Ss(t)&&!Ti(t).n_()&&t.N_.size>0}function Ss(t){return ce(t).L_.size===0}function cv(t){t.Q_=void 0}async function iT(t){t.q_.set("Online")}async function oT(t){t.N_.forEach((e,n)=>{Hh(t,e)})}async function aT(t,e){cv(t),Gh(t)?(t.q_.M_(e),qh(t)):t.q_.set("Unknown")}async function lT(t,e,n){if(t.q_.set("Online"),e instanceof Y0&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){Z("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ml(t,r)}else if(e instanceof rl?t.Q_.Ke(e):e instanceof K0?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ue.min()))try{const r=await iv(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=i.N_.get(h);p&&i.N_.set(h,p.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,h)=>{const p=i.N_.get(u);if(!p)return;i.N_.set(u,p.withResumeToken(St.EMPTY_BYTE_STRING,p.snapshotVersion)),uv(i,u);const g=new Rr(p.target,u,h,p.sequenceNumber);Hh(i,g)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Z("RemoteStore","Failed to raise snapshot:",r),await Ml(t,r)}}async function Ml(t,e,n){if(!Yo(e))throw e;t.L_.add(1),await ea(t),t.q_.set("Offline"),n||(n=()=>iv(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Z("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await cu(t)})}function dv(t,e){return e().catch(n=>Ml(t,n,e))}async function du(t){const e=ce(t),n=qr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;uT(e);)try{const s=await qE(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,cT(e,s)}catch(s){await Ml(e,s)}hv(e)&&fv(e)}function uT(t){return Ss(t)&&t.O_.length<10}function cT(t,e){t.O_.push(e);const n=qr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function hv(t){return Ss(t)&&!qr(t).n_()&&t.O_.length>0}function fv(t){qr(t).start()}async function dT(t){qr(t).p_()}async function hT(t){const e=qr(t);for(const n of t.O_)e.m_(n.mutations)}async function fT(t,e,n){const r=t.O_.shift(),s=Oh.from(r,e,n);await dv(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await du(t)}async function pT(t,e){e&&qr(t).V_&&await async function(r,s){if(function(a){return nE(a)&&a!==z.ABORTED}(s.code)){const i=r.O_.shift();qr(r).s_(),await dv(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await du(r)}}(t,e),hv(t)&&fv(t)}async function Rm(t,e){const n=ce(t);n.asyncQueue.verifyOperationInProgress(),Z("RemoteStore","RemoteStore received new credentials");const r=Ss(n);n.L_.add(3),await ea(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await cu(n)}async function mT(t,e){const n=ce(t);e?(n.L_.delete(2),await cu(n)):e||(n.L_.add(2),await ea(n),n.q_.set("Unknown"))}function Ti(t){return t.K_||(t.K_=function(n,r,s){const i=ce(n);return i.w_(),new eT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:iT.bind(null,t),Ro:oT.bind(null,t),mo:aT.bind(null,t),d_:lT.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Gh(t)?qh(t):t.q_.set("Unknown")):(await t.K_.stop(),cv(t))})),t.K_}function qr(t){return t.U_||(t.U_=function(n,r,s){const i=ce(n);return i.w_(),new tT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:dT.bind(null,t),mo:pT.bind(null,t),f_:hT.bind(null,t),g_:fT.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await du(t)):(await t.U_.stop(),t.O_.length>0&&(Z("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new Qh(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new X(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Kh(t,e){if(ar("AsyncQueue",`${e}: ${t}`),Yo(t))return new X(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this.comparator=e?(n,r)=>e(n,r)||se.comparator(n.key,r.key):(n,r)=>se.comparator(n.key,r.key),this.keyedMap=Zi(),this.sortedSet=new He(this.comparator)}static emptySet(e){return new ri(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ri)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ri;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(){this.W_=new He(se.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ae():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class gi{constructor(e,n,r,s,i,a,l,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new gi(e,n,ri.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&su(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class yT{constructor(){this.queries=bm(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ce(n),i=s.queries;s.queries=bm(),i.forEach((a,l)=>{for(const u of l.j_)u.onError(r)})})(this,new X(z.ABORTED,"Firestore shutting down"))}}function bm(){return new Ei(t=>V0(t),su)}async function pv(t,e){const n=ce(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new gT,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=Kh(a,`Initialization of query '${Ms(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Yh(n)}async function mv(t,e){const n=ce(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function vT(t,e){const n=ce(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&Yh(n)}function _T(t,e,n){const r=ce(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Yh(t){t.Y_.forEach(e=>{e.next()})}var Ed,Dm;(Dm=Ed||(Ed={})).ea="default",Dm.Cache="cache";class gv{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new gi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=gi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ed.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e){this.key=e}}class vv{constructor(e){this.key=e}}class xT{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=me(),this.mutatedKeys=me(),this.Aa=M0(e),this.Ra=new ri(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Pm,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,g)=>{const y=s.get(p),E=iu(this.query,g)?g:null,A=!!y&&this.mutatedKeys.has(y.key),P=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let F=!1;y&&E?y.data.isEqual(E.data)?A!==P&&(r.track({type:3,doc:E}),F=!0):this.ga(y,E)||(r.track({type:2,doc:E}),F=!0,(u&&this.Aa(E,u)>0||h&&this.Aa(E,h)<0)&&(l=!0)):!y&&E?(r.track({type:0,doc:E}),F=!0):y&&!E&&(r.track({type:1,doc:y}),F=!0,(u||h)&&(l=!0)),F&&(E?(a=a.add(E),i=P?i.add(p):i.delete(p)):(a=a.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((p,g)=>function(E,A){const P=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae()}};return P(E)-P(A)}(p.type,g.type)||this.Aa(p.doc,g.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,h=u!==this.Ea;return this.Ea=u,a.length!==0||h?{snapshot:new gi(this.query,e.Ra,i,a,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Pm,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=me(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new vv(r))}),this.da.forEach(r=>{e.has(r)||n.push(new yv(r))}),n}ba(e){this.Ta=e.Ts,this.da=me();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return gi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class wT{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class ST{constructor(e){this.key=e,this.va=!1}}class ET{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Ei(l=>V0(l),su),this.Ma=new Map,this.xa=new Set,this.Oa=new He(se.comparator),this.Na=new Map,this.La=new Bh,this.Ba={},this.ka=new Map,this.qa=mi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function TT(t,e,n=!0){const r=Tv(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await _v(r,e,n,!0),s}async function IT(t,e){const n=Tv(t);await _v(n,e,!0,!1)}async function _v(t,e,n,r){const s=await GE(t.localStore,Ln(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await CT(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&lv(t.remoteStore,s),l}async function CT(t,e,n,r,s){t.Ka=(g,y,E)=>async function(P,F,I,S){let C=F.view.ma(I);C.ns&&(C=await Cm(P.localStore,F.query,!1).then(({documents:v})=>F.view.ma(v,C)));const V=S&&S.targetChanges.get(F.targetId),L=S&&S.targetMismatches.get(F.targetId)!=null,M=F.view.applyChanges(C,P.isPrimaryClient,V,L);return jm(P,F.targetId,M.wa),M.snapshot}(t,g,y,E);const i=await Cm(t.localStore,e,!0),a=new xT(e,i.Ts),l=a.ma(i.documents),u=Zo.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=a.applyChanges(l,t.isPrimaryClient,u);jm(t,n,h.wa);const p=new wT(e,n,a);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function AT(t,e,n){const r=ce(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!su(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Sd(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Wh(r.remoteStore,s.targetId),Td(r,s.targetId)}).catch(Ko)):(Td(r,s.targetId),await Sd(r.localStore,s.targetId,!0))}async function kT(t,e){const n=ce(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Wh(n.remoteStore,r.targetId))}async function RT(t,e,n){const r=MT(t);try{const s=await function(a,l){const u=ce(a),h=lt.now(),p=l.reduce((E,A)=>E.add(A.key),me());let g,y;return u.persistence.runTransaction("Locally write mutations","readwrite",E=>{let A=lr(),P=me();return u.cs.getEntries(E,p).next(F=>{A=F,A.forEach((I,S)=>{S.isValidDocument()||(P=P.add(I))})}).next(()=>u.localDocuments.getOverlayedDocuments(E,A)).next(F=>{g=F;const I=[];for(const S of l){const C=XS(S,g.get(S.key).overlayedDocument);C!=null&&I.push(new Yr(S.key,C,A0(C.value.mapValue),Cn.exists(!0)))}return u.mutationQueue.addMutationBatch(E,h,I,l)}).next(F=>{y=F;const I=F.applyToLocalDocumentSet(g,P);return u.documentOverlayCache.saveOverlays(E,F.batchId,I)})}).then(()=>({batchId:y.batchId,changes:O0(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,u){let h=a.Ba[a.currentUser.toKey()];h||(h=new He(xe)),h=h.insert(l,u),a.Ba[a.currentUser.toKey()]=h}(r,s.batchId,n),await ta(r,s.changes),await du(r.remoteStore)}catch(s){const i=Kh(s,"Failed to persist write");n.reject(i)}}async function xv(t,e){const n=ce(t);try{const r=await WE(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(Te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?Te(a.va):s.removedDocuments.size>0&&(Te(a.va),a.va=!1))}),await ta(n,r,e)}catch(r){await Ko(r)}}function Nm(t,e,n){const r=ce(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const u=ce(a);u.onlineState=l;let h=!1;u.queries.forEach((p,g)=>{for(const y of g.j_)y.Z_(l)&&(h=!0)}),h&&Yh(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function PT(t,e,n){const r=ce(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new He(se.comparator);a=a.insert(i,Pt.newNoDocument(i,ue.min()));const l=me().add(i),u=new lu(ue.min(),new Map,new He(xe),a,l);await xv(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Xh(r)}else await Sd(r.localStore,e,!1).then(()=>Td(r,e,n)).catch(Ko)}async function bT(t,e){const n=ce(t),r=e.batch.batchId;try{const s=await $E(n.localStore,e);Sv(n,r,null),wv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ta(n,s)}catch(s){await Ko(s)}}async function DT(t,e,n){const r=ce(t);try{const s=await function(a,l){const u=ce(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,l).next(g=>(Te(g!==null),p=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(r.localStore,e);Sv(r,e,n),wv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ta(r,s)}catch(s){await Ko(s)}}function wv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Sv(t,e,n){const r=ce(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Td(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Ev(t,r)})}function Ev(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Wh(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Xh(t))}function jm(t,e,n){for(const r of n)r instanceof yv?(t.La.addReference(r.key,e),NT(t,r)):r instanceof vv?(Z("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Ev(t,r.key)):ae()}function NT(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(Z("SyncEngine","New document in limbo: "+n),t.xa.add(r),Xh(t))}function Xh(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new se(Ve.fromString(e)),r=t.qa.next();t.Na.set(r,new ST(n)),t.Oa=t.Oa.insert(n,r),lv(t.remoteStore,new Rr(Ln(Mh(n.path)),r,"TargetPurposeLimboResolution",Ph.oe))}}async function ta(t,e,n){const r=ce(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{a.push(r.Ka(u,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const g=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){s.push(h);const g=$h.Wi(u.targetId,h);i.push(g)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(u,h){const p=ce(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>U.forEach(h,y=>U.forEach(y.$i,E=>p.persistence.referenceDelegate.addReference(g,y.targetId,E)).next(()=>U.forEach(y.Ui,E=>p.persistence.referenceDelegate.removeReference(g,y.targetId,E)))))}catch(g){if(!Yo(g))throw g;Z("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const y=g.targetId;if(!g.fromCache){const E=p.os.get(y),A=E.snapshotVersion,P=E.withLastLimboFreeSnapshotVersion(A);p.os=p.os.insert(y,P)}}}(r.localStore,i))}async function jT(t,e){const n=ce(t);if(!n.currentUser.isEqual(e)){Z("SyncEngine","User change. New user:",e.toKey());const r=await sv(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new X(z.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ta(n,r.hs)}}function VT(t,e){const n=ce(t),r=n.Na.get(e);if(r&&r.va)return me().add(r.key);{let s=me();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}function Tv(t){const e=ce(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=xv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=VT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=PT.bind(null,e),e.Ca.d_=vT.bind(null,e.eventManager),e.Ca.$a=_T.bind(null,e.eventManager),e}function MT(t){const e=ce(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=bT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DT.bind(null,e),e}class Ll{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=uu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return UE(this.persistence,new zE,e.initialUser,this.serializer)}Ga(e){return new LE(Uh.Zr,this.serializer)}Wa(e){return new KE}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ll.provider={build:()=>new Ll};class Id{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Nm(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=jT.bind(null,this.syncEngine),await mT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new yT}()}createDatastore(e){const n=uu(e.databaseInfo.databaseId),r=function(i){return new ZE(i)}(e.databaseInfo);return function(i,a,l,u){return new nT(i,a,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new sT(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Nm(this.syncEngine,n,0),function(){return km.D()?new km:new YE}())}createSyncEngine(e,n){return function(s,i,a,l,u,h,p){const g=new ET(s,i,a,l,u,h);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ce(s);Z("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await ea(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Id.provider={build:()=>new Id};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ar("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ut.UNAUTHENTICATED,this.clientId=T0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{Z("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(Z("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Kh(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function lc(t,e){t.asyncQueue.verifyOperationInProgress(),Z("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await sv(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Vm(t,e){t.asyncQueue.verifyOperationInProgress();const n=await OT(t);Z("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Rm(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Rm(e.remoteStore,s)),t._onlineComponents=e}async function OT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Z("FirestoreClient","Using user provided OfflineComponentProvider");try{await lc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Vo("Error using user provided cache. Falling back to memory cache: "+n),await lc(t,new Ll)}}else Z("FirestoreClient","Using default OfflineComponentProvider"),await lc(t,new Ll);return t._offlineComponents}async function Cv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Z("FirestoreClient","Using user provided OnlineComponentProvider"),await Vm(t,t._uninitializedComponentsProvider._online)):(Z("FirestoreClient","Using default OnlineComponentProvider"),await Vm(t,new Id))),t._onlineComponents}function FT(t){return Cv(t).then(e=>e.syncEngine)}async function Av(t){const e=await Cv(t),n=e.eventManager;return n.onListen=TT.bind(null,e.syncEngine),n.onUnlisten=AT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=IT.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=kT.bind(null,e.syncEngine),n}function zT(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,h){const p=new Iv({next:y=>{p.Za(),a.enqueueAndForget(()=>mv(i,g));const E=y.docs.has(l);!E&&y.fromCache?h.reject(new X(z.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&y.fromCache&&u&&u.source==="server"?h.reject(new X(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(y)},error:y=>h.reject(y)}),g=new gv(Mh(l.path),p,{includeMetadataChanges:!0,_a:!0});return pv(i,g)}(await Av(t),t.asyncQueue,e,n,r)),r.promise}function BT(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,h){const p=new Iv({next:y=>{p.Za(),a.enqueueAndForget(()=>mv(i,g)),y.fromCache&&u.source==="server"?h.reject(new X(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(y)},error:y=>h.reject(y)}),g=new gv(l,p,{includeMetadataChanges:!0,_a:!0});return pv(i,g)}(await Av(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mm=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(t,e,n){if(!n)throw new X(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function UT(t,e,n,r){if(e===!0&&r===!0)throw new X(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Lm(t){if(!se.isDocumentKey(t))throw new X(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Om(t){if(se.isDocumentKey(t))throw new X(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function hu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae()}function ur(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new X(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=hu(t);throw new X(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new X(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new X(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}UT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new X(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new X(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new X(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Jh{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Fm({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new X(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new X(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Fm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new oS;switch(r.type){case"firstParty":return new uS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new X(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Mm.get(n);r&&(Z("ComponentProvider","Removing Datastore"),Mm.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ii(this.firestore,e,this._query)}}class Mt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Br(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Mt(this.firestore,e,this._key)}}class Br extends Ii{constructor(e,n,r){super(e,n,Mh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Mt(this.firestore,null,new se(e))}withConverter(e){return new Br(this.firestore,e,this._path)}}function $o(t,e,...n){if(t=kn(t),Rv("collection","path",e),t instanceof Jh){const r=Ve.fromString(e,...n);return Om(r),new Br(t,null,r)}{if(!(t instanceof Mt||t instanceof Br))throw new X(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ve.fromString(e,...n));return Om(r),new Br(t.firestore,null,r)}}function bt(t,e,...n){if(t=kn(t),arguments.length===1&&(e=T0.newId()),Rv("doc","path",e),t instanceof Jh){const r=Ve.fromString(e,...n);return Lm(r),new Mt(t,null,new se(r))}{if(!(t instanceof Mt||t instanceof Br))throw new X(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ve.fromString(e,...n));return Lm(r),new Mt(t.firestore,t instanceof Br?t.converter:null,new se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new ov(this,"async_queue_retry"),this.Vu=()=>{const r=ac();r&&Z("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=ac();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=ac();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new er;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Yo(e))throw e;Z("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw ar("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Qh.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ae()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Ci extends Jh{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new zm,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new zm(e),this._firestoreClient=void 0,await e}}}function $T(t,e,n){n||(n="(default)");const r=p0(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Rl(i,e))return s;throw new X(z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new X(z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new X(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function Zh(t){if(t._terminated)throw new X(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||WT(t),t._firestoreClient}function WT(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,h,p){return new SS(l,u,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,kv(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new LT(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yi(St.fromBase64String(e))}catch(n){throw new X(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new yi(St.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new X(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new X(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new X(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT=/^__.*__$/;class qT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Yr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Jo(e,this.data,n,this.fieldTransforms)}}class Pv{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Yr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function bv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae()}}class nf{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new nf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ol(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(bv(this.Cu)&&HT.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class GT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||uu(e)}Qu(e,n,r,s=!1){return new nf({Cu:e,methodName:n,qu:r,path:vt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mu(t){const e=t._freezeSettings(),n=uu(t._databaseId);return new GT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Dv(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);sf("Data must be an object, but it was:",a,r);const l=Nv(r,a);let u,h;if(i.merge)u=new rn(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const p=[];for(const g of i.mergeFields){const y=Cd(e,g,n);if(!a.contains(y))throw new X(z.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Vv(p,y)||p.push(y)}u=new rn(p),h=a.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=a.fieldTransforms;return new qT(new Wt(l),u,h)}class gu extends pu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gu}}class rf extends pu{_toFieldTransform(e){return new GS(e.path,new zo)}isEqual(e){return e instanceof rf}}function QT(t,e,n,r){const s=t.Qu(1,e,n);sf("Data must be an object, but it was:",s,r);const i=[],a=Wt.empty();ws(r,(u,h)=>{const p=of(e,u,n);h=kn(h);const g=s.Nu(p);if(h instanceof gu)i.push(p);else{const y=na(h,g);y!=null&&(i.push(p),a.set(p,y))}});const l=new rn(i);return new Pv(a,l,s.fieldTransforms)}function KT(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[Cd(e,r,n)],u=[s];if(i.length%2!=0)throw new X(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)l.push(Cd(e,i[y])),u.push(i[y+1]);const h=[],p=Wt.empty();for(let y=l.length-1;y>=0;--y)if(!Vv(h,l[y])){const E=l[y];let A=u[y];A=kn(A);const P=a.Nu(E);if(A instanceof gu)h.push(E);else{const F=na(A,P);F!=null&&(h.push(E),p.set(E,F))}}const g=new rn(h);return new Pv(p,g,a.fieldTransforms)}function YT(t,e,n,r=!1){return na(n,t.Qu(r?4:3,e))}function na(t,e){if(jv(t=kn(t)))return sf("Unsupported field value:",e,t),Nv(t,e);if(t instanceof pu)return function(r,s){if(!bv(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let u=na(l,s.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=kn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return WS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=lt.fromDate(r);return{timestampValue:Vl(s.serializer,i)}}if(r instanceof lt){const i=new lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vl(s.serializer,i)}}if(r instanceof ef)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof yi)return{bytesValue:X0(s.serializer,r._byteString)};if(r instanceof Mt){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:zh(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof tf)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return Lh(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${hu(r)}`)}(t,e)}function Nv(t,e){const n={};return I0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ws(t,(r,s)=>{const i=na(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function jv(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof lt||t instanceof ef||t instanceof yi||t instanceof Mt||t instanceof pu||t instanceof tf)}function sf(t,e,n){if(!jv(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=hu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Cd(t,e,n){if((e=kn(e))instanceof fu)return e._internalPath;if(typeof e=="string")return of(t,e);throw Ol("Field path arguments must be of type string or ",t,!1,void 0,n)}const XT=new RegExp("[~\\*/\\[\\]]");function of(t,e,n){if(e.search(XT)>=0)throw Ol(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new fu(...e.split("."))._internalPath}catch{throw Ol(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ol(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new X(z.INVALID_ARGUMENT,l+t+u)}function Vv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Mt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(af("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class JT extends Mv{data(){return super.data()}}function af(t,e){return typeof e=="string"?of(t,e):e instanceof fu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new X(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class lf{}class eI extends lf{}function tI(t,e,...n){let r=[];e instanceof lf&&r.push(e),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof uf).length,l=i.filter(u=>u instanceof yu).length;if(a>1||a>0&&l>0)throw new X(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class yu extends eI{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new yu(e,n,r)}_apply(e){const n=this._parse(e);return Lv(e._query,n),new Ii(e.firestore,e.converter,gd(e._query,n))}_parse(e){const n=mu(e.firestore);return function(i,a,l,u,h,p,g){let y;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new X(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){$m(g,p);const E=[];for(const A of g)E.push(Um(u,i,A));y={arrayValue:{values:E}}}else y=Um(u,i,g)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||$m(g,p),y=YT(l,a,g,p==="in"||p==="not-in");return rt.create(h,p,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Bm(t,e,n){const r=e,s=af("where",t);return yu._create(s,r,n)}class uf extends lf{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new uf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Rn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const u of l)Lv(a,u),a=gd(a,u)}(e._query,n),new Ii(e.firestore,e.converter,gd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Um(t,e,n){if(typeof(n=kn(n))=="string"){if(n==="")throw new X(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!j0(e)&&n.indexOf("/")!==-1)throw new X(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ve.fromString(n));if(!se.isDocumentKey(r))throw new X(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return um(t,new se(r))}if(n instanceof Mt)return um(t,n._key);throw new X(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hu(n)}.`)}function $m(t,e){if(!Array.isArray(t)||t.length===0)throw new X(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Lv(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new X(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new X(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class nI{convertValue(e,n="none"){switch(vs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ye(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ys(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ae()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ws(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>Ye(a.doubleValue));return new tf(i)}convertGeoPoint(e){return new ef(Ye(e.latitude),Ye(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Dh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Lo(e));default:return null}}convertTimestamp(e){const n=Hr(e);return new lt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ve.fromString(e);Te(rv(r));const s=new Oo(r.get(1),r.get(3)),i=new se(r.popFirst(5));return s.isEqual(n)||ar(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ov(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fv extends Mv{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new sl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(af("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class sl extends Fv{data(e={}){return super.data(e)}}class rI{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new to(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new sl(this._firestore,this._userDataWriter,r.key,r,new to(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new X(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const u=new sl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new to(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new sl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new to(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,p=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:sI(l.type),doc:u,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function sI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(t){t=ur(t,Mt);const e=ur(t.firestore,Ci);return zT(Zh(e),t._key).then(n=>iI(e,t,n))}class zv extends nI{constructor(e){super(),this.firestore=e}convertBytes(e){return new yi(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Mt(this.firestore,null,n)}}function Ad(t){t=ur(t,Ii);const e=ur(t.firestore,Ci),n=Zh(e),r=new zv(e);return ZT(t._query),BT(n,t._query).then(s=>new rI(e,r,t,s))}function kd(t,e,n){t=ur(t,Mt);const r=ur(t.firestore,Ci),s=Ov(t.converter,e,n);return df(r,[Dv(mu(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Cn.none())])}function Yn(t,e,n,...r){t=ur(t,Mt);const s=ur(t.firestore,Ci),i=mu(s);let a;return a=typeof(e=kn(e))=="string"||e instanceof fu?KT(i,"updateDoc",t._key,e,n,r):QT(i,"updateDoc",t._key,e),df(s,[a.toMutation(t._key,Cn.exists(!0))])}function Bv(t,e){const n=ur(t.firestore,Ci),r=bt(t),s=Ov(t.converter,e);return df(n,[Dv(mu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Cn.exists(!1))]).then(()=>r)}function df(t,e){return function(r,s){const i=new er;return r.asyncQueue.enqueueAndForget(async()=>RT(await FT(r),s,i)),i.promise}(Zh(t),e)}function iI(t,e,n){const r=n.docs.get(e._key),s=new zv(t);return new Fv(t,s,e._key,r,new to(n.hasPendingWrites,n.fromCache),e.converter)}function En(){return new rf("serverTimestamp")}(function(e,n=!0){(function(s){Si=s})(qw),No(new di("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new Ci(new aS(r.getProvider("auth-internal")),new dS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new X(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Oo(h.options.projectId,p)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),zr(sm,"4.7.3",e),zr(sm,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rd="us-central1";class aI{constructor(e,n,r,s,i=Rd,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new oI(n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Rd}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function lI(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const Wm="@firebase/functions",Hm="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI="auth-internal",cI="app-check-internal",dI="messaging-internal";function hI(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),a=r.getProvider(uI),l=r.getProvider(dI),u=r.getProvider(cI);return new aI(i,a,l,u,s,t)};No(new di(Uv,n,"PUBLIC").setMultipleInstances(!0)),zr(Wm,Hm,e),zr(Wm,Hm,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(t=Gw(),e=Rd){const r=p0(kn(t),Uv).getImmediate({identifier:e}),s=O1("functions");return s&&pI(r,...s),r}function pI(t,e,n){lI(kn(t),e,n)}hI(fetch.bind(self));const mI={apiKey:'"AIzaSyDRdl4zhwoZumVtphmJ19orZ8HoR0WQQZM",',authDomain:'"qualtrics-game-backend.firebaseapp.com",',projectId:'"qualtrics-game-backend",',storageBucket:'"qualtrics-game-backend.firebasestorage.app",',messagingSenderId:'"441267092549",',appId:"1:441267092549:web:6ce075f5f3ea7cf958772c"},$v=m0(mI),tt=$T($v,{experimentalForceLongPolling:!1,useFetchStreams:!1});fI($v);const et={init(){localStorage.getItem("sessionId")||(localStorage.setItem("sessionId",this.generateSessionId()),localStorage.setItem("sessionStartTime",Date.now().toString())),localStorage.getItem("semesterStartTime")||localStorage.setItem("semesterStartTime",Date.now().toString())},generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},async logEvent(t,e){const n=localStorage.getItem("sessionId")||this.generateSessionId(),r=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),s=Date.now(),i=s-r,a=(i/1e3).toFixed(1),l=Math.floor(i/6e4),u=Math.floor(i%6e4/1e3),h=`${l}:${u.toString().padStart(2,"0")}`,p=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),g=this.getFullGameContext(),y={sessionId:n,studentId:p.studentId||null,type:t,timestamp:new Date().toISOString(),clientTimestamp:s,timeElapsedSeconds:parseFloat(a),readableTime:h,semesterTime:this.getSemesterTime(),...g,isAdminMode:p.role==="admin",hasCheckpoint:p.checkpointSemester2||!1,hasAI:p.hasAI||!1,section:p.section||null,...this.convertTimesToSeconds(e)};(t==="user_action"||t==="task_attempt")&&console.log(`DEBUG: Event ${t} - studentId: ${y.studentId}, role: ${p.role}`);try{await Bv($o(tt,"events"),y)}catch(E){console.error("Failed to log event:",E),this.storeOfflineEvent(y)}},convertTimesToSeconds(t){const e={...t},n=["timeTaken","timeSpent","totalTime","timeOnPreviousPage","averageTime","timeBetweenHelpAndSubmit"];for(const r of n)e[r]!==void 0&&e[r]!==null&&(e[`${r}Seconds`]=(e[r]/1e3).toFixed(1),delete e[r]);return e.timeProgression&&(e.timeProgressionSeconds=e.timeProgression.map(r=>(r/1e3).toFixed(1)),delete e.timeProgression),e.timePerAttempt&&(e.timePerAttemptSeconds=e.timePerAttempt.map(r=>(r/1e3).toFixed(1)),delete e.timePerAttempt),e},getSemesterTime(){const t=parseInt(localStorage.getItem("semesterStartTime")||Date.now()),e=Date.now()-t,n=(e/1e3).toFixed(1),r=Math.floor(e/6e4),s=Math.floor(e%6e4/1e3);return{elapsedSeconds:parseFloat(n),readable:`${r}:${s.toString().padStart(2,"0")}`,minutes:r,seconds:s}},getCurrentContext(){const t=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),e=((Date.now()-t)/1e3).toFixed(1);return{currentTask:localStorage.getItem("currentTask"),gameMode:localStorage.getItem("gameMode"),totalCompleted:this.getCompletedTaskCount(),currentStreak:this.getCurrentStreak(),sessionDurationSeconds:parseFloat(e)}},getFullGameContext(){const t=localStorage.getItem("currentTask")||"",e=localStorage.getItem("gameMode")||"",n=parseInt(localStorage.getItem("currentSemester")||"1"),r=parseInt(localStorage.getItem("totalSemesters")||"2"),s=localStorage.getItem("practiceCompleted")==="true",i=parseInt(localStorage.getItem("completedTasksCount")||"0"),a=parseInt(localStorage.getItem("completedLevels")||"0"),l=parseInt(localStorage.getItem("totalSwitches")||"0"),u=parseInt(localStorage.getItem("aiUsageCount")||"0"),h=JSON.parse(localStorage.getItem("categoryPoints")||"{}"),p=parseFloat(localStorage.getItem("studentLearningScore")||"0");return{currentTask:t,gameMode:e,currentSemester:n,totalSemesters:r,practiceCompleted:s,completedTasks:i,completedLevels:a,totalSwitches:l,aiUsageCount:u,studentLearning:p,totalBonus:h.bonus||0,finalScore:Math.round(p)+(h.bonus||0),semester:n}},calculateImprovementTrend(t){if(!t||t.length<3)return"needs_more_data";const n=t.slice(-5).map(s=>s.accuracy),r=this.calculateTrend(n);return r>5?"rapid_improvement":r>2?"steady_improvement":r>0?"slight_improvement":r>-2?"stable":r>-5?"slight_decline":"rapid_decline"},calculateImprovementRate(t){if(!t||t.length<2)return{overall:0,trend:0,isImproving:!1,dataPoints:t?t.length:0};const e=t[0].accuracy,r=t[t.length-1].accuracy-e;if(t.length<3)return{overall:r,trend:r,isImproving:r>0,dataPoints:t.length};const s=Math.floor(t.length/2),i=t.slice(0,s).reduce((u,h)=>u+h.accuracy,0)/s,l=t.slice(s).reduce((u,h)=>u+h.accuracy,0)/(t.length-s)-i;return{overall:r,trend:l,isImproving:l>0,dataPoints:t.length}},setPageStartTime(t){t&&localStorage.setItem(`pageStartTime_${t}`,Date.now().toString())},getTimeOnCurrentPage(t){if(!t)return 0;const e=localStorage.getItem(`pageStartTime_${t}`);return e?Date.now()-parseInt(e):0},ensureSession(){localStorage.getItem("sessionId")||this.init()},async trackAIHelpResponse(t,e,n,r,s,i){const a=parseInt(localStorage.getItem("aiUsageCount")||"0");return localStorage.setItem("aiUsageCount",(a+1).toString()),this.logEvent("ai_help_response",{taskId:t,helpType:e,suggestion:n,playerAction:r,playerValue:s,timeBetween:i})},async trackTaskAttempt(t,e){return this.logEvent("task_attempt",{taskId:t,...e})},async trackUserAction(t,e){return this.logEvent("user_action",{action:t,response:e.response||"",query:e.query||"",queryType:e.queryType||"",choice:e.choice||"",currentMode:e.currentMode||"",...e})},async syncOfflineEvents(){return console.log("Syncing offline events..."),Promise.resolve()},async trackTaskComplete(t,e){return this.logEvent("task_complete",{taskId:t,...e})},async trackPageSwitch(t,e,n){return this.logEvent("page_switch",{from:t,to:e,isAutoAdvance:n})},trackAITaskHelp(t,e,n,r,s){return this.logEvent("ai_task_help",{taskId:t,taskType:e,suggestion:n,wasCorrect:r,attemptNumber:s})}};et.init();const tr={seedRandom:null,currentSeed:null,initializeSeed(t){this.currentSeed=t;let e=t;this.seedRandom=function(){return e=(e*9301+49297)%233280,e/233280}},getRandom(){return this.seedRandom?this.seedRandom():Math.random()},generateCountingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n;e==="easy"?n=(t-1)%5+1:e==="medium"?n=(t-11)%5+6:n=(t-25)%5+11;const s={easy:{1:{target:"the",type:"word"},2:{target:"and",type:"word"},3:{target:"of",type:"word"},4:{target:"to",type:"word"},5:{target:"in",type:"word"}},medium:{6:{target:"e",type:"letter"},7:{target:"a",type:"letter"},8:{target:"i",type:"letter"},9:{target:"o",type:"letter"},10:{target:"s",type:"letter"}},hard:{11:{targets:["a","e"],type:"multi-letter"},12:{targets:["i","o"],type:"multi-letter"},13:{targets:["s","t"],type:"multi-letter"},14:{targets:["n","r"],type:"multi-letter"},15:{targets:["l","d"],type:"multi-letter"}}}[e][n];let i="";return s.type==="word"?i=`Count how many times the word "${s.target}" appears:`:s.type==="letter"?i=`Count how many times the letter "${s.target}" appears (case-insensitive):`:i=`Count how many times the letters "${s.targets[0]}" and "${s.targets[1]}" appear in total:`,{...s,instruction:i,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},generateSliderPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n,r,s;return e==="easy"?(n=Math.floor(this.getRandom()*11),r=1,s=!0):e==="medium"?(n=Math.round(this.getRandom()*10*10)/10,r=.1,s=!0):(n=Math.round(this.getRandom()*10*100)/100,r=.01,s=(t-25)%5!==0),{target:n,step:r,showValue:s,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1),precision:e==="easy"?0:e==="medium"?1:2}},generateTypingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard",n={easy:["hello world","quick test","type this","easy mode","simple text","good job","keep going","nice work","almost done","level up"],medium:["HeLLo WoRLd","QuIcK tEsT","TyPe ThIs","MeDiUm MoDe","MiXeD cAsE","KeEp GoInG","NiCe WoRk","AlMoSt DoNe","LeVeL uP","ChAlLeNgE","TeSt RuN","NeXt LeVeL","TrY aGaIn","GoOd LuCk","FiNaL tEsT"],hard:["Test@123","Go4It!Now","X9%Y8&Z7*","P6!Q5?R4+","Z1@Y2#X3$","M7&N8*O9!","J4%K5^L6&","D1!E2@F3#","A7$B8%C9^","V3*W4+X5=","Q2#R3$S4%","H5^I6&J7*","K8(L9)M0!","N1@O2#P3$","T4%U5^V6&","W7*X8(Y9)","C0!D1@E2#","F3$G4%H5^","I6&J7*K8(","L9)M0!N1@","O2#P3$Q4%","R5^S6&T7*","U8(V9)W0!","X1@Y2#Z3$","A4%B5^C6&"]};let r;if(e==="easy"){const s=(t-1)%n.easy.length;r=n.easy[s]}else if(e==="medium"){const s=(t-11)%n.medium.length;r=n.medium[s]}else{const s=(t-25)%n.hard.length;r=n.hard[s]}return{pattern:r,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},textPassages:["The University of California, Berkeley (UC Berkeley, Berkeley, Cal, or California) is a public land-grant research university in Berkeley, California, United States. Founded in 1868 and named after the Anglo-Irish philosopher George Berkeley, it is the state's first land-grant university and is the founding campus of the University of California system.","Berkeley has an enrollment of more than 45,000 students. The university is organized around fifteen schools of study on the same campus, including the College of Chemistry, the College of Engineering, College of Letters and Science, and the Haas School of Business.",'The Berkeley campus encompasses approximately 1,232 acres, though the "central campus" occupies only the low-lying western 178 acres. The campus contains numerous wooded areas, including the Eucalyptus Grove and Strawberry Creek, which runs through the center of campus.',"Oski the Bear (Oski) is the official mascot of the University of California, Berkeley, representing the California Golden Bears. Named after the Oski Yell, he made his debut at a freshman rally in the Greek Theatre on September 25, 1941.","Berkeley faculty, alumni, and researchers have won 111 Nobel laureates, 25 Turing Award winners, and 19 Academy Award winners. The university has produced many notable alumni in various fields including science, politics, business, and entertainment.","The university's athletic teams compete as the California Golden Bears and are members of the Atlantic Coast Conference for most sports. Berkeley teams have won 107 national championships, including 45 NCAA national championships.","Research at Berkeley is conducted within departments, organized research units, and interdisciplinary research centers. Berkeley operates Lawrence Berkeley National Laboratory, manages Los Alamos National Laboratory, and is a founding partner of the Space Sciences Laboratory.","The Berkeley campus offers over 350 degree programs through its 14 colleges and schools. Popular majors include Computer Science, Economics, Political Science, and Business Administration. The student-faculty ratio is 17:1.","Berkeley's libraries contain more than 13 million volumes and maintain special collections including the Mark Twain Papers, the Oral History Center, and the Bancroft Library, which houses the largest collection of materials on California history.","The campus is home to several museums including the Berkeley Art Museum and Pacific Film Archive, the Lawrence Hall of Science, and the UC Botanical Garden. These facilities serve both educational and public outreach purposes.","Notable Berkeley inventions and discoveries include the cyclotron, the atomic bomb, the flu vaccine, and vitamin E. Berkeley researchers discovered 16 chemical elements of the periodic table, more than any other university.","The Free Speech Movement, which took place during the 1964-65 academic year, was a pivotal moment in the history of civil liberties in the United States. It began when students protested a ban on political activities on campus.","Berkeley's Campanile, known as Sather Tower, is the third-tallest clock tower in the world at 307 feet. It was completed in 1914 and is visible for miles, serving as a symbol of the university.","The university operates on a semester system, with fall semester beginning in late August and spring semester beginning in mid-January. Berkeley offers over 5,000 courses each semester across all disciplines.",`Cal Bears have won at least one team national title in 13 different sports. The university's traditional rival is Stanford University, with the annual football game known as "The Big Game" dating back to 1892.`],getTextPassage(t){if(this.seedRandom){const e=Math.floor(this.getRandom()*this.textPassages.length),n=(t-1+e)%this.textPassages.length;return this.textPassages[n]}else{const e=(t-1)%this.textPassages.length;return this.textPassages[e]}}};function Pd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=D.useState(""),[a,l]=D.useState(""),[u,h]=D.useState(null),[p,g]=D.useState(""),[y,E]=D.useState(null),[A,P]=D.useState(""),[F,I]=D.useState(""),[S]=D.useState(Date.now()),[C,V]=D.useState(""),[L,M]=D.useState(!1),[v,m]=D.useState(new Set),x=D.useRef(0);D.useRef(null);const w=(re,ie=null,$=null)=>{const N=document.createElement("canvas"),O=N.getContext("2d");N.width=900,N.height=400,O.fillStyle="#fafafa",O.fillRect(0,0,N.width,N.height),O.strokeStyle="#e0e0e0",O.lineWidth=2,O.strokeRect(0,0,N.width,N.height),O.font="24px monospace",O.fillStyle="#333";const G=36,ee=25,te=N.width-ee*2;return((we,fe)=>{const de=we.split(" "),Fe=[];let Se="";for(let ne of de){const Ce=Se+(Se?" ":"")+ne;O.measureText(Ce).width>fe&&Se?(Fe.push(Se),Se=ne):Se=Ce}return Se&&Fe.push(Se),Fe})(re,te).forEach((we,fe)=>{const de=ee+(fe+1)*G;let Fe=ee;if(t<=5){const Se=we.split(" ");let ne=0;Se.forEach(Ce=>{const ze=$&&$.has(ne),Re=ie&&ie.some(Et=>Ce.toLowerCase()===Et.toLowerCase());if(ze){const Et=O.measureText(Ce).width;O.fillStyle="yellow",O.fillRect(Fe-2,de-18,Et+4,24)}else if(Re){const Et=O.measureText(Ce).width;O.fillStyle="rgba(255, 215, 0, 0.4)",O.fillRect(Fe-2,de-18,Et+4,24)}O.fillStyle="#333",O.fillText(Ce,Fe,de),Fe+=O.measureText(Ce+" ").width,ne++})}else for(let Se=0;Se<we.length;Se++){const ne=we[Se],Ce=O.measureText(ne).width;ie&&ie.some(Re=>ne.toLowerCase()===Re.toLowerCase())&&(O.fillStyle="rgba(255, 215, 0, 0.4)",O.fillRect(Fe-1,de-18,Ce+2,24)),O.fillStyle="#333",O.fillText(ne,Fe,de),Fe+=Ce}}),N.toDataURL()};D.useEffect(()=>{g(0),E(null),x.current=0},[t]),D.useEffect(()=>{const re=async($,N)=>{const O=document.createElement("canvas"),G=O.getContext("2d");O.width=900,O.height=350,G.fillStyle="#fafafa",G.fillRect(0,0,O.width,O.height),G.strokeStyle="#e0e0e0",G.lineWidth=2,G.strokeRect(0,0,O.width,O.height),G.font="24px monospace";const ee=36,te=20,le=O.width-te*2,we=((fe,de)=>{const Fe=fe.split(" "),Se=[];let ne="";for(let Ce of Fe){const ze=ne+(ne?" ":"")+Ce;G.measureText(ze).width>de&&ne?(Se.push(ne),ne=Ce):ne=ze}return ne&&Se.push(ne),Se})(A,le);for(let fe=0;fe<$.length;fe++)$[fe],we.forEach((de,Fe)=>{const Se=te+(Fe+1)*ee;let ne=te;for(let Ce=0;Ce<de.length;Ce++){const ze=de[Ce],Re=G.measureText(ze).width;$.some(Kt=>ze.toLowerCase()===Kt.toLowerCase())&&(G.fillStyle="rgba(255, 255, 0, 0.6)",G.fillRect(ne-1,Se-20,Re+2,26)),G.fillStyle="#333",G.fillText(ze,ne,Se),ne+=Re}}),V(O.toDataURL()),await new Promise(de=>setTimeout(de,300));setTimeout(()=>{g(N.toString())},300)},ie=async $=>{const{action:N,highlightWords:O,suggestedCount:G,animate:ee,isMultiLetter:te,targetLetters:le}=$.detail||{};if(N==="highlightAndCount"){if(te&&Array.isArray(le)){ee&&await re(le,G);return}if(Array.isArray(O)&&ee){A.split(" ");let ke=[];for(let we=0;we<O.length;we++){ke.push(O[we]);const fe=document.createElement("canvas"),de=fe.getContext("2d");fe.width=900,fe.height=350,de.fillStyle="#fafafa",de.fillRect(0,0,fe.width,fe.height),de.strokeStyle="#e0e0e0",de.lineWidth=2,de.strokeRect(0,0,fe.width,fe.height),de.font="24px monospace";const Fe=36,Se=20,ne=fe.width-Se*2;((Re,Et)=>{const Kt=Re.split(" "),Yt=[];let Xt="";for(let Jt of Kt){const dr=Xt+(Xt?" ":"")+Jt;de.measureText(dr).width>Et&&Xt?(Yt.push(Xt),Xt=Jt):Xt=dr}return Xt&&Yt.push(Xt),Yt})(A,ne).forEach((Re,Et)=>{const Kt=Se+(Et+1)*Fe;let Yt=Se;Re.split(" ").forEach(Jt=>{const dr=de.measureText(Jt).width;ke.some(Pn=>{const fr=Jt.replace(/[.,;!?]/g,"").toLowerCase(),Pe=Pn.replace(/[.,;!?]/g,"").toLowerCase();return fr===Pe})&&(de.fillStyle="rgba(255, 255, 0, 0.5)",de.fillRect(Yt-2,Kt-18,dr+4,24)),de.fillStyle="#333",de.fillText(Jt,Yt,Kt),Yt+=de.measureText(Jt+" ").width})}),V(fe.toDataURL()),await new Promise(Re=>setTimeout(Re,200))}setTimeout(()=>{g(G.toString())},300)}}};return window.addEventListener("aiCountingHelp",ie),()=>window.removeEventListener("aiCountingHelp",ie)},[A,t]),D.useEffect(()=>{var O;const re=tr.generateCountingPattern(t),ie=tr.getTextPassage(t);P(ie),i(re.target||((O=re.targets)==null?void 0:O.join(", "))),l(re.instruction);let $=0;if(re.type==="word"){const G=new RegExp(`\\b${re.target}\\b`,"gi"),ee=ie.match(G);$=ee?ee.length:0}else if(re.type==="letter"){const G=new RegExp(re.target,"gi"),ee=ie.match(G);$=ee?ee.length:0}else re.type==="multi-letter"&&re.targets.forEach(G=>{const ee=new RegExp(G,"gi"),te=ie.match(ee);$+=te?te.length:0});h($);const N=w(ie,null);V(N)},[t]);const k=async()=>{const re=Date.now()-S,ie=parseInt(p,10)||0,$=u??0,N=Math.abs(ie-$),O=`g1t${t}`,G=localStorage.getItem(`lastAIHelp_${O}`);if(G){const le=JSON.parse(G),ke=Date.now()-le.timestamp,we=ie===le.suggestion?"accepted":"modified";await et.trackAIHelpResponse(O,le.type,le.suggestion,we,ie,ke),localStorage.removeItem(`lastAIHelp_${O}`)}let ee=0;N===0?ee=2:N<=1?ee=1:ee=0,x.current+=1,await et.trackTaskAttempt(O,x.current,!0,re,ie,$);const te=localStorage.getItem("sessionId");if(te&&!te.startsWith("offline-"))try{await Yn(bt(tt,"sessions",te),{[`taskAccuracies.g1t${t}`]:ee===2?100:ee===1?70:0,[`taskTimes.g1t${t}`]:re,[`taskPoints.g1t${t}`]:ee,lastActivity:En()})}catch(le){console.error("Error storing accuracy:",le)}E(ee===2?" Perfect! 2 points earned!":ee===1?` Off by ${N} - 1 point earned!`:` Off by ${N} - 0 points earned.`),setTimeout(()=>{e==null||e(`g1t${t}`,{attempts:x.current,totalTime:re,accuracy:ee===2?100:ee===1?70:0,userAnswer:ie,correctAnswer:$,points:ee})},500)},T=tr.generateCountingPattern(t).difficultyLabel,oe=t<=5?"easy":t<=10?"medium":"hard";return d.jsxs("div",{className:"task counting",children:[d.jsxs("h3",{children:["Research Content - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${oe}`,children:T}),d.jsxs("p",{className:"instruction",children:[d.jsx("strong",{children:a}),d.jsx("br",{}),d.jsx("span",{className:"hint",children:"(Case-insensitive)"})]}),d.jsxs("div",{className:"text-display text-to-count","data-counting-text":A,children:[d.jsx("div",{className:"count-target","data-pattern":s,style:{display:"none"},children:s}),C?d.jsx("img",{src:C,alt:"Text passage for counting",style:{width:"100%",maxWidth:"900px",height:"auto",maxHeight:"350px",objectFit:"contain",border:"none",userSelect:"none",pointerEvents:"none"},onContextMenu:re=>re.preventDefault(),draggable:!1}):d.jsx("div",{dangerouslySetInnerHTML:{__html:F}})]}),d.jsxs("div",{className:"input-section",children:[d.jsx("label",{children:"Your answer:"}),d.jsx("input",{type:"number",min:"0",max:"999",value:p,onChange:re=>g(re.target.value),onKeyPress:re=>{re.key==="Enter"&&k()},placeholder:"Enter count"})]}),d.jsx("button",{onClick:k,className:"submit-btn",style:{display:"block",margin:"20px auto 0"},children:"Submit"}),y&&d.jsx("div",{className:`feedback ${y.includes("2 points")?"correct":y.includes("0 points")?"incorrect":"partial"}`,children:y})]})}function bd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=D.useState(5),[a,l]=D.useState(0),[u,h]=D.useState(null),[p]=D.useState(Date.now()),[g,y]=D.useState(1),[E,A]=D.useState(!0),[P,F]=D.useState(!1),[I,S]=D.useState(!1),[C,V]=D.useState(!1),[L,M]=D.useState(!1),v=D.useRef(null),m=D.useRef(0);D.useEffect(()=>{if(n)i(3),y(1),A(!0);else{const $=tr.generateSliderPattern(t);i($.target),y($.step),A($.showValue)}l(0),h(null),m.current=0},[t,n]),D.useEffect(()=>{const $=N=>{const{action:O,value:G,animate:ee}=N.detail;if(O==="moveSlider")if(S(!0),ee){const te=parseFloat(a),le=parseFloat(G),ke=1e3,we=30;let fe=0;const de=setInterval(()=>{fe++;const Fe=fe/we,Se=1-Math.pow(1-Fe,3),ne=te+(le-te)*Se;l(parseFloat(ne.toFixed(2))),fe>=we&&(clearInterval(de),S(!1),l(parseFloat(le.toFixed(2))))},ke/we)}else l(parseFloat(G.toFixed(2))),S(!1)};return window.addEventListener("aiSliderHelp",$),()=>window.removeEventListener("aiSliderHelp",$)},[a]),D.useEffect(()=>{const $=N=>{N.key==="Enter"&&!I&&R()};return document.addEventListener("keypress",$),()=>document.removeEventListener("keypress",$)},[I,a,s]);const x=$=>{if(I)return;const N=v.current;if(!N)return;$.preventDefault();const O=N.getBoundingClientRect(),G=a/10,ee=O.left+O.width*G,te=$.clientX||$.touches&&$.touches[0].clientX;Math.abs(te-ee)<30&&(V(!0),M(!0))},w=$=>{if(!C||I)return;const N=v.current;if(!N)return;const O=N.getBoundingClientRect(),G=$.clientX||$.touches&&$.touches[0].clientX,te=Math.max(0,Math.min(1,(G-O.left)/O.width))*10,le=Math.round(te/g)*g;l(parseFloat(le.toFixed(2)))},k=()=>{V(!1)};D.useEffect(()=>{if(C){const $=O=>w(O),N=()=>k();return document.addEventListener("mousemove",$),document.addEventListener("mouseup",N),document.addEventListener("touchmove",$),document.addEventListener("touchend",N),()=>{document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",N),document.removeEventListener("touchmove",$),document.removeEventListener("touchend",N)}}},[C,g,I]);const R=async()=>{const $=Date.now()-p,N=parseFloat(a),O=Math.abs(N-s),G=`g2t${t}`,ee=localStorage.getItem(`lastAIHelp_${G}`);if(ee){const ke=JSON.parse(ee),we=Date.now()-ke.timestamp,fe=N===ke.suggestion?"accepted":"modified";await et.trackAIHelpResponse(G,ke.type,ke.suggestion,fe,N,we),localStorage.removeItem(`lastAIHelp_${G}`)}let te=0;O===0?te=2:O<=1?te=1:te=0,m.current+=1,await et.trackTaskAttempt(G,m.current,!0,$,N,s);const le=localStorage.getItem("sessionId");if(le&&!le.startsWith("offline-"))try{await Yn(bt(tt,"sessions",le),{[`taskDifferences.g2t${t}`]:O,[`taskTimes.g2t${t}`]:$,[`taskPoints.g2t${t}`]:te,lastActivity:En()})}catch(ke){console.error("Error storing difference:",ke)}h(te===2?" Perfect! 2 points earned!":te===1?` Off by ${O.toFixed(2)} - 1 point earned!`:` Off by ${O.toFixed(2)} - 0 points earned.`),setTimeout(()=>{e(`g2t${t}`,{attempts:m.current,totalTime:$,accuracy:te===2?100:te===1?70:0,userAnswer:N,correctAnswer:s,points:te})},500)},T=tr.generateSliderPattern(t),oe=T.difficultyLabel,re=T.difficulty,ie=()=>{const $=[];for(let N=0;N<=10;N++)$.push(d.jsxs("div",{style:{position:"absolute",left:`${N*10}%`,transform:"translateX(-50%)",textAlign:"center"},children:[d.jsx("div",{style:{width:"2px",height:"12px",background:"#666",margin:"0 auto"}}),d.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:N})]},N));return $};return d.jsxs("div",{className:`task slider ${I?"ai-controlled":""}`,children:[d.jsxs("h3",{children:["Material Creation - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${re}`,children:oe}),d.jsxs("p",{className:"instruction",children:["Move the slider to:"," ",d.jsx("strong",{className:"target-value","data-target-value":s,children:s}),d.jsx("br",{}),d.jsx("span",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:!L&&"Hold and drag the slider handle to move it"})]}),d.jsxs("div",{className:"slider-container",children:[d.jsxs("div",{className:"range-labels",children:[d.jsx("span",{children:"0"}),d.jsx("span",{children:"10"})]}),d.jsxs("div",{style:{position:"relative",padding:"20px 0 30px 0"},children:[d.jsx("div",{style:{position:"absolute",width:"100%",height:"20px",top:"0"},children:ie()}),d.jsx("div",{style:{position:"relative",marginTop:"20px"},children:d.jsx("input",{ref:v,type:"range",min:"0",max:"10",step:g,value:a,onChange:$=>{!C&&!I&&(l(parseFloat($.target.value)),M(!0))},className:"slider-input",style:{width:"100%",cursor:C?"grabbing":"grab"},onMouseDown:x,onTouchStart:x})})]}),d.jsx("div",{className:"current-value",children:E?parseFloat(a).toFixed(n?0:T.precision):"??"})]}),d.jsx("button",{onClick:R,className:"submit-btn",disabled:I,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function Dd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=D.useState(""),[a,l]=D.useState(""),[u,h]=D.useState(null),[p]=D.useState(Date.now()),[g,y]=D.useState(""),[E,A]=D.useState(!1),P=D.useRef(0),F=L=>{const M=document.createElement("canvas"),v=M.getContext("2d");return M.width=600,M.height=150,v.fillStyle="#f5f5f5",v.fillRect(0,0,M.width,M.height),v.font='bold 40px "Courier New", monospace',v.fillStyle="#333",v.textAlign="center",v.textBaseline="middle",v.fillText(L,M.width/2,M.height/2),M.toDataURL()};D.useEffect(()=>{const M=tr.generateTypingPattern(t).pattern;i(M);const v=F(M);y(v)},[t]),D.useEffect(()=>{l(""),h(null),P.current=0},[t]),D.useEffect(()=>{const L=M=>{const{action:v,text:m,typeSpeed:x}=M.detail;if(v==="autoType"&&m){A(!0),l("");let w="",k=0;const R=setInterval(()=>{k<m.length?(w+=m[k],l(w),k++):(clearInterval(R),A(!1))},x||50);return()=>clearInterval(R)}};return window.addEventListener("aiTypingHelp",L),()=>window.removeEventListener("aiTypingHelp",L)},[]);const I=async()=>{const L=Date.now()-p,M=`g3t${t}`,v=localStorage.getItem(`lastAIHelp_${M}`);if(v){const R=JSON.parse(v),T=Date.now()-R.timestamp,oe=a===R.suggestion?"accepted":"modified";await et.trackAIHelpResponse(M,R.type,R.suggestion,oe,a,T),localStorage.removeItem(`lastAIHelp_${M}`)}const x=((R,T)=>{const oe=R.length,re=T.length,ie=Array(oe+1).fill(null).map(()=>Array(re+1).fill(0));for(let $=0;$<=oe;$++)ie[$][0]=$;for(let $=0;$<=re;$++)ie[0][$]=$;for(let $=1;$<=oe;$++)for(let N=1;N<=re;N++)R[$-1]===T[N-1]?ie[$][N]=ie[$-1][N-1]:ie[$][N]=Math.min(ie[$-1][N]+1,ie[$][N-1]+1,ie[$-1][N-1]+1);return ie[oe][re]})(a,s);let w=0;x===0?w=2:x===1?w=1:w=0,P.current+=1,await et.trackTaskAttempt(M,P.current,!0,L,a,s);const k=localStorage.getItem("sessionId");if(k&&!k.startsWith("offline-"))try{await Yn(bt(tt,"sessions",k),{[`taskAccuracies.g3t${t}`]:w===2?100:w===1?70:0,[`taskTimes.g3t${t}`]:L,[`taskPoints.g3t${t}`]:w,lastActivity:En()})}catch(R){console.error("Error storing accuracy:",R)}h(w===2?" Perfect! 2 points earned!":w===1?" 1 typo - 1 point earned!":` ${x} errors - 0 points earned.`),setTimeout(()=>{e(`g3t${t}`,{attempts:P.current,totalTime:L,accuracy:w===2?100:w===1?70:0,userAnswer:a,correctAnswer:s,points:w})},500)},S=tr.generateTypingPattern(t),C=S.difficultyLabel,V=S.difficulty;return d.jsxs("div",{className:"task typing",style:{maxWidth:"100%"},children:[d.jsxs("h3",{children:["Student Engagement - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${V}`,children:C}),d.jsx("p",{className:"instruction",children:"Type this pattern exactly:"}),d.jsxs("div",{className:"pattern-display",children:[d.jsx("div",{className:"typing-pattern","data-typing-pattern":s,style:{display:"none"},children:s}),g?d.jsx("img",{src:g,alt:"Pattern to type",style:{width:"100%",maxWidth:"600px",height:"auto",userSelect:"none",pointerEvents:"none"},onContextMenu:L=>L.preventDefault(),draggable:!1}):d.jsx("span",{className:"pattern-text",children:s})]}),d.jsx("div",{className:"input-section",style:{width:"90%",maxWidth:"900px",margin:"20px auto 0"},children:d.jsx("input",{type:"text",inputMode:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:a,onChange:L=>!E&&l(L.target.value),onKeyPress:L=>{L.key==="Enter"&&!E&&(L.preventDefault(),I())},placeholder:"Type here...",className:"typing-input",disabled:E,style:{backgroundColor:E?"#e3f2fd":"white",transition:"background-color 0.3s",width:"100%",maxWidth:"100%",fontFamily:'"Courier New", monospace',fontSize:"28px",padding:"12px 14px",border:"2px solid #e0e0e0",borderRadius:"8px",boxSizing:"border-box"}})}),d.jsx("button",{onClick:I,className:"submit-btn",disabled:E,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function gI({practiceCompleted:t={},onPracticeComplete:e,onStartMainGame:n,onSelectPractice:r,isAdmin:s=!1}){const[i,a]=D.useState(null),l=(y,E)=>{if(E&&E.points===2){typeof e=="function"&&e(y,E);const A=document.createElement("div");A.className="notification-enter",A.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",A.textContent="Perfect! Practice task completed. Returning to menu...",document.body.appendChild(A),setTimeout(()=>{a(null),document.body.contains(A)&&document.body.removeChild(A)},1500)}else{const A=(E==null?void 0:E.points)||0,P=document.createElement("div");P.className="notification-enter",P.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #ff9800; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",P.textContent=`Practice requires 100% accuracy. You scored ${A===1?"50%":"0%"}. Try again!`,document.body.appendChild(P),setTimeout(()=>{document.body.contains(P)&&document.body.removeChild(P)},3e3)}},u=t.g2t1&&t.g1t1&&t.g3t1,h=()=>d.jsxs("div",{className:"practice-menu",children:[d.jsxs("h2",{children:["Practice Mode ",!s&&"(Required)"]}),!s&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",borderRadius:"12px",padding:"16px",marginBottom:"25px",border:"2px solid #f57c00",boxShadow:"0 4px 6px rgba(245, 124, 0, 0.1)",textAlign:"center"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:""}),d.jsx("strong",{style:{color:"#e65100",fontSize:"18px"},children:"100% PERFECT ACCURACY REQUIRED"})]}),d.jsxs("div",{style:{color:"#e65100",fontSize:"14px"},children:["You must score 2/2 points (exact answer) on all three practice tasks to proceed.",d.jsx("br",{}),d.jsx("strong",{children:"No partial credit in practice mode!"})]}),d.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"12px"},children:[d.jsxs("span",{style:{padding:"4px 12px",background:t.g2t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g2t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g2t1?"#4CAF50":"#ffb74d"}`},children:["Materials ",t.g2t1?"":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g1t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g1t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g1t1?"#4CAF50":"#ffb74d"}`},children:["Research ",t.g1t1?"":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g3t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g3t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g3t1?"#4CAF50":"#ffb74d"}`},children:["Engagement ",t.g3t1?"":"Required"]})]})]}),d.jsx("p",{className:"practice-hint",style:{textAlign:"center",fontSize:"16px",color:"#666",marginBottom:"30px"},children:"Try each task type before starting the main challenge. No time pressure!"}),d.jsxs("div",{className:"practice-cards",children:[d.jsxs("div",{className:"practice-card materials",children:[d.jsx("h3",{children:" Materials"}),d.jsx("p",{children:"Hold and drag slider to match target values"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Base points - directly added to score"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g2t1"),r&&r("g2t1")},className:t.g2t1?"completed":"",disabled:!1,children:t.g2t1?" Completed":"Try Materials"})})]}),d.jsxs("div",{className:"practice-card research",children:[d.jsx("h3",{children:" Research"}),d.jsx("p",{children:"Count words or letters in text passages"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 15% multiplier per point in main game"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g1t1"),r&&r("g1t1")},className:t.g1t1?"completed":"",disabled:!1,children:t.g1t1?" Completed":"Try Research"})})]}),d.jsxs("div",{className:"practice-card engagement",children:[d.jsx("h3",{children:" Engagement"}),d.jsx("p",{children:"Type patterns exactly as shown"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 0.15% compound interest per point"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g3t1"),r&&r("g3t1")},className:t.g3t1?"completed":"",disabled:!1,children:t.g3t1?" Completed":"Try Engagement"})})]})]}),d.jsxs("div",{style:{marginTop:"25px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h4",{style:{margin:"0 0 10px 0",color:"#333",fontSize:"16px"},children:"Practice Progress:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[d.jsxs("div",{style:{padding:"8px 15px",background:t.g2t1?"#4CAF50":"#e0e0e0",color:t.g2t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Materials ",t.g2t1&&""]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g1t1?"#9C27B0":"#e0e0e0",color:t.g1t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Research ",t.g1t1&&""]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g3t1?"#f44336":"#e0e0e0",color:t.g3t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Engagement ",t.g3t1&&""]})]}),d.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#666"},children:[d.jsx("strong",{children:"100% accuracy required"})," to complete each practice task"]})]}),d.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:d.jsx("button",{className:"start-main-game-btn",onClick:n,style:{opacity:!s&&!u?.5:1,cursor:!s&&!u?"not-allowed":"pointer"},disabled:!s&&!u,children:s?"Start Main Game (Admin)":u?"Start Main Game - You're Ready! ":"Complete Practice First"})})]});if(!i)return h();const p=i[1],g=1;return d.jsxs("div",{className:"practice-container",children:[d.jsx("button",{className:"back-to-menu",onClick:()=>a(null),children:" Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),d.jsxs("div",{className:"practice-task-wrapper",children:[p==="1"&&d.jsx(Pd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i}),p==="2"&&d.jsx(bd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i}),p==="3"&&d.jsx(Dd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i})]})]})}class yI{constructor(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={}}getUniversalAttemptNumber(){return this.totalAIUsage}shouldAIBeCorrect(e){let n;return e===1||e===2||e===4||e===5?n=!0:e===3?n=!1:n=Math.random()<.75,n}getTaskUsageCount(e){return this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]}incrementTaskUsage(e,n){this.totalAIUsage++,this.usageCount[n]++,this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]++}resetForNewSemester(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={},console.log(" AI Help usage reset for new semester")}helpWithSlider(e,n){this.incrementTaskUsage(n,"materials");const r=this.getUniversalAttemptNumber();let s;if(this.shouldAIBeCorrect(r))s=e;else if(r===3){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else if(Math.random()<.5){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else{const i=(Math.random()<.5?-1:1)*(2+Math.random()*2);s=Math.max(0,Math.min(10,e+i))}return{action:"moveSlider",value:s,animate:!0}}helpWithCounting(e,n,r){this.incrementTaskUsage(r,"research");const s=this.getUniversalAttemptNumber(),i=this.shouldAIBeCorrect(s);return n.length===1||n.includes(" and ")||n.includes(",")?this.helpWithLetterCounting(e,n,s,i):this.helpWithWordCounting(e,n,s,i)}helpWithLetterCounting(e,n,r,s){let i=[];n.includes(" and ")||n.includes(",")?i=n.match(/[a-z]/gi)||[]:i=[n];let a=0;i.forEach(h=>{const p=new RegExp(h,"gi"),g=e.match(p);a+=g?g.length:0});let l=a,u=[...i];if(!s){r===3||Math.random()<.5?l=a+1:l=a+Math.floor(Math.random()*3)+2,l=Math.max(0,l);const p="abcdefghijklmnopqrstuvwxyz".split("").filter(y=>!i.includes(y.toLowerCase())),g=Math.floor(Math.random()*2)+1;for(let y=0;y<g&&p.length>0;y++){const E=Math.floor(Math.random()*p.length);u.push(p[E]),p.splice(E,1)}}return{action:"highlightAndCount",highlightWords:[],suggestedCount:l,animate:!0,isMultiLetter:!0,targetLetters:u}}helpWithWordCounting(e,n,r,s){const i=e.split(/\s+/),a=[];let l=0,u=0;if(i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&u++}),s)i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&(a.push(h),l++)});else if(r===3){l=u+1,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());if(h.length>0&&a.length<l){const p=h[Math.floor(Math.random()*h.length)];a.push(p)}}else{Math.random()<.5?l=u+1:l=u+Math.floor(Math.random()*3)+2,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());for(;a.length<l&&h.length>0;){const p=Math.floor(Math.random()*h.length),g=h[p];a.includes(g)||a.push(g),h.splice(p,1)}}return{action:"highlightAndCount",highlightWords:a,suggestedCount:l,animate:!0}}helpWithTyping(e,n){this.incrementTaskUsage(n,"engagement");const r=this.getUniversalAttemptNumber();let s=e;const i={0:["o","O"],o:["0"],O:["0"],1:["l","I","i"],l:["1","I","i"],I:["1","l","i"],i:["1","l","I"],e:["3"],3:["e"],a:["@"],"@":["a"],s:["5","$"],S:["5","$"],5:["s","S"],$:["s","S"],g:["9"],9:["g"],b:["6"],6:["b"],z:["2"],2:["z"],B:["8"],8:["B"]},a=l=>{const u=l.split(""),h=u.map((p,g)=>i[p]?g:-1).filter(p=>p!==-1);if(h.length>0){const p=h[Math.floor(Math.random()*h.length)],g=u[p],y=i[g];y&&y.length>0&&(u[p]=y[Math.floor(Math.random()*y.length)])}else{const p=["transpose","duplicate","missing"],g=p[Math.floor(Math.random()*p.length)],y=Math.floor(Math.random()*u.length);switch(g){case"transpose":y<u.length-1&&([u[y],u[y+1]]=[u[y+1],u[y]]);break;case"duplicate":u.splice(y,0,u[y]);break;case"missing":u.splice(y,1);break}}return u.join("")};if(this.shouldAIBeCorrect(r))s=e;else if(r===3)s=a(e);else if(Math.random()<.5)s=a(e);else{let l=e;const u=Math.floor(Math.random()*3)+2;for(let h=0;h<u;h++)l=a(l);s=l}return{action:"autoType",text:s,typeSpeed:50,perfect:this.shouldAIBeCorrect(r)}}}const Fl=new yI;function vI({bonusPrompts:t=0,currentTask:e="",categoryPoints:n=null,timeRemaining:r=null,calculateStudentLearning:s=()=>0,aiCost:i=0,onAiCost:a}){const[l,u]=D.useState(!0),[h,p]=D.useState(0),[g,y]=D.useState(!1);D.useEffect(()=>{const L=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");u(L.hasAI!==!1)},[]),D.useEffect(()=>{if(e){const L=Fl.getTaskUsageCount(e)>=1;y(L)}},[e]),D.useEffect(()=>{const L=()=>{p(Fl.totalAIUsage)},M=setInterval(L,1e3);return L(),()=>clearInterval(M)},[]);const[E,A]=D.useState([{sender:"bot",text:l?"Hello! I'm your AI teaching assistant. You get ONE AI help attempt per task - use it wisely!":"Hello! This is the chat interface. AI assistance is not available for this session."}]),[P,F]=D.useState(""),[I,S]=D.useState(!1),[C,V]=D.useState({materials:0,research:0,engagement:0});D.useRef(null)}const zl={generateCode(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`${t}-${e}`.toUpperCase()},async createCode(t={}){return{success:!0,code:this.generateCode(),data:t}},async markCodeAsUsed(t,e){if(!t)return{success:!1,error:"No code provided"};try{const n={code:t,status:"used",usedAt:En(),sessionId:e,createdAt:En()};return await kd(bt(tt,"accessCodes",t),n),{success:!0}}catch(n){return console.error("Error marking code as used:",n),{success:!1,error:n.message}}},async checkCodeUsage(t){if(!t)return{used:!1};try{const e=await cf(bt(tt,"accessCodes",t));if(e.exists()){const n=e.data();return{used:n.status==="used",sessionId:n.sessionId,usedAt:n.usedAt}}return{used:!1}}catch(e){return console.error("Error checking code usage:",e),{used:!1,error:e.message}}},getCodeFromURL(){const t=new URLSearchParams(window.location.search);return t.get("code")||t.get("c")||null},async verifyQualtricsCode(t){return{valid:!1,reason:"Qualtrics codes not yet supported"}}};function _I({onLoginSuccess:t}){const[e,n]=D.useState(""),[r,s]=D.useState(!1),[i,a]=D.useState(""),[l,u]=D.useState(!1),h={MASTER:{section:"ADMIN-MASTER",role:"master_admin",name:"Master Administrator",hasAI:!1,isMasterInterface:!0},ADMIN:{role:"admin",semesterDuration:72e4,name:"Admin User",hasAI:!0,checkpointSemester2:!0}},p=E=>({section:"TESTING-AI-CP",hasAI:!0,checkpointSemester2:!0,displayName:`${E} (Internal Tester - AI + Checkpoint)`}),g=E=>{if(h[E])return{valid:!0,type:"master",data:h[E]};const A=E.trim().replace(/[^a-zA-Z0-9\s\-_]/g,"");return A.length<2?{valid:!1,error:"Please enter a name with at least 2 characters"}:A.length>50?{valid:!1,error:"Name too long. Please use 50 characters or less"}:{valid:!0,type:"tester",condition:p(A),cleanName:A}},y=async E=>{if(E.preventDefault(),!e.trim()){a("Please enter your name");return}s(!0),a("");try{const A=g(e.trim());if(!A.valid){a(A.error||"Invalid Student ID"),s(!1);return}let P={timestamp:new Date().toISOString()};if(A.type==="master"){if(P={...P,studentIdentifier:e,role:A.data.role,semesterDuration:A.data.semesterDuration,displayName:A.data.name,section:A.data.isTestCode?"ADMIN-TEST":"ADMIN",hasAI:A.data.hasAI,checkpointSemester2:A.data.checkpointSemester2,isMasterCode:!0,isTestCode:A.data.isTestCode||!1,isMasterInterface:A.data.isMasterInterface||!1},A.data.isMasterInterface){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",displayName:A.data.name,section:"master_admin",hasAI:!0,checkpointSemester2:!0})),window.location.href=`${window.location.origin}?master=true`;return}}else if(A.type==="tester"){const I=A.condition,S=A.cleanName;P={...P,studentIdentifier:S,role:"tester",semesterDuration:72e4,displayName:I.displayName,section:I.section,hasAI:I.hasAI,checkpointSemester2:I.checkpointSemester2,isMasterCode:!1,isTestUser:!0}}const F=await zl.createCode(P);F.success?(sessionStorage.setItem("gameConfig",JSON.stringify({semesterDuration:P.semesterDuration,role:P.role,studentId:P.studentIdentifier,displayName:P.displayName,section:P.section,hasAI:P.hasAI,checkpointSemester2:P.checkpointSemester2})),window.location.href=`${window.location.origin}?code=${F.code}`):a("Failed to generate access code. Please try again.")}catch(A){console.error("Login error:",A),a("System error. Please try again.")}finally{s(!1)}};return d.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",padding:"20px"},children:[d.jsxs("div",{style:{background:"white",padding:"48px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",maxWidth:"480px",width:"100%"},children:[d.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[d.jsxs("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a202c",marginBottom:"8px",lineHeight:"1.2"},children:["Scheduling Challenge:",d.jsx("br",{}),"Can you beat Park?"]}),d.jsx("p",{style:{fontSize:"16px",color:"#718096",marginTop:"12px"},children:"Enter your name to access the game"})]}),d.jsxs("form",{onSubmit:y,children:[d.jsxs("div",{style:{marginBottom:"24px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#2d3748",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.025em"},children:"Your Name:"}),d.jsx("input",{type:"text",value:e,onChange:E=>n(E.target.value),disabled:r,style:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e2e8f0",borderRadius:"8px",boxSizing:"border-box",fontFamily:"'SF Mono', Monaco, 'Courier New', monospace",transition:"all 0.2s ease",background:"#f7fafc",outline:"none"},onFocus:E=>{E.target.style.borderColor="#2196F3",E.target.style.background="white",E.target.style.boxShadow="0 0 0 3px rgba(33, 150, 243, 0.1)"},onBlur:E=>{E.target.style.borderColor="#e2e8f0",E.target.style.background="#f7fafc",E.target.style.boxShadow="none"}}),d.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"#a0aec0",lineHeight:"1.4"},children:"Enter your first and last name (2-50 characters)"})]}),i&&d.jsxs("div",{style:{background:"#fed7d7",color:"#c53030",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",fontSize:"14px",display:"flex",alignItems:"center",border:"1px solid #fc8181"},children:[d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",style:{marginRight:"8px",flexShrink:0},children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i]}),d.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:"600",background:r?"#cbd5e0":"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:r?"none":"0 4px 6px rgba(33, 150, 243, 0.25)",transform:r?"none":"translateY(0)"},onMouseDown:E=>{r||(E.target.style.transform="translateY(2px)",E.target.style.boxShadow="0 2px 4px rgba(33, 150, 243, 0.25)")},onMouseUp:E=>{r||(E.target.style.transform="translateY(0)",E.target.style.boxShadow="0 4px 6px rgba(33, 150, 243, 0.25)")},onMouseOver:E=>{r||(E.target.style.background="#1976D2")},onMouseOut:E=>{r||(E.target.style.background="#2196F3")},children:r?d.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[d.jsxs("svg",{className:"animate-spin",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px",animation:"spin 1s linear infinite"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",strokeOpacity:"0.25"}),d.jsx("path",{d:"M4 12a8 8 0 018-8",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),"Verifying Name..."]}):"Access Game"})]}),d.jsxs("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[d.jsx("p",{style:{fontSize:"14px",color:"#718096",marginBottom:"12px"},children:"Having trouble? Contact your instructor:"}),d.jsxs("p",{style:{fontSize:"16px",color:"#2196F3",fontWeight:"500"},children:["Park Sinchaisri",d.jsx("br",{}),d.jsx("a",{href:"mailto:parksinchaisri@haas.berkeley.edu",style:{color:"#2196F3",textDecoration:"none",borderBottom:"1px solid #2196F3",fontSize:"15px"},children:"parksinchaisri@haas.berkeley.edu"})]}),l&&d.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#f7fafc",borderRadius:"8px",fontSize:"11px",color:"#4a5568",lineHeight:"1.8"},children:[d.jsx("strong",{children:"Test Codes:"}),d.jsxs("div",{style:{marginTop:"8px",fontFamily:"monospace"},children:[d.jsx("div",{children:"ADMIN (Standard Game Mode)"}),d.jsx("div",{children:"MASTER (Master interface)"})]})]})]})]}),d.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const qm={async checkDailyLimit(t){var r;if(!t)return{allowed:!0};const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);try{const s=$o(tt,"sessions"),i=tI(s,Bm("studentId","==",t),Bm("startTime",">=",n)),a=await Ad(i);if(!a.empty){const l=a.docs[0].data(),u=(r=l.startTime)!=null&&r.toDate?l.startTime.toDate():new Date(l.clientStartTime);return{allowed:!1,reason:"daily_limit",existingSession:l,nextAvailable:new Date(n.getTime()+24*60*60*1e3)}}return{allowed:!0}}catch(s){console.error("Error checking daily limit:",s);const i=`played_${t}_${n.toISOString().split("T")[0]}`;return localStorage.getItem(i)?{allowed:!1,reason:"daily_limit",nextAvailable:new Date(n.getTime()+24*60*60*1e3)}:{allowed:!0}}},async markDailyPlay(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=`played_${t}_${n.toISOString().split("T")[0]}`;localStorage.setItem(r,"true");const s=new Date(Date.now()-7*24*60*60*1e3);for(let i=0;i<localStorage.length;i++){const a=localStorage.key(i);if(a&&a.startsWith("played_")){const l=a.split("_")[2];l&&new Date(l)<s&&localStorage.removeItem(a)}}},async checkAccess(){try{const t=zl.getCodeFromURL();if(!t)return{allowed:!1,reason:"Please login with your student ID",requiresCode:!0};const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),n=e.role==="admin"||e.role==="master_admin";if(!n&&e.studentId){const r=await this.checkDailyLimit(e.studentId);if(!r.allowed&&!r.refreshGranted){const i=r.nextAvailable;return{allowed:!1,reason:`You have already completed today's session. Please come back in ${Math.ceil((i-Date.now())/(1e3*60*60))} hours (after midnight).`,dailyLimitReached:!0,nextAvailable:i}}if(sessionStorage.getItem("activeSessionId"))return{allowed:!1,reason:"Page refresh is not allowed during the game. Your session has been terminated.",refreshAttempt:!0}}return e.studentId?(n||await this.markDailyPlay(e.studentId),{allowed:!0,newSession:!0,code:t,codeData:{status:"new",metadata:e},isAdmin:n}):{allowed:!1,reason:"Please login with your Berkeley student ID",requiresCode:!0}}catch(t){console.error("Error in checkAccess:",t);const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");return e.role==="admin"?{allowed:!0,newSession:!0,code:zl.getCodeFromURL(),codeData:{status:"error_bypass",metadata:e},isAdmin:!0}:{allowed:!1,reason:"System error. Please try again.",requiresCode:!0}}},async createSession(t=null,e=null,n=!1){try{const r=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),s=r.role==="admin"||r.role==="master_admin",i={id:crypto.randomUUID(),accessCode:t,studentId:r.studentId||null,role:r.role||"student",semesterDuration:r.semesterDuration||72e4,displayName:r.displayName||"Student",startTime:En(),clientStartTime:new Date().toISOString(),status:"active",completedTasks:{},isPractice:n,isAdminSession:s,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`,section:r.section,hasAI:r.hasAI,checkpointSemester2:r.checkpointSemester2},l=(await Bv($o(tt,"sessions"),i)).id;return localStorage.setItem("sessionId",l),sessionStorage.setItem("activeSessionId",l),s||(window.addEventListener("beforeunload",u=>{u.preventDefault(),u.returnValue="Your progress will be lost if you leave this page.",this.handleSessionAbandonment()}),document.addEventListener("visibilitychange",()=>{!s&&document.hidden})),l}catch(r){console.error("Error creating session:",r);const s=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(s.role==="admin"){const i="offline-"+Date.now();localStorage.setItem("sessionId",i),sessionStorage.setItem("activeSessionId",i);const a={id:i,accessCode:t,startTime:Date.now(),status:"active",isOffline:!0,studentId:s.studentId||null,role:s.role||"admin"};return localStorage.setItem("offlineSession",JSON.stringify(a)),i}throw r}},async handleSessionAbandonment(){const t=localStorage.getItem("sessionId");if(t&&!t.startsWith("offline-"))try{await Yn(bt(tt,"sessions",t),{status:"abandoned",abandonedAt:En(),abandonReason:"page_unload"})}catch(e){console.error("Error marking session as abandoned:",e)}sessionStorage.removeItem("activeSessionId"),sessionStorage.removeItem("gameConfig")}};function xI(){const[t,e]=D.useState(""),[n,r]=D.useState(!1),[s,i]=D.useState(""),[a,l]=D.useState(!1),u=async()=>{r(!0),i(""),l(!1);try{const p=await zl.createCode({createdBy:"admin",timestamp:new Date().toISOString()});p.success?e(p.code):i("Failed to generate code: "+p.error)}catch(p){i("Error: "+p.message)}finally{r(!1)}},h=()=>{const p=`${window.location.origin}?code=${t}`;navigator.clipboard.writeText(p),l(!0),setTimeout(()=>l(!1),2e3)};return d.jsxs("div",{style:{padding:"40px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, -apple-system, sans-serif"},children:[d.jsx("h1",{style:{color:"#333",marginBottom:"10px"},children:"Admin Dashboard"}),d.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:"Generate access codes for participants"}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("button",{onClick:u,disabled:n,style:{padding:"12px 30px",fontSize:"16px",background:n?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:"bold"},children:n?"Generating...":"Generate New Access Code"}),t&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"white",borderRadius:"6px",border:"1px solid #e0e0e0"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Generated Code"}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Access Code:"}),d.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"18px",fontWeight:"bold"},children:t})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Full URL:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"stretch"},children:[d.jsx("input",{type:"text",value:`${window.location.origin}?code=${t}`,readOnly:!0,style:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",background:"#f9f9f9"}}),d.jsx("button",{onClick:h,style:{padding:"10px 20px",background:a?"#4CAF50":"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:a?" Copied!":"Copy URL"})]})]}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"4px",fontSize:"14px",color:"#1976d2"},children:[d.jsx("strong",{children:"Note:"})," This code is valid for 24 hours and can only be used once."]})]}),s&&d.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"#ffebee",color:"#c62828",borderRadius:"4px"},children:s})]}),d.jsxs("div",{style:{marginTop:"40px",padding:"20px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"How to use:"}),d.jsxs("ol",{style:{margin:"10px 0",paddingLeft:"20px"},children:[d.jsx("li",{children:"Generate a code using the button above"}),d.jsx("li",{children:"Copy the full URL"}),d.jsx("li",{children:"Share the URL with participants"}),d.jsx("li",{children:"Each participant can use their unique code once"})]})]})]})}function wI({sessionId:t,completedLevels:e,totalTime:n,gameMode:r}){const[s,i]=D.useState(""),[a,l]=D.useState(!1);D.useEffect(()=>{u()},[]);const u=()=>{const p=Date.now().toString(36).toUpperCase(),g=e.toString().padStart(2,"0"),y=r.limit==="time"?"T":"A",E=r.accuracy==="strict"?"S":"L",F=`GAME-${`${t}-${g}-${n}`.split("").reduce((I,S)=>I+S.charCodeAt(0),0).toString(36).toUpperCase().slice(-3)}-${g}-${y}${E}-${p}`;i(F)},h=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(s),l(!0),setTimeout(()=>l(!1),3e3);else{const p=document.createElement("textarea");p.value=s,p.style.position="fixed",p.style.top="0",p.style.left="0",p.style.width="2em",p.style.height="2em",p.style.padding="0",p.style.border="none",p.style.outline="none",p.style.boxShadow="none",p.style.background="transparent",p.style.opacity="0",document.body.appendChild(p),p.focus(),p.select();try{document.execCommand("copy")?(l(!0),setTimeout(()=>l(!1),3e3)):(console.error("Failed to copy using execCommand"),alert("Copy failed. Please manually select and copy the code."))}catch(g){console.error("Failed to copy:",g),alert("Copy failed. Please manually select and copy the code.")}document.body.removeChild(p)}}catch(p){console.error("Clipboard operation failed:",p),alert(`Copy failed. Here's your code to copy manually:

${s}`)}};return d.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"30px",marginTop:"30px",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},children:[d.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:" Your Completion Code"}),d.jsx("p",{style:{marginBottom:"20px",opacity:.9,fontSize:"16px"},children:"Copy this code and paste it into the Qualtrics survey to verify your completion:"}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"20px",marginBottom:"20px",backdropFilter:"blur(10px)"},children:[d.jsx("div",{style:{fontFamily:"monospace",fontSize:"28px",fontWeight:"bold",letterSpacing:"2px",marginBottom:"15px",wordBreak:"break-all",textShadow:"2px 2px 4px rgba(0,0,0,0.2)",userSelect:"text",cursor:"text"},onClick:p=>{const g=window.getSelection(),y=document.createRange();y.selectNodeContents(p.currentTarget),g.removeAllRanges(),g.addRange(y)},title:"Click to select all text",children:s}),d.jsx("button",{onClick:h,style:{padding:"12px 30px",fontSize:"16px",fontWeight:"bold",background:a?"#4CAF50":"white",color:a?"white":"#764ba2",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:a?" Copied!":" Copy Code"})]}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:"6px",padding:"15px",fontSize:"14px",lineHeight:"1.5"},children:[d.jsx("strong",{children:" Important:"})," This code is your proof of completion. Make sure to copy it before closing this window!",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"13px",opacity:.9},children:" Tip: If the Copy button doesn't work, click on the code text to select it, then use Ctrl+C (or Cmd+C on Mac) to copy."})]}),d.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[d.jsx("summary",{style:{cursor:"pointer",opacity:.8,fontSize:"12px",marginBottom:"10px"},children:"Code Details "}),d.jsxs("div",{style:{fontSize:"12px",opacity:.7,background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",fontFamily:"monospace"},children:[d.jsxs("div",{children:["Levels Completed: ",e,"/45"]}),d.jsxs("div",{children:["Game Mode: ",r.limit==="time"?"Time Challenge":"Task Attempts"]}),d.jsxs("div",{children:["Accuracy Mode: ",r.accuracy==="strict"?"Strict (100%)":"Lenient"]}),d.jsxs("div",{children:["Total Time: ",Math.floor(n/60),"m ",n%60,"s"]}),d.jsxs("div",{children:["Generated: ",new Date().toLocaleString()]})]})]})]})}function SI({onClose:t}){const[e,n]=D.useState("config"),[r,s]=D.useState([]),[i,a]=D.useState(!0),[l,u]=D.useState(!1),[h,p]=D.useState(""),[g,y]=D.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,wrongAnswerPenalty:2,switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0,taskOrderStrategy:"sequential_task",difficultyMode:"fixed"}),[E,A]=D.useState(!1);D.useEffect(()=>{P(),S()},[]);const P=async()=>{try{const v=bt(tt,"game_settings","global"),m=await cf(v);m.exists()&&y({...g,...m.data()})}catch(v){console.error("Error loading game config:",v)}},F=async()=>{A(!0);try{const v=bt(tt,"game_settings","global");await kd(v,g,{merge:!0}),alert("Configuration saved successfully!")}catch(v){console.error("Error saving config:",v),alert("Failed to save configuration")}finally{A(!1)}},I=(v,m)=>{y(x=>({...x,[v]:m}))},S=async()=>{a(!0);try{const v=$o(tt,"students"),x=(await Ad(v)).docs.map(w=>({id:w.id,...w.data()}));s(x)}catch(v){console.error("Error fetching students:",v)}finally{a(!1)}},C=async()=>{if(window.confirm("Are you sure you want to reset ALL student data? This cannot be undone!")){u(!0);try{const v=$o(tt,"students"),m=await Ad(v);for(const x of m.docs)await kd(bt(tt,"students",x.id),{hasPlayed:!1,totalAccesses:0,scores:[]},{merge:!0});alert("All student data has been reset!"),await S()}catch(v){console.error("Error resetting data:",v),alert("Failed to reset data")}finally{u(!1)}}},V=v=>({padding:"12px 24px",background:v?"#2196F3":"transparent",color:v?"white":"#666",border:"none",borderBottom:v?"3px solid #2196F3":"3px solid transparent",cursor:"pointer",fontSize:"14px",fontWeight:v?"600":"normal",transition:"all 0.2s"}),L=r.filter(v=>{var m;return!((m=v.section)!=null&&m.includes("ADMIN"))}).length,M=r.filter(v=>{var m;return!((m=v.section)!=null&&m.includes("ADMIN"))&&v.hasPlayed}).length;return d.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[d.jsx("h1",{style:{margin:0,color:"#333"},children:" Master Admin Dashboard"}),d.jsx("button",{onClick:t,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:"Exit Admin"})]}),d.jsxs("div",{style:{display:"flex",borderBottom:"1px solid #e0e0e0",marginBottom:"30px"},children:[d.jsx("button",{onClick:()=>n("config"),style:V(e==="config"),children:" Game Configuration"}),d.jsx("button",{onClick:()=>n("players"),style:V(e==="players"),children:" Player Data"}),d.jsx("button",{onClick:()=>n("advice"),style:V(e==="advice"),children:" Game Advice"})]}),e==="config"&&d.jsxs("div",{children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"20px",marginBottom:"20px"},children:[d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Time & Semesters"}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Semester Duration (Minutes)"}),d.jsx("input",{type:"number",value:g.semesterDuration,onChange:v=>I("semesterDuration",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Semesters"}),d.jsx("input",{type:"number",value:g.totalSemesters,onChange:v=>I("totalSemesters",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("input",{type:"checkbox",checked:g.midtermEnabled,onChange:v=>I("midtermEnabled",v.target.checked),id:"midtermCheck"}),d.jsx("label",{htmlFor:"midtermCheck",style:{fontSize:"13px",cursor:"pointer"},children:"Enable Midterm Checkpoint"})]})]}),d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Task Settings"}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Tasks per Semester"}),d.jsx("input",{type:"number",value:g.totalTasks,onChange:v=>I("totalTasks",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Difficulty Configuration"}),d.jsxs("select",{value:g.difficultyMode||"fixed",onChange:v=>I("difficultyMode",v.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[d.jsx("option",{value:"fixed",children:"Fixed (50% Easy, 30% Medium, 20% Hard)"}),d.jsx("option",{value:"manual",children:"Manual (User chooses difficulty)"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Task Order Strategy"}),d.jsxs("select",{value:g.taskOrderStrategy,onChange:v=>I("taskOrderStrategy",v.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[d.jsx("option",{value:"sequential_task",children:"Order by Task (Materials  Research  Engagement)"}),d.jsx("option",{value:"sequential_difficulty",children:"Order by Difficulty (Easy  Medium  Hard)"})]})]})]}),d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Penalties & Mechanics"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Switch Cost (Points)"}),d.jsx("input",{type:"number",value:g.switchCost||0,onChange:v=>I("switchCost",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Refill Freeze (Seconds)"}),d.jsx("input",{type:"number",value:g.jarRefillFreezeTime||0,onChange:v=>I("jarRefillFreezeTime",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Unfinished Jar Penalty (Pts)"}),d.jsx("input",{type:"number",value:g.unfinishedJarPenalty||0,onChange:v=>I("unfinishedJarPenalty",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"AI Delay (Seconds)"}),d.jsx("input",{type:"number",value:g.aiDelay||0,onChange:v=>I("aiDelay",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]})]})]}),d.jsx("div",{style:{textAlign:"right"},children:d.jsx("button",{onClick:F,disabled:E,style:{padding:"12px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:E?"not-allowed":"pointer",fontWeight:"600",fontSize:"14px",opacity:E?.6:1},children:E?"Saving...":" Save Settings"})})]}),e==="players"&&d.jsxs("div",{style:{background:"white",padding:"25px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[d.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Active Sessions"}),d.jsx("button",{onClick:C,disabled:l,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:l?"not-allowed":"pointer",fontWeight:"500",opacity:l?.6:1},children:l?"Processing...":" Reset All Data"})]}),d.jsx("div",{style:{marginBottom:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"6px"},children:d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",textAlign:"center"},children:[d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:L}),d.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Total Students"})]}),d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:M}),d.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Have Played"})]}),d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:L-M}),d.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Never Played"})]})]})}),i?d.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"Loading student data..."}):d.jsx("div",{style:{overflowX:"auto"},children:d.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[d.jsx("thead",{children:d.jsxs("tr",{style:{background:"#f5f5f5",textAlign:"left"},children:[d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Student ID"}),d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Section"}),d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Has Played"}),d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Total Accesses"}),d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Highest Score"})]})}),d.jsx("tbody",{children:r.filter(v=>{var m;return!((m=v.section)!=null&&m.includes("ADMIN"))}).map(v=>d.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[d.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:v.sid||v.id}),d.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:v.section||"N/A"}),d.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:d.jsx("span",{style:{padding:"4px 12px",borderRadius:"12px",background:v.hasPlayed?"#e8f5e9":"#f5f5f5",color:v.hasPlayed?"#4CAF50":"#999",fontSize:"12px",fontWeight:"500"},children:v.hasPlayed?"Yes":"No"})}),d.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600"},children:v.totalAccesses||0}),d.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600",color:"#2196F3"},children:v.scores&&v.scores.length>0?Math.max(...v.scores.map(m=>m.total||0)):0})]},v.id))})]})})]}),e==="advice"&&d.jsxs("div",{style:{background:"white",padding:"60px 40px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),d.jsx("h2",{style:{fontSize:"24px",color:"#666",marginBottom:"15px",fontWeight:"500"},children:"Game Advice Configuration"}),d.jsx("p",{style:{color:"#999",maxWidth:"600px",margin:"0 auto 30px",lineHeight:"1.6"},children:"Configure contextual advice prompts based on remaining time and tasks completed. This feature will allow you to define dynamic advice messages for different game states."}),d.jsxs("div",{style:{marginTop:"40px",padding:"30px",background:"#f9f9f9",borderRadius:"8px",maxWidth:"500px",margin:"40px auto 0",border:"2px dashed #ddd"},children:[d.jsx("p",{style:{color:"#666",fontSize:"15px",margin:0,fontWeight:"500"},children:"Coming Soon: Dynamic 2D Advice Matrix"}),d.jsx("p",{style:{color:"#999",fontSize:"13px",margin:"10px 0 0",lineHeight:"1.5"},children:"Define advice based on time remaining  tasks completed thresholds"})]})]})]})}const EI={notifyGameComplete(t={}){try{window.parent.postMessage({type:"gameComplete",status:"finished",timestamp:new Date().toISOString(),...t},"*");try{if(window.parent&&window.parent.document){const e=window.parent.document.querySelector("#NextButton");e&&(e.style.display="inline-block",e.style.visibility="visible",e.disabled=!1)}}catch{window.parent.postMessage({type:"showNextButton",action:"show"},"*")}console.log(" Game completion notification sent to Qualtrics")}catch(e){console.error("Failed to notify Qualtrics:",e)}},notifySemesterComplete(t,e,n={}){try{window.parent.postMessage({type:"semesterComplete",semester:t,totalSemesters:e,timestamp:new Date().toISOString(),...n},"*"),window.parent.postMessage({type:"keepNextButtonVisible",action:"maintain"},"*"),console.log(` Semester ${t} completion notification sent`)}catch(r){console.error("Failed to notify Qualtrics of semester completion:",r)}},ensureNextButtonVisible(){try{window.parent.postMessage({type:"ensureNextButton",action:"show",timestamp:new Date().toISOString()},"*")}catch(t){console.error("Failed to ensure Next button visibility:",t)}}};function TI({onStart:t,totalTasks:e=10,orderStrategy:n="sequential_task",durationMinutes:r=12,difficultyMode:s="fixed"}){const[i,a]=D.useState({g2:0,g1:0,g3:0}),[l,u]=D.useState({g2:{easy:0,medium:0,hard:0},g1:{easy:0,medium:0,hard:0},g3:{easy:0,medium:0,hard:0}}),[h,p]=D.useState([]),[g,y]=D.useState(0),[E,A]=D.useState(null),P=["It's generally smart to do roughly an even number of each task.","This is because the tasks that are worth more points take more time to do, so you don't want to only do the shorter tasks or only do the longer tasks.","Of course, you might prefer one task over another, so you could take that into account. Do you feel like you are particularly good at one of the tasks?"],F=()=>{g<P.length?(p(m=>[...m,{sender:"AI",text:P[g]}]),y(m=>m+1)):p(m=>[...m,{sender:"AI",text:"I've shared my best advice! It's up to you now."}])},I=(m,x)=>{const w=parseInt(x)||0;a(k=>({...k,[m]:Math.max(0,w)})),A(null)},S=(m,x,w)=>{const k=parseInt(w)||0;u(R=>({...R,[m]:{...R[m],[x]:Math.max(0,k)}})),A(null)},L=s==="manual"?(()=>{let m=0;return Object.values(l).forEach(x=>{m+=x.easy+x.medium+x.hard}),m})():Object.values(i).reduce((m,x)=>m+x,0),M=L===e,v=()=>{if(L!==e){A(`Total tasks must equal ${e}. Currently: ${L}`);return}let m=[];s==="fixed"?["g2","g1","g3"].forEach(oe=>{const re=i[oe];if(re>0){const ie=Math.max(0,Math.round(re*.5)),$=Math.max(0,Math.round(re*.3)),N=Math.max(0,re-ie-$);for(let O=0;O<ie;O++)m.push({type:oe,difficulty:"easy"});for(let O=0;O<$;O++)m.push({type:oe,difficulty:"medium"});for(let O=0;O<N;O++)m.push({type:oe,difficulty:"hard"})}}):["g2","g1","g3"].forEach(oe=>{const{easy:re,medium:ie,hard:$}=l[oe];for(let N=0;N<re;N++)m.push({type:oe,difficulty:"easy"});for(let N=0;N<ie;N++)m.push({type:oe,difficulty:"medium"});for(let N=0;N<$;N++)m.push({type:oe,difficulty:"hard"})});const x={g2:{easy:1,medium:6,hard:11},g1:{easy:1,medium:6,hard:11},g3:{easy:1,medium:6,hard:11}},w=m.map(oe=>{const{type:re,difficulty:ie}=oe,$=x[re][ie]++;return{...oe,id:`${re}t${$}`}});let k=[];if(n==="sequential_difficulty"){const oe={easy:1,medium:2,hard:3},re={g2:1,g1:2,g3:3};k=w.sort((ie,$)=>oe[ie.difficulty]!==oe[$.difficulty]?oe[ie.difficulty]-oe[$.difficulty]:re[ie.type]-re[$.type])}else{const oe={g2:1,g1:2,g3:3},re={easy:1,medium:2,hard:3};k=w.sort((ie,$)=>oe[ie.type]!==oe[$.type]?oe[ie.type]-oe[$.type]:re[ie.difficulty]-re[$.difficulty])}const R=k.map(oe=>oe.id),T=s==="fixed"?i:{g2:l.g2.easy+l.g2.medium+l.g2.hard,g1:l.g1.easy+l.g1.medium+l.g1.hard,g3:l.g3.easy+l.g3.medium+l.g3.hard};t(R,T)};return d.jsxs("div",{style:{maxWidth:"900px",margin:"40px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[d.jsx("h1",{style:{textAlign:"center",marginBottom:"30px",color:"#333"},children:"Task Allocation Strategy"}),d.jsxs("div",{style:{marginBottom:"30px",lineHeight:"1.6",color:"#555"},children:[d.jsxs("p",{children:["You have ",d.jsxs("strong",{children:[r," minutes"]})," to complete ",d.jsxs("strong",{children:[e," tasks"]}),"."]}),d.jsx("p",{children:"You must decide now how many of each task type you want to perform."}),d.jsxs("p",{children:["Total tasks must add up to ",d.jsx("strong",{children:e}),"."]}),s==="fixed"&&d.jsx("p",{style:{fontSize:"14px",fontStyle:"italic",color:"#666"},children:"* Within each task type, tasks are distributed as 50% Easy, 30% Medium, 20% Hard."})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"40px",marginBottom:"40px"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[s==="fixed"?d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:uc,children:[d.jsxs("label",{style:dc,children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 1: Slider (Materials)"]}),d.jsx("input",{type:"number",min:"0",max:e,value:i.g2,onChange:m=>I("g2",m.target.value),style:hc})]}),d.jsxs("div",{style:uc,children:[d.jsxs("label",{style:dc,children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 2: Counting (Research)"]}),d.jsx("input",{type:"number",min:"0",max:e,value:i.g1,onChange:m=>I("g1",m.target.value),style:hc})]}),d.jsxs("div",{style:uc,children:[d.jsxs("label",{style:dc,children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 3: Typing (Engagement)"]}),d.jsx("input",{type:"number",min:"0",max:e,value:i.g3,onChange:m=>I("g3",m.target.value),style:hc})]})]}):d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[d.jsxs("div",{style:cc,children:[d.jsxs("div",{style:{fontWeight:"bold",marginBottom:"10px",display:"flex",alignItems:"center"},children:[d.jsx("span",{style:{fontSize:"20px",marginRight:"10px"},children:""})," Materials (Slider)"]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[d.jsx(Gn,{label:"Easy",value:l.g2.easy,onChange:m=>S("g2","easy",m)}),d.jsx(Gn,{label:"Medium",value:l.g2.medium,onChange:m=>S("g2","medium",m)}),d.jsx(Gn,{label:"Hard",value:l.g2.hard,onChange:m=>S("g2","hard",m)})]})]}),d.jsxs("div",{style:cc,children:[d.jsxs("div",{style:{fontWeight:"bold",marginBottom:"10px",display:"flex",alignItems:"center"},children:[d.jsx("span",{style:{fontSize:"20px",marginRight:"10px"},children:""})," Research (Counting)"]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[d.jsx(Gn,{label:"Easy",value:l.g1.easy,onChange:m=>S("g1","easy",m)}),d.jsx(Gn,{label:"Medium",value:l.g1.medium,onChange:m=>S("g1","medium",m)}),d.jsx(Gn,{label:"Hard",value:l.g1.hard,onChange:m=>S("g1","hard",m)})]})]}),d.jsxs("div",{style:cc,children:[d.jsxs("div",{style:{fontWeight:"bold",marginBottom:"10px",display:"flex",alignItems:"center"},children:[d.jsx("span",{style:{fontSize:"20px",marginRight:"10px"},children:""})," Engagement (Typing)"]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[d.jsx(Gn,{label:"Easy",value:l.g3.easy,onChange:m=>S("g3","easy",m)}),d.jsx(Gn,{label:"Medium",value:l.g3.medium,onChange:m=>S("g3","medium",m)}),d.jsx(Gn,{label:"Hard",value:l.g3.hard,onChange:m=>S("g3","hard",m)})]})]})]}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:M?"#e8f5e9":"#ffebee",borderRadius:"8px",textAlign:"center",fontWeight:"bold",color:M?"#2e7d32":"#c62828"},children:["Total Allocated: ",L," / ",e]}),E&&d.jsx("div",{style:{color:"red",textAlign:"center",fontSize:"14px"},children:E})]}),d.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"12px",padding:"20px",display:"flex",flexDirection:"column"},children:[d.jsxs("div",{style:{flex:1,marginBottom:"15px",overflowY:"auto",maxHeight:"300px",display:"flex",flexDirection:"column",gap:"10px"},children:[h.length===0&&d.jsx("div",{style:{color:"#999",fontStyle:"italic",textAlign:"center",marginTop:"40px"},children:"Need advice? Ask the AI helper."}),h.map((m,x)=>d.jsxs("div",{style:{background:"#f0f7ff",padding:"10px 15px",borderRadius:"12px 12px 12px 0",alignSelf:"flex-start",maxWidth:"90%"},children:[d.jsx("strong",{children:" AI:"})," ",m.text]},x))]}),d.jsxs("button",{onClick:F,style:{background:"#2196F3",color:"white",border:"none",padding:"12px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[d.jsx("span",{children:""})," Ask AI for Recommendation"]})]})]}),d.jsx("div",{style:{textAlign:"center"},children:d.jsx("button",{onClick:v,disabled:!M,style:{background:M?"#4CAF50":"#ccc",color:"white",border:"none",padding:"15px 40px",fontSize:"18px",borderRadius:"30px",cursor:M?"pointer":"not-allowed",fontWeight:"bold",boxShadow:M?"0 4px 15px rgba(76, 175, 80, 0.3)":"none",transition:"all 0.2s"},children:"Start Experiment"})})]})}const Gn=({label:t,value:e,onChange:n})=>d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[d.jsx("label",{style:{fontSize:"12px",marginBottom:"4px",color:"#666"},children:t}),d.jsx("input",{type:"number",min:"0",value:e,onChange:r=>n(r.target.value),style:{width:"50px",padding:"8px",textAlign:"center",border:"1px solid #ddd",borderRadius:"4px"}})]}),uc={display:"flex",alignItems:"center",justifyContent:"space-between",background:"#f9f9f9",padding:"15px",borderRadius:"8px"},cc={background:"#f9f9f9",padding:"15px",borderRadius:"8px",border:"1px solid #eee"},dc={fontWeight:"bold",color:"#333",display:"flex",alignItems:"center"},hc={width:"60px",padding:"10px",fontSize:"18px",textAlign:"center",borderRadius:"6px",border:"1px solid #ddd"};function II({currentTaskIndex:t,totalTasks:e,taskQueue:n,onSwitchTask:r,onRefill:s,children:i,points:a,timeRemaining:l,onTimeUp:u,chatInterface:h}){const p=n[t];(C=>C.startsWith("g1")?{name:"Research",icon:"",color:"#9C27B0",bg:"#f3e5f5"}:C.startsWith("g2")?{name:"Materials",icon:"",color:"#4CAF50",bg:"#e8f5e9"}:C.startsWith("g3")?{name:"Engagement",icon:"",color:"#f44336",bg:"#ffebee"}:{name:"Unknown",icon:"",color:"#333",bg:"#eee"})(p);const y=n.slice(0,t),E={g1:y.filter(C=>C.startsWith("g1")).length,g2:y.filter(C=>C.startsWith("g2")).length,g3:y.filter(C=>C.startsWith("g3")).length},A=e-t,P=n.slice(t),F={g2:P.filter(C=>C.startsWith("g2")),g1:P.filter(C=>C.startsWith("g1")),g3:P.filter(C=>C.startsWith("g3"))},I=C=>p.startsWith(C),S=(C,V,L,M,v,m)=>{const x=m.length,w=I(C),k=x>0;return d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",background:v,borderRadius:"12px",padding:"10px",border:`2px solid ${w?M:"transparent"}`,height:"100%",position:"relative"},children:[d.jsxs("div",{style:{fontSize:"14px",fontWeight:"bold",color:M,marginBottom:"10px",display:"flex",alignItems:"center",gap:"5px"},children:[d.jsx("span",{children:L}),d.jsx("span",{children:x})]}),d.jsx("div",{style:{flex:1,width:"100%",display:"flex",flexDirection:"column",gap:"5px",justifyContent:"flex-end",paddingBottom:"10px"},children:k?d.jsxs(d.Fragment,{children:[m.slice(1).map((R,T)=>d.jsx("div",{style:{height:"8px",width:"80%",background:M,opacity:.4,borderRadius:"4px",margin:"0 auto"}},T)),d.jsx("button",{onClick:()=>!w&&r(C),disabled:w,style:{width:"100%",padding:"15px 5px",background:w?M:"white",color:w?"white":M,border:`2px solid ${M}`,borderRadius:"8px",cursor:w?"default":"pointer",fontWeight:"bold",fontSize:"12px",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",transition:"transform 0.1s",zIndex:2},children:w?"Current":"Switch"})]}):d.jsx("button",{onClick:()=>s&&s(C),style:{width:"100%",padding:"10px 5px",background:"white",border:"2px dashed #999",borderRadius:"8px",color:"#666",cursor:"pointer",fontSize:"12px"},children:" Refill"})}),d.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"5px"},children:V})]})};return d.jsxs("div",{style:{maxWidth:"1600px",margin:"0 auto",padding:"20px"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"white",padding:"15px 25px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[d.jsx("div",{style:{width:"200px"},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""}),d.jsx("div",{children:d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:l<60?"#f44336":"#333",animation:l<60?"pulse 1s infinite":"none"},children:[Math.floor(l/60),":",(l%60).toString().padStart(2,"0")]})})]})}),d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Points"}),d.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#2196F3"},children:a})]}),d.jsxs("div",{style:{textAlign:"right",minWidth:"300px"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"5px"},children:"Task Progress"}),d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"15px"},children:[d.jsxs("div",{style:{display:"flex",gap:"10px",fontSize:"16px",fontWeight:"500",color:"#555"},children:[d.jsxs("span",{title:"Materials Done",children:[" ",E.g2]}),d.jsx("span",{style:{color:"#ddd"},children:"|"}),d.jsxs("span",{title:"Research Done",children:[" ",E.g1]}),d.jsx("span",{style:{color:"#ddd"},children:"|"}),d.jsxs("span",{title:"Engagement Done",children:[" ",E.g3]})]}),d.jsxs("div",{style:{background:"#eee",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold",color:"#333"},children:["Remaining: ",A]})]})]})]}),d.jsxs("div",{className:"task-runner-layout",style:{display:"grid",gridTemplateColumns:"320px 1fr 320px",gap:"20px",height:"calc(100vh - 140px)",boxSizing:"border-box"},children:[d.jsxs("div",{style:{background:"white",padding:"15px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",height:"fit-content",maxHeight:"100%"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#666",textAlign:"center"},children:"Task Jars"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px",flex:1},children:[S("g2","Materials","","#4CAF50","#e8f5e9",F.g2),S("g1","Research","","#9C27B0","#f3e5f5",F.g1),S("g3","Engagement","","#f44336","#ffebee",F.g3)]})]}),d.jsx("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",overflow:"hidden",display:"flex",flexDirection:"column"},children:i}),d.jsx("div",{style:{height:"100%",overflow:"hidden"},children:h&&d.jsx("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:h})})]}),d.jsx("style",{children:`
        @keyframes pulse {
          0% { opacity: 1; }
          50% { opacity: 0.5; }
          100% { opacity: 1; }
        }
      `})]})}function CI({timeRemaining:t,onSelectTask:e,onFinishEarly:n}){return d.jsxs("div",{style:{maxWidth:"800px",margin:"40px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsx("h1",{style:{color:"#2196F3",marginBottom:"20px"},children:" All Tasks Completed!"}),d.jsxs("div",{style:{fontSize:"18px",color:"#555",marginBottom:"30px",lineHeight:"1.6"},children:[d.jsx("p",{children:"You have finished all 10 allocated tasks with time to spare."}),d.jsxs("p",{children:["You currently have ",d.jsxs("strong",{children:[Math.floor(t/60)," minutes and ",t%60," seconds"]})," remaining."]}),d.jsxs("p",{children:["You can choose to do more tasks for ",d.jsx("strong",{children:"1/2 credit"})," to increase your score, or finish the experiment now."]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"40px"},children:[d.jsxs("button",{onClick:()=>e("g2"),style:fc("#4CAF50"),children:[d.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Materials Task",d.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),d.jsxs("button",{onClick:()=>e("g1"),style:fc("#9C27B0"),children:[d.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Research Task",d.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),d.jsxs("button",{onClick:()=>e("g3"),style:fc("#f44336"),children:[d.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Engagement Task",d.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]})]}),d.jsx("div",{style:{borderTop:"1px solid #eee",paddingTop:"30px"},children:d.jsx("button",{onClick:n,style:{background:"#f5f5f5",color:"#666",border:"1px solid #ddd",padding:"12px 30px",fontSize:"16px",borderRadius:"30px",cursor:"pointer",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:r=>r.target.style.background="#e0e0e0",onMouseLeave:r=>r.target.style.background="#f5f5f5",children:"No thanks, I'm done"})})]})}const fc=t=>({background:"white",border:`2px solid ${t}`,color:t,padding:"20px",borderRadius:"12px",cursor:"pointer",fontSize:"16px",fontWeight:"bold",transition:"all 0.2s",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"});function AI(t,e){const n=t.length,r=e.length,s=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let i=0;i<=n;i++)s[i][0]=i;for(let i=0;i<=r;i++)s[0][i]=i;for(let i=1;i<=n;i++)for(let a=1;a<=r;a++)t[i-1]===e[a-1]?s[i][a]=s[i-1][a-1]:s[i][a]=Math.min(s[i-1][a]+1,s[i][a-1]+1,s[i-1][a-1]+1);return s[n][r]}function kI(){const e=new URLSearchParams(window.location.search).get("admin")==="berkeley2024",[n,r]=D.useState("landing"),[s,i]=D.useState(null),[a,l]=D.useState(null),[u,h]=D.useState("g2t1"),[p,g]=D.useState({}),[y,E]=D.useState(0),[A,P]=D.useState(null),[F,I]=D.useState(!1),[S,C]=D.useState(""),[V,L]=D.useState(!0),[M,v]=D.useState(0),[m,x]=D.useState({}),[w,k]=D.useState(0),[R,T]=D.useState(0),[oe,re]=D.useState(!1),[ie,$]=D.useState(null),[N,O]=D.useState(!1),[G,ee]=D.useState(30),[te,le]=D.useState(!1),[ke,we]=D.useState(5),[fe,de]=D.useState(!1),[Fe,Se]=D.useState(0),[ne,Ce]=D.useState(1),[ze]=D.useState(2),[Re,Et]=D.useState([]),[Kt,Yt]=D.useState(null),[Xt,Jt]=D.useState(!1),[dr,hr]=D.useState(0),[Pn,fr]=D.useState(null),[Pe,Ai]=D.useState({g2t1:!1,g1t1:!1,g3t1:!1}),[ra,st]=D.useState(720),[Je,pr]=D.useState(720),[Xr,ki]=D.useState(0),[Ie,Zt]=D.useState({materials:0,research:0,engagement:0,bonus:0}),[Jr,Es]=D.useState({}),[sa,ia]=D.useState({}),[hf,Ts]=D.useState({}),[Be,oa]=D.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,unfinishedTaskPenalty:0,taskOrderStrategy:"sequential_task",freezePenalty:0,contextAdviceEnabled:!0,difficultyMode:"fixed",switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0});D.useEffect(()=>{(async()=>{try{const B=bt(tt,"game_settings","global"),W=await cf(B);if(W.exists()){const K=W.data();if(oa(he=>({...he,...K})),K.semesterDuration){const he=K.semesterDuration*60;st(he),pr(he),As.current=he,bi.current=he}}}catch(B){console.error("Error loading global config:",B)}})()},[]);const[Ft,zn]=D.useState([]),[Bn,gn]=D.useState(0),[aa,Is]=D.useState(null),[vu,Cs]=D.useState(!1),[la,it]=D.useState([]),[ua,Un]=D.useState(!1),[$n,_u]=D.useState(!0),[xu,mr]=D.useState(0),Ri=D.useRef(Date.now()),Zr=D.useRef(null);D.useRef(null),D.useRef(null);const gr=D.useRef(null),Pi=D.useRef(Date.now()),bi=D.useRef(720),As=D.useRef(720),zt=()=>{const q=(Be.semesterDuration||12)*60*1e3,B=Math.floor(q/2e3);return Math.floor(B/60)};if(D.useEffect(()=>{(async()=>{try{const B=new URLSearchParams(window.location.search),W=B.has("code")||B.has("c");if((B.get("code")||B.get("c"))==="MASTER"){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",section:"master_admin",hasAI:!1,isMasterInterface:!0,displayName:"Master Administrator"})),L(!1);return}if(e&&!sessionStorage.getItem("gameConfig")&&sessionStorage.setItem("gameConfig",JSON.stringify({role:"admin",section:"admin",hasAI:!0,checkpointSemester2:!0,displayName:"Admin User"})),!W){r("studentLogin"),L(!1);return}const{allowed:he,reason:qe,resumeSession:De,newSession:Ke,code:ht,codeData:Bt}=await qm.checkAccess();if(!he){I(!0),C(qe),L(!1);return}if(De)P(De),localStorage.setItem("sessionId",De);else if(Ke){const ft=await qm.createSession(ht,Bt);P(ft)}await et.syncOfflineEvents(),L(!1)}catch{L(!1)}})()},[]),D.useEffect(()=>{n==="complete"&&ne>=ze&&EI.notifyGameComplete({finalScore:Math.round(yr())+(Ie.bonus||0),totalTime:M,semestersCompleted:ne,sessionId:A})},[n,ne,ze,M,Ie.bonus,A]),D.useEffect(()=>{localStorage.setItem("currentTask",u)},[u]),D.useEffect(()=>{localStorage.setItem("gameMode",JSON.stringify(s))},[s]),D.useEffect(()=>{localStorage.setItem("currentSemester",ne.toString())},[ne]),D.useEffect(()=>{localStorage.setItem("totalSemesters",ze.toString())},[ze]),D.useEffect(()=>{localStorage.setItem("completedTasksCount",Object.keys(p).length.toString())},[p]),D.useEffect(()=>{localStorage.setItem("completedLevels",y.toString())},[y]),D.useEffect(()=>{localStorage.setItem("totalSwitches",w.toString())},[w]),D.useEffect(()=>{localStorage.setItem("categoryPoints",JSON.stringify(Ie))},[Ie]),D.useEffect(()=>{localStorage.setItem("studentLearningScore",Xr.toString())},[Xr]),D.useEffect(()=>{const q=Pe.g2t1&&Pe.g1t1&&Pe.g3t1;localStorage.setItem("practiceCompleted",q.toString())},[Pe]),V)return d.jsx("div",{className:"app",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:d.jsx("h2",{children:"Loading..."})});if(window.location.search.includes("master=true")&&JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="master_admin")return d.jsx(SI,{onClose:()=>r("landing")});if(window.location.search.includes("admin=true"))return d.jsx(xI,{});const yr=(q=Ie,B=Jr)=>{let W=0;Object.entries(B).forEach(([Ke,ht])=>{const ft=1+parseInt(Ke)*.15;W+=ht*ft});const K=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,he=W+K,qe=q.materials||0,De=q.research||0;return console.log(` STUDENT LEARNING: ${he.toFixed(1)} pts | Materials: ${qe} (with sequential multipliers) | Research: ${De} | Interest: ${K.toFixed(1)} = ${he.toFixed(1)}`),isNaN(he)?0:he},ca=()=>{if(!(ne===2&&Be.midtermEnabled))return;Jt(!0),yr()>=300?(hr(300),Zt(K=>({...K,bonus:(K.bonus||0)+300}))):hr(0),re(!0),$("checkpoint")},ks=()=>{const q=(Be.semesterDuration||12)*60*1e3,B=Math.floor(q/1e3);st(B),pr(B),Ri.current=Date.now(),Zr.current=setInterval(()=>{const K=Date.now()-Ri.current,he=Math.floor(K/1e3);v(he);const qe=Math.max(0,B-he);if(pr(qe),he%10===0&&A&&!A.startsWith("offline-")&&Yn(bt(tt,"sessions",A),{timeElapsed:he,lastUpdated:En()}).catch(Ke=>console.error("Failed to update session time:",Ke)),ne===2&&Be.midtermEnabled){const Ke=(Be.semesterDuration||12)*60*1e3,ht=Math.floor(Ke/2e3);he===ht&&!Xt&&ca()}qe<=0&&(clearInterval(Zr.current),Zr.current=null,bn("semester_complete"))},1e3)},Rs=q=>{const W=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin",K=Pe.g2t1&&Pe.g1t1&&Pe.g3t1;l(q),et.logEvent("practice_choice",{choice:q}),q==="no"?!W&&!K?(un("You must complete all three practice tasks first!"),r("practice")):Di():r("practice")},Di=()=>{if(!Kt){const q=Math.floor(Math.random()*1e6);Yt(q),tr.initializeSeed(q),A&&!A.startsWith("offline-")&&Yn(bt(tt,"sessions",A),{randomSeed:q,[`semesterSeeds.semester${ne}`]:q})}localStorage.setItem("engagementInterest","0"),Zt({materials:0,research:0,engagement:0,bonus:0}),Es({}),r("allocation"),g({}),E(0),k(0),T(0),Jt(!1),ia({}),Ts({})},da=(q,B)=>{zn(q),Is(B),gn(0),r("challenge");const K=`${q[0]}t1`;h(K),x({[K]:Date.now()}),et.setPageStartTime(K),ks(),et.logEvent("allocation_complete",{counts:B,queue:q,timestamp:Date.now()})},wu=q=>{const B=Ft[Bn].substring(0,2);if(B===q)return;const W=Be.switchCost||0;W>0&&(Zt(Ne=>({...Ne,bonus:(Ne.bonus||0)-W})),un(`Switching tasks cost ${W} points!`));const K=[...Ft],he=K.slice(Bn),qe=K.slice(0,Bn),De=he.filter(Ne=>Ne.startsWith(B)),Ke=he.filter(Ne=>Ne.startsWith(q)),ht=he.filter(Ne=>!Ne.startsWith(B)&&!Ne.startsWith(q)),Bt=[...Ke,...ht,...De],ft=[...qe,...Bt];if(zn(ft),k(Ne=>Ne+1),Ke.length>0){const Ne=Ke[0];Ps(Ne)}},vr=async(q,B)=>{Pi.current=Date.now();let W=0;const K=q.startsWith("g1")?"research":q.startsWith("g2")?"materials":"engagement";if(K==="materials")if(B.points!==void 0)W=B.points;else{const Y=parseFloat(B.userAnswer||B.userValue||0),Le=parseFloat(B.correctAnswer||B.targetValue||0),pt=Math.abs(Y-Le);pt===0?W=2:pt<=1?W=1:W=0}else if(K==="research")if(B.points!==void 0)W=B.points;else{const Y=parseInt(B.userAnswer||0),Le=parseInt(B.correctAnswer||0),pt=Math.abs(Y-Le);pt===0?W=2:pt<=1?W=1:W=0}else if(K==="engagement")if(B.points!==void 0)W=B.points;else{const Y=B.userAnswer||"",Le=B.correctAnswer||"";Y===Le?W=2:AI(Y,Le)===1?W=1:W=0}if(Zt(Y=>{const Le={...Y,[K]:Y[K]+W};return console.log(` Updated ${K}: +${W} (total: ${Le[K]})`),Le}),K==="materials"&&W>0){const Y=Ie.research;Es(Le=>{const pt=Le[Y]||0;return{...Le,[Y]:pt+W}})}const qe=.0015*(K==="engagement"?Ie.engagement+W:Ie.engagement),De={...Ie,[K]:Ie[K]+W};let Ke=Jr;if(K==="materials"&&W>0){const Y=Ie.research,Le=Jr[Y]||0;Ke={...Jr,[Y]:Le+W}}let ht=0;Object.entries(Ke).forEach(([Y,Le])=>{const Hn=1+parseInt(Y)*.15;ht+=Le*Hn});const ft=parseFloat(localStorage.getItem("engagementInterest")||"0")+qe*ht;localStorage.setItem("engagementInterest",ft.toString()),Ts(Y=>({...Y,[q]:W})),ia(Y=>({...Y,[q]:(Y[q]||0)+1}));const Ne={...Ie,[K]:Ie[K]+W},_r=yr(Ne,Ke);ki(_r);let Nt="";if(K==="materials"){const Y=Math.abs((B.userValue||0)-(B.targetValue||0));Y===0?Nt="Perfect materials!":Y<=1?Nt=`Off by ${Y.toFixed(2)}`:Nt=`Off by ${Y.toFixed(2)}`}else if(K==="research"){const Y=Math.abs((B.userAnswer||0)-(B.correctAnswer||0));Y===0?Nt="Perfect research!":Y<=1?Nt=`Off by ${Y}`:Nt=`Off by ${Y}`}else K==="engagement"&&(W===2?Nt="Perfect engagement!":W===1?Nt="One typo":Nt="Multiple errors");un(`${Nt} | +${W} ${K} pts`),g(Y=>({...Y,[q]:!0})),E(Y=>Y+1),T(Y=>Y+1),await et.trackTaskComplete(q,B.attempts,B.totalTime,B.accuracy||B.difference||0),await et.logEvent("task_complete",{taskId:q,...B,pointsEarned:W,categoryPoints:De,studentLearningScore:_r,engagementInterest:ft,completionContext:{totalTasksCompleted:Object.keys(p).length+1,currentGameTime:M,switchesBeforeCompletion:w,bonusPromptsEarned:R+1,timeRemaining:Je}}),A&&!A.startsWith("offline-")&&await Yn(bt(tt,"sessions",A),{[`completedTasks.${q}`]:!0,[`taskPoints.${q}`]:W,categoryPoints:De,studentLearningScore:_r,engagementInterest:ft,bonusPrompts:R+1,lastActivity:En()});const bs=Bn+1;if(bs<Ft.length){gn(bs);const Y=Ft[bs];let Le=Object.keys(p).filter(Eu=>Eu.startsWith(Y)).length;Y===q.substring(0,2)&&q.startsWith(Y)&&(Le+=1);const pt=Le+1,Hn=`${Y}t${pt}`;Ps(Hn,!0)}else bn("all_tasks_done")},Ps=async(q,B=!1)=>{if(!oe){if(p[q]&&!B){un("Task already completed! Choose a different task.");return}if(B||await et.logEvent("manual_tab_switch",{from:u,to:q,reason:"user_clicked"}),Pi.current=Date.now(),te&&(le(!1),we(5),gr.current&&(clearInterval(gr.current),gr.current=null)),u!==q&&!B&&k(W=>W+1),await et.trackPageSwitch(u,q,B),m[u]){const W=Date.now()-m[u];await et.logEvent("task_time",{taskId:u,timeSpent:W,completed:p[u]||!1,leftForTask:q})}h(q),x(W=>({...W,[q]:Date.now()})),et.setPageStartTime(q)}},un=q=>{const B=document.createElement("div");B.className="notification-enter",B.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",B.textContent=q,document.body.appendChild(B),setTimeout(()=>{B.className="notification-exit",setTimeout(()=>{document.body.contains(B)&&document.body.removeChild(B)},500)},3e3)},bn=async(q="semester_complete")=>{Zr.current&&clearInterval(Zr.current);const B=Math.floor((Date.now()-Ri.current-Fe)/1e3),W=yr(),K=Ie.bonus||0,he=Math.max(0,Be.totalTasks-Object.keys(p).length),qe=he*(Be.unfinishedTaskPenalty||0),De=Math.round(W)+K-qe;qe>0&&console.log(` Unfinished Penalty: -${qe} pts (${he} tasks x ${Be.unfinishedTaskPenalty})`),await et.logEvent("game_complete",{totalTime:B,totalSwitches:w,completedTasks:Object.keys(p).length,completedLevels:y,completionReason:q,gameMode:s,currentSemester:ne,categoryPoints:Ie,studentLearningScore:W,totalBonus:K,finalScore:De,finalContext:{practiceCompleted:a==="yes",totalPrompts:3+R,isAdminMode:e}}),A&&!A.startsWith("offline-")&&await Yn(bt(tt,"sessions",A),{status:"completed",completedAt:En(),finalTime:B,timeElapsed:B,totalSwitches:w,completionReason:q,currentSemester:ne,finalScore:De,studentLearningScore:W}),r("complete")},Wn=async q=>{const B={sender:"user",text:q,timestamp:Date.now()};it(K=>[...K,B]),Un(!0);const W={currentTask:u,timeRemaining:Je,score:Math.round(Xr),completedTasks:Object.keys(p).length,totalTasks:Ft.length};try{const K=(Be.aiDelay||0)*1e3,he=await Fl.getAdvice(q,W);setTimeout(()=>{const qe={sender:"ai",text:he,timestamp:Date.now()};it(De=>[...De,qe]),Un(!1),$n||mr(De=>De+1),Be.aiCost>0&&(Zt(De=>({...De,bonus:(De.bonus||0)-Be.aiCost})),un(`AI Help Cost: -${Be.aiCost} pts`))},Math.max(1e3,K))}catch(K){console.error("AI Error:",K),Un(!1),it(he=>[...he,{sender:"ai",text:"I'm having trouble connecting right now. Please try again.",timestamp:Date.now()}])}},yn=(q,B)=>{if(B&&B.points&&B.points===2)Ai(W=>({...W,[q]:!0})),un("Perfect! Practice task completed."),setTimeout(()=>{fr(null)},1500);else{const W=(B==null?void 0:B.points)||0;un(`Practice requires 100% accuracy. You scored ${W===1?"50%":"0%"}. Try again!`),setTimeout(()=>{fr(null)},2e3)}},Su=()=>{const q=u[1],B=parseInt(u.substring(3)),W=n==="practice";return q==="1"?d.jsx(Pd,{taskNum:B,onComplete:W?yn:vr,currentTaskId:u,isPractice:W}):q==="2"?d.jsx(bd,{taskNum:B,onComplete:W?yn:vr,currentTaskId:u,isPractice:W}):d.jsx(Dd,{taskNum:B,onComplete:W?yn:vr,currentTaskId:u,isPractice:W})};if(n==="studentLogin")return d.jsx(_I,{onLoginSuccess:q=>{window.location.href=`${window.location.origin}?code=${q}`}});if(F)return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"600px",margin:"50px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[d.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Access Denied"}),d.jsx("p",{style:{fontSize:"18px",marginBottom:"20px"},children:S}),d.jsx("div",{style:{padding:"15px",background:"#ffebee",borderRadius:"8px",border:"1px solid #f44336"},children:d.jsx("p",{style:{color:"#c62828",margin:0},children:"If you believe this is an error, please contact your instructor."})})]})});if(n==="semesterBreak"){const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),B=ne===2&&q.checkpointSemester2;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"700px",margin:"50px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsxs("h1",{style:{color:"#2196F3",marginBottom:"30px"},children:[" Semester ",ne-1," Complete!"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsx("h3",{style:{color:"#1976d2",marginBottom:"10px"},children:"Take a Break!"}),d.jsxs("p",{style:{fontSize:"16px",color:"#666",marginBottom:"0"},children:["Great job completing Semester ",ne-1,"! Take a moment to rest your eyes, stretch, or grab some water before continuing."]})]}),B&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",padding:"25px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #ff9800"},children:[d.jsx("h3",{style:{color:"#f57c00",marginBottom:"15px"},children:" Midterm Checkpoint Coming!"}),d.jsxs("div",{style:{fontSize:"16px",color:"#666",textAlign:"left"},children:[d.jsx("p",{style:{marginBottom:"10px"},children:d.jsxs("strong",{children:["Semester 2 includes a midterm exam at the"," ",zt(),"-minute mark!"]})}),d.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"10px"},children:[d.jsx("li",{children:"Your students will be tested at the midpoint"}),d.jsxs("li",{children:["If student learning  300 points:"," ",d.jsx("strong",{children:"+300 bonus points!"})]}),d.jsx("li",{children:"Build up your teaching effectiveness early to maximize the bonus"})]}),d.jsxs("p",{style:{background:"white",padding:"10px",borderRadius:"4px",textAlign:"center",fontWeight:"bold",color:"#f57c00"},children:["Goal: Reach 300+ Student Learning by minute"," ",zt()]})]})]}),Re.length>0&&d.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"10px"},children:"Your Performance So Far:"}),Re.map((W,K)=>d.jsxs("div",{style:{marginBottom:"8px",fontSize:"16px"},children:["Semester ",K+1,":"," ",d.jsxs("strong",{children:[W.finalScore," points"]})]},K))]}),d.jsxs("div",{style:{marginTop:"30px"},children:[d.jsxs("button",{onClick:()=>{Ce(W=>W+1),r("allocation"),g({}),zn([]),gn(0),ki(0),Zt({materials:0,research:0,engagement:0,bonus:0}),ks(),x({g2t1:Date.now()}),et.setPageStartTime("g2t1"),et.logEvent("semester_start",{semester:ne,timestamp:Date.now(),hasCheckpoint:B})},style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:W=>{W.currentTarget.style.transform="translateY(-2px)",W.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:W=>{W.currentTarget.style.transform="translateY(0)",W.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["I'm Ready - Start Semester ",ne]}),d.jsx("p",{style:{marginTop:"15px",fontSize:"14px",color:"#999"},children:"Click when you're ready to continue. The timer will start immediately."})]})]})})}if(n==="landing"){s||i({accuracy:"lenient",limit:"time"});const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),B=q.role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",style:{padding:"40px",maxWidth:"900px"},children:[d.jsxs("h1",{style:{color:"#333",marginBottom:"30px",fontSize:"32px",textAlign:"left"},children:["Can you beat Park? - Semester ",ne,"/",ze]}),d.jsxs("div",{className:"game-info",style:{textAlign:"left"},children:[d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#f44336",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Engagement"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Build interest that compounds! Each point adds 0.15% interest after every task completion."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#9C27B0",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Research"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Research amplifies your FUTURE materials! Each point adds +15% multiplier to materials earned after the research (order matters!)."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#4CAF50",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Materials"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Create teaching materials - each point directly contributes to your goal points!"})]}),d.jsxs("div",{style:{background:"#f0f8ff",borderRadius:"8px",padding:"25px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{color:"#2196F3",fontSize:"20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Student Learning Formula"]}),d.jsxs("div",{style:{background:"white",padding:"18px",borderRadius:"6px",fontFamily:"monospace",fontSize:"18px",textAlign:"center",marginBottom:"20px",border:"1px solid #e0e0e0",lineHeight:"1.8"},children:["Goal ="," ",d.jsx("strong",{children:"Materials  (1 + Research0.15) + Engagement Interest"}),d.jsx("br",{}),d.jsxs("div",{style:{fontSize:"14px",marginTop:"10px",fontFamily:"sans-serif"},children:["Research multipliers apply only to materials earned"," ",d.jsx("em",{children:"after"})," the research"]})]}),d.jsxs("ul",{style:{color:"#333",lineHeight:"2",margin:"0",paddingLeft:"25px",fontSize:"15px",textAlign:"left"},children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Scoring:"})," Exact = 2 pts | Within 1 = 1 pt | Otherwise = 0 pts"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Timing:"})," Task completion order affects your final score"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Strategy:"})," Think carefully about when to complete each task type!"]}),ne===2&&d.jsxs("li",{children:["At minute ",zt(),": Exam checkpoint with bonus opportunity (300+ Student Learning = 300 bonus)"]})]})]}),q.hasAI&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"1px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"AI Assistant Available:"}),d.jsxs("ul",{style:{color:"#856404",lineHeight:"1.6",margin:"0",paddingLeft:"20px",fontSize:"14px"},children:[d.jsx("li",{children:"Click the help buttons below each task for AI assistance"}),d.jsx("li",{children:"Unlimited use but reliability varies"}),d.jsx("li",{children:'Type "strategy" or "order" in chat for strategic advice!'})]})]}),ne===2&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"2px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:" Semester 2: Midterm Checkpoint!"}),d.jsxs("p",{style:{color:"#856404",fontSize:"14px",margin:0},children:["At the ",zt(),"-minute mark, if you have 300+ student learning points, you'll earn a 300-point bonus!"]})]})]}),!B&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)",borderRadius:"12px",padding:"20px",marginTop:"20px",marginBottom:"20px",border:"2px solid #d32f2f",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"12px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""}),d.jsx("h3",{style:{color:"#b71c1c",margin:0,fontSize:"18px",fontWeight:"600"},children:"ONE ATTEMPT ONLY - NO RESTART"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No refresh/close"})," - Session ends"]})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No tab switching"})," - 30s warning"]})]})]}),d.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"6px",textAlign:"center",fontSize:"14px",color:"#b71c1c",fontWeight:"600"},children:" Ensure 40 minutes uninterrupted before starting"})]}),d.jsxs("button",{className:"start-button",onClick:()=>r("practiceChoice"),children:["Start Semester ",ne]}),e&&d.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#ffcccb",borderRadius:"6px",border:"2px solid #ff0000",fontWeight:"bold",color:"#d00"},children:["ADMIN MODE: ",ra/60," minute timer, checkpoint at"," ",zt(),"minute"]}),Re.length>0&&d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"6px",fontSize:"14px"},children:[d.jsx("strong",{children:"Previous Semesters:"}),Re.map((W,K)=>d.jsxs("div",{style:{marginTop:"5px"},children:["Semester ",K+1,": ",W.finalScore," points"]},K))]})]})})})}if(n==="practiceChoice"){const B=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",children:[d.jsx("h2",{style:{color:"#333",marginBottom:"20px"},children:B?"Practice Mode (Optional for Admin)":"Practice Mode (Required)"}),d.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:B?"As an admin, you can skip practice or try it first.":"You must complete all three practice tasks before starting the main game."}),d.jsx("p",{style:{color:"#888",fontSize:"14px",marginBottom:"30px",fontStyle:"italic"},children:"Practice lets you try each teaching task without time pressure."}),!B&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #1976d2",boxShadow:"0 4px 6px rgba(25, 118, 210, 0.1)"},children:[d.jsxs("h4",{style:{color:"#0d47a1",margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:""}),"Required Practice Tasks (100% accuracy needed):"]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Pe.g2t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Pe.g2t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Materials"})}),Pe.g2t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Pe.g1t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Pe.g1t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Research"})}),Pe.g1t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Pe.g3t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Pe.g3t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Engagement"})}),Pe.g3t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]})]}),d.jsx("div",{style:{marginTop:"16px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"6px",fontSize:"13px",color:"#0d47a1",textAlign:"center",fontStyle:"italic"},children:" Each task must be completed perfectly to proceed"})]}),d.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[d.jsx("button",{onClick:()=>Rs("yes"),style:{padding:"15px 30px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:B?"Try Practice Mode":"Start Required Practice"}),B&&d.jsx("button",{onClick:()=>Rs("no"),style:{padding:"15px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:"Skip Practice (Admin)"})]})]})})})}if(n==="practice"){const B=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";if(!Pn)return d.jsxs("div",{className:"app",children:[d.jsx("h1",{children:"Teaching Simulation - Practice Mode"}),d.jsx(gI,{practiceCompleted:Pe,onPracticeComplete:yn,onSelectPractice:fr,onStartMainGame:()=>{const he=Pe.g2t1&&Pe.g1t1&&Pe.g3t1;!B&&!he?un("You must complete all three practice tasks first!"):Di()},isAdmin:B})]});const W=Pn[1],K=1;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[d.jsx("button",{onClick:()=>fr(null),style:{marginBottom:"20px",padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:" Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),W==="1"&&d.jsx(Pd,{taskNum:K,onComplete:yn,currentTaskId:Pn,isPractice:!0}),W==="2"&&d.jsx(bd,{taskNum:K,onComplete:yn,currentTaskId:Pn,isPractice:!0}),W==="3"&&d.jsx(Dd,{taskNum:K,onComplete:yn,currentTaskId:Pn,isPractice:!0})]})})}if(n==="complete"){const q=Math.floor(M/60),B=M%60,W=Math.round(yr()),K=Ie.bonus||0,he=W+K,qe={semester:ne,totalTime:M,completedLevels:y,categoryPoints:Ie,switches:w,gameMode:s,randomSeed:Kt,studentLearningScore:W,finalScore:he},De=async()=>{const ht=[...Re,qe];Et(ht),localStorage.setItem("engagementInterest","0"),Zt({materials:0,research:0,engagement:0,bonus:0}),Es({}),A&&!A.startsWith("offline-")&&await Yn(bt(tt,"sessions",A),{[`semesterHistory.semester${ne}`]:qe,currentSemester:ne+1,lastActivity:En()}),Ce(ne+1),Fl.resetForNewSemester(),r("semesterBreak"),g({}),E(0),k(0),T(0),v(0),Se(0),h("g2t1"),Jt(!1);const Bt=Math.floor(Math.random()*1e6);Yt(Bt),tr.initializeSeed(Bt)},Ke=ne>=ze;return d.jsxs("div",{className:"app",children:[d.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[d.jsx("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"8px",border:"2px solid #2196F3"},children:d.jsxs("h2",{style:{color:"#2196F3",margin:0},children:["Semester ",ne," of ",ze," Complete!"]})}),Ke&&d.jsx(wI,{sessionId:A,completedLevels:y,totalTime:M,gameMode:s}),d.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginTop:"20px"},children:[d.jsxs("h2",{style:{color:"#333",marginBottom:"20px"},children:[" Semester ",ne," Performance"]}),d.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2196F3",marginBottom:"30px"},children:["Final Score: ",he," points"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{margin:"0 0 15px 0",color:"#1976d2"},children:["Student Learning Score: ",W]}),d.jsxs("div",{style:{fontSize:"16px",color:"#666"},children:["= ",Ie.materials||0," (Materials) "," ",(1+(Ie.research||0)*.15).toFixed(2)," ","(Research)",parseFloat(localStorage.getItem("engagementInterest")||"0")>0&&` + ${parseFloat(localStorage.getItem("engagementInterest")||"0").toFixed(2)} (Interest)`]}),K>0&&d.jsxs("div",{style:{marginTop:"10px",fontSize:"16px",color:"#1976d2"},children:["+ ",K," Checkpoint Bonus"]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Total Time"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[q,"m ",B,"s"]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Student Learning"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:W})]})]}),(ne===2||K>0)&&d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Checkpoint Bonus"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:["+",K]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Tasks Completed"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:y})]})]}),d.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:"Teaching Performance by Category"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f0f8f0",padding:"15px",borderRadius:"6px",border:"2px solid #4CAF5020"},children:[d.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",marginBottom:"5px"},children:" Materials"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ie.materials||0}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Base points"})]}),d.jsxs("div",{style:{background:"#f8f0ff",padding:"15px",borderRadius:"6px",border:"2px solid #9C27B020"},children:[d.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold",marginBottom:"5px"},children:" Research"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ie.research||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(Ie.research||0)*15,"% to future materials"]})]}),d.jsxs("div",{style:{background:"#fff0f0",padding:"15px",borderRadius:"6px",border:"2px solid #f4433620"},children:[d.jsx("div",{style:{color:"#f44336",fontWeight:"bold",marginBottom:"5px"},children:" Engagement"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ie.engagement||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",((Ie.engagement||0)*.15).toFixed(1),"% interest/task"]})]})]})]}),ne===2&&Ie.bonus>0&&d.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[d.jsxs("strong",{style:{color:"#856404"},children:[" Exam Season Bonus:"," "]}),d.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#856404"},children:["+",Ie.bonus," points"]})]}),Re.length>0&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"15px"},children:"Progress Over Semesters"}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px"},children:[...Re,qe].map((ht,Bt)=>d.jsxs("div",{style:{padding:"10px",background:Bt===Re.length?"#e3f2fd":"white",borderRadius:"6px",border:"1px solid #e0e0e0",textAlign:"center"},children:[d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Semester ",Bt+1]}),d.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:ht.finalScore})]},Bt))})]}),d.jsx("div",{style:{marginTop:"30px",textAlign:"center"},children:Ke?d.jsxs("div",{style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h3",{style:{color:"#856404",marginBottom:"10px"},children:" All semesters complete!"}),d.jsx("p",{style:{color:"#856404",marginBottom:"0"},children:"Return to the Qualtrics survey and enter your completion code to finish the study."})]}):d.jsxs("button",{onClick:De,style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",ne+1," "]})})]})}if(n==="allocation")return d.jsx(TI,{onStart:da,totalTasks:Be.totalTasks,orderStrategy:Be.taskOrderStrategy,durationMinutes:Be.semesterDuration,difficultyMode:Be.difficultyMode});if(n==="bonus_round")return d.jsx(CI,{timeRemaining:Je,onSelectTask:q=>{const B=[...Ft,q];zn(B);const W=Object.keys(p).filter(he=>he.startsWith(q)).length,K=`${q}t${W+1}`;r("challenge"),Ps(K,!0)},onFinishEarly:()=>bn("finished_early")});const ha=q=>{Be.jarRefillFreezeTime>0?(de(!0),C(`Refilling ${q==="g1"?"Research":q==="g2"?"Materials":"Engagement"} Jar...`),setTimeout(()=>{de(!1),C(""),Ni(q,3)},Be.jarRefillFreezeTime*1e3)):Ni(q,3)},Ni=(q,B)=>{const W=[];for(let K=0;K<B;K++){const he=Math.floor(Math.random()*20)+1;W.push(`${q}t${he}`)}zn(K=>[...K,...W])};if(n==="challenge"||n==="bonus_round")return d.jsxs("div",{className:"app",children:[fe&&d.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"24px",flexDirection:"column",gap:"20px"},children:[d.jsx("div",{style:{fontSize:"48px"},children:""}),d.jsx("div",{children:S}),d.jsx("div",{style:{fontSize:"16px",opacity:.8},children:"Please wait..."})]}),d.jsx(II,{currentTaskIndex:Bn,totalTasks:Ft.length,taskQueue:Ft,onSwitchTask:wu,onRefill:ha,allocationCounts:aa,points:Math.round(Xr),timeRemaining:Je,onTimeUp:()=>bn("time_up"),chatInterface:d.jsx(vI,{messages:la,onSendMessage:Wn,isAiTyping:ua,isOpen:$n,onToggle:()=>_u(!$n),unreadCount:xu,aiDelay:Be.aiDelay}),children:Su()})]})}i0(document.getElementById("root")).render(d.jsx(D.StrictMode,{children:d.jsx(kI,{})}));
//# sourceMappingURL=index-C1l84Sk0.js.map
