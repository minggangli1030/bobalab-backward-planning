(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var om={exports:{}},du={},am={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ya=Symbol.for("react.element"),sx=Symbol.for("react.portal"),ix=Symbol.for("react.fragment"),ox=Symbol.for("react.strict_mode"),ax=Symbol.for("react.profiler"),lx=Symbol.for("react.provider"),ux=Symbol.for("react.context"),cx=Symbol.for("react.forward_ref"),dx=Symbol.for("react.suspense"),hx=Symbol.for("react.memo"),fx=Symbol.for("react.lazy"),Yf=Symbol.iterator;function px(t){return t===null||typeof t!="object"?null:(t=Yf&&t[Yf]||t["@@iterator"],typeof t=="function"?t:null)}var lm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},um=Object.assign,cm={};function Ki(t,e,n){this.props=t,this.context=e,this.refs=cm,this.updater=n||lm}Ki.prototype.isReactComponent={};Ki.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ki.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function dm(){}dm.prototype=Ki.prototype;function th(t,e,n){this.props=t,this.context=e,this.refs=cm,this.updater=n||lm}var nh=th.prototype=new dm;nh.constructor=th;um(nh,Ki.prototype);nh.isPureReactComponent=!0;var Xf=Array.isArray,hm=Object.prototype.hasOwnProperty,rh={current:null},fm={key:!0,ref:!0,__self:!0,__source:!0};function pm(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)hm.call(e,r)&&!fm.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),h=0;h<l;h++)c[h]=arguments[h+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ya,type:t,key:i,ref:a,props:s,_owner:rh.current}}function gx(t,e){return{$$typeof:ya,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function sh(t){return typeof t=="object"&&t!==null&&t.$$typeof===ya}function mx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Jf=/\/+/g;function Ju(t,e){return typeof t=="object"&&t!==null&&t.key!=null?mx(""+t.key):e.toString(36)}function hl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case ya:case sx:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+Ju(a,0):r,Xf(s)?(n="",t!=null&&(n=t.replace(Jf,"$&/")+"/"),hl(s,e,n,"",function(h){return h})):s!=null&&(sh(s)&&(s=gx(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Jf,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",Xf(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Ju(i,l);a+=hl(i,e,n,c,s)}else if(c=px(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Ju(i,l++),a+=hl(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Ha(t,e,n){if(t==null)return t;var r=[],s=0;return hl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function yx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Xt={current:null},fl={transition:null},vx={ReactCurrentDispatcher:Xt,ReactCurrentBatchConfig:fl,ReactCurrentOwner:rh};function gm(){throw Error("act(...) is not supported in production builds of React.")}Ie.Children={map:Ha,forEach:function(t,e,n){Ha(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ha(t,function(){e++}),e},toArray:function(t){return Ha(t,function(e){return e})||[]},only:function(t){if(!sh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ie.Component=Ki;Ie.Fragment=ix;Ie.Profiler=ax;Ie.PureComponent=th;Ie.StrictMode=ox;Ie.Suspense=dx;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vx;Ie.act=gm;Ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=um({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=rh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)hm.call(e,c)&&!fm.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var h=0;h<c;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:ya,type:t.type,key:s,ref:i,props:r,_owner:a}};Ie.createContext=function(t){return t={$$typeof:ux,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:lx,_context:t},t.Consumer=t};Ie.createElement=pm;Ie.createFactory=function(t){var e=pm.bind(null,t);return e.type=t,e};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(t){return{$$typeof:cx,render:t}};Ie.isValidElement=sh;Ie.lazy=function(t){return{$$typeof:fx,_payload:{_status:-1,_result:t},_init:yx}};Ie.memo=function(t,e){return{$$typeof:hx,type:t,compare:e===void 0?null:e}};Ie.startTransition=function(t){var e=fl.transition;fl.transition={};try{t()}finally{fl.transition=e}};Ie.unstable_act=gm;Ie.useCallback=function(t,e){return Xt.current.useCallback(t,e)};Ie.useContext=function(t){return Xt.current.useContext(t)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(t){return Xt.current.useDeferredValue(t)};Ie.useEffect=function(t,e){return Xt.current.useEffect(t,e)};Ie.useId=function(){return Xt.current.useId()};Ie.useImperativeHandle=function(t,e,n){return Xt.current.useImperativeHandle(t,e,n)};Ie.useInsertionEffect=function(t,e){return Xt.current.useInsertionEffect(t,e)};Ie.useLayoutEffect=function(t,e){return Xt.current.useLayoutEffect(t,e)};Ie.useMemo=function(t,e){return Xt.current.useMemo(t,e)};Ie.useReducer=function(t,e,n){return Xt.current.useReducer(t,e,n)};Ie.useRef=function(t){return Xt.current.useRef(t)};Ie.useState=function(t){return Xt.current.useState(t)};Ie.useSyncExternalStore=function(t,e,n){return Xt.current.useSyncExternalStore(t,e,n)};Ie.useTransition=function(){return Xt.current.useTransition()};Ie.version="18.3.1";am.exports=Ie;var N=am.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xx=N,_x=Symbol.for("react.element"),wx=Symbol.for("react.fragment"),Sx=Object.prototype.hasOwnProperty,Tx=xx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ex={key:!0,ref:!0,__self:!0,__source:!0};function mm(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)Sx.call(e,r)&&!Ex.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:_x,type:t,key:i,ref:a,props:s,_owner:Tx.current}}du.Fragment=wx;du.jsx=mm;du.jsxs=mm;om.exports=du;var u=om.exports,ym={exports:{}},yn={},vm={exports:{}},xm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,W){var P=D.length;D.push(W);e:for(;0<P;){var M=P-1>>>1,U=D[M];if(0<s(U,W))D[M]=W,D[P]=U,P=M;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var W=D[0],P=D.pop();if(P!==W){D[0]=P;e:for(var M=0,U=D.length,$=U>>>1;M<$;){var Y=2*(M+1)-1,te=D[Y],q=Y+1,re=D[q];if(0>s(te,P))q<U&&0>s(re,te)?(D[M]=re,D[q]=P,M=q):(D[M]=te,D[Y]=P,M=Y);else if(q<U&&0>s(re,P))D[M]=re,D[q]=P,M=q;else break e}}return W}function s(D,W){var P=D.sortIndex-W.sortIndex;return P!==0?P:D.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],h=[],p=1,y=null,m=3,S=!1,k=!1,b=!1,L=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(D){for(var W=n(h);W!==null;){if(W.callback===null)r(h);else if(W.startTime<=D)r(h),W.sortIndex=W.expirationTime,e(c,W);else break;W=n(h)}}function V(D){if(b=!1,I(D),!k)if(n(c)!==null)k=!0,Ee(B);else{var W=n(h);W!==null&&ee(V,W.startTime-D)}}function B(D,W){k=!1,b&&(b=!1,A(g),g=-1),S=!0;var P=m;try{for(I(W),y=n(c);y!==null&&(!(y.expirationTime>W)||D&&!C());){var M=y.callback;if(typeof M=="function"){y.callback=null,m=y.priorityLevel;var U=M(y.expirationTime<=W);W=t.unstable_now(),typeof U=="function"?y.callback=U:y===n(c)&&r(c),I(W)}else r(c);y=n(c)}if(y!==null)var $=!0;else{var Y=n(h);Y!==null&&ee(V,Y.startTime-W),$=!1}return $}finally{y=null,m=P,S=!1}}var F=!1,w=null,g=-1,_=5,x=-1;function C(){return!(t.unstable_now()-x<_)}function R(){if(w!==null){var D=t.unstable_now();x=D;var W=!0;try{W=w(!0,D)}finally{W?E():(F=!1,w=null)}}else F=!1}var E;if(typeof T=="function")E=function(){T(R)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,pe=oe.port2;oe.port1.onmessage=R,E=function(){pe.postMessage(null)}}else E=function(){L(R,0)};function Ee(D){w=D,F||(F=!0,E())}function ee(D,W){g=L(function(){D(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){k||S||(k=!0,Ee(B))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(D){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var P=m;m=W;try{return D()}finally{m=P}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,W){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var P=m;m=D;try{return W()}finally{m=P}},t.unstable_scheduleCallback=function(D,W,P){var M=t.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?M+P:M):P=M,D){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=P+U,D={id:p++,callback:W,priorityLevel:D,startTime:P,expirationTime:U,sortIndex:-1},P>M?(D.sortIndex=P,e(h,D),n(c)===null&&D===n(h)&&(b?(A(g),g=-1):b=!0,ee(V,P-M))):(D.sortIndex=U,e(c,D),k||S||(k=!0,Ee(B))),D},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(D){var W=m;return function(){var P=m;m=W;try{return D.apply(this,arguments)}finally{m=P}}}})(xm);vm.exports=xm;var Ix=vm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cx=N,mn=Ix;function J(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _m=new Set,Wo={};function Us(t,e){Mi(t,e),Mi(t+"Capture",e)}function Mi(t,e){for(Wo[t]=e,t=0;t<e.length;t++)_m.add(e[t])}var mr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vc=Object.prototype.hasOwnProperty,kx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zf={},ep={};function Ax(t){return Vc.call(ep,t)?!0:Vc.call(Zf,t)?!1:kx.test(t)?ep[t]=!0:(Zf[t]=!0,!1)}function Rx(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function bx(t,e,n,r){if(e===null||typeof e>"u"||Rx(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Jt(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Nt[t]=new Jt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Nt[e]=new Jt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Nt[t]=new Jt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Nt[t]=new Jt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Nt[t]=new Jt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Nt[t]=new Jt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Nt[t]=new Jt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Nt[t]=new Jt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Nt[t]=new Jt(t,5,!1,t.toLowerCase(),null,!1,!1)});var ih=/[\-:]([a-z])/g;function oh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ih,oh);Nt[e]=new Jt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ih,oh);Nt[e]=new Jt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ih,oh);Nt[e]=new Jt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Nt[t]=new Jt(t,1,!1,t.toLowerCase(),null,!1,!1)});Nt.xlinkHref=new Jt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Nt[t]=new Jt(t,1,!1,t.toLowerCase(),null,!0,!0)});function ah(t,e,n,r){var s=Nt.hasOwnProperty(e)?Nt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bx(e,n,s,r)&&(n=null),r||s===null?Ax(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Er=Cx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qa=Symbol.for("react.element"),mi=Symbol.for("react.portal"),yi=Symbol.for("react.fragment"),lh=Symbol.for("react.strict_mode"),Lc=Symbol.for("react.profiler"),wm=Symbol.for("react.provider"),Sm=Symbol.for("react.context"),uh=Symbol.for("react.forward_ref"),Fc=Symbol.for("react.suspense"),Oc=Symbol.for("react.suspense_list"),ch=Symbol.for("react.memo"),Lr=Symbol.for("react.lazy"),Tm=Symbol.for("react.offscreen"),tp=Symbol.iterator;function fo(t){return t===null||typeof t!="object"?null:(t=tp&&t[tp]||t["@@iterator"],typeof t=="function"?t:null)}var nt=Object.assign,Zu;function So(t){if(Zu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Zu=e&&e[1]||""}return`
`+Zu+t}var ec=!1;function tc(t,e){if(!t||ec)return"";ec=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{ec=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?So(t):""}function Px(t){switch(t.tag){case 5:return So(t.type);case 16:return So("Lazy");case 13:return So("Suspense");case 19:return So("SuspenseList");case 0:case 2:case 15:return t=tc(t.type,!1),t;case 11:return t=tc(t.type.render,!1),t;case 1:return t=tc(t.type,!0),t;default:return""}}function zc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case yi:return"Fragment";case mi:return"Portal";case Lc:return"Profiler";case lh:return"StrictMode";case Fc:return"Suspense";case Oc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Sm:return(t.displayName||"Context")+".Consumer";case wm:return(t._context.displayName||"Context")+".Provider";case uh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ch:return e=t.displayName||null,e!==null?e:zc(t.type)||"Memo";case Lr:e=t._payload,t=t._init;try{return zc(t(e))}catch{}}return null}function Dx(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zc(e);case 8:return e===lh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function rs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Em(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function jx(t){var e=Em(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ga(t){t._valueTracker||(t._valueTracker=jx(t))}function Im(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Em(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Rl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Bc(t,e){var n=e.checked;return nt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function np(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=rs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Cm(t,e){e=e.checked,e!=null&&ah(t,"checked",e,!1)}function Uc(t,e){Cm(t,e);var n=rs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?$c(t,e.type,n):e.hasOwnProperty("defaultValue")&&$c(t,e.type,rs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function rp(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function $c(t,e,n){(e!=="number"||Rl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var To=Array.isArray;function Ai(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+rs(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Wc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(J(91));return nt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function sp(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(J(92));if(To(n)){if(1<n.length)throw Error(J(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:rs(n)}}function km(t,e){var n=rs(e.value),r=rs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function ip(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Am(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Am(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Qa,Rm=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Qa=Qa||document.createElement("div"),Qa.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Qa.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ho(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Po={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nx=["Webkit","ms","Moz","O"];Object.keys(Po).forEach(function(t){Nx.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Po[e]=Po[t]})});function bm(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Po.hasOwnProperty(t)&&Po[t]?(""+e).trim():e+"px"}function Pm(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=bm(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Mx=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qc(t,e){if(e){if(Mx[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(J(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(J(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(J(61))}if(e.style!=null&&typeof e.style!="object")throw Error(J(62))}}function Gc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qc=null;function dh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Kc=null,Ri=null,bi=null;function op(t){if(t=_a(t)){if(typeof Kc!="function")throw Error(J(280));var e=t.stateNode;e&&(e=mu(e),Kc(t.stateNode,t.type,e))}}function Dm(t){Ri?bi?bi.push(t):bi=[t]:Ri=t}function jm(){if(Ri){var t=Ri,e=bi;if(bi=Ri=null,op(t),e)for(t=0;t<e.length;t++)op(e[t])}}function Nm(t,e){return t(e)}function Mm(){}var nc=!1;function Vm(t,e,n){if(nc)return t(e,n);nc=!0;try{return Nm(t,e,n)}finally{nc=!1,(Ri!==null||bi!==null)&&(Mm(),jm())}}function qo(t,e){var n=t.stateNode;if(n===null)return null;var r=mu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(J(231,e,typeof n));return n}var Yc=!1;if(mr)try{var po={};Object.defineProperty(po,"passive",{get:function(){Yc=!0}}),window.addEventListener("test",po,po),window.removeEventListener("test",po,po)}catch{Yc=!1}function Vx(t,e,n,r,s,i,a,l,c){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var Do=!1,bl=null,Pl=!1,Xc=null,Lx={onError:function(t){Do=!0,bl=t}};function Fx(t,e,n,r,s,i,a,l,c){Do=!1,bl=null,Vx.apply(Lx,arguments)}function Ox(t,e,n,r,s,i,a,l,c){if(Fx.apply(this,arguments),Do){if(Do){var h=bl;Do=!1,bl=null}else throw Error(J(198));Pl||(Pl=!0,Xc=h)}}function $s(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Lm(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ap(t){if($s(t)!==t)throw Error(J(188))}function zx(t){var e=t.alternate;if(!e){if(e=$s(t),e===null)throw Error(J(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return ap(s),t;if(i===r)return ap(s),e;i=i.sibling}throw Error(J(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(J(189))}}if(n.alternate!==r)throw Error(J(190))}if(n.tag!==3)throw Error(J(188));return n.stateNode.current===n?t:e}function Fm(t){return t=zx(t),t!==null?Om(t):null}function Om(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Om(t);if(e!==null)return e;t=t.sibling}return null}var zm=mn.unstable_scheduleCallback,lp=mn.unstable_cancelCallback,Bx=mn.unstable_shouldYield,Ux=mn.unstable_requestPaint,ut=mn.unstable_now,$x=mn.unstable_getCurrentPriorityLevel,hh=mn.unstable_ImmediatePriority,Bm=mn.unstable_UserBlockingPriority,Dl=mn.unstable_NormalPriority,Wx=mn.unstable_LowPriority,Um=mn.unstable_IdlePriority,hu=null,Xn=null;function Hx(t){if(Xn&&typeof Xn.onCommitFiberRoot=="function")try{Xn.onCommitFiberRoot(hu,t,void 0,(t.current.flags&128)===128)}catch{}}var Fn=Math.clz32?Math.clz32:Qx,qx=Math.log,Gx=Math.LN2;function Qx(t){return t>>>=0,t===0?32:31-(qx(t)/Gx|0)|0}var Ka=64,Ya=4194304;function Eo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function jl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Eo(l):(i&=a,i!==0&&(r=Eo(i)))}else a=n&~s,a!==0?r=Eo(a):i!==0&&(r=Eo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Fn(e),s=1<<n,r|=t[n],e&=~s;return r}function Kx(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yx(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Fn(i),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=Kx(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Jc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function $m(){var t=Ka;return Ka<<=1,!(Ka&4194240)&&(Ka=64),t}function rc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function va(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Fn(e),t[e]=n}function Xx(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Fn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function fh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Fn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ze=0;function Wm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Hm,ph,qm,Gm,Qm,Zc=!1,Xa=[],Hr=null,qr=null,Gr=null,Go=new Map,Qo=new Map,Or=[],Jx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function up(t,e){switch(t){case"focusin":case"focusout":Hr=null;break;case"dragenter":case"dragleave":qr=null;break;case"mouseover":case"mouseout":Gr=null;break;case"pointerover":case"pointerout":Go.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qo.delete(e.pointerId)}}function go(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=_a(e),e!==null&&ph(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Zx(t,e,n,r,s){switch(e){case"focusin":return Hr=go(Hr,t,e,n,r,s),!0;case"dragenter":return qr=go(qr,t,e,n,r,s),!0;case"mouseover":return Gr=go(Gr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Go.set(i,go(Go.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Qo.set(i,go(Qo.get(i)||null,t,e,n,r,s)),!0}return!1}function Km(t){var e=ks(t.target);if(e!==null){var n=$s(e);if(n!==null){if(e=n.tag,e===13){if(e=Lm(n),e!==null){t.blockedOn=e,Qm(t.priority,function(){qm(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function pl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ed(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Qc=r,n.target.dispatchEvent(r),Qc=null}else return e=_a(n),e!==null&&ph(e),t.blockedOn=n,!1;e.shift()}return!0}function cp(t,e,n){pl(t)&&n.delete(e)}function e1(){Zc=!1,Hr!==null&&pl(Hr)&&(Hr=null),qr!==null&&pl(qr)&&(qr=null),Gr!==null&&pl(Gr)&&(Gr=null),Go.forEach(cp),Qo.forEach(cp)}function mo(t,e){t.blockedOn===e&&(t.blockedOn=null,Zc||(Zc=!0,mn.unstable_scheduleCallback(mn.unstable_NormalPriority,e1)))}function Ko(t){function e(s){return mo(s,t)}if(0<Xa.length){mo(Xa[0],t);for(var n=1;n<Xa.length;n++){var r=Xa[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Hr!==null&&mo(Hr,t),qr!==null&&mo(qr,t),Gr!==null&&mo(Gr,t),Go.forEach(e),Qo.forEach(e),n=0;n<Or.length;n++)r=Or[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Or.length&&(n=Or[0],n.blockedOn===null);)Km(n),n.blockedOn===null&&Or.shift()}var Pi=Er.ReactCurrentBatchConfig,Nl=!0;function t1(t,e,n,r){var s=ze,i=Pi.transition;Pi.transition=null;try{ze=1,gh(t,e,n,r)}finally{ze=s,Pi.transition=i}}function n1(t,e,n,r){var s=ze,i=Pi.transition;Pi.transition=null;try{ze=4,gh(t,e,n,r)}finally{ze=s,Pi.transition=i}}function gh(t,e,n,r){if(Nl){var s=ed(t,e,n,r);if(s===null)fc(t,e,r,Ml,n),up(t,r);else if(Zx(s,t,e,n,r))r.stopPropagation();else if(up(t,r),e&4&&-1<Jx.indexOf(t)){for(;s!==null;){var i=_a(s);if(i!==null&&Hm(i),i=ed(t,e,n,r),i===null&&fc(t,e,r,Ml,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else fc(t,e,r,null,n)}}var Ml=null;function ed(t,e,n,r){if(Ml=null,t=dh(r),t=ks(t),t!==null)if(e=$s(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Lm(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ml=t,null}function Ym(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($x()){case hh:return 1;case Bm:return 4;case Dl:case Wx:return 16;case Um:return 536870912;default:return 16}default:return 16}}var Br=null,mh=null,gl=null;function Xm(){if(gl)return gl;var t,e=mh,n=e.length,r,s="value"in Br?Br.value:Br.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return gl=s.slice(t,1<r?1-r:void 0)}function ml(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ja(){return!0}function dp(){return!1}function vn(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ja:dp,this.isPropagationStopped=dp,this}return nt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ja)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ja)},persist:function(){},isPersistent:Ja}),e}var Yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yh=vn(Yi),xa=nt({},Yi,{view:0,detail:0}),r1=vn(xa),sc,ic,yo,fu=nt({},xa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==yo&&(yo&&t.type==="mousemove"?(sc=t.screenX-yo.screenX,ic=t.screenY-yo.screenY):ic=sc=0,yo=t),sc)},movementY:function(t){return"movementY"in t?t.movementY:ic}}),hp=vn(fu),s1=nt({},fu,{dataTransfer:0}),i1=vn(s1),o1=nt({},xa,{relatedTarget:0}),oc=vn(o1),a1=nt({},Yi,{animationName:0,elapsedTime:0,pseudoElement:0}),l1=vn(a1),u1=nt({},Yi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),c1=vn(u1),d1=nt({},Yi,{data:0}),fp=vn(d1),h1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},f1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},p1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function g1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=p1[t])?!!e[t]:!1}function vh(){return g1}var m1=nt({},xa,{key:function(t){if(t.key){var e=h1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ml(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?f1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vh,charCode:function(t){return t.type==="keypress"?ml(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ml(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),y1=vn(m1),v1=nt({},fu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pp=vn(v1),x1=nt({},xa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vh}),_1=vn(x1),w1=nt({},Yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),S1=vn(w1),T1=nt({},fu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),E1=vn(T1),I1=[9,13,27,32],xh=mr&&"CompositionEvent"in window,jo=null;mr&&"documentMode"in document&&(jo=document.documentMode);var C1=mr&&"TextEvent"in window&&!jo,Jm=mr&&(!xh||jo&&8<jo&&11>=jo),gp=" ",mp=!1;function Zm(t,e){switch(t){case"keyup":return I1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ey(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var vi=!1;function k1(t,e){switch(t){case"compositionend":return ey(e);case"keypress":return e.which!==32?null:(mp=!0,gp);case"textInput":return t=e.data,t===gp&&mp?null:t;default:return null}}function A1(t,e){if(vi)return t==="compositionend"||!xh&&Zm(t,e)?(t=Xm(),gl=mh=Br=null,vi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Jm&&e.locale!=="ko"?null:e.data;default:return null}}var R1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!R1[t.type]:e==="textarea"}function ty(t,e,n,r){Dm(r),e=Vl(e,"onChange"),0<e.length&&(n=new yh("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var No=null,Yo=null;function b1(t){hy(t,0)}function pu(t){var e=wi(t);if(Im(e))return t}function P1(t,e){if(t==="change")return e}var ny=!1;if(mr){var ac;if(mr){var lc="oninput"in document;if(!lc){var vp=document.createElement("div");vp.setAttribute("oninput","return;"),lc=typeof vp.oninput=="function"}ac=lc}else ac=!1;ny=ac&&(!document.documentMode||9<document.documentMode)}function xp(){No&&(No.detachEvent("onpropertychange",ry),Yo=No=null)}function ry(t){if(t.propertyName==="value"&&pu(Yo)){var e=[];ty(e,Yo,t,dh(t)),Vm(b1,e)}}function D1(t,e,n){t==="focusin"?(xp(),No=e,Yo=n,No.attachEvent("onpropertychange",ry)):t==="focusout"&&xp()}function j1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return pu(Yo)}function N1(t,e){if(t==="click")return pu(e)}function M1(t,e){if(t==="input"||t==="change")return pu(e)}function V1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Bn=typeof Object.is=="function"?Object.is:V1;function Xo(t,e){if(Bn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Vc.call(e,s)||!Bn(t[s],e[s]))return!1}return!0}function _p(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function wp(t,e){var n=_p(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_p(n)}}function sy(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?sy(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function iy(){for(var t=window,e=Rl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Rl(t.document)}return e}function _h(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function L1(t){var e=iy(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&sy(n.ownerDocument.documentElement,n)){if(r!==null&&_h(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=wp(n,i);var a=wp(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var F1=mr&&"documentMode"in document&&11>=document.documentMode,xi=null,td=null,Mo=null,nd=!1;function Sp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nd||xi==null||xi!==Rl(r)||(r=xi,"selectionStart"in r&&_h(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Mo&&Xo(Mo,r)||(Mo=r,r=Vl(td,"onSelect"),0<r.length&&(e=new yh("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=xi)))}function Za(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var _i={animationend:Za("Animation","AnimationEnd"),animationiteration:Za("Animation","AnimationIteration"),animationstart:Za("Animation","AnimationStart"),transitionend:Za("Transition","TransitionEnd")},uc={},oy={};mr&&(oy=document.createElement("div").style,"AnimationEvent"in window||(delete _i.animationend.animation,delete _i.animationiteration.animation,delete _i.animationstart.animation),"TransitionEvent"in window||delete _i.transitionend.transition);function gu(t){if(uc[t])return uc[t];if(!_i[t])return t;var e=_i[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in oy)return uc[t]=e[n];return t}var ay=gu("animationend"),ly=gu("animationiteration"),uy=gu("animationstart"),cy=gu("transitionend"),dy=new Map,Tp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ls(t,e){dy.set(t,e),Us(e,[t])}for(var cc=0;cc<Tp.length;cc++){var dc=Tp[cc],O1=dc.toLowerCase(),z1=dc[0].toUpperCase()+dc.slice(1);ls(O1,"on"+z1)}ls(ay,"onAnimationEnd");ls(ly,"onAnimationIteration");ls(uy,"onAnimationStart");ls("dblclick","onDoubleClick");ls("focusin","onFocus");ls("focusout","onBlur");ls(cy,"onTransitionEnd");Mi("onMouseEnter",["mouseout","mouseover"]);Mi("onMouseLeave",["mouseout","mouseover"]);Mi("onPointerEnter",["pointerout","pointerover"]);Mi("onPointerLeave",["pointerout","pointerover"]);Us("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Us("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Us("onBeforeInput",["compositionend","keypress","textInput","paste"]);Us("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Us("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Us("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Io="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Io));function Ep(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Ox(r,e,void 0,t),t.currentTarget=null}function hy(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,h=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;Ep(s,l,h),i=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,h=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;Ep(s,l,h),i=c}}}if(Pl)throw t=Xc,Pl=!1,Xc=null,t}function Ge(t,e){var n=e[ad];n===void 0&&(n=e[ad]=new Set);var r=t+"__bubble";n.has(r)||(fy(e,t,2,!1),n.add(r))}function hc(t,e,n){var r=0;e&&(r|=4),fy(n,t,r,e)}var el="_reactListening"+Math.random().toString(36).slice(2);function Jo(t){if(!t[el]){t[el]=!0,_m.forEach(function(n){n!=="selectionchange"&&(B1.has(n)||hc(n,!1,t),hc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[el]||(e[el]=!0,hc("selectionchange",!1,e))}}function fy(t,e,n,r){switch(Ym(e)){case 1:var s=t1;break;case 4:s=n1;break;default:s=gh}n=s.bind(null,e,n,t),s=void 0,!Yc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function fc(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=ks(l),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}l=l.parentNode}}r=r.return}Vm(function(){var h=i,p=dh(n),y=[];e:{var m=dy.get(t);if(m!==void 0){var S=yh,k=t;switch(t){case"keypress":if(ml(n)===0)break e;case"keydown":case"keyup":S=y1;break;case"focusin":k="focus",S=oc;break;case"focusout":k="blur",S=oc;break;case"beforeblur":case"afterblur":S=oc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=hp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=i1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=_1;break;case ay:case ly:case uy:S=l1;break;case cy:S=S1;break;case"scroll":S=r1;break;case"wheel":S=E1;break;case"copy":case"cut":case"paste":S=c1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=pp}var b=(e&4)!==0,L=!b&&t==="scroll",A=b?m!==null?m+"Capture":null:m;b=[];for(var T=h,I;T!==null;){I=T;var V=I.stateNode;if(I.tag===5&&V!==null&&(I=V,A!==null&&(V=qo(T,A),V!=null&&b.push(Zo(T,V,I)))),L)break;T=T.return}0<b.length&&(m=new S(m,k,null,n,p),y.push({event:m,listeners:b}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",S=t==="mouseout"||t==="pointerout",m&&n!==Qc&&(k=n.relatedTarget||n.fromElement)&&(ks(k)||k[yr]))break e;if((S||m)&&(m=p.window===p?p:(m=p.ownerDocument)?m.defaultView||m.parentWindow:window,S?(k=n.relatedTarget||n.toElement,S=h,k=k?ks(k):null,k!==null&&(L=$s(k),k!==L||k.tag!==5&&k.tag!==6)&&(k=null)):(S=null,k=h),S!==k)){if(b=hp,V="onMouseLeave",A="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(b=pp,V="onPointerLeave",A="onPointerEnter",T="pointer"),L=S==null?m:wi(S),I=k==null?m:wi(k),m=new b(V,T+"leave",S,n,p),m.target=L,m.relatedTarget=I,V=null,ks(p)===h&&(b=new b(A,T+"enter",k,n,p),b.target=I,b.relatedTarget=L,V=b),L=V,S&&k)t:{for(b=S,A=k,T=0,I=b;I;I=di(I))T++;for(I=0,V=A;V;V=di(V))I++;for(;0<T-I;)b=di(b),T--;for(;0<I-T;)A=di(A),I--;for(;T--;){if(b===A||A!==null&&b===A.alternate)break t;b=di(b),A=di(A)}b=null}else b=null;S!==null&&Ip(y,m,S,b,!1),k!==null&&L!==null&&Ip(y,L,k,b,!0)}}e:{if(m=h?wi(h):window,S=m.nodeName&&m.nodeName.toLowerCase(),S==="select"||S==="input"&&m.type==="file")var B=P1;else if(yp(m))if(ny)B=M1;else{B=j1;var F=D1}else(S=m.nodeName)&&S.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(B=N1);if(B&&(B=B(t,h))){ty(y,B,n,p);break e}F&&F(t,m,h),t==="focusout"&&(F=m._wrapperState)&&F.controlled&&m.type==="number"&&$c(m,"number",m.value)}switch(F=h?wi(h):window,t){case"focusin":(yp(F)||F.contentEditable==="true")&&(xi=F,td=h,Mo=null);break;case"focusout":Mo=td=xi=null;break;case"mousedown":nd=!0;break;case"contextmenu":case"mouseup":case"dragend":nd=!1,Sp(y,n,p);break;case"selectionchange":if(F1)break;case"keydown":case"keyup":Sp(y,n,p)}var w;if(xh)e:{switch(t){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else vi?Zm(t,n)&&(g="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(g="onCompositionStart");g&&(Jm&&n.locale!=="ko"&&(vi||g!=="onCompositionStart"?g==="onCompositionEnd"&&vi&&(w=Xm()):(Br=p,mh="value"in Br?Br.value:Br.textContent,vi=!0)),F=Vl(h,g),0<F.length&&(g=new fp(g,t,null,n,p),y.push({event:g,listeners:F}),w?g.data=w:(w=ey(n),w!==null&&(g.data=w)))),(w=C1?k1(t,n):A1(t,n))&&(h=Vl(h,"onBeforeInput"),0<h.length&&(p=new fp("onBeforeInput","beforeinput",null,n,p),y.push({event:p,listeners:h}),p.data=w))}hy(y,e)})}function Zo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Vl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=qo(t,n),i!=null&&r.unshift(Zo(t,i,s)),i=qo(t,e),i!=null&&r.push(Zo(t,i,s))),t=t.return}return r}function di(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ip(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,h=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&h!==null&&(l=h,s?(c=qo(n,i),c!=null&&a.unshift(Zo(n,c,l))):s||(c=qo(n,i),c!=null&&a.push(Zo(n,c,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var U1=/\r\n?/g,$1=/\u0000|\uFFFD/g;function Cp(t){return(typeof t=="string"?t:""+t).replace(U1,`
`).replace($1,"")}function tl(t,e,n){if(e=Cp(e),Cp(t)!==e&&n)throw Error(J(425))}function Ll(){}var rd=null,sd=null;function id(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var od=typeof setTimeout=="function"?setTimeout:void 0,W1=typeof clearTimeout=="function"?clearTimeout:void 0,kp=typeof Promise=="function"?Promise:void 0,H1=typeof queueMicrotask=="function"?queueMicrotask:typeof kp<"u"?function(t){return kp.resolve(null).then(t).catch(q1)}:od;function q1(t){setTimeout(function(){throw t})}function pc(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ko(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ko(e)}function Qr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Ap(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Xi=Math.random().toString(36).slice(2),Yn="__reactFiber$"+Xi,ea="__reactProps$"+Xi,yr="__reactContainer$"+Xi,ad="__reactEvents$"+Xi,G1="__reactListeners$"+Xi,Q1="__reactHandles$"+Xi;function ks(t){var e=t[Yn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[yr]||n[Yn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Ap(t);t!==null;){if(n=t[Yn])return n;t=Ap(t)}return e}t=n,n=t.parentNode}return null}function _a(t){return t=t[Yn]||t[yr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function wi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(J(33))}function mu(t){return t[ea]||null}var ld=[],Si=-1;function us(t){return{current:t}}function Ke(t){0>Si||(t.current=ld[Si],ld[Si]=null,Si--)}function We(t,e){Si++,ld[Si]=t.current,t.current=e}var ss={},Ht=us(ss),sn=us(!1),Ns=ss;function Vi(t,e){var n=t.type.contextTypes;if(!n)return ss;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function on(t){return t=t.childContextTypes,t!=null}function Fl(){Ke(sn),Ke(Ht)}function Rp(t,e,n){if(Ht.current!==ss)throw Error(J(168));We(Ht,e),We(sn,n)}function py(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(J(108,Dx(t)||"Unknown",s));return nt({},n,r)}function Ol(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ss,Ns=Ht.current,We(Ht,t),We(sn,sn.current),!0}function bp(t,e,n){var r=t.stateNode;if(!r)throw Error(J(169));n?(t=py(t,e,Ns),r.__reactInternalMemoizedMergedChildContext=t,Ke(sn),Ke(Ht),We(Ht,t)):Ke(sn),We(sn,n)}var cr=null,yu=!1,gc=!1;function gy(t){cr===null?cr=[t]:cr.push(t)}function K1(t){yu=!0,gy(t)}function cs(){if(!gc&&cr!==null){gc=!0;var t=0,e=ze;try{var n=cr;for(ze=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}cr=null,yu=!1}catch(s){throw cr!==null&&(cr=cr.slice(t+1)),zm(hh,cs),s}finally{ze=e,gc=!1}}return null}var Ti=[],Ei=0,zl=null,Bl=0,_n=[],wn=0,Ms=null,hr=1,fr="";function Es(t,e){Ti[Ei++]=Bl,Ti[Ei++]=zl,zl=t,Bl=e}function my(t,e,n){_n[wn++]=hr,_n[wn++]=fr,_n[wn++]=Ms,Ms=t;var r=hr;t=fr;var s=32-Fn(r)-1;r&=~(1<<s),n+=1;var i=32-Fn(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,hr=1<<32-Fn(e)+s|n<<s|r,fr=i+t}else hr=1<<i|n<<s|r,fr=t}function wh(t){t.return!==null&&(Es(t,1),my(t,1,0))}function Sh(t){for(;t===zl;)zl=Ti[--Ei],Ti[Ei]=null,Bl=Ti[--Ei],Ti[Ei]=null;for(;t===Ms;)Ms=_n[--wn],_n[wn]=null,fr=_n[--wn],_n[wn]=null,hr=_n[--wn],_n[wn]=null}var gn=null,fn=null,Je=!1,Vn=null;function yy(t,e){var n=Sn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Pp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,gn=t,fn=Qr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,gn=t,fn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ms!==null?{id:hr,overflow:fr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Sn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,gn=t,fn=null,!0):!1;default:return!1}}function ud(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cd(t){if(Je){var e=fn;if(e){var n=e;if(!Pp(t,e)){if(ud(t))throw Error(J(418));e=Qr(n.nextSibling);var r=gn;e&&Pp(t,e)?yy(r,n):(t.flags=t.flags&-4097|2,Je=!1,gn=t)}}else{if(ud(t))throw Error(J(418));t.flags=t.flags&-4097|2,Je=!1,gn=t}}}function Dp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;gn=t}function nl(t){if(t!==gn)return!1;if(!Je)return Dp(t),Je=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!id(t.type,t.memoizedProps)),e&&(e=fn)){if(ud(t))throw vy(),Error(J(418));for(;e;)yy(t,e),e=Qr(e.nextSibling)}if(Dp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(J(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){fn=Qr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}fn=null}}else fn=gn?Qr(t.stateNode.nextSibling):null;return!0}function vy(){for(var t=fn;t;)t=Qr(t.nextSibling)}function Li(){fn=gn=null,Je=!1}function Th(t){Vn===null?Vn=[t]:Vn.push(t)}var Y1=Er.ReactCurrentBatchConfig;function vo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(J(309));var r=n.stateNode}if(!r)throw Error(J(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(J(284));if(!n._owner)throw Error(J(290,t))}return t}function rl(t,e){throw t=Object.prototype.toString.call(e),Error(J(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function jp(t){var e=t._init;return e(t._payload)}function xy(t){function e(A,T){if(t){var I=A.deletions;I===null?(A.deletions=[T],A.flags|=16):I.push(T)}}function n(A,T){if(!t)return null;for(;T!==null;)e(A,T),T=T.sibling;return null}function r(A,T){for(A=new Map;T!==null;)T.key!==null?A.set(T.key,T):A.set(T.index,T),T=T.sibling;return A}function s(A,T){return A=Jr(A,T),A.index=0,A.sibling=null,A}function i(A,T,I){return A.index=I,t?(I=A.alternate,I!==null?(I=I.index,I<T?(A.flags|=2,T):I):(A.flags|=2,T)):(A.flags|=1048576,T)}function a(A){return t&&A.alternate===null&&(A.flags|=2),A}function l(A,T,I,V){return T===null||T.tag!==6?(T=Sc(I,A.mode,V),T.return=A,T):(T=s(T,I),T.return=A,T)}function c(A,T,I,V){var B=I.type;return B===yi?p(A,T,I.props.children,V,I.key):T!==null&&(T.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Lr&&jp(B)===T.type)?(V=s(T,I.props),V.ref=vo(A,T,I),V.return=A,V):(V=Tl(I.type,I.key,I.props,null,A.mode,V),V.ref=vo(A,T,I),V.return=A,V)}function h(A,T,I,V){return T===null||T.tag!==4||T.stateNode.containerInfo!==I.containerInfo||T.stateNode.implementation!==I.implementation?(T=Tc(I,A.mode,V),T.return=A,T):(T=s(T,I.children||[]),T.return=A,T)}function p(A,T,I,V,B){return T===null||T.tag!==7?(T=Ds(I,A.mode,V,B),T.return=A,T):(T=s(T,I),T.return=A,T)}function y(A,T,I){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Sc(""+T,A.mode,I),T.return=A,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case qa:return I=Tl(T.type,T.key,T.props,null,A.mode,I),I.ref=vo(A,null,T),I.return=A,I;case mi:return T=Tc(T,A.mode,I),T.return=A,T;case Lr:var V=T._init;return y(A,V(T._payload),I)}if(To(T)||fo(T))return T=Ds(T,A.mode,I,null),T.return=A,T;rl(A,T)}return null}function m(A,T,I,V){var B=T!==null?T.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return B!==null?null:l(A,T,""+I,V);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case qa:return I.key===B?c(A,T,I,V):null;case mi:return I.key===B?h(A,T,I,V):null;case Lr:return B=I._init,m(A,T,B(I._payload),V)}if(To(I)||fo(I))return B!==null?null:p(A,T,I,V,null);rl(A,I)}return null}function S(A,T,I,V,B){if(typeof V=="string"&&V!==""||typeof V=="number")return A=A.get(I)||null,l(T,A,""+V,B);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case qa:return A=A.get(V.key===null?I:V.key)||null,c(T,A,V,B);case mi:return A=A.get(V.key===null?I:V.key)||null,h(T,A,V,B);case Lr:var F=V._init;return S(A,T,I,F(V._payload),B)}if(To(V)||fo(V))return A=A.get(I)||null,p(T,A,V,B,null);rl(T,V)}return null}function k(A,T,I,V){for(var B=null,F=null,w=T,g=T=0,_=null;w!==null&&g<I.length;g++){w.index>g?(_=w,w=null):_=w.sibling;var x=m(A,w,I[g],V);if(x===null){w===null&&(w=_);break}t&&w&&x.alternate===null&&e(A,w),T=i(x,T,g),F===null?B=x:F.sibling=x,F=x,w=_}if(g===I.length)return n(A,w),Je&&Es(A,g),B;if(w===null){for(;g<I.length;g++)w=y(A,I[g],V),w!==null&&(T=i(w,T,g),F===null?B=w:F.sibling=w,F=w);return Je&&Es(A,g),B}for(w=r(A,w);g<I.length;g++)_=S(w,A,g,I[g],V),_!==null&&(t&&_.alternate!==null&&w.delete(_.key===null?g:_.key),T=i(_,T,g),F===null?B=_:F.sibling=_,F=_);return t&&w.forEach(function(C){return e(A,C)}),Je&&Es(A,g),B}function b(A,T,I,V){var B=fo(I);if(typeof B!="function")throw Error(J(150));if(I=B.call(I),I==null)throw Error(J(151));for(var F=B=null,w=T,g=T=0,_=null,x=I.next();w!==null&&!x.done;g++,x=I.next()){w.index>g?(_=w,w=null):_=w.sibling;var C=m(A,w,x.value,V);if(C===null){w===null&&(w=_);break}t&&w&&C.alternate===null&&e(A,w),T=i(C,T,g),F===null?B=C:F.sibling=C,F=C,w=_}if(x.done)return n(A,w),Je&&Es(A,g),B;if(w===null){for(;!x.done;g++,x=I.next())x=y(A,x.value,V),x!==null&&(T=i(x,T,g),F===null?B=x:F.sibling=x,F=x);return Je&&Es(A,g),B}for(w=r(A,w);!x.done;g++,x=I.next())x=S(w,A,g,x.value,V),x!==null&&(t&&x.alternate!==null&&w.delete(x.key===null?g:x.key),T=i(x,T,g),F===null?B=x:F.sibling=x,F=x);return t&&w.forEach(function(R){return e(A,R)}),Je&&Es(A,g),B}function L(A,T,I,V){if(typeof I=="object"&&I!==null&&I.type===yi&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case qa:e:{for(var B=I.key,F=T;F!==null;){if(F.key===B){if(B=I.type,B===yi){if(F.tag===7){n(A,F.sibling),T=s(F,I.props.children),T.return=A,A=T;break e}}else if(F.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Lr&&jp(B)===F.type){n(A,F.sibling),T=s(F,I.props),T.ref=vo(A,F,I),T.return=A,A=T;break e}n(A,F);break}else e(A,F);F=F.sibling}I.type===yi?(T=Ds(I.props.children,A.mode,V,I.key),T.return=A,A=T):(V=Tl(I.type,I.key,I.props,null,A.mode,V),V.ref=vo(A,T,I),V.return=A,A=V)}return a(A);case mi:e:{for(F=I.key;T!==null;){if(T.key===F)if(T.tag===4&&T.stateNode.containerInfo===I.containerInfo&&T.stateNode.implementation===I.implementation){n(A,T.sibling),T=s(T,I.children||[]),T.return=A,A=T;break e}else{n(A,T);break}else e(A,T);T=T.sibling}T=Tc(I,A.mode,V),T.return=A,A=T}return a(A);case Lr:return F=I._init,L(A,T,F(I._payload),V)}if(To(I))return k(A,T,I,V);if(fo(I))return b(A,T,I,V);rl(A,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,T!==null&&T.tag===6?(n(A,T.sibling),T=s(T,I),T.return=A,A=T):(n(A,T),T=Sc(I,A.mode,V),T.return=A,A=T),a(A)):n(A,T)}return L}var Fi=xy(!0),_y=xy(!1),Ul=us(null),$l=null,Ii=null,Eh=null;function Ih(){Eh=Ii=$l=null}function Ch(t){var e=Ul.current;Ke(Ul),t._currentValue=e}function dd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Di(t,e){$l=t,Eh=Ii=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(rn=!0),t.firstContext=null)}function En(t){var e=t._currentValue;if(Eh!==t)if(t={context:t,memoizedValue:e,next:null},Ii===null){if($l===null)throw Error(J(308));Ii=t,$l.dependencies={lanes:0,firstContext:t}}else Ii=Ii.next=t;return e}var As=null;function kh(t){As===null?As=[t]:As.push(t)}function wy(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,kh(e)):(n.next=s.next,s.next=n),e.interleaved=n,vr(t,r)}function vr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fr=!1;function Ah(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Sy(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function pr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Kr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ne&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,vr(t,n)}return s=r.interleaved,s===null?(e.next=e,kh(r)):(e.next=s.next,s.next=e),r.interleaved=e,vr(t,n)}function yl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,fh(t,n)}}function Np(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Wl(t,e,n,r){var s=t.updateQueue;Fr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,h=c.next;c.next=null,a===null?i=h:a.next=h,a=c;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==a&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=c))}if(i!==null){var y=s.baseState;a=0,p=h=c=null,l=i;do{var m=l.lane,S=l.eventTime;if((r&m)===m){p!==null&&(p=p.next={eventTime:S,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var k=t,b=l;switch(m=e,S=n,b.tag){case 1:if(k=b.payload,typeof k=="function"){y=k.call(S,y,m);break e}y=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=b.payload,m=typeof k=="function"?k.call(S,y,m):k,m==null)break e;y=nt({},y,m);break e;case 2:Fr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else S={eventTime:S,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=S,c=y):p=p.next=S,a|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(p===null&&(c=y),s.baseState=c,s.firstBaseUpdate=h,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ls|=a,t.lanes=a,t.memoizedState=y}}function Mp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(J(191,s));s.call(r)}}}var wa={},Jn=us(wa),ta=us(wa),na=us(wa);function Rs(t){if(t===wa)throw Error(J(174));return t}function Rh(t,e){switch(We(na,e),We(ta,t),We(Jn,wa),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Hc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Hc(e,t)}Ke(Jn),We(Jn,e)}function Oi(){Ke(Jn),Ke(ta),Ke(na)}function Ty(t){Rs(na.current);var e=Rs(Jn.current),n=Hc(e,t.type);e!==n&&(We(ta,t),We(Jn,n))}function bh(t){ta.current===t&&(Ke(Jn),Ke(ta))}var et=us(0);function Hl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var mc=[];function Ph(){for(var t=0;t<mc.length;t++)mc[t]._workInProgressVersionPrimary=null;mc.length=0}var vl=Er.ReactCurrentDispatcher,yc=Er.ReactCurrentBatchConfig,Vs=0,tt=null,yt=null,wt=null,ql=!1,Vo=!1,ra=0,X1=0;function zt(){throw Error(J(321))}function Dh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Bn(t[n],e[n]))return!1;return!0}function jh(t,e,n,r,s,i){if(Vs=i,tt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,vl.current=t===null||t.memoizedState===null?t_:n_,t=n(r,s),Vo){i=0;do{if(Vo=!1,ra=0,25<=i)throw Error(J(301));i+=1,wt=yt=null,e.updateQueue=null,vl.current=r_,t=n(r,s)}while(Vo)}if(vl.current=Gl,e=yt!==null&&yt.next!==null,Vs=0,wt=yt=tt=null,ql=!1,e)throw Error(J(300));return t}function Nh(){var t=ra!==0;return ra=0,t}function Kn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?tt.memoizedState=wt=t:wt=wt.next=t,wt}function In(){if(yt===null){var t=tt.alternate;t=t!==null?t.memoizedState:null}else t=yt.next;var e=wt===null?tt.memoizedState:wt.next;if(e!==null)wt=e,yt=t;else{if(t===null)throw Error(J(310));yt=t,t={memoizedState:yt.memoizedState,baseState:yt.baseState,baseQueue:yt.baseQueue,queue:yt.queue,next:null},wt===null?tt.memoizedState=wt=t:wt=wt.next=t}return wt}function sa(t,e){return typeof e=="function"?e(t):e}function vc(t){var e=In(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var r=yt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,c=null,h=i;do{var p=h.lane;if((Vs&p)===p)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var y={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(l=c=y,a=r):c=c.next=y,tt.lanes|=p,Ls|=p}h=h.next}while(h!==null&&h!==i);c===null?a=r:c.next=l,Bn(r,e.memoizedState)||(rn=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,tt.lanes|=i,Ls|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function xc(t){var e=In(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Bn(i,e.memoizedState)||(rn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Ey(){}function Iy(t,e){var n=tt,r=In(),s=e(),i=!Bn(r.memoizedState,s);if(i&&(r.memoizedState=s,rn=!0),r=r.queue,Mh(Ay.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||wt!==null&&wt.memoizedState.tag&1){if(n.flags|=2048,ia(9,ky.bind(null,n,r,s,e),void 0,null),St===null)throw Error(J(349));Vs&30||Cy(n,e,s)}return s}function Cy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=tt.updateQueue,e===null?(e={lastEffect:null,stores:null},tt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function ky(t,e,n,r){e.value=n,e.getSnapshot=r,Ry(e)&&by(t)}function Ay(t,e,n){return n(function(){Ry(e)&&by(t)})}function Ry(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Bn(t,n)}catch{return!0}}function by(t){var e=vr(t,1);e!==null&&On(e,t,1,-1)}function Vp(t){var e=Kn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:t},e.queue=t,t=t.dispatch=e_.bind(null,tt,t),[e.memoizedState,t]}function ia(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=tt.updateQueue,e===null?(e={lastEffect:null,stores:null},tt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Py(){return In().memoizedState}function xl(t,e,n,r){var s=Kn();tt.flags|=t,s.memoizedState=ia(1|e,n,void 0,r===void 0?null:r)}function vu(t,e,n,r){var s=In();r=r===void 0?null:r;var i=void 0;if(yt!==null){var a=yt.memoizedState;if(i=a.destroy,r!==null&&Dh(r,a.deps)){s.memoizedState=ia(e,n,i,r);return}}tt.flags|=t,s.memoizedState=ia(1|e,n,i,r)}function Lp(t,e){return xl(8390656,8,t,e)}function Mh(t,e){return vu(2048,8,t,e)}function Dy(t,e){return vu(4,2,t,e)}function jy(t,e){return vu(4,4,t,e)}function Ny(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function My(t,e,n){return n=n!=null?n.concat([t]):null,vu(4,4,Ny.bind(null,e,t),n)}function Vh(){}function Vy(t,e){var n=In();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Dh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ly(t,e){var n=In();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Dh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Fy(t,e,n){return Vs&21?(Bn(n,e)||(n=$m(),tt.lanes|=n,Ls|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,rn=!0),t.memoizedState=n)}function J1(t,e){var n=ze;ze=n!==0&&4>n?n:4,t(!0);var r=yc.transition;yc.transition={};try{t(!1),e()}finally{ze=n,yc.transition=r}}function Oy(){return In().memoizedState}function Z1(t,e,n){var r=Xr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},zy(t))By(e,n);else if(n=wy(t,e,n,r),n!==null){var s=Kt();On(n,t,r,s),Uy(n,e,r)}}function e_(t,e,n){var r=Xr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(zy(t))By(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,Bn(l,a)){var c=e.interleaved;c===null?(s.next=s,kh(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=wy(t,e,s,r),n!==null&&(s=Kt(),On(n,t,r,s),Uy(n,e,r))}}function zy(t){var e=t.alternate;return t===tt||e!==null&&e===tt}function By(t,e){Vo=ql=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Uy(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,fh(t,n)}}var Gl={readContext:En,useCallback:zt,useContext:zt,useEffect:zt,useImperativeHandle:zt,useInsertionEffect:zt,useLayoutEffect:zt,useMemo:zt,useReducer:zt,useRef:zt,useState:zt,useDebugValue:zt,useDeferredValue:zt,useTransition:zt,useMutableSource:zt,useSyncExternalStore:zt,useId:zt,unstable_isNewReconciler:!1},t_={readContext:En,useCallback:function(t,e){return Kn().memoizedState=[t,e===void 0?null:e],t},useContext:En,useEffect:Lp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,xl(4194308,4,Ny.bind(null,e,t),n)},useLayoutEffect:function(t,e){return xl(4194308,4,t,e)},useInsertionEffect:function(t,e){return xl(4,2,t,e)},useMemo:function(t,e){var n=Kn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Kn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Z1.bind(null,tt,t),[r.memoizedState,t]},useRef:function(t){var e=Kn();return t={current:t},e.memoizedState=t},useState:Vp,useDebugValue:Vh,useDeferredValue:function(t){return Kn().memoizedState=t},useTransition:function(){var t=Vp(!1),e=t[0];return t=J1.bind(null,t[1]),Kn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=tt,s=Kn();if(Je){if(n===void 0)throw Error(J(407));n=n()}else{if(n=e(),St===null)throw Error(J(349));Vs&30||Cy(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Lp(Ay.bind(null,r,i,t),[t]),r.flags|=2048,ia(9,ky.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Kn(),e=St.identifierPrefix;if(Je){var n=fr,r=hr;n=(r&~(1<<32-Fn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ra++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=X1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},n_={readContext:En,useCallback:Vy,useContext:En,useEffect:Mh,useImperativeHandle:My,useInsertionEffect:Dy,useLayoutEffect:jy,useMemo:Ly,useReducer:vc,useRef:Py,useState:function(){return vc(sa)},useDebugValue:Vh,useDeferredValue:function(t){var e=In();return Fy(e,yt.memoizedState,t)},useTransition:function(){var t=vc(sa)[0],e=In().memoizedState;return[t,e]},useMutableSource:Ey,useSyncExternalStore:Iy,useId:Oy,unstable_isNewReconciler:!1},r_={readContext:En,useCallback:Vy,useContext:En,useEffect:Mh,useImperativeHandle:My,useInsertionEffect:Dy,useLayoutEffect:jy,useMemo:Ly,useReducer:xc,useRef:Py,useState:function(){return xc(sa)},useDebugValue:Vh,useDeferredValue:function(t){var e=In();return yt===null?e.memoizedState=t:Fy(e,yt.memoizedState,t)},useTransition:function(){var t=xc(sa)[0],e=In().memoizedState;return[t,e]},useMutableSource:Ey,useSyncExternalStore:Iy,useId:Oy,unstable_isNewReconciler:!1};function Nn(t,e){if(t&&t.defaultProps){e=nt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function hd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:nt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var xu={isMounted:function(t){return(t=t._reactInternals)?$s(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Kt(),s=Xr(t),i=pr(r,s);i.payload=e,n!=null&&(i.callback=n),e=Kr(t,i,s),e!==null&&(On(e,t,s,r),yl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Kt(),s=Xr(t),i=pr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Kr(t,i,s),e!==null&&(On(e,t,s,r),yl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Kt(),r=Xr(t),s=pr(n,r);s.tag=2,e!=null&&(s.callback=e),e=Kr(t,s,r),e!==null&&(On(e,t,r,n),yl(e,t,r))}};function Fp(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!Xo(n,r)||!Xo(s,i):!0}function $y(t,e,n){var r=!1,s=ss,i=e.contextType;return typeof i=="object"&&i!==null?i=En(i):(s=on(e)?Ns:Ht.current,r=e.contextTypes,i=(r=r!=null)?Vi(t,s):ss),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=xu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Op(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&xu.enqueueReplaceState(e,e.state,null)}function fd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Ah(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=En(i):(i=on(e)?Ns:Ht.current,s.context=Vi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(hd(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&xu.enqueueReplaceState(s,s.state,null),Wl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function zi(t,e){try{var n="",r=e;do n+=Px(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function _c(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function pd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var s_=typeof WeakMap=="function"?WeakMap:Map;function Wy(t,e,n){n=pr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Kl||(Kl=!0,Ed=r),pd(t,e)},n}function Hy(t,e,n){n=pr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){pd(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){pd(t,e),typeof r!="function"&&(Yr===null?Yr=new Set([this]):Yr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function zp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new s_;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=v_.bind(null,t,e,n),e.then(t,t))}function Bp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Up(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=pr(-1,1),e.tag=2,Kr(n,e,1))),n.lanes|=1),t)}var i_=Er.ReactCurrentOwner,rn=!1;function Qt(t,e,n,r){e.child=t===null?_y(e,null,n,r):Fi(e,t.child,n,r)}function $p(t,e,n,r,s){n=n.render;var i=e.ref;return Di(e,s),r=jh(t,e,n,r,i,s),n=Nh(),t!==null&&!rn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,xr(t,e,s)):(Je&&n&&wh(e),e.flags|=1,Qt(t,e,r,s),e.child)}function Wp(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Wh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,qy(t,e,i,r,s)):(t=Tl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Xo,n(a,r)&&t.ref===e.ref)return xr(t,e,s)}return e.flags|=1,t=Jr(i,r),t.ref=e.ref,t.return=e,e.child=t}function qy(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Xo(i,r)&&t.ref===e.ref)if(rn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(rn=!0);else return e.lanes=t.lanes,xr(t,e,s)}return gd(t,e,n,r,s)}function Gy(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(ki,hn),hn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,We(ki,hn),hn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,We(ki,hn),hn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,We(ki,hn),hn|=r;return Qt(t,e,s,n),e.child}function Qy(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function gd(t,e,n,r,s){var i=on(n)?Ns:Ht.current;return i=Vi(e,i),Di(e,s),n=jh(t,e,n,r,i,s),r=Nh(),t!==null&&!rn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,xr(t,e,s)):(Je&&r&&wh(e),e.flags|=1,Qt(t,e,n,s),e.child)}function Hp(t,e,n,r,s){if(on(n)){var i=!0;Ol(e)}else i=!1;if(Di(e,s),e.stateNode===null)_l(t,e),$y(e,n,r),fd(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=En(h):(h=on(n)?Ns:Ht.current,h=Vi(e,h));var p=n.getDerivedStateFromProps,y=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";y||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==h)&&Op(e,a,r,h),Fr=!1;var m=e.memoizedState;a.state=m,Wl(e,r,a,s),c=e.memoizedState,l!==r||m!==c||sn.current||Fr?(typeof p=="function"&&(hd(e,n,p,r),c=e.memoizedState),(l=Fr||Fp(e,n,l,r,m,c,h))?(y||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),a.props=r,a.state=c,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Sy(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:Nn(e.type,l),a.props=h,y=e.pendingProps,m=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=En(c):(c=on(n)?Ns:Ht.current,c=Vi(e,c));var S=n.getDerivedStateFromProps;(p=typeof S=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==y||m!==c)&&Op(e,a,r,c),Fr=!1,m=e.memoizedState,a.state=m,Wl(e,r,a,s);var k=e.memoizedState;l!==y||m!==k||sn.current||Fr?(typeof S=="function"&&(hd(e,n,S,r),k=e.memoizedState),(h=Fr||Fp(e,n,h,r,m,k,c)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,k,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,k,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=k),a.props=r,a.state=k,a.context=c,r=h):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return md(t,e,n,r,i,s)}function md(t,e,n,r,s,i){Qy(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&bp(e,n,!1),xr(t,e,i);r=e.stateNode,i_.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Fi(e,t.child,null,i),e.child=Fi(e,null,l,i)):Qt(t,e,l,i),e.memoizedState=r.state,s&&bp(e,n,!0),e.child}function Ky(t){var e=t.stateNode;e.pendingContext?Rp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Rp(t,e.context,!1),Rh(t,e.containerInfo)}function qp(t,e,n,r,s){return Li(),Th(s),e.flags|=256,Qt(t,e,n,r),e.child}var yd={dehydrated:null,treeContext:null,retryLane:0};function vd(t){return{baseLanes:t,cachePool:null,transitions:null}}function Yy(t,e,n){var r=e.pendingProps,s=et.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),We(et,s&1),t===null)return cd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Su(a,r,0,null),t=Ds(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=vd(n),e.memoizedState=yd,t):Lh(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return o_(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Jr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Jr(l,i):(i=Ds(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?vd(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=yd,r}return i=t.child,t=i.sibling,r=Jr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Lh(t,e){return e=Su({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function sl(t,e,n,r){return r!==null&&Th(r),Fi(e,t.child,null,n),t=Lh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function o_(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=_c(Error(J(422))),sl(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Su({mode:"visible",children:r.children},s,0,null),i=Ds(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Fi(e,t.child,null,a),e.child.memoizedState=vd(a),e.memoizedState=yd,i);if(!(e.mode&1))return sl(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(J(419)),r=_c(i,r,void 0),sl(t,e,a,r)}if(l=(a&t.childLanes)!==0,rn||l){if(r=St,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,vr(t,s),On(r,t,s,-1))}return $h(),r=_c(Error(J(421))),sl(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=x_.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,fn=Qr(s.nextSibling),gn=e,Je=!0,Vn=null,t!==null&&(_n[wn++]=hr,_n[wn++]=fr,_n[wn++]=Ms,hr=t.id,fr=t.overflow,Ms=e),e=Lh(e,r.children),e.flags|=4096,e)}function Gp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),dd(t.return,e,n)}function wc(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Xy(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Qt(t,e,r.children,n),r=et.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Gp(t,n,e);else if(t.tag===19)Gp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(We(et,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Hl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),wc(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Hl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}wc(e,!0,n,null,i);break;case"together":wc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function _l(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function xr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ls|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(J(153));if(e.child!==null){for(t=e.child,n=Jr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Jr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function a_(t,e,n){switch(e.tag){case 3:Ky(e),Li();break;case 5:Ty(e);break;case 1:on(e.type)&&Ol(e);break;case 4:Rh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;We(Ul,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(We(et,et.current&1),e.flags|=128,null):n&e.child.childLanes?Yy(t,e,n):(We(et,et.current&1),t=xr(t,e,n),t!==null?t.sibling:null);We(et,et.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Xy(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),We(et,et.current),r)break;return null;case 22:case 23:return e.lanes=0,Gy(t,e,n)}return xr(t,e,n)}var Jy,xd,Zy,e0;Jy=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};xd=function(){};Zy=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Rs(Jn.current);var i=null;switch(n){case"input":s=Bc(t,s),r=Bc(t,r),i=[];break;case"select":s=nt({},s,{value:void 0}),r=nt({},r,{value:void 0}),i=[];break;case"textarea":s=Wc(t,s),r=Wc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ll)}qc(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Wo.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var c=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&c!==l&&(c!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(h,n)),n=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Wo.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&Ge("scroll",t),i||l===c||(i=[])):(i=i||[]).push(h,c))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};e0=function(t,e,n,r){n!==r&&(e.flags|=4)};function xo(t,e){if(!Je)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function l_(t,e,n){var r=e.pendingProps;switch(Sh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(e),null;case 1:return on(e.type)&&Fl(),Bt(e),null;case 3:return r=e.stateNode,Oi(),Ke(sn),Ke(Ht),Ph(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(nl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Vn!==null&&(kd(Vn),Vn=null))),xd(t,e),Bt(e),null;case 5:bh(e);var s=Rs(na.current);if(n=e.type,t!==null&&e.stateNode!=null)Zy(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(J(166));return Bt(e),null}if(t=Rs(Jn.current),nl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Yn]=e,r[ea]=i,t=(e.mode&1)!==0,n){case"dialog":Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":case"embed":Ge("load",r);break;case"video":case"audio":for(s=0;s<Io.length;s++)Ge(Io[s],r);break;case"source":Ge("error",r);break;case"img":case"image":case"link":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"input":np(r,i),Ge("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ge("invalid",r);break;case"textarea":sp(r,i),Ge("invalid",r)}qc(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&tl(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&tl(r.textContent,l,t),s=["children",""+l]):Wo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Ge("scroll",r)}switch(n){case"input":Ga(r),rp(r,i,!0);break;case"textarea":Ga(r),ip(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ll)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Am(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Yn]=e,t[ea]=r,Jy(t,e,!1,!1),e.stateNode=t;e:{switch(a=Gc(n,r),n){case"dialog":Ge("cancel",t),Ge("close",t),s=r;break;case"iframe":case"object":case"embed":Ge("load",t),s=r;break;case"video":case"audio":for(s=0;s<Io.length;s++)Ge(Io[s],t);s=r;break;case"source":Ge("error",t),s=r;break;case"img":case"image":case"link":Ge("error",t),Ge("load",t),s=r;break;case"details":Ge("toggle",t),s=r;break;case"input":np(t,r),s=Bc(t,r),Ge("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=nt({},r,{value:void 0}),Ge("invalid",t);break;case"textarea":sp(t,r),s=Wc(t,r),Ge("invalid",t);break;default:s=r}qc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Pm(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Rm(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Ho(t,c):typeof c=="number"&&Ho(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Wo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ge("scroll",t):c!=null&&ah(t,i,c,a))}switch(n){case"input":Ga(t),rp(t,r,!1);break;case"textarea":Ga(t),ip(t);break;case"option":r.value!=null&&t.setAttribute("value",""+rs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ai(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ai(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Ll)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Bt(e),null;case 6:if(t&&e.stateNode!=null)e0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(J(166));if(n=Rs(na.current),Rs(Jn.current),nl(e)){if(r=e.stateNode,n=e.memoizedProps,r[Yn]=e,(i=r.nodeValue!==n)&&(t=gn,t!==null))switch(t.tag){case 3:tl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&tl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Yn]=e,e.stateNode=r}return Bt(e),null;case 13:if(Ke(et),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Je&&fn!==null&&e.mode&1&&!(e.flags&128))vy(),Li(),e.flags|=98560,i=!1;else if(i=nl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(J(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(J(317));i[Yn]=e}else Li(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Bt(e),i=!1}else Vn!==null&&(kd(Vn),Vn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||et.current&1?vt===0&&(vt=3):$h())),e.updateQueue!==null&&(e.flags|=4),Bt(e),null);case 4:return Oi(),xd(t,e),t===null&&Jo(e.stateNode.containerInfo),Bt(e),null;case 10:return Ch(e.type._context),Bt(e),null;case 17:return on(e.type)&&Fl(),Bt(e),null;case 19:if(Ke(et),i=e.memoizedState,i===null)return Bt(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)xo(i,!1);else{if(vt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Hl(t),a!==null){for(e.flags|=128,xo(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return We(et,et.current&1|2),e.child}t=t.sibling}i.tail!==null&&ut()>Bi&&(e.flags|=128,r=!0,xo(i,!1),e.lanes=4194304)}else{if(!r)if(t=Hl(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),xo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Je)return Bt(e),null}else 2*ut()-i.renderingStartTime>Bi&&n!==1073741824&&(e.flags|=128,r=!0,xo(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ut(),e.sibling=null,n=et.current,We(et,r?n&1|2:n&1),e):(Bt(e),null);case 22:case 23:return Uh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?hn&1073741824&&(Bt(e),e.subtreeFlags&6&&(e.flags|=8192)):Bt(e),null;case 24:return null;case 25:return null}throw Error(J(156,e.tag))}function u_(t,e){switch(Sh(e),e.tag){case 1:return on(e.type)&&Fl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Oi(),Ke(sn),Ke(Ht),Ph(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return bh(e),null;case 13:if(Ke(et),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(J(340));Li()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ke(et),null;case 4:return Oi(),null;case 10:return Ch(e.type._context),null;case 22:case 23:return Uh(),null;case 24:return null;default:return null}}var il=!1,$t=!1,c_=typeof WeakSet=="function"?WeakSet:Set,ie=null;function Ci(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){at(t,e,r)}else n.current=null}function _d(t,e,n){try{n()}catch(r){at(t,e,r)}}var Qp=!1;function d_(t,e){if(rd=Nl,t=iy(),_h(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,h=0,p=0,y=t,m=null;t:for(;;){for(var S;y!==n||s!==0&&y.nodeType!==3||(l=a+s),y!==i||r!==0&&y.nodeType!==3||(c=a+r),y.nodeType===3&&(a+=y.nodeValue.length),(S=y.firstChild)!==null;)m=y,y=S;for(;;){if(y===t)break t;if(m===n&&++h===s&&(l=a),m===i&&++p===r&&(c=a),(S=y.nextSibling)!==null)break;y=m,m=y.parentNode}y=S}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(sd={focusedElem:t,selectionRange:n},Nl=!1,ie=e;ie!==null;)if(e=ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ie=t;else for(;ie!==null;){e=ie;try{var k=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var b=k.memoizedProps,L=k.memoizedState,A=e.stateNode,T=A.getSnapshotBeforeUpdate(e.elementType===e.type?b:Nn(e.type,b),L);A.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(V){at(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,ie=t;break}ie=e.return}return k=Qp,Qp=!1,k}function Lo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&_d(e,n,i)}s=s.next}while(s!==r)}}function _u(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function wd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function t0(t){var e=t.alternate;e!==null&&(t.alternate=null,t0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Yn],delete e[ea],delete e[ad],delete e[G1],delete e[Q1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function n0(t){return t.tag===5||t.tag===3||t.tag===4}function Kp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||n0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ll));else if(r!==4&&(t=t.child,t!==null))for(Sd(t,e,n),t=t.sibling;t!==null;)Sd(t,e,n),t=t.sibling}function Td(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Td(t,e,n),t=t.sibling;t!==null;)Td(t,e,n),t=t.sibling}var At=null,Mn=!1;function Vr(t,e,n){for(n=n.child;n!==null;)r0(t,e,n),n=n.sibling}function r0(t,e,n){if(Xn&&typeof Xn.onCommitFiberUnmount=="function")try{Xn.onCommitFiberUnmount(hu,n)}catch{}switch(n.tag){case 5:$t||Ci(n,e);case 6:var r=At,s=Mn;At=null,Vr(t,e,n),At=r,Mn=s,At!==null&&(Mn?(t=At,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):At.removeChild(n.stateNode));break;case 18:At!==null&&(Mn?(t=At,n=n.stateNode,t.nodeType===8?pc(t.parentNode,n):t.nodeType===1&&pc(t,n),Ko(t)):pc(At,n.stateNode));break;case 4:r=At,s=Mn,At=n.stateNode.containerInfo,Mn=!0,Vr(t,e,n),At=r,Mn=s;break;case 0:case 11:case 14:case 15:if(!$t&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&_d(n,e,a),s=s.next}while(s!==r)}Vr(t,e,n);break;case 1:if(!$t&&(Ci(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){at(n,e,l)}Vr(t,e,n);break;case 21:Vr(t,e,n);break;case 22:n.mode&1?($t=(r=$t)||n.memoizedState!==null,Vr(t,e,n),$t=r):Vr(t,e,n);break;default:Vr(t,e,n)}}function Yp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new c_),e.forEach(function(r){var s=__.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function jn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:At=l.stateNode,Mn=!1;break e;case 3:At=l.stateNode.containerInfo,Mn=!0;break e;case 4:At=l.stateNode.containerInfo,Mn=!0;break e}l=l.return}if(At===null)throw Error(J(160));r0(i,a,s),At=null,Mn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(h){at(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)s0(e,t),e=e.sibling}function s0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(jn(e,t),Qn(t),r&4){try{Lo(3,t,t.return),_u(3,t)}catch(b){at(t,t.return,b)}try{Lo(5,t,t.return)}catch(b){at(t,t.return,b)}}break;case 1:jn(e,t),Qn(t),r&512&&n!==null&&Ci(n,n.return);break;case 5:if(jn(e,t),Qn(t),r&512&&n!==null&&Ci(n,n.return),t.flags&32){var s=t.stateNode;try{Ho(s,"")}catch(b){at(t,t.return,b)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Cm(s,i),Gc(l,a);var h=Gc(l,i);for(a=0;a<c.length;a+=2){var p=c[a],y=c[a+1];p==="style"?Pm(s,y):p==="dangerouslySetInnerHTML"?Rm(s,y):p==="children"?Ho(s,y):ah(s,p,y,h)}switch(l){case"input":Uc(s,i);break;case"textarea":km(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var S=i.value;S!=null?Ai(s,!!i.multiple,S,!1):m!==!!i.multiple&&(i.defaultValue!=null?Ai(s,!!i.multiple,i.defaultValue,!0):Ai(s,!!i.multiple,i.multiple?[]:"",!1))}s[ea]=i}catch(b){at(t,t.return,b)}}break;case 6:if(jn(e,t),Qn(t),r&4){if(t.stateNode===null)throw Error(J(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(b){at(t,t.return,b)}}break;case 3:if(jn(e,t),Qn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ko(e.containerInfo)}catch(b){at(t,t.return,b)}break;case 4:jn(e,t),Qn(t);break;case 13:jn(e,t),Qn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(zh=ut())),r&4&&Yp(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?($t=(h=$t)||p,jn(e,t),$t=h):jn(e,t),Qn(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(ie=t,p=t.child;p!==null;){for(y=ie=p;ie!==null;){switch(m=ie,S=m.child,m.tag){case 0:case 11:case 14:case 15:Lo(4,m,m.return);break;case 1:Ci(m,m.return);var k=m.stateNode;if(typeof k.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,k.props=e.memoizedProps,k.state=e.memoizedState,k.componentWillUnmount()}catch(b){at(r,n,b)}}break;case 5:Ci(m,m.return);break;case 22:if(m.memoizedState!==null){Jp(y);continue}}S!==null?(S.return=m,ie=S):Jp(y)}p=p.sibling}e:for(p=null,y=t;;){if(y.tag===5){if(p===null){p=y;try{s=y.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=y.stateNode,c=y.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=bm("display",a))}catch(b){at(t,t.return,b)}}}else if(y.tag===6){if(p===null)try{y.stateNode.nodeValue=h?"":y.memoizedProps}catch(b){at(t,t.return,b)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===t)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;p===y&&(p=null),y=y.return}p===y&&(p=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:jn(e,t),Qn(t),r&4&&Yp(t);break;case 21:break;default:jn(e,t),Qn(t)}}function Qn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(n0(n)){var r=n;break e}n=n.return}throw Error(J(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ho(s,""),r.flags&=-33);var i=Kp(t);Td(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Kp(t);Sd(t,l,a);break;default:throw Error(J(161))}}catch(c){at(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function h_(t,e,n){ie=t,i0(t)}function i0(t,e,n){for(var r=(t.mode&1)!==0;ie!==null;){var s=ie,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||il;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||$t;l=il;var h=$t;if(il=a,($t=c)&&!h)for(ie=s;ie!==null;)a=ie,c=a.child,a.tag===22&&a.memoizedState!==null?Zp(s):c!==null?(c.return=a,ie=c):Zp(s);for(;i!==null;)ie=i,i0(i),i=i.sibling;ie=s,il=l,$t=h}Xp(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ie=i):Xp(t)}}function Xp(t){for(;ie!==null;){var e=ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$t||_u(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!$t)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Nn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Mp(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Mp(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var y=p.dehydrated;y!==null&&Ko(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}$t||e.flags&512&&wd(e)}catch(m){at(e,e.return,m)}}if(e===t){ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,ie=n;break}ie=e.return}}function Jp(t){for(;ie!==null;){var e=ie;if(e===t){ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ie=n;break}ie=e.return}}function Zp(t){for(;ie!==null;){var e=ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{_u(4,e)}catch(c){at(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){at(e,s,c)}}var i=e.return;try{wd(e)}catch(c){at(e,i,c)}break;case 5:var a=e.return;try{wd(e)}catch(c){at(e,a,c)}}}catch(c){at(e,e.return,c)}if(e===t){ie=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ie=l;break}ie=e.return}}var f_=Math.ceil,Ql=Er.ReactCurrentDispatcher,Fh=Er.ReactCurrentOwner,Tn=Er.ReactCurrentBatchConfig,Ne=0,St=null,pt=null,Dt=0,hn=0,ki=us(0),vt=0,oa=null,Ls=0,wu=0,Oh=0,Fo=null,tn=null,zh=0,Bi=1/0,ur=null,Kl=!1,Ed=null,Yr=null,ol=!1,Ur=null,Yl=0,Oo=0,Id=null,wl=-1,Sl=0;function Kt(){return Ne&6?ut():wl!==-1?wl:wl=ut()}function Xr(t){return t.mode&1?Ne&2&&Dt!==0?Dt&-Dt:Y1.transition!==null?(Sl===0&&(Sl=$m()),Sl):(t=ze,t!==0||(t=window.event,t=t===void 0?16:Ym(t.type)),t):1}function On(t,e,n,r){if(50<Oo)throw Oo=0,Id=null,Error(J(185));va(t,n,r),(!(Ne&2)||t!==St)&&(t===St&&(!(Ne&2)&&(wu|=n),vt===4&&zr(t,Dt)),an(t,r),n===1&&Ne===0&&!(e.mode&1)&&(Bi=ut()+500,yu&&cs()))}function an(t,e){var n=t.callbackNode;Yx(t,e);var r=jl(t,t===St?Dt:0);if(r===0)n!==null&&lp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&lp(n),e===1)t.tag===0?K1(eg.bind(null,t)):gy(eg.bind(null,t)),H1(function(){!(Ne&6)&&cs()}),n=null;else{switch(Wm(r)){case 1:n=hh;break;case 4:n=Bm;break;case 16:n=Dl;break;case 536870912:n=Um;break;default:n=Dl}n=f0(n,o0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function o0(t,e){if(wl=-1,Sl=0,Ne&6)throw Error(J(327));var n=t.callbackNode;if(ji()&&t.callbackNode!==n)return null;var r=jl(t,t===St?Dt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Xl(t,r);else{e=r;var s=Ne;Ne|=2;var i=l0();(St!==t||Dt!==e)&&(ur=null,Bi=ut()+500,Ps(t,e));do try{m_();break}catch(l){a0(t,l)}while(!0);Ih(),Ql.current=i,Ne=s,pt!==null?e=0:(St=null,Dt=0,e=vt)}if(e!==0){if(e===2&&(s=Jc(t),s!==0&&(r=s,e=Cd(t,s))),e===1)throw n=oa,Ps(t,0),zr(t,r),an(t,ut()),n;if(e===6)zr(t,r);else{if(s=t.current.alternate,!(r&30)&&!p_(s)&&(e=Xl(t,r),e===2&&(i=Jc(t),i!==0&&(r=i,e=Cd(t,i))),e===1))throw n=oa,Ps(t,0),zr(t,r),an(t,ut()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(J(345));case 2:Is(t,tn,ur);break;case 3:if(zr(t,r),(r&130023424)===r&&(e=zh+500-ut(),10<e)){if(jl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Kt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=od(Is.bind(null,t,tn,ur),e);break}Is(t,tn,ur);break;case 4:if(zr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Fn(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=ut()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*f_(r/1960))-r,10<r){t.timeoutHandle=od(Is.bind(null,t,tn,ur),r);break}Is(t,tn,ur);break;case 5:Is(t,tn,ur);break;default:throw Error(J(329))}}}return an(t,ut()),t.callbackNode===n?o0.bind(null,t):null}function Cd(t,e){var n=Fo;return t.current.memoizedState.isDehydrated&&(Ps(t,e).flags|=256),t=Xl(t,e),t!==2&&(e=tn,tn=n,e!==null&&kd(e)),t}function kd(t){tn===null?tn=t:tn.push.apply(tn,t)}function p_(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Bn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function zr(t,e){for(e&=~Oh,e&=~wu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Fn(e),r=1<<n;t[n]=-1,e&=~r}}function eg(t){if(Ne&6)throw Error(J(327));ji();var e=jl(t,0);if(!(e&1))return an(t,ut()),null;var n=Xl(t,e);if(t.tag!==0&&n===2){var r=Jc(t);r!==0&&(e=r,n=Cd(t,r))}if(n===1)throw n=oa,Ps(t,0),zr(t,e),an(t,ut()),n;if(n===6)throw Error(J(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Is(t,tn,ur),an(t,ut()),null}function Bh(t,e){var n=Ne;Ne|=1;try{return t(e)}finally{Ne=n,Ne===0&&(Bi=ut()+500,yu&&cs())}}function Fs(t){Ur!==null&&Ur.tag===0&&!(Ne&6)&&ji();var e=Ne;Ne|=1;var n=Tn.transition,r=ze;try{if(Tn.transition=null,ze=1,t)return t()}finally{ze=r,Tn.transition=n,Ne=e,!(Ne&6)&&cs()}}function Uh(){hn=ki.current,Ke(ki)}function Ps(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,W1(n)),pt!==null)for(n=pt.return;n!==null;){var r=n;switch(Sh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Fl();break;case 3:Oi(),Ke(sn),Ke(Ht),Ph();break;case 5:bh(r);break;case 4:Oi();break;case 13:Ke(et);break;case 19:Ke(et);break;case 10:Ch(r.type._context);break;case 22:case 23:Uh()}n=n.return}if(St=t,pt=t=Jr(t.current,null),Dt=hn=e,vt=0,oa=null,Oh=wu=Ls=0,tn=Fo=null,As!==null){for(e=0;e<As.length;e++)if(n=As[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}As=null}return t}function a0(t,e){do{var n=pt;try{if(Ih(),vl.current=Gl,ql){for(var r=tt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}ql=!1}if(Vs=0,wt=yt=tt=null,Vo=!1,ra=0,Fh.current=null,n===null||n.return===null){vt=1,oa=e,pt=null;break}e:{var i=t,a=n.return,l=n,c=e;if(e=Dt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,p=l,y=p.tag;if(!(p.mode&1)&&(y===0||y===11||y===15)){var m=p.alternate;m?(p.updateQueue=m.updateQueue,p.memoizedState=m.memoizedState,p.lanes=m.lanes):(p.updateQueue=null,p.memoizedState=null)}var S=Bp(a);if(S!==null){S.flags&=-257,Up(S,a,l,i,e),S.mode&1&&zp(i,h,e),e=S,c=h;var k=e.updateQueue;if(k===null){var b=new Set;b.add(c),e.updateQueue=b}else k.add(c);break e}else{if(!(e&1)){zp(i,h,e),$h();break e}c=Error(J(426))}}else if(Je&&l.mode&1){var L=Bp(a);if(L!==null){!(L.flags&65536)&&(L.flags|=256),Up(L,a,l,i,e),Th(zi(c,l));break e}}i=c=zi(c,l),vt!==4&&(vt=2),Fo===null?Fo=[i]:Fo.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var A=Wy(i,c,e);Np(i,A);break e;case 1:l=c;var T=i.type,I=i.stateNode;if(!(i.flags&128)&&(typeof T.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Yr===null||!Yr.has(I)))){i.flags|=65536,e&=-e,i.lanes|=e;var V=Hy(i,l,e);Np(i,V);break e}}i=i.return}while(i!==null)}c0(n)}catch(B){e=B,pt===n&&n!==null&&(pt=n=n.return);continue}break}while(!0)}function l0(){var t=Ql.current;return Ql.current=Gl,t===null?Gl:t}function $h(){(vt===0||vt===3||vt===2)&&(vt=4),St===null||!(Ls&268435455)&&!(wu&268435455)||zr(St,Dt)}function Xl(t,e){var n=Ne;Ne|=2;var r=l0();(St!==t||Dt!==e)&&(ur=null,Ps(t,e));do try{g_();break}catch(s){a0(t,s)}while(!0);if(Ih(),Ne=n,Ql.current=r,pt!==null)throw Error(J(261));return St=null,Dt=0,vt}function g_(){for(;pt!==null;)u0(pt)}function m_(){for(;pt!==null&&!Bx();)u0(pt)}function u0(t){var e=h0(t.alternate,t,hn);t.memoizedProps=t.pendingProps,e===null?c0(t):pt=e,Fh.current=null}function c0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=u_(n,e),n!==null){n.flags&=32767,pt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vt=6,pt=null;return}}else if(n=l_(n,e,hn),n!==null){pt=n;return}if(e=e.sibling,e!==null){pt=e;return}pt=e=t}while(e!==null);vt===0&&(vt=5)}function Is(t,e,n){var r=ze,s=Tn.transition;try{Tn.transition=null,ze=1,y_(t,e,n,r)}finally{Tn.transition=s,ze=r}return null}function y_(t,e,n,r){do ji();while(Ur!==null);if(Ne&6)throw Error(J(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(J(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Xx(t,i),t===St&&(pt=St=null,Dt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ol||(ol=!0,f0(Dl,function(){return ji(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Tn.transition,Tn.transition=null;var a=ze;ze=1;var l=Ne;Ne|=4,Fh.current=null,d_(t,n),s0(n,t),L1(sd),Nl=!!rd,sd=rd=null,t.current=n,h_(n),Ux(),Ne=l,ze=a,Tn.transition=i}else t.current=n;if(ol&&(ol=!1,Ur=t,Yl=s),i=t.pendingLanes,i===0&&(Yr=null),Hx(n.stateNode),an(t,ut()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Kl)throw Kl=!1,t=Ed,Ed=null,t;return Yl&1&&t.tag!==0&&ji(),i=t.pendingLanes,i&1?t===Id?Oo++:(Oo=0,Id=t):Oo=0,cs(),null}function ji(){if(Ur!==null){var t=Wm(Yl),e=Tn.transition,n=ze;try{if(Tn.transition=null,ze=16>t?16:t,Ur===null)var r=!1;else{if(t=Ur,Ur=null,Yl=0,Ne&6)throw Error(J(331));var s=Ne;for(Ne|=4,ie=t.current;ie!==null;){var i=ie,a=i.child;if(ie.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var h=l[c];for(ie=h;ie!==null;){var p=ie;switch(p.tag){case 0:case 11:case 15:Lo(8,p,i)}var y=p.child;if(y!==null)y.return=p,ie=y;else for(;ie!==null;){p=ie;var m=p.sibling,S=p.return;if(t0(p),p===h){ie=null;break}if(m!==null){m.return=S,ie=m;break}ie=S}}}var k=i.alternate;if(k!==null){var b=k.child;if(b!==null){k.child=null;do{var L=b.sibling;b.sibling=null,b=L}while(b!==null)}}ie=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ie=a;else e:for(;ie!==null;){if(i=ie,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Lo(9,i,i.return)}var A=i.sibling;if(A!==null){A.return=i.return,ie=A;break e}ie=i.return}}var T=t.current;for(ie=T;ie!==null;){a=ie;var I=a.child;if(a.subtreeFlags&2064&&I!==null)I.return=a,ie=I;else e:for(a=T;ie!==null;){if(l=ie,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:_u(9,l)}}catch(B){at(l,l.return,B)}if(l===a){ie=null;break e}var V=l.sibling;if(V!==null){V.return=l.return,ie=V;break e}ie=l.return}}if(Ne=s,cs(),Xn&&typeof Xn.onPostCommitFiberRoot=="function")try{Xn.onPostCommitFiberRoot(hu,t)}catch{}r=!0}return r}finally{ze=n,Tn.transition=e}}return!1}function tg(t,e,n){e=zi(n,e),e=Wy(t,e,1),t=Kr(t,e,1),e=Kt(),t!==null&&(va(t,1,e),an(t,e))}function at(t,e,n){if(t.tag===3)tg(t,t,n);else for(;e!==null;){if(e.tag===3){tg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Yr===null||!Yr.has(r))){t=zi(n,t),t=Hy(e,t,1),e=Kr(e,t,1),t=Kt(),e!==null&&(va(e,1,t),an(e,t));break}}e=e.return}}function v_(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Kt(),t.pingedLanes|=t.suspendedLanes&n,St===t&&(Dt&n)===n&&(vt===4||vt===3&&(Dt&130023424)===Dt&&500>ut()-zh?Ps(t,0):Oh|=n),an(t,e)}function d0(t,e){e===0&&(t.mode&1?(e=Ya,Ya<<=1,!(Ya&130023424)&&(Ya=4194304)):e=1);var n=Kt();t=vr(t,e),t!==null&&(va(t,e,n),an(t,n))}function x_(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),d0(t,n)}function __(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(J(314))}r!==null&&r.delete(e),d0(t,n)}var h0;h0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||sn.current)rn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return rn=!1,a_(t,e,n);rn=!!(t.flags&131072)}else rn=!1,Je&&e.flags&1048576&&my(e,Bl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;_l(t,e),t=e.pendingProps;var s=Vi(e,Ht.current);Di(e,n),s=jh(null,e,r,t,s,n);var i=Nh();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,on(r)?(i=!0,Ol(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ah(e),s.updater=xu,e.stateNode=s,s._reactInternals=e,fd(e,r,t,n),e=md(null,e,r,!0,i,n)):(e.tag=0,Je&&i&&wh(e),Qt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(_l(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=S_(r),t=Nn(r,t),s){case 0:e=gd(null,e,r,t,n);break e;case 1:e=Hp(null,e,r,t,n);break e;case 11:e=$p(null,e,r,t,n);break e;case 14:e=Wp(null,e,r,Nn(r.type,t),n);break e}throw Error(J(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),gd(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),Hp(t,e,r,s,n);case 3:e:{if(Ky(e),t===null)throw Error(J(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Sy(t,e),Wl(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=zi(Error(J(423)),e),e=qp(t,e,r,n,s);break e}else if(r!==s){s=zi(Error(J(424)),e),e=qp(t,e,r,n,s);break e}else for(fn=Qr(e.stateNode.containerInfo.firstChild),gn=e,Je=!0,Vn=null,n=_y(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Li(),r===s){e=xr(t,e,n);break e}Qt(t,e,r,n)}e=e.child}return e;case 5:return Ty(e),t===null&&cd(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,id(r,s)?a=null:i!==null&&id(r,i)&&(e.flags|=32),Qy(t,e),Qt(t,e,a,n),e.child;case 6:return t===null&&cd(e),null;case 13:return Yy(t,e,n);case 4:return Rh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Fi(e,null,r,n):Qt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),$p(t,e,r,s,n);case 7:return Qt(t,e,e.pendingProps,n),e.child;case 8:return Qt(t,e,e.pendingProps.children,n),e.child;case 12:return Qt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,We(Ul,r._currentValue),r._currentValue=a,i!==null)if(Bn(i.value,a)){if(i.children===s.children&&!sn.current){e=xr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=pr(-1,n&-n),c.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?c.next=c:(c.next=p.next,p.next=c),h.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),dd(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(J(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),dd(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Qt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Di(e,n),s=En(s),r=r(s),e.flags|=1,Qt(t,e,r,n),e.child;case 14:return r=e.type,s=Nn(r,e.pendingProps),s=Nn(r.type,s),Wp(t,e,r,s,n);case 15:return qy(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),_l(t,e),e.tag=1,on(r)?(t=!0,Ol(e)):t=!1,Di(e,n),$y(e,r,s),fd(e,r,s,n),md(null,e,r,!0,t,n);case 19:return Xy(t,e,n);case 22:return Gy(t,e,n)}throw Error(J(156,e.tag))};function f0(t,e){return zm(t,e)}function w_(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sn(t,e,n,r){return new w_(t,e,n,r)}function Wh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function S_(t){if(typeof t=="function")return Wh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===uh)return 11;if(t===ch)return 14}return 2}function Jr(t,e){var n=t.alternate;return n===null?(n=Sn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Tl(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")Wh(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case yi:return Ds(n.children,s,i,e);case lh:a=8,s|=8;break;case Lc:return t=Sn(12,n,e,s|2),t.elementType=Lc,t.lanes=i,t;case Fc:return t=Sn(13,n,e,s),t.elementType=Fc,t.lanes=i,t;case Oc:return t=Sn(19,n,e,s),t.elementType=Oc,t.lanes=i,t;case Tm:return Su(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case wm:a=10;break e;case Sm:a=9;break e;case uh:a=11;break e;case ch:a=14;break e;case Lr:a=16,r=null;break e}throw Error(J(130,t==null?t:typeof t,""))}return e=Sn(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Ds(t,e,n,r){return t=Sn(7,t,r,e),t.lanes=n,t}function Su(t,e,n,r){return t=Sn(22,t,r,e),t.elementType=Tm,t.lanes=n,t.stateNode={isHidden:!1},t}function Sc(t,e,n){return t=Sn(6,t,null,e),t.lanes=n,t}function Tc(t,e,n){return e=Sn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function T_(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rc(0),this.expirationTimes=rc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Hh(t,e,n,r,s,i,a,l,c){return t=new T_(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Sn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ah(i),t}function E_(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function p0(t){if(!t)return ss;t=t._reactInternals;e:{if($s(t)!==t||t.tag!==1)throw Error(J(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(on(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(J(171))}if(t.tag===1){var n=t.type;if(on(n))return py(t,n,e)}return e}function g0(t,e,n,r,s,i,a,l,c){return t=Hh(n,r,!0,t,s,i,a,l,c),t.context=p0(null),n=t.current,r=Kt(),s=Xr(n),i=pr(r,s),i.callback=e??null,Kr(n,i,s),t.current.lanes=s,va(t,s,r),an(t,r),t}function Tu(t,e,n,r){var s=e.current,i=Kt(),a=Xr(s);return n=p0(n),e.context===null?e.context=n:e.pendingContext=n,e=pr(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Kr(s,e,a),t!==null&&(On(t,s,a,i),yl(t,s,a)),a}function Jl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ng(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function qh(t,e){ng(t,e),(t=t.alternate)&&ng(t,e)}function I_(){return null}var m0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Gh(t){this._internalRoot=t}Eu.prototype.render=Gh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(J(409));Tu(t,e,null,null)};Eu.prototype.unmount=Gh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Fs(function(){Tu(null,t,null,null)}),e[yr]=null}};function Eu(t){this._internalRoot=t}Eu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Gm();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Or.length&&e!==0&&e<Or[n].priority;n++);Or.splice(n,0,t),n===0&&Km(t)}};function Qh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Iu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function rg(){}function C_(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=Jl(a);i.call(h)}}var a=g0(e,r,t,0,null,!1,!1,"",rg);return t._reactRootContainer=a,t[yr]=a.current,Jo(t.nodeType===8?t.parentNode:t),Fs(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=Jl(c);l.call(h)}}var c=Hh(t,0,!1,null,null,!1,!1,"",rg);return t._reactRootContainer=c,t[yr]=c.current,Jo(t.nodeType===8?t.parentNode:t),Fs(function(){Tu(e,c,n,r)}),c}function Cu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=Jl(a);l.call(c)}}Tu(e,a,t,s)}else a=C_(n,e,t,s,r);return Jl(a)}Hm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Eo(e.pendingLanes);n!==0&&(fh(e,n|1),an(e,ut()),!(Ne&6)&&(Bi=ut()+500,cs()))}break;case 13:Fs(function(){var r=vr(t,1);if(r!==null){var s=Kt();On(r,t,1,s)}}),qh(t,1)}};ph=function(t){if(t.tag===13){var e=vr(t,134217728);if(e!==null){var n=Kt();On(e,t,134217728,n)}qh(t,134217728)}};qm=function(t){if(t.tag===13){var e=Xr(t),n=vr(t,e);if(n!==null){var r=Kt();On(n,t,e,r)}qh(t,e)}};Gm=function(){return ze};Qm=function(t,e){var n=ze;try{return ze=t,e()}finally{ze=n}};Kc=function(t,e,n){switch(e){case"input":if(Uc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=mu(r);if(!s)throw Error(J(90));Im(r),Uc(r,s)}}}break;case"textarea":km(t,n);break;case"select":e=n.value,e!=null&&Ai(t,!!n.multiple,e,!1)}};Nm=Bh;Mm=Fs;var k_={usingClientEntryPoint:!1,Events:[_a,wi,mu,Dm,jm,Bh]},_o={findFiberByHostInstance:ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},A_={bundleType:_o.bundleType,version:_o.version,rendererPackageName:_o.rendererPackageName,rendererConfig:_o.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Er.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fm(t),t===null?null:t.stateNode},findFiberByHostInstance:_o.findFiberByHostInstance||I_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{hu=al.inject(A_),Xn=al}catch{}}yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k_;yn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qh(e))throw Error(J(200));return E_(t,e,null,n)};yn.createRoot=function(t,e){if(!Qh(t))throw Error(J(299));var n=!1,r="",s=m0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Hh(t,1,!1,null,null,n,!1,r,s),t[yr]=e.current,Jo(t.nodeType===8?t.parentNode:t),new Gh(e)};yn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(J(188)):(t=Object.keys(t).join(","),Error(J(268,t)));return t=Fm(e),t=t===null?null:t.stateNode,t};yn.flushSync=function(t){return Fs(t)};yn.hydrate=function(t,e,n){if(!Iu(e))throw Error(J(200));return Cu(null,t,e,!0,n)};yn.hydrateRoot=function(t,e,n){if(!Qh(t))throw Error(J(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=m0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=g0(e,null,t,1,n??null,s,!1,i,a),t[yr]=e.current,Jo(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Eu(e)};yn.render=function(t,e,n){if(!Iu(e))throw Error(J(200));return Cu(null,t,e,!1,n)};yn.unmountComponentAtNode=function(t){if(!Iu(t))throw Error(J(40));return t._reactRootContainer?(Fs(function(){Cu(null,null,t,!1,function(){t._reactRootContainer=null,t[yr]=null})}),!0):!1};yn.unstable_batchedUpdates=Bh;yn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Iu(n))throw Error(J(200));if(t==null||t._reactInternals===void 0)throw Error(J(38));return Cu(t,e,n,!1,r)};yn.version="18.3.1-next-f1338f8080-20240426";function y0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(y0)}catch(t){console.error(t)}}y0(),ym.exports=yn;var R_=ym.exports,v0,sg=R_;v0=sg.createRoot,sg.hydrateRoot;var ig={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},b_=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},_0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,c=s+2<t.length,h=c?t[s+2]:0,p=i>>2,y=(i&3)<<4|l>>4;let m=(l&15)<<2|h>>6,S=h&63;c||(S=64,a||(m=64)),r.push(n[p],n[y],n[m],n[S])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(x0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):b_(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const y=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||h==null||y==null)throw new P_;const m=i<<2|l>>4;if(r.push(m),h!==64){const S=l<<4&240|h>>2;if(r.push(S),y!==64){const k=h<<6&192|y;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class P_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const D_=function(t){const e=x0(t);return _0.encodeByteArray(e,!0)},w0=function(t){return D_(t).replace(/\./g,"")},j_=function(t){try{return _0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M_=()=>N_().__FIREBASE_DEFAULTS__,V_=()=>{if(typeof process>"u"||typeof ig>"u")return;const t=ig.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},L_=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&j_(t[1]);return e&&JSON.parse(e)},Kh=()=>{try{return M_()||V_()||L_()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},F_=t=>{var e,n;return(n=(e=Kh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},O_=t=>{const e=F_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},S0=()=>{var t;return(t=Kh())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B_(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function U_(){var t;const e=(t=Kh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $_(){return!U_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function W_(){try{return typeof indexedDB=="object"}catch{return!1}}function H_(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_="FirebaseError";class Ji extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=q_,Object.setPrototypeOf(this,Ji.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,T0.prototype.create)}}class T0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?G_(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new Ji(s,l,r)}}function G_(t,e){return t.replace(Q_,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Q_=/\{\$([^}]+)}/g;function Zl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(og(i)&&og(a)){if(!Zl(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function og(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Un(t){return t&&t._delegate?t._delegate:t}class Ui{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new z_;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(X_(e))try{this.getOrInitializeService({instanceIdentifier:Cs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Cs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Cs){return this.instances.has(e)}getOptions(e=Cs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Y_(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Cs){return this.component?this.component.multipleInstances?e:Cs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Y_(t){return t===Cs?void 0:t}function X_(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new K_(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(je||(je={}));const Z_={debug:je.DEBUG,verbose:je.VERBOSE,info:je.INFO,warn:je.WARN,error:je.ERROR,silent:je.SILENT},ew=je.INFO,tw={[je.DEBUG]:"log",[je.VERBOSE]:"log",[je.INFO]:"info",[je.WARN]:"warn",[je.ERROR]:"error"},nw=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=tw[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class E0{constructor(e){this.name=e,this._logLevel=ew,this._logHandler=nw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Z_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,je.DEBUG,...e),this._logHandler(this,je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,je.VERBOSE,...e),this._logHandler(this,je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,je.INFO,...e),this._logHandler(this,je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,je.WARN,...e),this._logHandler(this,je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,je.ERROR,...e),this._logHandler(this,je.ERROR,...e)}}const rw=(t,e)=>e.some(n=>t instanceof n);let ag,lg;function sw(){return ag||(ag=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function iw(){return lg||(lg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const I0=new WeakMap,Ad=new WeakMap,C0=new WeakMap,Ec=new WeakMap,Yh=new WeakMap;function ow(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Zr(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&I0.set(n,t)}).catch(()=>{}),Yh.set(e,t),e}function aw(t){if(Ad.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Ad.set(t,e)}let Rd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ad.get(t);if(e==="objectStoreNames")return t.objectStoreNames||C0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Zr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function lw(t){Rd=t(Rd)}function uw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Ic(this),e,...n);return C0.set(r,e.sort?e.sort():[e]),Zr(r)}:iw().includes(t)?function(...e){return t.apply(Ic(this),e),Zr(I0.get(this))}:function(...e){return Zr(t.apply(Ic(this),e))}}function cw(t){return typeof t=="function"?uw(t):(t instanceof IDBTransaction&&aw(t),rw(t,sw())?new Proxy(t,Rd):t)}function Zr(t){if(t instanceof IDBRequest)return ow(t);if(Ec.has(t))return Ec.get(t);const e=cw(t);return e!==t&&(Ec.set(t,e),Yh.set(e,t)),e}const Ic=t=>Yh.get(t);function dw(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=Zr(a);return r&&a.addEventListener("upgradeneeded",c=>{r(Zr(a.result),c.oldVersion,c.newVersion,Zr(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const hw=["get","getKey","getAll","getAllKeys","count"],fw=["put","add","delete","clear"],Cc=new Map;function ug(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Cc.get(e))return Cc.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=fw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||hw.includes(n)))return;const i=async function(a,...l){const c=this.transaction(a,s?"readwrite":"readonly");let h=c.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),s&&c.done]))[0]};return Cc.set(e,i),i}lw(t=>({...t,get:(e,n,r)=>ug(e,n)||t.get(e,n,r),has:(e,n)=>!!ug(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(gw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function gw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const bd="@firebase/app",cg="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _r=new E0("@firebase/app"),mw="@firebase/app-compat",yw="@firebase/analytics-compat",vw="@firebase/analytics",xw="@firebase/app-check-compat",_w="@firebase/app-check",ww="@firebase/auth",Sw="@firebase/auth-compat",Tw="@firebase/database",Ew="@firebase/data-connect",Iw="@firebase/database-compat",Cw="@firebase/functions",kw="@firebase/functions-compat",Aw="@firebase/installations",Rw="@firebase/installations-compat",bw="@firebase/messaging",Pw="@firebase/messaging-compat",Dw="@firebase/performance",jw="@firebase/performance-compat",Nw="@firebase/remote-config",Mw="@firebase/remote-config-compat",Vw="@firebase/storage",Lw="@firebase/storage-compat",Fw="@firebase/firestore",Ow="@firebase/vertexai-preview",zw="@firebase/firestore-compat",Bw="firebase",Uw="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd="[DEFAULT]",$w={[bd]:"fire-core",[mw]:"fire-core-compat",[vw]:"fire-analytics",[yw]:"fire-analytics-compat",[_w]:"fire-app-check",[xw]:"fire-app-check-compat",[ww]:"fire-auth",[Sw]:"fire-auth-compat",[Tw]:"fire-rtdb",[Ew]:"fire-data-connect",[Iw]:"fire-rtdb-compat",[Cw]:"fire-fn",[kw]:"fire-fn-compat",[Aw]:"fire-iid",[Rw]:"fire-iid-compat",[bw]:"fire-fcm",[Pw]:"fire-fcm-compat",[Dw]:"fire-perf",[jw]:"fire-perf-compat",[Nw]:"fire-rc",[Mw]:"fire-rc-compat",[Vw]:"fire-gcs",[Lw]:"fire-gcs-compat",[Fw]:"fire-fst",[zw]:"fire-fst-compat",[Ow]:"fire-vertex","fire-js":"fire-js",[Bw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eu=new Map,Ww=new Map,Dd=new Map;function dg(t,e){try{t.container.addComponent(e)}catch(n){_r.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function aa(t){const e=t.name;if(Dd.has(e))return _r.debug(`There were multiple attempts to register component ${e}.`),!1;Dd.set(e,t);for(const n of eu.values())dg(n,t);for(const n of Ww.values())dg(n,t);return!0}function k0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},es=new T0("app","Firebase",Hw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ui("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw es.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gw=Uw;function A0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Pd,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw es.create("bad-app-name",{appName:String(s)});if(n||(n=S0()),!n)throw es.create("no-options");const i=eu.get(s);if(i){if(Zl(n,i.options)&&Zl(r,i.config))return i;throw es.create("duplicate-app",{appName:s})}const a=new J_(s);for(const c of Dd.values())a.addComponent(c);const l=new qw(n,r,a);return eu.set(s,l),l}function Qw(t=Pd){const e=eu.get(t);if(!e&&t===Pd&&S0())return A0();if(!e)throw es.create("no-app",{appName:t});return e}function ts(t,e,n){var r;let s=(r=$w[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_r.warn(l.join(" "));return}aa(new Ui(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw="firebase-heartbeat-database",Yw=1,la="firebase-heartbeat-store";let kc=null;function R0(){return kc||(kc=dw(Kw,Yw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(la)}catch(n){console.warn(n)}}}}).catch(t=>{throw es.create("idb-open",{originalErrorMessage:t.message})})),kc}async function Xw(t){try{const n=(await R0()).transaction(la),r=await n.objectStore(la).get(b0(t));return await n.done,r}catch(e){if(e instanceof Ji)_r.warn(e.message);else{const n=es.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});_r.warn(n.message)}}}async function hg(t,e){try{const r=(await R0()).transaction(la,"readwrite");await r.objectStore(la).put(e,b0(t)),await r.done}catch(n){if(n instanceof Ji)_r.warn(n.message);else{const r=es.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});_r.warn(r.message)}}}function b0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw=1024,Zw=30*24*60*60*1e3;class eS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new nS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=fg();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=Zw}),this._storage.overwrite(this._heartbeatsCache))}catch(r){_r.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=fg(),{heartbeatsToSend:r,unsentEntries:s}=tS(this._heartbeatsCache.heartbeats),i=w0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return _r.warn(n),""}}}function fg(){return new Date().toISOString().substring(0,10)}function tS(t,e=Jw){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),pg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),pg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class nS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return W_()?H_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Xw(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return hg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return hg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function pg(t){return w0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(t){aa(new Ui("platform-logger",e=>new pw(e),"PRIVATE")),aa(new Ui("heartbeat",e=>new eS(e),"PRIVATE")),ts(bd,cg,t),ts(bd,cg,"esm2017"),ts("fire-js","")}rS("");var sS="firebase",iS="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ts(sS,iS,"app");var gg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var js,P0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,g){function _(){}_.prototype=g.prototype,w.D=g.prototype,w.prototype=new _,w.prototype.constructor=w,w.C=function(x,C,R){for(var E=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)E[oe-2]=arguments[oe];return g.prototype[C].apply(x,E)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,g,_){_||(_=0);var x=Array(16);if(typeof g=="string")for(var C=0;16>C;++C)x[C]=g.charCodeAt(_++)|g.charCodeAt(_++)<<8|g.charCodeAt(_++)<<16|g.charCodeAt(_++)<<24;else for(C=0;16>C;++C)x[C]=g[_++]|g[_++]<<8|g[_++]<<16|g[_++]<<24;g=w.g[0],_=w.g[1],C=w.g[2];var R=w.g[3],E=g+(R^_&(C^R))+x[0]+3614090360&4294967295;g=_+(E<<7&4294967295|E>>>25),E=R+(C^g&(_^C))+x[1]+3905402710&4294967295,R=g+(E<<12&4294967295|E>>>20),E=C+(_^R&(g^_))+x[2]+606105819&4294967295,C=R+(E<<17&4294967295|E>>>15),E=_+(g^C&(R^g))+x[3]+3250441966&4294967295,_=C+(E<<22&4294967295|E>>>10),E=g+(R^_&(C^R))+x[4]+4118548399&4294967295,g=_+(E<<7&4294967295|E>>>25),E=R+(C^g&(_^C))+x[5]+1200080426&4294967295,R=g+(E<<12&4294967295|E>>>20),E=C+(_^R&(g^_))+x[6]+2821735955&4294967295,C=R+(E<<17&4294967295|E>>>15),E=_+(g^C&(R^g))+x[7]+4249261313&4294967295,_=C+(E<<22&4294967295|E>>>10),E=g+(R^_&(C^R))+x[8]+1770035416&4294967295,g=_+(E<<7&4294967295|E>>>25),E=R+(C^g&(_^C))+x[9]+2336552879&4294967295,R=g+(E<<12&4294967295|E>>>20),E=C+(_^R&(g^_))+x[10]+4294925233&4294967295,C=R+(E<<17&4294967295|E>>>15),E=_+(g^C&(R^g))+x[11]+2304563134&4294967295,_=C+(E<<22&4294967295|E>>>10),E=g+(R^_&(C^R))+x[12]+1804603682&4294967295,g=_+(E<<7&4294967295|E>>>25),E=R+(C^g&(_^C))+x[13]+4254626195&4294967295,R=g+(E<<12&4294967295|E>>>20),E=C+(_^R&(g^_))+x[14]+2792965006&4294967295,C=R+(E<<17&4294967295|E>>>15),E=_+(g^C&(R^g))+x[15]+1236535329&4294967295,_=C+(E<<22&4294967295|E>>>10),E=g+(C^R&(_^C))+x[1]+4129170786&4294967295,g=_+(E<<5&4294967295|E>>>27),E=R+(_^C&(g^_))+x[6]+3225465664&4294967295,R=g+(E<<9&4294967295|E>>>23),E=C+(g^_&(R^g))+x[11]+643717713&4294967295,C=R+(E<<14&4294967295|E>>>18),E=_+(R^g&(C^R))+x[0]+3921069994&4294967295,_=C+(E<<20&4294967295|E>>>12),E=g+(C^R&(_^C))+x[5]+3593408605&4294967295,g=_+(E<<5&4294967295|E>>>27),E=R+(_^C&(g^_))+x[10]+38016083&4294967295,R=g+(E<<9&4294967295|E>>>23),E=C+(g^_&(R^g))+x[15]+3634488961&4294967295,C=R+(E<<14&4294967295|E>>>18),E=_+(R^g&(C^R))+x[4]+3889429448&4294967295,_=C+(E<<20&4294967295|E>>>12),E=g+(C^R&(_^C))+x[9]+568446438&4294967295,g=_+(E<<5&4294967295|E>>>27),E=R+(_^C&(g^_))+x[14]+3275163606&4294967295,R=g+(E<<9&4294967295|E>>>23),E=C+(g^_&(R^g))+x[3]+4107603335&4294967295,C=R+(E<<14&4294967295|E>>>18),E=_+(R^g&(C^R))+x[8]+1163531501&4294967295,_=C+(E<<20&4294967295|E>>>12),E=g+(C^R&(_^C))+x[13]+2850285829&4294967295,g=_+(E<<5&4294967295|E>>>27),E=R+(_^C&(g^_))+x[2]+4243563512&4294967295,R=g+(E<<9&4294967295|E>>>23),E=C+(g^_&(R^g))+x[7]+1735328473&4294967295,C=R+(E<<14&4294967295|E>>>18),E=_+(R^g&(C^R))+x[12]+2368359562&4294967295,_=C+(E<<20&4294967295|E>>>12),E=g+(_^C^R)+x[5]+4294588738&4294967295,g=_+(E<<4&4294967295|E>>>28),E=R+(g^_^C)+x[8]+2272392833&4294967295,R=g+(E<<11&4294967295|E>>>21),E=C+(R^g^_)+x[11]+1839030562&4294967295,C=R+(E<<16&4294967295|E>>>16),E=_+(C^R^g)+x[14]+4259657740&4294967295,_=C+(E<<23&4294967295|E>>>9),E=g+(_^C^R)+x[1]+2763975236&4294967295,g=_+(E<<4&4294967295|E>>>28),E=R+(g^_^C)+x[4]+1272893353&4294967295,R=g+(E<<11&4294967295|E>>>21),E=C+(R^g^_)+x[7]+4139469664&4294967295,C=R+(E<<16&4294967295|E>>>16),E=_+(C^R^g)+x[10]+3200236656&4294967295,_=C+(E<<23&4294967295|E>>>9),E=g+(_^C^R)+x[13]+681279174&4294967295,g=_+(E<<4&4294967295|E>>>28),E=R+(g^_^C)+x[0]+3936430074&4294967295,R=g+(E<<11&4294967295|E>>>21),E=C+(R^g^_)+x[3]+3572445317&4294967295,C=R+(E<<16&4294967295|E>>>16),E=_+(C^R^g)+x[6]+76029189&4294967295,_=C+(E<<23&4294967295|E>>>9),E=g+(_^C^R)+x[9]+3654602809&4294967295,g=_+(E<<4&4294967295|E>>>28),E=R+(g^_^C)+x[12]+3873151461&4294967295,R=g+(E<<11&4294967295|E>>>21),E=C+(R^g^_)+x[15]+530742520&4294967295,C=R+(E<<16&4294967295|E>>>16),E=_+(C^R^g)+x[2]+3299628645&4294967295,_=C+(E<<23&4294967295|E>>>9),E=g+(C^(_|~R))+x[0]+4096336452&4294967295,g=_+(E<<6&4294967295|E>>>26),E=R+(_^(g|~C))+x[7]+1126891415&4294967295,R=g+(E<<10&4294967295|E>>>22),E=C+(g^(R|~_))+x[14]+2878612391&4294967295,C=R+(E<<15&4294967295|E>>>17),E=_+(R^(C|~g))+x[5]+4237533241&4294967295,_=C+(E<<21&4294967295|E>>>11),E=g+(C^(_|~R))+x[12]+1700485571&4294967295,g=_+(E<<6&4294967295|E>>>26),E=R+(_^(g|~C))+x[3]+2399980690&4294967295,R=g+(E<<10&4294967295|E>>>22),E=C+(g^(R|~_))+x[10]+4293915773&4294967295,C=R+(E<<15&4294967295|E>>>17),E=_+(R^(C|~g))+x[1]+2240044497&4294967295,_=C+(E<<21&4294967295|E>>>11),E=g+(C^(_|~R))+x[8]+1873313359&4294967295,g=_+(E<<6&4294967295|E>>>26),E=R+(_^(g|~C))+x[15]+4264355552&4294967295,R=g+(E<<10&4294967295|E>>>22),E=C+(g^(R|~_))+x[6]+2734768916&4294967295,C=R+(E<<15&4294967295|E>>>17),E=_+(R^(C|~g))+x[13]+1309151649&4294967295,_=C+(E<<21&4294967295|E>>>11),E=g+(C^(_|~R))+x[4]+4149444226&4294967295,g=_+(E<<6&4294967295|E>>>26),E=R+(_^(g|~C))+x[11]+3174756917&4294967295,R=g+(E<<10&4294967295|E>>>22),E=C+(g^(R|~_))+x[2]+718787259&4294967295,C=R+(E<<15&4294967295|E>>>17),E=_+(R^(C|~g))+x[9]+3951481745&4294967295,w.g[0]=w.g[0]+g&4294967295,w.g[1]=w.g[1]+(C+(E<<21&4294967295|E>>>11))&4294967295,w.g[2]=w.g[2]+C&4294967295,w.g[3]=w.g[3]+R&4294967295}r.prototype.u=function(w,g){g===void 0&&(g=w.length);for(var _=g-this.blockSize,x=this.B,C=this.h,R=0;R<g;){if(C==0)for(;R<=_;)s(this,w,R),R+=this.blockSize;if(typeof w=="string"){for(;R<g;)if(x[C++]=w.charCodeAt(R++),C==this.blockSize){s(this,x),C=0;break}}else for(;R<g;)if(x[C++]=w[R++],C==this.blockSize){s(this,x),C=0;break}}this.h=C,this.o+=g},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var g=1;g<w.length-8;++g)w[g]=0;var _=8*this.o;for(g=w.length-8;g<w.length;++g)w[g]=_&255,_/=256;for(this.u(w),w=Array(16),g=_=0;4>g;++g)for(var x=0;32>x;x+=8)w[_++]=this.g[g]>>>x&255;return w};function i(w,g){var _=l;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=g(w)}function a(w,g){this.h=g;for(var _=[],x=!0,C=w.length-1;0<=C;C--){var R=w[C]|0;x&&R==g||(_[C]=R,x=!1)}this.g=_}var l={};function c(w){return-128<=w&&128>w?i(w,function(g){return new a([g|0],0>g?-1:0)}):new a([w|0],0>w?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return y;if(0>w)return L(h(-w));for(var g=[],_=1,x=0;w>=_;x++)g[x]=w/_|0,_*=4294967296;return new a(g,0)}function p(w,g){if(w.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(w.charAt(0)=="-")return L(p(w.substring(1),g));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=h(Math.pow(g,8)),x=y,C=0;C<w.length;C+=8){var R=Math.min(8,w.length-C),E=parseInt(w.substring(C,C+R),g);8>R?(R=h(Math.pow(g,R)),x=x.j(R).add(h(E))):(x=x.j(_),x=x.add(h(E)))}return x}var y=c(0),m=c(1),S=c(16777216);t=a.prototype,t.m=function(){if(b(this))return-L(this).m();for(var w=0,g=1,_=0;_<this.g.length;_++){var x=this.i(_);w+=(0<=x?x:4294967296+x)*g,g*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(k(this))return"0";if(b(this))return"-"+L(this).toString(w);for(var g=h(Math.pow(w,6)),_=this,x="";;){var C=V(_,g).g;_=A(_,C.j(g));var R=((0<_.g.length?_.g[0]:_.h)>>>0).toString(w);if(_=C,k(_))return R+x;for(;6>R.length;)R="0"+R;x=R+x}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function k(w){if(w.h!=0)return!1;for(var g=0;g<w.g.length;g++)if(w.g[g]!=0)return!1;return!0}function b(w){return w.h==-1}t.l=function(w){return w=A(this,w),b(w)?-1:k(w)?0:1};function L(w){for(var g=w.g.length,_=[],x=0;x<g;x++)_[x]=~w.g[x];return new a(_,~w.h).add(m)}t.abs=function(){return b(this)?L(this):this},t.add=function(w){for(var g=Math.max(this.g.length,w.g.length),_=[],x=0,C=0;C<=g;C++){var R=x+(this.i(C)&65535)+(w.i(C)&65535),E=(R>>>16)+(this.i(C)>>>16)+(w.i(C)>>>16);x=E>>>16,R&=65535,E&=65535,_[C]=E<<16|R}return new a(_,_[_.length-1]&-2147483648?-1:0)};function A(w,g){return w.add(L(g))}t.j=function(w){if(k(this)||k(w))return y;if(b(this))return b(w)?L(this).j(L(w)):L(L(this).j(w));if(b(w))return L(this.j(L(w)));if(0>this.l(S)&&0>w.l(S))return h(this.m()*w.m());for(var g=this.g.length+w.g.length,_=[],x=0;x<2*g;x++)_[x]=0;for(x=0;x<this.g.length;x++)for(var C=0;C<w.g.length;C++){var R=this.i(x)>>>16,E=this.i(x)&65535,oe=w.i(C)>>>16,pe=w.i(C)&65535;_[2*x+2*C]+=E*pe,T(_,2*x+2*C),_[2*x+2*C+1]+=R*pe,T(_,2*x+2*C+1),_[2*x+2*C+1]+=E*oe,T(_,2*x+2*C+1),_[2*x+2*C+2]+=R*oe,T(_,2*x+2*C+2)}for(x=0;x<g;x++)_[x]=_[2*x+1]<<16|_[2*x];for(x=g;x<2*g;x++)_[x]=0;return new a(_,0)};function T(w,g){for(;(w[g]&65535)!=w[g];)w[g+1]+=w[g]>>>16,w[g]&=65535,g++}function I(w,g){this.g=w,this.h=g}function V(w,g){if(k(g))throw Error("division by zero");if(k(w))return new I(y,y);if(b(w))return g=V(L(w),g),new I(L(g.g),L(g.h));if(b(g))return g=V(w,L(g)),new I(L(g.g),g.h);if(30<w.g.length){if(b(w)||b(g))throw Error("slowDivide_ only works with positive integers.");for(var _=m,x=g;0>=x.l(w);)_=B(_),x=B(x);var C=F(_,1),R=F(x,1);for(x=F(x,2),_=F(_,2);!k(x);){var E=R.add(x);0>=E.l(w)&&(C=C.add(_),R=E),x=F(x,1),_=F(_,1)}return g=A(w,C.j(g)),new I(C,g)}for(C=y;0<=w.l(g);){for(_=Math.max(1,Math.floor(w.m()/g.m())),x=Math.ceil(Math.log(_)/Math.LN2),x=48>=x?1:Math.pow(2,x-48),R=h(_),E=R.j(g);b(E)||0<E.l(w);)_-=x,R=h(_),E=R.j(g);k(R)&&(R=m),C=C.add(R),w=A(w,E)}return new I(C,w)}t.A=function(w){return V(this,w).h},t.and=function(w){for(var g=Math.max(this.g.length,w.g.length),_=[],x=0;x<g;x++)_[x]=this.i(x)&w.i(x);return new a(_,this.h&w.h)},t.or=function(w){for(var g=Math.max(this.g.length,w.g.length),_=[],x=0;x<g;x++)_[x]=this.i(x)|w.i(x);return new a(_,this.h|w.h)},t.xor=function(w){for(var g=Math.max(this.g.length,w.g.length),_=[],x=0;x<g;x++)_[x]=this.i(x)^w.i(x);return new a(_,this.h^w.h)};function B(w){for(var g=w.g.length+1,_=[],x=0;x<g;x++)_[x]=w.i(x)<<1|w.i(x-1)>>>31;return new a(_,w.h)}function F(w,g){var _=g>>5;g%=32;for(var x=w.g.length-_,C=[],R=0;R<x;R++)C[R]=0<g?w.i(R+_)>>>g|w.i(R+_+1)<<32-g:w.i(R+_);return new a(C,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,P0=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,js=a}).apply(typeof gg<"u"?gg:typeof self<"u"?self:typeof window<"u"?window:{});var ll=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var D0,Co,j0,El,jd,N0,M0,V0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,d,f){return o==Array.prototype||o==Object.prototype||(o[d]=f.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof ll=="object"&&ll];for(var d=0;d<o.length;++d){var f=o[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(o,d){if(d)e:{var f=r;o=o.split(".");for(var v=0;v<o.length-1;v++){var j=o[v];if(!(j in f))break e;f=f[j]}o=o[o.length-1],v=f[o],d=d(v),d!=v&&d!=null&&e(f,o,{configurable:!0,writable:!0,value:d})}}function i(o,d){o instanceof String&&(o+="");var f=0,v=!1,j={next:function(){if(!v&&f<o.length){var O=f++;return{value:d(O,o[O]),done:!1}}return v=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}s("Array.prototype.values",function(o){return o||function(){return i(this,function(d,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function c(o){var d=typeof o;return d=d!="object"?d:o?Array.isArray(o)?"array":d:"null",d=="array"||d=="object"&&typeof o.length=="number"}function h(o){var d=typeof o;return d=="object"&&o!=null||d=="function"}function p(o,d,f){return o.call.apply(o.bind,arguments)}function y(o,d,f){if(!o)throw Error();if(2<arguments.length){var v=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,v),o.apply(d,j)}}return function(){return o.apply(d,arguments)}}function m(o,d,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:y,m.apply(null,arguments)}function S(o,d){var f=Array.prototype.slice.call(arguments,1);return function(){var v=f.slice();return v.push.apply(v,arguments),o.apply(this,v)}}function k(o,d){function f(){}f.prototype=d.prototype,o.aa=d.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(v,j,O){for(var Z=Array(arguments.length-2),$e=2;$e<arguments.length;$e++)Z[$e-2]=arguments[$e];return d.prototype[j].apply(v,Z)}}function b(o){const d=o.length;if(0<d){const f=Array(d);for(let v=0;v<d;v++)f[v]=o[v];return f}return[]}function L(o,d){for(let f=1;f<arguments.length;f++){const v=arguments[f];if(c(v)){const j=o.length||0,O=v.length||0;o.length=j+O;for(let Z=0;Z<O;Z++)o[j+Z]=v[Z]}else o.push(v)}}class A{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function T(o){return/^[\s\xa0]*$/.test(o)}function I(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function V(o){return V[" "](o),o}V[" "]=function(){};var B=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function F(o,d,f){for(const v in o)d.call(f,o[v],v,o)}function w(o,d){for(const f in o)d.call(void 0,o[f],f,o)}function g(o){const d={};for(const f in o)d[f]=o[f];return d}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(o,d){let f,v;for(let j=1;j<arguments.length;j++){v=arguments[j];for(f in v)o[f]=v[f];for(let O=0;O<_.length;O++)f=_[O],Object.prototype.hasOwnProperty.call(v,f)&&(o[f]=v[f])}}function C(o){var d=1;o=o.split(":");const f=[];for(;0<d&&o.length;)f.push(o.shift()),d--;return o.length&&f.push(o.join(":")),f}function R(o){l.setTimeout(()=>{throw o},0)}function E(){var o=W;let d=null;return o.g&&(d=o.g,o.g=o.g.next,o.g||(o.h=null),d.next=null),d}class oe{constructor(){this.h=this.g=null}add(d,f){const v=pe.get();v.set(d,f),this.h?this.h.next=v:this.g=v,this.h=v}}var pe=new A(()=>new Ee,o=>o.reset());class Ee{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,D=!1,W=new oe,P=()=>{const o=l.Promise.resolve(void 0);ee=()=>{o.then(M)}};var M=()=>{for(var o;o=E();){try{o.h.call(o.g)}catch(f){R(f)}var d=pe;d.j(o),100>d.h&&(d.h++,o.next=d.g,d.g=o)}D=!1};function U(){this.s=this.s,this.C=this.C}U.prototype.s=!1,U.prototype.ma=function(){this.s||(this.s=!0,this.N())},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function $(o,d){this.type=o,this.g=this.target=d,this.defaultPrevented=!1}$.prototype.h=function(){this.defaultPrevented=!0};var Y=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,d=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};l.addEventListener("test",f,d),l.removeEventListener("test",f,d)}catch{}return o}();function te(o,d){if($.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,v=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=d,d=o.relatedTarget){if(B){e:{try{V(d.nodeName);var j=!0;break e}catch{}j=!1}j||(d=null)}}else f=="mouseover"?d=o.fromElement:f=="mouseout"&&(d=o.toElement);this.relatedTarget=d,v?(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:q[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&te.aa.h.call(this)}}k(te,$);var q={2:"touch",3:"pen",4:"mouse"};te.prototype.h=function(){te.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var re="closure_listenable_"+(1e6*Math.random()|0),Se=0;function ye(o,d,f,v,j){this.listener=o,this.proxy=null,this.src=d,this.type=f,this.capture=!!v,this.ha=j,this.key=++Se,this.da=this.fa=!1}function Ae(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function me(o){this.src=o,this.g={},this.h=0}me.prototype.add=function(o,d,f,v,j){var O=o.toString();o=this.g[O],o||(o=this.g[O]=[],this.h++);var Z=Re(o,d,v,j);return-1<Z?(d=o[Z],f||(d.fa=!1)):(d=new ye(d,this.src,O,!!v,j),d.fa=f,o.push(d)),d};function ne(o,d){var f=d.type;if(f in o.g){var v=o.g[f],j=Array.prototype.indexOf.call(v,d,void 0),O;(O=0<=j)&&Array.prototype.splice.call(v,j,1),O&&(Ae(d),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Re(o,d,f,v){for(var j=0;j<o.length;++j){var O=o[j];if(!O.da&&O.listener==d&&O.capture==!!f&&O.ha==v)return j}return-1}var de="closure_lm_"+(1e6*Math.random()|0),ge={};function be(o,d,f,v,j){if(Array.isArray(d)){for(var O=0;O<d.length;O++)be(o,d[O],f,v,j);return null}return f=Gs(f),o&&o[re]?o.K(d,f,h(v)?!!v.capture:!1,j):st(o,d,f,!1,v,j)}function st(o,d,f,v,j,O){if(!d)throw Error("Invalid event type");var Z=h(j)?!!j.capture:!!j,$e=Cr(o);if($e||(o[de]=$e=new me(o)),f=$e.add(d,f,v,Z,O),f.proxy)return f;if(v=qt(),f.proxy=v,v.src=o,v.listener=f,o.addEventListener)Y||(j=Z),j===void 0&&(j=!1),o.addEventListener(d.toString(),v,j);else if(o.attachEvent)o.attachEvent(Ir(d.toString()),v);else if(o.addListener&&o.removeListener)o.addListener(v);else throw Error("addEventListener and attachEvent are unavailable.");return f}function qt(){function o(f){return d.call(o.src,o.listener,f)}const d=qs;return o}function Zt(o,d,f,v,j){if(Array.isArray(d))for(var O=0;O<d.length;O++)Zt(o,d[O],f,v,j);else v=h(v)?!!v.capture:!!v,f=Gs(f),o&&o[re]?(o=o.i,d=String(d).toString(),d in o.g&&(O=o.g[d],f=Re(O,f,v,j),-1<f&&(Ae(O[f]),Array.prototype.splice.call(O,f,1),O.length==0&&(delete o.g[d],o.h--)))):o&&(o=Cr(o))&&(d=o.g[d.toString()],o=-1,d&&(o=Re(d,f,v,j)),(f=-1<o?d[o]:null)&&Vt(f))}function Vt(o){if(typeof o!="number"&&o&&!o.da){var d=o.src;if(d&&d[re])ne(d.i,o);else{var f=o.type,v=o.proxy;d.removeEventListener?d.removeEventListener(f,v,o.capture):d.detachEvent?d.detachEvent(Ir(f),v):d.addListener&&d.removeListener&&d.removeListener(v),(f=Cr(d))?(ne(f,o),f.h==0&&(f.src=null,d[de]=null)):Ae(o)}}}function Ir(o){return o in ge?ge[o]:ge[o]="on"+o}function qs(o,d){if(o.da)o=!0;else{d=new te(d,this);var f=o.listener,v=o.ha||o.src;o.fa&&Vt(o),o=f.call(v,d)}return o}function Cr(o){return o=o[de],o instanceof me?o:null}var nr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gs(o){return typeof o=="function"?o:(o[nr]||(o[nr]=function(d){return o.handleEvent(d)}),o[nr])}function ct(){U.call(this),this.i=new me(this),this.M=this,this.F=null}k(ct,U),ct.prototype[re]=!0,ct.prototype.removeEventListener=function(o,d,f,v){Zt(this,o,d,f,v)};function Tt(o,d){var f,v=o.F;if(v)for(f=[];v;v=v.F)f.push(v);if(o=o.M,v=d.type||d,typeof d=="string")d=new $(d,o);else if(d instanceof $)d.target=d.target||o;else{var j=d;d=new $(v,o),x(d,j)}if(j=!0,f)for(var O=f.length-1;0<=O;O--){var Z=d.g=f[O];j=kr(Z,v,!0,d)&&j}if(Z=d.g=o,j=kr(Z,v,!0,d)&&j,j=kr(Z,v,!1,d)&&j,f)for(O=0;O<f.length;O++)Z=d.g=f[O],j=kr(Z,v,!1,d)&&j}ct.prototype.N=function(){if(ct.aa.N.call(this),this.i){var o=this.i,d;for(d in o.g){for(var f=o.g[d],v=0;v<f.length;v++)Ae(f[v]);delete o.g[d],o.h--}}this.F=null},ct.prototype.K=function(o,d,f,v){return this.i.add(String(o),d,!1,f,v)},ct.prototype.L=function(o,d,f,v){return this.i.add(String(o),d,!0,f,v)};function kr(o,d,f,v){if(d=o.i.g[String(d)],!d)return!0;d=d.concat();for(var j=!0,O=0;O<d.length;++O){var Z=d[O];if(Z&&!Z.da&&Z.capture==f){var $e=Z.listener,Ct=Z.ha||Z.src;Z.fa&&ne(o.i,Z),j=$e.call(Ct,v)!==!1&&j}}return j&&!v.defaultPrevented}function ba(o,d,f){if(typeof o=="function")f&&(o=m(o,f));else if(o&&typeof o.handleEvent=="function")o=m(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:l.setTimeout(o,d||0)}function Qs(o){o.g=ba(()=>{o.g=null,o.i&&(o.i=!1,Qs(o))},o.l);const d=o.h;o.h=null,o.m.apply(null,d)}class hs extends U{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Qs(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wn(o){U.call(this),this.h=o,this.g={}}k(Wn,U);var Ze=[];function Pa(o){F(o.g,function(d,f){this.g.hasOwnProperty(f)&&Vt(d)},o),o.g={}}Wn.prototype.N=function(){Wn.aa.N.call(this),Pa(this)},Wn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var so=l.JSON.stringify,Da=l.JSON.parse,rr=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function fs(){}fs.prototype.h=null;function ps(o){return o.h||(o.h=o.i())}function Ks(){}var ae={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Cn(){$.call(this,"d")}k(Cn,$);function sr(){$.call(this,"c")}k(sr,$);var kn={},Uu=null;function Ar(){return Uu=Uu||new ct}kn.La="serverreachability";function $u(o){$.call(this,kn.La,o)}k($u,$);function ir(o){const d=Ar();Tt(d,new $u(d))}kn.STAT_EVENT="statevent";function ln(o,d){$.call(this,kn.STAT_EVENT,o),this.stat=d}k(ln,$);function dt(o){const d=Ar();Tt(d,new ln(d,o))}kn.Ma="timingevent";function Ce(o,d){$.call(this,kn.Ma,o),this.size=d}k(Ce,$);function gs(o,d){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},d)}function Et(){this.g=!0}Et.prototype.xa=function(){this.g=!1};function Rr(o,d,f,v,j,O){o.info(function(){if(o.g)if(O)for(var Z="",$e=O.split("&"),Ct=0;Ct<$e.length;Ct++){var Me=$e[Ct].split("=");if(1<Me.length){var Ft=Me[0];Me=Me[1];var Ot=Ft.split("_");Z=2<=Ot.length&&Ot[1]=="type"?Z+(Ft+"="+Me+"&"):Z+(Ft+"=redacted&")}}else Z=null;else Z=O;return"XMLHTTP REQ ("+v+") [attempt "+j+"]: "+d+`
`+f+`
`+Z})}function An(o,d,f,v,j,O,Z){o.info(function(){return"XMLHTTP RESP ("+v+") [ attempt "+j+"]: "+d+`
`+f+`
`+O+" "+Z})}function un(o,d,f,v){o.info(function(){return"XMLHTTP TEXT ("+d+"): "+Hu(o,f)+(v?" "+v:"")})}function Wu(o,d){o.info(function(){return"TIMEOUT: "+d})}Et.prototype.info=function(){};function Hu(o,d){if(!o.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var v=f[o];if(!(2>v.length)){var j=v[1];if(Array.isArray(j)&&!(1>j.length)){var O=j[0];if(O!="noop"&&O!="stop"&&O!="close")for(var Z=1;Z<j.length;Z++)j[Z]=""}}}}return so(f)}catch{return d}}var io={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},qu={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ys;function br(){}k(br,fs),br.prototype.g=function(){return new XMLHttpRequest},br.prototype.i=function(){return{}},Ys=new br;function Rn(o,d,f,v){this.j=o,this.i=d,this.l=f,this.R=v||1,this.U=new Wn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Xs}function Xs(){this.i=null,this.g="",this.h=!1}var Pr={},Js={};function Zs(o,d,f){o.L=1,o.v=_s(xn(d)),o.m=f,o.P=!0,ja(o,null)}function ja(o,d){o.F=Date.now(),Dr(o),o.A=xn(o.v);var f=o.A,v=o.R;Array.isArray(v)||(v=[String(v)]),qn(f.i,"t",v),o.C=0,f=o.j.J,o.h=new Xs,o.g=qf(o.j,f?d:null,!o.m),0<o.O&&(o.M=new hs(m(o.Y,o,o.g),o.O)),d=o.U,f=o.g,v=o.ca;var j="readystatechange";Array.isArray(j)||(j&&(Ze[0]=j.toString()),j=Ze);for(var O=0;O<j.length;O++){var Z=be(f,j[O],v||d.handleEvent,!1,d.h||d);if(!Z)break;d.g[Z.key]=Z}d=o.H?g(o.H):{},o.m?(o.u||(o.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,d)):(o.u="GET",o.g.ea(o.A,o.u,null,d)),ir(),Rr(o.i,o.u,o.A,o.l,o.R,o.m)}Rn.prototype.ca=function(o){o=o.target;const d=this.M;d&&ar(o)==3?d.j():this.Y(o)},Rn.prototype.Y=function(o){try{if(o==this.g)e:{const Ot=ar(this.g);var d=this.g.Ba();const ci=this.g.Z();if(!(3>Ot)&&(Ot!=3||this.g&&(this.h.h||this.g.oa()||Mf(this.g)))){this.J||Ot!=4||d==7||(d==8||0>=ci?ir(3):ir(2)),ao(this);var f=this.g.Z();this.X=f;t:if(ei(this)){var v=Mf(this.g);o="";var j=v.length,O=ar(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){cn(this),ys(this);var Z="";break t}this.h.i=new l.TextDecoder}for(d=0;d<j;d++)this.h.h=!0,o+=this.h.i.decode(v[d],{stream:!(O&&d==j-1)});v.length=0,this.h.g+=o,this.C=0,Z=this.h.g}else Z=this.g.oa();if(this.o=f==200,An(this.i,this.u,this.A,this.l,this.R,Ot,f),this.o){if(this.T&&!this.K){t:{if(this.g){var $e,Ct=this.g;if(($e=Ct.g?Ct.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T($e)){var Me=$e;break t}}Me=null}if(f=Me)un(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hn(this,f);else{this.o=!1,this.s=3,dt(12),cn(this),ys(this);break e}}if(this.P){f=!0;let Dn;for(;!this.J&&this.C<Z.length;)if(Dn=ms(this,Z),Dn==Js){Ot==4&&(this.s=4,dt(14),f=!1),un(this.i,this.l,null,"[Incomplete Response]");break}else if(Dn==Pr){this.s=4,dt(15),un(this.i,this.l,Z,"[Invalid Chunk]"),f=!1;break}else un(this.i,this.l,Dn,null),Hn(this,Dn);if(ei(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ot!=4||Z.length!=0||this.h.h||(this.s=1,dt(16),f=!1),this.o=this.o&&f,!f)un(this.i,this.l,Z,"[Invalid Chunked Response]"),cn(this),ys(this);else if(0<Z.length&&!this.W){this.W=!0;var Ft=this.j;Ft.g==this&&Ft.ba&&!Ft.M&&(Ft.j.info("Great, no buffering proxy detected. Bytes received: "+Z.length),Yu(Ft),Ft.M=!0,dt(11))}}else un(this.i,this.l,Z,null),Hn(this,Z);Ot==4&&cn(this),this.o&&!this.J&&(Ot==4?Uf(this.j,this):(this.o=!1,Dr(this)))}else nx(this.g),f==400&&0<Z.indexOf("Unknown SID")?(this.s=3,dt(12)):(this.s=0,dt(13)),cn(this),ys(this)}}}catch{}finally{}};function ei(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function ms(o,d){var f=o.C,v=d.indexOf(`
`,f);return v==-1?Js:(f=Number(d.substring(f,v)),isNaN(f)?Pr:(v+=1,v+f>d.length?Js:(d=d.slice(v,v+f),o.C=v+f,d)))}Rn.prototype.cancel=function(){this.J=!0,cn(this)};function Dr(o){o.S=Date.now()+o.I,oo(o,o.I)}function oo(o,d){if(o.B!=null)throw Error("WatchDog timer not null");o.B=gs(m(o.ba,o),d)}function ao(o){o.B&&(l.clearTimeout(o.B),o.B=null)}Rn.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(Wu(this.i,this.A),this.L!=2&&(ir(),dt(17)),cn(this),this.s=2,ys(this)):oo(this,this.S-o)};function ys(o){o.j.G==0||o.J||Uf(o.j,o)}function cn(o){ao(o);var d=o.M;d&&typeof d.ma=="function"&&d.ma(),o.M=null,Pa(o.U),o.g&&(d=o.g,o.g=null,d.abort(),d.ma())}function Hn(o,d){try{var f=o.j;if(f.G!=0&&(f.g==o||ti(f.h,o))){if(!o.K&&ti(f.h,o)&&f.G==3){try{var v=f.Da.g.parse(d)}catch{v=null}if(Array.isArray(v)&&v.length==3){var j=v;if(j[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)Ua(f),za(f);else break e;Ku(f),dt(18)}}else f.za=j[1],0<f.za-f.T&&37500>j[2]&&f.F&&f.v==0&&!f.C&&(f.C=gs(m(f.Za,f),6e3));if(1>=vs(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Ts(f,11)}else if((o.K||f.g==o)&&Ua(f),!T(d))for(j=f.Da.g.parse(d),d=0;d<j.length;d++){let Me=j[d];if(f.T=Me[0],Me=Me[1],f.G==2)if(Me[0]=="c"){f.K=Me[1],f.ia=Me[2];const Ft=Me[3];Ft!=null&&(f.la=Ft,f.j.info("VER="+f.la));const Ot=Me[4];Ot!=null&&(f.Aa=Ot,f.j.info("SVER="+f.Aa));const ci=Me[5];ci!=null&&typeof ci=="number"&&0<ci&&(v=1.5*ci,f.L=v,f.j.info("backChannelRequestTimeoutMs_="+v)),v=f;const Dn=o.g;if(Dn){const Wa=Dn.g?Dn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wa){var O=v.h;O.g||Wa.indexOf("spdy")==-1&&Wa.indexOf("quic")==-1&&Wa.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(ni(O,O.h),O.h=null))}if(v.D){const Xu=Dn.g?Dn.g.getResponseHeader("X-HTTP-Session-Id"):null;Xu&&(v.ya=Xu,Ue(v.I,v.D,Xu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),v=f;var Z=o;if(v.qa=Hf(v,v.J?v.ia:null,v.W),Z.K){Va(v.h,Z);var $e=Z,Ct=v.L;Ct&&($e.I=Ct),$e.B&&(ao($e),Dr($e)),v.g=Z}else zf(v);0<f.i.length&&Ba(f)}else Me[0]!="stop"&&Me[0]!="close"||Ts(f,7);else f.G==3&&(Me[0]=="stop"||Me[0]=="close"?Me[0]=="stop"?Ts(f,7):Qu(f):Me[0]!="noop"&&f.l&&f.l.ta(Me),f.v=0)}}ir(4)}catch{}}var jf=class{constructor(o,d){this.g=o,this.map=d}};function Na(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ma(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function vs(o){return o.h?1:o.g?o.g.size:0}function ti(o,d){return o.h?o.h==d:o.g?o.g.has(d):!1}function ni(o,d){o.g?o.g.add(d):o.h=d}function Va(o,d){o.h&&o.h==d?o.h=null:o.g&&o.g.has(d)&&o.g.delete(d)}Na.prototype.cancel=function(){if(this.i=La(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function La(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let d=o.i;for(const f of o.g.values())d=d.concat(f.D);return d}return b(o.i)}function lo(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(c(o)){for(var d=[],f=o.length,v=0;v<f;v++)d.push(o[v]);return d}d=[],f=0;for(v in o)d[f++]=o[v];return d}function bn(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(c(o)||typeof o=="string"){var d=[];o=o.length;for(var f=0;f<o;f++)d.push(f);return d}d=[],f=0;for(const v in o)d[f++]=v;return d}}}function Pn(o,d){if(o.forEach&&typeof o.forEach=="function")o.forEach(d,void 0);else if(c(o)||typeof o=="string")Array.prototype.forEach.call(o,d,void 0);else for(var f=bn(o),v=lo(o),j=v.length,O=0;O<j;O++)d.call(void 0,v[O],f&&f[O],o)}var xs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fa(o,d){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var v=o[f].indexOf("="),j=null;if(0<=v){var O=o[f].substring(0,v);j=o[f].substring(v+1)}else O=o[f];d(O,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Gt(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Gt){this.h=o.h,or(this,o.j),this.o=o.o,this.g=o.g,ri(this,o.s),this.l=o.l;var d=o.i,f=new Le;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),uo(this,f),this.m=o.m}else o&&(d=String(o).match(xs))?(this.h=!1,or(this,d[1]||"",!0),this.o=G(d[2]||""),this.g=G(d[3]||"",!0),ri(this,d[4]),this.l=G(d[5]||"",!0),uo(this,d[6]||"",!0),this.m=G(d[7]||"")):(this.h=!1,this.i=new Le(null,this.h))}Gt.prototype.toString=function(){var o=[],d=this.j;d&&o.push(z(d,K,!0),":");var f=this.g;return(f||d=="file")&&(o.push("//"),(d=this.o)&&o.push(z(d,K,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(z(f,f.charAt(0)=="/"?ue:le,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",z(f,Te)),o.join("")};function xn(o){return new Gt(o)}function or(o,d,f){o.j=f?G(d,!0):d,o.j&&(o.j=o.j.replace(/:$/,""))}function ri(o,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);o.s=d}else o.s=null}function uo(o,d,f){d instanceof Le?(o.i=d,He(o.i,o.h)):(f||(d=z(d,he)),o.i=new Le(d,o.h))}function Ue(o,d,f){o.i.set(d,f)}function _s(o){return Ue(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function G(o,d){return o?d?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function z(o,d,f){return typeof o=="string"?(o=encodeURI(o).replace(d,Q),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Q(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var K=/[#\/\?@]/g,le=/[#\?:]/g,ue=/[#\?]/g,he=/[#\?@]/g,Te=/#/g;function Le(o,d){this.h=this.g=null,this.i=o||null,this.j=!!d}function Fe(o){o.g||(o.g=new Map,o.h=0,o.i&&Fa(o.i,function(d,f){o.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}t=Le.prototype,t.add=function(o,d){Fe(this),this.i=null,o=ht(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(d),this.h+=1,this};function It(o,d){Fe(o),d=ht(o,d),o.g.has(d)&&(o.i=null,o.h-=o.g.get(d).length,o.g.delete(d))}function mt(o,d){return Fe(o),d=ht(o,d),o.g.has(d)}t.forEach=function(o,d){Fe(this),this.g.forEach(function(f,v){f.forEach(function(j){o.call(d,j,v,this)},this)},this)},t.na=function(){Fe(this);const o=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let v=0;v<d.length;v++){const j=o[v];for(let O=0;O<j.length;O++)f.push(d[v])}return f},t.V=function(o){Fe(this);let d=[];if(typeof o=="string")mt(this,o)&&(d=d.concat(this.g.get(ht(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)d=d.concat(o[f])}return d},t.set=function(o,d){return Fe(this),this.i=null,o=ht(this,o),mt(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[d]),this.h+=1,this},t.get=function(o,d){return o?(o=this.V(o),0<o.length?String(o[0]):d):d};function qn(o,d,f){It(o,d),0<f.length&&(o.i=null,o.g.set(ht(o,d),b(f)),o.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var v=d[f];const O=encodeURIComponent(String(v)),Z=this.V(v);for(v=0;v<Z.length;v++){var j=O;Z[v]!==""&&(j+="="+encodeURIComponent(String(Z[v]))),o.push(j)}}return this.i=o.join("&")};function ht(o,d){return d=String(d),o.j&&(d=d.toLowerCase()),d}function He(o,d){d&&!o.j&&(Fe(o),o.i=null,o.g.forEach(function(f,v){var j=v.toLowerCase();v!=j&&(It(this,v),qn(this,j,f))},o)),o.j=d}function jr(o,d){const f=new Et;if(l.Image){const v=new Image;v.onload=S(Pe,f,"TestLoadImage: loaded",!0,d,v),v.onerror=S(Pe,f,"TestLoadImage: error",!1,d,v),v.onabort=S(Pe,f,"TestLoadImage: abort",!1,d,v),v.ontimeout=S(Pe,f,"TestLoadImage: timeout",!1,d,v),l.setTimeout(function(){v.ontimeout&&v.ontimeout()},1e4),v.src=o}else d(!1)}function si(o,d){const f=new Et,v=new AbortController,j=setTimeout(()=>{v.abort(),Pe(f,"TestPingServer: timeout",!1,d)},1e4);fetch(o,{signal:v.signal}).then(O=>{clearTimeout(j),O.ok?Pe(f,"TestPingServer: ok",!0,d):Pe(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(j),Pe(f,"TestPingServer: error",!1,d)})}function Pe(o,d,f,v,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),v(f)}catch{}}function Gn(){this.g=new rr}function Oa(o,d,f){const v=f||"";try{Pn(o,function(j,O){let Z=j;h(j)&&(Z=so(j)),d.push(v+O+"="+encodeURIComponent(Z))})}catch(j){throw d.push(v+"type="+encodeURIComponent("_badmap")),j}}function Nr(o){this.l=o.Ub||null,this.j=o.eb||!1}k(Nr,fs),Nr.prototype.g=function(){return new ii(this.l,this.j)},Nr.prototype.i=function(o){return function(){return o}}({});function ii(o,d){ct.call(this),this.D=o,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(ii,ct),t=ii.prototype,t.open=function(o,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=d,this.readyState=1,ws(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(d.body=o),(this.D||l).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Lt(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,ws(this)),this.g&&(this.readyState=3,ws(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;oi(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function oi(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var d=o.value?o.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!o.done}))&&(this.response=this.responseText+=d)}o.done?Lt(this):ws(this),this.readyState==3&&oi(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,Lt(this))},t.Qa=function(o){this.g&&(this.response=o,Lt(this))},t.ga=function(){this.g&&Lt(this)};function Lt(o){o.readyState=4,o.l=null,o.j=null,o.v=null,ws(o)}t.setRequestHeader=function(o,d){this.u.append(o,d)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=d.next();return o.join(`\r
`)};function ws(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(ii.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Gu(o){let d="";return F(o,function(f,v){d+=v,d+=":",d+=f,d+=`\r
`}),d}function ai(o,d,f){e:{for(v in f){var v=!1;break e}v=!0}v||(f=Gu(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):Ue(o,d,f))}function qe(o){ct.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(qe,ct);var xe=/^https?$/i,Ye=["POST","PUT"];t=qe.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,d,f,v){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);d=d?d.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ys.g(),this.v=this.o?ps(this.o):ps(Ys),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(o),!0),this.B=!1}catch(O){it(this,O);return}if(o=f||"",f=new Map(this.headers),v)if(Object.getPrototypeOf(v)===Object.prototype)for(var j in v)f.set(j,v[j]);else if(typeof v.keys=="function"&&typeof v.get=="function")for(const O of v.keys())f.set(O,v.get(O));else throw Error("Unknown input type for opt_headers: "+String(v));v=Array.from(f.keys()).find(O=>O.toLowerCase()=="content-type"),j=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Ye,d,void 0))||v||j||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[O,Z]of f)this.g.setRequestHeader(O,Z);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Nf(this),this.u=!0,this.g.send(o),this.u=!1}catch(O){it(this,O)}};function it(o,d){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=d,o.m=5,Ss(o),Mr(o)}function Ss(o){o.A||(o.A=!0,Tt(o,"complete"),Tt(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Tt(this,"complete"),Tt(this,"abort"),Mr(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mr(this,!0)),qe.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?li(this):this.bb())},t.bb=function(){li(this)};function li(o){if(o.h&&typeof a<"u"&&(!o.v[1]||ar(o)!=4||o.Z()!=2)){if(o.u&&ar(o)==4)ba(o.Ea,0,o);else if(Tt(o,"readystatechange"),ar(o)==4){o.h=!1;try{const Z=o.Z();e:switch(Z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var v;if(v=Z===0){var j=String(o.D).match(xs)[1]||null;!j&&l.self&&l.self.location&&(j=l.self.location.protocol.slice(0,-1)),v=!xe.test(j?j.toLowerCase():"")}f=v}if(f)Tt(o,"complete"),Tt(o,"success");else{o.m=6;try{var O=2<ar(o)?o.g.statusText:""}catch{O=""}o.l=O+" ["+o.Z()+"]",Ss(o)}}finally{Mr(o)}}}}function Mr(o,d){if(o.g){Nf(o);const f=o.g,v=o.v[0]?()=>{}:null;o.g=null,o.v=null,d||Tt(o,"ready");try{f.onreadystatechange=v}catch{}}}function Nf(o){o.I&&(l.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function ar(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<ar(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var d=this.g.responseText;return o&&d.indexOf(o)==0&&(d=d.substring(o.length)),Da(d)}};function Mf(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function nx(o){const d={};o=(o.g&&2<=ar(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let v=0;v<o.length;v++){if(T(o[v]))continue;var f=C(o[v]);const j=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const O=d[j]||[];d[j]=O,O.push(f)}w(d,function(v){return v.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function co(o,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||d}function Vf(o){this.Aa=0,this.i=[],this.j=new Et,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=co("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=co("baseRetryDelayMs",5e3,o),this.cb=co("retryDelaySeedMs",1e4,o),this.Wa=co("forwardChannelMaxRetries",2,o),this.wa=co("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Na(o&&o.concurrentRequestLimit),this.Da=new Gn,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Vf.prototype,t.la=8,t.G=1,t.connect=function(o,d,f,v){dt(0),this.W=o,this.H=d||{},f&&v!==void 0&&(this.H.OSID=f,this.H.OAID=v),this.F=this.X,this.I=Hf(this,null,this.W),Ba(this)};function Qu(o){if(Lf(o),o.G==3){var d=o.U++,f=xn(o.I);if(Ue(f,"SID",o.K),Ue(f,"RID",d),Ue(f,"TYPE","terminate"),ho(o,f),d=new Rn(o,o.j,d),d.L=2,d.v=_s(xn(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=d.v,f=!0),f||(d.g=qf(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Dr(d)}Wf(o)}function za(o){o.g&&(Yu(o),o.g.cancel(),o.g=null)}function Lf(o){za(o),o.u&&(l.clearTimeout(o.u),o.u=null),Ua(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function Ba(o){if(!Ma(o.h)&&!o.s){o.s=!0;var d=o.Ga;ee||P(),D||(ee(),D=!0),W.add(d,o),o.B=0}}function rx(o,d){return vs(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=d.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=gs(m(o.Ga,o,d),$f(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const j=new Rn(this,this.j,o);let O=this.o;if(this.S&&(O?(O=g(O),x(O,this.S)):O=this.S),this.m!==null||this.O||(j.H=O,O=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var v=this.i[f];if("__data__"in v.map&&(v=v.map.__data__,typeof v=="string")){v=v.length;break t}v=void 0}if(v===void 0)break;if(d+=v,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=Of(this,j,d),f=xn(this.I),Ue(f,"RID",o),Ue(f,"CVER",22),this.D&&Ue(f,"X-HTTP-Session-Id",this.D),ho(this,f),O&&(this.O?d="headers="+encodeURIComponent(String(Gu(O)))+"&"+d:this.m&&ai(f,this.m,O)),ni(this.h,j),this.Ua&&Ue(f,"TYPE","init"),this.P?(Ue(f,"$req",d),Ue(f,"SID","null"),j.T=!0,Zs(j,f,null)):Zs(j,f,d),this.G=2}}else this.G==3&&(o?Ff(this,o):this.i.length==0||Ma(this.h)||Ff(this))};function Ff(o,d){var f;d?f=d.l:f=o.U++;const v=xn(o.I);Ue(v,"SID",o.K),Ue(v,"RID",f),Ue(v,"AID",o.T),ho(o,v),o.m&&o.o&&ai(v,o.m,o.o),f=new Rn(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),d&&(o.i=d.D.concat(o.i)),d=Of(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),ni(o.h,f),Zs(f,v,d)}function ho(o,d){o.H&&F(o.H,function(f,v){Ue(d,v,f)}),o.l&&Pn({},function(f,v){Ue(d,v,f)})}function Of(o,d,f){f=Math.min(o.i.length,f);var v=o.l?m(o.l.Na,o.l,o):null;e:{var j=o.i;let O=-1;for(;;){const Z=["count="+f];O==-1?0<f?(O=j[0].g,Z.push("ofs="+O)):O=0:Z.push("ofs="+O);let $e=!0;for(let Ct=0;Ct<f;Ct++){let Me=j[Ct].g;const Ft=j[Ct].map;if(Me-=O,0>Me)O=Math.max(0,j[Ct].g-100),$e=!1;else try{Oa(Ft,Z,"req"+Me+"_")}catch{v&&v(Ft)}}if($e){v=Z.join("&");break e}}}return o=o.i.splice(0,f),d.D=o,v}function zf(o){if(!o.g&&!o.u){o.Y=1;var d=o.Fa;ee||P(),D||(ee(),D=!0),W.add(d,o),o.v=0}}function Ku(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=gs(m(o.Fa,o),$f(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,Bf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=gs(m(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,dt(10),za(this),Bf(this))};function Yu(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function Bf(o){o.g=new Rn(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var d=xn(o.qa);Ue(d,"RID","rpc"),Ue(d,"SID",o.K),Ue(d,"AID",o.T),Ue(d,"CI",o.F?"0":"1"),!o.F&&o.ja&&Ue(d,"TO",o.ja),Ue(d,"TYPE","xmlhttp"),ho(o,d),o.m&&o.o&&ai(d,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=_s(xn(d)),f.m=null,f.P=!0,ja(f,o)}t.Za=function(){this.C!=null&&(this.C=null,za(this),Ku(this),dt(19))};function Ua(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function Uf(o,d){var f=null;if(o.g==d){Ua(o),Yu(o),o.g=null;var v=2}else if(ti(o.h,d))f=d.D,Va(o.h,d),v=1;else return;if(o.G!=0){if(d.o)if(v==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var j=o.B;v=Ar(),Tt(v,new Ce(v,f)),Ba(o)}else zf(o);else if(j=d.s,j==3||j==0&&0<d.X||!(v==1&&rx(o,d)||v==2&&Ku(o)))switch(f&&0<f.length&&(d=o.h,d.i=d.i.concat(f)),j){case 1:Ts(o,5);break;case 4:Ts(o,10);break;case 3:Ts(o,6);break;default:Ts(o,2)}}}function $f(o,d){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*d}function Ts(o,d){if(o.j.info("Error code "+d),d==2){var f=m(o.fb,o),v=o.Xa;const j=!v;v=new Gt(v||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||or(v,"https"),_s(v),j?jr(v.toString(),f):si(v.toString(),f)}else dt(2);o.G=0,o.l&&o.l.sa(d),Wf(o),Lf(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),dt(2)):(this.j.info("Failed to ping google.com"),dt(1))};function Wf(o){if(o.G=0,o.ka=[],o.l){const d=La(o.h);(d.length!=0||o.i.length!=0)&&(L(o.ka,d),L(o.ka,o.i),o.h.i.length=0,b(o.i),o.i.length=0),o.l.ra()}}function Hf(o,d,f){var v=f instanceof Gt?xn(f):new Gt(f);if(v.g!="")d&&(v.g=d+"."+v.g),ri(v,v.s);else{var j=l.location;v=j.protocol,d=d?d+"."+j.hostname:j.hostname,j=+j.port;var O=new Gt(null);v&&or(O,v),d&&(O.g=d),j&&ri(O,j),f&&(O.l=f),v=O}return f=o.D,d=o.ya,f&&d&&Ue(v,f,d),Ue(v,"VER",o.la),ho(o,v),v}function qf(o,d,f){if(d&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=o.Ca&&!o.pa?new qe(new Nr({eb:f})):new qe(o.pa),d.Ha(o.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gf(){}t=Gf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function $a(){}$a.prototype.g=function(o,d){return new dn(o,d)};function dn(o,d){ct.call(this),this.g=new Vf(d),this.l=o,this.h=d&&d.messageUrlParams||null,o=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(o?o["X-WebChannel-Content-Type"]=d.messageContentType:o={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(o?o["X-WebChannel-Client-Profile"]=d.va:o={"X-WebChannel-Client-Profile":d.va}),this.g.S=o,(o=d&&d.Sb)&&!T(o)&&(this.g.m=o),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!T(d)&&(this.g.D=d,o=this.h,o!==null&&d in o&&(o=this.h,d in o&&delete o[d])),this.j=new ui(this)}k(dn,ct),dn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},dn.prototype.close=function(){Qu(this.g)},dn.prototype.o=function(o){var d=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=so(o),o=f);d.i.push(new jf(d.Ya++,o)),d.G==3&&Ba(d)},dn.prototype.N=function(){this.g.l=null,delete this.j,Qu(this.g),delete this.g,dn.aa.N.call(this)};function Qf(o){Cn.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var d=o.__sm__;if(d){e:{for(const f in d){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,d=d!==null&&o in d?d[o]:void 0),this.data=d}else this.data=o}k(Qf,Cn);function Kf(){sr.call(this),this.status=1}k(Kf,sr);function ui(o){this.g=o}k(ui,Gf),ui.prototype.ua=function(){Tt(this.g,"a")},ui.prototype.ta=function(o){Tt(this.g,new Qf(o))},ui.prototype.sa=function(o){Tt(this.g,new Kf)},ui.prototype.ra=function(){Tt(this.g,"b")},$a.prototype.createWebChannel=$a.prototype.g,dn.prototype.send=dn.prototype.o,dn.prototype.open=dn.prototype.m,dn.prototype.close=dn.prototype.close,V0=function(){return new $a},M0=function(){return Ar()},N0=kn,jd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},io.NO_ERROR=0,io.TIMEOUT=8,io.HTTP_ERROR=6,El=io,qu.COMPLETE="complete",j0=qu,Ks.EventType=ae,ae.OPEN="a",ae.CLOSE="b",ae.ERROR="c",ae.MESSAGE="d",ct.prototype.listen=ct.prototype.K,Co=Ks,qe.prototype.listenOnce=qe.prototype.L,qe.prototype.getLastError=qe.prototype.Ka,qe.prototype.getLastErrorCode=qe.prototype.Ba,qe.prototype.getStatus=qe.prototype.Z,qe.prototype.getResponseJson=qe.prototype.Oa,qe.prototype.getResponseText=qe.prototype.oa,qe.prototype.send=qe.prototype.ea,qe.prototype.setWithCredentials=qe.prototype.Ha,D0=qe}).apply(typeof ll<"u"?ll:typeof self<"u"?self:typeof window<"u"?window:{});const mg="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}en.UNAUTHENTICATED=new en(null),en.GOOGLE_CREDENTIALS=new en("google-credentials-uid"),en.FIRST_PARTY=new en("first-party-uid"),en.MOCK_USER=new en("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zi="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os=new E0("@firebase/firestore");function wo(){return Os.logLevel}function ce(t,...e){if(Os.logLevel<=je.DEBUG){const n=e.map(Xh);Os.debug(`Firestore (${Zi}): ${t}`,...n)}}function wr(t,...e){if(Os.logLevel<=je.ERROR){const n=e.map(Xh);Os.error(`Firestore (${Zi}): ${t}`,...n)}}function ua(t,...e){if(Os.logLevel<=je.WARN){const n=e.map(Xh);Os.warn(`Firestore (${Zi}): ${t}`,...n)}}function Xh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ve(t="Unexpected state"){const e=`FIRESTORE (${Zi}) INTERNAL ASSERTION FAILED: `+t;throw wr(e),new Error(e)}function Be(t,e){t||ve()}function we(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class se extends Ji{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class aS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(en.UNAUTHENTICATED))}shutdown(){}}class lS{constructor(e){this.t=e,this.currentUser=en.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Be(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new gr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new gr,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new gr)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Be(typeof r.accessToken=="string"),new oS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Be(e===null||typeof e=="string"),new en(e)}}class uS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=en.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class cS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new uS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(en.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class dS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Be(this.o===void 0);const r=i=>{i.error!=null&&ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,ce("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Be(typeof n.token=="string"),this.R=n.token,new dS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=fS(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Ve(t,e){return t<e?-1:t>e?1:0}function $i(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new se(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new se(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new se(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new se(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new xt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.timestamp=e}static fromTimestamp(e){return new _e(e)}static min(){return new _e(new xt(0,0))}static max(){return new _e(new xt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,n,r){n===void 0?n=0:n>e.length&&ve(),r===void 0?r=e.length-n:r>e.length-n&&ve(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ca.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ca?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Qe extends ca{construct(e,n,r){return new Qe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new se(H.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Qe(n)}static emptyPath(){return new Qe([])}}const pS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pt extends ca{construct(e,n,r){return new Pt(e,n,r)}static isValidIdentifier(e){return pS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Pt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new se(H.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new se(H.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new se(H.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new se(H.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pt(n)}static emptyPath(){return new Pt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.path=e}static fromPath(e){return new fe(Qe.fromString(e))}static fromName(e){return new fe(Qe.fromString(e).popFirst(5))}static empty(){return new fe(Qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Qe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new fe(new Qe(e.slice()))}}function gS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=_e.fromTimestamp(r===1e9?new xt(n+1,0):new xt(n,r));return new is(s,fe.empty(),e)}function mS(t){return new is(t.readTime,t.key,-1)}class is{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new is(_e.min(),fe.empty(),-1)}static max(){return new is(_e.max(),fe.empty(),-1)}}function yS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=fe.comparator(t.documentKey,e.documentKey),n!==0?n:Ve(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sa(t){if(t.code!==H.FAILED_PRECONDITION||t.message!==vS)throw t;ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ve(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new X((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof X?n:X.resolve(n)}catch(n){return X.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):X.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):X.reject(n)}static resolve(e){return new X((n,r)=>{n(e)})}static reject(e){return new X((n,r)=>{r(e)})}static waitFor(e){return new X((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},c=>r(c))}),a=!0,i===s&&n()})}static or(e){let n=X.resolve(!1);for(const r of e)n=n.next(s=>s?X.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new X((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let c=0;c<i;c++){const h=c;n(e[h]).next(p=>{a[h]=p,++l,l===i&&r(a)},p=>s(p))}})}static doWhile(e,n){return new X((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function _S(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ta(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Jh.oe=-1;function ku(t){return t==null}function tu(t){return t===0&&1/t==-1/0}function wS(t){return typeof t=="number"&&Number.isInteger(t)&&!tu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ws(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function F0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,n){this.comparator=e,this.root=n||Rt.EMPTY}insert(e,n){return new rt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Rt.BLACK,null,null))}remove(e){return new rt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ul(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ul(this.root,e,this.comparator,!1)}getReverseIterator(){return new ul(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ul(this.root,e,this.comparator,!0)}}class ul{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Rt.RED,this.left=s??Rt.EMPTY,this.right=i??Rt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Rt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Rt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Rt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ve();const e=this.left.check();if(e!==this.right.check())throw ve();return e+(this.isRed()?0:1)}}Rt.EMPTY=null,Rt.RED=!0,Rt.BLACK=!1;Rt.EMPTY=new class{constructor(){this.size=0}get key(){throw ve()}get value(){throw ve()}get color(){throw ve()}get left(){throw ve()}get right(){throw ve()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Rt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.comparator=e,this.data=new rt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new vg(this.data.getIterator())}getIteratorFrom(e){return new vg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof jt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new jt(this.comparator);return n.data=e,n}}class vg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.fields=e,e.sort(Pt.comparator)}static empty(){return new pn([])}unionWith(e){let n=new jt(Pt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new pn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return $i(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new O0("Invalid base64 string: "+i):i}}(e);return new Mt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new Mt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Mt.EMPTY_BYTE_STRING=new Mt("");const SS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function os(t){if(Be(!!t),typeof t=="string"){let e=0;const n=SS.exec(t);if(Be(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:lt(t.seconds),nanos:lt(t.nanos)}}function lt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function zs(t){return typeof t=="string"?Mt.fromBase64String(t):Mt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function ef(t){const e=t.mapValue.fields.__previous_value__;return Zh(e)?ef(e):e}function da(t){const e=os(t.mapValue.fields.__local_write_time__.timestampValue);return new xt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(e,n,r,s,i,a,l,c,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=h}}class ha{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ha("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ha&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl={mapValue:{}};function Bs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Zh(t)?4:IS(t)?9007199254740991:ES(t)?10:11:ve()}function tr(t,e){if(t===e)return!0;const n=Bs(t);if(n!==Bs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return da(t).isEqual(da(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=os(s.timestampValue),l=os(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return zs(s.bytesValue).isEqual(zs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return lt(s.geoPointValue.latitude)===lt(i.geoPointValue.latitude)&&lt(s.geoPointValue.longitude)===lt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return lt(s.integerValue)===lt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=lt(s.doubleValue),l=lt(i.doubleValue);return a===l?tu(a)===tu(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return $i(t.arrayValue.values||[],e.arrayValue.values||[],tr);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(yg(a)!==yg(l))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(l[c]===void 0||!tr(a[c],l[c])))return!1;return!0}(t,e);default:return ve()}}function fa(t,e){return(t.values||[]).find(n=>tr(n,e))!==void 0}function Wi(t,e){if(t===e)return 0;const n=Bs(t),r=Bs(e);if(n!==r)return Ve(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ve(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=lt(i.integerValue||i.doubleValue),c=lt(a.integerValue||a.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return xg(t.timestampValue,e.timestampValue);case 4:return xg(da(t),da(e));case 5:return Ve(t.stringValue,e.stringValue);case 6:return function(i,a){const l=zs(i),c=zs(a);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),c=a.split("/");for(let h=0;h<l.length&&h<c.length;h++){const p=Ve(l[h],c[h]);if(p!==0)return p}return Ve(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=Ve(lt(i.latitude),lt(a.latitude));return l!==0?l:Ve(lt(i.longitude),lt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return _g(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,c,h,p;const y=i.fields||{},m=a.fields||{},S=(l=y.value)===null||l===void 0?void 0:l.arrayValue,k=(c=m.value)===null||c===void 0?void 0:c.arrayValue,b=Ve(((h=S==null?void 0:S.values)===null||h===void 0?void 0:h.length)||0,((p=k==null?void 0:k.values)===null||p===void 0?void 0:p.length)||0);return b!==0?b:_g(S,k)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===cl.mapValue&&a===cl.mapValue)return 0;if(i===cl.mapValue)return 1;if(a===cl.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),h=a.fields||{},p=Object.keys(h);c.sort(),p.sort();for(let y=0;y<c.length&&y<p.length;++y){const m=Ve(c[y],p[y]);if(m!==0)return m;const S=Wi(l[c[y]],h[p[y]]);if(S!==0)return S}return Ve(c.length,p.length)}(t.mapValue,e.mapValue);default:throw ve()}}function xg(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ve(t,e);const n=os(t),r=os(e),s=Ve(n.seconds,r.seconds);return s!==0?s:Ve(n.nanos,r.nanos)}function _g(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Wi(n[s],r[s]);if(i)return i}return Ve(n.length,r.length)}function Hi(t){return Nd(t)}function Nd(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=os(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return zs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return fe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Nd(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Nd(n.fields[a])}`;return s+"}"}(t.mapValue):ve()}function wg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Md(t){return!!t&&"integerValue"in t}function tf(t){return!!t&&"arrayValue"in t}function Sg(t){return!!t&&"nullValue"in t}function Tg(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Il(t){return!!t&&"mapValue"in t}function ES(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function zo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ws(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=zo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=zo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function IS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.value=e}static empty(){return new nn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Il(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=zo(n)}setAll(e){let n=Pt.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=zo(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Il(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return tr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Il(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Ws(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new nn(zo(this.value))}}function z0(t){const e=[];return Ws(t.fields,(n,r)=>{const s=new Pt([n]);if(Il(r)){const i=z0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new pn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Wt(e,0,_e.min(),_e.min(),_e.min(),nn.empty(),0)}static newFoundDocument(e,n,r,s){return new Wt(e,1,n,_e.min(),r,s,0)}static newNoDocument(e,n){return new Wt(e,2,n,_e.min(),_e.min(),nn.empty(),0)}static newUnknownDocument(e,n){return new Wt(e,3,n,_e.min(),_e.min(),nn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(_e.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_e.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e,n){this.position=e,this.inclusive=n}}function Eg(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=fe.comparator(fe.fromName(a.referenceValue),n.key):r=Wi(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ig(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!tr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n="asc"){this.field=e,this.dir=n}}function CS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{}class gt extends B0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new AS(e,n,r):n==="array-contains"?new PS(e,r):n==="in"?new DS(e,r):n==="not-in"?new jS(e,r):n==="array-contains-any"?new NS(e,r):new gt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new RS(e,r):new bS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Wi(n,this.value)):n!==null&&Bs(this.value)===Bs(n)&&this.matchesComparison(Wi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ve()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $n extends B0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new $n(e,n)}matches(e){return U0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function U0(t){return t.op==="and"}function $0(t){return kS(t)&&U0(t)}function kS(t){for(const e of t.filters)if(e instanceof $n)return!1;return!0}function Vd(t){if(t instanceof gt)return t.field.canonicalString()+t.op.toString()+Hi(t.value);if($0(t))return t.filters.map(e=>Vd(e)).join(",");{const e=t.filters.map(n=>Vd(n)).join(",");return`${t.op}(${e})`}}function W0(t,e){return t instanceof gt?function(r,s){return s instanceof gt&&r.op===s.op&&r.field.isEqual(s.field)&&tr(r.value,s.value)}(t,e):t instanceof $n?function(r,s){return s instanceof $n&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&W0(a,s.filters[l]),!0):!1}(t,e):void ve()}function H0(t){return t instanceof gt?function(n){return`${n.field.canonicalString()} ${n.op} ${Hi(n.value)}`}(t):t instanceof $n?function(n){return n.op.toString()+" {"+n.getFilters().map(H0).join(" ,")+"}"}(t):"Filter"}class AS extends gt{constructor(e,n,r){super(e,n,r),this.key=fe.fromName(r.referenceValue)}matches(e){const n=fe.comparator(e.key,this.key);return this.matchesComparison(n)}}class RS extends gt{constructor(e,n){super(e,"in",n),this.keys=q0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class bS extends gt{constructor(e,n){super(e,"not-in",n),this.keys=q0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function q0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>fe.fromName(r.referenceValue))}class PS extends gt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return tf(n)&&fa(n.arrayValue,this.value)}}class DS extends gt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&fa(this.value.arrayValue,n)}}class jS extends gt{constructor(e,n){super(e,"not-in",n)}matches(e){if(fa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!fa(this.value.arrayValue,n)}}class NS extends gt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!tf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>fa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function Cg(t,e=null,n=[],r=[],s=null,i=null,a=null){return new MS(t,e,n,r,s,i,a)}function nf(t){const e=we(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Vd(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),ku(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Hi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Hi(r)).join(",")),e.ue=n}return e.ue}function rf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!CS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!W0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ig(t.startAt,e.startAt)&&Ig(t.endAt,e.endAt)}function Ld(t){return fe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function VS(t,e,n,r,s,i,a,l){return new Ea(t,e,n,r,s,i,a,l)}function sf(t){return new Ea(t)}function kg(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function G0(t){return t.collectionGroup!==null}function Bo(t){const e=we(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new jt(Pt.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new ru(i,r))}),n.has(Pt.keyField().canonicalString())||e.ce.push(new ru(Pt.keyField(),r))}return e.ce}function Zn(t){const e=we(t);return e.le||(e.le=LS(e,Bo(t))),e.le}function LS(t,e){if(t.limitType==="F")return Cg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new ru(s.field,i)});const n=t.endAt?new nu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new nu(t.startAt.position,t.startAt.inclusive):null;return Cg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Fd(t,e){const n=t.filters.concat([e]);return new Ea(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Od(t,e,n){return new Ea(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Au(t,e){return rf(Zn(t),Zn(e))&&t.limitType===e.limitType}function Q0(t){return`${nf(Zn(t))}|lt:${t.limitType}`}function fi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>H0(s)).join(", ")}]`),ku(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Hi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Hi(s)).join(",")),`Target(${r})`}(Zn(t))}; limitType=${t.limitType})`}function Ru(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):fe.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Bo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,c){const h=Eg(a,l,c);return a.inclusive?h<=0:h<0}(r.startAt,Bo(r),s)||r.endAt&&!function(a,l,c){const h=Eg(a,l,c);return a.inclusive?h>=0:h>0}(r.endAt,Bo(r),s))}(t,e)}function FS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function K0(t){return(e,n)=>{let r=!1;for(const s of Bo(t)){const i=OS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function OS(t,e,n){const r=t.field.isKeyField()?fe.comparator(e.key,n.key):function(i,a,l){const c=a.data.field(i),h=l.data.field(i);return c!==null&&h!==null?Wi(c,h):ve()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ws(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return F0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS=new rt(fe.comparator);function Sr(){return zS}const Y0=new rt(fe.comparator);function ko(...t){let e=Y0;for(const n of t)e=e.insert(n.key,n);return e}function X0(t){let e=Y0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function bs(){return Uo()}function J0(){return Uo()}function Uo(){return new eo(t=>t.toString(),(t,e)=>t.isEqual(e))}const BS=new rt(fe.comparator),US=new jt(fe.comparator);function ke(...t){let e=US;for(const n of t)e=e.add(n);return e}const $S=new jt(Ve);function WS(){return $S}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function of(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tu(e)?"-0":e}}function Z0(t){return{integerValue:""+t}}function HS(t,e){return wS(e)?Z0(e):of(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(){this._=void 0}}function qS(t,e,n){return t instanceof pa?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Zh(i)&&(i=ef(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof ga?tv(t,e):t instanceof ma?nv(t,e):function(s,i){const a=ev(s,i),l=Ag(a)+Ag(s.Pe);return Md(a)&&Md(s.Pe)?Z0(l):of(s.serializer,l)}(t,e)}function GS(t,e,n){return t instanceof ga?tv(t,e):t instanceof ma?nv(t,e):n}function ev(t,e){return t instanceof su?function(r){return Md(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class pa extends bu{}class ga extends bu{constructor(e){super(),this.elements=e}}function tv(t,e){const n=rv(e);for(const r of t.elements)n.some(s=>tr(s,r))||n.push(r);return{arrayValue:{values:n}}}class ma extends bu{constructor(e){super(),this.elements=e}}function nv(t,e){let n=rv(e);for(const r of t.elements)n=n.filter(s=>!tr(s,r));return{arrayValue:{values:n}}}class su extends bu{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Ag(t){return lt(t.integerValue||t.doubleValue)}function rv(t){return tf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,n){this.field=e,this.transform=n}}function KS(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof ga&&s instanceof ga||r instanceof ma&&s instanceof ma?$i(r.elements,s.elements,tr):r instanceof su&&s instanceof su?tr(r.Pe,s.Pe):r instanceof pa&&s instanceof pa}(t.transform,e.transform)}class YS{constructor(e,n){this.version=e,this.transformResults=n}}class zn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new zn}static exists(e){return new zn(void 0,e)}static updateTime(e){return new zn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Cl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Pu{}function sv(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ov(t.key,zn.none()):new Ia(t.key,t.data,zn.none());{const n=t.data,r=nn.empty();let s=new jt(Pt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new ds(t.key,r,new pn(s.toArray()),zn.none())}}function XS(t,e,n){t instanceof Ia?function(s,i,a){const l=s.value.clone(),c=bg(s.fieldTransforms,i,a.transformResults);l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof ds?function(s,i,a){if(!Cl(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=bg(s.fieldTransforms,i,a.transformResults),c=i.data;c.setAll(iv(s)),c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function $o(t,e,n,r){return t instanceof Ia?function(i,a,l,c){if(!Cl(i.precondition,a))return l;const h=i.value.clone(),p=Pg(i.fieldTransforms,c,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof ds?function(i,a,l,c){if(!Cl(i.precondition,a))return l;const h=Pg(i.fieldTransforms,c,a),p=a.data;return p.setAll(iv(i)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(y=>y.field))}(t,e,n,r):function(i,a,l){return Cl(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function JS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=ev(r.transform,s||null);i!=null&&(n===null&&(n=nn.empty()),n.set(r.field,i))}return n||null}function Rg(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&$i(r,s,(i,a)=>KS(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ia extends Pu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ds extends Pu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function iv(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function bg(t,e,n){const r=new Map;Be(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,GS(a,l,n[s]))}return r}function Pg(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,qS(i,a,e))}return r}class ov extends Pu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ZS extends Pu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&XS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=$o(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=$o(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=J0();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const c=sv(a,l);c!==null&&r.set(s.key,c),a.isValidDocument()||a.convertToNoDocument(_e.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ke())}isEqual(e){return this.batchId===e.batchId&&$i(this.mutations,e.mutations,(n,r)=>Rg(n,r))&&$i(this.baseMutations,e.baseMutations,(n,r)=>Rg(n,r))}}class af{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Be(e.mutations.length===r.length);let s=function(){return BS}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new af(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft,De;function rT(t){switch(t){default:return ve();case H.CANCELLED:case H.UNKNOWN:case H.DEADLINE_EXCEEDED:case H.RESOURCE_EXHAUSTED:case H.INTERNAL:case H.UNAVAILABLE:case H.UNAUTHENTICATED:return!1;case H.INVALID_ARGUMENT:case H.NOT_FOUND:case H.ALREADY_EXISTS:case H.PERMISSION_DENIED:case H.FAILED_PRECONDITION:case H.ABORTED:case H.OUT_OF_RANGE:case H.UNIMPLEMENTED:case H.DATA_LOSS:return!0}}function av(t){if(t===void 0)return wr("GRPC error has no .code"),H.UNKNOWN;switch(t){case ft.OK:return H.OK;case ft.CANCELLED:return H.CANCELLED;case ft.UNKNOWN:return H.UNKNOWN;case ft.DEADLINE_EXCEEDED:return H.DEADLINE_EXCEEDED;case ft.RESOURCE_EXHAUSTED:return H.RESOURCE_EXHAUSTED;case ft.INTERNAL:return H.INTERNAL;case ft.UNAVAILABLE:return H.UNAVAILABLE;case ft.UNAUTHENTICATED:return H.UNAUTHENTICATED;case ft.INVALID_ARGUMENT:return H.INVALID_ARGUMENT;case ft.NOT_FOUND:return H.NOT_FOUND;case ft.ALREADY_EXISTS:return H.ALREADY_EXISTS;case ft.PERMISSION_DENIED:return H.PERMISSION_DENIED;case ft.FAILED_PRECONDITION:return H.FAILED_PRECONDITION;case ft.ABORTED:return H.ABORTED;case ft.OUT_OF_RANGE:return H.OUT_OF_RANGE;case ft.UNIMPLEMENTED:return H.UNIMPLEMENTED;case ft.DATA_LOSS:return H.DATA_LOSS;default:return ve()}}(De=ft||(ft={}))[De.OK=0]="OK",De[De.CANCELLED=1]="CANCELLED",De[De.UNKNOWN=2]="UNKNOWN",De[De.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",De[De.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",De[De.NOT_FOUND=5]="NOT_FOUND",De[De.ALREADY_EXISTS=6]="ALREADY_EXISTS",De[De.PERMISSION_DENIED=7]="PERMISSION_DENIED",De[De.UNAUTHENTICATED=16]="UNAUTHENTICATED",De[De.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",De[De.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",De[De.ABORTED=10]="ABORTED",De[De.OUT_OF_RANGE=11]="OUT_OF_RANGE",De[De.UNIMPLEMENTED=12]="UNIMPLEMENTED",De[De.INTERNAL=13]="INTERNAL",De[De.UNAVAILABLE=14]="UNAVAILABLE",De[De.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sT(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT=new js([4294967295,4294967295],0);function Dg(t){const e=sT().encode(t),n=new P0;return n.update(e),new Uint8Array(n.digest())}function jg(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new js([n,r],0),new js([s,i],0)]}class lf{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ao(`Invalid padding: ${n}`);if(r<0)throw new Ao(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ao(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ao(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=js.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(js.fromNumber(r)));return s.compare(iT)===1&&(s=new js([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Dg(e),[r,s]=jg(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new lf(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=Dg(e),[r,s]=jg(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ao extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ca.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Du(_e.min(),s,new rt(Ve),Sr(),ke())}}class Ca{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ca(r,n,ke(),ke(),ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class lv{constructor(e,n){this.targetId=e,this.me=n}}class uv{constructor(e,n,r=Mt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Ng{constructor(){this.fe=0,this.ge=Vg(),this.pe=Mt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ke(),n=ke(),r=ke();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ve()}}),new Ca(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Vg()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Be(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class oT{constructor(e){this.Le=e,this.Be=new Map,this.ke=Sr(),this.qe=Mg(),this.Qe=new rt(Ve)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ve()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(Ld(i))if(r===0){const a=new fe(i.path);this.Ue(n,a,Wt.newNoDocument(a,_e.min()))}else Be(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),c=l?this.Xe(l,e,a):1;if(c!==0){this.je(n);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=zs(r).toUint8Array()}catch(c){if(c instanceof O0)return ua("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new lf(a,s,i)}catch(c){return ua(c instanceof Ao?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&Ld(l.target)){const c=new fe(l.target.path);this.ke.get(c)!==null||this.it(a,c)||this.Ue(a,c,Wt.newNoDocument(c,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=ke();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(c=>{const h=this.Je(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new Du(e,n,this.Qe,this.ke,r);return this.ke=Sr(),this.qe=Mg(),this.Qe=new rt(Ve),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Ng,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new jt(Ve),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ce("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ng),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Mg(){return new rt(fe.comparator)}function Vg(){return new rt(fe.comparator)}const aT={asc:"ASCENDING",desc:"DESCENDING"},lT={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uT={and:"AND",or:"OR"};class cT{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function zd(t,e){return t.useProto3Json||ku(e)?e:{value:e}}function iu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function cv(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function dT(t,e){return iu(t,e.toTimestamp())}function er(t){return Be(!!t),_e.fromTimestamp(function(n){const r=os(n);return new xt(r.seconds,r.nanos)}(t))}function uf(t,e){return Bd(t,e).canonicalString()}function Bd(t,e){const n=function(s){return new Qe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function dv(t){const e=Qe.fromString(t);return Be(mv(e)),e}function Ud(t,e){return uf(t.databaseId,e.path)}function Ac(t,e){const n=dv(e);if(n.get(1)!==t.databaseId.projectId)throw new se(H.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new se(H.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new fe(fv(n))}function hv(t,e){return uf(t.databaseId,e)}function hT(t){const e=dv(t);return e.length===4?Qe.emptyPath():fv(e)}function $d(t){return new Qe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function fv(t){return Be(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Lg(t,e,n){return{name:Ud(t,e),fields:n.value.mapValue.fields}}function fT(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ve()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,p){return h.useProto3Json?(Be(p===void 0||typeof p=="string"),Mt.fromBase64String(p||"")):(Be(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Mt.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){const p=h.code===void 0?H.UNKNOWN:av(h.code);return new se(p,h.message||"")}(a);n=new uv(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ac(t,r.document.name),i=er(r.document.updateTime),a=r.document.createTime?er(r.document.createTime):_e.min(),l=new nn({mapValue:{fields:r.document.fields}}),c=Wt.newFoundDocument(s,i,a,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new kl(h,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ac(t,r.document),i=r.readTime?er(r.readTime):_e.min(),a=Wt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new kl([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ac(t,r.document),i=r.removedTargetIds||[];n=new kl([],i,s,null)}else{if(!("filter"in e))return ve();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new nT(s,i),l=r.targetId;n=new lv(l,a)}}return n}function pT(t,e){let n;if(e instanceof Ia)n={update:Lg(t,e.key,e.value)};else if(e instanceof ov)n={delete:Ud(t,e.key)};else if(e instanceof ds)n={update:Lg(t,e.key,e.data),updateMask:TT(e.fieldMask)};else{if(!(e instanceof ZS))return ve();n={verify:Ud(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof pa)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ga)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ma)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof su)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw ve()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:dT(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ve()}(t,e.precondition)),n}function gT(t,e){return t&&t.length>0?(Be(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?er(s.updateTime):er(i);return a.isEqual(_e.min())&&(a=er(i)),new YS(a,s.transformResults||[])}(n,e))):[]}function mT(t,e){return{documents:[hv(t,e.path)]}}function yT(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=hv(t,s);const i=function(h){if(h.length!==0)return gv($n.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(h){if(h.length!==0)return h.map(p=>function(m){return{field:pi(m.field),direction:_T(m.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=zd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function vT(t){let e=hT(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Be(r===1);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(y){const m=pv(y);return m instanceof $n&&$0(m)?m.getFilters():[m]}(n.where));let a=[];n.orderBy&&(a=function(y){return y.map(m=>function(k){return new ru(gi(k.field),function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(y){let m;return m=typeof y=="object"?y.value:y,ku(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(y){const m=!!y.before,S=y.values||[];return new nu(S,m)}(n.startAt));let h=null;return n.endAt&&(h=function(y){const m=!y.before,S=y.values||[];return new nu(S,m)}(n.endAt)),VS(e,s,a,i,l,"F",c,h)}function xT(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ve()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function pv(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=gi(n.unaryFilter.field);return gt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=gi(n.unaryFilter.field);return gt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=gi(n.unaryFilter.field);return gt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=gi(n.unaryFilter.field);return gt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ve()}}(t):t.fieldFilter!==void 0?function(n){return gt.create(gi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ve()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return $n.create(n.compositeFilter.filters.map(r=>pv(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ve()}}(n.compositeFilter.op))}(t):ve()}function _T(t){return aT[t]}function wT(t){return lT[t]}function ST(t){return uT[t]}function pi(t){return{fieldPath:t.canonicalString()}}function gi(t){return Pt.fromServerFormat(t.fieldPath)}function gv(t){return t instanceof gt?function(n){if(n.op==="=="){if(Tg(n.value))return{unaryFilter:{field:pi(n.field),op:"IS_NAN"}};if(Sg(n.value))return{unaryFilter:{field:pi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Tg(n.value))return{unaryFilter:{field:pi(n.field),op:"IS_NOT_NAN"}};if(Sg(n.value))return{unaryFilter:{field:pi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pi(n.field),op:wT(n.op),value:n.value}}}(t):t instanceof $n?function(n){const r=n.getFilters().map(s=>gv(s));return r.length===1?r[0]:{compositeFilter:{op:ST(n.op),filters:r}}}(t):ve()}function TT(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function mv(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e,n,r,s,i=_e.min(),a=_e.min(),l=Mt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new $r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new $r(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new $r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new $r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e){this.ct=e}}function IT(t){const e=vT({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Od(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(){this.un=new kT}addToCollectionParentIndex(e,n){return this.un.add(n),X.resolve()}getCollectionParents(e,n){return X.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return X.resolve()}deleteFieldIndex(e,n){return X.resolve()}deleteAllFieldIndexes(e){return X.resolve()}createTargetIndexes(e,n){return X.resolve()}getDocumentsMatchingTarget(e,n){return X.resolve(null)}getIndexType(e,n){return X.resolve(0)}getFieldIndexes(e,n){return X.resolve([])}getNextCollectionGroupToUpdate(e){return X.resolve(null)}getMinOffset(e,n){return X.resolve(is.min())}getMinOffsetFromCollectionGroup(e,n){return X.resolve(is.min())}updateCollectionGroup(e,n,r){return X.resolve()}updateIndexEntries(e,n){return X.resolve()}}class kT{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new jt(Qe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new jt(Qe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new qi(0)}static kn(){return new qi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(){this.changes=new eo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Wt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?X.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&$o(r.mutation,s,pn.empty(),xt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ke()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ke()){const s=bs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=ko();return i.forEach((l,c)=>{a=a.insert(l,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=bs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ke()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=Sr();const a=Uo(),l=function(){return Uo()}();return n.forEach((c,h)=>{const p=r.get(h.key);s.has(h.key)&&(p===void 0||p.mutation instanceof ds)?i=i.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),$o(p.mutation,h,p.mutation.getFieldMask(),xt.now())):a.set(h.key,pn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((h,p)=>a.set(h,p)),n.forEach((h,p)=>{var y;return l.set(h,new RT(p,(y=a.get(h))!==null&&y!==void 0?y:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Uo();let s=new rt((a,l)=>a-l),i=ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(c=>{const h=n.get(c);if(h===null)return;let p=r.get(c)||pn.empty();p=l.applyToLocalView(h,p),r.set(c,p);const y=(s.get(l.batchId)||ke()).add(c);s=s.insert(l.batchId,y)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),h=c.key,p=c.value,y=J0();p.forEach(m=>{if(!i.has(m)){const S=sv(n.get(m),r.get(m));S!==null&&y.set(m,S),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,y))}return X.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return fe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):G0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):X.resolve(bs());let l=-1,c=i;return a.next(h=>X.forEach(h,(p,y)=>(l<y.largestBatchId&&(l=y.largestBatchId),i.get(p)?X.resolve():this.remoteDocumentCache.getEntry(e,p).next(m=>{c=c.insert(p,m)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,c,h,ke())).next(p=>({batchId:l,changes:X0(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new fe(n)).next(r=>{let s=ko();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=ko();return this.indexManager.getCollectionParents(e,i).next(l=>X.forEach(l,c=>{const h=function(y,m){return new Ea(m,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(p=>{p.forEach((y,m)=>{a=a.insert(y,m)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((c,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,Wt.newInvalidDocument(p)))});let l=ko();return a.forEach((c,h)=>{const p=i.get(c);p!==void 0&&$o(p.mutation,h,pn.empty(),xt.now()),Ru(n,h)&&(l=l.insert(c,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return X.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:er(s.createTime)}}(n)),X.resolve()}getNamedQuery(e,n){return X.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:IT(s.bundledQuery),readTime:er(s.readTime)}}(n)),X.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(){this.overlays=new rt(fe.comparator),this.Ir=new Map}getOverlay(e,n){return X.resolve(this.overlays.get(n))}getOverlays(e,n){const r=bs();return X.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),X.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),X.resolve()}getOverlaysForCollection(e,n,r){const s=bs(),i=n.length+1,a=new fe(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const c=l.getNext().value,h=c.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return X.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new rt((h,p)=>h-p);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=i.get(h.largestBatchId);p===null&&(p=bs(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=bs(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=s)););return X.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new tT(n,r));let i=this.Ir.get(n);i===void 0&&(i=ke(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(){this.sessionToken=Mt.EMPTY_BYTE_STRING}getSessionToken(e){return X.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,X.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(){this.Tr=new jt(_t.Er),this.dr=new jt(_t.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new _t(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new _t(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new fe(new Qe([])),r=new _t(n,e),s=new _t(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new fe(new Qe([])),r=new _t(n,e),s=new _t(n,e+1);let i=ke();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new _t(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class _t{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return fe.comparator(e.key,n.key)||Ve(e.wr,n.wr)}static Ar(e,n){return Ve(e.wr,n.wr)||fe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new jt(_t.Er)}checkEmpty(e){return X.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new eT(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new _t(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return X.resolve(a)}lookupMutationBatch(e,n){return X.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return X.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return X.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return X.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new _t(n,0),s=new _t(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),X.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new jt(Ve);return n.forEach(s=>{const i=new _t(s,0),a=new _t(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),X.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;fe.isDocumentKey(i)||(i=i.child(""));const a=new _t(new fe(i),0);let l=new jt(Ve);return this.br.forEachWhile(c=>{const h=c.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(l=l.add(c.wr)),!0)},a),X.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Be(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return X.forEach(n.mutations,s=>{const i=new _t(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new _t(n,0),s=this.br.firstAfterOrEqual(r);return X.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,X.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT{constructor(e){this.Mr=e,this.docs=function(){return new rt(fe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return X.resolve(r?r.document.mutableCopy():Wt.newInvalidDocument(n))}getEntries(e,n){let r=Sr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Wt.newInvalidDocument(s))}),X.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Sr();const a=n.path,l=new fe(a.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:h,value:{document:p}}=c.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||yS(mS(p),r)<=0||(s.has(p.key)||Ru(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return X.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ve()}Or(e,n){return X.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new VT(this)}getSize(e){return X.resolve(this.size)}}class VT extends AT{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),X.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e){this.persistence=e,this.Nr=new eo(n=>nf(n),rf),this.lastRemoteSnapshotVersion=_e.min(),this.highestTargetId=0,this.Lr=0,this.Br=new cf,this.targetCount=0,this.kr=qi.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),X.resolve()}getLastRemoteSnapshotVersion(e){return X.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return X.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),X.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),X.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new qi(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,X.resolve()}updateTargetData(e,n){return this.Kn(n),X.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,X.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),X.waitFor(i).next(()=>s)}getTargetCount(e){return X.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return X.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),X.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),X.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),X.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return X.resolve(r)}containsKey(e,n){return X.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Jh(0),this.Kr=!1,this.Kr=!0,this.$r=new jT,this.referenceDelegate=e(this),this.Ur=new LT(this),this.indexManager=new CT,this.remoteDocumentCache=function(s){return new MT(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new ET(n),this.Gr=new PT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new DT,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new NT(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ce("MemoryPersistence","Starting transaction:",e);const s=new OT(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return X.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class OT extends xS{constructor(e){super(),this.currentSequenceNumber=e}}class df{constructor(e){this.persistence=e,this.Jr=new cf,this.Yr=null}static Zr(e){return new df(e)}get Xr(){if(this.Yr)return this.Yr;throw ve()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),X.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),X.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),X.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return X.forEach(this.Xr,r=>{const s=fe.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,_e.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return X.or([()=>X.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=ke(),s=ke();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new hf(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return $_()?8:_S(B_())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new zT;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(wo()<=je.DEBUG&&ce("QueryEngine","SDK will not create cache indexes for query:",fi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),X.resolve()):(wo()<=je.DEBUG&&ce("QueryEngine","Query:",fi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(wo()<=je.DEBUG&&ce("QueryEngine","The SDK decides to create cache indexes for query:",fi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zn(n))):X.resolve())}Yi(e,n){if(kg(n))return X.resolve(null);let r=Zn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Od(n,null,"F"),r=Zn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=ke(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const h=this.ts(n,l);return this.ns(n,h,a,c.readTime)?this.Yi(e,Od(n,null,"F")):this.rs(e,h,n,c)}))})))}Zi(e,n,r,s){return kg(n)||s.isEqual(_e.min())?X.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?X.resolve(null):(wo()<=je.DEBUG&&ce("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),fi(n)),this.rs(e,a,n,gS(s,-1)).next(l=>l))})}ts(e,n){let r=new jt(K0(e));return n.forEach((s,i)=>{Ru(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return wo()<=je.DEBUG&&ce("QueryEngine","Using full collection scan to execute query:",fi(n)),this.Ji.getDocumentsMatchingQuery(e,n,is.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new rt(Ve),this._s=new eo(i=>nf(i),rf),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bT(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function $T(t,e,n,r){return new UT(t,e,n,r)}async function yv(t,e){const n=we(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let c=ke();for(const h of s){a.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}for(const h of i){l.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}return n.localDocuments.getDocuments(r,c).next(h=>({hs:h,removedBatchIds:a,addedBatchIds:l}))})})}function WT(t,e){const n=we(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,h,p){const y=h.batch,m=y.keys();let S=X.resolve();return m.forEach(k=>{S=S.next(()=>p.getEntry(c,k)).next(b=>{const L=h.docVersions.get(k);Be(L!==null),b.version.compareTo(L)<0&&(y.applyToRemoteDocument(b,h),b.isValidDocument()&&(b.setReadTime(h.commitVersion),p.addEntry(b)))})}),S.next(()=>l.mutationQueue.removeMutationBatch(c,y))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=ke();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(c=c.add(l.batch.mutations[h].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function vv(t){const e=we(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function HT(t,e){const n=we(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((p,y)=>{const m=s.get(y);if(!m)return;l.push(n.Ur.removeMatchingKeys(i,p.removedDocuments,y).next(()=>n.Ur.addMatchingKeys(i,p.addedDocuments,y)));let S=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(y)!==null?S=S.withResumeToken(Mt.EMPTY_BYTE_STRING,_e.min()).withLastLimboFreeSnapshotVersion(_e.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),s=s.insert(y,S),function(b,L,A){return b.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(m,S,p)&&l.push(n.Ur.updateTargetData(i,S))});let c=Sr(),h=ke();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),l.push(qT(i,a,e.documentUpdates).next(p=>{c=p.Ps,h=p.Is})),!r.isEqual(_e.min())){const p=n.Ur.getLastRemoteSnapshotVersion(i).next(y=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(p)}return X.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,h)).next(()=>c)}).then(i=>(n.os=s,i))}function qT(t,e,n){let r=ke(),s=ke();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=Sr();return n.forEach((l,c)=>{const h=i.get(l);c.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(_e.min())?(e.removeEntry(l,c.readTime),a=a.insert(l,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),a=a.insert(l,c)):ce("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",c.version)}),{Ps:a,Is:s}})}function GT(t,e){const n=we(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function QT(t,e){const n=we(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,X.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new $r(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Wd(t,e,n){const r=we(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Ta(a))throw a;ce("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Fg(t,e,n){const r=we(t);let s=_e.min(),i=ke();return r.persistence.runTransaction("Execute query","readwrite",a=>function(c,h,p){const y=we(c),m=y._s.get(p);return m!==void 0?X.resolve(y.os.get(m)):y.Ur.getTargetData(h,p)}(r,a,Zn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:_e.min(),n?i:ke())).next(l=>(KT(r,FS(e),l),{documents:l,Ts:i})))}function KT(t,e,n){let r=t.us.get(e)||_e.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Og{constructor(){this.activeTargetIds=WS()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class YT{constructor(){this.so=new Og,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Og,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ce("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ce("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dl=null;function Rc(){return dl===null?dl=function(){return 268435456+Math.round(2147483648*Math.random())}():dl++,"0x"+dl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ut="WebChannelConnection";class eE extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=Rc(),c=this.xo(n,r.toUriEncodedString());ce("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,a),this.No(n,c,h,s).then(p=>(ce("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw ua("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",c,"request:",s),p})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Zi}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=JT[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Rc();return new Promise((a,l)=>{const c=new D0;c.setWithCredentials(!0),c.listenOnce(j0.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case El.NO_ERROR:const p=c.getResponseJson();ce(Ut,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(p)),a(p);break;case El.TIMEOUT:ce(Ut,`RPC '${e}' ${i} timed out`),l(new se(H.DEADLINE_EXCEEDED,"Request time out"));break;case El.HTTP_ERROR:const y=c.getStatus();if(ce(Ut,`RPC '${e}' ${i} failed with status:`,y,"response text:",c.getResponseText()),y>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const S=m==null?void 0:m.error;if(S&&S.status&&S.message){const k=function(L){const A=L.toLowerCase().replace(/_/g,"-");return Object.values(H).indexOf(A)>=0?A:H.UNKNOWN}(S.status);l(new se(k,S.message))}else l(new se(H.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new se(H.UNAVAILABLE,"Connection failed."));break;default:ve()}}finally{ce(Ut,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);ce(Ut,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=Rc(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=V0(),l=M0(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const p=i.join("");ce(Ut,`Creating RPC '${e}' stream ${s}: ${p}`,c);const y=a.createWebChannel(p,c);let m=!1,S=!1;const k=new ZT({Io:L=>{S?ce(Ut,`Not sending because RPC '${e}' stream ${s} is closed:`,L):(m||(ce(Ut,`Opening RPC '${e}' stream ${s} transport.`),y.open(),m=!0),ce(Ut,`RPC '${e}' stream ${s} sending:`,L),y.send(L))},To:()=>y.close()}),b=(L,A,T)=>{L.listen(A,I=>{try{T(I)}catch(V){setTimeout(()=>{throw V},0)}})};return b(y,Co.EventType.OPEN,()=>{S||(ce(Ut,`RPC '${e}' stream ${s} transport opened.`),k.yo())}),b(y,Co.EventType.CLOSE,()=>{S||(S=!0,ce(Ut,`RPC '${e}' stream ${s} transport closed`),k.So())}),b(y,Co.EventType.ERROR,L=>{S||(S=!0,ua(Ut,`RPC '${e}' stream ${s} transport errored:`,L),k.So(new se(H.UNAVAILABLE,"The operation could not be completed")))}),b(y,Co.EventType.MESSAGE,L=>{var A;if(!S){const T=L.data[0];Be(!!T);const I=T,V=I.error||((A=I[0])===null||A===void 0?void 0:A.error);if(V){ce(Ut,`RPC '${e}' stream ${s} received error:`,V);const B=V.status;let F=function(_){const x=ft[_];if(x!==void 0)return av(x)}(B),w=V.message;F===void 0&&(F=H.INTERNAL,w="Unknown error status: "+B+" with message "+V.message),S=!0,k.So(new se(F,w)),y.close()}else ce(Ut,`RPC '${e}' stream ${s} received:`,T),k.bo(T)}}),b(l,N0.STAT_EVENT,L=>{L.stat===jd.PROXY?ce(Ut,`RPC '${e}' stream ${s} detected buffering proxy`):L.stat===jd.NOPROXY&&ce(Ut,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{k.wo()},0),k}}function bc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(t){return new cT(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&ce("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,n,r,s,i,a,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new xv(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===H.RESOURCE_EXHAUSTED?(wr(n.toString()),wr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===H.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new se(H.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ce("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ce("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class tE extends _v{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=fT(this.serializer,e),r=function(i){if(!("targetChange"in i))return _e.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?_e.min():a.readTime?er(a.readTime):_e.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=$d(this.serializer),n.addTarget=function(i,a){let l;const c=a.target;if(l=Ld(c)?{documents:mT(i,c)}:{query:yT(i,c)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=cv(i,a.resumeToken);const h=zd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(_e.min())>0){l.readTime=iu(i,a.snapshotVersion.toTimestamp());const h=zd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=xT(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=$d(this.serializer),n.removeTarget=e,this.a_(n)}}class nE extends _v{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Be(!!e.streamToken),this.lastStreamToken=e.streamToken,Be(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Be(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=gT(e.writeResults,e.commitTime),r=er(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=$d(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>pT(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new se(H.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,Bd(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new se(H.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,Bd(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new se(H.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class sE{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(wr(n),this.D_=!1):ce("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{Hs(this)&&(ce("RemoteStore","Restarting streams for network reachability change."),await async function(c){const h=we(c);h.L_.add(4),await ka(h),h.q_.set("Unknown"),h.L_.delete(4),await Nu(h)}(this))})}),this.q_=new sE(r,s)}}async function Nu(t){if(Hs(t))for(const e of t.B_)await e(!0)}async function ka(t){for(const e of t.B_)await e(!1)}function wv(t,e){const n=we(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),mf(n)?gf(n):to(n).r_()&&pf(n,e))}function ff(t,e){const n=we(t),r=to(n);n.N_.delete(e),r.r_()&&Sv(n,e),n.N_.size===0&&(r.r_()?r.o_():Hs(n)&&n.q_.set("Unknown"))}function pf(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_e.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}to(t).A_(e)}function Sv(t,e){t.Q_.xe(e),to(t).R_(e)}function gf(t){t.Q_=new oT({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),to(t).start(),t.q_.v_()}function mf(t){return Hs(t)&&!to(t).n_()&&t.N_.size>0}function Hs(t){return we(t).L_.size===0}function Tv(t){t.Q_=void 0}async function oE(t){t.q_.set("Online")}async function aE(t){t.N_.forEach((e,n)=>{pf(t,e)})}async function lE(t,e){Tv(t),mf(t)?(t.q_.M_(e),gf(t)):t.q_.set("Unknown")}async function uE(t,e,n){if(t.q_.set("Online"),e instanceof uv&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){ce("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ou(t,r)}else if(e instanceof kl?t.Q_.Ke(e):e instanceof lv?t.Q_.He(e):t.Q_.We(e),!n.isEqual(_e.min()))try{const r=await vv(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const p=i.N_.get(h);p&&i.N_.set(h,p.withResumeToken(c.resumeToken,a))}}),l.targetMismatches.forEach((c,h)=>{const p=i.N_.get(c);if(!p)return;i.N_.set(c,p.withResumeToken(Mt.EMPTY_BYTE_STRING,p.snapshotVersion)),Sv(i,c);const y=new $r(p.target,c,h,p.sequenceNumber);pf(i,y)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ce("RemoteStore","Failed to raise snapshot:",r),await ou(t,r)}}async function ou(t,e,n){if(!Ta(e))throw e;t.L_.add(1),await ka(t),t.q_.set("Offline"),n||(n=()=>vv(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ce("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Nu(t)})}function Ev(t,e){return e().catch(n=>ou(t,n,e))}async function Mu(t){const e=we(t),n=as(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;cE(e);)try{const s=await GT(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,dE(e,s)}catch(s){await ou(e,s)}Iv(e)&&Cv(e)}function cE(t){return Hs(t)&&t.O_.length<10}function dE(t,e){t.O_.push(e);const n=as(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Iv(t){return Hs(t)&&!as(t).n_()&&t.O_.length>0}function Cv(t){as(t).start()}async function hE(t){as(t).p_()}async function fE(t){const e=as(t);for(const n of t.O_)e.m_(n.mutations)}async function pE(t,e,n){const r=t.O_.shift(),s=af.from(r,e,n);await Ev(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Mu(t)}async function gE(t,e){e&&as(t).V_&&await async function(r,s){if(function(a){return rT(a)&&a!==H.ABORTED}(s.code)){const i=r.O_.shift();as(r).s_(),await Ev(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Mu(r)}}(t,e),Iv(t)&&Cv(t)}async function Bg(t,e){const n=we(t);n.asyncQueue.verifyOperationInProgress(),ce("RemoteStore","RemoteStore received new credentials");const r=Hs(n);n.L_.add(3),await ka(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Nu(n)}async function mE(t,e){const n=we(t);e?(n.L_.delete(2),await Nu(n)):e||(n.L_.add(2),await ka(n),n.q_.set("Unknown"))}function to(t){return t.K_||(t.K_=function(n,r,s){const i=we(n);return i.w_(),new tE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:oE.bind(null,t),Ro:aE.bind(null,t),mo:lE.bind(null,t),d_:uE.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),mf(t)?gf(t):t.q_.set("Unknown")):(await t.K_.stop(),Tv(t))})),t.K_}function as(t){return t.U_||(t.U_=function(n,r,s){const i=we(n);return i.w_(),new nE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:hE.bind(null,t),mo:gE.bind(null,t),f_:fE.bind(null,t),g_:pE.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Mu(t)):(await t.U_.stop(),t.O_.length>0&&(ce("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new gr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new yf(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new se(H.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vf(t,e){if(wr("AsyncQueue",`${e}: ${t}`),Ta(t))return new se(H.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this.comparator=e?(n,r)=>e(n,r)||fe.comparator(n.key,r.key):(n,r)=>fe.comparator(n.key,r.key),this.keyedMap=ko(),this.sortedSet=new rt(this.comparator)}static emptySet(e){return new Ni(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ni)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ni;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(){this.W_=new rt(fe.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ve():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Gi{constructor(e,n,r,s,i,a,l,c,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new Gi(e,n,Ni.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Au(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yE{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class vE{constructor(){this.queries=$g(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=we(n),i=s.queries;s.queries=$g(),i.forEach((a,l)=>{for(const c of l.j_)c.onError(r)})})(this,new se(H.ABORTED,"Firestore shutting down"))}}function $g(){return new eo(t=>Q0(t),Au)}async function kv(t,e){const n=we(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new yE,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=vf(a,`Initialization of query '${fi(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&xf(n)}async function Av(t,e){const n=we(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function xE(t,e){const n=we(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&xf(n)}function _E(t,e,n){const r=we(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function xf(t){t.Y_.forEach(e=>{e.next()})}var Hd,Wg;(Wg=Hd||(Hd={})).ea="default",Wg.Cache="cache";class Rv{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Gi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Gi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Hd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(e){this.key=e}}class Pv{constructor(e){this.key=e}}class wE{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ke(),this.mutatedKeys=ke(),this.Aa=K0(e),this.Ra=new Ni(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Ug,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,y)=>{const m=s.get(p),S=Ru(this.query,y)?y:null,k=!!m&&this.mutatedKeys.has(m.key),b=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let L=!1;m&&S?m.data.isEqual(S.data)?k!==b&&(r.track({type:3,doc:S}),L=!0):this.ga(m,S)||(r.track({type:2,doc:S}),L=!0,(c&&this.Aa(S,c)>0||h&&this.Aa(S,h)<0)&&(l=!0)):!m&&S?(r.track({type:0,doc:S}),L=!0):m&&!S&&(r.track({type:1,doc:m}),L=!0,(c||h)&&(l=!0)),L&&(S?(a=a.add(S),i=b?i.add(p):i.delete(p)):(a=a.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((p,y)=>function(S,k){const b=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ve()}};return b(S)-b(k)}(p.type,y.type)||this.Aa(p.doc,y.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,h=c!==this.Ea;return this.Ea=c,a.length!==0||h?{snapshot:new Gi(this.query,e.Ra,i,a,e.mutatedKeys,c===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ug,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ke(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Pv(r))}),this.da.forEach(r=>{e.has(r)||n.push(new bv(r))}),n}ba(e){this.Ta=e.Ts,this.da=ke();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Gi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class SE{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class TE{constructor(e){this.key=e,this.va=!1}}class EE{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new eo(l=>Q0(l),Au),this.Ma=new Map,this.xa=new Set,this.Oa=new rt(fe.comparator),this.Na=new Map,this.La=new cf,this.Ba={},this.ka=new Map,this.qa=qi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function IE(t,e,n=!0){const r=Lv(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await Dv(r,e,n,!0),s}async function CE(t,e){const n=Lv(t);await Dv(n,e,!0,!1)}async function Dv(t,e,n,r){const s=await QT(t.localStore,Zn(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await kE(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&wv(t.remoteStore,s),l}async function kE(t,e,n,r,s){t.Ka=(y,m,S)=>async function(b,L,A,T){let I=L.view.ma(A);I.ns&&(I=await Fg(b.localStore,L.query,!1).then(({documents:w})=>L.view.ma(w,I)));const V=T&&T.targetChanges.get(L.targetId),B=T&&T.targetMismatches.get(L.targetId)!=null,F=L.view.applyChanges(I,b.isPrimaryClient,V,B);return qg(b,L.targetId,F.wa),F.snapshot}(t,y,m,S);const i=await Fg(t.localStore,e,!0),a=new wE(e,i.Ts),l=a.ma(i.documents),c=Ca.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=a.applyChanges(l,t.isPrimaryClient,c);qg(t,n,h.wa);const p=new SE(e,n,a);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function AE(t,e,n){const r=we(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!Au(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Wd(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&ff(r.remoteStore,s.targetId),qd(r,s.targetId)}).catch(Sa)):(qd(r,s.targetId),await Wd(r.localStore,s.targetId,!0))}async function RE(t,e){const n=we(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ff(n.remoteStore,r.targetId))}async function bE(t,e,n){const r=LE(t);try{const s=await function(a,l){const c=we(a),h=xt.now(),p=l.reduce((S,k)=>S.add(k.key),ke());let y,m;return c.persistence.runTransaction("Locally write mutations","readwrite",S=>{let k=Sr(),b=ke();return c.cs.getEntries(S,p).next(L=>{k=L,k.forEach((A,T)=>{T.isValidDocument()||(b=b.add(A))})}).next(()=>c.localDocuments.getOverlayedDocuments(S,k)).next(L=>{y=L;const A=[];for(const T of l){const I=JS(T,y.get(T.key).overlayedDocument);I!=null&&A.push(new ds(T.key,I,z0(I.value.mapValue),zn.exists(!0)))}return c.mutationQueue.addMutationBatch(S,h,A,l)}).next(L=>{m=L;const A=L.applyToLocalDocumentSet(y,b);return c.documentOverlayCache.saveOverlays(S,L.batchId,A)})}).then(()=>({batchId:m.batchId,changes:X0(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,c){let h=a.Ba[a.currentUser.toKey()];h||(h=new rt(Ve)),h=h.insert(l,c),a.Ba[a.currentUser.toKey()]=h}(r,s.batchId,n),await Aa(r,s.changes),await Mu(r.remoteStore)}catch(s){const i=vf(s,"Failed to persist write");n.reject(i)}}async function jv(t,e){const n=we(t);try{const r=await HT(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(Be(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?Be(a.va):s.removedDocuments.size>0&&(Be(a.va),a.va=!1))}),await Aa(n,r,e)}catch(r){await Sa(r)}}function Hg(t,e,n){const r=we(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const c=we(a);c.onlineState=l;let h=!1;c.queries.forEach((p,y)=>{for(const m of y.j_)m.Z_(l)&&(h=!0)}),h&&xf(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function PE(t,e,n){const r=we(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new rt(fe.comparator);a=a.insert(i,Wt.newNoDocument(i,_e.min()));const l=ke().add(i),c=new Du(_e.min(),new Map,new rt(Ve),a,l);await jv(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),_f(r)}else await Wd(r.localStore,e,!1).then(()=>qd(r,e,n)).catch(Sa)}async function DE(t,e){const n=we(t),r=e.batch.batchId;try{const s=await WT(n.localStore,e);Mv(n,r,null),Nv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Aa(n,s)}catch(s){await Sa(s)}}async function jE(t,e,n){const r=we(t);try{const s=await function(a,l){const c=we(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return c.mutationQueue.lookupMutationBatch(h,l).next(y=>(Be(y!==null),p=y.keys(),c.mutationQueue.removeMutationBatch(h,y))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>c.localDocuments.getDocuments(h,p))})}(r.localStore,e);Mv(r,e,n),Nv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Aa(r,s)}catch(s){await Sa(s)}}function Nv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Mv(t,e,n){const r=we(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function qd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Vv(t,r)})}function Vv(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(ff(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),_f(t))}function qg(t,e,n){for(const r of n)r instanceof bv?(t.La.addReference(r.key,e),NE(t,r)):r instanceof Pv?(ce("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Vv(t,r.key)):ve()}function NE(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ce("SyncEngine","New document in limbo: "+n),t.xa.add(r),_f(t))}function _f(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new fe(Qe.fromString(e)),r=t.qa.next();t.Na.set(r,new TE(n)),t.Oa=t.Oa.insert(n,r),wv(t.remoteStore,new $r(Zn(sf(n.path)),r,"TargetPurposeLimboResolution",Jh.oe))}}async function Aa(t,e,n){const r=we(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{a.push(r.Ka(c,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const y=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,y?"current":"not-current")}if(h){s.push(h);const y=hf.Wi(c.targetId,h);i.push(y)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(c,h){const p=we(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>X.forEach(h,m=>X.forEach(m.$i,S=>p.persistence.referenceDelegate.addReference(y,m.targetId,S)).next(()=>X.forEach(m.Ui,S=>p.persistence.referenceDelegate.removeReference(y,m.targetId,S)))))}catch(y){if(!Ta(y))throw y;ce("LocalStore","Failed to update sequence numbers: "+y)}for(const y of h){const m=y.targetId;if(!y.fromCache){const S=p.os.get(m),k=S.snapshotVersion,b=S.withLastLimboFreeSnapshotVersion(k);p.os=p.os.insert(m,b)}}}(r.localStore,i))}async function ME(t,e){const n=we(t);if(!n.currentUser.isEqual(e)){ce("SyncEngine","User change. New user:",e.toKey());const r=await yv(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new se(H.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Aa(n,r.hs)}}function VE(t,e){const n=we(t),r=n.Na.get(e);if(r&&r.va)return ke().add(r.key);{let s=ke();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}function Lv(t){const e=we(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=jv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=VE.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=PE.bind(null,e),e.Ca.d_=xE.bind(null,e.eventManager),e.Ca.$a=_E.bind(null,e.eventManager),e}function LE(t){const e=we(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=DE.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=jE.bind(null,e),e}class au{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ju(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return $T(this.persistence,new BT,e.initialUser,this.serializer)}Ga(e){return new FT(df.Zr,this.serializer)}Wa(e){return new YT}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}au.provider={build:()=>new au};class Gd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Hg(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=ME.bind(null,this.syncEngine),await mE(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new vE}()}createDatastore(e){const n=ju(e.databaseInfo.databaseId),r=function(i){return new eE(i)}(e.databaseInfo);return function(i,a,l,c){return new rE(i,a,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new iE(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Hg(this.syncEngine,n,0),function(){return zg.D()?new zg:new XT}())}createSyncEngine(e,n){return function(s,i,a,l,c,h,p){const y=new EE(s,i,a,l,c,h);return p&&(y.Qa=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=we(s);ce("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await ka(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Gd.provider={build:()=>new Gd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):wr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=en.UNAUTHENTICATED,this.clientId=L0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{ce("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(ce("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=vf(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Pc(t,e){t.asyncQueue.verifyOperationInProgress(),ce("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await yv(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Gg(t,e){t.asyncQueue.verifyOperationInProgress();const n=await OE(t);ce("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Bg(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Bg(e.remoteStore,s)),t._onlineComponents=e}async function OE(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ce("FirestoreClient","Using user provided OfflineComponentProvider");try{await Pc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===H.FAILED_PRECONDITION||s.code===H.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;ua("Error using user provided cache. Falling back to memory cache: "+n),await Pc(t,new au)}}else ce("FirestoreClient","Using default OfflineComponentProvider"),await Pc(t,new au);return t._offlineComponents}async function Ov(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ce("FirestoreClient","Using user provided OnlineComponentProvider"),await Gg(t,t._uninitializedComponentsProvider._online)):(ce("FirestoreClient","Using default OnlineComponentProvider"),await Gg(t,new Gd))),t._onlineComponents}function zE(t){return Ov(t).then(e=>e.syncEngine)}async function zv(t){const e=await Ov(t),n=e.eventManager;return n.onListen=IE.bind(null,e.syncEngine),n.onUnlisten=AE.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=CE.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=RE.bind(null,e.syncEngine),n}function BE(t,e,n={}){const r=new gr;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,h){const p=new Fv({next:m=>{p.Za(),a.enqueueAndForget(()=>Av(i,y));const S=m.docs.has(l);!S&&m.fromCache?h.reject(new se(H.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&m.fromCache&&c&&c.source==="server"?h.reject(new se(H.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(m)},error:m=>h.reject(m)}),y=new Rv(sf(l.path),p,{includeMetadataChanges:!0,_a:!0});return kv(i,y)}(await zv(t),t.asyncQueue,e,n,r)),r.promise}function UE(t,e,n={}){const r=new gr;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,h){const p=new Fv({next:m=>{p.Za(),a.enqueueAndForget(()=>Av(i,y)),m.fromCache&&c.source==="server"?h.reject(new se(H.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(m)},error:m=>h.reject(m)}),y=new Rv(l,p,{includeMetadataChanges:!0,_a:!0});return kv(i,y)}(await zv(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bv(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uv(t,e,n){if(!n)throw new se(H.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $E(t,e,n,r){if(e===!0&&r===!0)throw new se(H.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Kg(t){if(!fe.isDocumentKey(t))throw new se(H.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Yg(t){if(fe.isDocumentKey(t))throw new se(H.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Vu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ve()}function Tr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new se(H.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Vu(t);throw new se(H.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new se(H.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new se(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$E("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Bv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new se(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new se(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new se(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wf{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xg({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new se(H.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new se(H.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new aS;switch(r.type){case"firstParty":return new cS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new se(H.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Qg.get(n);r&&(ce("ComponentProvider","Removing Datastore"),Qg.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new no(this.firestore,e,this._query)}}class Yt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ns(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yt(this.firestore,e,this._key)}}class ns extends no{constructor(e,n,r){super(e,n,sf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yt(this.firestore,null,new fe(e))}withConverter(e){return new ns(this.firestore,e,this._path)}}function Wr(t,e,...n){if(t=Un(t),Uv("collection","path",e),t instanceof wf){const r=Qe.fromString(e,...n);return Yg(r),new ns(t,null,r)}{if(!(t instanceof Yt||t instanceof ns))throw new se(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Qe.fromString(e,...n));return Yg(r),new ns(t.firestore,null,r)}}function bt(t,e,...n){if(t=Un(t),arguments.length===1&&(e=L0.newId()),Uv("doc","path",e),t instanceof wf){const r=Qe.fromString(e,...n);return Kg(r),new Yt(t,null,new fe(r))}{if(!(t instanceof Yt||t instanceof ns))throw new se(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Qe.fromString(e,...n));return Kg(r),new Yt(t.firestore,t instanceof ns?t.converter:null,new fe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new xv(this,"async_queue_retry"),this.Vu=()=>{const r=bc();r&&ce("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=bc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=bc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new gr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ta(e))throw e;ce("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw wr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=yf.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ve()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class ro extends wf{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Jg,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Jg(e),this._firestoreClient=void 0,await e}}}function WE(t,e,n){n||(n="(default)");const r=k0(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Zl(i,e))return s;throw new se(H.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new se(H.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new se(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function Sf(t){if(t._terminated)throw new se(H.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||HE(t),t._firestoreClient}function HE(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,h,p){return new TS(l,c,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Bv(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new FE(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qi(Mt.fromBase64String(e))}catch(n){throw new se(H.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Qi(Mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new se(H.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new se(H.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new se(H.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qE=/^__.*__$/;class GE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ds(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ia(e,this.data,n,this.fieldTransforms)}}class $v{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ds(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Wv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ve()}}class If{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new If(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return lu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Wv(this.Cu)&&qE.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class QE{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ju(e)}Qu(e,n,r,s=!1){return new If({Cu:e,methodName:n,qu:r,path:Pt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ou(t){const e=t._freezeSettings(),n=ju(t._databaseId);return new QE(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Hv(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);kf("Data must be an object, but it was:",a,r);const l=qv(r,a);let c,h;if(i.merge)c=new pn(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const p=[];for(const y of i.mergeFields){const m=Qd(e,y,n);if(!a.contains(m))throw new se(H.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Qv(p,m)||p.push(m)}c=new pn(p),h=a.fieldTransforms.filter(y=>c.covers(y.field))}else c=null,h=a.fieldTransforms;return new GE(new nn(l),c,h)}class zu extends Fu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof zu}}class Cf extends Fu{_toFieldTransform(e){return new QS(e.path,new pa)}isEqual(e){return e instanceof Cf}}function KE(t,e,n,r){const s=t.Qu(1,e,n);kf("Data must be an object, but it was:",s,r);const i=[],a=nn.empty();Ws(r,(c,h)=>{const p=Af(e,c,n);h=Un(h);const y=s.Nu(p);if(h instanceof zu)i.push(p);else{const m=Ra(h,y);m!=null&&(i.push(p),a.set(p,m))}});const l=new pn(i);return new $v(a,l,s.fieldTransforms)}function YE(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[Qd(e,r,n)],c=[s];if(i.length%2!=0)throw new se(H.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(Qd(e,i[m])),c.push(i[m+1]);const h=[],p=nn.empty();for(let m=l.length-1;m>=0;--m)if(!Qv(h,l[m])){const S=l[m];let k=c[m];k=Un(k);const b=a.Nu(S);if(k instanceof zu)h.push(S);else{const L=Ra(k,b);L!=null&&(h.push(S),p.set(S,L))}}const y=new pn(h);return new $v(p,y,a.fieldTransforms)}function XE(t,e,n,r=!1){return Ra(n,t.Qu(r?4:3,e))}function Ra(t,e){if(Gv(t=Un(t)))return kf("Unsupported field value:",e,t),qv(t,e);if(t instanceof Fu)return function(r,s){if(!Wv(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let c=Ra(l,s.Lu(a));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Un(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return HS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=xt.fromDate(r);return{timestampValue:iu(s.serializer,i)}}if(r instanceof xt){const i=new xt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:iu(s.serializer,i)}}if(r instanceof Tf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Qi)return{bytesValue:cv(s.serializer,r._byteString)};if(r instanceof Yt){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:uf(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Ef)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return of(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Vu(r)}`)}(t,e)}function qv(t,e){const n={};return F0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ws(t,(r,s)=>{const i=Ra(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Gv(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof xt||t instanceof Tf||t instanceof Qi||t instanceof Yt||t instanceof Fu||t instanceof Ef)}function kf(t,e,n){if(!Gv(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Vu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Qd(t,e,n){if((e=Un(e))instanceof Lu)return e._internalPath;if(typeof e=="string")return Af(t,e);throw lu("Field path arguments must be of type string or ",t,!1,void 0,n)}const JE=new RegExp("[~\\*/\\[\\]]");function Af(t,e,n){if(e.search(JE)>=0)throw lu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Lu(...e.split("."))._internalPath}catch{throw lu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function lu(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||a)&&(c+=" (found",i&&(c+=` in field ${r}`),a&&(c+=` in document ${s}`),c+=")"),new se(H.INVALID_ARGUMENT,l+t+c)}function Qv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Yt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ZE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Rf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class ZE extends Kv{data(){return super.data()}}function Rf(t,e){return typeof e=="string"?Af(t,e):e instanceof Lu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new se(H.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class bf{}class tI extends bf{}function nI(t,e,...n){let r=[];e instanceof bf&&r.push(e),r=r.concat(n),function(i){const a=i.filter(c=>c instanceof Pf).length,l=i.filter(c=>c instanceof Bu).length;if(a>1||a>0&&l>0)throw new se(H.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Bu extends tI{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Bu(e,n,r)}_apply(e){const n=this._parse(e);return Yv(e._query,n),new no(e.firestore,e.converter,Fd(e._query,n))}_parse(e){const n=Ou(e.firestore);return function(i,a,l,c,h,p,y){let m;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new se(H.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){tm(y,p);const S=[];for(const k of y)S.push(em(c,i,k));m={arrayValue:{values:S}}}else m=em(c,i,y)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||tm(y,p),m=XE(l,a,y,p==="in"||p==="not-in");return gt.create(h,p,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Zg(t,e,n){const r=e,s=Rf("where",t);return Bu._create(s,r,n)}class Pf extends bf{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Pf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:$n.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const c of l)Yv(a,c),a=Fd(a,c)}(e._query,n),new no(e.firestore,e.converter,Fd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function em(t,e,n){if(typeof(n=Un(n))=="string"){if(n==="")throw new se(H.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!G0(e)&&n.indexOf("/")!==-1)throw new se(H.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Qe.fromString(n));if(!fe.isDocumentKey(r))throw new se(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return wg(t,new fe(r))}if(n instanceof Yt)return wg(t,n._key);throw new se(H.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vu(n)}.`)}function tm(t,e){if(!Array.isArray(t)||t.length===0)throw new se(H.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Yv(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new se(H.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new se(H.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class rI{convertValue(e,n="none"){switch(Bs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(zs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ve()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ws(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>lt(a.doubleValue));return new Ef(i)}convertGeoPoint(e){return new Tf(lt(e.latitude),lt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=ef(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(da(e));default:return null}}convertTimestamp(e){const n=os(e);return new xt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Qe.fromString(e);Be(mv(r));const s=new ha(r.get(1),r.get(3)),i=new fe(r.popFirst(5));return s.isEqual(n)||wr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xv(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Jv extends Kv{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Al(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Rf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Al extends Jv{data(e={}){return super.data(e)}}class sI{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ro(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Al(this._firestore,this._userDataWriter,r.key,r,new Ro(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new se(H.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const c=new Al(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Ro(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new Al(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Ro(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,p=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:iI(l.type),doc:c,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function iI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(t){t=Tr(t,Yt);const e=Tr(t.firestore,ro);return BE(Sf(e),t._key).then(n=>oI(e,t,n))}class Zv extends rI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qi(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Yt(this.firestore,null,n)}}function bo(t){t=Tr(t,no);const e=Tr(t.firestore,ro),n=Sf(e),r=new Zv(e);return eI(t._query),UE(n,t._query).then(s=>new sI(e,r,t,s))}function Kd(t,e,n){t=Tr(t,Yt);const r=Tr(t.firestore,ro),s=Xv(t.converter,e,n);return Df(r,[Hv(Ou(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,zn.none())])}function dr(t,e,n,...r){t=Tr(t,Yt);const s=Tr(t.firestore,ro),i=Ou(s);let a;return a=typeof(e=Un(e))=="string"||e instanceof Lu?YE(i,"updateDoc",t._key,e,n,r):KE(i,"updateDoc",t._key,e),Df(s,[a.toMutation(t._key,zn.exists(!0))])}function Yd(t,e){const n=Tr(t.firestore,ro),r=bt(t),s=Xv(t.converter,e);return Df(n,[Hv(Ou(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,zn.exists(!1))]).then(()=>r)}function Df(t,e){return function(r,s){const i=new gr;return r.asyncQueue.enqueueAndForget(async()=>bE(await zE(r),s,i)),i.promise}(Sf(t),e)}function oI(t,e,n){const r=n.docs.get(e._key),s=new Zv(t);return new Jv(t,s,e._key,r,new Ro(n.hasPendingWrites,n.fromCache),e.converter)}function Ln(){return new Cf("serverTimestamp")}(function(e,n=!0){(function(s){Zi=s})(Gw),aa(new Ui("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new ro(new lS(r.getProvider("auth-internal")),new hS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new se(H.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ha(h.options.projectId,p)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),ts(mg,"4.7.3",e),ts(mg,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd="us-central1";class lI{constructor(e,n,r,s,i=Xd,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new aI(n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Xd}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function uI(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const nm="@firebase/functions",rm="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI="auth-internal",dI="app-check-internal",hI="messaging-internal";function fI(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),a=r.getProvider(cI),l=r.getProvider(hI),c=r.getProvider(dI);return new lI(i,a,l,c,s,t)};aa(new Ui(ex,n,"PUBLIC").setMultipleInstances(!0)),ts(nm,rm,e),ts(nm,rm,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(t=Qw(),e=Xd){const r=k0(Un(t),ex).getImmediate({identifier:e}),s=O_("functions");return s&&gI(r,...s),r}function gI(t,e,n){uI(Un(t),e,n)}fI(fetch.bind(self));const mI={apiKey:'"AIzaSyDRdl4zhwoZumVtphmJ19orZ8HoR0WQQZM",',authDomain:'"qualtrics-game-backend.firebaseapp.com",',projectId:'"qualtrics-game-backend",',storageBucket:'"qualtrics-game-backend.firebasestorage.app",',messagingSenderId:'"441267092549",',appId:"1:441267092549:web:6ce075f5f3ea7cf958772c"},tx=A0(mI),Xe=WE(tx,{experimentalForceLongPolling:!1,useFetchStreams:!1});pI(tx);const hi=[],Oe={init(){localStorage.getItem("sessionId")||(localStorage.setItem("sessionId",this.generateSessionId()),localStorage.setItem("sessionStartTime",Date.now().toString())),localStorage.getItem("semesterStartTime")||localStorage.setItem("semesterStartTime",Date.now().toString()),window.addEventListener("beforeunload",()=>{this.flushPendingEvents()}),window.addEventListener("pagehide",()=>{this.flushPendingEvents()})},async flushPendingEvents(){if(hi.length===0)return;const t=[...hi];hi.length=0;for(const e of t)try{await Yd(Wr(Xe,"events"),e)}catch(n){console.error("Failed to flush pending event:",n),hi.push(e)}},generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},async logEvent(t,e){const n=localStorage.getItem("sessionId")||this.generateSessionId(),r=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),s=Date.now(),i=s-r,a=(i/1e3).toFixed(1),l=Math.floor(i/6e4),c=Math.floor(i%6e4/1e3),h=`${l}:${c.toString().padStart(2,"0")}`,p=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),y=this.getFullGameContext(),m=JSON.parse(localStorage.getItem("globalConfig")||"{}"),S={sessionId:n,studentId:p.studentId||null,username:p.displayName||p.username||p.studentId||null,type:t,timestamp:new Date().toISOString(),clientTimestamp:s,timeElapsedSeconds:parseFloat(a),readableTime:h,semesterTime:this.getSemesterTime(),...y,isAdminMode:p.role==="admin",hasCheckpoint:p.checkpointSemester2||!1,hasAI:p.hasAI||!1,section:p.section||null,gameConfig:{semesterDuration:m.semesterDuration||12,totalTasks:m.totalTasks||10,totalSemesters:m.totalSemesters||2,midtermEnabled:m.midtermEnabled||!1,aiCost:m.aiCost||0,wrongAnswerPenalty:m.wrongAnswerPenalty||0,switchCost:m.switchCost||0,jarRefillFreezeTime:m.jarRefillFreezeTime||0,unfinishedJarPenalty:m.unfinishedJarPenalty||0,unfinishedTaskPenalty:m.unfinishedTaskPenalty||0,aiDelay:m.aiDelay||0,taskOrderStrategy:m.taskOrderStrategy||"sequential_task",difficultyMode:m.difficultyMode||"fixed",gameMode:m.gameMode||"knapsack",scoring:m.scoring||null},...this.convertTimesToSeconds(e)};(t==="user_action"||t==="task_attempt")&&console.log(`DEBUG: Event ${t} - studentId: ${S.studentId}, role: ${p.role}`);try{Yd(Wr(Xe,"events"),S).catch(k=>{console.error("Failed to log event immediately:",k),hi.push(S),this.storeOfflineEvent(S)})}catch(k){console.error("Failed to log event:",k),hi.push(S),this.storeOfflineEvent(S)}},convertTimesToSeconds(t){const e={...t},n=["timeTaken","timeSpent","totalTime","timeOnPreviousPage","averageTime","timeBetweenHelpAndSubmit"];for(const r of n)e[r]!==void 0&&e[r]!==null&&(e[`${r}Seconds`]=(e[r]/1e3).toFixed(1),delete e[r]);return e.timeProgression&&(e.timeProgressionSeconds=e.timeProgression.map(r=>(r/1e3).toFixed(1)),delete e.timeProgression),e.timePerAttempt&&(e.timePerAttemptSeconds=e.timePerAttempt.map(r=>(r/1e3).toFixed(1)),delete e.timePerAttempt),e},getSemesterTime(){const t=parseInt(localStorage.getItem("semesterStartTime")||Date.now()),e=Date.now()-t,n=(e/1e3).toFixed(1),r=Math.floor(e/6e4),s=Math.floor(e%6e4/1e3);return{elapsedSeconds:parseFloat(n),readable:`${r}:${s.toString().padStart(2,"0")}`,minutes:r,seconds:s}},getCurrentContext(){const t=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),e=((Date.now()-t)/1e3).toFixed(1);return{currentTask:localStorage.getItem("currentTask"),gameMode:localStorage.getItem("gameMode"),totalCompleted:this.getCompletedTaskCount(),currentStreak:this.getCurrentStreak(),sessionDurationSeconds:parseFloat(e)}},getFullGameContext(){const t=localStorage.getItem("currentTask")||"",e=localStorage.getItem("gameMode")||"",n=parseInt(localStorage.getItem("currentSemester")||"1"),r=parseInt(localStorage.getItem("totalSemesters")||"2"),s=localStorage.getItem("practiceCompleted")==="true",i=parseInt(localStorage.getItem("completedTasksCount")||"0"),a=parseInt(localStorage.getItem("completedLevels")||"0"),l=parseInt(localStorage.getItem("totalSwitches")||"0"),c=parseInt(localStorage.getItem("aiUsageCount")||"0"),h=JSON.parse(localStorage.getItem("categoryPoints")||"{}"),p=parseFloat(localStorage.getItem("studentLearningScore")||"0");return{currentTask:t,gameMode:e,currentSemester:n,totalSemesters:r,practiceCompleted:s,completedTasks:i,completedLevels:a,totalSwitches:l,aiUsageCount:c,studentLearning:p,totalBonus:h.bonus||0,finalScore:Math.round(p)+(h.bonus||0),semester:n}},calculateImprovementTrend(t){if(!t||t.length<3)return"needs_more_data";const n=t.slice(-5).map(s=>s.accuracy),r=this.calculateTrend(n);return r>5?"rapid_improvement":r>2?"steady_improvement":r>0?"slight_improvement":r>-2?"stable":r>-5?"slight_decline":"rapid_decline"},calculateImprovementRate(t){if(!t||t.length<2)return{overall:0,trend:0,isImproving:!1,dataPoints:t?t.length:0};const e=t[0].accuracy,r=t[t.length-1].accuracy-e;if(t.length<3)return{overall:r,trend:r,isImproving:r>0,dataPoints:t.length};const s=Math.floor(t.length/2),i=t.slice(0,s).reduce((c,h)=>c+h.accuracy,0)/s,l=t.slice(s).reduce((c,h)=>c+h.accuracy,0)/(t.length-s)-i;return{overall:r,trend:l,isImproving:l>0,dataPoints:t.length}},setPageStartTime(t){t&&localStorage.setItem(`pageStartTime_${t}`,Date.now().toString())},getTimeOnCurrentPage(t){if(!t)return 0;const e=localStorage.getItem(`pageStartTime_${t}`);return e?Date.now()-parseInt(e):0},ensureSession(){localStorage.getItem("sessionId")||this.init()},async trackAIHelpResponse(t,e,n,r,s,i){const a=parseInt(localStorage.getItem("aiUsageCount")||"0");return localStorage.setItem("aiUsageCount",(a+1).toString()),this.logEvent("ai_help_response",{taskId:t,helpType:e,suggestion:n,playerAction:r,playerValue:s,timeBetween:i})},async trackTaskAttempt(t,e){return this.logEvent("task_attempt",{taskId:t,...e})},async trackUserAction(t,e){return this.logEvent("user_action",{action:t,response:e.response||"",query:e.query||"",queryType:e.queryType||"",choice:e.choice||"",currentMode:e.currentMode||"",...e})},async syncOfflineEvents(){return console.log("Syncing offline events..."),Promise.resolve()},async trackTaskComplete(t,e){return this.logEvent("task_complete",{taskId:t,...e})},async trackPageSwitch(t,e,n){return this.logEvent("page_switch",{from:t,to:e,isAutoAdvance:n})},trackAITaskHelp(t,e,n,r,s){return this.logEvent("ai_task_help",{taskId:t,taskType:e,suggestion:n,wasCorrect:r,attemptNumber:s})},storeOfflineEvent(t){try{const e=JSON.parse(localStorage.getItem("offlineEvents")||"[]");e.push(t),e.length>1e3&&e.shift(),localStorage.setItem("offlineEvents",JSON.stringify(e))}catch(e){console.error("Failed to store offline event:",e)}}};Oe.init();const ot={seedRandom:null,currentSeed:null,initializeSeed(t){this.currentSeed=t;let e=t;this.seedRandom=function(){return e=(e*9301+49297)%233280,e/233280}},getRandom(){return this.seedRandom?this.seedRandom():Math.random()},generateCountingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n;e==="easy"?n=(t-1)%5+1:e==="medium"?n=(t-11)%5+6:n=(t-25)%5+11;const s={easy:{1:{target:"the",type:"word"},2:{target:"and",type:"word"},3:{target:"of",type:"word"},4:{target:"to",type:"word"},5:{target:"in",type:"word"}},medium:{6:{target:"e",type:"letter"},7:{target:"a",type:"letter"},8:{target:"i",type:"letter"},9:{target:"o",type:"letter"},10:{target:"s",type:"letter"}},hard:{11:{targets:["a","e"],type:"multi-letter"},12:{targets:["i","o"],type:"multi-letter"},13:{targets:["s","t"],type:"multi-letter"},14:{targets:["n","r"],type:"multi-letter"},15:{targets:["l","d"],type:"multi-letter"}}}[e][n];let i="";return s.type==="word"?i=`Count how many times the word "${s.target}" appears:`:s.type==="letter"?i=`Count how many times the letter "${s.target}" appears (case-insensitive):`:i=`Count how many times the letters "${s.targets[0]}" and "${s.targets[1]}" appear in total:`,{...s,instruction:i,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},generateSliderPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n,r,s;return e==="easy"?(n=Math.floor(this.getRandom()*11),r=1,s=!0):e==="medium"?(n=Math.round(this.getRandom()*10*10)/10,r=.1,s=!0):(n=Math.round(this.getRandom()*10*100)/100,r=.01,s=(t-25)%5!==0),{target:n,step:r,showValue:s,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1),precision:e==="easy"?0:e==="medium"?1:2}},generateTypingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard",n={easy:["hello world","quick test","type this","easy mode","simple text","good job","keep going","nice work","almost done","level up"],medium:["HeLLo WoRLd","QuIcK tEsT","TyPe ThIs","MeDiUm MoDe","MiXeD cAsE","KeEp GoInG","NiCe WoRk","AlMoSt DoNe","LeVeL uP","ChAlLeNgE","TeSt RuN","NeXt LeVeL","TrY aGaIn","GoOd LuCk","FiNaL tEsT"],hard:["Test@123","Go4It!Now","X9%Y8&Z7*","P6!Q5?R4+","Z1@Y2#X3$","M7&N8*O9!","J4%K5^L6&","D1!E2@F3#","A7$B8%C9^","V3*W4+X5=","Q2#R3$S4%","H5^I6&J7*","K8(L9)M0!","N1@O2#P3$","T4%U5^V6&","W7*X8(Y9)","C0!D1@E2#","F3$G4%H5^","I6&J7*K8(","L9)M0!N1@","O2#P3$Q4%","R5^S6&T7*","U8(V9)W0!","X1@Y2#Z3$","A4%B5^C6&"]};let r;if(e==="easy"){const s=(t-1)%n.easy.length;r=n.easy[s]}else if(e==="medium"){const s=(t-11)%n.medium.length;r=n.medium[s]}else{const s=(t-25)%n.hard.length;r=n.hard[s]}return{pattern:r,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},textPassages:["The University of California, Berkeley (UC Berkeley, Berkeley, Cal, or California) is a public land-grant research university in Berkeley, California, United States. Founded in 1868 and named after the Anglo-Irish philosopher George Berkeley, it is the state's first land-grant university and is the founding campus of the University of California system.","Berkeley has an enrollment of more than 45,000 students. The university is organized around fifteen schools of study on the same campus, including the College of Chemistry, the College of Engineering, College of Letters and Science, and the Haas School of Business.",'The Berkeley campus encompasses approximately 1,232 acres, though the "central campus" occupies only the low-lying western 178 acres. The campus contains numerous wooded areas, including the Eucalyptus Grove and Strawberry Creek, which runs through the center of campus.',"Oski the Bear (Oski) is the official mascot of the University of California, Berkeley, representing the California Golden Bears. Named after the Oski Yell, he made his debut at a freshman rally in the Greek Theatre on September 25, 1941.","Berkeley faculty, alumni, and researchers have won 111 Nobel laureates, 25 Turing Award winners, and 19 Academy Award winners. The university has produced many notable alumni in various fields including science, politics, business, and entertainment.","The university's athletic teams compete as the California Golden Bears and are members of the Atlantic Coast Conference for most sports. Berkeley teams have won 107 national championships, including 45 NCAA national championships.","Research at Berkeley is conducted within departments, organized research units, and interdisciplinary research centers. Berkeley operates Lawrence Berkeley National Laboratory, manages Los Alamos National Laboratory, and is a founding partner of the Space Sciences Laboratory.","The Berkeley campus offers over 350 degree programs through its 14 colleges and schools. Popular majors include Computer Science, Economics, Political Science, and Business Administration. The student-faculty ratio is 17:1.","Berkeley's libraries contain more than 13 million volumes and maintain special collections including the Mark Twain Papers, the Oral History Center, and the Bancroft Library, which houses the largest collection of materials on California history.","The campus is home to several museums including the Berkeley Art Museum and Pacific Film Archive, the Lawrence Hall of Science, and the UC Botanical Garden. These facilities serve both educational and public outreach purposes.","Notable Berkeley inventions and discoveries include the cyclotron, the atomic bomb, the flu vaccine, and vitamin E. Berkeley researchers discovered 16 chemical elements of the periodic table, more than any other university.","The Free Speech Movement, which took place during the 1964-65 academic year, was a pivotal moment in the history of civil liberties in the United States. It began when students protested a ban on political activities on campus.","Berkeley's Campanile, known as Sather Tower, is the third-tallest clock tower in the world at 307 feet. It was completed in 1914 and is visible for miles, serving as a symbol of the university.","The university operates on a semester system, with fall semester beginning in late August and spring semester beginning in mid-January. Berkeley offers over 5,000 courses each semester across all disciplines.",`Cal Bears have won at least one team national title in 13 different sports. The university's traditional rival is Stanford University, with the annual football game known as "The Big Game" dating back to 1892.`],getTextPassage(t){if(this.seedRandom){const e=Math.floor(this.getRandom()*this.textPassages.length),n=(t-1+e)%this.textPassages.length;return this.textPassages[n]}else{const e=(t-1)%this.textPassages.length;return this.textPassages[e]}}};function Jd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r,preGeneratedPattern:s=null,preGeneratedText:i=null}){const[a,l]=N.useState(""),[c,h]=N.useState(""),[p,y]=N.useState(null),[m,S]=N.useState(""),[k,b]=N.useState(null),[L,A]=N.useState(""),[T,I]=N.useState(""),[V]=N.useState(Date.now()),[B,F]=N.useState(""),[w,g]=N.useState(!1),[_,x]=N.useState(new Set),C=N.useRef(0);N.useRef(null);const R=(ee,D=null,W=null)=>{const P=document.createElement("canvas"),M=P.getContext("2d");P.width=900,P.height=400,M.fillStyle="#fafafa",M.fillRect(0,0,P.width,P.height),M.strokeStyle="#e0e0e0",M.lineWidth=2,M.strokeRect(0,0,P.width,P.height),M.font="24px monospace",M.fillStyle="#333";const U=36,$=25,Y=P.width-$*2;return((re,Se)=>{const ye=re.split(" "),Ae=[];let me="";for(let ne of ye){const Re=me+(me?" ":"")+ne;M.measureText(Re).width>Se&&me?(Ae.push(me),me=ne):me=Re}return me&&Ae.push(me),Ae})(ee,Y).forEach((re,Se)=>{const ye=$+(Se+1)*U;let Ae=$;if(t<=5){const me=re.split(" ");let ne=0;me.forEach(Re=>{const de=W&&W.has(ne),ge=D&&D.some(be=>Re.toLowerCase()===be.toLowerCase());if(de){const be=M.measureText(Re).width;M.fillStyle="yellow",M.fillRect(Ae-2,ye-18,be+4,24)}else if(ge){const be=M.measureText(Re).width;M.fillStyle="rgba(255, 215, 0, 0.4)",M.fillRect(Ae-2,ye-18,be+4,24)}M.fillStyle="#333",M.fillText(Re,Ae,ye),Ae+=M.measureText(Re+" ").width,ne++})}else for(let me=0;me<re.length;me++){const ne=re[me],Re=M.measureText(ne).width;D&&D.some(ge=>ne.toLowerCase()===ge.toLowerCase())&&(M.fillStyle="rgba(255, 215, 0, 0.4)",M.fillRect(Ae-1,ye-18,Re+2,24)),M.fillStyle="#333",M.fillText(ne,Ae,ye),Ae+=Re}}),P.toDataURL()};N.useEffect(()=>{S(0),b(null),C.current=0},[t]),N.useEffect(()=>{const ee=async(W,P)=>{const M=document.createElement("canvas"),U=M.getContext("2d");M.width=900,M.height=350,U.fillStyle="#fafafa",U.fillRect(0,0,M.width,M.height),U.strokeStyle="#e0e0e0",U.lineWidth=2,U.strokeRect(0,0,M.width,M.height),U.font="24px monospace";const $=36,Y=20,te=M.width-Y*2,re=((Se,ye)=>{const Ae=Se.split(" "),me=[];let ne="";for(let Re of Ae){const de=ne+(ne?" ":"")+Re;U.measureText(de).width>ye&&ne?(me.push(ne),ne=Re):ne=de}return ne&&me.push(ne),me})(L,te);for(let Se=0;Se<W.length;Se++)W[Se],re.forEach((ye,Ae)=>{const me=Y+(Ae+1)*$;let ne=Y;for(let Re=0;Re<ye.length;Re++){const de=ye[Re],ge=U.measureText(de).width;W.some(st=>de.toLowerCase()===st.toLowerCase())&&(U.fillStyle="rgba(255, 255, 0, 0.6)",U.fillRect(ne-1,me-20,ge+2,26)),U.fillStyle="#333",U.fillText(de,ne,me),ne+=ge}}),F(M.toDataURL()),await new Promise(ye=>setTimeout(ye,300));setTimeout(()=>{S(P.toString())},300)},D=async W=>{const{action:P,highlightWords:M,suggestedCount:U,animate:$,isMultiLetter:Y,targetLetters:te}=W.detail||{};if(P==="highlightAndCount"){if(Y&&Array.isArray(te)){$&&await ee(te,U);return}if(Array.isArray(M)&&$){L.split(" ");let q=[];for(let re=0;re<M.length;re++){q.push(M[re]);const Se=document.createElement("canvas"),ye=Se.getContext("2d");Se.width=900,Se.height=350,ye.fillStyle="#fafafa",ye.fillRect(0,0,Se.width,Se.height),ye.strokeStyle="#e0e0e0",ye.lineWidth=2,ye.strokeRect(0,0,Se.width,Se.height),ye.font="24px monospace";const Ae=36,me=20,ne=Se.width-me*2;((ge,be)=>{const st=ge.split(" "),qt=[];let Zt="";for(let Vt of st){const Ir=Zt+(Zt?" ":"")+Vt;ye.measureText(Ir).width>be&&Zt?(qt.push(Zt),Zt=Vt):Zt=Ir}return Zt&&qt.push(Zt),qt})(L,ne).forEach((ge,be)=>{const st=me+(be+1)*Ae;let qt=me;ge.split(" ").forEach(Vt=>{const Ir=ye.measureText(Vt).width;q.some(Cr=>{const nr=Vt.replace(/[.,;!?]/g,"").toLowerCase(),Gs=Cr.replace(/[.,;!?]/g,"").toLowerCase();return nr===Gs})&&(ye.fillStyle="rgba(255, 255, 0, 0.5)",ye.fillRect(qt-2,st-18,Ir+4,24)),ye.fillStyle="#333",ye.fillText(Vt,qt,st),qt+=ye.measureText(Vt+" ").width})}),F(Se.toDataURL()),await new Promise(ge=>setTimeout(ge,200))}setTimeout(()=>{S(U.toString())},300)}}};return window.addEventListener("aiCountingHelp",D),()=>window.removeEventListener("aiCountingHelp",D)},[L,t]),N.useEffect(()=>{var M;const ee=s||ot.generateCountingPattern(t),D=i||ot.getTextPassage(t);A(D),l(ee.target||((M=ee.targets)==null?void 0:M.join(", "))),h(ee.instruction);let W=0;if(ee.type==="word"){const U=new RegExp(`\\b${ee.target}\\b`,"gi"),$=D.match(U);W=$?$.length:0}else if(ee.type==="letter"){const U=new RegExp(ee.target,"gi"),$=D.match(U);W=$?$.length:0}else ee.type==="multi-letter"&&ee.targets.forEach(U=>{const $=new RegExp(U,"gi"),Y=D.match($);W+=Y?Y.length:0});y(W);const P=R(D,null);F(P)},[t,s,i]);const E=async()=>{const ee=Date.now()-V,D=parseInt(m,10)||0,W=p??0,P=Math.abs(D-W),M=`g1t${t}`,U=localStorage.getItem(`lastAIHelp_${M}`);if(U){const te=JSON.parse(U),q=Date.now()-te.timestamp,re=D===te.suggestion?"accepted":"modified";await Oe.trackAIHelpResponse(M,te.type,te.suggestion,re,D,q),localStorage.removeItem(`lastAIHelp_${M}`)}let $=0;P===0?$=2:P<=1?$=1:$=0,C.current+=1,await Oe.trackTaskAttempt(M,C.current,!0,ee,D,W);const Y=localStorage.getItem("sessionId");if(Y&&!Y.startsWith("offline-"))try{await dr(bt(Xe,"sessions",Y),{[`taskAccuracies.g1t${t}`]:$===2?100:$===1?70:0,[`taskTimes.g1t${t}`]:ee,[`taskPoints.g1t${t}`]:$,lastActivity:Ln()})}catch(te){console.error("Error storing accuracy:",te)}b($===2?" Perfect! 2 points earned!":$===1?` Off by ${P} - 1 point earned!`:` Off by ${P} - 0 points earned.`),setTimeout(()=>{e==null||e(`g1t${t}`,{attempts:C.current,totalTime:ee,accuracy:$===2?100:$===1?70:0,userAnswer:D,correctAnswer:W,points:$})},500)},pe=ot.generateCountingPattern(t).difficultyLabel,Ee=t<=5?"easy":t<=10?"medium":"hard";return u.jsxs("div",{className:"task counting",children:[u.jsxs("h3",{children:["Research Content - Level ",t]}),u.jsx("div",{className:`difficulty-badge ${Ee}`,children:pe}),u.jsxs("p",{className:"instruction",children:[u.jsx("strong",{children:c}),u.jsx("br",{}),u.jsx("span",{className:"hint",children:"(Case-insensitive)"})]}),u.jsxs("div",{className:"text-display text-to-count","data-counting-text":L,children:[u.jsx("div",{className:"count-target","data-pattern":a,style:{display:"none"},children:a}),B?u.jsx("img",{src:B,alt:"Text passage for counting",style:{width:"100%",maxWidth:"900px",height:"auto",maxHeight:"350px",objectFit:"contain",border:"none",userSelect:"none",pointerEvents:"none"},onContextMenu:ee=>ee.preventDefault(),draggable:!1}):u.jsx("div",{dangerouslySetInnerHTML:{__html:T}})]}),u.jsxs("div",{className:"input-section",children:[u.jsx("label",{children:"Your answer:"}),u.jsx("input",{type:"number",min:"0",max:"999",value:m,onChange:ee=>S(ee.target.value),onKeyPress:ee=>{ee.key==="Enter"&&E()},placeholder:"Enter count"})]}),u.jsx("button",{onClick:E,className:"submit-btn",style:{display:"block",margin:"20px auto 0"},children:"Submit"}),k&&u.jsx("div",{className:`feedback ${k.includes("2 points")?"correct":k.includes("0 points")?"incorrect":"partial"}`,children:k})]})}function Zd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r,preGeneratedPattern:s=null}){const[i,a]=N.useState(5),[l,c]=N.useState(0),[h,p]=N.useState(null),[y]=N.useState(Date.now()),[m,S]=N.useState(1),[k,b]=N.useState(!0),[L,A]=N.useState(!1),[T,I]=N.useState(!1),[V,B]=N.useState(!1),[F,w]=N.useState(!1),g=N.useRef(null),_=N.useRef(0);N.useEffect(()=>{if(n)a(3),S(1),b(!0);else{const D=s||ot.generateSliderPattern(t);a(D.target),S(D.step),b(D.showValue)}c(0),p(null),_.current=0},[t,n,s]),N.useEffect(()=>{const D=W=>{const{action:P,value:M,animate:U}=W.detail;if(P==="moveSlider")if(I(!0),U){const $=parseFloat(l),Y=parseFloat(M),te=1e3,q=30;let re=0;const Se=setInterval(()=>{re++;const ye=re/q,Ae=1-Math.pow(1-ye,3),me=$+(Y-$)*Ae;c(parseFloat(me.toFixed(2))),re>=q&&(clearInterval(Se),I(!1),c(parseFloat(Y.toFixed(2))))},te/q)}else c(parseFloat(M.toFixed(2))),I(!1)};return window.addEventListener("aiSliderHelp",D),()=>window.removeEventListener("aiSliderHelp",D)},[l]),N.useEffect(()=>{const D=W=>{W.key==="Enter"&&!T&&E()};return document.addEventListener("keypress",D),()=>document.removeEventListener("keypress",D)},[T,l,i]);const x=D=>{if(T)return;const W=g.current;if(!W)return;D.preventDefault();const P=W.getBoundingClientRect(),M=l/10,U=P.left+P.width*M,$=D.clientX||D.touches&&D.touches[0].clientX;Math.abs($-U)<30&&(B(!0),w(!0))},C=D=>{if(!V||T)return;const W=g.current;if(!W)return;const P=W.getBoundingClientRect(),M=D.clientX||D.touches&&D.touches[0].clientX,$=Math.max(0,Math.min(1,(M-P.left)/P.width))*10,Y=Math.round($/m)*m;c(parseFloat(Y.toFixed(2)))},R=()=>{B(!1)};N.useEffect(()=>{if(V){const D=P=>C(P),W=()=>R();return document.addEventListener("mousemove",D),document.addEventListener("mouseup",W),document.addEventListener("touchmove",D),document.addEventListener("touchend",W),()=>{document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",W),document.removeEventListener("touchmove",D),document.removeEventListener("touchend",W)}}},[V,m,T]);const E=async()=>{const D=Date.now()-y,W=parseFloat(l),P=Math.abs(W-i),M=`g2t${t}`,U=localStorage.getItem(`lastAIHelp_${M}`);if(U){const te=JSON.parse(U),q=Date.now()-te.timestamp,re=W===te.suggestion?"accepted":"modified";await Oe.trackAIHelpResponse(M,te.type,te.suggestion,re,W,q),localStorage.removeItem(`lastAIHelp_${M}`)}let $=0;P===0?$=2:P<=1?$=1:$=0,_.current+=1,await Oe.trackTaskAttempt(M,_.current,!0,D,W,i);const Y=localStorage.getItem("sessionId");if(Y&&!Y.startsWith("offline-"))try{await dr(bt(Xe,"sessions",Y),{[`taskDifferences.g2t${t}`]:P,[`taskTimes.g2t${t}`]:D,[`taskPoints.g2t${t}`]:$,lastActivity:Ln()})}catch(te){console.error("Error storing difference:",te)}p($===2?" Perfect! 2 points earned!":$===1?` Off by ${P.toFixed(2)} - 1 point earned!`:` Off by ${P.toFixed(2)} - 0 points earned.`),setTimeout(()=>{e(`g2t${t}`,{attempts:_.current,totalTime:D,accuracy:$===2?100:$===1?70:0,userAnswer:W,correctAnswer:i,points:$})},500)},oe=ot.generateSliderPattern(t),pe=oe.difficultyLabel,Ee=oe.difficulty,ee=()=>{const D=[];for(let W=0;W<=10;W++)D.push(u.jsxs("div",{style:{position:"absolute",left:`${W*10}%`,transform:"translateX(-50%)",textAlign:"center"},children:[u.jsx("div",{style:{width:"2px",height:"12px",background:"#666",margin:"0 auto"}}),u.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:W})]},W));return D};return u.jsxs("div",{className:`task slider ${T?"ai-controlled":""}`,children:[u.jsxs("h3",{children:["Material Creation - Level ",t]}),u.jsx("div",{className:`difficulty-badge ${Ee}`,children:pe}),u.jsxs("p",{className:"instruction",children:["Move the slider to:"," ",u.jsx("strong",{className:"target-value","data-target-value":i,children:i}),u.jsx("br",{}),u.jsx("span",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:!F&&"Hold and drag the slider handle to move it"})]}),u.jsxs("div",{className:"slider-container",children:[u.jsxs("div",{className:"range-labels",children:[u.jsx("span",{children:"0"}),u.jsx("span",{children:"10"})]}),u.jsxs("div",{style:{position:"relative",padding:"20px 0 30px 0"},children:[u.jsx("div",{style:{position:"absolute",width:"100%",height:"20px",top:"0"},children:ee()}),u.jsx("div",{style:{position:"relative",marginTop:"20px"},children:u.jsx("input",{ref:g,type:"range",min:"0",max:"10",step:m,value:l,onChange:D=>{!V&&!T&&(c(parseFloat(D.target.value)),w(!0))},className:"slider-input",style:{width:"100%",cursor:V?"grabbing":"grab"},onMouseDown:x,onTouchStart:x})})]}),u.jsx("div",{className:"current-value",children:k?parseFloat(l).toFixed(n?0:oe.precision):"??"})]}),u.jsx("button",{onClick:E,className:"submit-btn",disabled:T,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),h&&u.jsx("div",{className:`feedback ${h.includes("2 points")?"correct":h.includes("0 points")?"incorrect":"partial"}`,children:h})]})}function eh({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r,preGeneratedPattern:s=null}){const[i,a]=N.useState(""),[l,c]=N.useState(""),[h,p]=N.useState(null),[y]=N.useState(Date.now()),[m,S]=N.useState(""),[k,b]=N.useState(!1),L=N.useRef(0),A=F=>{const w=document.createElement("canvas"),g=w.getContext("2d");return w.width=600,w.height=150,g.fillStyle="#f5f5f5",g.fillRect(0,0,w.width,w.height),g.font='bold 40px "Courier New", monospace',g.fillStyle="#333",g.textAlign="center",g.textBaseline="middle",g.fillText(F,w.width/2,w.height/2),w.toDataURL()};N.useEffect(()=>{const w=(s||ot.generateTypingPattern(t)).pattern;a(w);const g=A(w);S(g)},[t,s]),N.useEffect(()=>{c(""),p(null),L.current=0},[t]),N.useEffect(()=>{const F=w=>{const{action:g,text:_,typeSpeed:x}=w.detail;if(g==="autoType"&&_){b(!0),c("");let C="",R=0;const E=setInterval(()=>{R<_.length?(C+=_[R],c(C),R++):(clearInterval(E),b(!1))},x||50);return()=>clearInterval(E)}};return window.addEventListener("aiTypingHelp",F),()=>window.removeEventListener("aiTypingHelp",F)},[]);const T=async()=>{const F=Date.now()-y,w=`g3t${t}`,g=localStorage.getItem(`lastAIHelp_${w}`);if(g){const E=JSON.parse(g),oe=Date.now()-E.timestamp,pe=l===E.suggestion?"accepted":"modified";await Oe.trackAIHelpResponse(w,E.type,E.suggestion,pe,l,oe),localStorage.removeItem(`lastAIHelp_${w}`)}const x=((E,oe)=>{const pe=E.length,Ee=oe.length,ee=Array(pe+1).fill(null).map(()=>Array(Ee+1).fill(0));for(let D=0;D<=pe;D++)ee[D][0]=D;for(let D=0;D<=Ee;D++)ee[0][D]=D;for(let D=1;D<=pe;D++)for(let W=1;W<=Ee;W++)E[D-1]===oe[W-1]?ee[D][W]=ee[D-1][W-1]:ee[D][W]=Math.min(ee[D-1][W]+1,ee[D][W-1]+1,ee[D-1][W-1]+1);return ee[pe][Ee]})(l,i);let C=0;x===0?C=2:x===1?C=1:C=0,L.current+=1,await Oe.trackTaskAttempt(w,L.current,!0,F,l,i);const R=localStorage.getItem("sessionId");if(R&&!R.startsWith("offline-"))try{await dr(bt(Xe,"sessions",R),{[`taskAccuracies.g3t${t}`]:C===2?100:C===1?70:0,[`taskTimes.g3t${t}`]:F,[`taskPoints.g3t${t}`]:C,lastActivity:Ln()})}catch(E){console.error("Error storing accuracy:",E)}p(C===2?" Perfect! 2 points earned!":C===1?" 1 typo - 1 point earned!":` ${x} errors - 0 points earned.`),setTimeout(()=>{e(`g3t${t}`,{attempts:L.current,totalTime:F,accuracy:C===2?100:C===1?70:0,userAnswer:l,correctAnswer:i,points:C})},500)},I=ot.generateTypingPattern(t),V=I.difficultyLabel,B=I.difficulty;return u.jsxs("div",{className:"task typing",style:{maxWidth:"100%"},children:[u.jsxs("h3",{children:["Student Engagement - Level ",t]}),u.jsx("div",{className:`difficulty-badge ${B}`,children:V}),u.jsx("p",{className:"instruction",children:"Type this pattern exactly:"}),u.jsxs("div",{className:"pattern-display",children:[u.jsx("div",{className:"typing-pattern","data-typing-pattern":i,style:{display:"none"},children:i}),m?u.jsx("img",{src:m,alt:"Pattern to type",style:{width:"100%",maxWidth:"600px",height:"auto",userSelect:"none",pointerEvents:"none"},onContextMenu:F=>F.preventDefault(),draggable:!1}):u.jsx("span",{className:"pattern-text",children:i})]}),u.jsx("div",{className:"input-section",style:{width:"90%",maxWidth:"900px",margin:"20px auto 0"},children:u.jsx("input",{type:"text",inputMode:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:l,onChange:F=>!k&&c(F.target.value),onKeyPress:F=>{F.key==="Enter"&&!k&&(F.preventDefault(),T())},placeholder:"Type here...",className:"typing-input",disabled:k,style:{backgroundColor:k?"#e3f2fd":"white",transition:"background-color 0.3s",width:"100%",maxWidth:"100%",fontFamily:'"Courier New", monospace',fontSize:"28px",padding:"12px 14px",border:"2px solid #e0e0e0",borderRadius:"8px",boxSizing:"border-box"}})}),u.jsx("button",{onClick:T,className:"submit-btn",disabled:k,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),h&&u.jsx("div",{className:`feedback ${h.includes("2 points")?"correct":h.includes("0 points")?"incorrect":"partial"}`,children:h})]})}function yI({current:t,completed:e,onSwitch:n,limitMode:r,taskPoints:s={},categoryMultipliers:i={},starGoals:a={},categoryPoints:l={},timeRemaining:c=null}){const h=()=>{const I=l.materials||0,V=1+(l.research||0)*.15,B=parseFloat(localStorage.getItem("engagementInterest")||"0")||0;return I*V+B},p=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,y=1+(l.research||0)*.15,m=[];for(let I=1;I<=3;I++)for(let V=1;V<=100;V++){const B=["Research","Materials","Engage"][I-1];m.push({id:`g${I}t${V}`,label:`${B} ${V}`,game:I})}const S=I=>{const V=I.id[1],B=parseInt(I.id.substring(3));if(B===1)return!0;const F=`g${V}t${B-1}`;return e[F]===!0},k={2:m.filter(I=>I.game===2),1:m.filter(I=>I.game===1),3:m.filter(I=>I.game===3)},b={1:"#9C27B0",2:"#4CAF50",3:"#f44336"},L={1:"",2:"",3:""},A={1:"Research",2:"Materials",3:"Engagement"},T={1:"research",2:"materials",3:"engagement"};return u.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"25px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"25px"},children:[2,1,3].map(I=>{const V=k[I],B=V.filter(C=>e[C.id]).length,F=T[I],w=B+1,g=I==="1"?(l.research||0)*.15:0,_=I==="3"?(l.engagement||0)*.0015:0,x=g>0||_>0;return u.jsxs("div",{style:{background:`linear-gradient(135deg, ${b[I]}10 0%, ${b[I]}05 100%)`,borderRadius:"12px",border:`2px solid ${b[I]}20`,padding:"20px",position:"relative",overflow:"hidden",boxShadow:x?`0 0 20px ${b[I]}20`:"none",transition:"all 0.3s ease"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"15px"},children:[u.jsx("span",{style:{fontSize:"28px"},children:L[I]}),u.jsxs("div",{style:{flex:1},children:[u.jsx("h3",{style:{margin:0,color:b[I],fontSize:"18px",fontWeight:"bold"},children:A[I]}),u.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:["Level ",Math.min(w,30)]})]}),l&&l[F]>0&&u.jsxs("div",{style:{background:b[I],color:"white",padding:"6px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[l[F]," pts"]})]}),I==="1"&&(l.research||0)>0&&u.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",(l.research*15).toFixed(0),"%"]}),I==="3"&&(l.engagement||0)>0&&u.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",((l.engagement||0)*.15).toFixed(1),"% interest/task"]}),u.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:V.filter(C=>parseInt(C.id.substring(3))<=w).map(C=>{const R=S(C),E=e[C.id],oe=t===C.id,pe=parseInt(C.id.substring(3)),Ee=s[C.id]||0;return u.jsxs("button",{disabled:!R||E,onClick:()=>R&&!E&&n(C.id),style:{position:"relative",width:"40px",height:"40px",padding:"0",fontSize:"14px",fontWeight:oe?"bold":"500",border:`2px solid ${oe?b[I]:E?`${b[I]}40`:"#e0e0e0"}`,borderRadius:"8px",background:oe?b[I]:E?`${b[I]}10`:"white",color:oe?"white":E?b[I]:"#333",cursor:R&&!E?"pointer":"not-allowed",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",opacity:E?.7:1,boxShadow:oe?`0 2px 8px ${b[I]}40`:"none",transform:"translateY(0)",willChange:"transform, box-shadow"},onMouseEnter:ee=>{R&&!oe&&!E&&requestAnimationFrame(()=>{ee.currentTarget.style.transform="translateY(-2px)",ee.currentTarget.style.boxShadow=`0 4px 12px ${b[I]}30`})},onMouseLeave:ee=>{R&&!oe&&!E&&requestAnimationFrame(()=>{ee.currentTarget.style.transform="translateY(0)",ee.currentTarget.style.boxShadow="none"})},title:E?`Level ${pe} completed (${Ee} pts)`:R?`Start Level ${pe}`:`Complete Level ${pe-1} first`,children:[pe,E&&u.jsx("span",{style:{position:"absolute",top:"-4px",right:"-4px",background:b[I],color:"white",width:"16px",height:"16px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"bold"},children:""}),E&&u.jsx("div",{style:{position:"absolute",bottom:"2px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"2px"},children:Ee===0?u.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",border:`1px solid ${b[I]}`,background:"transparent"}}):[...Array(Math.min(Ee,2))].map((ee,D)=>u.jsx("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:b[I]}},D))})]},C.id)})})]},I)})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",background:"#f8f9fa",borderRadius:"8px",flexWrap:"wrap",gap:"20px"},children:[c!==null&&u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""}),u.jsxs("div",{children:[u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:c<60?"#f44336":"#333"},children:[Math.floor(c/60),":",(c%60).toString().padStart(2,"0")]}),c<180&&c>0&&u.jsx("div",{style:{fontSize:"11px",color:"#ff9800"},children:"Hurry up!"})]})]}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Tasks Completed"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:Object.keys(e).length})]}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Student Learning"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:Math.round(h())}),u.jsxs("div",{style:{fontSize:"10px",color:"#999"},children:[l.materials||0," (materials)  ",y.toFixed(2)," (research) + ",p.toFixed(1)," (cumulative engagement interest)"]})]}),t&&u.jsxs("div",{style:{padding:"8px 16px",background:t.startsWith("g1")?"#9C27B0":t.startsWith("g2")?"#4CAF50":"#f44336",color:"white",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:["Current:"," ",t.replace("g1t","Research ").replace("g2t","Materials ").replace("g3t","Engage ")]})]})]})}function vI({practiceCompleted:t={},onPracticeComplete:e,onStartMainGame:n,onSelectPractice:r,isAdmin:s=!1}){const[i,a]=N.useState(null),l=(m,S)=>{if(S&&S.points===2){typeof e=="function"&&e(m,S);const k=document.createElement("div");k.className="notification-enter",k.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",k.textContent="Perfect! Practice task completed. Returning to menu...",document.body.appendChild(k),setTimeout(()=>{a(null),document.body.contains(k)&&document.body.removeChild(k)},1500)}else{const k=(S==null?void 0:S.points)||0,b=document.createElement("div");b.className="notification-enter",b.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #ff9800; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",b.textContent=`Practice requires 100% accuracy. You scored ${k===1?"50%":"0%"}. Try again!`,document.body.appendChild(b),setTimeout(()=>{document.body.contains(b)&&document.body.removeChild(b)},3e3)}},c=t.g2t1&&t.g1t1&&t.g3t1,h=()=>u.jsxs("div",{className:"practice-menu",children:[u.jsxs("h2",{children:["Practice Mode ",!s&&"(Required)"]}),!s&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",borderRadius:"12px",padding:"16px",marginBottom:"25px",border:"2px solid #f57c00",boxShadow:"0 4px 6px rgba(245, 124, 0, 0.1)",textAlign:"center"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""}),u.jsx("strong",{style:{color:"#e65100",fontSize:"18px"},children:"100% PERFECT ACCURACY REQUIRED"})]}),u.jsxs("div",{style:{color:"#e65100",fontSize:"14px"},children:["You must score 2/2 points (exact answer) on all three practice tasks to proceed.",u.jsx("br",{}),u.jsx("strong",{children:"No partial credit in practice mode!"})]}),u.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"12px"},children:[u.jsxs("span",{style:{padding:"4px 12px",background:t.g2t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g2t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g2t1?"#4CAF50":"#ffb74d"}`},children:["Materials ",t.g2t1?"":"Required"]}),u.jsxs("span",{style:{padding:"4px 12px",background:t.g1t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g1t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g1t1?"#4CAF50":"#ffb74d"}`},children:["Research ",t.g1t1?"":"Required"]}),u.jsxs("span",{style:{padding:"4px 12px",background:t.g3t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g3t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g3t1?"#4CAF50":"#ffb74d"}`},children:["Engagement ",t.g3t1?"":"Required"]})]})]}),u.jsx("p",{className:"practice-hint",style:{textAlign:"center",fontSize:"16px",color:"#666",marginBottom:"30px"},children:"Try each task type before starting the main challenge. No time pressure!"}),u.jsxs("div",{className:"practice-cards",children:[u.jsxs("div",{className:"practice-card materials",children:[u.jsx("h3",{children:" Materials"}),u.jsx("p",{children:"Hold and drag slider to match target values"}),u.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Base points - directly added to score"}),u.jsx("div",{className:"practice-buttons",children:u.jsx("button",{onClick:()=>{a("g2t1"),r&&r("g2t1")},className:t.g2t1?"completed":"",disabled:!1,children:t.g2t1?" Completed":"Try Materials"})})]}),u.jsxs("div",{className:"practice-card research",children:[u.jsx("h3",{children:" Research"}),u.jsx("p",{children:"Count words or letters in text passages"}),u.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 15% multiplier per point in main game"}),u.jsx("div",{className:"practice-buttons",children:u.jsx("button",{onClick:()=>{a("g1t1"),r&&r("g1t1")},className:t.g1t1?"completed":"",disabled:!1,children:t.g1t1?" Completed":"Try Research"})})]}),u.jsxs("div",{className:"practice-card engagement",children:[u.jsx("h3",{children:" Engagement"}),u.jsx("p",{children:"Type patterns exactly as shown"}),u.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 0.15% compound interest per point"}),u.jsx("div",{className:"practice-buttons",children:u.jsx("button",{onClick:()=>{a("g3t1"),r&&r("g3t1")},className:t.g3t1?"completed":"",disabled:!1,children:t.g3t1?" Completed":"Try Engagement"})})]})]}),u.jsxs("div",{style:{marginTop:"25px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",textAlign:"center"},children:[u.jsx("h4",{style:{margin:"0 0 10px 0",color:"#333",fontSize:"16px"},children:"Practice Progress:"}),u.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[u.jsxs("div",{style:{padding:"8px 15px",background:t.g2t1?"#4CAF50":"#e0e0e0",color:t.g2t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Materials ",t.g2t1&&""]}),u.jsxs("div",{style:{padding:"8px 15px",background:t.g1t1?"#9C27B0":"#e0e0e0",color:t.g1t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Research ",t.g1t1&&""]}),u.jsxs("div",{style:{padding:"8px 15px",background:t.g3t1?"#f44336":"#e0e0e0",color:t.g3t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Engagement ",t.g3t1&&""]})]}),u.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#666"},children:[u.jsx("strong",{children:"100% accuracy required"})," to complete each practice task"]})]}),u.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:u.jsx("button",{className:"start-main-game-btn",onClick:n,style:{opacity:!s&&!c?.5:1,cursor:!s&&!c?"not-allowed":"pointer"},disabled:!s&&!c,children:s?"Start Main Game (Admin)":c?"Start Main Game - You're Ready! ":"Complete Practice First"})})]});if(!i)return h();const p=i[1],y=1;return u.jsxs("div",{className:"practice-container",children:[u.jsx("button",{className:"back-to-menu",onClick:()=>a(null),children:" Back to Practice Menu"}),u.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[u.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),u.jsxs("div",{className:"practice-task-wrapper",children:[p==="1"&&u.jsx(Jd,{taskNum:y,onComplete:l,isPractice:!0,currentTaskId:i}),p==="2"&&u.jsx(Zd,{taskNum:y,onComplete:l,isPractice:!0,currentTaskId:i}),p==="3"&&u.jsx(eh,{taskNum:y,onComplete:l,isPractice:!0,currentTaskId:i})]})]})}class xI{constructor(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={}}getUniversalAttemptNumber(){return this.totalAIUsage}shouldAIBeCorrect(e){let n;return e===1||e===2||e===4||e===5?n=!0:e===3?n=!1:n=Math.random()<.75,n}getTaskUsageCount(e){return this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]}incrementTaskUsage(e,n){this.totalAIUsage++,this.usageCount[n]++,this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]++}resetForNewSemester(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={},console.log(" AI Help usage reset for new semester")}helpWithSlider(e,n){this.incrementTaskUsage(n,"materials");const r=this.getUniversalAttemptNumber();let s;if(this.shouldAIBeCorrect(r))s=e;else if(r===3){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else if(Math.random()<.5){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else{const i=(Math.random()<.5?-1:1)*(2+Math.random()*2);s=Math.max(0,Math.min(10,e+i))}return{action:"moveSlider",value:s,animate:!0}}helpWithCounting(e,n,r){this.incrementTaskUsage(r,"research");const s=this.getUniversalAttemptNumber(),i=this.shouldAIBeCorrect(s);return n.length===1||n.includes(" and ")||n.includes(",")?this.helpWithLetterCounting(e,n,s,i):this.helpWithWordCounting(e,n,s,i)}helpWithLetterCounting(e,n,r,s){let i=[];n.includes(" and ")||n.includes(",")?i=n.match(/[a-z]/gi)||[]:i=[n];let a=0;i.forEach(h=>{const p=new RegExp(h,"gi"),y=e.match(p);a+=y?y.length:0});let l=a,c=[...i];if(!s){r===3||Math.random()<.5?l=a+1:l=a+Math.floor(Math.random()*3)+2,l=Math.max(0,l);const p="abcdefghijklmnopqrstuvwxyz".split("").filter(m=>!i.includes(m.toLowerCase())),y=Math.floor(Math.random()*2)+1;for(let m=0;m<y&&p.length>0;m++){const S=Math.floor(Math.random()*p.length);c.push(p[S]),p.splice(S,1)}}return{action:"highlightAndCount",highlightWords:[],suggestedCount:l,animate:!0,isMultiLetter:!0,targetLetters:c}}helpWithWordCounting(e,n,r,s){const i=e.split(/\s+/),a=[];let l=0,c=0;if(i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&c++}),s)i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&(a.push(h),l++)});else if(r===3){l=c+1,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());if(h.length>0&&a.length<l){const p=h[Math.floor(Math.random()*h.length)];a.push(p)}}else{Math.random()<.5?l=c+1:l=c+Math.floor(Math.random()*3)+2,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());for(;a.length<l&&h.length>0;){const p=Math.floor(Math.random()*h.length),y=h[p];a.includes(y)||a.push(y),h.splice(p,1)}}return{action:"highlightAndCount",highlightWords:a,suggestedCount:l,animate:!0}}helpWithTyping(e,n){this.incrementTaskUsage(n,"engagement");const r=this.getUniversalAttemptNumber();let s=e;const i={0:["o","O"],o:["0"],O:["0"],1:["l","I","i"],l:["1","I","i"],I:["1","l","i"],i:["1","l","I"],e:["3"],3:["e"],a:["@"],"@":["a"],s:["5","$"],S:["5","$"],5:["s","S"],$:["s","S"],g:["9"],9:["g"],b:["6"],6:["b"],z:["2"],2:["z"],B:["8"],8:["B"]},a=l=>{const c=l.split(""),h=c.map((p,y)=>i[p]?y:-1).filter(p=>p!==-1);if(h.length>0){const p=h[Math.floor(Math.random()*h.length)],y=c[p],m=i[y];m&&m.length>0&&(c[p]=m[Math.floor(Math.random()*m.length)])}else{const p=["transpose","duplicate","missing"],y=p[Math.floor(Math.random()*p.length)],m=Math.floor(Math.random()*c.length);switch(y){case"transpose":m<c.length-1&&([c[m],c[m+1]]=[c[m+1],c[m]]);break;case"duplicate":c.splice(m,0,c[m]);break;case"missing":c.splice(m,1);break}}return c.join("")};if(this.shouldAIBeCorrect(r))s=e;else if(r===3)s=a(e);else if(Math.random()<.5)s=a(e);else{let l=e;const c=Math.floor(Math.random()*3)+2;for(let h=0;h<c;h++)l=a(l);s=l}return{action:"autoType",text:s,typeSpeed:50,perfect:this.shouldAIBeCorrect(r)}}}const kt=new xI;function sm({bonusPrompts:t=0,currentTask:e="",categoryPoints:n=null,timeRemaining:r=null,calculateStudentLearning:s=()=>0,aiCost:i=0,onAiCost:a,aiDelay:l=0,onPauseTimer:c=null}){const[h,p]=N.useState(!0),[y,m]=N.useState(0),[S,k]=N.useState(!1);N.useEffect(()=>{const M=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");p(M.hasAI!==!1)},[]),N.useEffect(()=>{if(e){const M=kt.getTaskUsageCount(e)>=1;k(M)}},[e]),N.useEffect(()=>{const M=()=>{m(kt.totalAIUsage)},U=setInterval(M,1e3);return M(),()=>clearInterval(U)},[]);const[b,L]=N.useState([{sender:"bot",text:h?"Hello! I'm your AI teaching assistant. You get ONE AI help attempt per task - use it wisely!":"Hello! This is the chat interface. AI assistance is not available for this session."}]),[A,T]=N.useState(""),[I,V]=N.useState(!1),[B,F]=N.useState(0),[w,g]=N.useState(!1),[_,x]=N.useState({materials:0,research:0,engagement:0}),C=N.useRef(null),R=()=>e?e.startsWith("g1")?"research":e.startsWith("g2")?"materials":e.startsWith("g3")?"engagement":null:null,E=(M=null)=>{const U=M||R();if(!U){L(te=>[...te,{sender:"bot",text:"Please start a task first, then I can help you!"}]);return}if(kt.getTaskUsageCount(e)>=1){L(te=>[...te,{sender:"bot",text:" You've already used AI help for this task. Only 1 AI attempt allowed per task!"}]);return}const Y=Date.now();if(Y-_[U]<3e3){L(te=>[...te,{sender:"bot",text:"Please wait a moment before requesting help again!"}]);return}switch(x(te=>({...te,[U]:Y})),l>0&&c&&c(l,"AI Help"),U){case"materials":oe();break;case"research":pe();break;case"engagement":ee();break;default:L(te=>[...te,{sender:"bot",text:"I'm not sure which task you're on. Please try again!"}])}},oe=()=>{var te,q;const M=((te=document.querySelector("[data-target-value]"))==null?void 0:te.getAttribute("data-target-value"))||((q=document.querySelector(".target-value"))==null?void 0:q.textContent)||5,U=kt.helpWithSlider(parseFloat(M),e),$=kt.getUniversalAttemptNumber(),Y=kt.shouldAIBeCorrect($);Oe.logEvent("ai_help_task",{taskId:e,taskType:"slider",helpType:"materials",aiFeedback:U.value,wasCorrect:Y,attemptNumber:$,aiDelay:l||0,currentScore:s()}).catch(re=>console.error("Error tracking slider help:",re)),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"slider",suggestion:U.value,timestamp:Date.now(),wasCorrect:Y})),window.dispatchEvent(new CustomEvent("aiSliderHelp",{detail:U})),m(kt.totalAIUsage),k(!0),L(re=>[...re,{sender:"bot",text:` Helping with materials...
Suggested value: ${U.value.toFixed(2)}`}])},pe=()=>{var $;const M=document.querySelector(".text-to-count"),U=document.querySelector(".count-target");if(M&&U){const Y=M.getAttribute("data-counting-text")||"";let te=(($=U.getAttribute("data-pattern"))==null?void 0:$.replace(/['"]/g,"").trim())||"";const q=kt.helpWithCounting(Y,te,e),re=q.suggestedCount;window.dispatchEvent(new CustomEvent("aiCountingHelp",{detail:q}));const Se=kt.getUniversalAttemptNumber(),ye=kt.shouldAIBeCorrect(Se);Oe.logEvent("ai_help_task",{taskId:e,taskType:"counting",helpType:"research",aiFeedback:re,wasCorrect:ye,attemptNumber:Se,aiDelay:l||0,currentScore:s(),highlightedWords:q.highlightWords||[],targetLetters:q.targetLetters||[],isMultiLetter:q.isMultiLetter||!1}).catch(me=>console.error("Error tracking counting help:",me)),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"counting",suggestion:re,timestamp:Date.now(),wasCorrect:ye,highlightedWords:q.highlightWords||[],targetLetters:q.targetLetters||[]})),m(kt.totalAIUsage),k(!0);const Ae=q.isMultiLetter?"letters/characters":"words";L(me=>[...me,{sender:"bot",text:` Helping with research...
Found ${re} ${Ae}`}])}},Ee=()=>{l>0&&c&&c(l,"AI Planning Help");const M=[" CRITICAL STRATEGY: Do tasks in this EXACT order  1 Engagement (builds interest from the start) 2 Research (multiplies future materials) 3 Materials (gets all multipliers). Materials done early = WASTED points!"," MAXIMUM SCORE ORDER: Engagement FIRST  Research SECOND  Materials LAST! Why? Engagement compounds every task, Research only multiplies FUTURE materials. Doing materials early gets ZERO multiplier!"," WARNING: Research multipliers ONLY apply to materials earned AFTER! If you do materials first, you get NO bonus. Always do ALL engagement & research before touching ANY materials!"," PRO TIP: Complete 100% of Engagement tasks first (builds interest early), then 100% of Research (sets up multipliers), THEN do Materials. This order can DOUBLE your score vs doing materials first!"," OPTIMAL PATH: Think of it like this - Engagement = compound interest (starts early), Research = multiplier (affects future only), Materials = base score (save for last). Wrong order = lost points forever!"],U=M[Math.floor(Math.random()*M.length)];L($=>[...$,{sender:"bot",text:U}]),Oe.logEvent("ai_help_plan",{helpType:"planning",aiFeedback:U,currentTask:e,aiDelay:l,timestamp:Date.now()}).catch($=>console.error("Error tracking planning help:",$))},ee=()=>{const M=document.querySelector("[data-typing-pattern]");if(M){const U=M.getAttribute("data-typing-pattern");if(U){const $=kt.helpWithTyping(U,e),Y=kt.getUniversalAttemptNumber(),te=$.perfect;Oe.logEvent("ai_help_task",{taskId:e,taskType:"typing",helpType:"engagement",aiFeedback:$.text,wasCorrect:te,attemptNumber:Y,aiDelay:l||0,currentScore:s(),originalPattern:U}).catch(q=>console.error("Error tracking typing help:",q)),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"typing",suggestion:$.text,timestamp:Date.now(),wasCorrect:te,originalPattern:U})),window.dispatchEvent(new CustomEvent("aiTypingHelp",{detail:$})),m(kt.totalAIUsage),k(!0),L(q=>[...q,{sender:"bot",text:` Helping with engagement...
Typing: "${$.text.substring(0,30)}${$.text.length>30?"...":""}"`}])}}};N.useEffect(()=>{C.current&&C.current.scrollIntoView({behavior:"smooth"})},[b]);const D=async()=>{if(!A.trim()||I)return;if(i>0&&points<i){L($=>[...$,{id:Date.now(),text:`Not enough points! You need ${i} points to use AI help.`,sender:"system"}]);return}const M={id:Date.now(),text:A,sender:"user"};L($=>[...$,M]),T(""),V(!0),F(0);const U=(globalConfig==null?void 0:globalConfig.aiDelay)||0;if(U>0){const Y=U*1e3/100;let te=0;const q=setInterval(()=>{te++;const re=te/Y*100;F(re),te>=Y&&(clearInterval(q),W(M.text))},100)}else W(M.text)},W=async M=>{try{a&&a(i);const U=await kt.getHelp(currentTaskId,M,taskContext),$={id:Date.now()+1,text:U,sender:"ai"};L(Y=>[...Y,$])}catch(U){console.error("Error getting AI response:",U),L($=>[...$,{id:Date.now()+1,text:"Sorry, I encountered an error. Please try again.",sender:"ai"}])}finally{V(!1),F(0)}},P=R();return u.jsxs("div",{className:"chat-container-sidebar",style:{height:"100%",display:"flex",flexDirection:"column"},children:[u.jsxs("div",{className:"chat-header",children:[u.jsx("h3",{children:h?"AI Teaching Assistant":"Chat Interface"}),u.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"2px"},children:h?"1 AI help per task (reliability varies)":"AI assistance disabled for this session"}),u.jsxs("div",{style:{marginTop:"10px",padding:"8px",background:"#e3f2fd",borderRadius:"6px",border:"1px solid #2196F3"},children:[u.jsxs("div",{style:{fontSize:"12px",color:"#1976d2",fontWeight:"bold"},children:["Student Learning: ",Math.round(s())," pts"]}),u.jsxs("div",{style:{fontSize:"10px",color:"#666",marginTop:"2px"},children:["Mat: ",(n==null?void 0:n.materials)||0," "," ",(1+((n==null?void 0:n.research)||0)*.15).toFixed(2),n!=null&&n.bonus?` ${n.bonus>=0?"+":"-"} ${Math.abs(n.bonus)} (Penalties)`:"","+ Interest"]})]})]}),u.jsx("div",{className:"messages-sidebar",children:u.jsxs("div",{className:"messages-list",children:[b.map(M=>u.jsx("div",{className:`message ${M.sender}`,children:u.jsx("div",{className:"message-content",children:M.text})},M.id)),I&&u.jsxs("div",{className:"message ai loading",children:[u.jsxs("div",{className:"typing-indicator",children:[u.jsx("span",{}),u.jsx("span",{}),u.jsx("span",{})]}),B>0&&u.jsx("div",{style:{width:"100%",height:"4px",background:"#eee",marginTop:"5px",borderRadius:"2px"},children:u.jsx("div",{style:{width:`${B}%`,height:"100%",background:"#2196F3",borderRadius:"2px",transition:"width 0.1s linear"}})})]}),u.jsx("div",{ref:C})]})}),u.jsxs("div",{className:"chat-input-sidebar",children:[u.jsx("input",{type:"text",placeholder:h?"Ask about strategy and tips here...":"Chat disabled - no AI available",value:A,onChange:M=>T(M.target.value),onKeyPress:M=>M.key==="Enter"&&D(),disabled:!h}),u.jsx("button",{onClick:D,disabled:!A.trim()||!h,children:"Send"})]}),h&&u.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f8f9fa"},children:[u.jsxs("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:["AI Usage: ",y," total attempts",S&&u.jsxs("span",{style:{color:"#ff9800",fontWeight:"bold"},children:[" ","| Current task: 1/1 used"]})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"10px"},children:u.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[u.jsxs("button",{onClick:()=>E(),disabled:!P||S,style:{padding:"12px",background:S?"#ff9800":P?"#2196F3":"#ccc",color:"white",border:"none",borderRadius:"8px",cursor:P&&!S?"pointer":"not-allowed",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[u.jsx("span",{style:{fontSize:"18px"},children:""}),S?"AI Used (1/1)":P?"Help Task":"Start task first"]}),u.jsxs("button",{onClick:Ee,style:{padding:"12px",background:"#FF9800",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[u.jsx("span",{style:{fontSize:"18px"},children:""}),"Help Plan"]})]})}),u.jsx("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:P?u.jsx("span",{style:{color:"#4CAF50"},children:" AI ready to help"}):u.jsx("span",{style:{color:"#999"},children:" Navigate to a task to enable AI help"})})]}),!h&&u.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f5f5f5",textAlign:"center",color:"#666",fontSize:"14px"},children:[u.jsx("div",{style:{marginBottom:"5px"},children:" No AI Assistant"}),u.jsx("div",{style:{fontSize:"12px"},children:"Complete tasks using your own judgment"})]})]})}const cu={generateCode(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`${t}-${e}`.toUpperCase()},async createCode(t={}){return{success:!0,code:this.generateCode(),data:t}},async markCodeAsUsed(t,e){if(!t)return{success:!1,error:"No code provided"};try{const n={code:t,status:"used",usedAt:Ln(),sessionId:e,createdAt:Ln()};return await Kd(bt(Xe,"accessCodes",t),n),{success:!0}}catch(n){return console.error("Error marking code as used:",n),{success:!1,error:n.message}}},async checkCodeUsage(t){if(!t)return{used:!1};try{const e=await uu(bt(Xe,"accessCodes",t));if(e.exists()){const n=e.data();return{used:n.status==="used",sessionId:n.sessionId,usedAt:n.usedAt}}return{used:!1}}catch(e){return console.error("Error checking code usage:",e),{used:!1,error:e.message}}},getCodeFromURL(){const t=new URLSearchParams(window.location.search);return t.get("code")||t.get("c")||null},async verifyQualtricsCode(t){return{valid:!1,reason:"Qualtrics codes not yet supported"}}};function _I({onLoginSuccess:t}){const[e,n]=N.useState(""),[r,s]=N.useState(!1),[i,a]=N.useState(""),[l,c]=N.useState(!1),h={MASTER:{section:"ADMIN-MASTER",role:"master_admin",name:"Master Administrator",hasAI:!1,isMasterInterface:!0},ADMIN:{role:"admin",semesterDuration:72e4,name:"Admin User",hasAI:!0,checkpointSemester2:!0}},p=S=>({section:"TESTING-AI-CP",hasAI:!0,checkpointSemester2:!0,displayName:`${S} (Internal Tester - AI + Checkpoint)`}),y=S=>{if(h[S])return{valid:!0,type:"master",data:h[S]};const k=S.trim().replace(/[^a-zA-Z0-9\s\-_]/g,"");return k.length<2?{valid:!1,error:"Please enter a name with at least 2 characters"}:k.length>50?{valid:!1,error:"Name too long. Please use 50 characters or less"}:{valid:!0,type:"tester",condition:p(k),cleanName:k}},m=async S=>{if(S.preventDefault(),!e.trim()){a("Please enter your name");return}s(!0),a("");try{const k=y(e.trim());if(!k.valid){a(k.error||"Invalid Student ID"),s(!1);return}let b={timestamp:new Date().toISOString()};if(k.type==="master"){if(b={...b,studentIdentifier:e,role:k.data.role,semesterDuration:k.data.semesterDuration,displayName:k.data.name,section:k.data.isTestCode?"ADMIN-TEST":"ADMIN",hasAI:k.data.hasAI,checkpointSemester2:k.data.checkpointSemester2,isMasterCode:!0,isTestCode:k.data.isTestCode||!1,isMasterInterface:k.data.isMasterInterface||!1},k.data.isMasterInterface){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",displayName:k.data.name,section:"master_admin",hasAI:!0,checkpointSemester2:!0})),window.location.href=`${window.location.origin}?master=true`;return}}else if(k.type==="tester"){const A=k.condition,T=k.cleanName;b={...b,studentIdentifier:T,role:"tester",semesterDuration:72e4,displayName:A.displayName,section:A.section,hasAI:A.hasAI,checkpointSemester2:A.checkpointSemester2,isMasterCode:!1,isTestUser:!0}}const L=await cu.createCode(b);L.success?(sessionStorage.setItem("gameConfig",JSON.stringify({semesterDuration:b.semesterDuration,role:b.role,studentId:b.studentIdentifier,displayName:b.displayName,section:b.section,hasAI:b.hasAI,checkpointSemester2:b.checkpointSemester2})),window.location.href=`${window.location.origin}?code=${L.code}`):a("Failed to generate access code. Please try again.")}catch(k){console.error("Login error:",k),a("System error. Please try again.")}finally{s(!1)}};return u.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",padding:"20px"},children:[u.jsxs("div",{style:{background:"white",padding:"48px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",maxWidth:"480px",width:"100%"},children:[u.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[u.jsxs("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a202c",marginBottom:"8px",lineHeight:"1.2"},children:["Scheduling Challenge:",u.jsx("br",{}),"Can you beat Park?"]}),u.jsx("p",{style:{fontSize:"16px",color:"#718096",marginTop:"12px"},children:"Enter your name to access the game"})]}),u.jsxs("form",{onSubmit:m,children:[u.jsxs("div",{style:{marginBottom:"24px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#2d3748",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.025em"},children:"Your Name:"}),u.jsx("input",{type:"text",value:e,onChange:S=>n(S.target.value),disabled:r,style:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e2e8f0",borderRadius:"8px",boxSizing:"border-box",fontFamily:"'SF Mono', Monaco, 'Courier New', monospace",transition:"all 0.2s ease",background:"#f7fafc",outline:"none"},onFocus:S=>{S.target.style.borderColor="#2196F3",S.target.style.background="white",S.target.style.boxShadow="0 0 0 3px rgba(33, 150, 243, 0.1)"},onBlur:S=>{S.target.style.borderColor="#e2e8f0",S.target.style.background="#f7fafc",S.target.style.boxShadow="none"}}),u.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"#a0aec0",lineHeight:"1.4"},children:"Enter your first and last name (2-50 characters)"})]}),i&&u.jsxs("div",{style:{background:"#fed7d7",color:"#c53030",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",fontSize:"14px",display:"flex",alignItems:"center",border:"1px solid #fc8181"},children:[u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",style:{marginRight:"8px",flexShrink:0},children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i]}),u.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:"600",background:r?"#cbd5e0":"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:r?"none":"0 4px 6px rgba(33, 150, 243, 0.25)",transform:r?"none":"translateY(0)"},onMouseDown:S=>{r||(S.target.style.transform="translateY(2px)",S.target.style.boxShadow="0 2px 4px rgba(33, 150, 243, 0.25)")},onMouseUp:S=>{r||(S.target.style.transform="translateY(0)",S.target.style.boxShadow="0 4px 6px rgba(33, 150, 243, 0.25)")},onMouseOver:S=>{r||(S.target.style.background="#1976D2")},onMouseOut:S=>{r||(S.target.style.background="#2196F3")},children:r?u.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[u.jsxs("svg",{className:"animate-spin",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px",animation:"spin 1s linear infinite"},children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",strokeOpacity:"0.25"}),u.jsx("path",{d:"M4 12a8 8 0 018-8",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),"Verifying Name..."]}):"Access Game"})]}),u.jsxs("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[u.jsx("p",{style:{fontSize:"14px",color:"#718096",marginBottom:"12px"},children:"Having trouble? Contact your instructor:"}),u.jsxs("p",{style:{fontSize:"16px",color:"#2196F3",fontWeight:"500"},children:["Park Sinchaisri",u.jsx("br",{}),u.jsx("a",{href:"mailto:parksinchaisri@haas.berkeley.edu",style:{color:"#2196F3",textDecoration:"none",borderBottom:"1px solid #2196F3",fontSize:"15px"},children:"parksinchaisri@haas.berkeley.edu"})]}),l&&u.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#f7fafc",borderRadius:"8px",fontSize:"11px",color:"#4a5568",lineHeight:"1.8"},children:[u.jsx("strong",{children:"Test Codes:"}),u.jsxs("div",{style:{marginTop:"8px",fontFamily:"monospace"},children:[u.jsx("div",{children:"ADMIN (Standard Game Mode)"}),u.jsx("div",{children:"MASTER (Master interface)"})]})]})]})]}),u.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const im={async checkDailyLimit(t){var r;if(!t)return{allowed:!0};const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);try{const s=Wr(Xe,"sessions"),i=nI(s,Zg("studentId","==",t),Zg("startTime",">=",n)),a=await bo(i);if(!a.empty){const l=a.docs[0].data(),c=(r=l.startTime)!=null&&r.toDate?l.startTime.toDate():new Date(l.clientStartTime);return{allowed:!1,reason:"daily_limit",existingSession:l,nextAvailable:new Date(n.getTime()+24*60*60*1e3)}}return{allowed:!0}}catch(s){console.error("Error checking daily limit:",s);const i=`played_${t}_${n.toISOString().split("T")[0]}`;return localStorage.getItem(i)?{allowed:!1,reason:"daily_limit",nextAvailable:new Date(n.getTime()+24*60*60*1e3)}:{allowed:!0}}},async markDailyPlay(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=`played_${t}_${n.toISOString().split("T")[0]}`;localStorage.setItem(r,"true");const s=new Date(Date.now()-7*24*60*60*1e3);for(let i=0;i<localStorage.length;i++){const a=localStorage.key(i);if(a&&a.startsWith("played_")){const l=a.split("_")[2];l&&new Date(l)<s&&localStorage.removeItem(a)}}},async checkAccess(){try{const t=cu.getCodeFromURL();if(!t)return{allowed:!1,reason:"Please login with your student ID",requiresCode:!0};const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),n=e.role==="admin"||e.role==="master_admin";if(!n&&e.studentId){const r=await this.checkDailyLimit(e.studentId);if(!r.allowed&&!r.refreshGranted){const i=r.nextAvailable;return{allowed:!1,reason:`You have already completed today's session. Please come back in ${Math.ceil((i-Date.now())/(1e3*60*60))} hours (after midnight).`,dailyLimitReached:!0,nextAvailable:i}}if(sessionStorage.getItem("activeSessionId"))return{allowed:!1,reason:"Page refresh is not allowed during the game. Your session has been terminated.",refreshAttempt:!0}}return e.studentId?(n||await this.markDailyPlay(e.studentId),{allowed:!0,newSession:!0,code:t,codeData:{status:"new",metadata:e},isAdmin:n}):{allowed:!1,reason:"Please login with your Berkeley student ID",requiresCode:!0}}catch(t){console.error("Error in checkAccess:",t);const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");return e.role==="admin"?{allowed:!0,newSession:!0,code:cu.getCodeFromURL(),codeData:{status:"error_bypass",metadata:e},isAdmin:!0}:{allowed:!1,reason:"System error. Please try again.",requiresCode:!0}}},async createSession(t=null,e=null,n=!1){try{const r=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),s=r.role==="admin"||r.role==="master_admin",i={id:crypto.randomUUID(),accessCode:t,studentId:r.studentId||null,role:r.role||"student",semesterDuration:r.semesterDuration||72e4,displayName:r.displayName||"Student",startTime:Ln(),clientStartTime:new Date().toISOString(),status:"active",completedTasks:{},isPractice:n,isAdminSession:s,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`,section:r.section,hasAI:r.hasAI,checkpointSemester2:r.checkpointSemester2},l=(await Yd(Wr(Xe,"sessions"),i)).id;return localStorage.setItem("sessionId",l),sessionStorage.setItem("activeSessionId",l),s||(window.addEventListener("beforeunload",c=>{c.preventDefault(),c.returnValue="Your progress will be lost if you leave this page.",this.handleSessionAbandonment()}),document.addEventListener("visibilitychange",()=>{!s&&document.hidden})),l}catch(r){console.error("Error creating session:",r);const s=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(s.role==="admin"){const i="offline-"+Date.now();localStorage.setItem("sessionId",i),sessionStorage.setItem("activeSessionId",i);const a={id:i,accessCode:t,startTime:Date.now(),status:"active",isOffline:!0,studentId:s.studentId||null,role:s.role||"admin"};return localStorage.setItem("offlineSession",JSON.stringify(a)),i}throw r}},async handleSessionAbandonment(){const t=localStorage.getItem("sessionId");if(t&&!t.startsWith("offline-"))try{await dr(bt(Xe,"sessions",t),{status:"abandoned",abandonedAt:Ln(),abandonReason:"page_unload"})}catch(e){console.error("Error marking session as abandoned:",e)}sessionStorage.removeItem("activeSessionId"),sessionStorage.removeItem("gameConfig")}};function wI(){const[t,e]=N.useState(""),[n,r]=N.useState(!1),[s,i]=N.useState(""),[a,l]=N.useState(!1),c=async()=>{r(!0),i(""),l(!1);try{const p=await cu.createCode({createdBy:"admin",timestamp:new Date().toISOString()});p.success?e(p.code):i("Failed to generate code: "+p.error)}catch(p){i("Error: "+p.message)}finally{r(!1)}},h=()=>{const p=`${window.location.origin}?code=${t}`;navigator.clipboard.writeText(p),l(!0),setTimeout(()=>l(!1),2e3)};return u.jsxs("div",{style:{padding:"40px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, -apple-system, sans-serif"},children:[u.jsx("h1",{style:{color:"#333",marginBottom:"10px"},children:"Admin Dashboard"}),u.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:"Generate access codes for participants"}),u.jsxs("div",{style:{background:"#f8f9fa",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("button",{onClick:c,disabled:n,style:{padding:"12px 30px",fontSize:"16px",background:n?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:"bold"},children:n?"Generating...":"Generate New Access Code"}),t&&u.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"white",borderRadius:"6px",border:"1px solid #e0e0e0"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Generated Code"}),u.jsxs("div",{style:{marginBottom:"20px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Access Code:"}),u.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"18px",fontWeight:"bold"},children:t})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Full URL:"}),u.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"stretch"},children:[u.jsx("input",{type:"text",value:`${window.location.origin}?code=${t}`,readOnly:!0,style:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",background:"#f9f9f9"}}),u.jsx("button",{onClick:h,style:{padding:"10px 20px",background:a?"#4CAF50":"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:a?" Copied!":"Copy URL"})]})]}),u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"4px",fontSize:"14px",color:"#1976d2"},children:[u.jsx("strong",{children:"Note:"})," This code is valid for 24 hours and can only be used once."]})]}),s&&u.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"#ffebee",color:"#c62828",borderRadius:"4px"},children:s})]}),u.jsxs("div",{style:{marginTop:"40px",padding:"20px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666"},children:[u.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"How to use:"}),u.jsxs("ol",{style:{margin:"10px 0",paddingLeft:"20px"},children:[u.jsx("li",{children:"Generate a code using the button above"}),u.jsx("li",{children:"Copy the full URL"}),u.jsx("li",{children:"Share the URL with participants"}),u.jsx("li",{children:"Each participant can use their unique code once"})]})]})]})}function SI({sessionId:t,completedLevels:e,totalTime:n,gameMode:r}){const[s,i]=N.useState(""),[a,l]=N.useState(!1);N.useEffect(()=>{c()},[]);const c=()=>{const p=Date.now().toString(36).toUpperCase(),y=e.toString().padStart(2,"0"),m=r.limit==="time"?"T":"A",S=r.accuracy==="strict"?"S":"L",L=`GAME-${`${t}-${y}-${n}`.split("").reduce((A,T)=>A+T.charCodeAt(0),0).toString(36).toUpperCase().slice(-3)}-${y}-${m}${S}-${p}`;i(L)},h=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(s),l(!0),setTimeout(()=>l(!1),3e3);else{const p=document.createElement("textarea");p.value=s,p.style.position="fixed",p.style.top="0",p.style.left="0",p.style.width="2em",p.style.height="2em",p.style.padding="0",p.style.border="none",p.style.outline="none",p.style.boxShadow="none",p.style.background="transparent",p.style.opacity="0",document.body.appendChild(p),p.focus(),p.select();try{document.execCommand("copy")?(l(!0),setTimeout(()=>l(!1),3e3)):(console.error("Failed to copy using execCommand"),alert("Copy failed. Please manually select and copy the code."))}catch(y){console.error("Failed to copy:",y),alert("Copy failed. Please manually select and copy the code.")}document.body.removeChild(p)}}catch(p){console.error("Clipboard operation failed:",p),alert(`Copy failed. Here's your code to copy manually:

${s}`)}};return u.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"30px",marginTop:"30px",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},children:[u.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:" Your Completion Code"}),u.jsx("p",{style:{marginBottom:"20px",opacity:.9,fontSize:"16px"},children:"Copy this code and paste it into the Qualtrics survey to verify your completion:"}),u.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"20px",marginBottom:"20px",backdropFilter:"blur(10px)"},children:[u.jsx("div",{style:{fontFamily:"monospace",fontSize:"28px",fontWeight:"bold",letterSpacing:"2px",marginBottom:"15px",wordBreak:"break-all",textShadow:"2px 2px 4px rgba(0,0,0,0.2)",userSelect:"text",cursor:"text"},onClick:p=>{const y=window.getSelection(),m=document.createRange();m.selectNodeContents(p.currentTarget),y.removeAllRanges(),y.addRange(m)},title:"Click to select all text",children:s}),u.jsx("button",{onClick:h,style:{padding:"12px 30px",fontSize:"16px",fontWeight:"bold",background:a?"#4CAF50":"white",color:a?"white":"#764ba2",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:a?" Copied!":" Copy Code"})]}),u.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:"6px",padding:"15px",fontSize:"14px",lineHeight:"1.5"},children:[u.jsx("strong",{children:" Important:"})," This code is your proof of completion. Make sure to copy it before closing this window!",u.jsx("br",{}),u.jsx("span",{style:{fontSize:"13px",opacity:.9},children:" Tip: If the Copy button doesn't work, click on the code text to select it, then use Ctrl+C (or Cmd+C on Mac) to copy."})]}),u.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[u.jsx("summary",{style:{cursor:"pointer",opacity:.8,fontSize:"12px",marginBottom:"10px"},children:"Code Details "}),u.jsxs("div",{style:{fontSize:"12px",opacity:.7,background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",fontFamily:"monospace"},children:[u.jsxs("div",{children:["Levels Completed: ",e,"/45"]}),u.jsxs("div",{children:["Game Mode: ",r.limit==="time"?"Time Challenge":"Task Attempts"]}),u.jsxs("div",{children:["Accuracy Mode: ",r.accuracy==="strict"?"Strict (100%)":"Lenient"]}),u.jsxs("div",{children:["Total Time: ",Math.floor(n/60),"m ",n%60,"s"]}),u.jsxs("div",{children:["Generated: ",new Date().toLocaleString()]})]})]})]})}function TI({onClose:t}){const[e,n]=N.useState("config"),[r,s]=N.useState([]),[i,a]=N.useState(!0),[l,c]=N.useState(!1),[h,p]=N.useState(""),[y,m]=N.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,wrongAnswerPenalty:2,switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0,taskOrderStrategy:"sequential_task",difficultyMode:"fixed",scoring:{g1:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g2:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g3:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}}}}),[S,k]=N.useState(!1);N.useEffect(()=>{b(),x()},[]);const b=async()=>{try{const P=bt(Xe,"game_settings","global"),M=await uu(P);M.exists()&&m({...y,...M.data()})}catch(P){console.error("Error loading game config:",P)}},L=async()=>{k(!0);try{const P=bt(Xe,"game_settings","global");await Kd(P,y,{merge:!0}),alert("Configuration saved successfully!")}catch(P){console.error("Error saving config:",P),alert("Failed to save configuration")}finally{k(!1)}},A=(P,M)=>{m(U=>({...U,[P]:M}))},[T,I]=N.useState([]),[V,B]=N.useState([]),[F,w]=N.useState([]),[g,_]=N.useState(null),x=async()=>{a(!0);try{const P=Wr(Xe,"students"),M=await bo(P),U={},$=M.docs.map(de=>({id:de.id,...de.data()}));w($),M.docs.forEach(de=>{U[de.id]={id:de.id,...de.data()}});const Y=Wr(Xe,"sessions"),te=await bo(Y),q=te.docs.map(de=>({id:de.id,...de.data()}));I(q);const re=Wr(Xe,"events"),ye=(await bo(re)).docs.map(de=>({id:de.id,...de.data()}));B(ye);const Ae=bt(Xe,"game_settings","global"),me=await uu(Ae);me.exists()&&_({id:me.id,documentId:"global",...me.data()}),console.log(`Debug: Found ${M.size} students and ${te.size} sessions`);const ne={};te.docs.forEach(de=>{var qt;const ge=de.data(),be=ge.studentId;if(!be)return;ne[be]||(ne[be]={totalAccesses:0,scores:[],hasPlayed:!1,lastPlayed:null,section:ge.section||"Unknown",sid:be}),ne[be].totalAccesses+=1,ne[be].hasPlayed=!0;const st=(qt=ge.startTime)!=null&&qt.toDate?ge.startTime.toDate():new Date(ge.clientStartTime||0);(!ne[be].lastPlayed||st>ne[be].lastPlayed)&&(ne[be].lastPlayed=st),ge.finalScore!==void 0&&ne[be].scores.push({total:ge.finalScore,learning:ge.studentLearningScore,timestamp:ge.completedAt})});const Re=Object.values(U).map(de=>{const ge=ne[de.id]||{};return{...de,...ge,scores:ge.scores||de.scores||[],totalAccesses:ge.totalAccesses||0,hasPlayed:ge.hasPlayed||!1,lastPlayed:ge.lastPlayed||null}});Object.keys(ne).forEach(de=>{U[de]||Re.push({id:de,sid:de,...ne[de]})}),Re.sort((de,ge)=>{const be=de.lastPlayed?de.lastPlayed.getTime():0;return(ge.lastPlayed?ge.lastPlayed.getTime():0)-be}),s(Re)}catch(P){console.error("Error fetching students:",P)}finally{a(!1)}},C=async()=>{if(window.confirm("Are you sure you want to reset ALL student data? This cannot be undone!")){c(!0);try{const P=Wr(Xe,"students"),M=await bo(P);for(const U of M.docs)await Kd(bt(Xe,"students",U.id),{hasPlayed:!1,totalAccesses:0,scores:[]},{merge:!0});alert("All student data has been reset!"),await x()}catch(P){console.error("Error resetting data:",P),alert("Failed to reset data")}finally{c(!1)}}},R=async()=>{F.length===0&&await x();const P=["ID","Student ID","Section","Has Played","Last Played","Total Accesses","Highest Score"],M=F.filter(q=>{var re;return!((re=q.section)!=null&&re.includes("ADMIN"))}).map(q=>{const re=q.scores&&q.scores.length>0?Math.max(...q.scores.map(Se=>Se.total||0)):0;return[q.id||"",q.sid||q.id||"",q.section||"N/A",q.hasPlayed?"Yes":"No",q.lastPlayed?new Date(q.lastPlayed).toLocaleString():"-",q.totalAccesses||0,re]}),U=[P.join(","),...M.map(q=>q.map(re=>`"${String(re).replace(/"/g,'""')}"`).join(","))].join(`
`),$=new Blob([U],{type:"text/csv;charset=utf-8;"}),Y=document.createElement("a"),te=URL.createObjectURL($);Y.setAttribute("href",te),Y.setAttribute("download",`students_${new Date().toISOString().split("T")[0]}.csv`),Y.style.visibility="hidden",document.body.appendChild(Y),Y.click(),document.body.removeChild(Y)},E=async()=>{T.length===0&&await x();const P=["ID","Session ID","Student ID","Section","Start Time","Status","Final Score","Student Learning Score","Completed Tasks","Random Seed"],M=T.map(q=>{var ye;const re=(ye=q.startTime)!=null&&ye.toDate?q.startTime.toDate().toLocaleString():q.clientStartTime?new Date(q.clientStartTime).toLocaleString():"-",Se=q.completedTasks?Object.keys(q.completedTasks).length:0;return[q.id||"",q.id||"",q.studentId||"",q.section||"N/A",re,q.status||"unknown",q.finalScore!==void 0?q.finalScore:"",q.studentLearningScore!==void 0?q.studentLearningScore:"",Se,q.randomSeed||""]}),U=[P.join(","),...M.map(q=>q.map(re=>`"${String(re).replace(/"/g,'""')}"`).join(","))].join(`
`),$=new Blob([U],{type:"text/csv;charset=utf-8;"}),Y=document.createElement("a"),te=URL.createObjectURL($);Y.setAttribute("href",te),Y.setAttribute("download",`sessions_${new Date().toISOString().split("T")[0]}.csv`),Y.style.visibility="hidden",document.body.appendChild(Y),Y.click(),document.body.removeChild(Y)},oe=async()=>{V.length===0&&await x();const P=["ID","Session ID","Student ID","Username","Type","Timestamp","Client Timestamp","Time Elapsed Seconds","Readable Time","Current Task","Game Mode","Current Semester","Total Switches","AI Usage Count","Student Learning Score","Total Score","Event Data (JSON)"],M=V.map(q=>{const re={...q};return delete re.id,[q.id||"",q.sessionId||"",q.studentId||"",q.username||"",q.type||"",q.timestamp||"",q.clientTimestamp||"",q.timeElapsedSeconds||"",q.readableTime||"",q.currentTask||"",q.gameMode||"",q.currentSemester||"",q.totalSwitches||"",q.aiUsageCount||"",q.studentLearning||q.studentLearningScore||"",q.totalScore||q.finalScore||"",JSON.stringify(re)]}),U=[P.join(","),...M.map(q=>q.map(re=>`"${String(re).replace(/"/g,'""').replace(/\n/g,"\\n").replace(/\r/g,"\\r")}"`).join(","))].join(`
`),$=new Blob([U],{type:"text/csv;charset=utf-8;"}),Y=document.createElement("a"),te=URL.createObjectURL($);Y.setAttribute("href",te),Y.setAttribute("download",`events_${new Date().toISOString().split("T")[0]}.csv`),Y.style.visibility="hidden",document.body.appendChild(Y),Y.click(),document.body.removeChild(Y)},pe=async()=>{if(!g&&(await x(),!g)){alert("No game settings found!");return}const P=["ID","Document ID","Setting Name","Setting Value (JSON)"],U=Object.entries(g).filter(([re])=>re!=="id"&&re!=="documentId").map(([re,Se])=>[g.id||"",g.documentId||"global",re,typeof Se=="object"?JSON.stringify(Se):String(Se)]),$=[P.join(","),...U.map(re=>re.map(Se=>`"${String(Se).replace(/"/g,'""').replace(/\n/g,"\\n").replace(/\r/g,"\\r")}"`).join(","))].join(`
`),Y=new Blob([$],{type:"text/csv;charset=utf-8;"}),te=document.createElement("a"),q=URL.createObjectURL(Y);te.setAttribute("href",q),te.setAttribute("download",`game_settings_${new Date().toISOString().split("T")[0]}.csv`),te.style.visibility="hidden",document.body.appendChild(te),te.click(),document.body.removeChild(te)},Ee=()=>{R(),setTimeout(()=>E(),500),setTimeout(()=>oe(),1e3),setTimeout(()=>pe(),1500)},ee=P=>({padding:"12px 24px",background:P?"#2196F3":"transparent",color:P?"white":"#666",border:"none",borderBottom:P?"3px solid #2196F3":"3px solid transparent",cursor:"pointer",fontSize:"14px",fontWeight:P?"600":"normal",transition:"all 0.2s"}),D=r.filter(P=>{var M;return!((M=P.section)!=null&&M.includes("ADMIN"))}).length,W=r.filter(P=>{var M;return!((M=P.section)!=null&&M.includes("ADMIN"))&&P.hasPlayed}).length;return u.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h1",{style:{margin:0,color:"#333"},children:" Master Admin Dashboard"}),u.jsx("button",{onClick:t,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:"Exit Admin"})]}),u.jsxs("div",{style:{display:"flex",borderBottom:"1px solid #e0e0e0",marginBottom:"30px"},children:[u.jsx("button",{onClick:()=>n("config"),style:ee(e==="config"),children:" Game Configuration"}),u.jsx("button",{onClick:()=>n("scoring"),style:ee(e==="scoring"),children:" Scoring Configuration"}),u.jsx("button",{onClick:()=>n("players"),style:ee(e==="players"),children:" Player Data"}),u.jsx("button",{onClick:()=>n("advice"),style:ee(e==="advice"),children:" Game Advice"})]}),e==="config"&&u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h2",{style:{margin:0,fontSize:"20px",color:"#333"},children:"Game Configuration"}),u.jsx("button",{onClick:L,disabled:S,style:{padding:"10px 24px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:S?"not-allowed":"pointer",fontWeight:"600",fontSize:"14px",opacity:S?.6:1},children:S?"Saving...":" Save Settings"})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"20px",marginBottom:"20px"},children:[u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Time & Semesters"}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Semester Duration (Minutes)"}),u.jsx("input",{type:"number",value:y.semesterDuration,onChange:P=>A("semesterDuration",parseInt(P.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Semesters"}),u.jsx("input",{type:"number",value:y.totalSemesters,onChange:P=>A("totalSemesters",parseInt(P.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("input",{type:"checkbox",checked:y.midtermEnabled,onChange:P=>A("midtermEnabled",P.target.checked),id:"midtermCheck"}),u.jsx("label",{htmlFor:"midtermCheck",style:{fontSize:"13px",cursor:"pointer"},children:"Enable Midterm Checkpoint"})]})]}),u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Task Settings"}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Tasks per Semester"}),u.jsx("input",{type:"number",value:y.totalTasks,onChange:P=>A("totalTasks",parseInt(P.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Difficulty Configuration"}),u.jsxs("select",{value:y.difficultyMode||"fixed",onChange:P=>A("difficultyMode",P.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[u.jsx("option",{value:"fixed",children:"Fixed (50% Easy, 30% Medium, 20% Hard)"}),u.jsx("option",{value:"manual",children:"Manual (User chooses difficulty)"})]})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Task Order Strategy"}),u.jsxs("select",{value:y.taskOrderStrategy,onChange:P=>A("taskOrderStrategy",P.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[u.jsx("option",{value:"sequential_task",children:"Order by Task (Materials  Research  Engagement)"}),u.jsx("option",{value:"sequential_difficulty",children:"Order by Difficulty (Easy  Medium  Hard)"})]})]}),u.jsxs("div",{style:{marginTop:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Game Mode"}),u.jsxs("select",{value:y.gameMode||"knapsack",onChange:P=>A("gameMode",P.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[u.jsx("option",{value:"knapsack",children:"Knapsack Mode (Allocate tasks upfront, limited tasks)"}),u.jsx("option",{value:"sequential",children:"Sequential Mode (Infinite levels, countdown timer)"})]}),u.jsx("p",{style:{fontSize:"11px",color:"#666",marginTop:"5px"},children:"Sequential mode: Timer counts down, infinite levels, can keep playing until time runs out."})]})]}),u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Penalties & Mechanics"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Switch Cost (Points)"}),u.jsx("input",{type:"number",value:y.switchCost||0,onChange:P=>A("switchCost",parseInt(P.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Refill Freeze (Seconds)"}),u.jsx("input",{type:"number",value:y.jarRefillFreezeTime||0,onChange:P=>A("jarRefillFreezeTime",parseInt(P.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Unfinished Jar Penalty (Pts)"}),u.jsx("input",{type:"number",value:y.unfinishedJarPenalty||0,onChange:P=>A("unfinishedJarPenalty",parseInt(P.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"AI Delay (Seconds)"}),u.jsx("input",{type:"number",value:y.aiDelay||0,onChange:P=>A("aiDelay",parseInt(P.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]})]})]})]}),e==="scoring"&&u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h2",{style:{margin:0,fontSize:"20px",color:"#333"},children:"Scoring Configuration"}),u.jsx("button",{onClick:L,disabled:S,style:{padding:"10px 24px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:S?"not-allowed":"pointer",fontWeight:"600",fontSize:"14px",opacity:S?.6:1},children:S?"Saving...":" Save Settings"})]}),u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("p",{style:{fontSize:"13px",color:"#666",marginBottom:"20px"},children:'Configure points for each task type and difficulty level. "Full Correct" = perfect answer, "Half Correct" = partial credit.'}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px"},children:["g1","g2","g3"].map(P=>{const M={g1:"Research",g2:"Materials",g3:"Engagement"},U={g1:"",g2:"",g3:""},$={g1:"#9C27B0",g2:"#4CAF50",g3:"#f44336"};return u.jsxs("div",{style:{background:"#f9f9f9",padding:"15px",borderRadius:"8px",border:`2px solid ${$[P]}`},children:[u.jsxs("div",{style:{fontWeight:"bold",marginBottom:"12px",color:$[P],display:"flex",alignItems:"center",gap:"6px",fontSize:"14px"},children:[u.jsx("span",{children:U[P]}),u.jsx("span",{children:M[P]})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:["easy","medium","hard"].map(Y=>{var q,re,Se,ye,Ae,me;const te={easy:"E",medium:"M",hard:"H"};return u.jsxs("div",{style:{background:"white",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"},children:[u.jsx("div",{style:{fontSize:"10px",fontWeight:"600",marginBottom:"6px",color:"#666",textAlign:"center"},children:te[Y]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",fontSize:"9px",marginBottom:"2px",color:"#666"},children:"Full"}),u.jsx("input",{type:"number",min:"0",value:((Se=(re=(q=y.scoring)==null?void 0:q[P])==null?void 0:re[Y])==null?void 0:Se.fullCorrect)??2,onChange:ne=>{const Re=parseInt(ne.target.value)||0;m(de=>{var ge,be,st;return{...de,scoring:{...de.scoring,[P]:{...(ge=de.scoring)==null?void 0:ge[P],[Y]:{...(st=(be=de.scoring)==null?void 0:be[P])==null?void 0:st[Y],fullCorrect:Re}}}}})},style:{width:"100%",padding:"4px",borderRadius:"3px",border:"1px solid #ddd",fontSize:"12px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",fontSize:"9px",marginBottom:"2px",color:"#666"},children:"Half"}),u.jsx("input",{type:"number",min:"0",value:((me=(Ae=(ye=y.scoring)==null?void 0:ye[P])==null?void 0:Ae[Y])==null?void 0:me.halfCorrect)??1,onChange:ne=>{const Re=parseInt(ne.target.value)||0;m(de=>{var ge,be,st;return{...de,scoring:{...de.scoring,[P]:{...(ge=de.scoring)==null?void 0:ge[P],[Y]:{...(st=(be=de.scoring)==null?void 0:be[P])==null?void 0:st[Y],halfCorrect:Re}}}}})},style:{width:"100%",padding:"4px",borderRadius:"3px",border:"1px solid #ddd",fontSize:"12px"}})]})]})]},Y)})})]},P)})})]})]}),e==="players"&&u.jsxs("div",{style:{background:"white",padding:"25px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Active Sessions"}),u.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[u.jsx("button",{onClick:Ee,style:{padding:"10px 20px",background:"#9C27B0",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"600",fontSize:"14px"},children:" Download All Data"}),u.jsx("button",{onClick:R,style:{padding:"10px 20px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",fontSize:"13px"},children:" Students"}),u.jsx("button",{onClick:E,style:{padding:"10px 20px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",fontSize:"13px"},children:" Sessions"}),u.jsx("button",{onClick:oe,style:{padding:"10px 20px",background:"#FF9800",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",fontSize:"13px"},children:" Events"}),u.jsx("button",{onClick:pe,style:{padding:"10px 20px",background:"#9E9E9E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",fontSize:"13px"},children:" Settings"}),u.jsx("button",{onClick:C,disabled:l,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:l?"not-allowed":"pointer",fontWeight:"500",fontSize:"13px",opacity:l?.6:1},children:l?"Processing...":" Reset All Data"})]})]}),u.jsx("div",{style:{marginBottom:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"6px"},children:u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",textAlign:"center"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:D}),u.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Total Students"})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:W}),u.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Have Played"})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:D-W}),u.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Never Played"})]})]})}),i?u.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"Loading student data..."}):u.jsx("div",{style:{overflowX:"auto"},children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{background:"#f5f5f5",textAlign:"left"},children:[u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Student ID"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Section"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Has Played"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Last Played"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Total Accesses"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Highest Score"})]})}),u.jsx("tbody",{children:r.filter(P=>{var M;return!((M=P.section)!=null&&M.includes("ADMIN"))}).map(P=>u.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[u.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:P.sid||P.id}),u.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:P.section||"N/A"}),u.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:u.jsx("span",{style:{padding:"4px 12px",borderRadius:"12px",background:P.hasPlayed?"#e8f5e9":"#f5f5f5",color:P.hasPlayed?"#4CAF50":"#999",fontSize:"12px",fontWeight:"500"},children:P.hasPlayed?"Yes":"No"})}),u.jsx("td",{style:{padding:"12px",fontSize:"13px",color:"#666"},children:P.lastPlayed?new Date(P.lastPlayed).toLocaleString():"-"}),u.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600"},children:P.totalAccesses||0}),u.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600",color:"#2196F3"},children:P.scores&&P.scores.length>0?Math.max(...P.scores.map(M=>M.total||0)):0})]},P.id))})]})})]}),e==="advice"&&u.jsxs("div",{style:{background:"white",padding:"60px 40px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),u.jsx("h2",{style:{fontSize:"24px",color:"#666",marginBottom:"15px",fontWeight:"500"},children:"Game Advice Configuration"}),u.jsx("p",{style:{color:"#999",maxWidth:"600px",margin:"0 auto 30px",lineHeight:"1.6"},children:"Configure contextual advice prompts based on remaining time and tasks completed. This feature will allow you to define dynamic advice messages for different game states."}),u.jsxs("div",{style:{marginTop:"40px",padding:"30px",background:"#f9f9f9",borderRadius:"8px",maxWidth:"500px",margin:"40px auto 0",border:"2px dashed #ddd"},children:[u.jsx("p",{style:{color:"#666",fontSize:"15px",margin:0,fontWeight:"500"},children:"Coming Soon: Dynamic 2D Advice Matrix"}),u.jsx("p",{style:{color:"#999",fontSize:"13px",margin:"10px 0 0",lineHeight:"1.5"},children:"Define advice based on time remaining  tasks completed thresholds"})]})]})]})}const EI={notifyGameComplete(t={}){try{window.parent.postMessage({type:"gameComplete",status:"finished",timestamp:new Date().toISOString(),...t},"*");try{if(window.parent&&window.parent.document){const e=window.parent.document.querySelector("#NextButton");e&&(e.style.display="inline-block",e.style.visibility="visible",e.disabled=!1)}}catch{window.parent.postMessage({type:"showNextButton",action:"show"},"*")}console.log(" Game completion notification sent to Qualtrics")}catch(e){console.error("Failed to notify Qualtrics:",e)}},notifySemesterComplete(t,e,n={}){try{window.parent.postMessage({type:"semesterComplete",semester:t,totalSemesters:e,timestamp:new Date().toISOString(),...n},"*"),window.parent.postMessage({type:"keepNextButtonVisible",action:"maintain"},"*"),console.log(` Semester ${t} completion notification sent`)}catch(r){console.error("Failed to notify Qualtrics of semester completion:",r)}},ensureNextButtonVisible(){try{window.parent.postMessage({type:"ensureNextButton",action:"show",timestamp:new Date().toISOString()},"*")}catch(t){console.error("Failed to ensure Next button visibility:",t)}}};function II({onStart:t,totalTasks:e=10,orderStrategy:n="sequential_task",durationMinutes:r=12,difficultyMode:s="fixed"}){const[i,a]=N.useState({g2:0,g1:0,g3:0}),[l,c]=N.useState({g2:{easy:0,medium:0,hard:0},g1:{easy:0,medium:0,hard:0},g3:{easy:0,medium:0,hard:0}}),[h,p]=N.useState([]),[y,m]=N.useState(0),[S,k]=N.useState(null),b=["It's generally smart to do roughly an even number of each task.","This is because the tasks that are worth more points take more time to do, so you don't want to only do the shorter tasks or only do the longer tasks.","Of course, you might prefer one task over another, so you could take that into account. Do you feel like you are particularly good at one of the tasks?"],L=()=>{y<b.length?(p(g=>[...g,{sender:"AI",text:b[y]}]),m(g=>g+1)):p(g=>[...g,{sender:"AI",text:"I've shared my best advice! It's up to you now."}])},A=(g,_)=>{const x=parseInt(_)||0;a(C=>({...C,[g]:Math.max(0,x)})),k(null)},T=(g,_,x)=>{const C=parseInt(x)||0;c(R=>({...R,[g]:{...R[g],[_]:Math.max(0,C)}})),k(null)},B=s==="manual"?(()=>{let g=0;return Object.values(l).forEach(_=>{g+=_.easy+_.medium+_.hard}),g})():Object.values(i).reduce((g,_)=>g+_,0),F=B===e,w=()=>{if(B!==e){k(`Total tasks must equal ${e}. Currently: ${B}`);return}let g=[];s==="fixed"?["g2","g1","g3"].forEach(oe=>{const pe=i[oe];if(pe>0){const Ee=pe*.5,ee=pe*.3,D=pe*.2;let W=Math.floor(Ee),P=Math.floor(ee),M=Math.floor(D),U=pe-W-P-M;for(;U>0;){const Y=Ee-W,te=ee-P,q=D-M;Y>=te&&Y>=q?W++:te>=q?P++:M++,U--}const $=W+P+M;if($!==pe){const Y=pe-$;Y>0?W+=Y:W=Math.max(0,W+Y)}for(let Y=0;Y<W;Y++)g.push({type:oe,difficulty:"easy"});for(let Y=0;Y<P;Y++)g.push({type:oe,difficulty:"medium"});for(let Y=0;Y<M;Y++)g.push({type:oe,difficulty:"hard"})}}):["g2","g1","g3"].forEach(oe=>{const{easy:pe,medium:Ee,hard:ee}=l[oe];for(let D=0;D<pe;D++)g.push({type:oe,difficulty:"easy"});for(let D=0;D<Ee;D++)g.push({type:oe,difficulty:"medium"});for(let D=0;D<ee;D++)g.push({type:oe,difficulty:"hard"})});const _={g2:{easy:1,medium:6,hard:11},g1:{easy:1,medium:6,hard:11},g3:{easy:1,medium:6,hard:11}},x=g.map(oe=>{const{type:pe,difficulty:Ee}=oe,ee=_[pe][Ee]++;return{...oe,id:`${pe}t${ee}`}});let C=[];if(n==="sequential_difficulty"){const oe={easy:1,medium:2,hard:3},pe={g2:1,g1:2,g3:3};C=x.sort((Ee,ee)=>oe[Ee.difficulty]!==oe[ee.difficulty]?oe[Ee.difficulty]-oe[ee.difficulty]:pe[Ee.type]-pe[ee.type])}else{const oe={g2:1,g1:2,g3:3},pe={easy:1,medium:2,hard:3};C=x.sort((Ee,ee)=>oe[Ee.type]!==oe[ee.type]?oe[Ee.type]-oe[ee.type]:pe[Ee.difficulty]-pe[ee.difficulty])}const R=C.map(oe=>oe.id),E=s==="fixed"?i:{g2:l.g2.easy+l.g2.medium+l.g2.hard,g1:l.g1.easy+l.g1.medium+l.g1.hard,g3:l.g3.easy+l.g3.medium+l.g3.hard};t(R,E)};return u.jsxs("div",{style:{maxWidth:"900px",margin:"40px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[u.jsx("h1",{style:{textAlign:"center",marginBottom:"30px",color:"#333"},children:"Task Allocation Strategy"}),u.jsxs("div",{style:{marginBottom:"30px",lineHeight:"1.6",color:"#555"},children:[u.jsxs("p",{children:["You have ",u.jsxs("strong",{children:[r," minutes"]})," to complete ",u.jsxs("strong",{children:[e," tasks"]}),"."]}),u.jsx("p",{children:"You must decide now how many of each task type you want to perform."}),u.jsxs("p",{children:["Total tasks must add up to ",u.jsx("strong",{children:e}),"."]}),s==="fixed"&&u.jsx("p",{style:{fontSize:"14px",fontStyle:"italic",color:"#666"},children:"* Within each task type, tasks are distributed as 50% Easy, 30% Medium, 20% Hard."})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"40px",marginBottom:"40px"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[s==="fixed"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:Dc,children:[u.jsxs("label",{style:jc,children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 1: Slider (Materials)"]}),u.jsx("input",{type:"number",min:"0",max:e,value:i.g2,onChange:g=>A("g2",g.target.value),style:Nc})]}),u.jsxs("div",{style:Dc,children:[u.jsxs("label",{style:jc,children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 2: Counting (Research)"]}),u.jsx("input",{type:"number",min:"0",max:e,value:i.g1,onChange:g=>A("g1",g.target.value),style:Nc})]}),u.jsxs("div",{style:Dc,children:[u.jsxs("label",{style:jc,children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 3: Typing (Engagement)"]}),u.jsx("input",{type:"number",min:"0",max:e,value:i.g3,onChange:g=>A("g3",g.target.value),style:Nc})]})]}):u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px"},children:[u.jsx(lr,{icon:"",taskName:"Materials",difficulty:"Easy",value:l.g2.easy,onChange:g=>T("g2","easy",g),color:"#4CAF50"}),u.jsx(lr,{icon:"",taskName:"Materials",difficulty:"Medium",value:l.g2.medium,onChange:g=>T("g2","medium",g),color:"#4CAF50"}),u.jsx(lr,{icon:"",taskName:"Materials",difficulty:"Hard",value:l.g2.hard,onChange:g=>T("g2","hard",g),color:"#4CAF50"}),u.jsx(lr,{icon:"",taskName:"Research",difficulty:"Easy",value:l.g1.easy,onChange:g=>T("g1","easy",g),color:"#9C27B0"}),u.jsx(lr,{icon:"",taskName:"Research",difficulty:"Medium",value:l.g1.medium,onChange:g=>T("g1","medium",g),color:"#9C27B0"}),u.jsx(lr,{icon:"",taskName:"Research",difficulty:"Hard",value:l.g1.hard,onChange:g=>T("g1","hard",g),color:"#9C27B0"}),u.jsx(lr,{icon:"",taskName:"Engagement",difficulty:"Easy",value:l.g3.easy,onChange:g=>T("g3","easy",g),color:"#f44336"}),u.jsx(lr,{icon:"",taskName:"Engagement",difficulty:"Medium",value:l.g3.medium,onChange:g=>T("g3","medium",g),color:"#f44336"}),u.jsx(lr,{icon:"",taskName:"Engagement",difficulty:"Hard",value:l.g3.hard,onChange:g=>T("g3","hard",g),color:"#f44336"})]}),u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:F?"#e8f5e9":"#ffebee",borderRadius:"8px",textAlign:"center",fontWeight:"bold",color:F?"#2e7d32":"#c62828"},children:["Total Allocated: ",B," / ",e]}),S&&u.jsx("div",{style:{color:"red",textAlign:"center",fontSize:"14px"},children:S})]}),u.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"12px",padding:"20px",display:"flex",flexDirection:"column"},children:[u.jsxs("div",{style:{flex:1,marginBottom:"15px",overflowY:"auto",maxHeight:"300px",display:"flex",flexDirection:"column",gap:"10px"},children:[h.length===0&&u.jsx("div",{style:{color:"#999",fontStyle:"italic",textAlign:"center",marginTop:"40px"},children:"Need advice? Ask the AI helper."}),h.map((g,_)=>u.jsxs("div",{style:{background:"#f0f7ff",padding:"10px 15px",borderRadius:"12px 12px 12px 0",alignSelf:"flex-start",maxWidth:"90%"},children:[u.jsx("strong",{children:" AI:"})," ",g.text]},_))]}),u.jsxs("button",{onClick:L,style:{background:"#2196F3",color:"white",border:"none",padding:"12px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[u.jsx("span",{children:""})," Ask AI for Recommendation"]})]})]}),u.jsx("div",{style:{textAlign:"center"},children:u.jsx("button",{onClick:w,disabled:!F,style:{background:F?"#4CAF50":"#ccc",color:"white",border:"none",padding:"15px 40px",fontSize:"18px",borderRadius:"30px",cursor:F?"pointer":"not-allowed",fontWeight:"bold",boxShadow:F?"0 4px 15px rgba(76, 175, 80, 0.3)":"none",transition:"all 0.2s"},children:"Start Experiment"})})]})}const lr=({icon:t,taskName:e,difficulty:n,value:r,onChange:s,color:i})=>u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",background:"#f9f9f9",padding:"20px",borderRadius:"12px",border:`2px solid ${i}40`,transition:"all 0.2s"},children:[u.jsx("div",{style:{fontSize:"24px",marginBottom:"8px"},children:t}),u.jsx("div",{style:{fontSize:"14px",fontWeight:"bold",color:i,marginBottom:"4px",textAlign:"center"},children:e}),u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"12px",textAlign:"center"},children:n}),u.jsx("input",{type:"number",min:"0",max:100,value:r,onChange:a=>s(a.target.value),style:{width:"70px",padding:"12px",textAlign:"center",border:`2px solid ${i}`,borderRadius:"8px",fontSize:"18px",fontWeight:"bold",color:i,background:"white"}})]}),Dc={display:"flex",alignItems:"center",justifyContent:"space-between",background:"#f9f9f9",padding:"15px",borderRadius:"8px"},jc={fontWeight:"bold",color:"#333",display:"flex",alignItems:"center"},Nc={width:"60px",padding:"10px",fontSize:"18px",textAlign:"center",borderRadius:"6px",border:"1px solid #ddd"};function CI({currentTaskIndex:t,totalTasks:e,taskQueue:n,onSwitchTask:r,onRefill:s,onFinishNow:i,children:a,points:l,timeRemaining:c,onTimeUp:h,penalties:p={switch:0,refill:0,unfinished:0},chatInterface:y,difficultyMode:m="fixed",categoryPoints:S={materials:0,research:0,engagement:0},globalConfig:k={},allTasksCompleted:b=!1}){const L=n[t];(x=>x.startsWith("g1")?{name:"Research",icon:"",color:"#9C27B0",bg:"#f3e5f5"}:x.startsWith("g2")?{name:"Materials",icon:"",color:"#4CAF50",bg:"#e8f5e9"}:x.startsWith("g3")?{name:"Engagement",icon:"",color:"#f44336",bg:"#ffebee"}:{name:"Unknown",icon:"",color:"#333",bg:"#eee"})(L);const T=n.slice(0,t),I={g1:T.filter(x=>x.startsWith("g1")).length,g2:T.filter(x=>x.startsWith("g2")).length,g3:T.filter(x=>x.startsWith("g3")).length},V=e-t,B=b?[]:n.slice(t),F=x=>{const C=parseInt(x.substring(3))||1;return m==="manual"?C<=5?"easy":C<=10?"medium":"hard":C<=25?"easy":C<=40?"medium":"hard"};let w;m==="manual"?w={"g2-easy":B.filter(x=>x.startsWith("g2")&&F(x)==="easy"),"g2-medium":B.filter(x=>x.startsWith("g2")&&F(x)==="medium"),"g2-hard":B.filter(x=>x.startsWith("g2")&&F(x)==="hard"),"g1-easy":B.filter(x=>x.startsWith("g1")&&F(x)==="easy"),"g1-medium":B.filter(x=>x.startsWith("g1")&&F(x)==="medium"),"g1-hard":B.filter(x=>x.startsWith("g1")&&F(x)==="hard"),"g3-easy":B.filter(x=>x.startsWith("g3")&&F(x)==="easy"),"g3-medium":B.filter(x=>x.startsWith("g3")&&F(x)==="medium"),"g3-hard":B.filter(x=>x.startsWith("g3")&&F(x)==="hard")}:w={g2:B.filter(x=>x.startsWith("g2")),g1:B.filter(x=>x.startsWith("g1")),g3:B.filter(x=>x.startsWith("g3"))};const g=x=>{if(m==="manual"){const C=F(L);return L.startsWith(x.split("-")[0])&&C===x.split("-")[1]}else return L.startsWith(x)},_=(x,C,R,E,oe,pe,Ee=null)=>{const ee=pe.length,D=g(x),W=ee>0,P=x;return u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",background:oe,borderRadius:"10px",padding:m==="manual"?"8px":"10px",border:`2px solid ${D?E:"transparent"}`,height:m==="manual"?"auto":"100%",minHeight:m==="manual"?"120px":"auto",position:"relative"},children:[u.jsxs("div",{style:{fontSize:m==="manual"?"12px":"14px",fontWeight:"bold",color:E,marginBottom:m==="manual"?"6px":"10px",display:"flex",alignItems:"center",gap:"5px",justifyContent:"center"},children:[u.jsx("span",{children:R}),u.jsx("span",{children:ee})]}),u.jsx("div",{style:{flex:1,width:"100%",display:"flex",flexDirection:"column",gap:"5px",justifyContent:"flex-end",paddingBottom:"10px"},children:W?u.jsxs(u.Fragment,{children:[!D&&pe.length>0&&u.jsx("div",{style:{width:"90%",height:"25px",border:"2px dashed #999",borderRadius:"4px",margin:"0 auto 8px auto",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",color:"#666",background:"rgba(255, 255, 255, 0.5)",cursor:"pointer"},onClick:()=>r(P),title:"Click to switch to this task type",children:" Switch"}),pe.map((M,U)=>{const $=U===0&&D;return u.jsx("div",{style:{height:$?"35px":"8px",width:"80%",background:E,opacity:$?1:.4,borderRadius:"4px",margin:"0 auto",display:$?"flex":"block",alignItems:"center",justifyContent:"center",color:$?"white":"transparent",fontSize:"10px",fontWeight:"bold",cursor:$?"default":"pointer"},onClick:!D&&U===0?()=>r(P):void 0,children:$?"Current":""},U)})]}):u.jsx("button",{onClick:()=>s&&s(P),style:{width:"100%",padding:"10px 5px",background:"white",border:"2px dashed #999",borderRadius:"8px",color:"#666",cursor:"pointer",fontSize:"12px"},children:" Refill"})}),u.jsxs("div",{style:{fontSize:m==="manual"?"11px":"12px",color:"#666",marginTop:m==="manual"?"4px":"5px",textAlign:"center"},children:[C,Ee&&u.jsx("div",{style:{fontSize:"10px",color:"#999"},children:Ee})]})]})};return u.jsxs("div",{style:{maxWidth:"95vw",margin:"0 auto",padding:"20px"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"white",padding:"15px 25px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[u.jsx("div",{style:{width:"200px"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""}),u.jsx("div",{children:u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:c<60?"#f44336":"#333",animation:c<60?"pulse 1s infinite":"none"},children:[Math.floor(c/60),":",(c%60).toString().padStart(2,"0")]})})]})}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:"Total Points"}),u.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#2196F3"},children:l}),u.jsx("div",{style:{marginTop:"10px",fontSize:"10px",color:"#666",textAlign:"left",background:"#f5f5f5",padding:"10px 12px",borderRadius:"6px",width:"280px",margin:"10px auto 0"},children:u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"600",marginBottom:"4px",color:"#333",fontSize:"10px"},children:"Rules:"}),u.jsxs("div",{style:{fontSize:"9px",lineHeight:"1.5"},children:["Switch: -",(k==null?void 0:k.switchCost)||0," pts",u.jsx("br",{}),"Refill: ",(k==null?void 0:k.jarRefillFreezeTime)||0,"s pause",u.jsx("br",{}),"Unfinished: -",(k==null?void 0:k.unfinishedTaskPenalty)||0," pts"]})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:"600",marginBottom:"4px",color:"#333",fontSize:"10px"},children:"Earnings:"}),u.jsxs("div",{style:{fontSize:"9px",lineHeight:"1.5"},children:["Materials: ",(S==null?void 0:S.materials)||0," pts",u.jsx("br",{}),"Research: ",(S==null?void 0:S.research)||0," pts",u.jsx("br",{}),"Engagement: ",(S==null?void 0:S.engagement)||0," pts",u.jsx("br",{}),(p.switch>0||p.unfinished>0)&&u.jsxs("span",{style:{color:"#f44336"},children:["Penalties: -",p.switch+p.unfinished," pts"]})]})]})]})})]}),u.jsxs("div",{style:{textAlign:"right",minWidth:"300px"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"5px"},children:"Task Progress"}),u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"15px"},children:[u.jsxs("div",{style:{display:"flex",gap:"10px",fontSize:"16px",fontWeight:"500",color:"#555"},children:[u.jsxs("span",{title:"Materials Done",children:[" ",I.g2]}),u.jsx("span",{style:{color:"#ddd"},children:"|"}),u.jsxs("span",{title:"Research Done",children:[" ",I.g1]}),u.jsx("span",{style:{color:"#ddd"},children:"|"}),u.jsxs("span",{title:"Engagement Done",children:[" ",I.g3]})]}),u.jsxs("div",{style:{background:"#eee",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold",color:"#333"},children:["Remaining: ",V]})]})]})]}),u.jsxs("div",{className:"task-runner-layout",style:{display:"grid",gridTemplateColumns:"300px 1fr 340px",gap:"20px",height:"calc(100vh - 140px)",boxSizing:"border-box"},children:[u.jsxs("div",{style:{background:"white",padding:"15px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",height:"fit-content",maxHeight:"100%"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#666",textAlign:"center"},children:"Task Jars"}),m==="manual"?u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",flex:1},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#4CAF50",marginBottom:"4px"},children:"Materials"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:[_("g2-easy","Easy","","#4CAF50","#e8f5e9",w["g2-easy"],null),_("g2-medium","Medium","","#4CAF50","#e8f5e9",w["g2-medium"],null),_("g2-hard","Hard","","#4CAF50","#e8f5e9",w["g2-hard"],null)]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#9C27B0",marginBottom:"4px"},children:"Research"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:[_("g1-easy","Easy","","#9C27B0","#f3e5f5",w["g1-easy"],null),_("g1-medium","Medium","","#9C27B0","#f3e5f5",w["g1-medium"],null),_("g1-hard","Hard","","#9C27B0","#f3e5f5",w["g1-hard"],null)]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#f44336",marginBottom:"4px"},children:"Engagement"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:[_("g3-easy","Easy","","#f44336","#ffebee",w["g3-easy"],null),_("g3-medium","Medium","","#f44336","#ffebee",w["g3-medium"],null),_("g3-hard","Hard","","#f44336","#ffebee",w["g3-hard"],null)]})]})]}):u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px",flex:1},children:[_("g2","Materials","","#4CAF50","#e8f5e9",w.g2),_("g1","Research","","#9C27B0","#f3e5f5",w.g1),_("g3","Engagement","","#f44336","#ffebee",w.g3)]}),b&&u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#fff3cd",borderRadius:"8px",border:"2px solid #ffc107",textAlign:"center"},children:[u.jsx("p",{style:{fontSize:"13px",color:"#856404",margin:"0 0 12px 0",lineHeight:"1.5"},children:" All tasks completed! You can either finish early or continue by refilling jars."}),u.jsx("button",{onClick:i,style:{width:"100%",padding:"12px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",transition:"all 0.2s"},onMouseOver:x=>{x.currentTarget.style.background="#45a049",x.currentTarget.style.transform="translateY(-1px)"},onMouseOut:x=>{x.currentTarget.style.background="#4CAF50",x.currentTarget.style.transform="translateY(0)"},children:" Finish Now"})]})]}),u.jsx("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",overflow:"hidden",display:"flex",flexDirection:"column"},children:a}),u.jsx("div",{style:{height:"100%",overflow:"hidden"},children:y&&u.jsx("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:y})})]}),u.jsx("style",{children:`
        @keyframes pulse {
          0% { opacity: 1; }
          50% { opacity: 0.5; }
          100% { opacity: 1; }
        }
      `})]})}function kI({timeRemaining:t,onSelectTask:e,onFinishEarly:n}){return u.jsxs("div",{style:{maxWidth:"800px",margin:"40px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[u.jsx("h1",{style:{color:"#2196F3",marginBottom:"20px"},children:" All Tasks Completed!"}),u.jsxs("div",{style:{fontSize:"18px",color:"#555",marginBottom:"30px",lineHeight:"1.6"},children:[u.jsx("p",{children:"You have finished all 10 allocated tasks with time to spare."}),u.jsxs("p",{children:["You currently have ",u.jsxs("strong",{children:[Math.floor(t/60)," minutes and ",t%60," seconds"]})," remaining."]}),u.jsxs("p",{children:["You can choose to do more tasks for ",u.jsx("strong",{children:"1/2 credit"})," to increase your score, or finish the experiment now."]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"40px"},children:[u.jsxs("button",{onClick:()=>e("g2"),style:Mc("#4CAF50"),children:[u.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Materials Task",u.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),u.jsxs("button",{onClick:()=>e("g1"),style:Mc("#9C27B0"),children:[u.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Research Task",u.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),u.jsxs("button",{onClick:()=>e("g3"),style:Mc("#f44336"),children:[u.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Engagement Task",u.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]})]}),u.jsx("div",{style:{borderTop:"1px solid #eee",paddingTop:"30px"},children:u.jsx("button",{onClick:n,style:{background:"#f5f5f5",color:"#666",border:"1px solid #ddd",padding:"12px 30px",fontSize:"16px",borderRadius:"30px",cursor:"pointer",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:r=>r.target.style.background="#e0e0e0",onMouseLeave:r=>r.target.style.background="#f5f5f5",children:"No thanks, I'm done"})})]})}const Mc=t=>({background:"white",border:`2px solid ${t}`,color:t,padding:"20px",borderRadius:"12px",cursor:"pointer",fontSize:"16px",fontWeight:"bold",transition:"all 0.2s",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"});function AI(t,e){const n=t.length,r=e.length,s=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let i=0;i<=n;i++)s[i][0]=i;for(let i=0;i<=r;i++)s[0][i]=i;for(let i=1;i<=n;i++)for(let a=1;a<=r;a++)t[i-1]===e[a-1]?s[i][a]=s[i-1][a-1]:s[i][a]=Math.min(s[i-1][a]+1,s[i][a-1]+1,s[i-1][a-1]+1);return s[n][r]}function RI(){const e=new URLSearchParams(window.location.search).get("admin")==="berkeley2024",[n,r]=N.useState("landing"),[s,i]=N.useState(null),[a,l]=N.useState(null),[c,h]=N.useState("g2t1"),[p,y]=N.useState({}),[m,S]=N.useState(0),[k,b]=N.useState(null),[L,A]=N.useState(!1),[T,I]=N.useState(""),[V,B]=N.useState(!0),[F,w]=N.useState(0),[g,_]=N.useState({}),[x,C]=N.useState(0),[R,E]=N.useState(0),[oe,pe]=N.useState(!1),[Ee,ee]=N.useState(null),[D,W]=N.useState(!1),[P,M]=N.useState(30),[U,$]=N.useState(!1),[Y,te]=N.useState(5),[q,re]=N.useState(!1),[Se,ye]=N.useState(0),[Ae,me]=N.useState(!1),[ne,Re]=N.useState(1),[de]=N.useState(2),[ge,be]=N.useState([]),[st,qt]=N.useState(null),[Zt,Vt]=N.useState(!1),[Ir,qs]=N.useState(0),[Cr,nr]=N.useState({}),[Gs,ct]=N.useState({}),[Tt,kr]=N.useState({}),[ba,Qs]=N.useState({}),[hs,Wn]=N.useState(null),[Ze,Pa]=N.useState({g2t1:!1,g1t1:!1,g3t1:!1}),[so,Da]=N.useState(720),[rr,fs]=N.useState(720),[ps,Ks]=N.useState(0),[ae,Cn]=N.useState({materials:0,research:0,engagement:0,bonus:0}),[sr,kn]=N.useState({}),[Uu,Ar]=N.useState({}),[$u,ir]=N.useState({}),[ln,dt]=N.useState({switch:0,refill:0,unfinished:0}),[Ce,gs]=N.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,unfinishedTaskPenalty:0,taskOrderStrategy:"sequential_task",freezePenalty:0,contextAdviceEnabled:!0,difficultyMode:"fixed",switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0,gameMode:"knapsack",scoring:{g1:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g2:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g3:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}}}});N.useEffect(()=>{(async()=>{try{const z=bt(Xe,"game_settings","global"),Q=await uu(z);if(Q.exists()){const K=Q.data();if(gs(le=>({...le,...K})),localStorage.setItem("globalConfig",JSON.stringify({...K})),K.semesterDuration){const le=K.semesterDuration*60;Da(le),fs(le),ys.current=le,ao.current=le}}}catch(z){console.error("Error loading global config:",z)}})()},[]);const[Et,Rr]=N.useState([]),[An,un]=N.useState(0),[Wu,Hu]=N.useState(null),[io,qu]=N.useState(!1),[Ys,br]=N.useState([]),[Rn,Xs]=N.useState(!1),[Pr,Js]=N.useState(!0),[Zs,ja]=N.useState(0),ei=N.useRef(Date.now()),ms=N.useRef(null);N.useRef(null),N.useRef(null);const Dr=N.useRef(null),oo=N.useRef(Date.now()),ao=N.useRef(720),ys=N.useRef(720),cn=()=>{const G=(Ce.semesterDuration||12)*60*1e3,z=Math.floor(G/2e3);return Math.floor(z/60)};N.useEffect(()=>{(async()=>{try{const z=new URLSearchParams(window.location.search),Q=z.has("code")||z.has("c");if((z.get("code")||z.get("c"))==="MASTER"){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",section:"master_admin",hasAI:!1,isMasterInterface:!0,displayName:"Master Administrator"})),B(!1);return}if(e&&!sessionStorage.getItem("gameConfig")&&sessionStorage.setItem("gameConfig",JSON.stringify({role:"admin",section:"admin",hasAI:!0,checkpointSemester2:!0,displayName:"Admin User"})),!Q){r("studentLogin"),B(!1);return}const{allowed:le,reason:ue,resumeSession:he,newSession:Te,code:Le,codeData:Fe}=await im.checkAccess();if(!le){A(!0),I(ue),B(!1);return}if(he)b(he),localStorage.setItem("sessionId",he);else if(Te){const It=await im.createSession(Le,Fe);b(It)}await Oe.syncOfflineEvents(),B(!1)}catch{B(!1)}})()},[]),N.useEffect(()=>{n==="complete"&&ne>=de&&EI.notifyGameComplete({finalScore:Math.round(Hn())+(ae.bonus||0),totalTime:F,semestersCompleted:ne,sessionId:k})},[n,ne,de,F,ae.bonus,k]),N.useEffect(()=>{localStorage.setItem("currentTask",c)},[c]),N.useEffect(()=>{localStorage.setItem("gameMode",JSON.stringify(s))},[s]),N.useEffect(()=>{localStorage.setItem("currentSemester",ne.toString())},[ne]),N.useEffect(()=>{localStorage.setItem("totalSemesters",de.toString())},[de]),N.useEffect(()=>{localStorage.setItem("completedTasksCount",Object.keys(p).length.toString())},[p]),N.useEffect(()=>{localStorage.setItem("completedLevels",m.toString())},[m]),N.useEffect(()=>{localStorage.setItem("totalSwitches",x.toString())},[x]),N.useEffect(()=>{localStorage.setItem("categoryPoints",JSON.stringify(ae))},[ae]);const Hn=(G=ae,z=sr)=>{const Q=G.materials||0,K=G.research||0,le=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,ue=Q*(1+K*.15),he=ue+le+(G.bonus||0);return console.log(` STUDENT LEARNING: ${he.toFixed(1)} pts | Materials: ${Q}  (1 + ${K}0.15) = ${ue.toFixed(1)} | Interest: ${le.toFixed(1)} | Total: ${he.toFixed(1)}`),isNaN(he)?0:he};N.useEffect(()=>{const G=setInterval(()=>{Na(Q=>Q+1);const z=Hn();Ks(z)},2e3);return()=>clearInterval(G)},[ae,sr,ln]);const[jf,Na]=N.useState(0);if(N.useEffect(()=>{localStorage.setItem("studentLearningScore",ps.toString())},[ps]),N.useEffect(()=>{const G=Ze.g2t1&&Ze.g1t1&&Ze.g3t1;localStorage.setItem("practiceCompleted",G.toString())},[Ze]),V)return u.jsx("div",{className:"app",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:u.jsx("h2",{children:"Loading..."})});if(window.location.search.includes("master=true")&&JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="master_admin")return u.jsx(TI,{onClose:()=>{window.history.replaceState({},document.title,window.location.pathname),window.location.reload()}});if(window.location.search.includes("admin=true"))return u.jsx(wI,{});const Ma=()=>{if(!(ne===2&&Ce.midtermEnabled))return;Vt(!0),Hn()>=300?(qs(300),Cn(K=>({...K,bonus:(K.bonus||0)+300}))):qs(0),pe(!0),ee("checkpoint")},vs=()=>{const G=(Ce.semesterDuration||12)*60*1e3,z=Math.floor(G/1e3);Da(z),fs(z),ei.current=Date.now(),ms.current=setInterval(()=>{const K=Date.now()-ei.current,le=Math.floor(K/1e3);w(le);const ue=Math.max(0,z-le);if(fs(ue),le%10===0&&k&&!k.startsWith("offline-")&&dr(bt(Xe,"sessions",k),{timeElapsed:le,lastUpdated:Ln()}).catch(Te=>console.error("Failed to update session time:",Te)),ne===2&&Ce.midtermEnabled){const Te=(Ce.semesterDuration||12)*60*1e3,Le=Math.floor(Te/2e3);le===Le&&!Zt&&Ma()}ue<=0&&(clearInterval(ms.current),ms.current=null,xs("semester_complete"))},1e3)},ti=G=>{const Q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin",K=Ze.g2t1&&Ze.g1t1&&Ze.g3t1;l(G),Oe.logEvent("practice_choice",{choice:G}),G==="no"?!Q&&!K?(Pn("You must complete all three practice tasks first!"),r("practice")):ni():r("practice")},ni=()=>{if(st){if(Object.keys(Cr).length===0){ot.initializeSeed(st);const z={},Q={},K={},le={};for(let ue=1;ue<=100;ue++)z[ue]=ot.generateSliderPattern(ue),Q[ue]=ot.generateCountingPattern(ue),K[ue]=ot.generateTypingPattern(ue),le[ue]=ot.getTextPassage(ue);nr(z),ct(Q),kr(K),Qs(le)}}else{const z=Math.floor(Math.random()*1e6);qt(z),ot.initializeSeed(z);const Q={},K={},le={},ue={};for(let he=1;he<=100;he++)Q[he]=ot.generateSliderPattern(he),K[he]=ot.generateCountingPattern(he),le[he]=ot.generateTypingPattern(he),ue[he]=ot.getTextPassage(he);nr(Q),ct(K),kr(le),Qs(ue),k&&!k.startsWith("offline-")&&dr(bt(Xe,"sessions",k),{randomSeed:z,[`semesterSeeds.semester${ne}`]:z})}localStorage.setItem("engagementInterest","0"),Cn({materials:0,research:0,engagement:0,bonus:0}),kn({}),(Ce.gameMode||"knapsack")==="sequential"?(r("challenge"),h("g2t1"),y({}),S(0),C(0),E(0),Vt(!1),Ar({}),ir({}),dt({switch:0,refill:0,unfinished:0}),vs()):(r("allocation"),y({}),S(0),C(0),E(0),Vt(!1),Ar({}),ir({}),dt({switch:0,refill:0,unfinished:0}))},Va=(G,z)=>{Rr(G),Hu(z),un(0),r("challenge");const K=`${G[0]}t1`;h(K),_({[K]:Date.now()}),Oe.setPageStartTime(K),vs(),Oe.logEvent("allocation_complete",{counts:z,queue:G,timestamp:Date.now()})},La=G=>{const z=Et[An],Q=z.substring(0,2);let K=G,le=null;G.includes("-")&&([K,le]=G.split("-"));const ue=parseInt(z.substring(3))||1,he=ue<=5?"easy":ue<=10?"medium":"hard";if(Ce.difficultyMode==="manual"){if(Q===K&&he===le)return}else if(Q===K)return;const Te=Ce.switchCost||0;Te>0&&(Cn(Pe=>({...Pe,bonus:(Pe.bonus||0)-Te})),dt(Pe=>({...Pe,switch:Pe.switch+Te})),Pn(`Switching tasks cost ${Te} points!`));const Le=[...Et],Fe=Le.slice(An),It=Le.slice(0,An),mt=Pe=>{const Gn=parseInt(Pe.substring(3))||1;return Gn<=5?"easy":Gn<=10?"medium":"hard"},qn=Fe.filter(Pe=>Pe.startsWith(Q));let ht;Ce.difficultyMode==="manual"&&le?ht=Fe.filter(Pe=>{const Gn=Pe.startsWith(K),Oa=mt(Pe)===le;return Gn&&Oa}):ht=Fe.filter(Pe=>Pe.startsWith(K));const He=Fe.filter(Pe=>!Pe.startsWith(Q)&&!Pe.startsWith(K)),jr=[...ht,...He,...qn],si=[...It,...jr];if(Rr(si),C(Pe=>Pe+1),Oe.logEvent("task_switch",{fromTask:Et[An],toTaskType:K,toDifficulty:le,switchCost:Te,currentTaskIndex:An,queueLength:si.length,totalSwitches:x+1,currentScore:Math.round(((ae==null?void 0:ae.materials)||0)+((ae==null?void 0:ae.research)||0)+((ae==null?void 0:ae.engagement)||0)-(ln.switch+ln.unfinished))}).catch(Pe=>console.error("Error tracking switch:",Pe)),ht.length>0){const Pe=ht[0];bn(Pe).catch(Gn=>console.error("Error tracking switch:",Gn))}},lo=async(G,z)=>{var ai,qe;oo.current=Date.now();let Q=0;const K=G.startsWith("g1")?"research":G.startsWith("g2")?"materials":"engagement",le=G.startsWith("g1")?"g1":G.startsWith("g2")?"g2":"g3",ue=parseInt(G.substring(3))||1,he=ue<=5?"easy":ue<=10?"medium":"hard",Te=((qe=(ai=Ce.scoring)==null?void 0:ai[le])==null?void 0:qe[he])||{fullCorrect:2,halfCorrect:1},Le=Te.fullCorrect||2,Fe=Te.halfCorrect||1;let It=!1,mt=!1;if(K==="materials"){const xe=parseFloat(z.userAnswer||z.userValue||0),Ye=parseFloat(z.correctAnswer||z.targetValue||0),it=Math.abs(xe-Ye);It=it===0,mt=it>0&&it<=1}else if(K==="research"){const xe=parseInt(z.userAnswer||0),Ye=parseInt(z.correctAnswer||0),it=Math.abs(xe-Ye);It=it===0,mt=it>0&&it<=1}else if(K==="engagement"){const xe=z.userAnswer||"",Ye=z.correctAnswer||"";xe===Ye?It=!0:mt=AI(xe,Ye)===1}if(It?Q=Le:mt?Q=Fe:Q=0,Cn(xe=>{const Ye={...xe,[K]:xe[K]+Q};return console.log(` Updated ${K}: +${Q} (total: ${Ye[K]})`),Ye}),K==="materials"&&Q>0){const xe=ae.research;kn(Ye=>{const it=Ye[xe]||0;return{...Ye,[xe]:it+Q}})}const ht=.0015*(K==="engagement"?ae.engagement+Q:ae.engagement),He={...ae,[K]:ae[K]+Q};let jr=sr;if(K==="materials"&&Q>0){const xe=ae.research,Ye=sr[xe]||0;jr={...sr,[xe]:Ye+Q}}const si=He.materials||0,Pe=He.research||0,Gn=si*(1+Pe*.15),Nr=parseFloat(localStorage.getItem("engagementInterest")||"0")+ht*Gn;localStorage.setItem("engagementInterest",Nr.toString()),ir(xe=>({...xe,[G]:Q})),Ar(xe=>({...xe,[G]:(xe[G]||0)+1}));const ii={...ae,[K]:ae[K]+Q},oi=Hn(ii,jr);Ks(oi);let Lt="";if(K==="materials"){const xe=Math.abs((z.userValue||0)-(z.targetValue||0));xe===0?Lt="Perfect materials!":xe<=1?Lt=`Off by ${xe.toFixed(2)}`:Lt=`Off by ${xe.toFixed(2)}`}else if(K==="research"){const xe=Math.abs((z.userAnswer||0)-(z.correctAnswer||0));xe===0?Lt="Perfect research!":xe<=1?Lt=`Off by ${xe}`:Lt=`Off by ${xe}`}else K==="engagement"&&(Q===2?Lt="Perfect engagement!":Q===1?Lt="One typo":Lt="Multiple errors");Pn(`${Lt} | +${Q} ${K} pts`),y(xe=>({...xe,[G]:!0})),S(xe=>xe+1),E(xe=>xe+1),await Oe.trackTaskComplete(G,z.attempts,z.totalTime,z.accuracy||z.difference||0);const ws=Math.round((He.materials||0)+(He.research||0)+(He.engagement||0)-(ln.switch+ln.unfinished));if(await Oe.logEvent("task_complete",{taskId:G,...z,pointsEarned:Q,categoryPoints:He,studentLearningScore:oi,engagementInterest:Nr,totalScore:ws,completionContext:{totalTasksCompleted:Object.keys(p).length+1,currentGameTime:F,switchesBeforeCompletion:x,bonusPromptsEarned:R+1,timeRemaining:rr}}),k&&!k.startsWith("offline-")&&await dr(bt(Xe,"sessions",k),{[`completedTasks.${G}`]:!0,[`taskPoints.${G}`]:Q,categoryPoints:He,studentLearningScore:oi,engagementInterest:Nr,bonusPrompts:R+1,lastActivity:Ln()}),(Ce.gameMode||"knapsack")==="sequential"){const xe=G.substring(0,2),Ye=parseInt(G.substring(3))||1;if(Ye<100){const it=`${xe}t${Ye+1}`;bn(it,!0)}else{const it=["g2","g1","g3"],Ss=it.indexOf(xe);if(Ss<it.length-1){const Mr=`${it[Ss+1]}t1`;bn(Mr,!0)}else bn("g2t1",!0)}}else{const xe=An+1;if(xe<Et.length){un(xe);const Ye=Et[xe];let it=Object.keys(p).filter(Mr=>Mr.startsWith(Ye)).length;Ye===G.substring(0,2)&&G.startsWith(Ye)&&(it+=1);const Ss=it+1,li=`${Ye}t${Ss}`;bn(li,!0)}else me(!0)}},bn=async(G,z=!1)=>{if(oe)return;if(p[G]&&!z){Pn("Task already completed! Choose a different task.");return}const Q=c;if(h(G),_(K=>({...K,[G]:Date.now()})),Oe.setPageStartTime(G),oo.current=Date.now(),U&&($(!1),te(5),Dr.current&&(clearInterval(Dr.current),Dr.current=null)),Q!==G&&!z&&C(K=>K+1),z||Oe.logEvent("manual_tab_switch",{from:Q,to:G,reason:"user_clicked"}).catch(K=>console.error("Error logging tab switch:",K)),Oe.trackPageSwitch(Q,G,z).catch(K=>console.error("Error tracking page switch:",K)),g[Q]){const K=Date.now()-g[Q];Oe.logEvent("task_time",{taskId:Q,timeSpent:K,completed:p[Q]||!1,leftForTask:G}).catch(le=>console.error("Error logging task time:",le))}},Pn=G=>{const z=document.createElement("div");z.className="notification-enter",z.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",z.textContent=G,document.body.appendChild(z),setTimeout(()=>{z.className="notification-exit",setTimeout(()=>{document.body.contains(z)&&document.body.removeChild(z)},500)},3e3)},xs=async(G="semester_complete")=>{ms.current&&clearInterval(ms.current);const z=Math.floor((Date.now()-ei.current-Se)/1e3),Q=Hn(),K=ae.bonus||0,le=Math.max(0,Ce.totalTasks-Object.keys(p).length),ue=le*(Ce.unfinishedTaskPenalty||0);ue>0&&dt(Te=>({...Te,unfinished:ue}));const he=Math.round(Q)+K-ue;ue>0&&console.log(` Unfinished Penalty: -${ue} pts (${le} tasks x ${Ce.unfinishedTaskPenalty})`),await Oe.logEvent("game_complete",{totalTime:z,totalSwitches:x,completedTasks:Object.keys(p).length,completedLevels:m,completionReason:G,gameMode:s,currentSemester:ne,categoryPoints:ae,studentLearningScore:Q,totalBonus:K,finalScore:he,finalContext:{practiceCompleted:a==="yes",totalPrompts:3+R,isAdminMode:e}}),k&&!k.startsWith("offline-")&&await dr(bt(Xe,"sessions",k),{status:"completed",completedAt:Ln(),finalTime:z,timeElapsed:z,totalSwitches:x,completionReason:G,currentSemester:ne,finalScore:he,studentLearningScore:Q}),r("complete")},Fa=async G=>{const z={sender:"user",text:G,timestamp:Date.now()};br(K=>[...K,z]),Xs(!0);const Q={currentTask:c,timeRemaining:rr,score:Math.round(ps),completedTasks:Object.keys(p).length,totalTasks:Et.length};try{const K=(Ce.aiDelay||0)*1e3,le=await kt.getAdvice(G,Q);setTimeout(()=>{const ue={sender:"ai",text:le,timestamp:Date.now()};br(he=>[...he,ue]),Xs(!1),Pr||ja(he=>he+1),Oe.logEvent("ai_chat_message",{userMessage:G,aiResponse:le,currentTask:c,context:Q,aiDelay:K/1e3,currentScore:Math.round(ps),timeRemaining:rr}).catch(he=>console.error("Error tracking AI chat:",he)),Ce.aiCost>0&&(Cn(he=>({...he,bonus:(he.bonus||0)-Ce.aiCost})),Pn(`AI Help Cost: -${Ce.aiCost} pts`))},Math.max(1e3,K))}catch(K){console.error("AI Error:",K),Xs(!1),br(le=>[...le,{sender:"ai",text:"I'm having trouble connecting right now. Please try again.",timestamp:Date.now()}])}},Gt=(G,z)=>{if(z&&z.points&&z.points===2)Pa(Q=>({...Q,[G]:!0})),Pn("Perfect! Practice task completed."),setTimeout(()=>{Wn(null)},1500);else{const Q=(z==null?void 0:z.points)||0;Pn(`Practice requires 100% accuracy. You scored ${Q===1?"50%":"0%"}. Try again!`),setTimeout(()=>{Wn(null)},2e3)}},xn=()=>{const G=c[1],z=parseInt(c.substring(3)),Q=n==="practice";if(G==="1"){const le=Gs[z],ue=ba[z];return u.jsx(Jd,{taskNum:z,onComplete:Q?Gt:lo,currentTaskId:c,isPractice:Q,preGeneratedPattern:le,preGeneratedText:ue})}if(G==="2"){const le=Cr[z];return u.jsx(Zd,{taskNum:z,onComplete:Q?Gt:lo,currentTaskId:c,isPractice:Q,preGeneratedPattern:le})}const K=Tt[z];return u.jsx(eh,{taskNum:z,onComplete:Q?Gt:lo,currentTaskId:c,isPractice:Q,preGeneratedPattern:K})};if(n==="studentLogin")return u.jsx(_I,{onLoginSuccess:G=>{window.location.href=`${window.location.origin}?code=${G}`}});if(L)return u.jsx("div",{className:"app",children:u.jsxs("div",{style:{maxWidth:"600px",margin:"50px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[u.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Access Denied"}),u.jsx("p",{style:{fontSize:"18px",marginBottom:"20px"},children:T}),u.jsx("div",{style:{padding:"15px",background:"#ffebee",borderRadius:"8px",border:"1px solid #f44336"},children:u.jsx("p",{style:{color:"#c62828",margin:0},children:"If you believe this is an error, please contact your instructor."})})]})});if(n==="semesterBreak"){const G=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),z=ne===2&&G.checkpointSemester2;return u.jsx("div",{className:"app",children:u.jsxs("div",{style:{maxWidth:"700px",margin:"50px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[u.jsxs("h1",{style:{color:"#2196F3",marginBottom:"30px"},children:[" Semester ",ne-1," Complete!"]}),u.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[u.jsx("h3",{style:{color:"#1976d2",marginBottom:"10px"},children:"Take a Break!"}),u.jsxs("p",{style:{fontSize:"16px",color:"#666",marginBottom:"0"},children:["Great job completing Semester ",ne-1,"! Take a moment to rest your eyes, stretch, or grab some water before continuing."]})]}),z&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",padding:"25px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #ff9800"},children:[u.jsx("h3",{style:{color:"#f57c00",marginBottom:"15px"},children:" Midterm Checkpoint Coming!"}),u.jsxs("div",{style:{fontSize:"16px",color:"#666",textAlign:"left"},children:[u.jsx("p",{style:{marginBottom:"10px"},children:u.jsxs("strong",{children:["Semester 2 includes a midterm exam at the"," ",cn(),"-minute mark!"]})}),u.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"10px"},children:[u.jsx("li",{children:"Your students will be tested at the midpoint"}),u.jsxs("li",{children:["If student learning  300 points:"," ",u.jsx("strong",{children:"+300 bonus points!"})]}),u.jsx("li",{children:"Build up your teaching effectiveness early to maximize the bonus"})]}),u.jsxs("p",{style:{background:"white",padding:"10px",borderRadius:"4px",textAlign:"center",fontWeight:"bold",color:"#f57c00"},children:["Goal: Reach 300+ Student Learning by minute"," ",cn()]})]})]}),ge.length>0&&u.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[u.jsx("h4",{style:{color:"#666",marginBottom:"10px"},children:"Your Performance So Far:"}),ge.map((Q,K)=>u.jsxs("div",{style:{marginBottom:"8px",fontSize:"16px"},children:["Semester ",K+1,":"," ",u.jsxs("strong",{children:[Q.finalScore," points"]})]},K))]}),u.jsxs("div",{style:{marginTop:"30px"},children:[u.jsxs("button",{onClick:()=>{Re(K=>K+1),(Ce.gameMode||"knapsack")==="knapsack"?r("allocation"):(r("challenge"),vs()),y({}),Rr([]),un(0),me(!1),Ks(0),Cn({materials:0,research:0,engagement:0,bonus:0}),vs(),_({g2t1:Date.now()}),Oe.setPageStartTime("g2t1"),Oe.logEvent("semester_start",{semester:ne,timestamp:Date.now(),hasCheckpoint:z})},style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:Q=>{Q.currentTarget.style.transform="translateY(-2px)",Q.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:Q=>{Q.currentTarget.style.transform="translateY(0)",Q.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["I'm Ready - Start Semester ",ne]}),u.jsx("p",{style:{marginTop:"15px",fontSize:"14px",color:"#999"},children:"Click when you're ready to continue. The timer will start immediately."})]})]})})}if(n==="landing"){s||i({accuracy:"lenient",limit:"time"});const G=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),z=G.role==="admin",Q=Ce.gameMode||"knapsack",K=Ce.semesterDuration||12,le=Ce.totalTasks||10;return u.jsx("div",{className:"app",children:u.jsx("div",{style:{maxWidth:"1000px",margin:"40px auto",padding:"0 20px"},children:u.jsxs("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",padding:"40px"},children:[u.jsxs("h1",{style:{color:"#333",marginBottom:"10px",fontSize:"32px",textAlign:"center",fontWeight:"600"},children:["Can you beat Park? - Semester ",ne,"/",de]}),u.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%)",borderRadius:"12px",padding:"25px",marginBottom:"35px",border:"2px solid #2196F3",boxShadow:"0 2px 8px rgba(33, 150, 243, 0.2)"},children:[u.jsx("h2",{style:{color:"#1976d2",fontSize:"24px",marginBottom:"15px",textAlign:"center",fontWeight:"600"},children:" Game Overview"}),u.jsxs("p",{style:{fontSize:"18px",color:"#333",textAlign:"center",marginBottom:"12px",fontWeight:"500"},children:["You have"," ",u.jsxs("strong",{style:{color:"#1976d2"},children:[K," minutes"]})," ","to do"," ",u.jsxs("strong",{style:{color:"#1976d2"},children:[le," tasks"]}),", in what order?"]}),Q==="sequential"?u.jsxs("p",{style:{fontSize:"16px",color:"#555",textAlign:"center",fontStyle:"italic",background:"white",padding:"12px",borderRadius:"8px",marginTop:"10px"},children:[" ",u.jsx("strong",{children:"Sequential Mode:"})," Do as much as you can - the timer counts down but levels are infinite!"]}):u.jsxs("p",{style:{fontSize:"16px",color:"#555",textAlign:"center",fontStyle:"italic",background:"white",padding:"12px",borderRadius:"8px",marginTop:"10px"},children:[" ",u.jsx("strong",{children:"Knapsack Mode:"})," You can choose how many of each task to do!"]})]}),u.jsxs("div",{className:"game-info",style:{textAlign:"left"},children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px",marginBottom:"20px"},children:[u.jsxs("div",{style:{background:"#ffebee",borderRadius:"10px",padding:"15px",border:"2px solid #f44336",boxShadow:"0 2px 6px rgba(244, 67, 54, 0.1)"},children:[u.jsxs("h3",{style:{color:"#f44336",fontSize:"16px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""})," Engagement"]}),u.jsx("p",{style:{fontSize:"13px",lineHeight:"1.5",color:"#555",margin:0},children:"Build interest that compounds! Each point adds 0.15% interest after every task completion."})]}),u.jsxs("div",{style:{background:"#f3e5f5",borderRadius:"10px",padding:"15px",border:"2px solid #9C27B0",boxShadow:"0 2px 6px rgba(156, 39, 176, 0.1)"},children:[u.jsxs("h3",{style:{color:"#9C27B0",fontSize:"16px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""})," Research"]}),u.jsx("p",{style:{fontSize:"13px",lineHeight:"1.5",color:"#555",margin:0},children:"Research amplifies your FUTURE materials! Each point adds +15% multiplier to materials earned after the research (order matters!)."})]}),u.jsxs("div",{style:{background:"#e8f5e9",borderRadius:"10px",padding:"15px",border:"2px solid #4CAF50",boxShadow:"0 2px 6px rgba(76, 175, 80, 0.1)"},children:[u.jsxs("h3",{style:{color:"#4CAF50",fontSize:"16px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""})," Materials"]}),u.jsx("p",{style:{fontSize:"13px",lineHeight:"1.5",color:"#555",margin:0},children:"Create teaching materials - each point directly contributes to your goal points!"})]})]}),u.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #f0f8ff 100%)",borderRadius:"12px",padding:"25px",marginBottom:"30px",border:"2px solid #2196F3",boxShadow:"0 2px 8px rgba(33, 150, 243, 0.15)"},children:[u.jsxs("h3",{style:{color:"#1976d2",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px",fontWeight:"600"},children:[u.jsx("span",{style:{fontSize:"22px"},children:""})," Student Learning Formula"]}),u.jsxs("div",{style:{background:"white",padding:"12px",borderRadius:"8px",fontFamily:"monospace",fontSize:"14px",textAlign:"center",marginBottom:"12px",border:"2px solid #2196F3",lineHeight:"1.6"},children:["Goal ="," ",u.jsx("strong",{style:{color:"#1976d2"},children:"Materials  (1 + Research0.15) + Engagement Interest"}),u.jsxs("div",{style:{fontSize:"11px",marginTop:"6px",fontFamily:"sans-serif",color:"#666"},children:["Research multipliers apply only to materials earned"," ",u.jsx("em",{children:"after"})," the research"]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px",fontSize:"12px"},children:[u.jsxs("div",{children:[u.jsx("strong",{children:"Scoring:"})," Exact = 2 pts | Within 1 = 1 pt | Otherwise = 0 pts"]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Timing:"})," Task completion order affects your final score"]})]}),ne===2&&u.jsxs("div",{style:{marginTop:"8px",fontSize:"12px",color:"#f57c00",fontWeight:"600"},children:["At minute ",cn(),": Exam checkpoint (300+ Student Learning = 300 bonus)"]})]}),G.hasAI&&u.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"1px solid #ffc107"},children:[u.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"AI Assistant Available:"}),u.jsxs("ul",{style:{color:"#856404",lineHeight:"1.6",margin:"0",paddingLeft:"20px",fontSize:"14px"},children:[u.jsx("li",{children:"Click the help buttons below each task for AI assistance"}),u.jsx("li",{children:"Unlimited use but reliability varies"}),u.jsx("li",{children:'Type "strategy" or "order" in chat for strategic advice!'})]})]}),ne===2&&u.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"2px solid #ffc107"},children:[u.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:" Semester 2: Midterm Checkpoint!"}),u.jsxs("p",{style:{color:"#856404",fontSize:"14px",margin:0},children:["At the ",cn(),"-minute mark, if you have 300+ student learning points, you'll earn a 300-point bonus!"]})]})]}),!z&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)",borderRadius:"12px",padding:"20px",marginTop:"20px",marginBottom:"20px",border:"2px solid #d32f2f",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"12px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""}),u.jsx("h3",{style:{color:"#b71c1c",margin:0,fontSize:"18px",fontWeight:"600"},children:"ONE ATTEMPT ONLY - NO RESTART"})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),u.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[u.jsx("strong",{children:"No refresh/close"})," - Session ends"]})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),u.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[u.jsx("strong",{children:"No tab switching"})," - 30s warning"]})]})]}),u.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"6px",textAlign:"center",fontSize:"14px",color:"#b71c1c",fontWeight:"600"},children:" Ensure 40 minutes uninterrupted before starting"})]}),u.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:u.jsxs("button",{onClick:()=>r("practiceChoice"),style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:ue=>{ue.currentTarget.style.transform="translateY(-2px)",ue.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:ue=>{ue.currentTarget.style.transform="translateY(0)",ue.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",ne]})}),e&&u.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#ffcccb",borderRadius:"6px",border:"2px solid #ff0000",fontWeight:"bold",color:"#d00"},children:["ADMIN MODE: ",so/60," minute timer, checkpoint at"," ",cn(),"minute"]}),ge.length>0&&u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"6px",fontSize:"14px"},children:[u.jsx("strong",{children:"Previous Semesters:"}),ge.map((ue,he)=>u.jsxs("div",{style:{marginTop:"5px"},children:["Semester ",he+1,": ",ue.finalScore," points"]},he))]})]})})})}if(n==="practiceChoice"){const z=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";return u.jsx("div",{className:"app",children:u.jsx("div",{className:"landing-container",children:u.jsxs("div",{className:"landing-card",children:[u.jsx("h2",{style:{color:"#333",marginBottom:"20px"},children:z?"Practice Mode (Optional for Admin)":"Practice Mode (Required)"}),u.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:z?"As an admin, you can skip practice or try it first.":"You must complete all three practice tasks before starting the main game."}),u.jsx("p",{style:{color:"#888",fontSize:"14px",marginBottom:"30px",fontStyle:"italic"},children:"Practice lets you try each teaching task without time pressure."}),!z&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #1976d2",boxShadow:"0 4px 6px rgba(25, 118, 210, 0.1)"},children:[u.jsxs("h4",{style:{color:"#0d47a1",margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""}),"Required Practice Tasks (100% accuracy needed):"]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Ze.g2t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Ze.g2t1?"#4CAF50":"#e0e0e0"}`},children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),u.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:u.jsx("strong",{children:"Materials"})}),Ze.g2t1?u.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):u.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Ze.g1t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Ze.g1t1?"#4CAF50":"#e0e0e0"}`},children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),u.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:u.jsx("strong",{children:"Research"})}),Ze.g1t1?u.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):u.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Ze.g3t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Ze.g3t1?"#4CAF50":"#e0e0e0"}`},children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),u.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:u.jsx("strong",{children:"Engagement"})}),Ze.g3t1?u.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):u.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]})]}),u.jsx("div",{style:{marginTop:"16px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"6px",fontSize:"13px",color:"#0d47a1",textAlign:"center",fontStyle:"italic"},children:" Each task must be completed perfectly to proceed"})]}),u.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[u.jsx("button",{onClick:()=>ti("yes"),style:{padding:"15px 30px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:z?"Try Practice Mode":"Start Required Practice"}),z&&u.jsx("button",{onClick:()=>ti("no"),style:{padding:"15px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:"Skip Practice (Admin)"})]})]})})})}if(n==="practice"){const z=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";if(!hs)return u.jsxs("div",{className:"app",children:[u.jsx("h1",{children:"Teaching Simulation - Practice Mode"}),u.jsx(vI,{practiceCompleted:Ze,onPracticeComplete:Gt,onSelectPractice:Wn,onStartMainGame:()=>{const le=Ze.g2t1&&Ze.g1t1&&Ze.g3t1;!z&&!le?Pn("You must complete all three practice tasks first!"):ni()},isAdmin:z})]});const Q=hs[1],K=1;return u.jsx("div",{className:"app",children:u.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[u.jsx("button",{onClick:()=>Wn(null),style:{marginBottom:"20px",padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:" Back to Practice Menu"}),u.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[u.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),Q==="1"&&u.jsx(Jd,{taskNum:K,onComplete:Gt,currentTaskId:hs,isPractice:!0}),Q==="2"&&u.jsx(Zd,{taskNum:K,onComplete:Gt,currentTaskId:hs,isPractice:!0}),Q==="3"&&u.jsx(eh,{taskNum:K,onComplete:Gt,currentTaskId:hs,isPractice:!0})]})})}if(n==="complete"){const G=Math.floor(F/60),z=F%60,Q=Math.round(Hn()),K=ae.bonus||0,le=Q+K,ue={semester:ne,totalTime:F,completedLevels:m,categoryPoints:ae,switches:x,gameMode:s,randomSeed:st,studentLearningScore:Q,finalScore:le},he=async()=>{const Le=[...ge,ue];be(Le),localStorage.setItem("engagementInterest","0"),Cn({materials:0,research:0,engagement:0,bonus:0}),kn({}),k&&!k.startsWith("offline-")&&await dr(bt(Xe,"sessions",k),{[`semesterHistory.semester${ne}`]:ue,currentSemester:ne+1,lastActivity:Ln()}),Re(ne+1),kt.resetForNewSemester(),r("semesterBreak"),y({}),S(0),C(0),E(0),w(0),ye(0),h("g2t1"),Vt(!1),me(!1),un(0),Rr([]);const Fe=Math.floor(Math.random()*1e6);qt(Fe),ot.initializeSeed(Fe);const It={},mt={},qn={},ht={};for(let He=1;He<=100;He++)It[He]=ot.generateSliderPattern(He),mt[He]=ot.generateCountingPattern(He),qn[He]=ot.generateTypingPattern(He),ht[He]=ot.getTextPassage(He);nr(It),ct(mt),kr(qn),Qs(ht)},Te=ne>=de;return u.jsxs("div",{className:"app",children:[u.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[u.jsx("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"8px",border:"2px solid #2196F3"},children:u.jsxs("h2",{style:{color:"#2196F3",margin:0},children:["Semester ",ne," of ",de," Complete!"]})}),Te&&u.jsx(SI,{sessionId:k,completedLevels:m,totalTime:F,gameMode:s}),u.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginTop:"20px"},children:[u.jsxs("h2",{style:{color:"#333",marginBottom:"20px"},children:[" Semester ",ne," Performance"]}),u.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2196F3",marginBottom:"30px"},children:["Final Score: ",le," points"]}),u.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[u.jsxs("h3",{style:{margin:"0 0 15px 0",color:"#1976d2"},children:["Student Learning Score: ",Q]}),u.jsxs("div",{style:{fontSize:"16px",color:"#666"},children:["= ",ae.materials||0," (Materials) "," ",(1+(ae.research||0)*.15).toFixed(2)," ","(Research)",parseFloat(localStorage.getItem("engagementInterest")||"0")>0&&` + ${parseFloat(localStorage.getItem("engagementInterest")||"0").toFixed(2)} (Interest)`]}),K>0&&u.jsxs("div",{style:{marginTop:"10px",fontSize:"16px",color:"#1976d2"},children:["+ ",K," Checkpoint Bonus"]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"30px"},children:[u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Total Time"}),u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[G,"m ",z,"s"]})]}),u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Student Learning"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:Q})]})]}),(ne===2||K>0)&&u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Checkpoint Bonus"}),u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:["+",K]})]}),u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Tasks Completed"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:m})]})]}),u.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:"Teaching Performance by Category"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"30px"},children:[u.jsxs("div",{style:{background:"#f0f8f0",padding:"15px",borderRadius:"6px",border:"2px solid #4CAF5020"},children:[u.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",marginBottom:"5px"},children:" Materials"}),u.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:ae.materials||0}),u.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Base points"})]}),u.jsxs("div",{style:{background:"#f8f0ff",padding:"15px",borderRadius:"6px",border:"2px solid #9C27B020"},children:[u.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold",marginBottom:"5px"},children:" Research"}),u.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:ae.research||0}),u.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(ae.research||0)*15,"% to future materials"]})]}),u.jsxs("div",{style:{background:"#fff0f0",padding:"15px",borderRadius:"6px",border:"2px solid #f4433620"},children:[u.jsx("div",{style:{color:"#f44336",fontWeight:"bold",marginBottom:"5px"},children:" Engagement"}),u.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:ae.engagement||0}),u.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",((ae.engagement||0)*.15).toFixed(1),"% interest/task"]})]})]})]}),ne===2&&ae.bonus>0&&u.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[u.jsx("strong",{style:{color:"#856404"},children:" Exam Season Bonus: "}),u.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#856404"},children:["+",ae.bonus," points"]})]}),ge.length>0&&u.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[u.jsx("h4",{style:{color:"#666",marginBottom:"15px"},children:"Progress Over Semesters"}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px"},children:[...ge,ue].map((Le,Fe)=>u.jsxs("div",{style:{padding:"10px",background:Fe===ge.length?"#e3f2fd":"white",borderRadius:"6px",border:"1px solid #e0e0e0",textAlign:"center"},children:[u.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Semester ",Fe+1]}),u.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:Le.finalScore})]},Fe))})]}),u.jsx("div",{style:{marginTop:"30px",textAlign:"center"},children:Te?u.jsxs("div",{style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px",textAlign:"center"},children:[u.jsx("h3",{style:{color:"#856404",marginBottom:"10px"},children:" All semesters complete!"}),u.jsx("p",{style:{color:"#856404",marginBottom:"0"},children:"Return to the Qualtrics survey and enter your completion code to finish the study."})]}):u.jsxs("button",{onClick:he,style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",ne+1," "]})})]})}const or=Ce.gameMode||"knapsack";if(n==="allocation"&&or==="knapsack")return u.jsx(II,{onStart:Va,totalTasks:Ce.totalTasks,orderStrategy:Ce.taskOrderStrategy,durationMinutes:Ce.semesterDuration,difficultyMode:Ce.difficultyMode});if(n==="bonus_round"&&or==="knapsack")return u.jsx(kI,{timeRemaining:rr,onSelectTask:G=>{const z=[...Et,G];Rr(z);const Q=Object.keys(p).filter(le=>le.startsWith(G)).length,K=`${G}t${Q+1}`;r("challenge"),bn(K,!0)},onFinishEarly:()=>xs("finished_early")});const ri=G=>{let z=G,Q=null;G.includes("-")&&([z,Q]=G.split("-"));const K=z==="g1"?"Research":z==="g2"?"Materials":"Engagement",le=Ce.jarRefillFreezeTime||0;Oe.logEvent("jar_refill",{jarKey:G,taskType:z,taskTypeName:K,difficulty:Q,freezeTime:le,currentTaskIndex:An,queueLength:Et.length,allTasksCompleted:Ae,currentScore:Math.round(((ae==null?void 0:ae.materials)||0)+((ae==null?void 0:ae.research)||0)+((ae==null?void 0:ae.engagement)||0)-(ln.switch+ln.unfinished)),timeRemaining:rr}).catch(ue=>console.error("Error tracking refill:",ue)),le>0?(re(!0),I(`Refilling ${K}${Q?` (${Q})`:""} Jar...`),setTimeout(()=>{re(!1),I(""),_s(z,Q,1,(ue,he)=>{me(!1),un(he),Oe.logEvent("jar_refill_complete",{jarKey:G,taskType:z,difficulty:Q,newTaskId:ue,newTaskIndex:he}).catch(Te=>console.error("Error tracking refill complete:",Te)),bn(ue,!0).catch(Te=>console.error("Error switching to refilled task:",Te))})},le*1e3)):_s(z,Q,1,(ue,he)=>{me(!1),un(he),Oe.logEvent("jar_refill_complete",{jarKey:G,taskType:z,difficulty:Q,newTaskId:ue,newTaskIndex:he}).catch(Te=>console.error("Error tracking refill complete:",Te)),bn(ue,!0).catch(Te=>console.error("Error switching to refilled task:",Te))})},uo=(G,z="Paused")=>{G>0&&(re(!0),I(`${z}...`),setTimeout(()=>{re(!1),I("")},G*1e3))},Ue=(G,z)=>G<=5?"easy":G<=10?"medium":"hard",_s=(G,z,Q,K)=>{const le=Ce.difficultyMode==="manual";let ue=0;if(!z||!le){const Te=Object.keys(p).filter(Le=>Le.split("_")[0].startsWith(G));if(Te.length>0){const Le=Te.map(Fe=>{const mt=Fe.split("_")[0].match(new RegExp(`${G}t(\\d+)`));return mt?parseInt(mt[1]):0});ue=Math.max(...Le)}}const he=[];for(let Te=0;Te<Q;Te++){let Le;if(z&&le){const mt=Object.keys(p).filter(qn=>{const ht=qn.split("_")[0];if(!ht.startsWith(G))return!1;const He=ht.match(new RegExp(`${G}t(\\d+)`));if(!He)return!1;const jr=parseInt(He[1]);return Ue(jr)===z}).length;z==="easy"?Le=(mt+Te)%5+1:z==="medium"?Le=(mt+Te)%5+6:Le=11+mt+Te}else Le=ue+1+Te;const Fe=Date.now()+Te,It=`${G}t${Le}_${Fe}`;he.push(It)}Rr(Te=>{const Le=[...Te,...he];return K&&he.length>0&&K(he[0],Le.length-he.length),Le})};if(n==="challenge"&&or==="sequential")return u.jsxs("div",{className:"app",children:[u.jsx(yI,{current:c,completed:p,onSwitch:bn,limitMode:"time",categoryPoints:ae,timeRemaining:rr}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 340px",gap:"20px",maxWidth:"1400px",margin:"0 auto",padding:"20px"},children:[u.jsx("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:xn()}),u.jsx("div",{style:{height:"fit-content"},children:u.jsx(sm,{messages:Ys,onSendMessage:Fa,isAiTyping:Rn,isOpen:Pr,onToggle:()=>Js(!Pr),unreadCount:Zs,aiDelay:Ce.aiDelay,onPauseTimer:uo,currentTask:c,categoryPoints:ae})})]})]});if((n==="challenge"||n==="bonus_round")&&or==="knapsack")return u.jsxs("div",{className:"app",children:[q&&u.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"24px",flexDirection:"column",gap:"20px"},children:[u.jsx("div",{style:{fontSize:"48px"},children:""}),u.jsx("div",{children:T}),u.jsx("div",{style:{fontSize:"16px",opacity:.8},children:"Please wait..."})]}),u.jsx(CI,{currentTaskIndex:An,totalTasks:Et.length,taskQueue:Et,onSwitchTask:La,onRefill:ri,onFinishNow:()=>xs("all_tasks_done"),allocationCounts:Wu,points:Math.round(((ae==null?void 0:ae.materials)||0)+((ae==null?void 0:ae.research)||0)+((ae==null?void 0:ae.engagement)||0)-(ln.switch+ln.unfinished)),timeRemaining:rr,onTimeUp:()=>xs("time_up"),penalties:ln,difficultyMode:Ce.difficultyMode,categoryPoints:ae,globalConfig:Ce,allTasksCompleted:Ae,chatInterface:u.jsx(sm,{messages:Ys,onSendMessage:Fa,isAiTyping:Rn,isOpen:Pr,onToggle:()=>Js(!Pr),unreadCount:Zs,aiDelay:Ce.aiDelay,onPauseTimer:uo,currentTask:Et[An],categoryPoints:ae}),children:xn()})]})}v0(document.getElementById("root")).render(u.jsx(N.StrictMode,{children:u.jsx(RI,{})}));
//# sourceMappingURL=index-Dc8ZEuz7.js.map
