(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var om={exports:{}},hu={},am={exports:{}},Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var va=Symbol.for("react.element"),sx=Symbol.for("react.portal"),ix=Symbol.for("react.fragment"),ox=Symbol.for("react.strict_mode"),ax=Symbol.for("react.profiler"),lx=Symbol.for("react.provider"),ux=Symbol.for("react.context"),cx=Symbol.for("react.forward_ref"),dx=Symbol.for("react.suspense"),hx=Symbol.for("react.memo"),fx=Symbol.for("react.lazy"),Yf=Symbol.iterator;function px(t){return t===null||typeof t!="object"?null:(t=Yf&&t[Yf]||t["@@iterator"],typeof t=="function"?t:null)}var lm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},um=Object.assign,cm={};function Ki(t,e,n){this.props=t,this.context=e,this.refs=cm,this.updater=n||lm}Ki.prototype.isReactComponent={};Ki.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ki.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function dm(){}dm.prototype=Ki.prototype;function th(t,e,n){this.props=t,this.context=e,this.refs=cm,this.updater=n||lm}var nh=th.prototype=new dm;nh.constructor=th;um(nh,Ki.prototype);nh.isPureReactComponent=!0;var Xf=Array.isArray,hm=Object.prototype.hasOwnProperty,rh={current:null},fm={key:!0,ref:!0,__self:!0,__source:!0};function pm(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)hm.call(e,r)&&!fm.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),h=0;h<l;h++)c[h]=arguments[h+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:va,type:t,key:i,ref:a,props:s,_owner:rh.current}}function gx(t,e){return{$$typeof:va,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function sh(t){return typeof t=="object"&&t!==null&&t.$$typeof===va}function mx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Jf=/\/+/g;function Zu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?mx(""+t.key):e.toString(36)}function fl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case va:case sx:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+Zu(a,0):r,Xf(s)?(n="",t!=null&&(n=t.replace(Jf,"$&/")+"/"),fl(s,e,n,"",function(h){return h})):s!=null&&(sh(s)&&(s=gx(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Jf,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",Xf(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Zu(i,l);a+=fl(i,e,n,c,s)}else if(c=px(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Zu(i,l++),a+=fl(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function qa(t,e,n){if(t==null)return t;var r=[],s=0;return fl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function yx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Jt={current:null},pl={transition:null},vx={ReactCurrentDispatcher:Jt,ReactCurrentBatchConfig:pl,ReactCurrentOwner:rh};function gm(){throw Error("act(...) is not supported in production builds of React.")}Re.Children={map:qa,forEach:function(t,e,n){qa(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return qa(t,function(){e++}),e},toArray:function(t){return qa(t,function(e){return e})||[]},only:function(t){if(!sh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Re.Component=Ki;Re.Fragment=ix;Re.Profiler=ax;Re.PureComponent=th;Re.StrictMode=ox;Re.Suspense=dx;Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vx;Re.act=gm;Re.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=um({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=rh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)hm.call(e,c)&&!fm.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var h=0;h<c;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:va,type:t.type,key:s,ref:i,props:r,_owner:a}};Re.createContext=function(t){return t={$$typeof:ux,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:lx,_context:t},t.Consumer=t};Re.createElement=pm;Re.createFactory=function(t){var e=pm.bind(null,t);return e.type=t,e};Re.createRef=function(){return{current:null}};Re.forwardRef=function(t){return{$$typeof:cx,render:t}};Re.isValidElement=sh;Re.lazy=function(t){return{$$typeof:fx,_payload:{_status:-1,_result:t},_init:yx}};Re.memo=function(t,e){return{$$typeof:hx,type:t,compare:e===void 0?null:e}};Re.startTransition=function(t){var e=pl.transition;pl.transition={};try{t()}finally{pl.transition=e}};Re.unstable_act=gm;Re.useCallback=function(t,e){return Jt.current.useCallback(t,e)};Re.useContext=function(t){return Jt.current.useContext(t)};Re.useDebugValue=function(){};Re.useDeferredValue=function(t){return Jt.current.useDeferredValue(t)};Re.useEffect=function(t,e){return Jt.current.useEffect(t,e)};Re.useId=function(){return Jt.current.useId()};Re.useImperativeHandle=function(t,e,n){return Jt.current.useImperativeHandle(t,e,n)};Re.useInsertionEffect=function(t,e){return Jt.current.useInsertionEffect(t,e)};Re.useLayoutEffect=function(t,e){return Jt.current.useLayoutEffect(t,e)};Re.useMemo=function(t,e){return Jt.current.useMemo(t,e)};Re.useReducer=function(t,e,n){return Jt.current.useReducer(t,e,n)};Re.useRef=function(t){return Jt.current.useRef(t)};Re.useState=function(t){return Jt.current.useState(t)};Re.useSyncExternalStore=function(t,e,n){return Jt.current.useSyncExternalStore(t,e,n)};Re.useTransition=function(){return Jt.current.useTransition()};Re.version="18.3.1";am.exports=Re;var D=am.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xx=D,_x=Symbol.for("react.element"),wx=Symbol.for("react.fragment"),Sx=Object.prototype.hasOwnProperty,Tx=xx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ex={key:!0,ref:!0,__self:!0,__source:!0};function mm(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)Sx.call(e,r)&&!Ex.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:_x,type:t,key:i,ref:a,props:s,_owner:Tx.current}}hu.Fragment=wx;hu.jsx=mm;hu.jsxs=mm;om.exports=hu;var u=om.exports,ym={exports:{}},mn={},vm={exports:{}},xm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,B){var G=N.length;N.push(B);e:for(;0<G;){var U=G-1>>>1,b=N[U];if(0<s(b,B))N[U]=B,N[G]=b,G=U;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var B=N[0],G=N.pop();if(G!==B){N[0]=G;e:for(var U=0,b=N.length,V=b>>>1;U<V;){var $=2*(U+1)-1,re=N[$],Z=$+1,se=N[Z];if(0>s(re,G))Z<b&&0>s(se,re)?(N[U]=se,N[Z]=G,U=Z):(N[U]=re,N[$]=G,U=$);else if(Z<b&&0>s(se,G))N[U]=se,N[Z]=G,U=Z;else break e}}return B}function s(N,B){var G=N.sortIndex-B.sortIndex;return G!==0?G:N.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],h=[],p=1,y=null,m=3,I=!1,A=!1,P=!1,z=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(N){for(var B=n(h);B!==null;){if(B.callback===null)r(h);else if(B.startTime<=N)r(h),B.sortIndex=B.expirationTime,e(c,B);else break;B=n(h)}}function M(N){if(P=!1,T(N),!A)if(n(c)!==null)A=!0,Ie(H);else{var B=n(h);B!==null&&te(M,B.startTime-N)}}function H(N,B){A=!1,P&&(P=!1,k(g),g=-1),I=!0;var G=m;try{for(T(B),y=n(c);y!==null&&(!(y.expirationTime>B)||N&&!x());){var U=y.callback;if(typeof U=="function"){y.callback=null,m=y.priorityLevel;var b=U(y.expirationTime<=B);B=t.unstable_now(),typeof b=="function"?y.callback=b:y===n(c)&&r(c),T(B)}else r(c);y=n(c)}if(y!==null)var V=!0;else{var $=n(h);$!==null&&te(M,$.startTime-B),V=!1}return V}finally{y=null,m=G,I=!1}}var F=!1,w=null,g=-1,_=5,E=-1;function x(){return!(t.unstable_now()-E<_)}function R(){if(w!==null){var N=t.unstable_now();E=N;var B=!0;try{B=w(!0,N)}finally{B?C():(F=!1,w=null)}}else F=!1}var C;if(typeof S=="function")C=function(){S(R)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,me=ne.port2;ne.port1.onmessage=R,C=function(){me.postMessage(null)}}else C=function(){z(R,0)};function Ie(N){w=N,F||(F=!0,C())}function te(N,B){g=z(function(){N(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){A||I||(A=!0,Ie(H))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(N){switch(m){case 1:case 2:case 3:var B=3;break;default:B=m}var G=m;m=B;try{return N()}finally{m=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,B){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var G=m;m=N;try{return B()}finally{m=G}},t.unstable_scheduleCallback=function(N,B,G){var U=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?U+G:U):G=U,N){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=G+b,N={id:p++,callback:B,priorityLevel:N,startTime:G,expirationTime:b,sortIndex:-1},G>U?(N.sortIndex=G,e(h,N),n(c)===null&&N===n(h)&&(P?(k(g),g=-1):P=!0,te(M,G-U))):(N.sortIndex=b,e(c,N),A||I||(A=!0,Ie(H))),N},t.unstable_shouldYield=x,t.unstable_wrapCallback=function(N){var B=m;return function(){var G=m;m=B;try{return N.apply(this,arguments)}finally{m=G}}}})(xm);vm.exports=xm;var Ix=vm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cx=D,gn=Ix;function J(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _m=new Set,Ho={};function $s(t,e){Mi(t,e),Mi(t+"Capture",e)}function Mi(t,e){for(Ho[t]=e,t=0;t<e.length;t++)_m.add(e[t])}var xr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lc=Object.prototype.hasOwnProperty,Ax=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zf={},ep={};function kx(t){return Lc.call(ep,t)?!0:Lc.call(Zf,t)?!1:Ax.test(t)?ep[t]=!0:(Zf[t]=!0,!1)}function Rx(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function bx(t,e,n,r){if(e===null||typeof e>"u"||Rx(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Zt(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Lt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Lt[t]=new Zt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Lt[e]=new Zt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Lt[t]=new Zt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Lt[t]=new Zt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Lt[t]=new Zt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Lt[t]=new Zt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Lt[t]=new Zt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Lt[t]=new Zt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Lt[t]=new Zt(t,5,!1,t.toLowerCase(),null,!1,!1)});var ih=/[\-:]([a-z])/g;function oh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ih,oh);Lt[e]=new Zt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ih,oh);Lt[e]=new Zt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ih,oh);Lt[e]=new Zt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Lt[t]=new Zt(t,1,!1,t.toLowerCase(),null,!1,!1)});Lt.xlinkHref=new Zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Lt[t]=new Zt(t,1,!1,t.toLowerCase(),null,!0,!0)});function ah(t,e,n,r){var s=Lt.hasOwnProperty(e)?Lt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bx(e,n,s,r)&&(n=null),r||s===null?kx(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ar=Cx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ga=Symbol.for("react.element"),mi=Symbol.for("react.portal"),yi=Symbol.for("react.fragment"),lh=Symbol.for("react.strict_mode"),Fc=Symbol.for("react.profiler"),wm=Symbol.for("react.provider"),Sm=Symbol.for("react.context"),uh=Symbol.for("react.forward_ref"),Oc=Symbol.for("react.suspense"),zc=Symbol.for("react.suspense_list"),ch=Symbol.for("react.memo"),Or=Symbol.for("react.lazy"),Tm=Symbol.for("react.offscreen"),tp=Symbol.iterator;function fo(t){return t===null||typeof t!="object"?null:(t=tp&&t[tp]||t["@@iterator"],typeof t=="function"?t:null)}var it=Object.assign,ec;function So(t){if(ec===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ec=e&&e[1]||""}return`
`+ec+t}var tc=!1;function nc(t,e){if(!t||tc)return"";tc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{tc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?So(t):""}function Px(t){switch(t.tag){case 5:return So(t.type);case 16:return So("Lazy");case 13:return So("Suspense");case 19:return So("SuspenseList");case 0:case 2:case 15:return t=nc(t.type,!1),t;case 11:return t=nc(t.type.render,!1),t;case 1:return t=nc(t.type,!0),t;default:return""}}function Bc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case yi:return"Fragment";case mi:return"Portal";case Fc:return"Profiler";case lh:return"StrictMode";case Oc:return"Suspense";case zc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Sm:return(t.displayName||"Context")+".Consumer";case wm:return(t._context.displayName||"Context")+".Provider";case uh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ch:return e=t.displayName||null,e!==null?e:Bc(t.type)||"Memo";case Or:e=t._payload,t=t._init;try{return Bc(t(e))}catch{}}return null}function jx(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bc(e);case 8:return e===lh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ss(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Em(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Dx(t){var e=Em(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Qa(t){t._valueTracker||(t._valueTracker=Dx(t))}function Im(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Em(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function bl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Uc(t,e){var n=e.checked;return it({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function np(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ss(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Cm(t,e){e=e.checked,e!=null&&ah(t,"checked",e,!1)}function $c(t,e){Cm(t,e);var n=ss(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Wc(t,e.type,n):e.hasOwnProperty("defaultValue")&&Wc(t,e.type,ss(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function rp(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Wc(t,e,n){(e!=="number"||bl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var To=Array.isArray;function ki(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ss(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Hc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(J(91));return it({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function sp(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(J(92));if(To(n)){if(1<n.length)throw Error(J(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ss(n)}}function Am(t,e){var n=ss(e.value),r=ss(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function ip(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function km(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?km(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ka,Rm=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ka=Ka||document.createElement("div"),Ka.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ka.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function qo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Po={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nx=["Webkit","ms","Moz","O"];Object.keys(Po).forEach(function(t){Nx.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Po[e]=Po[t]})});function bm(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Po.hasOwnProperty(t)&&Po[t]?(""+e).trim():e+"px"}function Pm(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=bm(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Mx=it({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gc(t,e){if(e){if(Mx[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(J(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(J(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(J(61))}if(e.style!=null&&typeof e.style!="object")throw Error(J(62))}}function Qc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kc=null;function dh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Yc=null,Ri=null,bi=null;function op(t){if(t=wa(t)){if(typeof Yc!="function")throw Error(J(280));var e=t.stateNode;e&&(e=yu(e),Yc(t.stateNode,t.type,e))}}function jm(t){Ri?bi?bi.push(t):bi=[t]:Ri=t}function Dm(){if(Ri){var t=Ri,e=bi;if(bi=Ri=null,op(t),e)for(t=0;t<e.length;t++)op(e[t])}}function Nm(t,e){return t(e)}function Mm(){}var rc=!1;function Vm(t,e,n){if(rc)return t(e,n);rc=!0;try{return Nm(t,e,n)}finally{rc=!1,(Ri!==null||bi!==null)&&(Mm(),Dm())}}function Go(t,e){var n=t.stateNode;if(n===null)return null;var r=yu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(J(231,e,typeof n));return n}var Xc=!1;if(xr)try{var po={};Object.defineProperty(po,"passive",{get:function(){Xc=!0}}),window.addEventListener("test",po,po),window.removeEventListener("test",po,po)}catch{Xc=!1}function Vx(t,e,n,r,s,i,a,l,c){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var jo=!1,Pl=null,jl=!1,Jc=null,Lx={onError:function(t){jo=!0,Pl=t}};function Fx(t,e,n,r,s,i,a,l,c){jo=!1,Pl=null,Vx.apply(Lx,arguments)}function Ox(t,e,n,r,s,i,a,l,c){if(Fx.apply(this,arguments),jo){if(jo){var h=Pl;jo=!1,Pl=null}else throw Error(J(198));jl||(jl=!0,Jc=h)}}function Ws(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Lm(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ap(t){if(Ws(t)!==t)throw Error(J(188))}function zx(t){var e=t.alternate;if(!e){if(e=Ws(t),e===null)throw Error(J(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return ap(s),t;if(i===r)return ap(s),e;i=i.sibling}throw Error(J(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(J(189))}}if(n.alternate!==r)throw Error(J(190))}if(n.tag!==3)throw Error(J(188));return n.stateNode.current===n?t:e}function Fm(t){return t=zx(t),t!==null?Om(t):null}function Om(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Om(t);if(e!==null)return e;t=t.sibling}return null}var zm=gn.unstable_scheduleCallback,lp=gn.unstable_cancelCallback,Bx=gn.unstable_shouldYield,Ux=gn.unstable_requestPaint,ht=gn.unstable_now,$x=gn.unstable_getCurrentPriorityLevel,hh=gn.unstable_ImmediatePriority,Bm=gn.unstable_UserBlockingPriority,Dl=gn.unstable_NormalPriority,Wx=gn.unstable_LowPriority,Um=gn.unstable_IdlePriority,fu=null,Jn=null;function Hx(t){if(Jn&&typeof Jn.onCommitFiberRoot=="function")try{Jn.onCommitFiberRoot(fu,t,void 0,(t.current.flags&128)===128)}catch{}}var zn=Math.clz32?Math.clz32:Qx,qx=Math.log,Gx=Math.LN2;function Qx(t){return t>>>=0,t===0?32:31-(qx(t)/Gx|0)|0}var Ya=64,Xa=4194304;function Eo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Nl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Eo(l):(i&=a,i!==0&&(r=Eo(i)))}else a=n&~s,a!==0?r=Eo(a):i!==0&&(r=Eo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-zn(e),s=1<<n,r|=t[n],e&=~s;return r}function Kx(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yx(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-zn(i),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=Kx(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Zc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function $m(){var t=Ya;return Ya<<=1,!(Ya&4194240)&&(Ya=64),t}function sc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function xa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-zn(e),t[e]=n}function Xx(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-zn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function fh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-zn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var $e=0;function Wm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Hm,ph,qm,Gm,Qm,ed=!1,Ja=[],qr=null,Gr=null,Qr=null,Qo=new Map,Ko=new Map,Br=[],Jx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function up(t,e){switch(t){case"focusin":case"focusout":qr=null;break;case"dragenter":case"dragleave":Gr=null;break;case"mouseover":case"mouseout":Qr=null;break;case"pointerover":case"pointerout":Qo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ko.delete(e.pointerId)}}function go(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=wa(e),e!==null&&ph(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Zx(t,e,n,r,s){switch(e){case"focusin":return qr=go(qr,t,e,n,r,s),!0;case"dragenter":return Gr=go(Gr,t,e,n,r,s),!0;case"mouseover":return Qr=go(Qr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Qo.set(i,go(Qo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ko.set(i,go(Ko.get(i)||null,t,e,n,r,s)),!0}return!1}function Km(t){var e=ks(t.target);if(e!==null){var n=Ws(e);if(n!==null){if(e=n.tag,e===13){if(e=Lm(n),e!==null){t.blockedOn=e,Qm(t.priority,function(){qm(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function gl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=td(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Kc=r,n.target.dispatchEvent(r),Kc=null}else return e=wa(n),e!==null&&ph(e),t.blockedOn=n,!1;e.shift()}return!0}function cp(t,e,n){gl(t)&&n.delete(e)}function e1(){ed=!1,qr!==null&&gl(qr)&&(qr=null),Gr!==null&&gl(Gr)&&(Gr=null),Qr!==null&&gl(Qr)&&(Qr=null),Qo.forEach(cp),Ko.forEach(cp)}function mo(t,e){t.blockedOn===e&&(t.blockedOn=null,ed||(ed=!0,gn.unstable_scheduleCallback(gn.unstable_NormalPriority,e1)))}function Yo(t){function e(s){return mo(s,t)}if(0<Ja.length){mo(Ja[0],t);for(var n=1;n<Ja.length;n++){var r=Ja[n];r.blockedOn===t&&(r.blockedOn=null)}}for(qr!==null&&mo(qr,t),Gr!==null&&mo(Gr,t),Qr!==null&&mo(Qr,t),Qo.forEach(e),Ko.forEach(e),n=0;n<Br.length;n++)r=Br[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Br.length&&(n=Br[0],n.blockedOn===null);)Km(n),n.blockedOn===null&&Br.shift()}var Pi=Ar.ReactCurrentBatchConfig,Ml=!0;function t1(t,e,n,r){var s=$e,i=Pi.transition;Pi.transition=null;try{$e=1,gh(t,e,n,r)}finally{$e=s,Pi.transition=i}}function n1(t,e,n,r){var s=$e,i=Pi.transition;Pi.transition=null;try{$e=4,gh(t,e,n,r)}finally{$e=s,Pi.transition=i}}function gh(t,e,n,r){if(Ml){var s=td(t,e,n,r);if(s===null)pc(t,e,r,Vl,n),up(t,r);else if(Zx(s,t,e,n,r))r.stopPropagation();else if(up(t,r),e&4&&-1<Jx.indexOf(t)){for(;s!==null;){var i=wa(s);if(i!==null&&Hm(i),i=td(t,e,n,r),i===null&&pc(t,e,r,Vl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else pc(t,e,r,null,n)}}var Vl=null;function td(t,e,n,r){if(Vl=null,t=dh(r),t=ks(t),t!==null)if(e=Ws(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Lm(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Vl=t,null}function Ym(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($x()){case hh:return 1;case Bm:return 4;case Dl:case Wx:return 16;case Um:return 536870912;default:return 16}default:return 16}}var $r=null,mh=null,ml=null;function Xm(){if(ml)return ml;var t,e=mh,n=e.length,r,s="value"in $r?$r.value:$r.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return ml=s.slice(t,1<r?1-r:void 0)}function yl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Za(){return!0}function dp(){return!1}function yn(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Za:dp,this.isPropagationStopped=dp,this}return it(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Za)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Za)},persist:function(){},isPersistent:Za}),e}var Yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yh=yn(Yi),_a=it({},Yi,{view:0,detail:0}),r1=yn(_a),ic,oc,yo,pu=it({},_a,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==yo&&(yo&&t.type==="mousemove"?(ic=t.screenX-yo.screenX,oc=t.screenY-yo.screenY):oc=ic=0,yo=t),ic)},movementY:function(t){return"movementY"in t?t.movementY:oc}}),hp=yn(pu),s1=it({},pu,{dataTransfer:0}),i1=yn(s1),o1=it({},_a,{relatedTarget:0}),ac=yn(o1),a1=it({},Yi,{animationName:0,elapsedTime:0,pseudoElement:0}),l1=yn(a1),u1=it({},Yi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),c1=yn(u1),d1=it({},Yi,{data:0}),fp=yn(d1),h1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},f1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},p1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function g1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=p1[t])?!!e[t]:!1}function vh(){return g1}var m1=it({},_a,{key:function(t){if(t.key){var e=h1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=yl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?f1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vh,charCode:function(t){return t.type==="keypress"?yl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?yl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),y1=yn(m1),v1=it({},pu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pp=yn(v1),x1=it({},_a,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vh}),_1=yn(x1),w1=it({},Yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),S1=yn(w1),T1=it({},pu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),E1=yn(T1),I1=[9,13,27,32],xh=xr&&"CompositionEvent"in window,Do=null;xr&&"documentMode"in document&&(Do=document.documentMode);var C1=xr&&"TextEvent"in window&&!Do,Jm=xr&&(!xh||Do&&8<Do&&11>=Do),gp=" ",mp=!1;function Zm(t,e){switch(t){case"keyup":return I1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ey(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var vi=!1;function A1(t,e){switch(t){case"compositionend":return ey(e);case"keypress":return e.which!==32?null:(mp=!0,gp);case"textInput":return t=e.data,t===gp&&mp?null:t;default:return null}}function k1(t,e){if(vi)return t==="compositionend"||!xh&&Zm(t,e)?(t=Xm(),ml=mh=$r=null,vi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Jm&&e.locale!=="ko"?null:e.data;default:return null}}var R1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!R1[t.type]:e==="textarea"}function ty(t,e,n,r){jm(r),e=Ll(e,"onChange"),0<e.length&&(n=new yh("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var No=null,Xo=null;function b1(t){hy(t,0)}function gu(t){var e=wi(t);if(Im(e))return t}function P1(t,e){if(t==="change")return e}var ny=!1;if(xr){var lc;if(xr){var uc="oninput"in document;if(!uc){var vp=document.createElement("div");vp.setAttribute("oninput","return;"),uc=typeof vp.oninput=="function"}lc=uc}else lc=!1;ny=lc&&(!document.documentMode||9<document.documentMode)}function xp(){No&&(No.detachEvent("onpropertychange",ry),Xo=No=null)}function ry(t){if(t.propertyName==="value"&&gu(Xo)){var e=[];ty(e,Xo,t,dh(t)),Vm(b1,e)}}function j1(t,e,n){t==="focusin"?(xp(),No=e,Xo=n,No.attachEvent("onpropertychange",ry)):t==="focusout"&&xp()}function D1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return gu(Xo)}function N1(t,e){if(t==="click")return gu(e)}function M1(t,e){if(t==="input"||t==="change")return gu(e)}function V1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var $n=typeof Object.is=="function"?Object.is:V1;function Jo(t,e){if($n(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Lc.call(e,s)||!$n(t[s],e[s]))return!1}return!0}function _p(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function wp(t,e){var n=_p(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_p(n)}}function sy(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?sy(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function iy(){for(var t=window,e=bl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=bl(t.document)}return e}function _h(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function L1(t){var e=iy(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&sy(n.ownerDocument.documentElement,n)){if(r!==null&&_h(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=wp(n,i);var a=wp(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var F1=xr&&"documentMode"in document&&11>=document.documentMode,xi=null,nd=null,Mo=null,rd=!1;function Sp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;rd||xi==null||xi!==bl(r)||(r=xi,"selectionStart"in r&&_h(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Mo&&Jo(Mo,r)||(Mo=r,r=Ll(nd,"onSelect"),0<r.length&&(e=new yh("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=xi)))}function el(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var _i={animationend:el("Animation","AnimationEnd"),animationiteration:el("Animation","AnimationIteration"),animationstart:el("Animation","AnimationStart"),transitionend:el("Transition","TransitionEnd")},cc={},oy={};xr&&(oy=document.createElement("div").style,"AnimationEvent"in window||(delete _i.animationend.animation,delete _i.animationiteration.animation,delete _i.animationstart.animation),"TransitionEvent"in window||delete _i.transitionend.transition);function mu(t){if(cc[t])return cc[t];if(!_i[t])return t;var e=_i[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in oy)return cc[t]=e[n];return t}var ay=mu("animationend"),ly=mu("animationiteration"),uy=mu("animationstart"),cy=mu("transitionend"),dy=new Map,Tp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function us(t,e){dy.set(t,e),$s(e,[t])}for(var dc=0;dc<Tp.length;dc++){var hc=Tp[dc],O1=hc.toLowerCase(),z1=hc[0].toUpperCase()+hc.slice(1);us(O1,"on"+z1)}us(ay,"onAnimationEnd");us(ly,"onAnimationIteration");us(uy,"onAnimationStart");us("dblclick","onDoubleClick");us("focusin","onFocus");us("focusout","onBlur");us(cy,"onTransitionEnd");Mi("onMouseEnter",["mouseout","mouseover"]);Mi("onMouseLeave",["mouseout","mouseover"]);Mi("onPointerEnter",["pointerout","pointerover"]);Mi("onPointerLeave",["pointerout","pointerover"]);$s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$s("onBeforeInput",["compositionend","keypress","textInput","paste"]);$s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Io="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Io));function Ep(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Ox(r,e,void 0,t),t.currentTarget=null}function hy(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,h=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;Ep(s,l,h),i=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,h=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;Ep(s,l,h),i=c}}}if(jl)throw t=Jc,jl=!1,Jc=null,t}function Ye(t,e){var n=e[ld];n===void 0&&(n=e[ld]=new Set);var r=t+"__bubble";n.has(r)||(fy(e,t,2,!1),n.add(r))}function fc(t,e,n){var r=0;e&&(r|=4),fy(n,t,r,e)}var tl="_reactListening"+Math.random().toString(36).slice(2);function Zo(t){if(!t[tl]){t[tl]=!0,_m.forEach(function(n){n!=="selectionchange"&&(B1.has(n)||fc(n,!1,t),fc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[tl]||(e[tl]=!0,fc("selectionchange",!1,e))}}function fy(t,e,n,r){switch(Ym(e)){case 1:var s=t1;break;case 4:s=n1;break;default:s=gh}n=s.bind(null,e,n,t),s=void 0,!Xc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function pc(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=ks(l),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}l=l.parentNode}}r=r.return}Vm(function(){var h=i,p=dh(n),y=[];e:{var m=dy.get(t);if(m!==void 0){var I=yh,A=t;switch(t){case"keypress":if(yl(n)===0)break e;case"keydown":case"keyup":I=y1;break;case"focusin":A="focus",I=ac;break;case"focusout":A="blur",I=ac;break;case"beforeblur":case"afterblur":I=ac;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=hp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=i1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=_1;break;case ay:case ly:case uy:I=l1;break;case cy:I=S1;break;case"scroll":I=r1;break;case"wheel":I=E1;break;case"copy":case"cut":case"paste":I=c1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=pp}var P=(e&4)!==0,z=!P&&t==="scroll",k=P?m!==null?m+"Capture":null:m;P=[];for(var S=h,T;S!==null;){T=S;var M=T.stateNode;if(T.tag===5&&M!==null&&(T=M,k!==null&&(M=Go(S,k),M!=null&&P.push(ea(S,M,T)))),z)break;S=S.return}0<P.length&&(m=new I(m,A,null,n,p),y.push({event:m,listeners:P}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",m&&n!==Kc&&(A=n.relatedTarget||n.fromElement)&&(ks(A)||A[_r]))break e;if((I||m)&&(m=p.window===p?p:(m=p.ownerDocument)?m.defaultView||m.parentWindow:window,I?(A=n.relatedTarget||n.toElement,I=h,A=A?ks(A):null,A!==null&&(z=Ws(A),A!==z||A.tag!==5&&A.tag!==6)&&(A=null)):(I=null,A=h),I!==A)){if(P=hp,M="onMouseLeave",k="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(P=pp,M="onPointerLeave",k="onPointerEnter",S="pointer"),z=I==null?m:wi(I),T=A==null?m:wi(A),m=new P(M,S+"leave",I,n,p),m.target=z,m.relatedTarget=T,M=null,ks(p)===h&&(P=new P(k,S+"enter",A,n,p),P.target=T,P.relatedTarget=z,M=P),z=M,I&&A)t:{for(P=I,k=A,S=0,T=P;T;T=di(T))S++;for(T=0,M=k;M;M=di(M))T++;for(;0<S-T;)P=di(P),S--;for(;0<T-S;)k=di(k),T--;for(;S--;){if(P===k||k!==null&&P===k.alternate)break t;P=di(P),k=di(k)}P=null}else P=null;I!==null&&Ip(y,m,I,P,!1),A!==null&&z!==null&&Ip(y,z,A,P,!0)}}e:{if(m=h?wi(h):window,I=m.nodeName&&m.nodeName.toLowerCase(),I==="select"||I==="input"&&m.type==="file")var H=P1;else if(yp(m))if(ny)H=M1;else{H=D1;var F=j1}else(I=m.nodeName)&&I.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(H=N1);if(H&&(H=H(t,h))){ty(y,H,n,p);break e}F&&F(t,m,h),t==="focusout"&&(F=m._wrapperState)&&F.controlled&&m.type==="number"&&Wc(m,"number",m.value)}switch(F=h?wi(h):window,t){case"focusin":(yp(F)||F.contentEditable==="true")&&(xi=F,nd=h,Mo=null);break;case"focusout":Mo=nd=xi=null;break;case"mousedown":rd=!0;break;case"contextmenu":case"mouseup":case"dragend":rd=!1,Sp(y,n,p);break;case"selectionchange":if(F1)break;case"keydown":case"keyup":Sp(y,n,p)}var w;if(xh)e:{switch(t){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else vi?Zm(t,n)&&(g="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(g="onCompositionStart");g&&(Jm&&n.locale!=="ko"&&(vi||g!=="onCompositionStart"?g==="onCompositionEnd"&&vi&&(w=Xm()):($r=p,mh="value"in $r?$r.value:$r.textContent,vi=!0)),F=Ll(h,g),0<F.length&&(g=new fp(g,t,null,n,p),y.push({event:g,listeners:F}),w?g.data=w:(w=ey(n),w!==null&&(g.data=w)))),(w=C1?A1(t,n):k1(t,n))&&(h=Ll(h,"onBeforeInput"),0<h.length&&(p=new fp("onBeforeInput","beforeinput",null,n,p),y.push({event:p,listeners:h}),p.data=w))}hy(y,e)})}function ea(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ll(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Go(t,n),i!=null&&r.unshift(ea(t,i,s)),i=Go(t,e),i!=null&&r.push(ea(t,i,s))),t=t.return}return r}function di(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ip(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,h=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&h!==null&&(l=h,s?(c=Go(n,i),c!=null&&a.unshift(ea(n,c,l))):s||(c=Go(n,i),c!=null&&a.push(ea(n,c,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var U1=/\r\n?/g,$1=/\u0000|\uFFFD/g;function Cp(t){return(typeof t=="string"?t:""+t).replace(U1,`
`).replace($1,"")}function nl(t,e,n){if(e=Cp(e),Cp(t)!==e&&n)throw Error(J(425))}function Fl(){}var sd=null,id=null;function od(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ad=typeof setTimeout=="function"?setTimeout:void 0,W1=typeof clearTimeout=="function"?clearTimeout:void 0,Ap=typeof Promise=="function"?Promise:void 0,H1=typeof queueMicrotask=="function"?queueMicrotask:typeof Ap<"u"?function(t){return Ap.resolve(null).then(t).catch(q1)}:ad;function q1(t){setTimeout(function(){throw t})}function gc(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Yo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Yo(e)}function Kr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function kp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Xi=Math.random().toString(36).slice(2),Xn="__reactFiber$"+Xi,ta="__reactProps$"+Xi,_r="__reactContainer$"+Xi,ld="__reactEvents$"+Xi,G1="__reactListeners$"+Xi,Q1="__reactHandles$"+Xi;function ks(t){var e=t[Xn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[_r]||n[Xn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=kp(t);t!==null;){if(n=t[Xn])return n;t=kp(t)}return e}t=n,n=t.parentNode}return null}function wa(t){return t=t[Xn]||t[_r],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function wi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(J(33))}function yu(t){return t[ta]||null}var ud=[],Si=-1;function cs(t){return{current:t}}function Ze(t){0>Si||(t.current=ud[Si],ud[Si]=null,Si--)}function Ge(t,e){Si++,ud[Si]=t.current,t.current=e}var is={},Gt=cs(is),sn=cs(!1),Ms=is;function Vi(t,e){var n=t.type.contextTypes;if(!n)return is;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function on(t){return t=t.childContextTypes,t!=null}function Ol(){Ze(sn),Ze(Gt)}function Rp(t,e,n){if(Gt.current!==is)throw Error(J(168));Ge(Gt,e),Ge(sn,n)}function py(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(J(108,jx(t)||"Unknown",s));return it({},n,r)}function zl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||is,Ms=Gt.current,Ge(Gt,t),Ge(sn,sn.current),!0}function bp(t,e,n){var r=t.stateNode;if(!r)throw Error(J(169));n?(t=py(t,e,Ms),r.__reactInternalMemoizedMergedChildContext=t,Ze(sn),Ze(Gt),Ge(Gt,t)):Ze(sn),Ge(sn,n)}var hr=null,vu=!1,mc=!1;function gy(t){hr===null?hr=[t]:hr.push(t)}function K1(t){vu=!0,gy(t)}function ds(){if(!mc&&hr!==null){mc=!0;var t=0,e=$e;try{var n=hr;for($e=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}hr=null,vu=!1}catch(s){throw hr!==null&&(hr=hr.slice(t+1)),zm(hh,ds),s}finally{$e=e,mc=!1}}return null}var Ti=[],Ei=0,Bl=null,Ul=0,_n=[],wn=0,Vs=null,gr=1,mr="";function Is(t,e){Ti[Ei++]=Ul,Ti[Ei++]=Bl,Bl=t,Ul=e}function my(t,e,n){_n[wn++]=gr,_n[wn++]=mr,_n[wn++]=Vs,Vs=t;var r=gr;t=mr;var s=32-zn(r)-1;r&=~(1<<s),n+=1;var i=32-zn(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,gr=1<<32-zn(e)+s|n<<s|r,mr=i+t}else gr=1<<i|n<<s|r,mr=t}function wh(t){t.return!==null&&(Is(t,1),my(t,1,0))}function Sh(t){for(;t===Bl;)Bl=Ti[--Ei],Ti[Ei]=null,Ul=Ti[--Ei],Ti[Ei]=null;for(;t===Vs;)Vs=_n[--wn],_n[wn]=null,mr=_n[--wn],_n[wn]=null,gr=_n[--wn],_n[wn]=null}var pn=null,hn=null,tt=!1,On=null;function yy(t,e){var n=Sn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Pp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,pn=t,hn=Kr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,pn=t,hn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Vs!==null?{id:gr,overflow:mr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Sn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,pn=t,hn=null,!0):!1;default:return!1}}function cd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function dd(t){if(tt){var e=hn;if(e){var n=e;if(!Pp(t,e)){if(cd(t))throw Error(J(418));e=Kr(n.nextSibling);var r=pn;e&&Pp(t,e)?yy(r,n):(t.flags=t.flags&-4097|2,tt=!1,pn=t)}}else{if(cd(t))throw Error(J(418));t.flags=t.flags&-4097|2,tt=!1,pn=t}}}function jp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;pn=t}function rl(t){if(t!==pn)return!1;if(!tt)return jp(t),tt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!od(t.type,t.memoizedProps)),e&&(e=hn)){if(cd(t))throw vy(),Error(J(418));for(;e;)yy(t,e),e=Kr(e.nextSibling)}if(jp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(J(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){hn=Kr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}hn=null}}else hn=pn?Kr(t.stateNode.nextSibling):null;return!0}function vy(){for(var t=hn;t;)t=Kr(t.nextSibling)}function Li(){hn=pn=null,tt=!1}function Th(t){On===null?On=[t]:On.push(t)}var Y1=Ar.ReactCurrentBatchConfig;function vo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(J(309));var r=n.stateNode}if(!r)throw Error(J(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(J(284));if(!n._owner)throw Error(J(290,t))}return t}function sl(t,e){throw t=Object.prototype.toString.call(e),Error(J(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Dp(t){var e=t._init;return e(t._payload)}function xy(t){function e(k,S){if(t){var T=k.deletions;T===null?(k.deletions=[S],k.flags|=16):T.push(S)}}function n(k,S){if(!t)return null;for(;S!==null;)e(k,S),S=S.sibling;return null}function r(k,S){for(k=new Map;S!==null;)S.key!==null?k.set(S.key,S):k.set(S.index,S),S=S.sibling;return k}function s(k,S){return k=Zr(k,S),k.index=0,k.sibling=null,k}function i(k,S,T){return k.index=T,t?(T=k.alternate,T!==null?(T=T.index,T<S?(k.flags|=2,S):T):(k.flags|=2,S)):(k.flags|=1048576,S)}function a(k){return t&&k.alternate===null&&(k.flags|=2),k}function l(k,S,T,M){return S===null||S.tag!==6?(S=Tc(T,k.mode,M),S.return=k,S):(S=s(S,T),S.return=k,S)}function c(k,S,T,M){var H=T.type;return H===yi?p(k,S,T.props.children,M,T.key):S!==null&&(S.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===Or&&Dp(H)===S.type)?(M=s(S,T.props),M.ref=vo(k,S,T),M.return=k,M):(M=El(T.type,T.key,T.props,null,k.mode,M),M.ref=vo(k,S,T),M.return=k,M)}function h(k,S,T,M){return S===null||S.tag!==4||S.stateNode.containerInfo!==T.containerInfo||S.stateNode.implementation!==T.implementation?(S=Ec(T,k.mode,M),S.return=k,S):(S=s(S,T.children||[]),S.return=k,S)}function p(k,S,T,M,H){return S===null||S.tag!==7?(S=Ds(T,k.mode,M,H),S.return=k,S):(S=s(S,T),S.return=k,S)}function y(k,S,T){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Tc(""+S,k.mode,T),S.return=k,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ga:return T=El(S.type,S.key,S.props,null,k.mode,T),T.ref=vo(k,null,S),T.return=k,T;case mi:return S=Ec(S,k.mode,T),S.return=k,S;case Or:var M=S._init;return y(k,M(S._payload),T)}if(To(S)||fo(S))return S=Ds(S,k.mode,T,null),S.return=k,S;sl(k,S)}return null}function m(k,S,T,M){var H=S!==null?S.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return H!==null?null:l(k,S,""+T,M);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Ga:return T.key===H?c(k,S,T,M):null;case mi:return T.key===H?h(k,S,T,M):null;case Or:return H=T._init,m(k,S,H(T._payload),M)}if(To(T)||fo(T))return H!==null?null:p(k,S,T,M,null);sl(k,T)}return null}function I(k,S,T,M,H){if(typeof M=="string"&&M!==""||typeof M=="number")return k=k.get(T)||null,l(S,k,""+M,H);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Ga:return k=k.get(M.key===null?T:M.key)||null,c(S,k,M,H);case mi:return k=k.get(M.key===null?T:M.key)||null,h(S,k,M,H);case Or:var F=M._init;return I(k,S,T,F(M._payload),H)}if(To(M)||fo(M))return k=k.get(T)||null,p(S,k,M,H,null);sl(S,M)}return null}function A(k,S,T,M){for(var H=null,F=null,w=S,g=S=0,_=null;w!==null&&g<T.length;g++){w.index>g?(_=w,w=null):_=w.sibling;var E=m(k,w,T[g],M);if(E===null){w===null&&(w=_);break}t&&w&&E.alternate===null&&e(k,w),S=i(E,S,g),F===null?H=E:F.sibling=E,F=E,w=_}if(g===T.length)return n(k,w),tt&&Is(k,g),H;if(w===null){for(;g<T.length;g++)w=y(k,T[g],M),w!==null&&(S=i(w,S,g),F===null?H=w:F.sibling=w,F=w);return tt&&Is(k,g),H}for(w=r(k,w);g<T.length;g++)_=I(w,k,g,T[g],M),_!==null&&(t&&_.alternate!==null&&w.delete(_.key===null?g:_.key),S=i(_,S,g),F===null?H=_:F.sibling=_,F=_);return t&&w.forEach(function(x){return e(k,x)}),tt&&Is(k,g),H}function P(k,S,T,M){var H=fo(T);if(typeof H!="function")throw Error(J(150));if(T=H.call(T),T==null)throw Error(J(151));for(var F=H=null,w=S,g=S=0,_=null,E=T.next();w!==null&&!E.done;g++,E=T.next()){w.index>g?(_=w,w=null):_=w.sibling;var x=m(k,w,E.value,M);if(x===null){w===null&&(w=_);break}t&&w&&x.alternate===null&&e(k,w),S=i(x,S,g),F===null?H=x:F.sibling=x,F=x,w=_}if(E.done)return n(k,w),tt&&Is(k,g),H;if(w===null){for(;!E.done;g++,E=T.next())E=y(k,E.value,M),E!==null&&(S=i(E,S,g),F===null?H=E:F.sibling=E,F=E);return tt&&Is(k,g),H}for(w=r(k,w);!E.done;g++,E=T.next())E=I(w,k,g,E.value,M),E!==null&&(t&&E.alternate!==null&&w.delete(E.key===null?g:E.key),S=i(E,S,g),F===null?H=E:F.sibling=E,F=E);return t&&w.forEach(function(R){return e(k,R)}),tt&&Is(k,g),H}function z(k,S,T,M){if(typeof T=="object"&&T!==null&&T.type===yi&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Ga:e:{for(var H=T.key,F=S;F!==null;){if(F.key===H){if(H=T.type,H===yi){if(F.tag===7){n(k,F.sibling),S=s(F,T.props.children),S.return=k,k=S;break e}}else if(F.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===Or&&Dp(H)===F.type){n(k,F.sibling),S=s(F,T.props),S.ref=vo(k,F,T),S.return=k,k=S;break e}n(k,F);break}else e(k,F);F=F.sibling}T.type===yi?(S=Ds(T.props.children,k.mode,M,T.key),S.return=k,k=S):(M=El(T.type,T.key,T.props,null,k.mode,M),M.ref=vo(k,S,T),M.return=k,k=M)}return a(k);case mi:e:{for(F=T.key;S!==null;){if(S.key===F)if(S.tag===4&&S.stateNode.containerInfo===T.containerInfo&&S.stateNode.implementation===T.implementation){n(k,S.sibling),S=s(S,T.children||[]),S.return=k,k=S;break e}else{n(k,S);break}else e(k,S);S=S.sibling}S=Ec(T,k.mode,M),S.return=k,k=S}return a(k);case Or:return F=T._init,z(k,S,F(T._payload),M)}if(To(T))return A(k,S,T,M);if(fo(T))return P(k,S,T,M);sl(k,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,S!==null&&S.tag===6?(n(k,S.sibling),S=s(S,T),S.return=k,k=S):(n(k,S),S=Tc(T,k.mode,M),S.return=k,k=S),a(k)):n(k,S)}return z}var Fi=xy(!0),_y=xy(!1),$l=cs(null),Wl=null,Ii=null,Eh=null;function Ih(){Eh=Ii=Wl=null}function Ch(t){var e=$l.current;Ze($l),t._currentValue=e}function hd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ji(t,e){Wl=t,Eh=Ii=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(rn=!0),t.firstContext=null)}function In(t){var e=t._currentValue;if(Eh!==t)if(t={context:t,memoizedValue:e,next:null},Ii===null){if(Wl===null)throw Error(J(308));Ii=t,Wl.dependencies={lanes:0,firstContext:t}}else Ii=Ii.next=t;return e}var Rs=null;function Ah(t){Rs===null?Rs=[t]:Rs.push(t)}function wy(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Ah(e)):(n.next=s.next,s.next=n),e.interleaved=n,wr(t,r)}function wr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var zr=!1;function kh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Sy(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function yr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Yr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Me&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,wr(t,n)}return s=r.interleaved,s===null?(e.next=e,Ah(r)):(e.next=s.next,s.next=e),r.interleaved=e,wr(t,n)}function vl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,fh(t,n)}}function Np(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Hl(t,e,n,r){var s=t.updateQueue;zr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,h=c.next;c.next=null,a===null?i=h:a.next=h,a=c;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==a&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=c))}if(i!==null){var y=s.baseState;a=0,p=h=c=null,l=i;do{var m=l.lane,I=l.eventTime;if((r&m)===m){p!==null&&(p=p.next={eventTime:I,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var A=t,P=l;switch(m=e,I=n,P.tag){case 1:if(A=P.payload,typeof A=="function"){y=A.call(I,y,m);break e}y=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=P.payload,m=typeof A=="function"?A.call(I,y,m):A,m==null)break e;y=it({},y,m);break e;case 2:zr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else I={eventTime:I,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=I,c=y):p=p.next=I,a|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(p===null&&(c=y),s.baseState=c,s.firstBaseUpdate=h,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Fs|=a,t.lanes=a,t.memoizedState=y}}function Mp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(J(191,s));s.call(r)}}}var Sa={},Zn=cs(Sa),na=cs(Sa),ra=cs(Sa);function bs(t){if(t===Sa)throw Error(J(174));return t}function Rh(t,e){switch(Ge(ra,e),Ge(na,t),Ge(Zn,Sa),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qc(e,t)}Ze(Zn),Ge(Zn,e)}function Oi(){Ze(Zn),Ze(na),Ze(ra)}function Ty(t){bs(ra.current);var e=bs(Zn.current),n=qc(e,t.type);e!==n&&(Ge(na,t),Ge(Zn,n))}function bh(t){na.current===t&&(Ze(Zn),Ze(na))}var rt=cs(0);function ql(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var yc=[];function Ph(){for(var t=0;t<yc.length;t++)yc[t]._workInProgressVersionPrimary=null;yc.length=0}var xl=Ar.ReactCurrentDispatcher,vc=Ar.ReactCurrentBatchConfig,Ls=0,st=null,_t=null,Et=null,Gl=!1,Vo=!1,sa=0,X1=0;function Ut(){throw Error(J(321))}function jh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!$n(t[n],e[n]))return!1;return!0}function Dh(t,e,n,r,s,i){if(Ls=i,st=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xl.current=t===null||t.memoizedState===null?t_:n_,t=n(r,s),Vo){i=0;do{if(Vo=!1,sa=0,25<=i)throw Error(J(301));i+=1,Et=_t=null,e.updateQueue=null,xl.current=r_,t=n(r,s)}while(Vo)}if(xl.current=Ql,e=_t!==null&&_t.next!==null,Ls=0,Et=_t=st=null,Gl=!1,e)throw Error(J(300));return t}function Nh(){var t=sa!==0;return sa=0,t}function Yn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?st.memoizedState=Et=t:Et=Et.next=t,Et}function Cn(){if(_t===null){var t=st.alternate;t=t!==null?t.memoizedState:null}else t=_t.next;var e=Et===null?st.memoizedState:Et.next;if(e!==null)Et=e,_t=t;else{if(t===null)throw Error(J(310));_t=t,t={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},Et===null?st.memoizedState=Et=t:Et=Et.next=t}return Et}function ia(t,e){return typeof e=="function"?e(t):e}function xc(t){var e=Cn(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var r=_t,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,c=null,h=i;do{var p=h.lane;if((Ls&p)===p)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var y={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(l=c=y,a=r):c=c.next=y,st.lanes|=p,Fs|=p}h=h.next}while(h!==null&&h!==i);c===null?a=r:c.next=l,$n(r,e.memoizedState)||(rn=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,st.lanes|=i,Fs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function _c(t){var e=Cn(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);$n(i,e.memoizedState)||(rn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Ey(){}function Iy(t,e){var n=st,r=Cn(),s=e(),i=!$n(r.memoizedState,s);if(i&&(r.memoizedState=s,rn=!0),r=r.queue,Mh(ky.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Et!==null&&Et.memoizedState.tag&1){if(n.flags|=2048,oa(9,Ay.bind(null,n,r,s,e),void 0,null),It===null)throw Error(J(349));Ls&30||Cy(n,e,s)}return s}function Cy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Ay(t,e,n,r){e.value=n,e.getSnapshot=r,Ry(e)&&by(t)}function ky(t,e,n){return n(function(){Ry(e)&&by(t)})}function Ry(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!$n(t,n)}catch{return!0}}function by(t){var e=wr(t,1);e!==null&&Bn(e,t,1,-1)}function Vp(t){var e=Yn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:t},e.queue=t,t=t.dispatch=e_.bind(null,st,t),[e.memoizedState,t]}function oa(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Py(){return Cn().memoizedState}function _l(t,e,n,r){var s=Yn();st.flags|=t,s.memoizedState=oa(1|e,n,void 0,r===void 0?null:r)}function xu(t,e,n,r){var s=Cn();r=r===void 0?null:r;var i=void 0;if(_t!==null){var a=_t.memoizedState;if(i=a.destroy,r!==null&&jh(r,a.deps)){s.memoizedState=oa(e,n,i,r);return}}st.flags|=t,s.memoizedState=oa(1|e,n,i,r)}function Lp(t,e){return _l(8390656,8,t,e)}function Mh(t,e){return xu(2048,8,t,e)}function jy(t,e){return xu(4,2,t,e)}function Dy(t,e){return xu(4,4,t,e)}function Ny(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function My(t,e,n){return n=n!=null?n.concat([t]):null,xu(4,4,Ny.bind(null,e,t),n)}function Vh(){}function Vy(t,e){var n=Cn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&jh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ly(t,e){var n=Cn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&jh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Fy(t,e,n){return Ls&21?($n(n,e)||(n=$m(),st.lanes|=n,Fs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,rn=!0),t.memoizedState=n)}function J1(t,e){var n=$e;$e=n!==0&&4>n?n:4,t(!0);var r=vc.transition;vc.transition={};try{t(!1),e()}finally{$e=n,vc.transition=r}}function Oy(){return Cn().memoizedState}function Z1(t,e,n){var r=Jr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},zy(t))By(e,n);else if(n=wy(t,e,n,r),n!==null){var s=Yt();Bn(n,t,r,s),Uy(n,e,r)}}function e_(t,e,n){var r=Jr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(zy(t))By(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,$n(l,a)){var c=e.interleaved;c===null?(s.next=s,Ah(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=wy(t,e,s,r),n!==null&&(s=Yt(),Bn(n,t,r,s),Uy(n,e,r))}}function zy(t){var e=t.alternate;return t===st||e!==null&&e===st}function By(t,e){Vo=Gl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Uy(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,fh(t,n)}}var Ql={readContext:In,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useInsertionEffect:Ut,useLayoutEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useMutableSource:Ut,useSyncExternalStore:Ut,useId:Ut,unstable_isNewReconciler:!1},t_={readContext:In,useCallback:function(t,e){return Yn().memoizedState=[t,e===void 0?null:e],t},useContext:In,useEffect:Lp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,_l(4194308,4,Ny.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _l(4194308,4,t,e)},useInsertionEffect:function(t,e){return _l(4,2,t,e)},useMemo:function(t,e){var n=Yn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Yn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Z1.bind(null,st,t),[r.memoizedState,t]},useRef:function(t){var e=Yn();return t={current:t},e.memoizedState=t},useState:Vp,useDebugValue:Vh,useDeferredValue:function(t){return Yn().memoizedState=t},useTransition:function(){var t=Vp(!1),e=t[0];return t=J1.bind(null,t[1]),Yn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=st,s=Yn();if(tt){if(n===void 0)throw Error(J(407));n=n()}else{if(n=e(),It===null)throw Error(J(349));Ls&30||Cy(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Lp(ky.bind(null,r,i,t),[t]),r.flags|=2048,oa(9,Ay.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Yn(),e=It.identifierPrefix;if(tt){var n=mr,r=gr;n=(r&~(1<<32-zn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=sa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=X1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},n_={readContext:In,useCallback:Vy,useContext:In,useEffect:Mh,useImperativeHandle:My,useInsertionEffect:jy,useLayoutEffect:Dy,useMemo:Ly,useReducer:xc,useRef:Py,useState:function(){return xc(ia)},useDebugValue:Vh,useDeferredValue:function(t){var e=Cn();return Fy(e,_t.memoizedState,t)},useTransition:function(){var t=xc(ia)[0],e=Cn().memoizedState;return[t,e]},useMutableSource:Ey,useSyncExternalStore:Iy,useId:Oy,unstable_isNewReconciler:!1},r_={readContext:In,useCallback:Vy,useContext:In,useEffect:Mh,useImperativeHandle:My,useInsertionEffect:jy,useLayoutEffect:Dy,useMemo:Ly,useReducer:_c,useRef:Py,useState:function(){return _c(ia)},useDebugValue:Vh,useDeferredValue:function(t){var e=Cn();return _t===null?e.memoizedState=t:Fy(e,_t.memoizedState,t)},useTransition:function(){var t=_c(ia)[0],e=Cn().memoizedState;return[t,e]},useMutableSource:Ey,useSyncExternalStore:Iy,useId:Oy,unstable_isNewReconciler:!1};function Ln(t,e){if(t&&t.defaultProps){e=it({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function fd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:it({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var _u={isMounted:function(t){return(t=t._reactInternals)?Ws(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Yt(),s=Jr(t),i=yr(r,s);i.payload=e,n!=null&&(i.callback=n),e=Yr(t,i,s),e!==null&&(Bn(e,t,s,r),vl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Yt(),s=Jr(t),i=yr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Yr(t,i,s),e!==null&&(Bn(e,t,s,r),vl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Yt(),r=Jr(t),s=yr(n,r);s.tag=2,e!=null&&(s.callback=e),e=Yr(t,s,r),e!==null&&(Bn(e,t,r,n),vl(e,t,r))}};function Fp(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!Jo(n,r)||!Jo(s,i):!0}function $y(t,e,n){var r=!1,s=is,i=e.contextType;return typeof i=="object"&&i!==null?i=In(i):(s=on(e)?Ms:Gt.current,r=e.contextTypes,i=(r=r!=null)?Vi(t,s):is),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=_u,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Op(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&_u.enqueueReplaceState(e,e.state,null)}function pd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},kh(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=In(i):(i=on(e)?Ms:Gt.current,s.context=Vi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(fd(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&_u.enqueueReplaceState(s,s.state,null),Hl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function zi(t,e){try{var n="",r=e;do n+=Px(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function wc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function gd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var s_=typeof WeakMap=="function"?WeakMap:Map;function Wy(t,e,n){n=yr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Yl||(Yl=!0,Id=r),gd(t,e)},n}function Hy(t,e,n){n=yr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){gd(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){gd(t,e),typeof r!="function"&&(Xr===null?Xr=new Set([this]):Xr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function zp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new s_;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=v_.bind(null,t,e,n),e.then(t,t))}function Bp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Up(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=yr(-1,1),e.tag=2,Yr(n,e,1))),n.lanes|=1),t)}var i_=Ar.ReactCurrentOwner,rn=!1;function Kt(t,e,n,r){e.child=t===null?_y(e,null,n,r):Fi(e,t.child,n,r)}function $p(t,e,n,r,s){n=n.render;var i=e.ref;return ji(e,s),r=Dh(t,e,n,r,i,s),n=Nh(),t!==null&&!rn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Sr(t,e,s)):(tt&&n&&wh(e),e.flags|=1,Kt(t,e,r,s),e.child)}function Wp(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Wh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,qy(t,e,i,r,s)):(t=El(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Jo,n(a,r)&&t.ref===e.ref)return Sr(t,e,s)}return e.flags|=1,t=Zr(i,r),t.ref=e.ref,t.return=e,e.child=t}function qy(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Jo(i,r)&&t.ref===e.ref)if(rn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(rn=!0);else return e.lanes=t.lanes,Sr(t,e,s)}return md(t,e,n,r,s)}function Gy(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ge(Ai,dn),dn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ge(Ai,dn),dn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ge(Ai,dn),dn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ge(Ai,dn),dn|=r;return Kt(t,e,s,n),e.child}function Qy(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function md(t,e,n,r,s){var i=on(n)?Ms:Gt.current;return i=Vi(e,i),ji(e,s),n=Dh(t,e,n,r,i,s),r=Nh(),t!==null&&!rn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Sr(t,e,s)):(tt&&r&&wh(e),e.flags|=1,Kt(t,e,n,s),e.child)}function Hp(t,e,n,r,s){if(on(n)){var i=!0;zl(e)}else i=!1;if(ji(e,s),e.stateNode===null)wl(t,e),$y(e,n,r),pd(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=In(h):(h=on(n)?Ms:Gt.current,h=Vi(e,h));var p=n.getDerivedStateFromProps,y=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";y||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==h)&&Op(e,a,r,h),zr=!1;var m=e.memoizedState;a.state=m,Hl(e,r,a,s),c=e.memoizedState,l!==r||m!==c||sn.current||zr?(typeof p=="function"&&(fd(e,n,p,r),c=e.memoizedState),(l=zr||Fp(e,n,l,r,m,c,h))?(y||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),a.props=r,a.state=c,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Sy(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:Ln(e.type,l),a.props=h,y=e.pendingProps,m=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=In(c):(c=on(n)?Ms:Gt.current,c=Vi(e,c));var I=n.getDerivedStateFromProps;(p=typeof I=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==y||m!==c)&&Op(e,a,r,c),zr=!1,m=e.memoizedState,a.state=m,Hl(e,r,a,s);var A=e.memoizedState;l!==y||m!==A||sn.current||zr?(typeof I=="function"&&(fd(e,n,I,r),A=e.memoizedState),(h=zr||Fp(e,n,h,r,m,A,c)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,A,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,A,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),a.props=r,a.state=A,a.context=c,r=h):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return yd(t,e,n,r,i,s)}function yd(t,e,n,r,s,i){Qy(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&bp(e,n,!1),Sr(t,e,i);r=e.stateNode,i_.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Fi(e,t.child,null,i),e.child=Fi(e,null,l,i)):Kt(t,e,l,i),e.memoizedState=r.state,s&&bp(e,n,!0),e.child}function Ky(t){var e=t.stateNode;e.pendingContext?Rp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Rp(t,e.context,!1),Rh(t,e.containerInfo)}function qp(t,e,n,r,s){return Li(),Th(s),e.flags|=256,Kt(t,e,n,r),e.child}var vd={dehydrated:null,treeContext:null,retryLane:0};function xd(t){return{baseLanes:t,cachePool:null,transitions:null}}function Yy(t,e,n){var r=e.pendingProps,s=rt.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ge(rt,s&1),t===null)return dd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Tu(a,r,0,null),t=Ds(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=xd(n),e.memoizedState=vd,t):Lh(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return o_(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Zr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Zr(l,i):(i=Ds(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?xd(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=vd,r}return i=t.child,t=i.sibling,r=Zr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Lh(t,e){return e=Tu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function il(t,e,n,r){return r!==null&&Th(r),Fi(e,t.child,null,n),t=Lh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function o_(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=wc(Error(J(422))),il(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Tu({mode:"visible",children:r.children},s,0,null),i=Ds(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Fi(e,t.child,null,a),e.child.memoizedState=xd(a),e.memoizedState=vd,i);if(!(e.mode&1))return il(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(J(419)),r=wc(i,r,void 0),il(t,e,a,r)}if(l=(a&t.childLanes)!==0,rn||l){if(r=It,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,wr(t,s),Bn(r,t,s,-1))}return $h(),r=wc(Error(J(421))),il(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=x_.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,hn=Kr(s.nextSibling),pn=e,tt=!0,On=null,t!==null&&(_n[wn++]=gr,_n[wn++]=mr,_n[wn++]=Vs,gr=t.id,mr=t.overflow,Vs=e),e=Lh(e,r.children),e.flags|=4096,e)}function Gp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),hd(t.return,e,n)}function Sc(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Xy(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Kt(t,e,r.children,n),r=rt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Gp(t,n,e);else if(t.tag===19)Gp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ge(rt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&ql(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Sc(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ql(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Sc(e,!0,n,null,i);break;case"together":Sc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function wl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Sr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Fs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(J(153));if(e.child!==null){for(t=e.child,n=Zr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Zr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function a_(t,e,n){switch(e.tag){case 3:Ky(e),Li();break;case 5:Ty(e);break;case 1:on(e.type)&&zl(e);break;case 4:Rh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ge($l,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ge(rt,rt.current&1),e.flags|=128,null):n&e.child.childLanes?Yy(t,e,n):(Ge(rt,rt.current&1),t=Sr(t,e,n),t!==null?t.sibling:null);Ge(rt,rt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Xy(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ge(rt,rt.current),r)break;return null;case 22:case 23:return e.lanes=0,Gy(t,e,n)}return Sr(t,e,n)}var Jy,_d,Zy,e0;Jy=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};_d=function(){};Zy=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,bs(Zn.current);var i=null;switch(n){case"input":s=Uc(t,s),r=Uc(t,r),i=[];break;case"select":s=it({},s,{value:void 0}),r=it({},r,{value:void 0}),i=[];break;case"textarea":s=Hc(t,s),r=Hc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Fl)}Gc(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Ho.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var c=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&c!==l&&(c!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(h,n)),n=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Ho.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&Ye("scroll",t),i||l===c||(i=[])):(i=i||[]).push(h,c))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};e0=function(t,e,n,r){n!==r&&(e.flags|=4)};function xo(t,e){if(!tt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function $t(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function l_(t,e,n){var r=e.pendingProps;switch(Sh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $t(e),null;case 1:return on(e.type)&&Ol(),$t(e),null;case 3:return r=e.stateNode,Oi(),Ze(sn),Ze(Gt),Ph(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(rl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,On!==null&&(kd(On),On=null))),_d(t,e),$t(e),null;case 5:bh(e);var s=bs(ra.current);if(n=e.type,t!==null&&e.stateNode!=null)Zy(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(J(166));return $t(e),null}if(t=bs(Zn.current),rl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Xn]=e,r[ta]=i,t=(e.mode&1)!==0,n){case"dialog":Ye("cancel",r),Ye("close",r);break;case"iframe":case"object":case"embed":Ye("load",r);break;case"video":case"audio":for(s=0;s<Io.length;s++)Ye(Io[s],r);break;case"source":Ye("error",r);break;case"img":case"image":case"link":Ye("error",r),Ye("load",r);break;case"details":Ye("toggle",r);break;case"input":np(r,i),Ye("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ye("invalid",r);break;case"textarea":sp(r,i),Ye("invalid",r)}Gc(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&nl(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&nl(r.textContent,l,t),s=["children",""+l]):Ho.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Ye("scroll",r)}switch(n){case"input":Qa(r),rp(r,i,!0);break;case"textarea":Qa(r),ip(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Fl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=km(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Xn]=e,t[ta]=r,Jy(t,e,!1,!1),e.stateNode=t;e:{switch(a=Qc(n,r),n){case"dialog":Ye("cancel",t),Ye("close",t),s=r;break;case"iframe":case"object":case"embed":Ye("load",t),s=r;break;case"video":case"audio":for(s=0;s<Io.length;s++)Ye(Io[s],t);s=r;break;case"source":Ye("error",t),s=r;break;case"img":case"image":case"link":Ye("error",t),Ye("load",t),s=r;break;case"details":Ye("toggle",t),s=r;break;case"input":np(t,r),s=Uc(t,r),Ye("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=it({},r,{value:void 0}),Ye("invalid",t);break;case"textarea":sp(t,r),s=Hc(t,r),Ye("invalid",t);break;default:s=r}Gc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Pm(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Rm(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&qo(t,c):typeof c=="number"&&qo(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ho.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ye("scroll",t):c!=null&&ah(t,i,c,a))}switch(n){case"input":Qa(t),rp(t,r,!1);break;case"textarea":Qa(t),ip(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ss(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ki(t,!!r.multiple,i,!1):r.defaultValue!=null&&ki(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Fl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return $t(e),null;case 6:if(t&&e.stateNode!=null)e0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(J(166));if(n=bs(ra.current),bs(Zn.current),rl(e)){if(r=e.stateNode,n=e.memoizedProps,r[Xn]=e,(i=r.nodeValue!==n)&&(t=pn,t!==null))switch(t.tag){case 3:nl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&nl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Xn]=e,e.stateNode=r}return $t(e),null;case 13:if(Ze(rt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(tt&&hn!==null&&e.mode&1&&!(e.flags&128))vy(),Li(),e.flags|=98560,i=!1;else if(i=rl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(J(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(J(317));i[Xn]=e}else Li(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;$t(e),i=!1}else On!==null&&(kd(On),On=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||rt.current&1?wt===0&&(wt=3):$h())),e.updateQueue!==null&&(e.flags|=4),$t(e),null);case 4:return Oi(),_d(t,e),t===null&&Zo(e.stateNode.containerInfo),$t(e),null;case 10:return Ch(e.type._context),$t(e),null;case 17:return on(e.type)&&Ol(),$t(e),null;case 19:if(Ze(rt),i=e.memoizedState,i===null)return $t(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)xo(i,!1);else{if(wt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=ql(t),a!==null){for(e.flags|=128,xo(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ge(rt,rt.current&1|2),e.child}t=t.sibling}i.tail!==null&&ht()>Bi&&(e.flags|=128,r=!0,xo(i,!1),e.lanes=4194304)}else{if(!r)if(t=ql(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),xo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!tt)return $t(e),null}else 2*ht()-i.renderingStartTime>Bi&&n!==1073741824&&(e.flags|=128,r=!0,xo(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ht(),e.sibling=null,n=rt.current,Ge(rt,r?n&1|2:n&1),e):($t(e),null);case 22:case 23:return Uh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?dn&1073741824&&($t(e),e.subtreeFlags&6&&(e.flags|=8192)):$t(e),null;case 24:return null;case 25:return null}throw Error(J(156,e.tag))}function u_(t,e){switch(Sh(e),e.tag){case 1:return on(e.type)&&Ol(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Oi(),Ze(sn),Ze(Gt),Ph(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return bh(e),null;case 13:if(Ze(rt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(J(340));Li()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ze(rt),null;case 4:return Oi(),null;case 10:return Ch(e.type._context),null;case 22:case 23:return Uh(),null;case 24:return null;default:return null}}var ol=!1,Ht=!1,c_=typeof WeakSet=="function"?WeakSet:Set,ae=null;function Ci(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ct(t,e,r)}else n.current=null}function wd(t,e,n){try{n()}catch(r){ct(t,e,r)}}var Qp=!1;function d_(t,e){if(sd=Ml,t=iy(),_h(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,h=0,p=0,y=t,m=null;t:for(;;){for(var I;y!==n||s!==0&&y.nodeType!==3||(l=a+s),y!==i||r!==0&&y.nodeType!==3||(c=a+r),y.nodeType===3&&(a+=y.nodeValue.length),(I=y.firstChild)!==null;)m=y,y=I;for(;;){if(y===t)break t;if(m===n&&++h===s&&(l=a),m===i&&++p===r&&(c=a),(I=y.nextSibling)!==null)break;y=m,m=y.parentNode}y=I}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(id={focusedElem:t,selectionRange:n},Ml=!1,ae=e;ae!==null;)if(e=ae,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ae=t;else for(;ae!==null;){e=ae;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var P=A.memoizedProps,z=A.memoizedState,k=e.stateNode,S=k.getSnapshotBeforeUpdate(e.elementType===e.type?P:Ln(e.type,P),z);k.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(M){ct(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,ae=t;break}ae=e.return}return A=Qp,Qp=!1,A}function Lo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&wd(e,n,i)}s=s.next}while(s!==r)}}function wu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Sd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function t0(t){var e=t.alternate;e!==null&&(t.alternate=null,t0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Xn],delete e[ta],delete e[ld],delete e[G1],delete e[Q1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function n0(t){return t.tag===5||t.tag===3||t.tag===4}function Kp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||n0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Td(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Fl));else if(r!==4&&(t=t.child,t!==null))for(Td(t,e,n),t=t.sibling;t!==null;)Td(t,e,n),t=t.sibling}function Ed(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Ed(t,e,n),t=t.sibling;t!==null;)Ed(t,e,n),t=t.sibling}var Pt=null,Fn=!1;function Fr(t,e,n){for(n=n.child;n!==null;)r0(t,e,n),n=n.sibling}function r0(t,e,n){if(Jn&&typeof Jn.onCommitFiberUnmount=="function")try{Jn.onCommitFiberUnmount(fu,n)}catch{}switch(n.tag){case 5:Ht||Ci(n,e);case 6:var r=Pt,s=Fn;Pt=null,Fr(t,e,n),Pt=r,Fn=s,Pt!==null&&(Fn?(t=Pt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Pt.removeChild(n.stateNode));break;case 18:Pt!==null&&(Fn?(t=Pt,n=n.stateNode,t.nodeType===8?gc(t.parentNode,n):t.nodeType===1&&gc(t,n),Yo(t)):gc(Pt,n.stateNode));break;case 4:r=Pt,s=Fn,Pt=n.stateNode.containerInfo,Fn=!0,Fr(t,e,n),Pt=r,Fn=s;break;case 0:case 11:case 14:case 15:if(!Ht&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&wd(n,e,a),s=s.next}while(s!==r)}Fr(t,e,n);break;case 1:if(!Ht&&(Ci(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ct(n,e,l)}Fr(t,e,n);break;case 21:Fr(t,e,n);break;case 22:n.mode&1?(Ht=(r=Ht)||n.memoizedState!==null,Fr(t,e,n),Ht=r):Fr(t,e,n);break;default:Fr(t,e,n)}}function Yp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new c_),e.forEach(function(r){var s=__.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Vn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:Pt=l.stateNode,Fn=!1;break e;case 3:Pt=l.stateNode.containerInfo,Fn=!0;break e;case 4:Pt=l.stateNode.containerInfo,Fn=!0;break e}l=l.return}if(Pt===null)throw Error(J(160));r0(i,a,s),Pt=null,Fn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(h){ct(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)s0(e,t),e=e.sibling}function s0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vn(e,t),Kn(t),r&4){try{Lo(3,t,t.return),wu(3,t)}catch(P){ct(t,t.return,P)}try{Lo(5,t,t.return)}catch(P){ct(t,t.return,P)}}break;case 1:Vn(e,t),Kn(t),r&512&&n!==null&&Ci(n,n.return);break;case 5:if(Vn(e,t),Kn(t),r&512&&n!==null&&Ci(n,n.return),t.flags&32){var s=t.stateNode;try{qo(s,"")}catch(P){ct(t,t.return,P)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Cm(s,i),Qc(l,a);var h=Qc(l,i);for(a=0;a<c.length;a+=2){var p=c[a],y=c[a+1];p==="style"?Pm(s,y):p==="dangerouslySetInnerHTML"?Rm(s,y):p==="children"?qo(s,y):ah(s,p,y,h)}switch(l){case"input":$c(s,i);break;case"textarea":Am(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var I=i.value;I!=null?ki(s,!!i.multiple,I,!1):m!==!!i.multiple&&(i.defaultValue!=null?ki(s,!!i.multiple,i.defaultValue,!0):ki(s,!!i.multiple,i.multiple?[]:"",!1))}s[ta]=i}catch(P){ct(t,t.return,P)}}break;case 6:if(Vn(e,t),Kn(t),r&4){if(t.stateNode===null)throw Error(J(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){ct(t,t.return,P)}}break;case 3:if(Vn(e,t),Kn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Yo(e.containerInfo)}catch(P){ct(t,t.return,P)}break;case 4:Vn(e,t),Kn(t);break;case 13:Vn(e,t),Kn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(zh=ht())),r&4&&Yp(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(Ht=(h=Ht)||p,Vn(e,t),Ht=h):Vn(e,t),Kn(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(ae=t,p=t.child;p!==null;){for(y=ae=p;ae!==null;){switch(m=ae,I=m.child,m.tag){case 0:case 11:case 14:case 15:Lo(4,m,m.return);break;case 1:Ci(m,m.return);var A=m.stateNode;if(typeof A.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(P){ct(r,n,P)}}break;case 5:Ci(m,m.return);break;case 22:if(m.memoizedState!==null){Jp(y);continue}}I!==null?(I.return=m,ae=I):Jp(y)}p=p.sibling}e:for(p=null,y=t;;){if(y.tag===5){if(p===null){p=y;try{s=y.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=y.stateNode,c=y.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=bm("display",a))}catch(P){ct(t,t.return,P)}}}else if(y.tag===6){if(p===null)try{y.stateNode.nodeValue=h?"":y.memoizedProps}catch(P){ct(t,t.return,P)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===t)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;p===y&&(p=null),y=y.return}p===y&&(p=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:Vn(e,t),Kn(t),r&4&&Yp(t);break;case 21:break;default:Vn(e,t),Kn(t)}}function Kn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(n0(n)){var r=n;break e}n=n.return}throw Error(J(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(qo(s,""),r.flags&=-33);var i=Kp(t);Ed(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Kp(t);Td(t,l,a);break;default:throw Error(J(161))}}catch(c){ct(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function h_(t,e,n){ae=t,i0(t)}function i0(t,e,n){for(var r=(t.mode&1)!==0;ae!==null;){var s=ae,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||ol;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Ht;l=ol;var h=Ht;if(ol=a,(Ht=c)&&!h)for(ae=s;ae!==null;)a=ae,c=a.child,a.tag===22&&a.memoizedState!==null?Zp(s):c!==null?(c.return=a,ae=c):Zp(s);for(;i!==null;)ae=i,i0(i),i=i.sibling;ae=s,ol=l,Ht=h}Xp(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ae=i):Xp(t)}}function Xp(t){for(;ae!==null;){var e=ae;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ht||wu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ht)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Ln(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Mp(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Mp(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var y=p.dehydrated;y!==null&&Yo(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}Ht||e.flags&512&&Sd(e)}catch(m){ct(e,e.return,m)}}if(e===t){ae=null;break}if(n=e.sibling,n!==null){n.return=e.return,ae=n;break}ae=e.return}}function Jp(t){for(;ae!==null;){var e=ae;if(e===t){ae=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ae=n;break}ae=e.return}}function Zp(t){for(;ae!==null;){var e=ae;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{wu(4,e)}catch(c){ct(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){ct(e,s,c)}}var i=e.return;try{Sd(e)}catch(c){ct(e,i,c)}break;case 5:var a=e.return;try{Sd(e)}catch(c){ct(e,a,c)}}}catch(c){ct(e,e.return,c)}if(e===t){ae=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ae=l;break}ae=e.return}}var f_=Math.ceil,Kl=Ar.ReactCurrentDispatcher,Fh=Ar.ReactCurrentOwner,En=Ar.ReactCurrentBatchConfig,Me=0,It=null,yt=null,Mt=0,dn=0,Ai=cs(0),wt=0,aa=null,Fs=0,Su=0,Oh=0,Fo=null,tn=null,zh=0,Bi=1/0,dr=null,Yl=!1,Id=null,Xr=null,al=!1,Wr=null,Xl=0,Oo=0,Cd=null,Sl=-1,Tl=0;function Yt(){return Me&6?ht():Sl!==-1?Sl:Sl=ht()}function Jr(t){return t.mode&1?Me&2&&Mt!==0?Mt&-Mt:Y1.transition!==null?(Tl===0&&(Tl=$m()),Tl):(t=$e,t!==0||(t=window.event,t=t===void 0?16:Ym(t.type)),t):1}function Bn(t,e,n,r){if(50<Oo)throw Oo=0,Cd=null,Error(J(185));xa(t,n,r),(!(Me&2)||t!==It)&&(t===It&&(!(Me&2)&&(Su|=n),wt===4&&Ur(t,Mt)),an(t,r),n===1&&Me===0&&!(e.mode&1)&&(Bi=ht()+500,vu&&ds()))}function an(t,e){var n=t.callbackNode;Yx(t,e);var r=Nl(t,t===It?Mt:0);if(r===0)n!==null&&lp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&lp(n),e===1)t.tag===0?K1(eg.bind(null,t)):gy(eg.bind(null,t)),H1(function(){!(Me&6)&&ds()}),n=null;else{switch(Wm(r)){case 1:n=hh;break;case 4:n=Bm;break;case 16:n=Dl;break;case 536870912:n=Um;break;default:n=Dl}n=f0(n,o0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function o0(t,e){if(Sl=-1,Tl=0,Me&6)throw Error(J(327));var n=t.callbackNode;if(Di()&&t.callbackNode!==n)return null;var r=Nl(t,t===It?Mt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Jl(t,r);else{e=r;var s=Me;Me|=2;var i=l0();(It!==t||Mt!==e)&&(dr=null,Bi=ht()+500,js(t,e));do try{m_();break}catch(l){a0(t,l)}while(!0);Ih(),Kl.current=i,Me=s,yt!==null?e=0:(It=null,Mt=0,e=wt)}if(e!==0){if(e===2&&(s=Zc(t),s!==0&&(r=s,e=Ad(t,s))),e===1)throw n=aa,js(t,0),Ur(t,r),an(t,ht()),n;if(e===6)Ur(t,r);else{if(s=t.current.alternate,!(r&30)&&!p_(s)&&(e=Jl(t,r),e===2&&(i=Zc(t),i!==0&&(r=i,e=Ad(t,i))),e===1))throw n=aa,js(t,0),Ur(t,r),an(t,ht()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(J(345));case 2:Cs(t,tn,dr);break;case 3:if(Ur(t,r),(r&130023424)===r&&(e=zh+500-ht(),10<e)){if(Nl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Yt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ad(Cs.bind(null,t,tn,dr),e);break}Cs(t,tn,dr);break;case 4:if(Ur(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-zn(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=ht()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*f_(r/1960))-r,10<r){t.timeoutHandle=ad(Cs.bind(null,t,tn,dr),r);break}Cs(t,tn,dr);break;case 5:Cs(t,tn,dr);break;default:throw Error(J(329))}}}return an(t,ht()),t.callbackNode===n?o0.bind(null,t):null}function Ad(t,e){var n=Fo;return t.current.memoizedState.isDehydrated&&(js(t,e).flags|=256),t=Jl(t,e),t!==2&&(e=tn,tn=n,e!==null&&kd(e)),t}function kd(t){tn===null?tn=t:tn.push.apply(tn,t)}function p_(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!$n(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ur(t,e){for(e&=~Oh,e&=~Su,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-zn(e),r=1<<n;t[n]=-1,e&=~r}}function eg(t){if(Me&6)throw Error(J(327));Di();var e=Nl(t,0);if(!(e&1))return an(t,ht()),null;var n=Jl(t,e);if(t.tag!==0&&n===2){var r=Zc(t);r!==0&&(e=r,n=Ad(t,r))}if(n===1)throw n=aa,js(t,0),Ur(t,e),an(t,ht()),n;if(n===6)throw Error(J(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Cs(t,tn,dr),an(t,ht()),null}function Bh(t,e){var n=Me;Me|=1;try{return t(e)}finally{Me=n,Me===0&&(Bi=ht()+500,vu&&ds())}}function Os(t){Wr!==null&&Wr.tag===0&&!(Me&6)&&Di();var e=Me;Me|=1;var n=En.transition,r=$e;try{if(En.transition=null,$e=1,t)return t()}finally{$e=r,En.transition=n,Me=e,!(Me&6)&&ds()}}function Uh(){dn=Ai.current,Ze(Ai)}function js(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,W1(n)),yt!==null)for(n=yt.return;n!==null;){var r=n;switch(Sh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ol();break;case 3:Oi(),Ze(sn),Ze(Gt),Ph();break;case 5:bh(r);break;case 4:Oi();break;case 13:Ze(rt);break;case 19:Ze(rt);break;case 10:Ch(r.type._context);break;case 22:case 23:Uh()}n=n.return}if(It=t,yt=t=Zr(t.current,null),Mt=dn=e,wt=0,aa=null,Oh=Su=Fs=0,tn=Fo=null,Rs!==null){for(e=0;e<Rs.length;e++)if(n=Rs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}Rs=null}return t}function a0(t,e){do{var n=yt;try{if(Ih(),xl.current=Ql,Gl){for(var r=st.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Gl=!1}if(Ls=0,Et=_t=st=null,Vo=!1,sa=0,Fh.current=null,n===null||n.return===null){wt=1,aa=e,yt=null;break}e:{var i=t,a=n.return,l=n,c=e;if(e=Mt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,p=l,y=p.tag;if(!(p.mode&1)&&(y===0||y===11||y===15)){var m=p.alternate;m?(p.updateQueue=m.updateQueue,p.memoizedState=m.memoizedState,p.lanes=m.lanes):(p.updateQueue=null,p.memoizedState=null)}var I=Bp(a);if(I!==null){I.flags&=-257,Up(I,a,l,i,e),I.mode&1&&zp(i,h,e),e=I,c=h;var A=e.updateQueue;if(A===null){var P=new Set;P.add(c),e.updateQueue=P}else A.add(c);break e}else{if(!(e&1)){zp(i,h,e),$h();break e}c=Error(J(426))}}else if(tt&&l.mode&1){var z=Bp(a);if(z!==null){!(z.flags&65536)&&(z.flags|=256),Up(z,a,l,i,e),Th(zi(c,l));break e}}i=c=zi(c,l),wt!==4&&(wt=2),Fo===null?Fo=[i]:Fo.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var k=Wy(i,c,e);Np(i,k);break e;case 1:l=c;var S=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof S.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Xr===null||!Xr.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var M=Hy(i,l,e);Np(i,M);break e}}i=i.return}while(i!==null)}c0(n)}catch(H){e=H,yt===n&&n!==null&&(yt=n=n.return);continue}break}while(!0)}function l0(){var t=Kl.current;return Kl.current=Ql,t===null?Ql:t}function $h(){(wt===0||wt===3||wt===2)&&(wt=4),It===null||!(Fs&268435455)&&!(Su&268435455)||Ur(It,Mt)}function Jl(t,e){var n=Me;Me|=2;var r=l0();(It!==t||Mt!==e)&&(dr=null,js(t,e));do try{g_();break}catch(s){a0(t,s)}while(!0);if(Ih(),Me=n,Kl.current=r,yt!==null)throw Error(J(261));return It=null,Mt=0,wt}function g_(){for(;yt!==null;)u0(yt)}function m_(){for(;yt!==null&&!Bx();)u0(yt)}function u0(t){var e=h0(t.alternate,t,dn);t.memoizedProps=t.pendingProps,e===null?c0(t):yt=e,Fh.current=null}function c0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=u_(n,e),n!==null){n.flags&=32767,yt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wt=6,yt=null;return}}else if(n=l_(n,e,dn),n!==null){yt=n;return}if(e=e.sibling,e!==null){yt=e;return}yt=e=t}while(e!==null);wt===0&&(wt=5)}function Cs(t,e,n){var r=$e,s=En.transition;try{En.transition=null,$e=1,y_(t,e,n,r)}finally{En.transition=s,$e=r}return null}function y_(t,e,n,r){do Di();while(Wr!==null);if(Me&6)throw Error(J(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(J(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Xx(t,i),t===It&&(yt=It=null,Mt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||al||(al=!0,f0(Dl,function(){return Di(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=En.transition,En.transition=null;var a=$e;$e=1;var l=Me;Me|=4,Fh.current=null,d_(t,n),s0(n,t),L1(id),Ml=!!sd,id=sd=null,t.current=n,h_(n),Ux(),Me=l,$e=a,En.transition=i}else t.current=n;if(al&&(al=!1,Wr=t,Xl=s),i=t.pendingLanes,i===0&&(Xr=null),Hx(n.stateNode),an(t,ht()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Yl)throw Yl=!1,t=Id,Id=null,t;return Xl&1&&t.tag!==0&&Di(),i=t.pendingLanes,i&1?t===Cd?Oo++:(Oo=0,Cd=t):Oo=0,ds(),null}function Di(){if(Wr!==null){var t=Wm(Xl),e=En.transition,n=$e;try{if(En.transition=null,$e=16>t?16:t,Wr===null)var r=!1;else{if(t=Wr,Wr=null,Xl=0,Me&6)throw Error(J(331));var s=Me;for(Me|=4,ae=t.current;ae!==null;){var i=ae,a=i.child;if(ae.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var h=l[c];for(ae=h;ae!==null;){var p=ae;switch(p.tag){case 0:case 11:case 15:Lo(8,p,i)}var y=p.child;if(y!==null)y.return=p,ae=y;else for(;ae!==null;){p=ae;var m=p.sibling,I=p.return;if(t0(p),p===h){ae=null;break}if(m!==null){m.return=I,ae=m;break}ae=I}}}var A=i.alternate;if(A!==null){var P=A.child;if(P!==null){A.child=null;do{var z=P.sibling;P.sibling=null,P=z}while(P!==null)}}ae=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ae=a;else e:for(;ae!==null;){if(i=ae,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Lo(9,i,i.return)}var k=i.sibling;if(k!==null){k.return=i.return,ae=k;break e}ae=i.return}}var S=t.current;for(ae=S;ae!==null;){a=ae;var T=a.child;if(a.subtreeFlags&2064&&T!==null)T.return=a,ae=T;else e:for(a=S;ae!==null;){if(l=ae,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:wu(9,l)}}catch(H){ct(l,l.return,H)}if(l===a){ae=null;break e}var M=l.sibling;if(M!==null){M.return=l.return,ae=M;break e}ae=l.return}}if(Me=s,ds(),Jn&&typeof Jn.onPostCommitFiberRoot=="function")try{Jn.onPostCommitFiberRoot(fu,t)}catch{}r=!0}return r}finally{$e=n,En.transition=e}}return!1}function tg(t,e,n){e=zi(n,e),e=Wy(t,e,1),t=Yr(t,e,1),e=Yt(),t!==null&&(xa(t,1,e),an(t,e))}function ct(t,e,n){if(t.tag===3)tg(t,t,n);else for(;e!==null;){if(e.tag===3){tg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Xr===null||!Xr.has(r))){t=zi(n,t),t=Hy(e,t,1),e=Yr(e,t,1),t=Yt(),e!==null&&(xa(e,1,t),an(e,t));break}}e=e.return}}function v_(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Yt(),t.pingedLanes|=t.suspendedLanes&n,It===t&&(Mt&n)===n&&(wt===4||wt===3&&(Mt&130023424)===Mt&&500>ht()-zh?js(t,0):Oh|=n),an(t,e)}function d0(t,e){e===0&&(t.mode&1?(e=Xa,Xa<<=1,!(Xa&130023424)&&(Xa=4194304)):e=1);var n=Yt();t=wr(t,e),t!==null&&(xa(t,e,n),an(t,n))}function x_(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),d0(t,n)}function __(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(J(314))}r!==null&&r.delete(e),d0(t,n)}var h0;h0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||sn.current)rn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return rn=!1,a_(t,e,n);rn=!!(t.flags&131072)}else rn=!1,tt&&e.flags&1048576&&my(e,Ul,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;wl(t,e),t=e.pendingProps;var s=Vi(e,Gt.current);ji(e,n),s=Dh(null,e,r,t,s,n);var i=Nh();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,on(r)?(i=!0,zl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,kh(e),s.updater=_u,e.stateNode=s,s._reactInternals=e,pd(e,r,t,n),e=yd(null,e,r,!0,i,n)):(e.tag=0,tt&&i&&wh(e),Kt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(wl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=S_(r),t=Ln(r,t),s){case 0:e=md(null,e,r,t,n);break e;case 1:e=Hp(null,e,r,t,n);break e;case 11:e=$p(null,e,r,t,n);break e;case 14:e=Wp(null,e,r,Ln(r.type,t),n);break e}throw Error(J(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ln(r,s),md(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ln(r,s),Hp(t,e,r,s,n);case 3:e:{if(Ky(e),t===null)throw Error(J(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Sy(t,e),Hl(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=zi(Error(J(423)),e),e=qp(t,e,r,n,s);break e}else if(r!==s){s=zi(Error(J(424)),e),e=qp(t,e,r,n,s);break e}else for(hn=Kr(e.stateNode.containerInfo.firstChild),pn=e,tt=!0,On=null,n=_y(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Li(),r===s){e=Sr(t,e,n);break e}Kt(t,e,r,n)}e=e.child}return e;case 5:return Ty(e),t===null&&dd(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,od(r,s)?a=null:i!==null&&od(r,i)&&(e.flags|=32),Qy(t,e),Kt(t,e,a,n),e.child;case 6:return t===null&&dd(e),null;case 13:return Yy(t,e,n);case 4:return Rh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Fi(e,null,r,n):Kt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ln(r,s),$p(t,e,r,s,n);case 7:return Kt(t,e,e.pendingProps,n),e.child;case 8:return Kt(t,e,e.pendingProps.children,n),e.child;case 12:return Kt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Ge($l,r._currentValue),r._currentValue=a,i!==null)if($n(i.value,a)){if(i.children===s.children&&!sn.current){e=Sr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=yr(-1,n&-n),c.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?c.next=c:(c.next=p.next,p.next=c),h.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),hd(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(J(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),hd(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Kt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ji(e,n),s=In(s),r=r(s),e.flags|=1,Kt(t,e,r,n),e.child;case 14:return r=e.type,s=Ln(r,e.pendingProps),s=Ln(r.type,s),Wp(t,e,r,s,n);case 15:return qy(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ln(r,s),wl(t,e),e.tag=1,on(r)?(t=!0,zl(e)):t=!1,ji(e,n),$y(e,r,s),pd(e,r,s,n),yd(null,e,r,!0,t,n);case 19:return Xy(t,e,n);case 22:return Gy(t,e,n)}throw Error(J(156,e.tag))};function f0(t,e){return zm(t,e)}function w_(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sn(t,e,n,r){return new w_(t,e,n,r)}function Wh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function S_(t){if(typeof t=="function")return Wh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===uh)return 11;if(t===ch)return 14}return 2}function Zr(t,e){var n=t.alternate;return n===null?(n=Sn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function El(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")Wh(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case yi:return Ds(n.children,s,i,e);case lh:a=8,s|=8;break;case Fc:return t=Sn(12,n,e,s|2),t.elementType=Fc,t.lanes=i,t;case Oc:return t=Sn(13,n,e,s),t.elementType=Oc,t.lanes=i,t;case zc:return t=Sn(19,n,e,s),t.elementType=zc,t.lanes=i,t;case Tm:return Tu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case wm:a=10;break e;case Sm:a=9;break e;case uh:a=11;break e;case ch:a=14;break e;case Or:a=16,r=null;break e}throw Error(J(130,t==null?t:typeof t,""))}return e=Sn(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Ds(t,e,n,r){return t=Sn(7,t,r,e),t.lanes=n,t}function Tu(t,e,n,r){return t=Sn(22,t,r,e),t.elementType=Tm,t.lanes=n,t.stateNode={isHidden:!1},t}function Tc(t,e,n){return t=Sn(6,t,null,e),t.lanes=n,t}function Ec(t,e,n){return e=Sn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function T_(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=sc(0),this.expirationTimes=sc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Hh(t,e,n,r,s,i,a,l,c){return t=new T_(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Sn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(i),t}function E_(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function p0(t){if(!t)return is;t=t._reactInternals;e:{if(Ws(t)!==t||t.tag!==1)throw Error(J(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(on(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(J(171))}if(t.tag===1){var n=t.type;if(on(n))return py(t,n,e)}return e}function g0(t,e,n,r,s,i,a,l,c){return t=Hh(n,r,!0,t,s,i,a,l,c),t.context=p0(null),n=t.current,r=Yt(),s=Jr(n),i=yr(r,s),i.callback=e??null,Yr(n,i,s),t.current.lanes=s,xa(t,s,r),an(t,r),t}function Eu(t,e,n,r){var s=e.current,i=Yt(),a=Jr(s);return n=p0(n),e.context===null?e.context=n:e.pendingContext=n,e=yr(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Yr(s,e,a),t!==null&&(Bn(t,s,a,i),vl(t,s,a)),a}function Zl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ng(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function qh(t,e){ng(t,e),(t=t.alternate)&&ng(t,e)}function I_(){return null}var m0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Gh(t){this._internalRoot=t}Iu.prototype.render=Gh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(J(409));Eu(t,e,null,null)};Iu.prototype.unmount=Gh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Os(function(){Eu(null,t,null,null)}),e[_r]=null}};function Iu(t){this._internalRoot=t}Iu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Gm();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Br.length&&e!==0&&e<Br[n].priority;n++);Br.splice(n,0,t),n===0&&Km(t)}};function Qh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Cu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function rg(){}function C_(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=Zl(a);i.call(h)}}var a=g0(e,r,t,0,null,!1,!1,"",rg);return t._reactRootContainer=a,t[_r]=a.current,Zo(t.nodeType===8?t.parentNode:t),Os(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=Zl(c);l.call(h)}}var c=Hh(t,0,!1,null,null,!1,!1,"",rg);return t._reactRootContainer=c,t[_r]=c.current,Zo(t.nodeType===8?t.parentNode:t),Os(function(){Eu(e,c,n,r)}),c}function Au(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=Zl(a);l.call(c)}}Eu(e,a,t,s)}else a=C_(n,e,t,s,r);return Zl(a)}Hm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Eo(e.pendingLanes);n!==0&&(fh(e,n|1),an(e,ht()),!(Me&6)&&(Bi=ht()+500,ds()))}break;case 13:Os(function(){var r=wr(t,1);if(r!==null){var s=Yt();Bn(r,t,1,s)}}),qh(t,1)}};ph=function(t){if(t.tag===13){var e=wr(t,134217728);if(e!==null){var n=Yt();Bn(e,t,134217728,n)}qh(t,134217728)}};qm=function(t){if(t.tag===13){var e=Jr(t),n=wr(t,e);if(n!==null){var r=Yt();Bn(n,t,e,r)}qh(t,e)}};Gm=function(){return $e};Qm=function(t,e){var n=$e;try{return $e=t,e()}finally{$e=n}};Yc=function(t,e,n){switch(e){case"input":if($c(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=yu(r);if(!s)throw Error(J(90));Im(r),$c(r,s)}}}break;case"textarea":Am(t,n);break;case"select":e=n.value,e!=null&&ki(t,!!n.multiple,e,!1)}};Nm=Bh;Mm=Os;var A_={usingClientEntryPoint:!1,Events:[wa,wi,yu,jm,Dm,Bh]},_o={findFiberByHostInstance:ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},k_={bundleType:_o.bundleType,version:_o.version,rendererPackageName:_o.rendererPackageName,rendererConfig:_o.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ar.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fm(t),t===null?null:t.stateNode},findFiberByHostInstance:_o.findFiberByHostInstance||I_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ll=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ll.isDisabled&&ll.supportsFiber)try{fu=ll.inject(k_),Jn=ll}catch{}}mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A_;mn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qh(e))throw Error(J(200));return E_(t,e,null,n)};mn.createRoot=function(t,e){if(!Qh(t))throw Error(J(299));var n=!1,r="",s=m0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Hh(t,1,!1,null,null,n,!1,r,s),t[_r]=e.current,Zo(t.nodeType===8?t.parentNode:t),new Gh(e)};mn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(J(188)):(t=Object.keys(t).join(","),Error(J(268,t)));return t=Fm(e),t=t===null?null:t.stateNode,t};mn.flushSync=function(t){return Os(t)};mn.hydrate=function(t,e,n){if(!Cu(e))throw Error(J(200));return Au(null,t,e,!0,n)};mn.hydrateRoot=function(t,e,n){if(!Qh(t))throw Error(J(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=m0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=g0(e,null,t,1,n??null,s,!1,i,a),t[_r]=e.current,Zo(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Iu(e)};mn.render=function(t,e,n){if(!Cu(e))throw Error(J(200));return Au(null,t,e,!1,n)};mn.unmountComponentAtNode=function(t){if(!Cu(t))throw Error(J(40));return t._reactRootContainer?(Os(function(){Au(null,null,t,!1,function(){t._reactRootContainer=null,t[_r]=null})}),!0):!1};mn.unstable_batchedUpdates=Bh;mn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Cu(n))throw Error(J(200));if(t==null||t._reactInternals===void 0)throw Error(J(38));return Au(t,e,n,!1,r)};mn.version="18.3.1-next-f1338f8080-20240426";function y0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(y0)}catch(t){console.error(t)}}y0(),ym.exports=mn;var R_=ym.exports,v0,sg=R_;v0=sg.createRoot,sg.hydrateRoot;var ig={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},b_=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},_0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,c=s+2<t.length,h=c?t[s+2]:0,p=i>>2,y=(i&3)<<4|l>>4;let m=(l&15)<<2|h>>6,I=h&63;c||(I=64,a||(m=64)),r.push(n[p],n[y],n[m],n[I])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(x0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):b_(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const y=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||h==null||y==null)throw new P_;const m=i<<2|l>>4;if(r.push(m),h!==64){const I=l<<4&240|h>>2;if(r.push(I),y!==64){const A=h<<6&192|y;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class P_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const j_=function(t){const e=x0(t);return _0.encodeByteArray(e,!0)},w0=function(t){return j_(t).replace(/\./g,"")},D_=function(t){try{return _0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M_=()=>N_().__FIREBASE_DEFAULTS__,V_=()=>{if(typeof process>"u"||typeof ig>"u")return;const t=ig.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},L_=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&D_(t[1]);return e&&JSON.parse(e)},Kh=()=>{try{return M_()||V_()||L_()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},F_=t=>{var e,n;return(n=(e=Kh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},O_=t=>{const e=F_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},S0=()=>{var t;return(t=Kh())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B_(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function U_(){var t;const e=(t=Kh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $_(){return!U_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function W_(){try{return typeof indexedDB=="object"}catch{return!1}}function H_(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_="FirebaseError";class Ji extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=q_,Object.setPrototypeOf(this,Ji.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,T0.prototype.create)}}class T0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?G_(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new Ji(s,l,r)}}function G_(t,e){return t.replace(Q_,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Q_=/\{\$([^}]+)}/g;function eu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(og(i)&&og(a)){if(!eu(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function og(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wn(t){return t&&t._delegate?t._delegate:t}class Ui{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const As="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new z_;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(X_(e))try{this.getOrInitializeService({instanceIdentifier:As})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=As){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=As){return this.instances.has(e)}getOptions(e=As){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Y_(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=As){return this.component?this.component.multipleInstances?e:As:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Y_(t){return t===As?void 0:t}function X_(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new K_(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ne;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ne||(Ne={}));const Z_={debug:Ne.DEBUG,verbose:Ne.VERBOSE,info:Ne.INFO,warn:Ne.WARN,error:Ne.ERROR,silent:Ne.SILENT},ew=Ne.INFO,tw={[Ne.DEBUG]:"log",[Ne.VERBOSE]:"log",[Ne.INFO]:"info",[Ne.WARN]:"warn",[Ne.ERROR]:"error"},nw=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=tw[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class E0{constructor(e){this.name=e,this._logLevel=ew,this._logHandler=nw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ne))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Z_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ne.DEBUG,...e),this._logHandler(this,Ne.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ne.VERBOSE,...e),this._logHandler(this,Ne.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ne.INFO,...e),this._logHandler(this,Ne.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ne.WARN,...e),this._logHandler(this,Ne.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ne.ERROR,...e),this._logHandler(this,Ne.ERROR,...e)}}const rw=(t,e)=>e.some(n=>t instanceof n);let ag,lg;function sw(){return ag||(ag=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function iw(){return lg||(lg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const I0=new WeakMap,Rd=new WeakMap,C0=new WeakMap,Ic=new WeakMap,Yh=new WeakMap;function ow(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(es(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&I0.set(n,t)}).catch(()=>{}),Yh.set(e,t),e}function aw(t){if(Rd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});Rd.set(t,e)}let bd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Rd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||C0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return es(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function lw(t){bd=t(bd)}function uw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Cc(this),e,...n);return C0.set(r,e.sort?e.sort():[e]),es(r)}:iw().includes(t)?function(...e){return t.apply(Cc(this),e),es(I0.get(this))}:function(...e){return es(t.apply(Cc(this),e))}}function cw(t){return typeof t=="function"?uw(t):(t instanceof IDBTransaction&&aw(t),rw(t,sw())?new Proxy(t,bd):t)}function es(t){if(t instanceof IDBRequest)return ow(t);if(Ic.has(t))return Ic.get(t);const e=cw(t);return e!==t&&(Ic.set(t,e),Yh.set(e,t)),e}const Cc=t=>Yh.get(t);function dw(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=es(a);return r&&a.addEventListener("upgradeneeded",c=>{r(es(a.result),c.oldVersion,c.newVersion,es(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const hw=["get","getKey","getAll","getAllKeys","count"],fw=["put","add","delete","clear"],Ac=new Map;function ug(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ac.get(e))return Ac.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=fw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||hw.includes(n)))return;const i=async function(a,...l){const c=this.transaction(a,s?"readwrite":"readonly");let h=c.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),s&&c.done]))[0]};return Ac.set(e,i),i}lw(t=>({...t,get:(e,n,r)=>ug(e,n)||t.get(e,n,r),has:(e,n)=>!!ug(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(gw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function gw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Pd="@firebase/app",cg="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tr=new E0("@firebase/app"),mw="@firebase/app-compat",yw="@firebase/analytics-compat",vw="@firebase/analytics",xw="@firebase/app-check-compat",_w="@firebase/app-check",ww="@firebase/auth",Sw="@firebase/auth-compat",Tw="@firebase/database",Ew="@firebase/data-connect",Iw="@firebase/database-compat",Cw="@firebase/functions",Aw="@firebase/functions-compat",kw="@firebase/installations",Rw="@firebase/installations-compat",bw="@firebase/messaging",Pw="@firebase/messaging-compat",jw="@firebase/performance",Dw="@firebase/performance-compat",Nw="@firebase/remote-config",Mw="@firebase/remote-config-compat",Vw="@firebase/storage",Lw="@firebase/storage-compat",Fw="@firebase/firestore",Ow="@firebase/vertexai-preview",zw="@firebase/firestore-compat",Bw="firebase",Uw="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd="[DEFAULT]",$w={[Pd]:"fire-core",[mw]:"fire-core-compat",[vw]:"fire-analytics",[yw]:"fire-analytics-compat",[_w]:"fire-app-check",[xw]:"fire-app-check-compat",[ww]:"fire-auth",[Sw]:"fire-auth-compat",[Tw]:"fire-rtdb",[Ew]:"fire-data-connect",[Iw]:"fire-rtdb-compat",[Cw]:"fire-fn",[Aw]:"fire-fn-compat",[kw]:"fire-iid",[Rw]:"fire-iid-compat",[bw]:"fire-fcm",[Pw]:"fire-fcm-compat",[jw]:"fire-perf",[Dw]:"fire-perf-compat",[Nw]:"fire-rc",[Mw]:"fire-rc-compat",[Vw]:"fire-gcs",[Lw]:"fire-gcs-compat",[Fw]:"fire-fst",[zw]:"fire-fst-compat",[Ow]:"fire-vertex","fire-js":"fire-js",[Bw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tu=new Map,Ww=new Map,Dd=new Map;function dg(t,e){try{t.container.addComponent(e)}catch(n){Tr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function la(t){const e=t.name;if(Dd.has(e))return Tr.debug(`There were multiple attempts to register component ${e}.`),!1;Dd.set(e,t);for(const n of tu.values())dg(n,t);for(const n of Ww.values())dg(n,t);return!0}function A0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ts=new T0("app","Firebase",Hw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ui("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ts.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gw=Uw;function k0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:jd,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw ts.create("bad-app-name",{appName:String(s)});if(n||(n=S0()),!n)throw ts.create("no-options");const i=tu.get(s);if(i){if(eu(n,i.options)&&eu(r,i.config))return i;throw ts.create("duplicate-app",{appName:s})}const a=new J_(s);for(const c of Dd.values())a.addComponent(c);const l=new qw(n,r,a);return tu.set(s,l),l}function Qw(t=jd){const e=tu.get(t);if(!e&&t===jd&&S0())return k0();if(!e)throw ts.create("no-app",{appName:t});return e}function ns(t,e,n){var r;let s=(r=$w[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Tr.warn(l.join(" "));return}la(new Ui(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw="firebase-heartbeat-database",Yw=1,ua="firebase-heartbeat-store";let kc=null;function R0(){return kc||(kc=dw(Kw,Yw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ua)}catch(n){console.warn(n)}}}}).catch(t=>{throw ts.create("idb-open",{originalErrorMessage:t.message})})),kc}async function Xw(t){try{const n=(await R0()).transaction(ua),r=await n.objectStore(ua).get(b0(t));return await n.done,r}catch(e){if(e instanceof Ji)Tr.warn(e.message);else{const n=ts.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Tr.warn(n.message)}}}async function hg(t,e){try{const r=(await R0()).transaction(ua,"readwrite");await r.objectStore(ua).put(e,b0(t)),await r.done}catch(n){if(n instanceof Ji)Tr.warn(n.message);else{const r=ts.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Tr.warn(r.message)}}}function b0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw=1024,Zw=30*24*60*60*1e3;class eS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new nS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=fg();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=Zw}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Tr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=fg(),{heartbeatsToSend:r,unsentEntries:s}=tS(this._heartbeatsCache.heartbeats),i=w0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Tr.warn(n),""}}}function fg(){return new Date().toISOString().substring(0,10)}function tS(t,e=Jw){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),pg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),pg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class nS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return W_()?H_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Xw(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return hg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return hg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function pg(t){return w0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(t){la(new Ui("platform-logger",e=>new pw(e),"PRIVATE")),la(new Ui("heartbeat",e=>new eS(e),"PRIVATE")),ns(Pd,cg,t),ns(Pd,cg,"esm2017"),ns("fire-js","")}rS("");var sS="firebase",iS="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ns(sS,iS,"app");var gg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ns,P0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,g){function _(){}_.prototype=g.prototype,w.D=g.prototype,w.prototype=new _,w.prototype.constructor=w,w.C=function(E,x,R){for(var C=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)C[ne-2]=arguments[ne];return g.prototype[x].apply(E,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,g,_){_||(_=0);var E=Array(16);if(typeof g=="string")for(var x=0;16>x;++x)E[x]=g.charCodeAt(_++)|g.charCodeAt(_++)<<8|g.charCodeAt(_++)<<16|g.charCodeAt(_++)<<24;else for(x=0;16>x;++x)E[x]=g[_++]|g[_++]<<8|g[_++]<<16|g[_++]<<24;g=w.g[0],_=w.g[1],x=w.g[2];var R=w.g[3],C=g+(R^_&(x^R))+E[0]+3614090360&4294967295;g=_+(C<<7&4294967295|C>>>25),C=R+(x^g&(_^x))+E[1]+3905402710&4294967295,R=g+(C<<12&4294967295|C>>>20),C=x+(_^R&(g^_))+E[2]+606105819&4294967295,x=R+(C<<17&4294967295|C>>>15),C=_+(g^x&(R^g))+E[3]+3250441966&4294967295,_=x+(C<<22&4294967295|C>>>10),C=g+(R^_&(x^R))+E[4]+4118548399&4294967295,g=_+(C<<7&4294967295|C>>>25),C=R+(x^g&(_^x))+E[5]+1200080426&4294967295,R=g+(C<<12&4294967295|C>>>20),C=x+(_^R&(g^_))+E[6]+2821735955&4294967295,x=R+(C<<17&4294967295|C>>>15),C=_+(g^x&(R^g))+E[7]+4249261313&4294967295,_=x+(C<<22&4294967295|C>>>10),C=g+(R^_&(x^R))+E[8]+1770035416&4294967295,g=_+(C<<7&4294967295|C>>>25),C=R+(x^g&(_^x))+E[9]+2336552879&4294967295,R=g+(C<<12&4294967295|C>>>20),C=x+(_^R&(g^_))+E[10]+4294925233&4294967295,x=R+(C<<17&4294967295|C>>>15),C=_+(g^x&(R^g))+E[11]+2304563134&4294967295,_=x+(C<<22&4294967295|C>>>10),C=g+(R^_&(x^R))+E[12]+1804603682&4294967295,g=_+(C<<7&4294967295|C>>>25),C=R+(x^g&(_^x))+E[13]+4254626195&4294967295,R=g+(C<<12&4294967295|C>>>20),C=x+(_^R&(g^_))+E[14]+2792965006&4294967295,x=R+(C<<17&4294967295|C>>>15),C=_+(g^x&(R^g))+E[15]+1236535329&4294967295,_=x+(C<<22&4294967295|C>>>10),C=g+(x^R&(_^x))+E[1]+4129170786&4294967295,g=_+(C<<5&4294967295|C>>>27),C=R+(_^x&(g^_))+E[6]+3225465664&4294967295,R=g+(C<<9&4294967295|C>>>23),C=x+(g^_&(R^g))+E[11]+643717713&4294967295,x=R+(C<<14&4294967295|C>>>18),C=_+(R^g&(x^R))+E[0]+3921069994&4294967295,_=x+(C<<20&4294967295|C>>>12),C=g+(x^R&(_^x))+E[5]+3593408605&4294967295,g=_+(C<<5&4294967295|C>>>27),C=R+(_^x&(g^_))+E[10]+38016083&4294967295,R=g+(C<<9&4294967295|C>>>23),C=x+(g^_&(R^g))+E[15]+3634488961&4294967295,x=R+(C<<14&4294967295|C>>>18),C=_+(R^g&(x^R))+E[4]+3889429448&4294967295,_=x+(C<<20&4294967295|C>>>12),C=g+(x^R&(_^x))+E[9]+568446438&4294967295,g=_+(C<<5&4294967295|C>>>27),C=R+(_^x&(g^_))+E[14]+3275163606&4294967295,R=g+(C<<9&4294967295|C>>>23),C=x+(g^_&(R^g))+E[3]+4107603335&4294967295,x=R+(C<<14&4294967295|C>>>18),C=_+(R^g&(x^R))+E[8]+1163531501&4294967295,_=x+(C<<20&4294967295|C>>>12),C=g+(x^R&(_^x))+E[13]+2850285829&4294967295,g=_+(C<<5&4294967295|C>>>27),C=R+(_^x&(g^_))+E[2]+4243563512&4294967295,R=g+(C<<9&4294967295|C>>>23),C=x+(g^_&(R^g))+E[7]+1735328473&4294967295,x=R+(C<<14&4294967295|C>>>18),C=_+(R^g&(x^R))+E[12]+2368359562&4294967295,_=x+(C<<20&4294967295|C>>>12),C=g+(_^x^R)+E[5]+4294588738&4294967295,g=_+(C<<4&4294967295|C>>>28),C=R+(g^_^x)+E[8]+2272392833&4294967295,R=g+(C<<11&4294967295|C>>>21),C=x+(R^g^_)+E[11]+1839030562&4294967295,x=R+(C<<16&4294967295|C>>>16),C=_+(x^R^g)+E[14]+4259657740&4294967295,_=x+(C<<23&4294967295|C>>>9),C=g+(_^x^R)+E[1]+2763975236&4294967295,g=_+(C<<4&4294967295|C>>>28),C=R+(g^_^x)+E[4]+1272893353&4294967295,R=g+(C<<11&4294967295|C>>>21),C=x+(R^g^_)+E[7]+4139469664&4294967295,x=R+(C<<16&4294967295|C>>>16),C=_+(x^R^g)+E[10]+3200236656&4294967295,_=x+(C<<23&4294967295|C>>>9),C=g+(_^x^R)+E[13]+681279174&4294967295,g=_+(C<<4&4294967295|C>>>28),C=R+(g^_^x)+E[0]+3936430074&4294967295,R=g+(C<<11&4294967295|C>>>21),C=x+(R^g^_)+E[3]+3572445317&4294967295,x=R+(C<<16&4294967295|C>>>16),C=_+(x^R^g)+E[6]+76029189&4294967295,_=x+(C<<23&4294967295|C>>>9),C=g+(_^x^R)+E[9]+3654602809&4294967295,g=_+(C<<4&4294967295|C>>>28),C=R+(g^_^x)+E[12]+3873151461&4294967295,R=g+(C<<11&4294967295|C>>>21),C=x+(R^g^_)+E[15]+530742520&4294967295,x=R+(C<<16&4294967295|C>>>16),C=_+(x^R^g)+E[2]+3299628645&4294967295,_=x+(C<<23&4294967295|C>>>9),C=g+(x^(_|~R))+E[0]+4096336452&4294967295,g=_+(C<<6&4294967295|C>>>26),C=R+(_^(g|~x))+E[7]+1126891415&4294967295,R=g+(C<<10&4294967295|C>>>22),C=x+(g^(R|~_))+E[14]+2878612391&4294967295,x=R+(C<<15&4294967295|C>>>17),C=_+(R^(x|~g))+E[5]+4237533241&4294967295,_=x+(C<<21&4294967295|C>>>11),C=g+(x^(_|~R))+E[12]+1700485571&4294967295,g=_+(C<<6&4294967295|C>>>26),C=R+(_^(g|~x))+E[3]+2399980690&4294967295,R=g+(C<<10&4294967295|C>>>22),C=x+(g^(R|~_))+E[10]+4293915773&4294967295,x=R+(C<<15&4294967295|C>>>17),C=_+(R^(x|~g))+E[1]+2240044497&4294967295,_=x+(C<<21&4294967295|C>>>11),C=g+(x^(_|~R))+E[8]+1873313359&4294967295,g=_+(C<<6&4294967295|C>>>26),C=R+(_^(g|~x))+E[15]+4264355552&4294967295,R=g+(C<<10&4294967295|C>>>22),C=x+(g^(R|~_))+E[6]+2734768916&4294967295,x=R+(C<<15&4294967295|C>>>17),C=_+(R^(x|~g))+E[13]+1309151649&4294967295,_=x+(C<<21&4294967295|C>>>11),C=g+(x^(_|~R))+E[4]+4149444226&4294967295,g=_+(C<<6&4294967295|C>>>26),C=R+(_^(g|~x))+E[11]+3174756917&4294967295,R=g+(C<<10&4294967295|C>>>22),C=x+(g^(R|~_))+E[2]+718787259&4294967295,x=R+(C<<15&4294967295|C>>>17),C=_+(R^(x|~g))+E[9]+3951481745&4294967295,w.g[0]=w.g[0]+g&4294967295,w.g[1]=w.g[1]+(x+(C<<21&4294967295|C>>>11))&4294967295,w.g[2]=w.g[2]+x&4294967295,w.g[3]=w.g[3]+R&4294967295}r.prototype.u=function(w,g){g===void 0&&(g=w.length);for(var _=g-this.blockSize,E=this.B,x=this.h,R=0;R<g;){if(x==0)for(;R<=_;)s(this,w,R),R+=this.blockSize;if(typeof w=="string"){for(;R<g;)if(E[x++]=w.charCodeAt(R++),x==this.blockSize){s(this,E),x=0;break}}else for(;R<g;)if(E[x++]=w[R++],x==this.blockSize){s(this,E),x=0;break}}this.h=x,this.o+=g},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var g=1;g<w.length-8;++g)w[g]=0;var _=8*this.o;for(g=w.length-8;g<w.length;++g)w[g]=_&255,_/=256;for(this.u(w),w=Array(16),g=_=0;4>g;++g)for(var E=0;32>E;E+=8)w[_++]=this.g[g]>>>E&255;return w};function i(w,g){var _=l;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=g(w)}function a(w,g){this.h=g;for(var _=[],E=!0,x=w.length-1;0<=x;x--){var R=w[x]|0;E&&R==g||(_[x]=R,E=!1)}this.g=_}var l={};function c(w){return-128<=w&&128>w?i(w,function(g){return new a([g|0],0>g?-1:0)}):new a([w|0],0>w?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return y;if(0>w)return z(h(-w));for(var g=[],_=1,E=0;w>=_;E++)g[E]=w/_|0,_*=4294967296;return new a(g,0)}function p(w,g){if(w.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(w.charAt(0)=="-")return z(p(w.substring(1),g));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=h(Math.pow(g,8)),E=y,x=0;x<w.length;x+=8){var R=Math.min(8,w.length-x),C=parseInt(w.substring(x,x+R),g);8>R?(R=h(Math.pow(g,R)),E=E.j(R).add(h(C))):(E=E.j(_),E=E.add(h(C)))}return E}var y=c(0),m=c(1),I=c(16777216);t=a.prototype,t.m=function(){if(P(this))return-z(this).m();for(var w=0,g=1,_=0;_<this.g.length;_++){var E=this.i(_);w+=(0<=E?E:4294967296+E)*g,g*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(A(this))return"0";if(P(this))return"-"+z(this).toString(w);for(var g=h(Math.pow(w,6)),_=this,E="";;){var x=M(_,g).g;_=k(_,x.j(g));var R=((0<_.g.length?_.g[0]:_.h)>>>0).toString(w);if(_=x,A(_))return R+E;for(;6>R.length;)R="0"+R;E=R+E}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function A(w){if(w.h!=0)return!1;for(var g=0;g<w.g.length;g++)if(w.g[g]!=0)return!1;return!0}function P(w){return w.h==-1}t.l=function(w){return w=k(this,w),P(w)?-1:A(w)?0:1};function z(w){for(var g=w.g.length,_=[],E=0;E<g;E++)_[E]=~w.g[E];return new a(_,~w.h).add(m)}t.abs=function(){return P(this)?z(this):this},t.add=function(w){for(var g=Math.max(this.g.length,w.g.length),_=[],E=0,x=0;x<=g;x++){var R=E+(this.i(x)&65535)+(w.i(x)&65535),C=(R>>>16)+(this.i(x)>>>16)+(w.i(x)>>>16);E=C>>>16,R&=65535,C&=65535,_[x]=C<<16|R}return new a(_,_[_.length-1]&-2147483648?-1:0)};function k(w,g){return w.add(z(g))}t.j=function(w){if(A(this)||A(w))return y;if(P(this))return P(w)?z(this).j(z(w)):z(z(this).j(w));if(P(w))return z(this.j(z(w)));if(0>this.l(I)&&0>w.l(I))return h(this.m()*w.m());for(var g=this.g.length+w.g.length,_=[],E=0;E<2*g;E++)_[E]=0;for(E=0;E<this.g.length;E++)for(var x=0;x<w.g.length;x++){var R=this.i(E)>>>16,C=this.i(E)&65535,ne=w.i(x)>>>16,me=w.i(x)&65535;_[2*E+2*x]+=C*me,S(_,2*E+2*x),_[2*E+2*x+1]+=R*me,S(_,2*E+2*x+1),_[2*E+2*x+1]+=C*ne,S(_,2*E+2*x+1),_[2*E+2*x+2]+=R*ne,S(_,2*E+2*x+2)}for(E=0;E<g;E++)_[E]=_[2*E+1]<<16|_[2*E];for(E=g;E<2*g;E++)_[E]=0;return new a(_,0)};function S(w,g){for(;(w[g]&65535)!=w[g];)w[g+1]+=w[g]>>>16,w[g]&=65535,g++}function T(w,g){this.g=w,this.h=g}function M(w,g){if(A(g))throw Error("division by zero");if(A(w))return new T(y,y);if(P(w))return g=M(z(w),g),new T(z(g.g),z(g.h));if(P(g))return g=M(w,z(g)),new T(z(g.g),g.h);if(30<w.g.length){if(P(w)||P(g))throw Error("slowDivide_ only works with positive integers.");for(var _=m,E=g;0>=E.l(w);)_=H(_),E=H(E);var x=F(_,1),R=F(E,1);for(E=F(E,2),_=F(_,2);!A(E);){var C=R.add(E);0>=C.l(w)&&(x=x.add(_),R=C),E=F(E,1),_=F(_,1)}return g=k(w,x.j(g)),new T(x,g)}for(x=y;0<=w.l(g);){for(_=Math.max(1,Math.floor(w.m()/g.m())),E=Math.ceil(Math.log(_)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),R=h(_),C=R.j(g);P(C)||0<C.l(w);)_-=E,R=h(_),C=R.j(g);A(R)&&(R=m),x=x.add(R),w=k(w,C)}return new T(x,w)}t.A=function(w){return M(this,w).h},t.and=function(w){for(var g=Math.max(this.g.length,w.g.length),_=[],E=0;E<g;E++)_[E]=this.i(E)&w.i(E);return new a(_,this.h&w.h)},t.or=function(w){for(var g=Math.max(this.g.length,w.g.length),_=[],E=0;E<g;E++)_[E]=this.i(E)|w.i(E);return new a(_,this.h|w.h)},t.xor=function(w){for(var g=Math.max(this.g.length,w.g.length),_=[],E=0;E<g;E++)_[E]=this.i(E)^w.i(E);return new a(_,this.h^w.h)};function H(w){for(var g=w.g.length+1,_=[],E=0;E<g;E++)_[E]=w.i(E)<<1|w.i(E-1)>>>31;return new a(_,w.h)}function F(w,g){var _=g>>5;g%=32;for(var E=w.g.length-_,x=[],R=0;R<E;R++)x[R]=0<g?w.i(R+_)>>>g|w.i(R+_+1)<<32-g:w.i(R+_);return new a(x,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,P0=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,Ns=a}).apply(typeof gg<"u"?gg:typeof self<"u"?self:typeof window<"u"?window:{});var ul=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var j0,Co,D0,Il,Nd,N0,M0,V0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,d,f){return o==Array.prototype||o==Object.prototype||(o[d]=f.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof ul=="object"&&ul];for(var d=0;d<o.length;++d){var f=o[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(o,d){if(d)e:{var f=r;o=o.split(".");for(var v=0;v<o.length-1;v++){var j=o[v];if(!(j in f))break e;f=f[j]}o=o[o.length-1],v=f[o],d=d(v),d!=v&&d!=null&&e(f,o,{configurable:!0,writable:!0,value:d})}}function i(o,d){o instanceof String&&(o+="");var f=0,v=!1,j={next:function(){if(!v&&f<o.length){var O=f++;return{value:d(O,o[O]),done:!1}}return v=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}s("Array.prototype.values",function(o){return o||function(){return i(this,function(d,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function c(o){var d=typeof o;return d=d!="object"?d:o?Array.isArray(o)?"array":d:"null",d=="array"||d=="object"&&typeof o.length=="number"}function h(o){var d=typeof o;return d=="object"&&o!=null||d=="function"}function p(o,d,f){return o.call.apply(o.bind,arguments)}function y(o,d,f){if(!o)throw Error();if(2<arguments.length){var v=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,v),o.apply(d,j)}}return function(){return o.apply(d,arguments)}}function m(o,d,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:y,m.apply(null,arguments)}function I(o,d){var f=Array.prototype.slice.call(arguments,1);return function(){var v=f.slice();return v.push.apply(v,arguments),o.apply(this,v)}}function A(o,d){function f(){}f.prototype=d.prototype,o.aa=d.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(v,j,O){for(var ee=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)ee[qe-2]=arguments[qe];return d.prototype[j].apply(v,ee)}}function P(o){const d=o.length;if(0<d){const f=Array(d);for(let v=0;v<d;v++)f[v]=o[v];return f}return[]}function z(o,d){for(let f=1;f<arguments.length;f++){const v=arguments[f];if(c(v)){const j=o.length||0,O=v.length||0;o.length=j+O;for(let ee=0;ee<O;ee++)o[j+ee]=v[ee]}else o.push(v)}}class k{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function S(o){return/^[\s\xa0]*$/.test(o)}function T(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function M(o){return M[" "](o),o}M[" "]=function(){};var H=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function F(o,d,f){for(const v in o)d.call(f,o[v],v,o)}function w(o,d){for(const f in o)d.call(void 0,o[f],f,o)}function g(o){const d={};for(const f in o)d[f]=o[f];return d}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(o,d){let f,v;for(let j=1;j<arguments.length;j++){v=arguments[j];for(f in v)o[f]=v[f];for(let O=0;O<_.length;O++)f=_[O],Object.prototype.hasOwnProperty.call(v,f)&&(o[f]=v[f])}}function x(o){var d=1;o=o.split(":");const f=[];for(;0<d&&o.length;)f.push(o.shift()),d--;return o.length&&f.push(o.join(":")),f}function R(o){l.setTimeout(()=>{throw o},0)}function C(){var o=B;let d=null;return o.g&&(d=o.g,o.g=o.g.next,o.g||(o.h=null),d.next=null),d}class ne{constructor(){this.h=this.g=null}add(d,f){const v=me.get();v.set(d,f),this.h?this.h.next=v:this.g=v,this.h=v}}var me=new k(()=>new Ie,o=>o.reset());class Ie{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let te,N=!1,B=new ne,G=()=>{const o=l.Promise.resolve(void 0);te=()=>{o.then(U)}};var U=()=>{for(var o;o=C();){try{o.h.call(o.g)}catch(f){R(f)}var d=me;d.j(o),100>d.h&&(d.h++,o.next=d.g,d.g=o)}N=!1};function b(){this.s=this.s,this.C=this.C}b.prototype.s=!1,b.prototype.ma=function(){this.s||(this.s=!0,this.N())},b.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(o,d){this.type=o,this.g=this.target=d,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var $=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,d=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};l.addEventListener("test",f,d),l.removeEventListener("test",f,d)}catch{}return o}();function re(o,d){if(V.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,v=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=d,d=o.relatedTarget){if(H){e:{try{M(d.nodeName);var j=!0;break e}catch{}j=!1}j||(d=null)}}else f=="mouseover"?d=o.fromElement:f=="mouseout"&&(d=o.toElement);this.relatedTarget=d,v?(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:Z[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&re.aa.h.call(this)}}A(re,V);var Z={2:"touch",3:"pen",4:"mouse"};re.prototype.h=function(){re.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var se="closure_listenable_"+(1e6*Math.random()|0),X=0;function ie(o,d,f,v,j){this.listener=o,this.proxy=null,this.src=d,this.type=f,this.capture=!!v,this.ha=j,this.key=++X,this.da=this.fa=!1}function ve(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function xe(o){this.src=o,this.g={},this.h=0}xe.prototype.add=function(o,d,f,v,j){var O=o.toString();o=this.g[O],o||(o=this.g[O]=[],this.h++);var ee=ke(o,d,v,j);return-1<ee?(d=o[ee],f||(d.fa=!1)):(d=new ie(d,this.src,O,!!v,j),d.fa=f,o.push(d)),d};function le(o,d){var f=d.type;if(f in o.g){var v=o.g[f],j=Array.prototype.indexOf.call(v,d,void 0),O;(O=0<=j)&&Array.prototype.splice.call(v,j,1),O&&(ve(d),o.g[f].length==0&&(delete o.g[f],o.h--))}}function ke(o,d,f,v){for(var j=0;j<o.length;++j){var O=o[j];if(!O.da&&O.listener==d&&O.capture==!!f&&O.ha==v)return j}return-1}var Ve="closure_lm_"+(1e6*Math.random()|0),Se={};function ze(o,d,f,v,j){if(Array.isArray(d)){for(var O=0;O<d.length;O++)ze(o,d[O],f,v,j);return null}return f=Gs(f),o&&o[se]?o.K(d,f,h(v)?!!v.capture:!1,j):at(o,d,f,!1,v,j)}function at(o,d,f,v,j,O){if(!d)throw Error("Invalid event type");var ee=h(j)?!!j.capture:!!j,qe=kr(o);if(qe||(o[Ve]=qe=new xe(o)),f=qe.add(d,f,v,ee,O),f.proxy)return f;if(v=he(),f.proxy=v,v.src=o,v.listener=f,o.addEventListener)$||(j=ee),j===void 0&&(j=!1),o.addEventListener(d.toString(),v,j);else if(o.attachEvent)o.attachEvent(vn(d.toString()),v);else if(o.addListener&&o.removeListener)o.addListener(v);else throw Error("addEventListener and attachEvent are unavailable.");return f}function he(){function o(f){return d.call(o.src,o.listener,f)}const d=rr;return o}function ye(o,d,f,v,j){if(Array.isArray(d))for(var O=0;O<d.length;O++)ye(o,d[O],f,v,j);else v=h(v)?!!v.capture:!!v,f=Gs(f),o&&o[se]?(o=o.i,d=String(d).toString(),d in o.g&&(O=o.g[d],f=ke(O,f,v,j),-1<f&&(ve(O[f]),Array.prototype.splice.call(O,f,1),O.length==0&&(delete o.g[d],o.h--)))):o&&(o=kr(o))&&(d=o.g[d.toString()],o=-1,d&&(o=ke(d,f,v,j)),(f=-1<o?d[o]:null)&&Ae(f))}function Ae(o){if(typeof o!="number"&&o&&!o.da){var d=o.src;if(d&&d[se])le(d.i,o);else{var f=o.type,v=o.proxy;d.removeEventListener?d.removeEventListener(f,v,o.capture):d.detachEvent?d.detachEvent(vn(f),v):d.addListener&&d.removeListener&&d.removeListener(v),(f=kr(d))?(le(f,o),f.h==0&&(f.src=null,d[Ve]=null)):ve(o)}}}function vn(o){return o in Se?Se[o]:Se[o]="on"+o}function rr(o,d){if(o.da)o=!0;else{d=new re(d,this);var f=o.listener,v=o.ha||o.src;o.fa&&Ae(o),o=f.call(v,d)}return o}function kr(o){return o=o[Ve],o instanceof xe?o:null}var sr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gs(o){return typeof o=="function"?o:(o[sr]||(o[sr]=function(d){return o.handleEvent(d)}),o[sr])}function ft(){b.call(this),this.i=new xe(this),this.M=this,this.F=null}A(ft,b),ft.prototype[se]=!0,ft.prototype.removeEventListener=function(o,d,f,v){ye(this,o,d,f,v)};function Ct(o,d){var f,v=o.F;if(v)for(f=[];v;v=v.F)f.push(v);if(o=o.M,v=d.type||d,typeof d=="string")d=new V(d,o);else if(d instanceof V)d.target=d.target||o;else{var j=d;d=new V(v,o),E(d,j)}if(j=!0,f)for(var O=f.length-1;0<=O;O--){var ee=d.g=f[O];j=Rr(ee,v,!0,d)&&j}if(ee=d.g=o,j=Rr(ee,v,!0,d)&&j,j=Rr(ee,v,!1,d)&&j,f)for(O=0;O<f.length;O++)ee=d.g=f[O],j=Rr(ee,v,!1,d)&&j}ft.prototype.N=function(){if(ft.aa.N.call(this),this.i){var o=this.i,d;for(d in o.g){for(var f=o.g[d],v=0;v<f.length;v++)ve(f[v]);delete o.g[d],o.h--}}this.F=null},ft.prototype.K=function(o,d,f,v){return this.i.add(String(o),d,!1,f,v)},ft.prototype.L=function(o,d,f,v){return this.i.add(String(o),d,!0,f,v)};function Rr(o,d,f,v){if(d=o.i.g[String(d)],!d)return!0;d=d.concat();for(var j=!0,O=0;O<d.length;++O){var ee=d[O];if(ee&&!ee.da&&ee.capture==f){var qe=ee.listener,Rt=ee.ha||ee.src;ee.fa&&le(o.i,ee),j=qe.call(Rt,v)!==!1&&j}}return j&&!v.defaultPrevented}function Pa(o,d,f){if(typeof o=="function")f&&(o=m(o,f));else if(o&&typeof o.handleEvent=="function")o=m(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:l.setTimeout(o,d||0)}function Qs(o){o.g=Pa(()=>{o.g=null,o.i&&(o.i=!1,Qs(o))},o.l);const d=o.h;o.h=null,o.m.apply(null,d)}class fs extends b{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Qs(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qn(o){b.call(this),this.h=o,this.g={}}A(qn,b);var nt=[];function ja(o){F(o.g,function(d,f){this.g.hasOwnProperty(f)&&Ae(d)},o),o.g={}}qn.prototype.N=function(){qn.aa.N.call(this),ja(this)},qn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var so=l.JSON.stringify,Da=l.JSON.parse,ir=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function ps(){}ps.prototype.h=null;function gs(o){return o.h||(o.h=o.i())}function Ks(){}var fe={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function An(){V.call(this,"d")}A(An,V);function or(){V.call(this,"c")}A(or,V);var kn={},$u=null;function br(){return $u=$u||new ft}kn.La="serverreachability";function Wu(o){V.call(this,kn.La,o)}A(Wu,V);function ar(o){const d=br();Ct(d,new Wu(d))}kn.STAT_EVENT="statevent";function Rn(o,d){V.call(this,kn.STAT_EVENT,o),this.stat=d}A(Rn,V);function pt(o){const d=br();Ct(d,new Rn(d,o))}kn.Ma="timingevent";function be(o,d){V.call(this,kn.Ma,o),this.size=d}A(be,V);function ms(o,d){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},d)}function At(){this.g=!0}At.prototype.xa=function(){this.g=!1};function Pr(o,d,f,v,j,O){o.info(function(){if(o.g)if(O)for(var ee="",qe=O.split("&"),Rt=0;Rt<qe.length;Rt++){var Le=qe[Rt].split("=");if(1<Le.length){var zt=Le[0];Le=Le[1];var Bt=zt.split("_");ee=2<=Bt.length&&Bt[1]=="type"?ee+(zt+"="+Le+"&"):ee+(zt+"=redacted&")}}else ee=null;else ee=O;return"XMLHTTP REQ ("+v+") [attempt "+j+"]: "+d+`
`+f+`
`+ee})}function bn(o,d,f,v,j,O,ee){o.info(function(){return"XMLHTTP RESP ("+v+") [ attempt "+j+"]: "+d+`
`+f+`
`+O+" "+ee})}function ln(o,d,f,v){o.info(function(){return"XMLHTTP TEXT ("+d+"): "+qu(o,f)+(v?" "+v:"")})}function Hu(o,d){o.info(function(){return"TIMEOUT: "+d})}At.prototype.info=function(){};function qu(o,d){if(!o.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var v=f[o];if(!(2>v.length)){var j=v[1];if(Array.isArray(j)&&!(1>j.length)){var O=j[0];if(O!="noop"&&O!="stop"&&O!="close")for(var ee=1;ee<j.length;ee++)j[ee]=""}}}}return so(f)}catch{return d}}var io={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Gu={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ys;function jr(){}A(jr,ps),jr.prototype.g=function(){return new XMLHttpRequest},jr.prototype.i=function(){return{}},Ys=new jr;function Pn(o,d,f,v){this.j=o,this.i=d,this.l=f,this.R=v||1,this.U=new qn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Xs}function Xs(){this.i=null,this.g="",this.h=!1}var Dr={},Js={};function Zs(o,d,f){o.L=1,o.v=ws(xn(d)),o.m=f,o.P=!0,Na(o,null)}function Na(o,d){o.F=Date.now(),Nr(o),o.A=xn(o.v);var f=o.A,v=o.R;Array.isArray(v)||(v=[String(v)]),Gn(f.i,"t",v),o.C=0,f=o.j.J,o.h=new Xs,o.g=qf(o.j,f?d:null,!o.m),0<o.O&&(o.M=new fs(m(o.Y,o,o.g),o.O)),d=o.U,f=o.g,v=o.ca;var j="readystatechange";Array.isArray(j)||(j&&(nt[0]=j.toString()),j=nt);for(var O=0;O<j.length;O++){var ee=ze(f,j[O],v||d.handleEvent,!1,d.h||d);if(!ee)break;d.g[ee.key]=ee}d=o.H?g(o.H):{},o.m?(o.u||(o.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,d)):(o.u="GET",o.g.ea(o.A,o.u,null,d)),ar(),Pr(o.i,o.u,o.A,o.l,o.R,o.m)}Pn.prototype.ca=function(o){o=o.target;const d=this.M;d&&ur(o)==3?d.j():this.Y(o)},Pn.prototype.Y=function(o){try{if(o==this.g)e:{const Bt=ur(this.g);var d=this.g.Ba();const ci=this.g.Z();if(!(3>Bt)&&(Bt!=3||this.g&&(this.h.h||this.g.oa()||Mf(this.g)))){this.J||Bt!=4||d==7||(d==8||0>=ci?ar(3):ar(2)),ao(this);var f=this.g.Z();this.X=f;t:if(ei(this)){var v=Mf(this.g);o="";var j=v.length,O=ur(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){un(this),vs(this);var ee="";break t}this.h.i=new l.TextDecoder}for(d=0;d<j;d++)this.h.h=!0,o+=this.h.i.decode(v[d],{stream:!(O&&d==j-1)});v.length=0,this.h.g+=o,this.C=0,ee=this.h.g}else ee=this.g.oa();if(this.o=f==200,bn(this.i,this.u,this.A,this.l,this.R,Bt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var qe,Rt=this.g;if((qe=Rt.g?Rt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(qe)){var Le=qe;break t}}Le=null}if(f=Le)ln(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,jn(this,f);else{this.o=!1,this.s=3,pt(12),un(this),vs(this);break e}}if(this.P){f=!0;let Mn;for(;!this.J&&this.C<ee.length;)if(Mn=ys(this,ee),Mn==Js){Bt==4&&(this.s=4,pt(14),f=!1),ln(this.i,this.l,null,"[Incomplete Response]");break}else if(Mn==Dr){this.s=4,pt(15),ln(this.i,this.l,ee,"[Invalid Chunk]"),f=!1;break}else ln(this.i,this.l,Mn,null),jn(this,Mn);if(ei(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Bt!=4||ee.length!=0||this.h.h||(this.s=1,pt(16),f=!1),this.o=this.o&&f,!f)ln(this.i,this.l,ee,"[Invalid Chunked Response]"),un(this),vs(this);else if(0<ee.length&&!this.W){this.W=!0;var zt=this.j;zt.g==this&&zt.ba&&!zt.M&&(zt.j.info("Great, no buffering proxy detected. Bytes received: "+ee.length),Xu(zt),zt.M=!0,pt(11))}}else ln(this.i,this.l,ee,null),jn(this,ee);Bt==4&&un(this),this.o&&!this.J&&(Bt==4?Uf(this.j,this):(this.o=!1,Nr(this)))}else nx(this.g),f==400&&0<ee.indexOf("Unknown SID")?(this.s=3,pt(12)):(this.s=0,pt(13)),un(this),vs(this)}}}catch{}finally{}};function ei(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function ys(o,d){var f=o.C,v=d.indexOf(`
`,f);return v==-1?Js:(f=Number(d.substring(f,v)),isNaN(f)?Dr:(v+=1,v+f>d.length?Js:(d=d.slice(v,v+f),o.C=v+f,d)))}Pn.prototype.cancel=function(){this.J=!0,un(this)};function Nr(o){o.S=Date.now()+o.I,oo(o,o.I)}function oo(o,d){if(o.B!=null)throw Error("WatchDog timer not null");o.B=ms(m(o.ba,o),d)}function ao(o){o.B&&(l.clearTimeout(o.B),o.B=null)}Pn.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(Hu(this.i,this.A),this.L!=2&&(ar(),pt(17)),un(this),this.s=2,vs(this)):oo(this,this.S-o)};function vs(o){o.j.G==0||o.J||Uf(o.j,o)}function un(o){ao(o);var d=o.M;d&&typeof d.ma=="function"&&d.ma(),o.M=null,ja(o.U),o.g&&(d=o.g,o.g=null,d.abort(),d.ma())}function jn(o,d){try{var f=o.j;if(f.G!=0&&(f.g==o||ti(f.h,o))){if(!o.K&&ti(f.h,o)&&f.G==3){try{var v=f.Da.g.parse(d)}catch{v=null}if(Array.isArray(v)&&v.length==3){var j=v;if(j[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)$a(f),Ba(f);else break e;Yu(f),pt(18)}}else f.za=j[1],0<f.za-f.T&&37500>j[2]&&f.F&&f.v==0&&!f.C&&(f.C=ms(m(f.Za,f),6e3));if(1>=xs(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Es(f,11)}else if((o.K||f.g==o)&&$a(f),!S(d))for(j=f.Da.g.parse(d),d=0;d<j.length;d++){let Le=j[d];if(f.T=Le[0],Le=Le[1],f.G==2)if(Le[0]=="c"){f.K=Le[1],f.ia=Le[2];const zt=Le[3];zt!=null&&(f.la=zt,f.j.info("VER="+f.la));const Bt=Le[4];Bt!=null&&(f.Aa=Bt,f.j.info("SVER="+f.Aa));const ci=Le[5];ci!=null&&typeof ci=="number"&&0<ci&&(v=1.5*ci,f.L=v,f.j.info("backChannelRequestTimeoutMs_="+v)),v=f;const Mn=o.g;if(Mn){const Ha=Mn.g?Mn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ha){var O=v.h;O.g||Ha.indexOf("spdy")==-1&&Ha.indexOf("quic")==-1&&Ha.indexOf("h2")==-1||(O.j=O.l,O.g=new Set,O.h&&(ni(O,O.h),O.h=null))}if(v.D){const Ju=Mn.g?Mn.g.getResponseHeader("X-HTTP-Session-Id"):null;Ju&&(v.ya=Ju,He(v.I,v.D,Ju))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),v=f;var ee=o;if(v.qa=Hf(v,v.J?v.ia:null,v.W),ee.K){La(v.h,ee);var qe=ee,Rt=v.L;Rt&&(qe.I=Rt),qe.B&&(ao(qe),Nr(qe)),v.g=ee}else zf(v);0<f.i.length&&Ua(f)}else Le[0]!="stop"&&Le[0]!="close"||Es(f,7);else f.G==3&&(Le[0]=="stop"||Le[0]=="close"?Le[0]=="stop"?Es(f,7):Ku(f):Le[0]!="noop"&&f.l&&f.l.ta(Le),f.v=0)}}ar(4)}catch{}}var Df=class{constructor(o,d){this.g=o,this.map=d}};function Ma(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Va(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function xs(o){return o.h?1:o.g?o.g.size:0}function ti(o,d){return o.h?o.h==d:o.g?o.g.has(d):!1}function ni(o,d){o.g?o.g.add(d):o.h=d}function La(o,d){o.h&&o.h==d?o.h=null:o.g&&o.g.has(d)&&o.g.delete(d)}Ma.prototype.cancel=function(){if(this.i=Fa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Fa(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let d=o.i;for(const f of o.g.values())d=d.concat(f.D);return d}return P(o.i)}function lo(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(c(o)){for(var d=[],f=o.length,v=0;v<f;v++)d.push(o[v]);return d}d=[],f=0;for(v in o)d[f++]=o[v];return d}function Dn(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(c(o)||typeof o=="string"){var d=[];o=o.length;for(var f=0;f<o;f++)d.push(f);return d}d=[],f=0;for(const v in o)d[f++]=v;return d}}}function Nn(o,d){if(o.forEach&&typeof o.forEach=="function")o.forEach(d,void 0);else if(c(o)||typeof o=="string")Array.prototype.forEach.call(o,d,void 0);else for(var f=Dn(o),v=lo(o),j=v.length,O=0;O<j;O++)d.call(void 0,v[O],f&&f[O],o)}var _s=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Oa(o,d){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var v=o[f].indexOf("="),j=null;if(0<=v){var O=o[f].substring(0,v);j=o[f].substring(v+1)}else O=o[f];d(O,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Qt(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Qt){this.h=o.h,lr(this,o.j),this.o=o.o,this.g=o.g,ri(this,o.s),this.l=o.l;var d=o.i,f=new Oe;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),uo(this,f),this.m=o.m}else o&&(d=String(o).match(_s))?(this.h=!1,lr(this,d[1]||"",!0),this.o=q(d[2]||""),this.g=q(d[3]||"",!0),ri(this,d[4]),this.l=q(d[5]||"",!0),uo(this,d[6]||"",!0),this.m=q(d[7]||"")):(this.h=!1,this.i=new Oe(null,this.h))}Qt.prototype.toString=function(){var o=[],d=this.j;d&&o.push(L(d,K,!0),":");var f=this.g;return(f||d=="file")&&(o.push("//"),(d=this.o)&&o.push(L(d,K,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(L(f,f.charAt(0)=="/"?ce:ue,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",L(f,Ce)),o.join("")};function xn(o){return new Qt(o)}function lr(o,d,f){o.j=f?q(d,!0):d,o.j&&(o.j=o.j.replace(/:$/,""))}function ri(o,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);o.s=d}else o.s=null}function uo(o,d,f){d instanceof Oe?(o.i=d,Qe(o.i,o.h)):(f||(d=L(d,pe)),o.i=new Oe(d,o.h))}function He(o,d,f){o.i.set(d,f)}function ws(o){return He(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function q(o,d){return o?d?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function L(o,d,f){return typeof o=="string"?(o=encodeURI(o).replace(d,Q),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Q(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var K=/[#\/\?@]/g,ue=/[#\?:]/g,ce=/[#\?]/g,pe=/[#\?@]/g,Ce=/#/g;function Oe(o,d){this.h=this.g=null,this.i=o||null,this.j=!!d}function Be(o){o.g||(o.g=new Map,o.h=0,o.i&&Oa(o.i,function(d,f){o.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}t=Oe.prototype,t.add=function(o,d){Be(this),this.i=null,o=gt(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(d),this.h+=1,this};function kt(o,d){Be(o),d=gt(o,d),o.g.has(d)&&(o.i=null,o.h-=o.g.get(d).length,o.g.delete(d))}function xt(o,d){return Be(o),d=gt(o,d),o.g.has(d)}t.forEach=function(o,d){Be(this),this.g.forEach(function(f,v){f.forEach(function(j){o.call(d,j,v,this)},this)},this)},t.na=function(){Be(this);const o=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let v=0;v<d.length;v++){const j=o[v];for(let O=0;O<j.length;O++)f.push(d[v])}return f},t.V=function(o){Be(this);let d=[];if(typeof o=="string")xt(this,o)&&(d=d.concat(this.g.get(gt(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)d=d.concat(o[f])}return d},t.set=function(o,d){return Be(this),this.i=null,o=gt(this,o),xt(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[d]),this.h+=1,this},t.get=function(o,d){return o?(o=this.V(o),0<o.length?String(o[0]):d):d};function Gn(o,d,f){kt(o,d),0<f.length&&(o.i=null,o.g.set(gt(o,d),P(f)),o.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var v=d[f];const O=encodeURIComponent(String(v)),ee=this.V(v);for(v=0;v<ee.length;v++){var j=O;ee[v]!==""&&(j+="="+encodeURIComponent(String(ee[v]))),o.push(j)}}return this.i=o.join("&")};function gt(o,d){return d=String(d),o.j&&(d=d.toLowerCase()),d}function Qe(o,d){d&&!o.j&&(Be(o),o.i=null,o.g.forEach(function(f,v){var j=v.toLowerCase();v!=j&&(kt(this,v),Gn(this,j,f))},o)),o.j=d}function Mr(o,d){const f=new At;if(l.Image){const v=new Image;v.onload=I(je,f,"TestLoadImage: loaded",!0,d,v),v.onerror=I(je,f,"TestLoadImage: error",!1,d,v),v.onabort=I(je,f,"TestLoadImage: abort",!1,d,v),v.ontimeout=I(je,f,"TestLoadImage: timeout",!1,d,v),l.setTimeout(function(){v.ontimeout&&v.ontimeout()},1e4),v.src=o}else d(!1)}function si(o,d){const f=new At,v=new AbortController,j=setTimeout(()=>{v.abort(),je(f,"TestPingServer: timeout",!1,d)},1e4);fetch(o,{signal:v.signal}).then(O=>{clearTimeout(j),O.ok?je(f,"TestPingServer: ok",!0,d):je(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(j),je(f,"TestPingServer: error",!1,d)})}function je(o,d,f,v,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),v(f)}catch{}}function Qn(){this.g=new ir}function za(o,d,f){const v=f||"";try{Nn(o,function(j,O){let ee=j;h(j)&&(ee=so(j)),d.push(v+O+"="+encodeURIComponent(ee))})}catch(j){throw d.push(v+"type="+encodeURIComponent("_badmap")),j}}function Vr(o){this.l=o.Ub||null,this.j=o.eb||!1}A(Vr,ps),Vr.prototype.g=function(){return new ii(this.l,this.j)},Vr.prototype.i=function(o){return function(){return o}}({});function ii(o,d){ft.call(this),this.D=o,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(ii,ft),t=ii.prototype,t.open=function(o,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=d,this.readyState=1,Ss(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(d.body=o),(this.D||l).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ot(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Ss(this)),this.g&&(this.readyState=3,Ss(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;oi(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function oi(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var d=o.value?o.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!o.done}))&&(this.response=this.responseText+=d)}o.done?Ot(this):Ss(this),this.readyState==3&&oi(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,Ot(this))},t.Qa=function(o){this.g&&(this.response=o,Ot(this))},t.ga=function(){this.g&&Ot(this)};function Ot(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Ss(o)}t.setRequestHeader=function(o,d){this.u.append(o,d)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=d.next();return o.join(`\r
`)};function Ss(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(ii.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Qu(o){let d="";return F(o,function(f,v){d+=v,d+=":",d+=f,d+=`\r
`}),d}function ai(o,d,f){e:{for(v in f){var v=!1;break e}v=!0}v||(f=Qu(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):He(o,d,f))}function Ke(o){ft.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(Ke,ft);var we=/^https?$/i,et=["POST","PUT"];t=Ke.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,d,f,v){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);d=d?d.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ys.g(),this.v=this.o?gs(this.o):gs(Ys),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(o),!0),this.B=!1}catch(O){lt(this,O);return}if(o=f||"",f=new Map(this.headers),v)if(Object.getPrototypeOf(v)===Object.prototype)for(var j in v)f.set(j,v[j]);else if(typeof v.keys=="function"&&typeof v.get=="function")for(const O of v.keys())f.set(O,v.get(O));else throw Error("Unknown input type for opt_headers: "+String(v));v=Array.from(f.keys()).find(O=>O.toLowerCase()=="content-type"),j=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(et,d,void 0))||v||j||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[O,ee]of f)this.g.setRequestHeader(O,ee);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Nf(this),this.u=!0,this.g.send(o),this.u=!1}catch(O){lt(this,O)}};function lt(o,d){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=d,o.m=5,Ts(o),Lr(o)}function Ts(o){o.A||(o.A=!0,Ct(o,"complete"),Ct(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Ct(this,"complete"),Ct(this,"abort"),Lr(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Lr(this,!0)),Ke.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?li(this):this.bb())},t.bb=function(){li(this)};function li(o){if(o.h&&typeof a<"u"&&(!o.v[1]||ur(o)!=4||o.Z()!=2)){if(o.u&&ur(o)==4)Pa(o.Ea,0,o);else if(Ct(o,"readystatechange"),ur(o)==4){o.h=!1;try{const ee=o.Z();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var v;if(v=ee===0){var j=String(o.D).match(_s)[1]||null;!j&&l.self&&l.self.location&&(j=l.self.location.protocol.slice(0,-1)),v=!we.test(j?j.toLowerCase():"")}f=v}if(f)Ct(o,"complete"),Ct(o,"success");else{o.m=6;try{var O=2<ur(o)?o.g.statusText:""}catch{O=""}o.l=O+" ["+o.Z()+"]",Ts(o)}}finally{Lr(o)}}}}function Lr(o,d){if(o.g){Nf(o);const f=o.g,v=o.v[0]?()=>{}:null;o.g=null,o.v=null,d||Ct(o,"ready");try{f.onreadystatechange=v}catch{}}}function Nf(o){o.I&&(l.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function ur(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<ur(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var d=this.g.responseText;return o&&d.indexOf(o)==0&&(d=d.substring(o.length)),Da(d)}};function Mf(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function nx(o){const d={};o=(o.g&&2<=ur(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let v=0;v<o.length;v++){if(S(o[v]))continue;var f=x(o[v]);const j=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const O=d[j]||[];d[j]=O,O.push(f)}w(d,function(v){return v.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function co(o,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||d}function Vf(o){this.Aa=0,this.i=[],this.j=new At,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=co("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=co("baseRetryDelayMs",5e3,o),this.cb=co("retryDelaySeedMs",1e4,o),this.Wa=co("forwardChannelMaxRetries",2,o),this.wa=co("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Ma(o&&o.concurrentRequestLimit),this.Da=new Qn,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Vf.prototype,t.la=8,t.G=1,t.connect=function(o,d,f,v){pt(0),this.W=o,this.H=d||{},f&&v!==void 0&&(this.H.OSID=f,this.H.OAID=v),this.F=this.X,this.I=Hf(this,null,this.W),Ua(this)};function Ku(o){if(Lf(o),o.G==3){var d=o.U++,f=xn(o.I);if(He(f,"SID",o.K),He(f,"RID",d),He(f,"TYPE","terminate"),ho(o,f),d=new Pn(o,o.j,d),d.L=2,d.v=ws(xn(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=d.v,f=!0),f||(d.g=qf(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Nr(d)}Wf(o)}function Ba(o){o.g&&(Xu(o),o.g.cancel(),o.g=null)}function Lf(o){Ba(o),o.u&&(l.clearTimeout(o.u),o.u=null),$a(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function Ua(o){if(!Va(o.h)&&!o.s){o.s=!0;var d=o.Ga;te||G(),N||(te(),N=!0),B.add(d,o),o.B=0}}function rx(o,d){return xs(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=d.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=ms(m(o.Ga,o,d),$f(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const j=new Pn(this,this.j,o);let O=this.o;if(this.S&&(O?(O=g(O),E(O,this.S)):O=this.S),this.m!==null||this.O||(j.H=O,O=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var v=this.i[f];if("__data__"in v.map&&(v=v.map.__data__,typeof v=="string")){v=v.length;break t}v=void 0}if(v===void 0)break;if(d+=v,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=Of(this,j,d),f=xn(this.I),He(f,"RID",o),He(f,"CVER",22),this.D&&He(f,"X-HTTP-Session-Id",this.D),ho(this,f),O&&(this.O?d="headers="+encodeURIComponent(String(Qu(O)))+"&"+d:this.m&&ai(f,this.m,O)),ni(this.h,j),this.Ua&&He(f,"TYPE","init"),this.P?(He(f,"$req",d),He(f,"SID","null"),j.T=!0,Zs(j,f,null)):Zs(j,f,d),this.G=2}}else this.G==3&&(o?Ff(this,o):this.i.length==0||Va(this.h)||Ff(this))};function Ff(o,d){var f;d?f=d.l:f=o.U++;const v=xn(o.I);He(v,"SID",o.K),He(v,"RID",f),He(v,"AID",o.T),ho(o,v),o.m&&o.o&&ai(v,o.m,o.o),f=new Pn(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),d&&(o.i=d.D.concat(o.i)),d=Of(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),ni(o.h,f),Zs(f,v,d)}function ho(o,d){o.H&&F(o.H,function(f,v){He(d,v,f)}),o.l&&Nn({},function(f,v){He(d,v,f)})}function Of(o,d,f){f=Math.min(o.i.length,f);var v=o.l?m(o.l.Na,o.l,o):null;e:{var j=o.i;let O=-1;for(;;){const ee=["count="+f];O==-1?0<f?(O=j[0].g,ee.push("ofs="+O)):O=0:ee.push("ofs="+O);let qe=!0;for(let Rt=0;Rt<f;Rt++){let Le=j[Rt].g;const zt=j[Rt].map;if(Le-=O,0>Le)O=Math.max(0,j[Rt].g-100),qe=!1;else try{za(zt,ee,"req"+Le+"_")}catch{v&&v(zt)}}if(qe){v=ee.join("&");break e}}}return o=o.i.splice(0,f),d.D=o,v}function zf(o){if(!o.g&&!o.u){o.Y=1;var d=o.Fa;te||G(),N||(te(),N=!0),B.add(d,o),o.v=0}}function Yu(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=ms(m(o.Fa,o),$f(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,Bf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=ms(m(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,pt(10),Ba(this),Bf(this))};function Xu(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function Bf(o){o.g=new Pn(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var d=xn(o.qa);He(d,"RID","rpc"),He(d,"SID",o.K),He(d,"AID",o.T),He(d,"CI",o.F?"0":"1"),!o.F&&o.ja&&He(d,"TO",o.ja),He(d,"TYPE","xmlhttp"),ho(o,d),o.m&&o.o&&ai(d,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=ws(xn(d)),f.m=null,f.P=!0,Na(f,o)}t.Za=function(){this.C!=null&&(this.C=null,Ba(this),Yu(this),pt(19))};function $a(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function Uf(o,d){var f=null;if(o.g==d){$a(o),Xu(o),o.g=null;var v=2}else if(ti(o.h,d))f=d.D,La(o.h,d),v=1;else return;if(o.G!=0){if(d.o)if(v==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var j=o.B;v=br(),Ct(v,new be(v,f)),Ua(o)}else zf(o);else if(j=d.s,j==3||j==0&&0<d.X||!(v==1&&rx(o,d)||v==2&&Yu(o)))switch(f&&0<f.length&&(d=o.h,d.i=d.i.concat(f)),j){case 1:Es(o,5);break;case 4:Es(o,10);break;case 3:Es(o,6);break;default:Es(o,2)}}}function $f(o,d){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*d}function Es(o,d){if(o.j.info("Error code "+d),d==2){var f=m(o.fb,o),v=o.Xa;const j=!v;v=new Qt(v||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||lr(v,"https"),ws(v),j?Mr(v.toString(),f):si(v.toString(),f)}else pt(2);o.G=0,o.l&&o.l.sa(d),Wf(o),Lf(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),pt(2)):(this.j.info("Failed to ping google.com"),pt(1))};function Wf(o){if(o.G=0,o.ka=[],o.l){const d=Fa(o.h);(d.length!=0||o.i.length!=0)&&(z(o.ka,d),z(o.ka,o.i),o.h.i.length=0,P(o.i),o.i.length=0),o.l.ra()}}function Hf(o,d,f){var v=f instanceof Qt?xn(f):new Qt(f);if(v.g!="")d&&(v.g=d+"."+v.g),ri(v,v.s);else{var j=l.location;v=j.protocol,d=d?d+"."+j.hostname:j.hostname,j=+j.port;var O=new Qt(null);v&&lr(O,v),d&&(O.g=d),j&&ri(O,j),f&&(O.l=f),v=O}return f=o.D,d=o.ya,f&&d&&He(v,f,d),He(v,"VER",o.la),ho(o,v),v}function qf(o,d,f){if(d&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=o.Ca&&!o.pa?new Ke(new Vr({eb:f})):new Ke(o.pa),d.Ha(o.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gf(){}t=Gf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Wa(){}Wa.prototype.g=function(o,d){return new cn(o,d)};function cn(o,d){ft.call(this),this.g=new Vf(d),this.l=o,this.h=d&&d.messageUrlParams||null,o=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(o?o["X-WebChannel-Content-Type"]=d.messageContentType:o={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(o?o["X-WebChannel-Client-Profile"]=d.va:o={"X-WebChannel-Client-Profile":d.va}),this.g.S=o,(o=d&&d.Sb)&&!S(o)&&(this.g.m=o),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!S(d)&&(this.g.D=d,o=this.h,o!==null&&d in o&&(o=this.h,d in o&&delete o[d])),this.j=new ui(this)}A(cn,ft),cn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){Ku(this.g)},cn.prototype.o=function(o){var d=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=so(o),o=f);d.i.push(new Df(d.Ya++,o)),d.G==3&&Ua(d)},cn.prototype.N=function(){this.g.l=null,delete this.j,Ku(this.g),delete this.g,cn.aa.N.call(this)};function Qf(o){An.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var d=o.__sm__;if(d){e:{for(const f in d){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,d=d!==null&&o in d?d[o]:void 0),this.data=d}else this.data=o}A(Qf,An);function Kf(){or.call(this),this.status=1}A(Kf,or);function ui(o){this.g=o}A(ui,Gf),ui.prototype.ua=function(){Ct(this.g,"a")},ui.prototype.ta=function(o){Ct(this.g,new Qf(o))},ui.prototype.sa=function(o){Ct(this.g,new Kf)},ui.prototype.ra=function(){Ct(this.g,"b")},Wa.prototype.createWebChannel=Wa.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,V0=function(){return new Wa},M0=function(){return br()},N0=kn,Nd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},io.NO_ERROR=0,io.TIMEOUT=8,io.HTTP_ERROR=6,Il=io,Gu.COMPLETE="complete",D0=Gu,Ks.EventType=fe,fe.OPEN="a",fe.CLOSE="b",fe.ERROR="c",fe.MESSAGE="d",ft.prototype.listen=ft.prototype.K,Co=Ks,Ke.prototype.listenOnce=Ke.prototype.L,Ke.prototype.getLastError=Ke.prototype.Ka,Ke.prototype.getLastErrorCode=Ke.prototype.Ba,Ke.prototype.getStatus=Ke.prototype.Z,Ke.prototype.getResponseJson=Ke.prototype.Oa,Ke.prototype.getResponseText=Ke.prototype.oa,Ke.prototype.send=Ke.prototype.ea,Ke.prototype.setWithCredentials=Ke.prototype.Ha,j0=Ke}).apply(typeof ul<"u"?ul:typeof self<"u"?self:typeof window<"u"?window:{});const mg="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}en.UNAUTHENTICATED=new en(null),en.GOOGLE_CREDENTIALS=new en("google-credentials-uid"),en.FIRST_PARTY=new en("first-party-uid"),en.MOCK_USER=new en("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zi="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs=new E0("@firebase/firestore");function wo(){return zs.logLevel}function de(t,...e){if(zs.logLevel<=Ne.DEBUG){const n=e.map(Xh);zs.debug(`Firestore (${Zi}): ${t}`,...n)}}function Er(t,...e){if(zs.logLevel<=Ne.ERROR){const n=e.map(Xh);zs.error(`Firestore (${Zi}): ${t}`,...n)}}function ca(t,...e){if(zs.logLevel<=Ne.WARN){const n=e.map(Xh);zs.warn(`Firestore (${Zi}): ${t}`,...n)}}function Xh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _e(t="Unexpected state"){const e=`FIRESTORE (${Zi}) INTERNAL ASSERTION FAILED: `+t;throw Er(e),new Error(e)}function We(t,e){t||_e()}function Ee(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oe extends Ji{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class aS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(en.UNAUTHENTICATED))}shutdown(){}}class lS{constructor(e){this.t=e,this.currentUser=en.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){We(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new vr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new vr,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{de("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(de("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new vr)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(de("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(We(typeof r.accessToken=="string"),new oS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return We(e===null||typeof e=="string"),new en(e)}}class uS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=en.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class cS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new uS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(en.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class dS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){We(this.o===void 0);const r=i=>{i.error!=null&&de("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,de("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{de("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):de("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(We(typeof n.token=="string"),this.R=n.token,new dS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=fS(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Fe(t,e){return t<e?-1:t>e?1:0}function $i(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new oe(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new oe(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new oe(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new oe(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return St.fromMillis(Date.now())}static fromDate(e){return St.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new St(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Fe(this.nanoseconds,e.nanoseconds):Fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Te(e)}static min(){return new Te(new St(0,0))}static max(){return new Te(new St(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e,n,r){n===void 0?n=0:n>e.length&&_e(),r===void 0?r=e.length-n:r>e.length-n&&_e(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return da.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof da?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Je extends da{construct(e,n,r){return new Je(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new oe(W.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Je(n)}static emptyPath(){return new Je([])}}const pS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Nt extends da{construct(e,n,r){return new Nt(e,n,r)}static isValidIdentifier(e){return pS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Nt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Nt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new oe(W.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new oe(W.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new oe(W.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new oe(W.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Nt(n)}static emptyPath(){return new Nt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e){this.path=e}static fromPath(e){return new ge(Je.fromString(e))}static fromName(e){return new ge(Je.fromString(e).popFirst(5))}static empty(){return new ge(Je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Je.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ge(new Je(e.slice()))}}function gS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Te.fromTimestamp(r===1e9?new St(n+1,0):new St(n,r));return new os(s,ge.empty(),e)}function mS(t){return new os(t.readTime,t.key,-1)}class os{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new os(Te.min(),ge.empty(),-1)}static max(){return new os(Te.max(),ge.empty(),-1)}}function yS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ge.comparator(t.documentKey,e.documentKey),n!==0?n:Fe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ta(t){if(t.code!==W.FAILED_PRECONDITION||t.message!==vS)throw t;de("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&_e(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Y((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Y?n:Y.resolve(n)}catch(n){return Y.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Y.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Y.reject(n)}static resolve(e){return new Y((n,r)=>{n(e)})}static reject(e){return new Y((n,r)=>{r(e)})}static waitFor(e){return new Y((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},c=>r(c))}),a=!0,i===s&&n()})}static or(e){let n=Y.resolve(!1);for(const r of e)n=n.next(s=>s?Y.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new Y((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let c=0;c<i;c++){const h=c;n(e[h]).next(p=>{a[h]=p,++l,l===i&&r(a)},p=>s(p))}})}static doWhile(e,n){return new Y((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function _S(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ea(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Jh.oe=-1;function ku(t){return t==null}function nu(t){return t===0&&1/t==-1/0}function wS(t){return typeof t=="number"&&Number.isInteger(t)&&!nu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Hs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function F0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e,n){this.comparator=e,this.root=n||jt.EMPTY}insert(e,n){return new ot(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,jt.BLACK,null,null))}remove(e){return new ot(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cl(this.root,e,this.comparator,!1)}getReverseIterator(){return new cl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cl(this.root,e,this.comparator,!0)}}class cl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??jt.RED,this.left=s??jt.EMPTY,this.right=i??jt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new jt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return jt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return jt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw _e();const e=this.left.check();if(e!==this.right.check())throw _e();return e+(this.isRed()?0:1)}}jt.EMPTY=null,jt.RED=!0,jt.BLACK=!1;jt.EMPTY=new class{constructor(){this.size=0}get key(){throw _e()}get value(){throw _e()}get color(){throw _e()}get left(){throw _e()}get right(){throw _e()}copy(e,n,r,s,i){return this}insert(e,n,r){return new jt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.comparator=e,this.data=new ot(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new vg(this.data.getIterator())}getIteratorFrom(e){return new vg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Vt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Vt(this.comparator);return n.data=e,n}}class vg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.fields=e,e.sort(Nt.comparator)}static empty(){return new fn([])}unionWith(e){let n=new Vt(Nt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new fn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return $i(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new O0("Invalid base64 string: "+i):i}}(e);return new Ft(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new Ft(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ft.EMPTY_BYTE_STRING=new Ft("");const SS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function as(t){if(We(!!t),typeof t=="string"){let e=0;const n=SS.exec(t);if(We(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:dt(t.seconds),nanos:dt(t.nanos)}}function dt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Bs(t){return typeof t=="string"?Ft.fromBase64String(t):Ft.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function ef(t){const e=t.mapValue.fields.__previous_value__;return Zh(e)?ef(e):e}function ha(t){const e=as(t.mapValue.fields.__local_write_time__.timestampValue);return new St(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(e,n,r,s,i,a,l,c,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=h}}class fa{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new fa("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof fa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dl={mapValue:{}};function Us(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Zh(t)?4:IS(t)?9007199254740991:ES(t)?10:11:_e()}function nr(t,e){if(t===e)return!0;const n=Us(t);if(n!==Us(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ha(t).isEqual(ha(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=as(s.timestampValue),l=as(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Bs(s.bytesValue).isEqual(Bs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return dt(s.geoPointValue.latitude)===dt(i.geoPointValue.latitude)&&dt(s.geoPointValue.longitude)===dt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return dt(s.integerValue)===dt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=dt(s.doubleValue),l=dt(i.doubleValue);return a===l?nu(a)===nu(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return $i(t.arrayValue.values||[],e.arrayValue.values||[],nr);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(yg(a)!==yg(l))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(l[c]===void 0||!nr(a[c],l[c])))return!1;return!0}(t,e);default:return _e()}}function pa(t,e){return(t.values||[]).find(n=>nr(n,e))!==void 0}function Wi(t,e){if(t===e)return 0;const n=Us(t),r=Us(e);if(n!==r)return Fe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Fe(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=dt(i.integerValue||i.doubleValue),c=dt(a.integerValue||a.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return xg(t.timestampValue,e.timestampValue);case 4:return xg(ha(t),ha(e));case 5:return Fe(t.stringValue,e.stringValue);case 6:return function(i,a){const l=Bs(i),c=Bs(a);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),c=a.split("/");for(let h=0;h<l.length&&h<c.length;h++){const p=Fe(l[h],c[h]);if(p!==0)return p}return Fe(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=Fe(dt(i.latitude),dt(a.latitude));return l!==0?l:Fe(dt(i.longitude),dt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return _g(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,c,h,p;const y=i.fields||{},m=a.fields||{},I=(l=y.value)===null||l===void 0?void 0:l.arrayValue,A=(c=m.value)===null||c===void 0?void 0:c.arrayValue,P=Fe(((h=I==null?void 0:I.values)===null||h===void 0?void 0:h.length)||0,((p=A==null?void 0:A.values)===null||p===void 0?void 0:p.length)||0);return P!==0?P:_g(I,A)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===dl.mapValue&&a===dl.mapValue)return 0;if(i===dl.mapValue)return 1;if(a===dl.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),h=a.fields||{},p=Object.keys(h);c.sort(),p.sort();for(let y=0;y<c.length&&y<p.length;++y){const m=Fe(c[y],p[y]);if(m!==0)return m;const I=Wi(l[c[y]],h[p[y]]);if(I!==0)return I}return Fe(c.length,p.length)}(t.mapValue,e.mapValue);default:throw _e()}}function xg(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Fe(t,e);const n=as(t),r=as(e),s=Fe(n.seconds,r.seconds);return s!==0?s:Fe(n.nanos,r.nanos)}function _g(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Wi(n[s],r[s]);if(i)return i}return Fe(n.length,r.length)}function Hi(t){return Md(t)}function Md(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=as(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Bs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ge.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Md(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Md(n.fields[a])}`;return s+"}"}(t.mapValue):_e()}function wg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Vd(t){return!!t&&"integerValue"in t}function tf(t){return!!t&&"arrayValue"in t}function Sg(t){return!!t&&"nullValue"in t}function Tg(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Cl(t){return!!t&&"mapValue"in t}function ES(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function zo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Hs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=zo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=zo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function IS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.value=e}static empty(){return new nn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Cl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=zo(n)}setAll(e){let n=Nt.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=zo(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Cl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return nr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Cl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Hs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new nn(zo(this.value))}}function z0(t){const e=[];return Hs(t.fields,(n,r)=>{const s=new Nt([n]);if(Cl(r)){const i=z0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new qt(e,0,Te.min(),Te.min(),Te.min(),nn.empty(),0)}static newFoundDocument(e,n,r,s){return new qt(e,1,n,Te.min(),r,s,0)}static newNoDocument(e,n){return new qt(e,2,n,Te.min(),Te.min(),nn.empty(),0)}static newUnknownDocument(e,n){return new qt(e,3,n,Te.min(),Te.min(),nn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof qt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new qt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n){this.position=e,this.inclusive=n}}function Eg(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=ge.comparator(ge.fromName(a.referenceValue),n.key):r=Wi(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ig(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!nr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,n="asc"){this.field=e,this.dir=n}}function CS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{}class vt extends B0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new kS(e,n,r):n==="array-contains"?new PS(e,r):n==="in"?new jS(e,r):n==="not-in"?new DS(e,r):n==="array-contains-any"?new NS(e,r):new vt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new RS(e,r):new bS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Wi(n,this.value)):n!==null&&Us(this.value)===Us(n)&&this.matchesComparison(Wi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _e()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Hn extends B0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Hn(e,n)}matches(e){return U0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function U0(t){return t.op==="and"}function $0(t){return AS(t)&&U0(t)}function AS(t){for(const e of t.filters)if(e instanceof Hn)return!1;return!0}function Ld(t){if(t instanceof vt)return t.field.canonicalString()+t.op.toString()+Hi(t.value);if($0(t))return t.filters.map(e=>Ld(e)).join(",");{const e=t.filters.map(n=>Ld(n)).join(",");return`${t.op}(${e})`}}function W0(t,e){return t instanceof vt?function(r,s){return s instanceof vt&&r.op===s.op&&r.field.isEqual(s.field)&&nr(r.value,s.value)}(t,e):t instanceof Hn?function(r,s){return s instanceof Hn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&W0(a,s.filters[l]),!0):!1}(t,e):void _e()}function H0(t){return t instanceof vt?function(n){return`${n.field.canonicalString()} ${n.op} ${Hi(n.value)}`}(t):t instanceof Hn?function(n){return n.op.toString()+" {"+n.getFilters().map(H0).join(" ,")+"}"}(t):"Filter"}class kS extends vt{constructor(e,n,r){super(e,n,r),this.key=ge.fromName(r.referenceValue)}matches(e){const n=ge.comparator(e.key,this.key);return this.matchesComparison(n)}}class RS extends vt{constructor(e,n){super(e,"in",n),this.keys=q0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class bS extends vt{constructor(e,n){super(e,"not-in",n),this.keys=q0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function q0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ge.fromName(r.referenceValue))}class PS extends vt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return tf(n)&&pa(n.arrayValue,this.value)}}class jS extends vt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&pa(this.value.arrayValue,n)}}class DS extends vt{constructor(e,n){super(e,"not-in",n)}matches(e){if(pa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!pa(this.value.arrayValue,n)}}class NS extends vt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!tf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>pa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function Cg(t,e=null,n=[],r=[],s=null,i=null,a=null){return new MS(t,e,n,r,s,i,a)}function nf(t){const e=Ee(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Ld(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),ku(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Hi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Hi(r)).join(",")),e.ue=n}return e.ue}function rf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!CS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!W0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ig(t.startAt,e.startAt)&&Ig(t.endAt,e.endAt)}function Fd(t){return ge.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function VS(t,e,n,r,s,i,a,l){return new Ia(t,e,n,r,s,i,a,l)}function sf(t){return new Ia(t)}function Ag(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function G0(t){return t.collectionGroup!==null}function Bo(t){const e=Ee(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Vt(Nt.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new su(i,r))}),n.has(Nt.keyField().canonicalString())||e.ce.push(new su(Nt.keyField(),r))}return e.ce}function er(t){const e=Ee(t);return e.le||(e.le=LS(e,Bo(t))),e.le}function LS(t,e){if(t.limitType==="F")return Cg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new su(s.field,i)});const n=t.endAt?new ru(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ru(t.startAt.position,t.startAt.inclusive):null;return Cg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Od(t,e){const n=t.filters.concat([e]);return new Ia(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function zd(t,e,n){return new Ia(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ru(t,e){return rf(er(t),er(e))&&t.limitType===e.limitType}function Q0(t){return`${nf(er(t))}|lt:${t.limitType}`}function fi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>H0(s)).join(", ")}]`),ku(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Hi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Hi(s)).join(",")),`Target(${r})`}(er(t))}; limitType=${t.limitType})`}function bu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ge.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Bo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,c){const h=Eg(a,l,c);return a.inclusive?h<=0:h<0}(r.startAt,Bo(r),s)||r.endAt&&!function(a,l,c){const h=Eg(a,l,c);return a.inclusive?h>=0:h>0}(r.endAt,Bo(r),s))}(t,e)}function FS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function K0(t){return(e,n)=>{let r=!1;for(const s of Bo(t)){const i=OS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function OS(t,e,n){const r=t.field.isKeyField()?ge.comparator(e.key,n.key):function(i,a,l){const c=a.data.field(i),h=l.data.field(i);return c!==null&&h!==null?Wi(c,h):_e()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return _e()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Hs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return F0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS=new ot(ge.comparator);function Ir(){return zS}const Y0=new ot(ge.comparator);function Ao(...t){let e=Y0;for(const n of t)e=e.insert(n.key,n);return e}function X0(t){let e=Y0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ps(){return Uo()}function J0(){return Uo()}function Uo(){return new eo(t=>t.toString(),(t,e)=>t.isEqual(e))}const BS=new ot(ge.comparator),US=new Vt(ge.comparator);function Pe(...t){let e=US;for(const n of t)e=e.add(n);return e}const $S=new Vt(Fe);function WS(){return $S}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function of(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nu(e)?"-0":e}}function Z0(t){return{integerValue:""+t}}function HS(t,e){return wS(e)?Z0(e):of(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(){this._=void 0}}function qS(t,e,n){return t instanceof ga?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Zh(i)&&(i=ef(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof ma?tv(t,e):t instanceof ya?nv(t,e):function(s,i){const a=ev(s,i),l=kg(a)+kg(s.Pe);return Vd(a)&&Vd(s.Pe)?Z0(l):of(s.serializer,l)}(t,e)}function GS(t,e,n){return t instanceof ma?tv(t,e):t instanceof ya?nv(t,e):n}function ev(t,e){return t instanceof iu?function(r){return Vd(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ga extends Pu{}class ma extends Pu{constructor(e){super(),this.elements=e}}function tv(t,e){const n=rv(e);for(const r of t.elements)n.some(s=>nr(s,r))||n.push(r);return{arrayValue:{values:n}}}class ya extends Pu{constructor(e){super(),this.elements=e}}function nv(t,e){let n=rv(e);for(const r of t.elements)n=n.filter(s=>!nr(s,r));return{arrayValue:{values:n}}}class iu extends Pu{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function kg(t){return dt(t.integerValue||t.doubleValue)}function rv(t){return tf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,n){this.field=e,this.transform=n}}function KS(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof ma&&s instanceof ma||r instanceof ya&&s instanceof ya?$i(r.elements,s.elements,nr):r instanceof iu&&s instanceof iu?nr(r.Pe,s.Pe):r instanceof ga&&s instanceof ga}(t.transform,e.transform)}class YS{constructor(e,n){this.version=e,this.transformResults=n}}class Un{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Un}static exists(e){return new Un(void 0,e)}static updateTime(e){return new Un(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Al(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ju{}function sv(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ov(t.key,Un.none()):new Ca(t.key,t.data,Un.none());{const n=t.data,r=nn.empty();let s=new Vt(Nt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new hs(t.key,r,new fn(s.toArray()),Un.none())}}function XS(t,e,n){t instanceof Ca?function(s,i,a){const l=s.value.clone(),c=bg(s.fieldTransforms,i,a.transformResults);l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof hs?function(s,i,a){if(!Al(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=bg(s.fieldTransforms,i,a.transformResults),c=i.data;c.setAll(iv(s)),c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function $o(t,e,n,r){return t instanceof Ca?function(i,a,l,c){if(!Al(i.precondition,a))return l;const h=i.value.clone(),p=Pg(i.fieldTransforms,c,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof hs?function(i,a,l,c){if(!Al(i.precondition,a))return l;const h=Pg(i.fieldTransforms,c,a),p=a.data;return p.setAll(iv(i)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(y=>y.field))}(t,e,n,r):function(i,a,l){return Al(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function JS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=ev(r.transform,s||null);i!=null&&(n===null&&(n=nn.empty()),n.set(r.field,i))}return n||null}function Rg(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&$i(r,s,(i,a)=>KS(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ca extends ju{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class hs extends ju{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function iv(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function bg(t,e,n){const r=new Map;We(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,GS(a,l,n[s]))}return r}function Pg(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,qS(i,a,e))}return r}class ov extends ju{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ZS extends ju{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&XS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=$o(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=$o(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=J0();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const c=sv(a,l);c!==null&&r.set(s.key,c),a.isValidDocument()||a.convertToNoDocument(Te.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Pe())}isEqual(e){return this.batchId===e.batchId&&$i(this.mutations,e.mutations,(n,r)=>Rg(n,r))&&$i(this.baseMutations,e.baseMutations,(n,r)=>Rg(n,r))}}class af{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){We(e.mutations.length===r.length);let s=function(){return BS}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new af(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mt,De;function rT(t){switch(t){default:return _e();case W.CANCELLED:case W.UNKNOWN:case W.DEADLINE_EXCEEDED:case W.RESOURCE_EXHAUSTED:case W.INTERNAL:case W.UNAVAILABLE:case W.UNAUTHENTICATED:return!1;case W.INVALID_ARGUMENT:case W.NOT_FOUND:case W.ALREADY_EXISTS:case W.PERMISSION_DENIED:case W.FAILED_PRECONDITION:case W.ABORTED:case W.OUT_OF_RANGE:case W.UNIMPLEMENTED:case W.DATA_LOSS:return!0}}function av(t){if(t===void 0)return Er("GRPC error has no .code"),W.UNKNOWN;switch(t){case mt.OK:return W.OK;case mt.CANCELLED:return W.CANCELLED;case mt.UNKNOWN:return W.UNKNOWN;case mt.DEADLINE_EXCEEDED:return W.DEADLINE_EXCEEDED;case mt.RESOURCE_EXHAUSTED:return W.RESOURCE_EXHAUSTED;case mt.INTERNAL:return W.INTERNAL;case mt.UNAVAILABLE:return W.UNAVAILABLE;case mt.UNAUTHENTICATED:return W.UNAUTHENTICATED;case mt.INVALID_ARGUMENT:return W.INVALID_ARGUMENT;case mt.NOT_FOUND:return W.NOT_FOUND;case mt.ALREADY_EXISTS:return W.ALREADY_EXISTS;case mt.PERMISSION_DENIED:return W.PERMISSION_DENIED;case mt.FAILED_PRECONDITION:return W.FAILED_PRECONDITION;case mt.ABORTED:return W.ABORTED;case mt.OUT_OF_RANGE:return W.OUT_OF_RANGE;case mt.UNIMPLEMENTED:return W.UNIMPLEMENTED;case mt.DATA_LOSS:return W.DATA_LOSS;default:return _e()}}(De=mt||(mt={}))[De.OK=0]="OK",De[De.CANCELLED=1]="CANCELLED",De[De.UNKNOWN=2]="UNKNOWN",De[De.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",De[De.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",De[De.NOT_FOUND=5]="NOT_FOUND",De[De.ALREADY_EXISTS=6]="ALREADY_EXISTS",De[De.PERMISSION_DENIED=7]="PERMISSION_DENIED",De[De.UNAUTHENTICATED=16]="UNAUTHENTICATED",De[De.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",De[De.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",De[De.ABORTED=10]="ABORTED",De[De.OUT_OF_RANGE=11]="OUT_OF_RANGE",De[De.UNIMPLEMENTED=12]="UNIMPLEMENTED",De[De.INTERNAL=13]="INTERNAL",De[De.UNAVAILABLE=14]="UNAVAILABLE",De[De.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sT(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT=new Ns([4294967295,4294967295],0);function jg(t){const e=sT().encode(t),n=new P0;return n.update(e),new Uint8Array(n.digest())}function Dg(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ns([n,r],0),new Ns([s,i],0)]}class lf{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ko(`Invalid padding: ${n}`);if(r<0)throw new ko(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ko(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ko(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ns.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Ns.fromNumber(r)));return s.compare(iT)===1&&(s=new Ns([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=jg(e),[r,s]=Dg(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new lf(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=jg(e),[r,s]=Dg(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ko extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Aa.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Du(Te.min(),s,new ot(Fe),Ir(),Pe())}}class Aa{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Aa(r,n,Pe(),Pe(),Pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class lv{constructor(e,n){this.targetId=e,this.me=n}}class uv{constructor(e,n,r=Ft.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Ng{constructor(){this.fe=0,this.ge=Vg(),this.pe=Ft.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Pe(),n=Pe(),r=Pe();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:_e()}}),new Aa(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Vg()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,We(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class oT{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ir(),this.qe=Mg(),this.Qe=new ot(Fe)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:_e()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(Fd(i))if(r===0){const a=new ge(i.path);this.Ue(n,a,qt.newNoDocument(a,Te.min()))}else We(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),c=l?this.Xe(l,e,a):1;if(c!==0){this.je(n);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=Bs(r).toUint8Array()}catch(c){if(c instanceof O0)return ca("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new lf(a,s,i)}catch(c){return ca(c instanceof ko?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&Fd(l.target)){const c=new ge(l.target.path);this.ke.get(c)!==null||this.it(a,c)||this.Ue(a,c,qt.newNoDocument(c,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=Pe();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(c=>{const h=this.Je(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new Du(e,n,this.Qe,this.ke,r);return this.ke=Ir(),this.qe=Mg(),this.Qe=new ot(Fe),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Ng,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Vt(Fe),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||de("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ng),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Mg(){return new ot(ge.comparator)}function Vg(){return new ot(ge.comparator)}const aT={asc:"ASCENDING",desc:"DESCENDING"},lT={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uT={and:"AND",or:"OR"};class cT{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Bd(t,e){return t.useProto3Json||ku(e)?e:{value:e}}function ou(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function cv(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function dT(t,e){return ou(t,e.toTimestamp())}function tr(t){return We(!!t),Te.fromTimestamp(function(n){const r=as(n);return new St(r.seconds,r.nanos)}(t))}function uf(t,e){return Ud(t,e).canonicalString()}function Ud(t,e){const n=function(s){return new Je(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function dv(t){const e=Je.fromString(t);return We(mv(e)),e}function $d(t,e){return uf(t.databaseId,e.path)}function Rc(t,e){const n=dv(e);if(n.get(1)!==t.databaseId.projectId)throw new oe(W.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new oe(W.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ge(fv(n))}function hv(t,e){return uf(t.databaseId,e)}function hT(t){const e=dv(t);return e.length===4?Je.emptyPath():fv(e)}function Wd(t){return new Je(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function fv(t){return We(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Lg(t,e,n){return{name:$d(t,e),fields:n.value.mapValue.fields}}function fT(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:_e()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,p){return h.useProto3Json?(We(p===void 0||typeof p=="string"),Ft.fromBase64String(p||"")):(We(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Ft.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){const p=h.code===void 0?W.UNKNOWN:av(h.code);return new oe(p,h.message||"")}(a);n=new uv(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Rc(t,r.document.name),i=tr(r.document.updateTime),a=r.document.createTime?tr(r.document.createTime):Te.min(),l=new nn({mapValue:{fields:r.document.fields}}),c=qt.newFoundDocument(s,i,a,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new kl(h,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Rc(t,r.document),i=r.readTime?tr(r.readTime):Te.min(),a=qt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new kl([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Rc(t,r.document),i=r.removedTargetIds||[];n=new kl([],i,s,null)}else{if(!("filter"in e))return _e();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new nT(s,i),l=r.targetId;n=new lv(l,a)}}return n}function pT(t,e){let n;if(e instanceof Ca)n={update:Lg(t,e.key,e.value)};else if(e instanceof ov)n={delete:$d(t,e.key)};else if(e instanceof hs)n={update:Lg(t,e.key,e.data),updateMask:TT(e.fieldMask)};else{if(!(e instanceof ZS))return _e();n={verify:$d(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof ga)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ma)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ya)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof iu)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw _e()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:dT(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:_e()}(t,e.precondition)),n}function gT(t,e){return t&&t.length>0?(We(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?tr(s.updateTime):tr(i);return a.isEqual(Te.min())&&(a=tr(i)),new YS(a,s.transformResults||[])}(n,e))):[]}function mT(t,e){return{documents:[hv(t,e.path)]}}function yT(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=hv(t,s);const i=function(h){if(h.length!==0)return gv(Hn.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(h){if(h.length!==0)return h.map(p=>function(m){return{field:pi(m.field),direction:_T(m.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=Bd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function vT(t){let e=hT(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){We(r===1);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(y){const m=pv(y);return m instanceof Hn&&$0(m)?m.getFilters():[m]}(n.where));let a=[];n.orderBy&&(a=function(y){return y.map(m=>function(A){return new su(gi(A.field),function(z){switch(z){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(y){let m;return m=typeof y=="object"?y.value:y,ku(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(y){const m=!!y.before,I=y.values||[];return new ru(I,m)}(n.startAt));let h=null;return n.endAt&&(h=function(y){const m=!y.before,I=y.values||[];return new ru(I,m)}(n.endAt)),VS(e,s,a,i,l,"F",c,h)}function xT(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _e()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function pv(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=gi(n.unaryFilter.field);return vt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=gi(n.unaryFilter.field);return vt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=gi(n.unaryFilter.field);return vt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=gi(n.unaryFilter.field);return vt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return _e()}}(t):t.fieldFilter!==void 0?function(n){return vt.create(gi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return _e()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Hn.create(n.compositeFilter.filters.map(r=>pv(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return _e()}}(n.compositeFilter.op))}(t):_e()}function _T(t){return aT[t]}function wT(t){return lT[t]}function ST(t){return uT[t]}function pi(t){return{fieldPath:t.canonicalString()}}function gi(t){return Nt.fromServerFormat(t.fieldPath)}function gv(t){return t instanceof vt?function(n){if(n.op==="=="){if(Tg(n.value))return{unaryFilter:{field:pi(n.field),op:"IS_NAN"}};if(Sg(n.value))return{unaryFilter:{field:pi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Tg(n.value))return{unaryFilter:{field:pi(n.field),op:"IS_NOT_NAN"}};if(Sg(n.value))return{unaryFilter:{field:pi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pi(n.field),op:wT(n.op),value:n.value}}}(t):t instanceof Hn?function(n){const r=n.getFilters().map(s=>gv(s));return r.length===1?r[0]:{compositeFilter:{op:ST(n.op),filters:r}}}(t):_e()}function TT(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function mv(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e,n,r,s,i=Te.min(),a=Te.min(),l=Ft.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Hr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e){this.ct=e}}function IT(t){const e=vT({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?zd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(){this.un=new AT}addToCollectionParentIndex(e,n){return this.un.add(n),Y.resolve()}getCollectionParents(e,n){return Y.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return Y.resolve()}deleteFieldIndex(e,n){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,n){return Y.resolve()}getDocumentsMatchingTarget(e,n){return Y.resolve(null)}getIndexType(e,n){return Y.resolve(0)}getFieldIndexes(e,n){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,n){return Y.resolve(os.min())}getMinOffsetFromCollectionGroup(e,n){return Y.resolve(os.min())}updateCollectionGroup(e,n,r){return Y.resolve()}updateIndexEntries(e,n){return Y.resolve()}}class AT{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Vt(Je.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Vt(Je.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new qi(0)}static kn(){return new qi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(){this.changes=new eo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,qt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?Y.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&$o(r.mutation,s,fn.empty(),St.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Pe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Pe()){const s=Ps();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=Ao();return i.forEach((l,c)=>{a=a.insert(l,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Ps();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Pe()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=Ir();const a=Uo(),l=function(){return Uo()}();return n.forEach((c,h)=>{const p=r.get(h.key);s.has(h.key)&&(p===void 0||p.mutation instanceof hs)?i=i.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),$o(p.mutation,h,p.mutation.getFieldMask(),St.now())):a.set(h.key,fn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((h,p)=>a.set(h,p)),n.forEach((h,p)=>{var y;return l.set(h,new RT(p,(y=a.get(h))!==null&&y!==void 0?y:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Uo();let s=new ot((a,l)=>a-l),i=Pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(c=>{const h=n.get(c);if(h===null)return;let p=r.get(c)||fn.empty();p=l.applyToLocalView(h,p),r.set(c,p);const y=(s.get(l.batchId)||Pe()).add(c);s=s.insert(l.batchId,y)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),h=c.key,p=c.value,y=J0();p.forEach(m=>{if(!i.has(m)){const I=sv(n.get(m),r.get(m));I!==null&&y.set(m,I),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,y))}return Y.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return ge.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):G0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):Y.resolve(Ps());let l=-1,c=i;return a.next(h=>Y.forEach(h,(p,y)=>(l<y.largestBatchId&&(l=y.largestBatchId),i.get(p)?Y.resolve():this.remoteDocumentCache.getEntry(e,p).next(m=>{c=c.insert(p,m)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,c,h,Pe())).next(p=>({batchId:l,changes:X0(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ge(n)).next(r=>{let s=Ao();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=Ao();return this.indexManager.getCollectionParents(e,i).next(l=>Y.forEach(l,c=>{const h=function(y,m){return new Ia(m,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(p=>{p.forEach((y,m)=>{a=a.insert(y,m)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((c,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,qt.newInvalidDocument(p)))});let l=Ao();return a.forEach((c,h)=>{const p=i.get(c);p!==void 0&&$o(p.mutation,h,fn.empty(),St.now()),bu(n,h)&&(l=l.insert(c,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return Y.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:tr(s.createTime)}}(n)),Y.resolve()}getNamedQuery(e,n){return Y.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:IT(s.bundledQuery),readTime:tr(s.readTime)}}(n)),Y.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(){this.overlays=new ot(ge.comparator),this.Ir=new Map}getOverlay(e,n){return Y.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ps();return Y.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),Y.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),Y.resolve()}getOverlaysForCollection(e,n,r){const s=Ps(),i=n.length+1,a=new ge(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const c=l.getNext().value,h=c.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return Y.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ot((h,p)=>h-p);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=i.get(h.largestBatchId);p===null&&(p=Ps(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=Ps(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=s)););return Y.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new tT(n,r));let i=this.Ir.get(n);i===void 0&&(i=Pe(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(){this.sessionToken=Ft.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Y.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(){this.Tr=new Vt(Tt.Er),this.dr=new Vt(Tt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Tt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Tt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ge(new Je([])),r=new Tt(n,e),s=new Tt(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ge(new Je([])),r=new Tt(n,e),s=new Tt(n,e+1);let i=Pe();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new Tt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Tt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ge.comparator(e.key,n.key)||Fe(e.wr,n.wr)}static Ar(e,n){return Fe(e.wr,n.wr)||ge.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Vt(Tt.Er)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new eT(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new Tt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Y.resolve(a)}lookupMutationBatch(e,n){return Y.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return Y.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Tt(n,0),s=new Tt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),Y.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Vt(Fe);return n.forEach(s=>{const i=new Tt(s,0),a=new Tt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),Y.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ge.isDocumentKey(i)||(i=i.child(""));const a=new Tt(new ge(i),0);let l=new Vt(Fe);return this.br.forEachWhile(c=>{const h=c.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(l=l.add(c.wr)),!0)},a),Y.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){We(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Y.forEach(n.mutations,s=>{const i=new Tt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Tt(n,0),s=this.br.firstAfterOrEqual(r);return Y.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT{constructor(e){this.Mr=e,this.docs=function(){return new ot(ge.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return Y.resolve(r?r.document.mutableCopy():qt.newInvalidDocument(n))}getEntries(e,n){let r=Ir();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():qt.newInvalidDocument(s))}),Y.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Ir();const a=n.path,l=new ge(a.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:h,value:{document:p}}=c.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||yS(mS(p),r)<=0||(s.has(p.key)||bu(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return Y.resolve(i)}getAllFromCollectionGroup(e,n,r,s){_e()}Or(e,n){return Y.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new VT(this)}getSize(e){return Y.resolve(this.size)}}class VT extends kT{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),Y.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e){this.persistence=e,this.Nr=new eo(n=>nf(n),rf),this.lastRemoteSnapshotVersion=Te.min(),this.highestTargetId=0,this.Lr=0,this.Br=new cf,this.targetCount=0,this.kr=qi.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),Y.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new qi(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,Y.resolve()}updateTargetData(e,n){return this.Kn(n),Y.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),Y.waitFor(i).next(()=>s)}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return Y.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),Y.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),Y.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),Y.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return Y.resolve(r)}containsKey(e,n){return Y.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Jh(0),this.Kr=!1,this.Kr=!0,this.$r=new DT,this.referenceDelegate=e(this),this.Ur=new LT(this),this.indexManager=new CT,this.remoteDocumentCache=function(s){return new MT(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new ET(n),this.Gr=new PT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new jT,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new NT(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){de("MemoryPersistence","Starting transaction:",e);const s=new OT(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return Y.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class OT extends xS{constructor(e){super(),this.currentSequenceNumber=e}}class df{constructor(e){this.persistence=e,this.Jr=new cf,this.Yr=null}static Zr(e){return new df(e)}get Xr(){if(this.Yr)return this.Yr;throw _e()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),Y.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),Y.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),Y.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.Xr,r=>{const s=ge.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,Te.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return Y.or([()=>Y.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Pe(),s=Pe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new hf(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return $_()?8:_S(B_())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new zT;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(wo()<=Ne.DEBUG&&de("QueryEngine","SDK will not create cache indexes for query:",fi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Y.resolve()):(wo()<=Ne.DEBUG&&de("QueryEngine","Query:",fi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(wo()<=Ne.DEBUG&&de("QueryEngine","The SDK decides to create cache indexes for query:",fi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,er(n))):Y.resolve())}Yi(e,n){if(Ag(n))return Y.resolve(null);let r=er(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=zd(n,null,"F"),r=er(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=Pe(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const h=this.ts(n,l);return this.ns(n,h,a,c.readTime)?this.Yi(e,zd(n,null,"F")):this.rs(e,h,n,c)}))})))}Zi(e,n,r,s){return Ag(n)||s.isEqual(Te.min())?Y.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?Y.resolve(null):(wo()<=Ne.DEBUG&&de("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),fi(n)),this.rs(e,a,n,gS(s,-1)).next(l=>l))})}ts(e,n){let r=new Vt(K0(e));return n.forEach((s,i)=>{bu(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return wo()<=Ne.DEBUG&&de("QueryEngine","Using full collection scan to execute query:",fi(n)),this.Ji.getDocumentsMatchingQuery(e,n,os.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new ot(Fe),this._s=new eo(i=>nf(i),rf),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bT(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function $T(t,e,n,r){return new UT(t,e,n,r)}async function yv(t,e){const n=Ee(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let c=Pe();for(const h of s){a.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}for(const h of i){l.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}return n.localDocuments.getDocuments(r,c).next(h=>({hs:h,removedBatchIds:a,addedBatchIds:l}))})})}function WT(t,e){const n=Ee(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,h,p){const y=h.batch,m=y.keys();let I=Y.resolve();return m.forEach(A=>{I=I.next(()=>p.getEntry(c,A)).next(P=>{const z=h.docVersions.get(A);We(z!==null),P.version.compareTo(z)<0&&(y.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),p.addEntry(P)))})}),I.next(()=>l.mutationQueue.removeMutationBatch(c,y))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Pe();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(c=c.add(l.batch.mutations[h].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function vv(t){const e=Ee(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function HT(t,e){const n=Ee(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((p,y)=>{const m=s.get(y);if(!m)return;l.push(n.Ur.removeMatchingKeys(i,p.removedDocuments,y).next(()=>n.Ur.addMatchingKeys(i,p.addedDocuments,y)));let I=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(y)!==null?I=I.withResumeToken(Ft.EMPTY_BYTE_STRING,Te.min()).withLastLimboFreeSnapshotVersion(Te.min()):p.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(p.resumeToken,r)),s=s.insert(y,I),function(P,z,k){return P.resumeToken.approximateByteSize()===0||z.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(m,I,p)&&l.push(n.Ur.updateTargetData(i,I))});let c=Ir(),h=Pe();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),l.push(qT(i,a,e.documentUpdates).next(p=>{c=p.Ps,h=p.Is})),!r.isEqual(Te.min())){const p=n.Ur.getLastRemoteSnapshotVersion(i).next(y=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(p)}return Y.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,h)).next(()=>c)}).then(i=>(n.os=s,i))}function qT(t,e,n){let r=Pe(),s=Pe();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=Ir();return n.forEach((l,c)=>{const h=i.get(l);c.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(Te.min())?(e.removeEntry(l,c.readTime),a=a.insert(l,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),a=a.insert(l,c)):de("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",c.version)}),{Ps:a,Is:s}})}function GT(t,e){const n=Ee(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function QT(t,e){const n=Ee(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,Y.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new Hr(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Hd(t,e,n){const r=Ee(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Ea(a))throw a;de("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Fg(t,e,n){const r=Ee(t);let s=Te.min(),i=Pe();return r.persistence.runTransaction("Execute query","readwrite",a=>function(c,h,p){const y=Ee(c),m=y._s.get(p);return m!==void 0?Y.resolve(y.os.get(m)):y.Ur.getTargetData(h,p)}(r,a,er(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:Te.min(),n?i:Pe())).next(l=>(KT(r,FS(e),l),{documents:l,Ts:i})))}function KT(t,e,n){let r=t.us.get(e)||Te.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Og{constructor(){this.activeTargetIds=WS()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class YT{constructor(){this.so=new Og,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Og,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){de("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){de("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hl=null;function bc(){return hl===null?hl=function(){return 268435456+Math.round(2147483648*Math.random())}():hl++,"0x"+hl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wt="WebChannelConnection";class eE extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=bc(),c=this.xo(n,r.toUriEncodedString());de("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,a),this.No(n,c,h,s).then(p=>(de("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw ca("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",c,"request:",s),p})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Zi}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=JT[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=bc();return new Promise((a,l)=>{const c=new j0;c.setWithCredentials(!0),c.listenOnce(D0.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Il.NO_ERROR:const p=c.getResponseJson();de(Wt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(p)),a(p);break;case Il.TIMEOUT:de(Wt,`RPC '${e}' ${i} timed out`),l(new oe(W.DEADLINE_EXCEEDED,"Request time out"));break;case Il.HTTP_ERROR:const y=c.getStatus();if(de(Wt,`RPC '${e}' ${i} failed with status:`,y,"response text:",c.getResponseText()),y>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const I=m==null?void 0:m.error;if(I&&I.status&&I.message){const A=function(z){const k=z.toLowerCase().replace(/_/g,"-");return Object.values(W).indexOf(k)>=0?k:W.UNKNOWN}(I.status);l(new oe(A,I.message))}else l(new oe(W.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new oe(W.UNAVAILABLE,"Connection failed."));break;default:_e()}}finally{de(Wt,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);de(Wt,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=bc(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=V0(),l=M0(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const p=i.join("");de(Wt,`Creating RPC '${e}' stream ${s}: ${p}`,c);const y=a.createWebChannel(p,c);let m=!1,I=!1;const A=new ZT({Io:z=>{I?de(Wt,`Not sending because RPC '${e}' stream ${s} is closed:`,z):(m||(de(Wt,`Opening RPC '${e}' stream ${s} transport.`),y.open(),m=!0),de(Wt,`RPC '${e}' stream ${s} sending:`,z),y.send(z))},To:()=>y.close()}),P=(z,k,S)=>{z.listen(k,T=>{try{S(T)}catch(M){setTimeout(()=>{throw M},0)}})};return P(y,Co.EventType.OPEN,()=>{I||(de(Wt,`RPC '${e}' stream ${s} transport opened.`),A.yo())}),P(y,Co.EventType.CLOSE,()=>{I||(I=!0,de(Wt,`RPC '${e}' stream ${s} transport closed`),A.So())}),P(y,Co.EventType.ERROR,z=>{I||(I=!0,ca(Wt,`RPC '${e}' stream ${s} transport errored:`,z),A.So(new oe(W.UNAVAILABLE,"The operation could not be completed")))}),P(y,Co.EventType.MESSAGE,z=>{var k;if(!I){const S=z.data[0];We(!!S);const T=S,M=T.error||((k=T[0])===null||k===void 0?void 0:k.error);if(M){de(Wt,`RPC '${e}' stream ${s} received error:`,M);const H=M.status;let F=function(_){const E=mt[_];if(E!==void 0)return av(E)}(H),w=M.message;F===void 0&&(F=W.INTERNAL,w="Unknown error status: "+H+" with message "+M.message),I=!0,A.So(new oe(F,w)),y.close()}else de(Wt,`RPC '${e}' stream ${s} received:`,S),A.bo(S)}}),P(l,N0.STAT_EVENT,z=>{z.stat===Nd.PROXY?de(Wt,`RPC '${e}' stream ${s} detected buffering proxy`):z.stat===Nd.NOPROXY&&de(Wt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{A.wo()},0),A}}function Pc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nu(t){return new cT(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&de("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e,n,r,s,i,a,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new xv(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===W.RESOURCE_EXHAUSTED?(Er(n.toString()),Er("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===W.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new oe(W.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return de("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(de("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class tE extends _v{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=fT(this.serializer,e),r=function(i){if(!("targetChange"in i))return Te.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Te.min():a.readTime?tr(a.readTime):Te.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Wd(this.serializer),n.addTarget=function(i,a){let l;const c=a.target;if(l=Fd(c)?{documents:mT(i,c)}:{query:yT(i,c)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=cv(i,a.resumeToken);const h=Bd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(Te.min())>0){l.readTime=ou(i,a.snapshotVersion.toTimestamp());const h=Bd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=xT(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Wd(this.serializer),n.removeTarget=e,this.a_(n)}}class nE extends _v{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return We(!!e.streamToken),this.lastStreamToken=e.streamToken,We(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){We(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=gT(e.writeResults,e.commitTime),r=tr(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Wd(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>pT(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new oe(W.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,Ud(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new oe(W.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,Ud(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new oe(W.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class sE{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Er(n),this.D_=!1):de("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{qs(this)&&(de("RemoteStore","Restarting streams for network reachability change."),await async function(c){const h=Ee(c);h.L_.add(4),await ka(h),h.q_.set("Unknown"),h.L_.delete(4),await Mu(h)}(this))})}),this.q_=new sE(r,s)}}async function Mu(t){if(qs(t))for(const e of t.B_)await e(!0)}async function ka(t){for(const e of t.B_)await e(!1)}function wv(t,e){const n=Ee(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),mf(n)?gf(n):to(n).r_()&&pf(n,e))}function ff(t,e){const n=Ee(t),r=to(n);n.N_.delete(e),r.r_()&&Sv(n,e),n.N_.size===0&&(r.r_()?r.o_():qs(n)&&n.q_.set("Unknown"))}function pf(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Te.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}to(t).A_(e)}function Sv(t,e){t.Q_.xe(e),to(t).R_(e)}function gf(t){t.Q_=new oT({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),to(t).start(),t.q_.v_()}function mf(t){return qs(t)&&!to(t).n_()&&t.N_.size>0}function qs(t){return Ee(t).L_.size===0}function Tv(t){t.Q_=void 0}async function oE(t){t.q_.set("Online")}async function aE(t){t.N_.forEach((e,n)=>{pf(t,e)})}async function lE(t,e){Tv(t),mf(t)?(t.q_.M_(e),gf(t)):t.q_.set("Unknown")}async function uE(t,e,n){if(t.q_.set("Online"),e instanceof uv&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){de("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await au(t,r)}else if(e instanceof kl?t.Q_.Ke(e):e instanceof lv?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Te.min()))try{const r=await vv(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const p=i.N_.get(h);p&&i.N_.set(h,p.withResumeToken(c.resumeToken,a))}}),l.targetMismatches.forEach((c,h)=>{const p=i.N_.get(c);if(!p)return;i.N_.set(c,p.withResumeToken(Ft.EMPTY_BYTE_STRING,p.snapshotVersion)),Sv(i,c);const y=new Hr(p.target,c,h,p.sequenceNumber);pf(i,y)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){de("RemoteStore","Failed to raise snapshot:",r),await au(t,r)}}async function au(t,e,n){if(!Ea(e))throw e;t.L_.add(1),await ka(t),t.q_.set("Offline"),n||(n=()=>vv(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{de("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Mu(t)})}function Ev(t,e){return e().catch(n=>au(t,n,e))}async function Vu(t){const e=Ee(t),n=ls(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;cE(e);)try{const s=await GT(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,dE(e,s)}catch(s){await au(e,s)}Iv(e)&&Cv(e)}function cE(t){return qs(t)&&t.O_.length<10}function dE(t,e){t.O_.push(e);const n=ls(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Iv(t){return qs(t)&&!ls(t).n_()&&t.O_.length>0}function Cv(t){ls(t).start()}async function hE(t){ls(t).p_()}async function fE(t){const e=ls(t);for(const n of t.O_)e.m_(n.mutations)}async function pE(t,e,n){const r=t.O_.shift(),s=af.from(r,e,n);await Ev(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Vu(t)}async function gE(t,e){e&&ls(t).V_&&await async function(r,s){if(function(a){return rT(a)&&a!==W.ABORTED}(s.code)){const i=r.O_.shift();ls(r).s_(),await Ev(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Vu(r)}}(t,e),Iv(t)&&Cv(t)}async function Bg(t,e){const n=Ee(t);n.asyncQueue.verifyOperationInProgress(),de("RemoteStore","RemoteStore received new credentials");const r=qs(n);n.L_.add(3),await ka(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Mu(n)}async function mE(t,e){const n=Ee(t);e?(n.L_.delete(2),await Mu(n)):e||(n.L_.add(2),await ka(n),n.q_.set("Unknown"))}function to(t){return t.K_||(t.K_=function(n,r,s){const i=Ee(n);return i.w_(),new tE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:oE.bind(null,t),Ro:aE.bind(null,t),mo:lE.bind(null,t),d_:uE.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),mf(t)?gf(t):t.q_.set("Unknown")):(await t.K_.stop(),Tv(t))})),t.K_}function ls(t){return t.U_||(t.U_=function(n,r,s){const i=Ee(n);return i.w_(),new nE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:hE.bind(null,t),mo:gE.bind(null,t),f_:fE.bind(null,t),g_:pE.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Vu(t)):(await t.U_.stop(),t.O_.length>0&&(de("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new vr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new yf(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new oe(W.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vf(t,e){if(Er("AsyncQueue",`${e}: ${t}`),Ea(t))return new oe(W.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ge.comparator(n.key,r.key):(n,r)=>ge.comparator(n.key,r.key),this.keyedMap=Ao(),this.sortedSet=new ot(this.comparator)}static emptySet(e){return new Ni(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ni)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ni;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(){this.W_=new ot(ge.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):_e():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Gi{constructor(e,n,r,s,i,a,l,c,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new Gi(e,n,Ni.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ru(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yE{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class vE{constructor(){this.queries=$g(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=Ee(n),i=s.queries;s.queries=$g(),i.forEach((a,l)=>{for(const c of l.j_)c.onError(r)})})(this,new oe(W.ABORTED,"Firestore shutting down"))}}function $g(){return new eo(t=>Q0(t),Ru)}async function Av(t,e){const n=Ee(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new yE,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=vf(a,`Initialization of query '${fi(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&xf(n)}async function kv(t,e){const n=Ee(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function xE(t,e){const n=Ee(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&xf(n)}function _E(t,e,n){const r=Ee(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function xf(t){t.Y_.forEach(e=>{e.next()})}var qd,Wg;(Wg=qd||(qd={})).ea="default",Wg.Cache="cache";class Rv{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Gi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Gi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==qd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(e){this.key=e}}class Pv{constructor(e){this.key=e}}class wE{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Pe(),this.mutatedKeys=Pe(),this.Aa=K0(e),this.Ra=new Ni(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Ug,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,y)=>{const m=s.get(p),I=bu(this.query,y)?y:null,A=!!m&&this.mutatedKeys.has(m.key),P=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let z=!1;m&&I?m.data.isEqual(I.data)?A!==P&&(r.track({type:3,doc:I}),z=!0):this.ga(m,I)||(r.track({type:2,doc:I}),z=!0,(c&&this.Aa(I,c)>0||h&&this.Aa(I,h)<0)&&(l=!0)):!m&&I?(r.track({type:0,doc:I}),z=!0):m&&!I&&(r.track({type:1,doc:m}),z=!0,(c||h)&&(l=!0)),z&&(I?(a=a.add(I),i=P?i.add(p):i.delete(p)):(a=a.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((p,y)=>function(I,A){const P=z=>{switch(z){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _e()}};return P(I)-P(A)}(p.type,y.type)||this.Aa(p.doc,y.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,h=c!==this.Ea;return this.Ea=c,a.length!==0||h?{snapshot:new Gi(this.query,e.Ra,i,a,e.mutatedKeys,c===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ug,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Pe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Pv(r))}),this.da.forEach(r=>{e.has(r)||n.push(new bv(r))}),n}ba(e){this.Ta=e.Ts,this.da=Pe();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Gi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class SE{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class TE{constructor(e){this.key=e,this.va=!1}}class EE{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new eo(l=>Q0(l),Ru),this.Ma=new Map,this.xa=new Set,this.Oa=new ot(ge.comparator),this.Na=new Map,this.La=new cf,this.Ba={},this.ka=new Map,this.qa=qi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function IE(t,e,n=!0){const r=Lv(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await jv(r,e,n,!0),s}async function CE(t,e){const n=Lv(t);await jv(n,e,!0,!1)}async function jv(t,e,n,r){const s=await QT(t.localStore,er(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await AE(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&wv(t.remoteStore,s),l}async function AE(t,e,n,r,s){t.Ka=(y,m,I)=>async function(P,z,k,S){let T=z.view.ma(k);T.ns&&(T=await Fg(P.localStore,z.query,!1).then(({documents:w})=>z.view.ma(w,T)));const M=S&&S.targetChanges.get(z.targetId),H=S&&S.targetMismatches.get(z.targetId)!=null,F=z.view.applyChanges(T,P.isPrimaryClient,M,H);return qg(P,z.targetId,F.wa),F.snapshot}(t,y,m,I);const i=await Fg(t.localStore,e,!0),a=new wE(e,i.Ts),l=a.ma(i.documents),c=Aa.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=a.applyChanges(l,t.isPrimaryClient,c);qg(t,n,h.wa);const p=new SE(e,n,a);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function kE(t,e,n){const r=Ee(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!Ru(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Hd(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&ff(r.remoteStore,s.targetId),Gd(r,s.targetId)}).catch(Ta)):(Gd(r,s.targetId),await Hd(r.localStore,s.targetId,!0))}async function RE(t,e){const n=Ee(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ff(n.remoteStore,r.targetId))}async function bE(t,e,n){const r=LE(t);try{const s=await function(a,l){const c=Ee(a),h=St.now(),p=l.reduce((I,A)=>I.add(A.key),Pe());let y,m;return c.persistence.runTransaction("Locally write mutations","readwrite",I=>{let A=Ir(),P=Pe();return c.cs.getEntries(I,p).next(z=>{A=z,A.forEach((k,S)=>{S.isValidDocument()||(P=P.add(k))})}).next(()=>c.localDocuments.getOverlayedDocuments(I,A)).next(z=>{y=z;const k=[];for(const S of l){const T=JS(S,y.get(S.key).overlayedDocument);T!=null&&k.push(new hs(S.key,T,z0(T.value.mapValue),Un.exists(!0)))}return c.mutationQueue.addMutationBatch(I,h,k,l)}).next(z=>{m=z;const k=z.applyToLocalDocumentSet(y,P);return c.documentOverlayCache.saveOverlays(I,z.batchId,k)})}).then(()=>({batchId:m.batchId,changes:X0(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,c){let h=a.Ba[a.currentUser.toKey()];h||(h=new ot(Fe)),h=h.insert(l,c),a.Ba[a.currentUser.toKey()]=h}(r,s.batchId,n),await Ra(r,s.changes),await Vu(r.remoteStore)}catch(s){const i=vf(s,"Failed to persist write");n.reject(i)}}async function Dv(t,e){const n=Ee(t);try{const r=await HT(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(We(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?We(a.va):s.removedDocuments.size>0&&(We(a.va),a.va=!1))}),await Ra(n,r,e)}catch(r){await Ta(r)}}function Hg(t,e,n){const r=Ee(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const c=Ee(a);c.onlineState=l;let h=!1;c.queries.forEach((p,y)=>{for(const m of y.j_)m.Z_(l)&&(h=!0)}),h&&xf(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function PE(t,e,n){const r=Ee(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new ot(ge.comparator);a=a.insert(i,qt.newNoDocument(i,Te.min()));const l=Pe().add(i),c=new Du(Te.min(),new Map,new ot(Fe),a,l);await Dv(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),_f(r)}else await Hd(r.localStore,e,!1).then(()=>Gd(r,e,n)).catch(Ta)}async function jE(t,e){const n=Ee(t),r=e.batch.batchId;try{const s=await WT(n.localStore,e);Mv(n,r,null),Nv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ra(n,s)}catch(s){await Ta(s)}}async function DE(t,e,n){const r=Ee(t);try{const s=await function(a,l){const c=Ee(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return c.mutationQueue.lookupMutationBatch(h,l).next(y=>(We(y!==null),p=y.keys(),c.mutationQueue.removeMutationBatch(h,y))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>c.localDocuments.getDocuments(h,p))})}(r.localStore,e);Mv(r,e,n),Nv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ra(r,s)}catch(s){await Ta(s)}}function Nv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Mv(t,e,n){const r=Ee(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Gd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Vv(t,r)})}function Vv(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(ff(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),_f(t))}function qg(t,e,n){for(const r of n)r instanceof bv?(t.La.addReference(r.key,e),NE(t,r)):r instanceof Pv?(de("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Vv(t,r.key)):_e()}function NE(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(de("SyncEngine","New document in limbo: "+n),t.xa.add(r),_f(t))}function _f(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ge(Je.fromString(e)),r=t.qa.next();t.Na.set(r,new TE(n)),t.Oa=t.Oa.insert(n,r),wv(t.remoteStore,new Hr(er(sf(n.path)),r,"TargetPurposeLimboResolution",Jh.oe))}}async function Ra(t,e,n){const r=Ee(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{a.push(r.Ka(c,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const y=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,y?"current":"not-current")}if(h){s.push(h);const y=hf.Wi(c.targetId,h);i.push(y)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(c,h){const p=Ee(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>Y.forEach(h,m=>Y.forEach(m.$i,I=>p.persistence.referenceDelegate.addReference(y,m.targetId,I)).next(()=>Y.forEach(m.Ui,I=>p.persistence.referenceDelegate.removeReference(y,m.targetId,I)))))}catch(y){if(!Ea(y))throw y;de("LocalStore","Failed to update sequence numbers: "+y)}for(const y of h){const m=y.targetId;if(!y.fromCache){const I=p.os.get(m),A=I.snapshotVersion,P=I.withLastLimboFreeSnapshotVersion(A);p.os=p.os.insert(m,P)}}}(r.localStore,i))}async function ME(t,e){const n=Ee(t);if(!n.currentUser.isEqual(e)){de("SyncEngine","User change. New user:",e.toKey());const r=await yv(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new oe(W.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ra(n,r.hs)}}function VE(t,e){const n=Ee(t),r=n.Na.get(e);if(r&&r.va)return Pe().add(r.key);{let s=Pe();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}function Lv(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Dv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=VE.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=PE.bind(null,e),e.Ca.d_=xE.bind(null,e.eventManager),e.Ca.$a=_E.bind(null,e.eventManager),e}function LE(t){const e=Ee(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jE.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DE.bind(null,e),e}class lu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Nu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return $T(this.persistence,new BT,e.initialUser,this.serializer)}Ga(e){return new FT(df.Zr,this.serializer)}Wa(e){return new YT}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}lu.provider={build:()=>new lu};class Qd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Hg(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=ME.bind(null,this.syncEngine),await mE(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new vE}()}createDatastore(e){const n=Nu(e.databaseInfo.databaseId),r=function(i){return new eE(i)}(e.databaseInfo);return function(i,a,l,c){return new rE(i,a,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new iE(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Hg(this.syncEngine,n,0),function(){return zg.D()?new zg:new XT}())}createSyncEngine(e,n){return function(s,i,a,l,c,h,p){const y=new EE(s,i,a,l,c,h);return p&&(y.Qa=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Ee(s);de("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await ka(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Qd.provider={build:()=>new Qd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Er("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=en.UNAUTHENTICATED,this.clientId=L0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{de("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(de("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=vf(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function jc(t,e){t.asyncQueue.verifyOperationInProgress(),de("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await yv(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Gg(t,e){t.asyncQueue.verifyOperationInProgress();const n=await OE(t);de("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Bg(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Bg(e.remoteStore,s)),t._onlineComponents=e}async function OE(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){de("FirestoreClient","Using user provided OfflineComponentProvider");try{await jc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===W.FAILED_PRECONDITION||s.code===W.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;ca("Error using user provided cache. Falling back to memory cache: "+n),await jc(t,new lu)}}else de("FirestoreClient","Using default OfflineComponentProvider"),await jc(t,new lu);return t._offlineComponents}async function Ov(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(de("FirestoreClient","Using user provided OnlineComponentProvider"),await Gg(t,t._uninitializedComponentsProvider._online)):(de("FirestoreClient","Using default OnlineComponentProvider"),await Gg(t,new Qd))),t._onlineComponents}function zE(t){return Ov(t).then(e=>e.syncEngine)}async function zv(t){const e=await Ov(t),n=e.eventManager;return n.onListen=IE.bind(null,e.syncEngine),n.onUnlisten=kE.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=CE.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=RE.bind(null,e.syncEngine),n}function BE(t,e,n={}){const r=new vr;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,h){const p=new Fv({next:m=>{p.Za(),a.enqueueAndForget(()=>kv(i,y));const I=m.docs.has(l);!I&&m.fromCache?h.reject(new oe(W.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&m.fromCache&&c&&c.source==="server"?h.reject(new oe(W.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(m)},error:m=>h.reject(m)}),y=new Rv(sf(l.path),p,{includeMetadataChanges:!0,_a:!0});return Av(i,y)}(await zv(t),t.asyncQueue,e,n,r)),r.promise}function UE(t,e,n={}){const r=new vr;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,h){const p=new Fv({next:m=>{p.Za(),a.enqueueAndForget(()=>kv(i,y)),m.fromCache&&c.source==="server"?h.reject(new oe(W.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(m)},error:m=>h.reject(m)}),y=new Rv(l,p,{includeMetadataChanges:!0,_a:!0});return Av(i,y)}(await zv(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bv(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uv(t,e,n){if(!n)throw new oe(W.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $E(t,e,n,r){if(e===!0&&r===!0)throw new oe(W.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Kg(t){if(!ge.isDocumentKey(t))throw new oe(W.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Yg(t){if(ge.isDocumentKey(t))throw new oe(W.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Lu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":_e()}function Cr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new oe(W.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Lu(t);throw new oe(W.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new oe(W.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new oe(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$E("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Bv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new oe(W.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new oe(W.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new oe(W.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wf{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xg({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new oe(W.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new oe(W.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new aS;switch(r.type){case"firstParty":return new cS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new oe(W.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Qg.get(n);r&&(de("ComponentProvider","Removing Datastore"),Qg.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new no(this.firestore,e,this._query)}}class Xt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new rs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xt(this.firestore,e,this._key)}}class rs extends no{constructor(e,n,r){super(e,n,sf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xt(this.firestore,null,new ge(e))}withConverter(e){return new rs(this.firestore,e,this._path)}}function fr(t,e,...n){if(t=Wn(t),Uv("collection","path",e),t instanceof wf){const r=Je.fromString(e,...n);return Yg(r),new rs(t,null,r)}{if(!(t instanceof Xt||t instanceof rs))throw new oe(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Je.fromString(e,...n));return Yg(r),new rs(t.firestore,null,r)}}function Dt(t,e,...n){if(t=Wn(t),arguments.length===1&&(e=L0.newId()),Uv("doc","path",e),t instanceof wf){const r=Je.fromString(e,...n);return Kg(r),new Xt(t,null,new ge(r))}{if(!(t instanceof Xt||t instanceof rs))throw new oe(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Je.fromString(e,...n));return Kg(r),new Xt(t.firestore,t instanceof rs?t.converter:null,new ge(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new xv(this,"async_queue_retry"),this.Vu=()=>{const r=Pc();r&&de("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Pc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Pc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new vr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ea(e))throw e;de("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw Er("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=yf.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&_e()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class ro extends wf{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Jg,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Jg(e),this._firestoreClient=void 0,await e}}}function WE(t,e,n){n||(n="(default)");const r=A0(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(eu(i,e))return s;throw new oe(W.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new oe(W.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new oe(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function Sf(t){if(t._terminated)throw new oe(W.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||HE(t),t._firestoreClient}function HE(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,h,p){return new TS(l,c,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Bv(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new FE(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qi(Ft.fromBase64String(e))}catch(n){throw new oe(W.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Qi(Ft.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new oe(W.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Nt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new oe(W.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new oe(W.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Fe(this._lat,e._lat)||Fe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qE=/^__.*__$/;class GE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new hs(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ca(e,this.data,n,this.fieldTransforms)}}class $v{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new hs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Wv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _e()}}class If{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new If(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return uu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Wv(this.Cu)&&qE.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class QE{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Nu(e)}Qu(e,n,r,s=!1){return new If({Cu:e,methodName:n,qu:r,path:Nt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zu(t){const e=t._freezeSettings(),n=Nu(t._databaseId);return new QE(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Hv(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);Af("Data must be an object, but it was:",a,r);const l=qv(r,a);let c,h;if(i.merge)c=new fn(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const p=[];for(const y of i.mergeFields){const m=Kd(e,y,n);if(!a.contains(m))throw new oe(W.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Qv(p,m)||p.push(m)}c=new fn(p),h=a.fieldTransforms.filter(y=>c.covers(y.field))}else c=null,h=a.fieldTransforms;return new GE(new nn(l),c,h)}class Bu extends Ou{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Bu}}class Cf extends Ou{_toFieldTransform(e){return new QS(e.path,new ga)}isEqual(e){return e instanceof Cf}}function KE(t,e,n,r){const s=t.Qu(1,e,n);Af("Data must be an object, but it was:",s,r);const i=[],a=nn.empty();Hs(r,(c,h)=>{const p=kf(e,c,n);h=Wn(h);const y=s.Nu(p);if(h instanceof Bu)i.push(p);else{const m=ba(h,y);m!=null&&(i.push(p),a.set(p,m))}});const l=new fn(i);return new $v(a,l,s.fieldTransforms)}function YE(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[Kd(e,r,n)],c=[s];if(i.length%2!=0)throw new oe(W.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(Kd(e,i[m])),c.push(i[m+1]);const h=[],p=nn.empty();for(let m=l.length-1;m>=0;--m)if(!Qv(h,l[m])){const I=l[m];let A=c[m];A=Wn(A);const P=a.Nu(I);if(A instanceof Bu)h.push(I);else{const z=ba(A,P);z!=null&&(h.push(I),p.set(I,z))}}const y=new fn(h);return new $v(p,y,a.fieldTransforms)}function XE(t,e,n,r=!1){return ba(n,t.Qu(r?4:3,e))}function ba(t,e){if(Gv(t=Wn(t)))return Af("Unsupported field value:",e,t),qv(t,e);if(t instanceof Ou)return function(r,s){if(!Wv(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let c=ba(l,s.Lu(a));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Wn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return HS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=St.fromDate(r);return{timestampValue:ou(s.serializer,i)}}if(r instanceof St){const i=new St(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ou(s.serializer,i)}}if(r instanceof Tf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Qi)return{bytesValue:cv(s.serializer,r._byteString)};if(r instanceof Xt){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:uf(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Ef)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return of(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Lu(r)}`)}(t,e)}function qv(t,e){const n={};return F0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hs(t,(r,s)=>{const i=ba(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Gv(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof St||t instanceof Tf||t instanceof Qi||t instanceof Xt||t instanceof Ou||t instanceof Ef)}function Af(t,e,n){if(!Gv(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Lu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Kd(t,e,n){if((e=Wn(e))instanceof Fu)return e._internalPath;if(typeof e=="string")return kf(t,e);throw uu("Field path arguments must be of type string or ",t,!1,void 0,n)}const JE=new RegExp("[~\\*/\\[\\]]");function kf(t,e,n){if(e.search(JE)>=0)throw uu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Fu(...e.split("."))._internalPath}catch{throw uu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function uu(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||a)&&(c+=" (found",i&&(c+=` in field ${r}`),a&&(c+=` in document ${s}`),c+=")"),new oe(W.INVALID_ARGUMENT,l+t+c)}function Qv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Xt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ZE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Rf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class ZE extends Kv{data(){return super.data()}}function Rf(t,e){return typeof e=="string"?kf(t,e):e instanceof Fu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new oe(W.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class bf{}class tI extends bf{}function nI(t,e,...n){let r=[];e instanceof bf&&r.push(e),r=r.concat(n),function(i){const a=i.filter(c=>c instanceof Pf).length,l=i.filter(c=>c instanceof Uu).length;if(a>1||a>0&&l>0)throw new oe(W.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Uu extends tI{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Uu(e,n,r)}_apply(e){const n=this._parse(e);return Yv(e._query,n),new no(e.firestore,e.converter,Od(e._query,n))}_parse(e){const n=zu(e.firestore);return function(i,a,l,c,h,p,y){let m;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new oe(W.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){tm(y,p);const I=[];for(const A of y)I.push(em(c,i,A));m={arrayValue:{values:I}}}else m=em(c,i,y)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||tm(y,p),m=XE(l,a,y,p==="in"||p==="not-in");return vt.create(h,p,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Zg(t,e,n){const r=e,s=Rf("where",t);return Uu._create(s,r,n)}class Pf extends bf{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Pf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Hn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const c of l)Yv(a,c),a=Od(a,c)}(e._query,n),new no(e.firestore,e.converter,Od(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function em(t,e,n){if(typeof(n=Wn(n))=="string"){if(n==="")throw new oe(W.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!G0(e)&&n.indexOf("/")!==-1)throw new oe(W.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Je.fromString(n));if(!ge.isDocumentKey(r))throw new oe(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return wg(t,new ge(r))}if(n instanceof Xt)return wg(t,n._key);throw new oe(W.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Lu(n)}.`)}function tm(t,e){if(!Array.isArray(t)||t.length===0)throw new oe(W.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Yv(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new oe(W.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new oe(W.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class rI{convertValue(e,n="none"){switch(Us(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Bs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw _e()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Hs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>dt(a.doubleValue));return new Ef(i)}convertGeoPoint(e){return new Tf(dt(e.latitude),dt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=ef(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ha(e));default:return null}}convertTimestamp(e){const n=as(e);return new St(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Je.fromString(e);We(mv(r));const s=new fa(r.get(1),r.get(3)),i=new ge(r.popFirst(5));return s.isEqual(n)||Er(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xv(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Jv extends Kv{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Rl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Rf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Rl extends Jv{data(e={}){return super.data(e)}}class sI{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ro(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Rl(this._firestore,this._userDataWriter,r.key,r,new Ro(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new oe(W.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const c=new Rl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Ro(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new Rl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Ro(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,p=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:iI(l.type),doc:c,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function iI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _e()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wo(t){t=Cr(t,Xt);const e=Cr(t.firestore,ro);return BE(Sf(e),t._key).then(n=>oI(e,t,n))}class Zv extends rI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qi(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Xt(this.firestore,null,n)}}function bo(t){t=Cr(t,no);const e=Cr(t.firestore,ro),n=Sf(e),r=new Zv(e);return eI(t._query),UE(n,t._query).then(s=>new sI(e,r,t,s))}function Yd(t,e,n){t=Cr(t,Xt);const r=Cr(t.firestore,ro),s=Xv(t.converter,e,n);return jf(r,[Hv(zu(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Un.none())])}function pr(t,e,n,...r){t=Cr(t,Xt);const s=Cr(t.firestore,ro),i=zu(s);let a;return a=typeof(e=Wn(e))=="string"||e instanceof Fu?YE(i,"updateDoc",t._key,e,n,r):KE(i,"updateDoc",t._key,e),jf(s,[a.toMutation(t._key,Un.exists(!0))])}function cu(t,e){const n=Cr(t.firestore,ro),r=Dt(t),s=Xv(t.converter,e);return jf(n,[Hv(zu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Un.exists(!1))]).then(()=>r)}function jf(t,e){return function(r,s){const i=new vr;return r.asyncQueue.enqueueAndForget(async()=>bE(await zE(r),s,i)),i.promise}(Sf(t),e)}function oI(t,e,n){const r=n.docs.get(e._key),s=new Zv(t);return new Jv(t,s,e._key,r,new Ro(n.hasPendingWrites,n.fromCache),e.converter)}function Tn(){return new Cf("serverTimestamp")}(function(e,n=!0){(function(s){Zi=s})(Gw),la(new Ui("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new ro(new lS(r.getProvider("auth-internal")),new hS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new oe(W.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new fa(h.options.projectId,p)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),ns(mg,"4.7.3",e),ns(mg,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd="us-central1";class lI{constructor(e,n,r,s,i=Xd,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new aI(n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Xd}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function uI(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const nm="@firebase/functions",rm="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI="auth-internal",dI="app-check-internal",hI="messaging-internal";function fI(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),a=r.getProvider(cI),l=r.getProvider(hI),c=r.getProvider(dI);return new lI(i,a,l,c,s,t)};la(new Ui(ex,n,"PUBLIC").setMultipleInstances(!0)),ns(nm,rm,e),ns(nm,rm,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(t=Qw(),e=Xd){const r=A0(Wn(t),ex).getImmediate({identifier:e}),s=O_("functions");return s&&gI(r,...s),r}function gI(t,e,n){uI(Wn(t),e,n)}fI(fetch.bind(self));const mI={apiKey:'"AIzaSyDRdl4zhwoZumVtphmJ19orZ8HoR0WQQZM",',authDomain:'"qualtrics-game-backend.firebaseapp.com",',projectId:'"qualtrics-game-backend",',storageBucket:'"qualtrics-game-backend.firebasestorage.app",',messagingSenderId:'"441267092549",',appId:"1:441267092549:web:6ce075f5f3ea7cf958772c"},tx=k0(mI),Xe=WE(tx,{experimentalForceLongPolling:!1,useFetchStreams:!1});pI(tx);const hi=[],Ue={init(){localStorage.getItem("sessionId")||(localStorage.setItem("sessionId",this.generateSessionId()),localStorage.setItem("sessionStartTime",Date.now().toString())),localStorage.getItem("semesterStartTime")||localStorage.setItem("semesterStartTime",Date.now().toString()),window.addEventListener("beforeunload",()=>{this.flushPendingEvents()}),window.addEventListener("pagehide",()=>{this.flushPendingEvents()})},async flushPendingEvents(){if(hi.length===0)return;const t=[...hi];hi.length=0;for(const e of t)try{await cu(fr(Xe,"events"),e)}catch(n){console.error("Failed to flush pending event:",n),hi.push(e)}},generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},async logEvent(t,e){const n=localStorage.getItem("sessionId")||this.generateSessionId(),r=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),s=Date.now(),i=s-r,a=(i/1e3).toFixed(1),l=Math.floor(i/6e4),c=Math.floor(i%6e4/1e3),h=`${l}:${c.toString().padStart(2,"0")}`,p=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),y=this.getFullGameContext(),m=JSON.parse(localStorage.getItem("globalConfig")||"{}"),I={sessionId:n,studentId:p.studentId||p.studentIdentifier||null,username:p.displayName||p.username||p.studentId||p.studentIdentifier||null,studentIdentifier:p.studentIdentifier||p.studentId||null,type:t,timestamp:new Date().toISOString(),clientTimestamp:s,timeElapsedSeconds:parseFloat(a),readableTime:h,semesterTime:this.getSemesterTime(),...y,isAdminMode:p.role==="admin",hasCheckpoint:p.checkpointSemester2||!1,hasAI:p.hasAI||!1,section:p.section||null,gameConfig:{semesterDuration:m.semesterDuration||12,totalTasks:m.totalTasks||10,totalSemesters:m.totalSemesters||2,midtermEnabled:m.midtermEnabled||!1,aiCost:m.aiCost||0,wrongAnswerPenalty:m.wrongAnswerPenalty||0,switchCost:m.switchCost||0,jarRefillFreezeTime:m.jarRefillFreezeTime||0,unfinishedJarPenalty:m.unfinishedJarPenalty||0,unfinishedTaskPenalty:m.unfinishedTaskPenalty||0,aiDelay:m.aiDelay||0,taskOrderStrategy:m.taskOrderStrategy||"sequential_task",difficultyMode:m.difficultyMode||"fixed",gameMode:m.gameMode||"knapsack",scoring:m.scoring||null},...this.convertTimesToSeconds(e)};(t==="user_action"||t==="task_attempt")&&console.log(`DEBUG: Event ${t} - studentId: ${I.studentId}, role: ${p.role}`);try{cu(fr(Xe,"events"),I).catch(A=>{console.error("Failed to log event immediately:",A),hi.push(I),this.storeOfflineEvent(I)})}catch(A){console.error("Failed to log event:",A),hi.push(I),this.storeOfflineEvent(I)}},convertTimesToSeconds(t){const e={...t},n=["timeTaken","timeSpent","totalTime","timeOnPreviousPage","averageTime","timeBetweenHelpAndSubmit"];for(const r of n)e[r]!==void 0&&e[r]!==null&&(e[`${r}Seconds`]=(e[r]/1e3).toFixed(1),delete e[r]);return e.timeProgression&&(e.timeProgressionSeconds=e.timeProgression.map(r=>(r/1e3).toFixed(1)),delete e.timeProgression),e.timePerAttempt&&(e.timePerAttemptSeconds=e.timePerAttempt.map(r=>(r/1e3).toFixed(1)),delete e.timePerAttempt),e},getSemesterTime(){const t=parseInt(localStorage.getItem("semesterStartTime")||Date.now()),e=Date.now()-t,n=(e/1e3).toFixed(1),r=Math.floor(e/6e4),s=Math.floor(e%6e4/1e3);return{elapsedSeconds:parseFloat(n),readable:`${r}:${s.toString().padStart(2,"0")}`,minutes:r,seconds:s}},getCurrentContext(){const t=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),e=((Date.now()-t)/1e3).toFixed(1);return{currentTask:localStorage.getItem("currentTask"),gameMode:localStorage.getItem("gameMode"),totalCompleted:this.getCompletedTaskCount(),currentStreak:this.getCurrentStreak(),sessionDurationSeconds:parseFloat(e)}},getFullGameContext(){const t=localStorage.getItem("currentTask")||"",e=localStorage.getItem("gameMode")||"",n=parseInt(localStorage.getItem("currentSemester")||"1"),r=parseInt(localStorage.getItem("totalSemesters")||"2"),s=localStorage.getItem("practiceCompleted")==="true",i=parseInt(localStorage.getItem("completedTasksCount")||"0"),a=parseInt(localStorage.getItem("completedLevels")||"0"),l=parseInt(localStorage.getItem("totalSwitches")||"0"),c=parseInt(localStorage.getItem("aiUsageCount")||"0"),h=JSON.parse(localStorage.getItem("categoryPoints")||"{}"),p=parseFloat(localStorage.getItem("studentLearningScore")||"0");return{currentTask:t,gameMode:e,currentSemester:n,totalSemesters:r,practiceCompleted:s,completedTasks:i,completedLevels:a,totalSwitches:l,aiUsageCount:c,studentLearning:p,totalBonus:h.bonus||0,finalScore:Math.round(p)+(h.bonus||0),semester:n}},calculateImprovementTrend(t){if(!t||t.length<3)return"needs_more_data";const n=t.slice(-5).map(s=>s.accuracy),r=this.calculateTrend(n);return r>5?"rapid_improvement":r>2?"steady_improvement":r>0?"slight_improvement":r>-2?"stable":r>-5?"slight_decline":"rapid_decline"},calculateImprovementRate(t){if(!t||t.length<2)return{overall:0,trend:0,isImproving:!1,dataPoints:t?t.length:0};const e=t[0].accuracy,r=t[t.length-1].accuracy-e;if(t.length<3)return{overall:r,trend:r,isImproving:r>0,dataPoints:t.length};const s=Math.floor(t.length/2),i=t.slice(0,s).reduce((c,h)=>c+h.accuracy,0)/s,l=t.slice(s).reduce((c,h)=>c+h.accuracy,0)/(t.length-s)-i;return{overall:r,trend:l,isImproving:l>0,dataPoints:t.length}},setPageStartTime(t){t&&localStorage.setItem(`pageStartTime_${t}`,Date.now().toString())},getTimeOnCurrentPage(t){if(!t)return 0;const e=localStorage.getItem(`pageStartTime_${t}`);return e?Date.now()-parseInt(e):0},ensureSession(){localStorage.getItem("sessionId")||this.init()},async trackAIHelpResponse(t,e,n,r,s,i){const a=parseInt(localStorage.getItem("aiUsageCount")||"0");return localStorage.setItem("aiUsageCount",(a+1).toString()),this.logEvent("ai_help_response",{taskId:t,helpType:e,suggestion:n,playerAction:r,playerValue:s,timeBetween:i})},async trackTaskAttempt(t,e){return this.logEvent("task_attempt",{taskId:t,...e})},async trackUserAction(t,e){return this.logEvent("user_action",{action:t,response:e.response||"",query:e.query||"",queryType:e.queryType||"",choice:e.choice||"",currentMode:e.currentMode||"",...e})},async syncOfflineEvents(){return console.log("Syncing offline events..."),Promise.resolve()},async trackTaskComplete(t,e){return this.logEvent("task_complete",{taskId:t,...e})},async trackPageSwitch(t,e,n){return this.logEvent("page_switch",{from:t,to:e,isAutoAdvance:n})},trackAITaskHelp(t,e,n,r,s){return this.logEvent("ai_task_help",{taskId:t,taskType:e,suggestion:n,wasCorrect:r,attemptNumber:s})},storeOfflineEvent(t){try{const e=JSON.parse(localStorage.getItem("offlineEvents")||"[]");e.push(t),e.length>1e3&&e.shift(),localStorage.setItem("offlineEvents",JSON.stringify(e))}catch(e){console.error("Failed to store offline event:",e)}}};Ue.init();const ut={seedRandom:null,currentSeed:null,initializeSeed(t){this.currentSeed=t;let e=t;this.seedRandom=function(){return e=(e*9301+49297)%233280,e/233280}},getRandom(){return this.seedRandom?this.seedRandom():Math.random()},generateCountingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n;e==="easy"?n=(t-1)%5+1:e==="medium"?n=(t-11)%5+6:n=(t-25)%5+11;const s={easy:{1:{target:"the",type:"word"},2:{target:"and",type:"word"},3:{target:"of",type:"word"},4:{target:"to",type:"word"},5:{target:"in",type:"word"}},medium:{6:{target:"e",type:"letter"},7:{target:"a",type:"letter"},8:{target:"i",type:"letter"},9:{target:"o",type:"letter"},10:{target:"s",type:"letter"}},hard:{11:{targets:["a","e"],type:"multi-letter"},12:{targets:["i","o"],type:"multi-letter"},13:{targets:["s","t"],type:"multi-letter"},14:{targets:["n","r"],type:"multi-letter"},15:{targets:["l","d"],type:"multi-letter"}}}[e][n];let i="";return s.type==="word"?i=`Count how many times the word "${s.target}" appears:`:s.type==="letter"?i=`Count how many times the letter "${s.target}" appears (case-insensitive):`:i=`Count how many times the letters "${s.targets[0]}" and "${s.targets[1]}" appear in total:`,{...s,instruction:i,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},generateSliderPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n,r,s;return e==="easy"?(n=Math.floor(this.getRandom()*11),r=1,s=!0):e==="medium"?(n=Math.round(this.getRandom()*10*10)/10,r=.1,s=!0):(n=Math.round(this.getRandom()*10*100)/100,r=.01,s=(t-25)%5!==0),{target:n,step:r,showValue:s,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1),precision:e==="easy"?0:e==="medium"?1:2}},generateTypingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard",n={easy:["hello world","quick test","type this","easy mode","simple text","good job","keep going","nice work","almost done","level up"],medium:["HeLLo WoRLd","QuIcK tEsT","TyPe ThIs","MeDiUm MoDe","MiXeD cAsE","KeEp GoInG","NiCe WoRk","AlMoSt DoNe","LeVeL uP","ChAlLeNgE","TeSt RuN","NeXt LeVeL","TrY aGaIn","GoOd LuCk","FiNaL tEsT"],hard:["Test@123","Go4It!Now","X9%Y8&Z7*","P6!Q5?R4+","Z1@Y2#X3$","M7&N8*O9!","J4%K5^L6&","D1!E2@F3#","A7$B8%C9^","V3*W4+X5=","Q2#R3$S4%","H5^I6&J7*","K8(L9)M0!","N1@O2#P3$","T4%U5^V6&","W7*X8(Y9)","C0!D1@E2#","F3$G4%H5^","I6&J7*K8(","L9)M0!N1@","O2#P3$Q4%","R5^S6&T7*","U8(V9)W0!","X1@Y2#Z3$","A4%B5^C6&"]};let r;if(e==="easy"){const s=(t-1)%n.easy.length;r=n.easy[s]}else if(e==="medium"){const s=(t-11)%n.medium.length;r=n.medium[s]}else{const s=(t-25)%n.hard.length;r=n.hard[s]}return{pattern:r,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},textPassages:["The University of California, Berkeley (UC Berkeley, Berkeley, Cal, or California) is a public land-grant research university in Berkeley, California, United States. Founded in 1868 and named after the Anglo-Irish philosopher George Berkeley, it is the state's first land-grant university and is the founding campus of the University of California system.","Berkeley has an enrollment of more than 45,000 students. The university is organized around fifteen schools of study on the same campus, including the College of Chemistry, the College of Engineering, College of Letters and Science, and the Haas School of Business.",'The Berkeley campus encompasses approximately 1,232 acres, though the "central campus" occupies only the low-lying western 178 acres. The campus contains numerous wooded areas, including the Eucalyptus Grove and Strawberry Creek, which runs through the center of campus.',"Oski the Bear (Oski) is the official mascot of the University of California, Berkeley, representing the California Golden Bears. Named after the Oski Yell, he made his debut at a freshman rally in the Greek Theatre on September 25, 1941.","Berkeley faculty, alumni, and researchers have won 111 Nobel laureates, 25 Turing Award winners, and 19 Academy Award winners. The university has produced many notable alumni in various fields including science, politics, business, and entertainment.","The university's athletic teams compete as the California Golden Bears and are members of the Atlantic Coast Conference for most sports. Berkeley teams have won 107 national championships, including 45 NCAA national championships.","Research at Berkeley is conducted within departments, organized research units, and interdisciplinary research centers. Berkeley operates Lawrence Berkeley National Laboratory, manages Los Alamos National Laboratory, and is a founding partner of the Space Sciences Laboratory.","The Berkeley campus offers over 350 degree programs through its 14 colleges and schools. Popular majors include Computer Science, Economics, Political Science, and Business Administration. The student-faculty ratio is 17:1.","Berkeley's libraries contain more than 13 million volumes and maintain special collections including the Mark Twain Papers, the Oral History Center, and the Bancroft Library, which houses the largest collection of materials on California history.","The campus is home to several museums including the Berkeley Art Museum and Pacific Film Archive, the Lawrence Hall of Science, and the UC Botanical Garden. These facilities serve both educational and public outreach purposes.","Notable Berkeley inventions and discoveries include the cyclotron, the atomic bomb, the flu vaccine, and vitamin E. Berkeley researchers discovered 16 chemical elements of the periodic table, more than any other university.","The Free Speech Movement, which took place during the 1964-65 academic year, was a pivotal moment in the history of civil liberties in the United States. It began when students protested a ban on political activities on campus.","Berkeley's Campanile, known as Sather Tower, is the third-tallest clock tower in the world at 307 feet. It was completed in 1914 and is visible for miles, serving as a symbol of the university.","The university operates on a semester system, with fall semester beginning in late August and spring semester beginning in mid-January. Berkeley offers over 5,000 courses each semester across all disciplines.",`Cal Bears have won at least one team national title in 13 different sports. The university's traditional rival is Stanford University, with the annual football game known as "The Big Game" dating back to 1892.`],getTextPassage(t){if(this.seedRandom){const e=Math.floor(this.getRandom()*this.textPassages.length),n=(t-1+e)%this.textPassages.length;return this.textPassages[n]}else{const e=(t-1)%this.textPassages.length;return this.textPassages[e]}}};function Jd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r,preGeneratedPattern:s=null,preGeneratedText:i=null}){const[a,l]=D.useState(""),[c,h]=D.useState(""),[p,y]=D.useState(null),[m,I]=D.useState(""),[A,P]=D.useState(null),[z,k]=D.useState(""),[S,T]=D.useState(""),[M]=D.useState(Date.now()),[H,F]=D.useState(""),[w,g]=D.useState(!1),[_,E]=D.useState(new Set),x=D.useRef(0);D.useRef(null);const R=(te,N=null,B=null)=>{const G=document.createElement("canvas"),U=G.getContext("2d");G.width=900,G.height=400,U.fillStyle="#fafafa",U.fillRect(0,0,G.width,G.height),U.strokeStyle="#e0e0e0",U.lineWidth=2,U.strokeRect(0,0,G.width,G.height),U.font="24px monospace",U.fillStyle="#333";const b=36,V=25,$=G.width-V*2;return((se,X)=>{const ie=se.split(" "),ve=[];let xe="";for(let le of ie){const ke=xe+(xe?" ":"")+le;U.measureText(ke).width>X&&xe?(ve.push(xe),xe=le):xe=ke}return xe&&ve.push(xe),ve})(te,$).forEach((se,X)=>{const ie=V+(X+1)*b;let ve=V;if(t<=5){const xe=se.split(" ");let le=0;xe.forEach(ke=>{const Ve=B&&B.has(le),Se=N&&N.some(ze=>ke.toLowerCase()===ze.toLowerCase());if(Ve){const ze=U.measureText(ke).width;U.fillStyle="yellow",U.fillRect(ve-2,ie-18,ze+4,24)}else if(Se){const ze=U.measureText(ke).width;U.fillStyle="rgba(255, 215, 0, 0.4)",U.fillRect(ve-2,ie-18,ze+4,24)}U.fillStyle="#333",U.fillText(ke,ve,ie),ve+=U.measureText(ke+" ").width,le++})}else for(let xe=0;xe<se.length;xe++){const le=se[xe],ke=U.measureText(le).width;N&&N.some(Se=>le.toLowerCase()===Se.toLowerCase())&&(U.fillStyle="rgba(255, 215, 0, 0.4)",U.fillRect(ve-1,ie-18,ke+2,24)),U.fillStyle="#333",U.fillText(le,ve,ie),ve+=ke}}),G.toDataURL()};D.useEffect(()=>{I(0),P(null),x.current=0},[t]),D.useEffect(()=>{const te=async(B,G)=>{const U=document.createElement("canvas"),b=U.getContext("2d");U.width=900,U.height=350,b.fillStyle="#fafafa",b.fillRect(0,0,U.width,U.height),b.strokeStyle="#e0e0e0",b.lineWidth=2,b.strokeRect(0,0,U.width,U.height),b.font="24px monospace";const V=36,$=20,re=U.width-$*2,se=((X,ie)=>{const ve=X.split(" "),xe=[];let le="";for(let ke of ve){const Ve=le+(le?" ":"")+ke;b.measureText(Ve).width>ie&&le?(xe.push(le),le=ke):le=Ve}return le&&xe.push(le),xe})(z,re);for(let X=0;X<B.length;X++)B[X],se.forEach((ie,ve)=>{const xe=$+(ve+1)*V;let le=$;for(let ke=0;ke<ie.length;ke++){const Ve=ie[ke],Se=b.measureText(Ve).width;B.some(at=>Ve.toLowerCase()===at.toLowerCase())&&(b.fillStyle="rgba(255, 255, 0, 0.6)",b.fillRect(le-1,xe-20,Se+2,26)),b.fillStyle="#333",b.fillText(Ve,le,xe),le+=Se}}),F(U.toDataURL()),await new Promise(ie=>setTimeout(ie,300));setTimeout(()=>{I(G.toString())},300)},N=async B=>{const{action:G,highlightWords:U,suggestedCount:b,animate:V,isMultiLetter:$,targetLetters:re}=B.detail||{};if(G==="highlightAndCount"){if($&&Array.isArray(re)){V&&await te(re,b);return}if(Array.isArray(U)&&V){z.split(" ");let Z=[];for(let se=0;se<U.length;se++){Z.push(U[se]);const X=document.createElement("canvas"),ie=X.getContext("2d");X.width=900,X.height=350,ie.fillStyle="#fafafa",ie.fillRect(0,0,X.width,X.height),ie.strokeStyle="#e0e0e0",ie.lineWidth=2,ie.strokeRect(0,0,X.width,X.height),ie.font="24px monospace";const ve=36,xe=20,le=X.width-xe*2;((Se,ze)=>{const at=Se.split(" "),he=[];let ye="";for(let Ae of at){const vn=ye+(ye?" ":"")+Ae;ie.measureText(vn).width>ze&&ye?(he.push(ye),ye=Ae):ye=vn}return ye&&he.push(ye),he})(z,le).forEach((Se,ze)=>{const at=xe+(ze+1)*ve;let he=xe;Se.split(" ").forEach(Ae=>{const vn=ie.measureText(Ae).width;Z.some(kr=>{const sr=Ae.replace(/[.,;!?]/g,"").toLowerCase(),Gs=kr.replace(/[.,;!?]/g,"").toLowerCase();return sr===Gs})&&(ie.fillStyle="rgba(255, 255, 0, 0.5)",ie.fillRect(he-2,at-18,vn+4,24)),ie.fillStyle="#333",ie.fillText(Ae,he,at),he+=ie.measureText(Ae+" ").width})}),F(X.toDataURL()),await new Promise(Se=>setTimeout(Se,200))}setTimeout(()=>{I(b.toString())},300)}}};return window.addEventListener("aiCountingHelp",N),()=>window.removeEventListener("aiCountingHelp",N)},[z,t]),D.useEffect(()=>{var U;const te=s||ut.generateCountingPattern(t),N=i||ut.getTextPassage(t);k(N),l(te.target||((U=te.targets)==null?void 0:U.join(", "))),h(te.instruction);let B=0;if(te.type==="word"){const b=new RegExp(`\\b${te.target}\\b`,"gi"),V=N.match(b);B=V?V.length:0}else if(te.type==="letter"){const b=new RegExp(te.target,"gi"),V=N.match(b);B=V?V.length:0}else te.type==="multi-letter"&&te.targets.forEach(b=>{const V=new RegExp(b,"gi"),$=N.match(V);B+=$?$.length:0});y(B);const G=R(N,null);F(G)},[t,s,i]);const C=async()=>{const te=Date.now()-M,N=parseInt(m,10)||0,B=p??0,G=Math.abs(N-B),U=`g1t${t}`,b=localStorage.getItem(`lastAIHelp_${U}`),V=b?JSON.parse(b):null;if(b&&V){const Z=Date.now()-V.timestamp,se=N===V.suggestion?"accepted":"modified";await Ue.trackAIHelpResponse(U,V.type,V.suggestion,se,N,Z),localStorage.removeItem(`lastAIHelp_${U}`)}let $=0;G===0?$=2:G<=1?$=1:$=0,x.current+=1,await Ue.trackTaskAttempt(U,{attempts:x.current,passed:!0,timeTaken:te,playerSubmission:N,goal:B,aiSubmission:(V==null?void 0:V.suggestion)||null});const re=localStorage.getItem("sessionId");if(re&&!re.startsWith("offline-"))try{await pr(Dt(Xe,"sessions",re),{[`taskAccuracies.g1t${t}`]:$===2?100:$===1?70:0,[`taskTimes.g1t${t}`]:te,[`taskPoints.g1t${t}`]:$,lastActivity:Tn()})}catch(Z){console.error("Error storing accuracy:",Z)}P($===2?" Perfect! 2 points earned!":$===1?` Off by ${G} - 1 point earned!`:` Off by ${G} - 0 points earned.`),setTimeout(()=>{e==null||e(`g1t${t}`,{attempts:x.current,totalTime:te,accuracy:$===2?100:$===1?70:0,userAnswer:N,correctAnswer:B,aiHelpValue:(V==null?void 0:V.suggestion)||null,points:$})},500)},me=ut.generateCountingPattern(t).difficultyLabel,Ie=t<=5?"easy":t<=10?"medium":"hard";return u.jsxs("div",{className:"task counting",children:[u.jsxs("h3",{children:["Research Content - Level ",t]}),u.jsx("div",{className:`difficulty-badge ${Ie}`,children:me}),u.jsxs("p",{className:"instruction",children:[u.jsx("strong",{children:c}),u.jsx("br",{}),u.jsx("span",{className:"hint",children:"(Case-insensitive)"})]}),u.jsxs("div",{className:"text-display text-to-count","data-counting-text":z,children:[u.jsx("div",{className:"count-target","data-pattern":a,style:{display:"none"},children:a}),H?u.jsx("img",{src:H,alt:"Text passage for counting",style:{width:"100%",maxWidth:"900px",height:"auto",maxHeight:"350px",objectFit:"contain",border:"none",userSelect:"none",pointerEvents:"none"},onContextMenu:te=>te.preventDefault(),draggable:!1}):u.jsx("div",{dangerouslySetInnerHTML:{__html:S}})]}),u.jsxs("div",{className:"input-section",children:[u.jsx("label",{children:"Your answer:"}),u.jsx("input",{type:"number",min:"0",max:"999",value:m,onChange:te=>I(te.target.value),onKeyPress:te=>{te.key==="Enter"&&C()},placeholder:"Enter count"})]}),u.jsx("button",{onClick:C,className:"submit-btn",style:{display:"block",margin:"20px auto 0"},children:"Submit"}),A&&u.jsx("div",{className:`feedback ${A.includes("2 points")?"correct":A.includes("0 points")?"incorrect":"partial"}`,children:A})]})}function Zd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r,preGeneratedPattern:s=null}){const[i,a]=D.useState(5),[l,c]=D.useState(0),[h,p]=D.useState(null),[y]=D.useState(Date.now()),[m,I]=D.useState(1),[A,P]=D.useState(!0),[z,k]=D.useState(!1),[S,T]=D.useState(!1),[M,H]=D.useState(!1),[F,w]=D.useState(!1),g=D.useRef(null),_=D.useRef(0);D.useEffect(()=>{if(n)a(3),I(1),P(!0);else{const N=s||ut.generateSliderPattern(t);a(N.target),I(N.step),P(N.showValue)}c(0),p(null),_.current=0},[t,n,s]),D.useEffect(()=>{const N=B=>{const{action:G,value:U,animate:b}=B.detail;if(G==="moveSlider")if(T(!0),b){const V=parseFloat(l),$=parseFloat(U),re=1e3,Z=30;let se=0;const X=setInterval(()=>{se++;const ie=se/Z,ve=1-Math.pow(1-ie,3),xe=V+($-V)*ve;c(parseFloat(xe.toFixed(2))),se>=Z&&(clearInterval(X),T(!1),c(parseFloat($.toFixed(2))))},re/Z)}else c(parseFloat(U.toFixed(2))),T(!1)};return window.addEventListener("aiSliderHelp",N),()=>window.removeEventListener("aiSliderHelp",N)},[l]),D.useEffect(()=>{const N=B=>{B.key==="Enter"&&!S&&C()};return document.addEventListener("keypress",N),()=>document.removeEventListener("keypress",N)},[S,l,i]);const E=N=>{if(S)return;const B=g.current;if(!B)return;N.preventDefault();const G=B.getBoundingClientRect(),U=l/10,b=G.left+G.width*U,V=N.clientX||N.touches&&N.touches[0].clientX;Math.abs(V-b)<30&&(H(!0),w(!0))},x=N=>{if(!M||S)return;const B=g.current;if(!B)return;const G=B.getBoundingClientRect(),U=N.clientX||N.touches&&N.touches[0].clientX,V=Math.max(0,Math.min(1,(U-G.left)/G.width))*10,$=Math.round(V/m)*m;c(parseFloat($.toFixed(2)))},R=()=>{H(!1)};D.useEffect(()=>{if(M){const N=G=>x(G),B=()=>R();return document.addEventListener("mousemove",N),document.addEventListener("mouseup",B),document.addEventListener("touchmove",N),document.addEventListener("touchend",B),()=>{document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",B),document.removeEventListener("touchmove",N),document.removeEventListener("touchend",B)}}},[M,m,S]);const C=async()=>{const N=Date.now()-y,B=parseFloat(l),G=Math.abs(B-i),U=`g2t${t}`,b=localStorage.getItem(`lastAIHelp_${U}`),V=b?JSON.parse(b):null;if(b&&V){const Z=Date.now()-V.timestamp,se=B===V.suggestion?"accepted":"modified";await Ue.trackAIHelpResponse(U,V.type,V.suggestion,se,B,Z),localStorage.removeItem(`lastAIHelp_${U}`)}let $=0;G===0?$=2:G<=1?$=1:$=0,_.current+=1,await Ue.trackTaskAttempt(U,{attempts:_.current,passed:!0,timeTaken:N,playerSubmission:B,goal:i,aiSubmission:(V==null?void 0:V.suggestion)||null});const re=localStorage.getItem("sessionId");if(re&&!re.startsWith("offline-"))try{await pr(Dt(Xe,"sessions",re),{[`taskDifferences.g2t${t}`]:G,[`taskTimes.g2t${t}`]:N,[`taskPoints.g2t${t}`]:$,lastActivity:Tn()})}catch(Z){console.error("Error storing difference:",Z)}p($===2?" Perfect! 2 points earned!":$===1?` Off by ${G.toFixed(2)} - 1 point earned!`:` Off by ${G.toFixed(2)} - 0 points earned.`),setTimeout(()=>{e(`g2t${t}`,{attempts:_.current,totalTime:N,accuracy:$===2?100:$===1?70:0,userAnswer:B,userValue:B,correctAnswer:i,targetValue:i,aiHelpValue:(V==null?void 0:V.suggestion)||null,points:$})},500)},ne=ut.generateSliderPattern(t),me=ne.difficultyLabel,Ie=ne.difficulty,te=()=>{const N=[];for(let B=0;B<=10;B++)N.push(u.jsxs("div",{style:{position:"absolute",left:`${B*10}%`,transform:"translateX(-50%)",textAlign:"center"},children:[u.jsx("div",{style:{width:"2px",height:"12px",background:"#666",margin:"0 auto"}}),u.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:B})]},B));return N};return u.jsxs("div",{className:`task slider ${S?"ai-controlled":""}`,children:[u.jsxs("h3",{children:["Material Creation - Level ",t]}),u.jsx("div",{className:`difficulty-badge ${Ie}`,children:me}),u.jsxs("p",{className:"instruction",children:["Move the slider to:"," ",u.jsx("strong",{className:"target-value","data-target-value":i,children:i}),u.jsx("br",{}),u.jsx("span",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:!F&&"Hold and drag the slider handle to move it"})]}),u.jsxs("div",{className:"slider-container",children:[u.jsxs("div",{className:"range-labels",children:[u.jsx("span",{children:"0"}),u.jsx("span",{children:"10"})]}),u.jsxs("div",{style:{position:"relative",padding:"20px 0 30px 0"},children:[u.jsx("div",{style:{position:"absolute",width:"100%",height:"20px",top:"0"},children:te()}),u.jsx("div",{style:{position:"relative",marginTop:"20px"},children:u.jsx("input",{ref:g,type:"range",min:"0",max:"10",step:m,value:l,onChange:N=>{!M&&!S&&(c(parseFloat(N.target.value)),w(!0))},className:"slider-input",style:{width:"100%",cursor:M?"grabbing":"grab"},onMouseDown:E,onTouchStart:E})})]}),u.jsx("div",{className:"current-value",children:A?parseFloat(l).toFixed(n?0:ne.precision):"??"})]}),u.jsx("button",{onClick:C,className:"submit-btn",disabled:S,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),h&&u.jsx("div",{className:`feedback ${h.includes("2 points")?"correct":h.includes("0 points")?"incorrect":"partial"}`,children:h})]})}function eh({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r,preGeneratedPattern:s=null}){const[i,a]=D.useState(""),[l,c]=D.useState(""),[h,p]=D.useState(null),[y]=D.useState(Date.now()),[m,I]=D.useState(""),[A,P]=D.useState(!1),z=D.useRef(0),k=F=>{const w=document.createElement("canvas"),g=w.getContext("2d");return w.width=600,w.height=150,g.fillStyle="#f5f5f5",g.fillRect(0,0,w.width,w.height),g.font='bold 40px "Courier New", monospace',g.fillStyle="#333",g.textAlign="center",g.textBaseline="middle",g.fillText(F,w.width/2,w.height/2),w.toDataURL()};D.useEffect(()=>{const w=(s||ut.generateTypingPattern(t)).pattern;a(w);const g=k(w);I(g)},[t,s]),D.useEffect(()=>{c(""),p(null),z.current=0},[t]),D.useEffect(()=>{const F=w=>{const{action:g,text:_,typeSpeed:E}=w.detail;if(g==="autoType"&&_){P(!0),c("");let x="",R=0;const C=setInterval(()=>{R<_.length?(x+=_[R],c(x),R++):(clearInterval(C),P(!1))},E||50);return()=>clearInterval(C)}};return window.addEventListener("aiTypingHelp",F),()=>window.removeEventListener("aiTypingHelp",F)},[]);const S=async()=>{const F=Date.now()-y,w=`g3t${t}`,g=localStorage.getItem(`lastAIHelp_${w}`),_=g?JSON.parse(g):null;if(g&&_){const ne=Date.now()-_.timestamp,me=l===_.suggestion?"accepted":"modified";await Ue.trackAIHelpResponse(w,_.type,_.suggestion,me,l,ne),localStorage.removeItem(`lastAIHelp_${w}`)}const x=((ne,me)=>{const Ie=ne.length,te=me.length,N=Array(Ie+1).fill(null).map(()=>Array(te+1).fill(0));for(let B=0;B<=Ie;B++)N[B][0]=B;for(let B=0;B<=te;B++)N[0][B]=B;for(let B=1;B<=Ie;B++)for(let G=1;G<=te;G++)ne[B-1]===me[G-1]?N[B][G]=N[B-1][G-1]:N[B][G]=Math.min(N[B-1][G]+1,N[B][G-1]+1,N[B-1][G-1]+1);return N[Ie][te]})(l,i);let R=0;x===0?R=2:x===1?R=1:R=0,z.current+=1,await Ue.trackTaskAttempt(w,{attempts:z.current,passed:!0,timeTaken:F,playerSubmission:l,goal:i,aiSubmission:(_==null?void 0:_.suggestion)||null});const C=localStorage.getItem("sessionId");if(C&&!C.startsWith("offline-"))try{await pr(Dt(Xe,"sessions",C),{[`taskAccuracies.g3t${t}`]:R===2?100:R===1?70:0,[`taskTimes.g3t${t}`]:F,[`taskPoints.g3t${t}`]:R,lastActivity:Tn()})}catch(ne){console.error("Error storing accuracy:",ne)}p(R===2?" Perfect! 2 points earned!":R===1?" 1 typo - 1 point earned!":` ${x} errors - 0 points earned.`),setTimeout(()=>{const ne=localStorage.getItem(`lastAIHelp_g3t${t}`),me=ne?JSON.parse(ne):null;e(`g3t${t}`,{attempts:z.current,totalTime:F,accuracy:R===2?100:R===1?70:0,userAnswer:l,input:l,correctAnswer:i,pattern:i,aiHelpValue:(me==null?void 0:me.suggestion)||null,points:R})},500)},T=ut.generateTypingPattern(t),M=T.difficultyLabel,H=T.difficulty;return u.jsxs("div",{className:"task typing",style:{maxWidth:"100%"},children:[u.jsxs("h3",{children:["Student Engagement - Level ",t]}),u.jsx("div",{className:`difficulty-badge ${H}`,children:M}),u.jsx("p",{className:"instruction",children:"Type this pattern exactly:"}),u.jsxs("div",{className:"pattern-display",children:[u.jsx("div",{className:"typing-pattern","data-typing-pattern":i,style:{display:"none"},children:i}),m?u.jsx("img",{src:m,alt:"Pattern to type",style:{width:"100%",maxWidth:"600px",height:"auto",userSelect:"none",pointerEvents:"none"},onContextMenu:F=>F.preventDefault(),draggable:!1}):u.jsx("span",{className:"pattern-text",children:i})]}),u.jsx("div",{className:"input-section",style:{width:"90%",maxWidth:"900px",margin:"20px auto 0"},children:u.jsx("input",{type:"text",inputMode:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:l,onChange:F=>!A&&c(F.target.value),onKeyPress:F=>{F.key==="Enter"&&!A&&(F.preventDefault(),S())},placeholder:"Type here...",className:"typing-input",disabled:A,style:{backgroundColor:A?"#e3f2fd":"white",transition:"background-color 0.3s",width:"100%",maxWidth:"100%",fontFamily:'"Courier New", monospace',fontSize:"28px",padding:"12px 14px",border:"2px solid #e0e0e0",borderRadius:"8px",boxSizing:"border-box"}})}),u.jsx("button",{onClick:S,className:"submit-btn",disabled:A,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),h&&u.jsx("div",{className:`feedback ${h.includes("2 points")?"correct":h.includes("0 points")?"incorrect":"partial"}`,children:h})]})}function yI({current:t,completed:e,onSwitch:n,limitMode:r,taskPoints:s={},categoryMultipliers:i={},starGoals:a={},categoryPoints:l={},timeRemaining:c=null}){const h=()=>{const T=l.materials||0,M=1+(l.research||0)*.15,H=parseFloat(localStorage.getItem("engagementInterest")||"0")||0;return T*M+H},p=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,y=1+(l.research||0)*.15,m=[];for(let T=1;T<=3;T++)for(let M=1;M<=100;M++){const H=["Research","Materials","Engage"][T-1];m.push({id:`g${T}t${M}`,label:`${H} ${M}`,game:T})}const I=T=>{const M=T.id[1],H=parseInt(T.id.substring(3));if(H===1)return!0;const F=`g${M}t${H-1}`;return e[F]===!0},A={2:m.filter(T=>T.game===2),1:m.filter(T=>T.game===1),3:m.filter(T=>T.game===3)},P={1:"#9C27B0",2:"#4CAF50",3:"#f44336"},z={1:"",2:"",3:""},k={1:"Research",2:"Materials",3:"Engagement"},S={1:"research",2:"materials",3:"engagement"};return u.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"25px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"25px"},children:[2,1,3].map(T=>{const M=A[T],H=M.filter(x=>e[x.id]).length,F=S[T],w=H+1,g=T==="1"?(l.research||0)*.15:0,_=T==="3"?(l.engagement||0)*.0015:0,E=g>0||_>0;return u.jsxs("div",{style:{background:`linear-gradient(135deg, ${P[T]}10 0%, ${P[T]}05 100%)`,borderRadius:"12px",border:`2px solid ${P[T]}20`,padding:"20px",position:"relative",overflow:"hidden",boxShadow:E?`0 0 20px ${P[T]}20`:"none",transition:"all 0.3s ease"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"15px"},children:[u.jsx("span",{style:{fontSize:"28px"},children:z[T]}),u.jsxs("div",{style:{flex:1},children:[u.jsx("h3",{style:{margin:0,color:P[T],fontSize:"18px",fontWeight:"bold"},children:k[T]}),u.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:["Level ",Math.min(w,30)]})]}),l&&l[F]>0&&u.jsxs("div",{style:{background:P[T],color:"white",padding:"6px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[l[F]," pts"]})]}),T==="1"&&(l.research||0)>0&&u.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",(l.research*15).toFixed(0),"%"]}),T==="3"&&(l.engagement||0)>0&&u.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",((l.engagement||0)*.15).toFixed(1),"% interest/task"]}),u.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:M.filter(x=>parseInt(x.id.substring(3))<=w).map(x=>{const R=I(x),C=e[x.id],ne=t===x.id,me=parseInt(x.id.substring(3)),Ie=s[x.id]||0;return u.jsxs("button",{disabled:!R||C,onClick:()=>R&&!C&&n(x.id),style:{position:"relative",width:"40px",height:"40px",padding:"0",fontSize:"14px",fontWeight:ne?"bold":"500",border:`2px solid ${ne?P[T]:C?`${P[T]}40`:"#e0e0e0"}`,borderRadius:"8px",background:ne?P[T]:C?`${P[T]}10`:"white",color:ne?"white":C?P[T]:"#333",cursor:R&&!C?"pointer":"not-allowed",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",opacity:C?.7:1,boxShadow:ne?`0 2px 8px ${P[T]}40`:"none",transform:"translateY(0)",willChange:"transform, box-shadow"},onMouseEnter:te=>{R&&!ne&&!C&&requestAnimationFrame(()=>{te.currentTarget.style.transform="translateY(-2px)",te.currentTarget.style.boxShadow=`0 4px 12px ${P[T]}30`})},onMouseLeave:te=>{R&&!ne&&!C&&requestAnimationFrame(()=>{te.currentTarget.style.transform="translateY(0)",te.currentTarget.style.boxShadow="none"})},title:C?`Level ${me} completed (${Ie} pts)`:R?`Start Level ${me}`:`Complete Level ${me-1} first`,children:[me,C&&u.jsx("span",{style:{position:"absolute",top:"-4px",right:"-4px",background:P[T],color:"white",width:"16px",height:"16px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"bold"},children:""}),C&&u.jsx("div",{style:{position:"absolute",bottom:"2px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"2px"},children:Ie===0?u.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",border:`1px solid ${P[T]}`,background:"transparent"}}):[...Array(Math.min(Ie,2))].map((te,N)=>u.jsx("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:P[T]}},N))})]},x.id)})})]},T)})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",background:"#f8f9fa",borderRadius:"8px",flexWrap:"wrap",gap:"20px"},children:[c!==null&&u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""}),u.jsxs("div",{children:[u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:c<60?"#f44336":"#333"},children:[Math.floor(c/60),":",(c%60).toString().padStart(2,"0")]}),c<180&&c>0&&u.jsx("div",{style:{fontSize:"11px",color:"#ff9800"},children:"Hurry up!"})]})]}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Tasks Completed"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:Object.keys(e).length})]}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Student Learning"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:Math.round(h())}),u.jsxs("div",{style:{fontSize:"10px",color:"#999"},children:[l.materials||0," (materials)  ",y.toFixed(2)," (research) + ",p.toFixed(1)," (cumulative engagement interest)"]})]}),t&&u.jsxs("div",{style:{padding:"8px 16px",background:t.startsWith("g1")?"#9C27B0":t.startsWith("g2")?"#4CAF50":"#f44336",color:"white",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:["Current:"," ",t.replace("g1t","Research ").replace("g2t","Materials ").replace("g3t","Engage ")]})]})]})}function vI({practiceCompleted:t={},onPracticeComplete:e,onStartMainGame:n,onSelectPractice:r,isAdmin:s=!1}){const[i,a]=D.useState(null),l=(m,I)=>{if(I&&I.points===2){typeof e=="function"&&e(m,I);const A=document.createElement("div");A.className="notification-enter",A.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",A.textContent="Perfect! Practice task completed. Returning to menu...",document.body.appendChild(A),setTimeout(()=>{a(null),document.body.contains(A)&&document.body.removeChild(A)},1500)}else{const A=(I==null?void 0:I.points)||0,P=document.createElement("div");P.className="notification-enter",P.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #ff9800; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",P.textContent=`Practice requires 100% accuracy. You scored ${A===1?"50%":"0%"}. Try again!`,document.body.appendChild(P),setTimeout(()=>{document.body.contains(P)&&document.body.removeChild(P)},3e3)}},c=t.g2t1&&t.g1t1&&t.g3t1,h=()=>u.jsxs("div",{className:"practice-menu",children:[u.jsxs("h2",{children:["Practice Mode ",!s&&"(Required)"]}),!s&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",borderRadius:"12px",padding:"16px",marginBottom:"25px",border:"2px solid #f57c00",boxShadow:"0 4px 6px rgba(245, 124, 0, 0.1)",textAlign:"center"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""}),u.jsx("strong",{style:{color:"#e65100",fontSize:"18px"},children:"100% PERFECT ACCURACY REQUIRED"})]}),u.jsxs("div",{style:{color:"#e65100",fontSize:"14px"},children:["You must score 2/2 points (exact answer) on all three practice tasks to proceed.",u.jsx("br",{}),u.jsx("strong",{children:"No partial credit in practice mode!"})]}),u.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"12px"},children:[u.jsxs("span",{style:{padding:"4px 12px",background:t.g2t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g2t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g2t1?"#4CAF50":"#ffb74d"}`},children:["Materials ",t.g2t1?"":"Required"]}),u.jsxs("span",{style:{padding:"4px 12px",background:t.g1t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g1t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g1t1?"#4CAF50":"#ffb74d"}`},children:["Research ",t.g1t1?"":"Required"]}),u.jsxs("span",{style:{padding:"4px 12px",background:t.g3t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g3t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g3t1?"#4CAF50":"#ffb74d"}`},children:["Engagement ",t.g3t1?"":"Required"]})]})]}),u.jsx("p",{className:"practice-hint",style:{textAlign:"center",fontSize:"16px",color:"#666",marginBottom:"30px"},children:"Try each task type before starting the main challenge. No time pressure!"}),u.jsxs("div",{className:"practice-cards",children:[u.jsxs("div",{className:"practice-card materials",children:[u.jsx("h3",{children:" Materials"}),u.jsx("p",{children:"Hold and drag slider to match target values"}),u.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Base points - directly added to score"}),u.jsx("div",{className:"practice-buttons",children:u.jsx("button",{onClick:()=>{a("g2t1"),r&&r("g2t1")},className:t.g2t1?"completed":"",disabled:!1,children:t.g2t1?" Completed":"Try Materials"})})]}),u.jsxs("div",{className:"practice-card research",children:[u.jsx("h3",{children:" Research"}),u.jsx("p",{children:"Count words or letters in text passages"}),u.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 15% multiplier per point in main game"}),u.jsx("div",{className:"practice-buttons",children:u.jsx("button",{onClick:()=>{a("g1t1"),r&&r("g1t1")},className:t.g1t1?"completed":"",disabled:!1,children:t.g1t1?" Completed":"Try Research"})})]}),u.jsxs("div",{className:"practice-card engagement",children:[u.jsx("h3",{children:" Engagement"}),u.jsx("p",{children:"Type patterns exactly as shown"}),u.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 0.15% compound interest per point"}),u.jsx("div",{className:"practice-buttons",children:u.jsx("button",{onClick:()=>{a("g3t1"),r&&r("g3t1")},className:t.g3t1?"completed":"",disabled:!1,children:t.g3t1?" Completed":"Try Engagement"})})]})]}),u.jsxs("div",{style:{marginTop:"25px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",textAlign:"center"},children:[u.jsx("h4",{style:{margin:"0 0 10px 0",color:"#333",fontSize:"16px"},children:"Practice Progress:"}),u.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[u.jsxs("div",{style:{padding:"8px 15px",background:t.g2t1?"#4CAF50":"#e0e0e0",color:t.g2t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Materials ",t.g2t1&&""]}),u.jsxs("div",{style:{padding:"8px 15px",background:t.g1t1?"#9C27B0":"#e0e0e0",color:t.g1t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Research ",t.g1t1&&""]}),u.jsxs("div",{style:{padding:"8px 15px",background:t.g3t1?"#f44336":"#e0e0e0",color:t.g3t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Engagement ",t.g3t1&&""]})]}),u.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#666"},children:[u.jsx("strong",{children:"100% accuracy required"})," to complete each practice task"]})]}),u.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:u.jsx("button",{className:"start-main-game-btn",onClick:n,style:{opacity:!s&&!c?.5:1,cursor:!s&&!c?"not-allowed":"pointer"},disabled:!s&&!c,children:s?"Start Main Game (Admin)":c?"Start Main Game - You're Ready! ":"Complete Practice First"})})]});if(!i)return h();const p=i[1],y=1;return u.jsxs("div",{className:"practice-container",children:[u.jsx("button",{className:"back-to-menu",onClick:()=>a(null),children:" Back to Practice Menu"}),u.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[u.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),u.jsxs("div",{className:"practice-task-wrapper",children:[p==="1"&&u.jsx(Jd,{taskNum:y,onComplete:l,isPractice:!0,currentTaskId:i}),p==="2"&&u.jsx(Zd,{taskNum:y,onComplete:l,isPractice:!0,currentTaskId:i}),p==="3"&&u.jsx(eh,{taskNum:y,onComplete:l,isPractice:!0,currentTaskId:i})]})]})}class xI{constructor(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={}}getUniversalAttemptNumber(){return this.totalAIUsage}shouldAIBeCorrect(e){let n;return e===1||e===2||e===4||e===5?n=!0:e===3?n=!1:n=Math.random()<.75,n}getTaskUsageCount(e){return this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]}incrementTaskUsage(e,n){this.totalAIUsage++,this.usageCount[n]++,this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]++}resetForNewSemester(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={},console.log(" AI Help usage reset for new semester")}helpWithSlider(e,n){this.incrementTaskUsage(n,"materials");const r=this.getUniversalAttemptNumber();let s;if(this.shouldAIBeCorrect(r))s=e;else if(r===3){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else if(Math.random()<.5){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else{const i=(Math.random()<.5?-1:1)*(2+Math.random()*2);s=Math.max(0,Math.min(10,e+i))}return{action:"moveSlider",value:s,animate:!0}}helpWithCounting(e,n,r){this.incrementTaskUsage(r,"research");const s=this.getUniversalAttemptNumber(),i=this.shouldAIBeCorrect(s);return n.length===1||n.includes(" and ")||n.includes(",")?this.helpWithLetterCounting(e,n,s,i):this.helpWithWordCounting(e,n,s,i)}helpWithLetterCounting(e,n,r,s){let i=[];n.includes(" and ")||n.includes(",")?i=n.match(/[a-z]/gi)||[]:i=[n];let a=0;i.forEach(h=>{const p=new RegExp(h,"gi"),y=e.match(p);a+=y?y.length:0});let l=a,c=[...i];if(!s){r===3||Math.random()<.5?l=a+1:l=a+Math.floor(Math.random()*3)+2,l=Math.max(0,l);const p="abcdefghijklmnopqrstuvwxyz".split("").filter(m=>!i.includes(m.toLowerCase())),y=Math.floor(Math.random()*2)+1;for(let m=0;m<y&&p.length>0;m++){const I=Math.floor(Math.random()*p.length);c.push(p[I]),p.splice(I,1)}}return{action:"highlightAndCount",highlightWords:[],suggestedCount:l,animate:!0,isMultiLetter:!0,targetLetters:c}}helpWithWordCounting(e,n,r,s){const i=e.split(/\s+/),a=[];let l=0,c=0;if(i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&c++}),s)i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&(a.push(h),l++)});else if(r===3){l=c+1,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());if(h.length>0&&a.length<l){const p=h[Math.floor(Math.random()*h.length)];a.push(p)}}else{Math.random()<.5?l=c+1:l=c+Math.floor(Math.random()*3)+2,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());for(;a.length<l&&h.length>0;){const p=Math.floor(Math.random()*h.length),y=h[p];a.includes(y)||a.push(y),h.splice(p,1)}}return{action:"highlightAndCount",highlightWords:a,suggestedCount:l,animate:!0}}helpWithTyping(e,n){this.incrementTaskUsage(n,"engagement");const r=this.getUniversalAttemptNumber();let s=e;const i={0:["o","O"],o:["0"],O:["0"],1:["l","I","i"],l:["1","I","i"],I:["1","l","i"],i:["1","l","I"],e:["3"],3:["e"],a:["@"],"@":["a"],s:["5","$"],S:["5","$"],5:["s","S"],$:["s","S"],g:["9"],9:["g"],b:["6"],6:["b"],z:["2"],2:["z"],B:["8"],8:["B"]},a=l=>{const c=l.split(""),h=c.map((p,y)=>i[p]?y:-1).filter(p=>p!==-1);if(h.length>0){const p=h[Math.floor(Math.random()*h.length)],y=c[p],m=i[y];m&&m.length>0&&(c[p]=m[Math.floor(Math.random()*m.length)])}else{const p=["transpose","duplicate","missing"],y=p[Math.floor(Math.random()*p.length)],m=Math.floor(Math.random()*c.length);switch(y){case"transpose":m<c.length-1&&([c[m],c[m+1]]=[c[m+1],c[m]]);break;case"duplicate":c.splice(m,0,c[m]);break;case"missing":c.splice(m,1);break}}return c.join("")};if(this.shouldAIBeCorrect(r))s=e;else if(r===3)s=a(e);else if(Math.random()<.5)s=a(e);else{let l=e;const c=Math.floor(Math.random()*3)+2;for(let h=0;h<c;h++)l=a(l);s=l}return{action:"autoType",text:s,typeSpeed:50,perfect:this.shouldAIBeCorrect(r)}}}const bt=new xI;function sm({bonusPrompts:t=0,currentTask:e="",categoryPoints:n=null,timeRemaining:r=null,calculateStudentLearning:s=()=>0,aiCost:i=0,onAiCost:a,aiDelay:l=0,onPauseTimer:c=null}){const[h,p]=D.useState(!0),[y,m]=D.useState(0),[I,A]=D.useState(!1);D.useEffect(()=>{const U=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");p(U.hasAI!==!1)},[]),D.useEffect(()=>{if(e){const U=bt.getTaskUsageCount(e)>=1;A(U)}},[e]),D.useEffect(()=>{const U=()=>{m(bt.totalAIUsage)},b=setInterval(U,1e3);return U(),()=>clearInterval(b)},[]);const[P,z]=D.useState([{sender:"bot",text:h?"Hello! I'm your AI teaching assistant. You get ONE AI help attempt per task - use it wisely!":"Hello! This is the chat interface. AI assistance is not available for this session."}]),[k,S]=D.useState(""),[T,M]=D.useState(!1),[H,F]=D.useState(0),[w,g]=D.useState(!1),[_,E]=D.useState({materials:0,research:0,engagement:0}),x=D.useRef(null),R=()=>e?e.startsWith("g1")?"research":e.startsWith("g2")?"materials":e.startsWith("g3")?"engagement":null:null,C=(U=null)=>{const b=U||R();if(!b){z(re=>[...re,{sender:"bot",text:"Please start a task first, then I can help you!"}]);return}if(bt.getTaskUsageCount(e)>=1){z(re=>[...re,{sender:"bot",text:" You've already used AI help for this task. Only 1 AI attempt allowed per task!"}]);return}const $=Date.now();if($-_[b]<3e3){z(re=>[...re,{sender:"bot",text:"Please wait a moment before requesting help again!"}]);return}switch(E(re=>({...re,[b]:$})),l>0&&c&&c(l,"AI Help"),b){case"materials":ne();break;case"research":me();break;case"engagement":te();break;default:z(re=>[...re,{sender:"bot",text:"I'm not sure which task you're on. Please try again!"}])}},ne=()=>{var Z,se,X,ie;const U=((Z=document.querySelector("[data-target-value]"))==null?void 0:Z.getAttribute("data-target-value"))||((se=document.querySelector(".target-value"))==null?void 0:se.textContent)||5,b=bt.helpWithSlider(parseFloat(U),e),V=bt.getUniversalAttemptNumber(),$=bt.shouldAIBeCorrect(V),re=((X=document.querySelector("[data-target-value]"))==null?void 0:X.getAttribute("data-target-value"))||((ie=document.querySelector(".target-value"))==null?void 0:ie.textContent)||null;Ue.logEvent("ai_help_task",{taskId:e,taskType:"slider",helpType:"materials",aiFeedback:b.value,aiSubmission:b.value,goal:re?parseFloat(re):null,wasCorrect:$,attemptNumber:V,aiDelay:l||0,currentScore:s()}).catch(ve=>console.error("Error tracking slider help:",ve)),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"slider",suggestion:b.value,timestamp:Date.now(),wasCorrect:$})),window.dispatchEvent(new CustomEvent("aiSliderHelp",{detail:b})),m(bt.totalAIUsage),A(!0),z(ve=>[...ve,{sender:"bot",text:` Helping with materials...
Suggested value: ${b.value.toFixed(2)}`}])},me=()=>{var V,$;const U=document.querySelector(".text-to-count"),b=document.querySelector(".count-target");if(U&&b){const re=U.getAttribute("data-counting-text")||"";let Z=((V=b.getAttribute("data-pattern"))==null?void 0:V.replace(/['"]/g,"").trim())||"";const se=bt.helpWithCounting(re,Z,e),X=se.suggestedCount;window.dispatchEvent(new CustomEvent("aiCountingHelp",{detail:se}));const ie=bt.getUniversalAttemptNumber(),ve=bt.shouldAIBeCorrect(ie),xe=(($=b.getAttribute("data-pattern"))==null?void 0:$.replace(/['"]/g,"").trim())||null;Ue.logEvent("ai_help_task",{taskId:e,taskType:"counting",helpType:"research",aiFeedback:X,aiSubmission:X,goal:xe,wasCorrect:ve,attemptNumber:ie,aiDelay:l||0,currentScore:s(),highlightedWords:se.highlightWords||[],targetLetters:se.targetLetters||[],isMultiLetter:se.isMultiLetter||!1}).catch(ke=>console.error("Error tracking counting help:",ke)),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"counting",suggestion:X,timestamp:Date.now(),wasCorrect:ve,highlightedWords:se.highlightWords||[],targetLetters:se.targetLetters||[]})),m(bt.totalAIUsage),A(!0);const le=se.isMultiLetter?"letters/characters":"words";z(ke=>[...ke,{sender:"bot",text:` Helping with research...
Found ${X} ${le}`}])}},Ie=()=>{l>0&&c&&c(l,"AI Planning Help");const U=[" CRITICAL STRATEGY: Do tasks in this EXACT order  1 Engagement (builds interest from the start) 2 Research (multiplies future materials) 3 Materials (gets all multipliers). Materials done early = WASTED points!"," MAXIMUM SCORE ORDER: Engagement FIRST  Research SECOND  Materials LAST! Why? Engagement compounds every task, Research only multiplies FUTURE materials. Doing materials early gets ZERO multiplier!"," WARNING: Research multipliers ONLY apply to materials earned AFTER! If you do materials first, you get NO bonus. Always do ALL engagement & research before touching ANY materials!"," PRO TIP: Complete 100% of Engagement tasks first (builds interest early), then 100% of Research (sets up multipliers), THEN do Materials. This order can DOUBLE your score vs doing materials first!"," OPTIMAL PATH: Think of it like this - Engagement = compound interest (starts early), Research = multiplier (affects future only), Materials = base score (save for last). Wrong order = lost points forever!"],b=U[Math.floor(Math.random()*U.length)];z(V=>[...V,{sender:"bot",text:b}]),Ue.logEvent("ai_help_plan",{helpType:"planning",aiFeedback:b,currentTask:e,aiDelay:l,timestamp:Date.now()}).catch(V=>console.error("Error tracking planning help:",V))},te=()=>{const U=document.querySelector("[data-typing-pattern]");if(U){const b=U.getAttribute("data-typing-pattern");if(b){const V=bt.helpWithTyping(b,e),$=bt.getUniversalAttemptNumber(),re=V.perfect;Ue.logEvent("ai_help_task",{taskId:e,taskType:"typing",helpType:"engagement",aiFeedback:V.text,aiSubmission:V.text,goal:b,wasCorrect:re,attemptNumber:$,aiDelay:l||0,currentScore:s(),originalPattern:b}).catch(Z=>console.error("Error tracking typing help:",Z)),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"typing",suggestion:V.text,timestamp:Date.now(),wasCorrect:re,originalPattern:b})),window.dispatchEvent(new CustomEvent("aiTypingHelp",{detail:V})),m(bt.totalAIUsage),A(!0),z(Z=>[...Z,{sender:"bot",text:` Helping with engagement...
Typing: "${V.text.substring(0,30)}${V.text.length>30?"...":""}"`}])}}};D.useEffect(()=>{x.current&&x.current.scrollIntoView({behavior:"smooth"})},[P]);const N=async()=>{if(!k.trim()||T)return;if(i>0&&points<i){z(V=>[...V,{id:Date.now(),text:`Not enough points! You need ${i} points to use AI help.`,sender:"system"}]);return}const U={id:Date.now(),text:k,sender:"user"};z(V=>[...V,U]),S(""),M(!0),F(0);const b=(globalConfig==null?void 0:globalConfig.aiDelay)||0;if(b>0){const $=b*1e3/100;let re=0;const Z=setInterval(()=>{re++;const se=re/$*100;F(se),re>=$&&(clearInterval(Z),B(U.text))},100)}else B(U.text)},B=async U=>{try{a&&a(i);const b=await bt.getHelp(currentTaskId,U,taskContext),V={id:Date.now()+1,text:b,sender:"ai"};z($=>[...$,V])}catch(b){console.error("Error getting AI response:",b),z(V=>[...V,{id:Date.now()+1,text:"Sorry, I encountered an error. Please try again.",sender:"ai"}])}finally{M(!1),F(0)}},G=R();return u.jsxs("div",{className:"chat-container-sidebar",style:{height:"100%",display:"flex",flexDirection:"column"},children:[u.jsxs("div",{className:"chat-header",children:[u.jsx("h3",{children:h?"AI Teaching Assistant":"Chat Interface"}),u.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"2px"},children:h?"1 AI help per task (reliability varies)":"AI assistance disabled for this session"}),u.jsxs("div",{style:{marginTop:"10px",padding:"10px",background:"#e3f2fd",borderRadius:"6px",border:"1px solid #2196F3"},children:[u.jsx("div",{style:{fontSize:"11px",color:"#1976d2",fontWeight:"bold",marginBottom:"6px"},children:"Points Breakdown"}),u.jsx("div",{style:{fontSize:"10px",color:"#666",lineHeight:"1.6"},children:(()=>{const U=(n==null?void 0:n.materials)||0,b=(n==null?void 0:n.research)||0,V=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,$=(n==null?void 0:n.bonus)||0,re=1+b*.15,Z=U*re,se=Z+V+$;return u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{marginBottom:"4px"},children:[u.jsxs("strong",{children:[U,"  (1 + ",b,"0.15) = ",Z.toFixed(1)]}),V>0&&u.jsxs(u.Fragment,{children:[u.jsx("br",{}),"Interest: +",V.toFixed(1)]}),$!==0&&u.jsxs(u.Fragment,{children:[u.jsx("br",{}),"Bonus: ",$>=0?"+":"",$.toFixed(1)]}),u.jsx("br",{}),u.jsxs("strong",{children:["Total: ",se.toFixed(1)]})]}),u.jsxs("div",{style:{fontSize:"9px",color:"#888",marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #bbdefb"},children:["Materials: ",U," | Research: ",b," | Engagement: ",(n==null?void 0:n.engagement)||0,V>0&&` | Interest: ${V.toFixed(1)}`]})]})})()})]})]}),u.jsx("div",{className:"messages-sidebar",children:u.jsxs("div",{className:"messages-list",children:[P.map(U=>u.jsx("div",{className:`message ${U.sender}`,children:u.jsx("div",{className:"message-content",children:U.text})},U.id)),T&&u.jsxs("div",{className:"message ai loading",children:[u.jsxs("div",{className:"typing-indicator",children:[u.jsx("span",{}),u.jsx("span",{}),u.jsx("span",{})]}),H>0&&u.jsx("div",{style:{width:"100%",height:"4px",background:"#eee",marginTop:"5px",borderRadius:"2px"},children:u.jsx("div",{style:{width:`${H}%`,height:"100%",background:"#2196F3",borderRadius:"2px",transition:"width 0.1s linear"}})})]}),u.jsx("div",{ref:x})]})}),u.jsxs("div",{className:"chat-input-sidebar",children:[u.jsx("input",{type:"text",placeholder:h?"Ask about strategy and tips here...":"Chat disabled - no AI available",value:k,onChange:U=>S(U.target.value),onKeyPress:U=>U.key==="Enter"&&N(),disabled:!h}),u.jsx("button",{onClick:N,disabled:!k.trim()||!h,children:"Send"})]}),h&&u.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f8f9fa"},children:[u.jsxs("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:["AI Usage: ",y," total attempts",I&&u.jsxs("span",{style:{color:"#ff9800",fontWeight:"bold"},children:[" ","| Current task: 1/1 used"]})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"10px"},children:u.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[u.jsxs("button",{onClick:()=>C(),disabled:!G||I,style:{padding:"12px",background:I?"#ff9800":G?"#2196F3":"#ccc",color:"white",border:"none",borderRadius:"8px",cursor:G&&!I?"pointer":"not-allowed",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[u.jsx("span",{style:{fontSize:"18px"},children:""}),I?"AI Used (1/1)":G?"Help Task":"Start task first"]}),u.jsxs("button",{onClick:Ie,style:{padding:"12px",background:"#FF9800",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[u.jsx("span",{style:{fontSize:"18px"},children:""}),"Help Plan"]})]})}),u.jsx("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:G?u.jsx("span",{style:{color:"#4CAF50"},children:" AI ready to help"}):u.jsx("span",{style:{color:"#999"},children:" Navigate to a task to enable AI help"})})]}),!h&&u.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f5f5f5",textAlign:"center",color:"#666",fontSize:"14px"},children:[u.jsx("div",{style:{marginBottom:"5px"},children:" No AI Assistant"}),u.jsx("div",{style:{fontSize:"12px"},children:"Complete tasks using your own judgment"})]})]})}const du={generateCode(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`${t}-${e}`.toUpperCase()},async createCode(t={}){return{success:!0,code:this.generateCode(),data:t}},async markCodeAsUsed(t,e){if(!t)return{success:!1,error:"No code provided"};try{const n={code:t,status:"used",usedAt:Tn(),sessionId:e,createdAt:Tn()};return await Yd(Dt(Xe,"accessCodes",t),n),{success:!0}}catch(n){return console.error("Error marking code as used:",n),{success:!1,error:n.message}}},async checkCodeUsage(t){if(!t)return{used:!1};try{const e=await Wo(Dt(Xe,"accessCodes",t));if(e.exists()){const n=e.data();return{used:n.status==="used",sessionId:n.sessionId,usedAt:n.usedAt}}return{used:!1}}catch(e){return console.error("Error checking code usage:",e),{used:!1,error:e.message}}},getCodeFromURL(){const t=new URLSearchParams(window.location.search);return t.get("code")||t.get("c")||null},async verifyQualtricsCode(t){return{valid:!1,reason:"Qualtrics codes not yet supported"}}};function _I({onLoginSuccess:t}){const[e,n]=D.useState(""),[r,s]=D.useState(!1),[i,a]=D.useState(""),[l,c]=D.useState(!1),h={MASTER:{section:"ADMIN-MASTER",role:"master_admin",name:"Master Administrator",hasAI:!1,isMasterInterface:!0},ADMIN:{role:"admin",semesterDuration:72e4,name:"Admin User",hasAI:!0,checkpointSemester2:!0}},p=I=>({section:"TESTING-AI-CP",hasAI:!0,checkpointSemester2:!0,displayName:`${I} (Internal Tester - AI + Checkpoint)`}),y=I=>{if(h[I])return{valid:!0,type:"master",data:h[I]};const A=I.trim().replace(/[^a-zA-Z0-9\s\-_]/g,"");return A.length<2?{valid:!1,error:"Please enter a name with at least 2 characters"}:A.length>50?{valid:!1,error:"Name too long. Please use 50 characters or less"}:{valid:!0,type:"tester",condition:p(A),cleanName:A}},m=async I=>{if(I.preventDefault(),!e.trim()){a("Please enter your name");return}s(!0),a("");try{const A=y(e.trim());if(!A.valid){a(A.error||"Invalid Student ID"),s(!1);return}let P={timestamp:new Date().toISOString()};if(A.type==="master"){if(P={...P,studentIdentifier:e,role:A.data.role,semesterDuration:A.data.semesterDuration,displayName:A.data.name,section:A.data.isTestCode?"ADMIN-TEST":"ADMIN",hasAI:A.data.hasAI,checkpointSemester2:A.data.checkpointSemester2,isMasterCode:!0,isTestCode:A.data.isTestCode||!1,isMasterInterface:A.data.isMasterInterface||!1},A.data.isMasterInterface){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",displayName:A.data.name,section:"master_admin",hasAI:!0,checkpointSemester2:!0})),window.location.href=`${window.location.origin}?master=true`;return}}else if(A.type==="tester"){const k=A.condition,S=A.cleanName;P={...P,studentIdentifier:S,role:"tester",semesterDuration:72e4,displayName:k.displayName,section:k.section,hasAI:k.hasAI,checkpointSemester2:k.checkpointSemester2,isMasterCode:!1,isTestUser:!0}}const z=await du.createCode(P);z.success?(sessionStorage.setItem("gameConfig",JSON.stringify({semesterDuration:P.semesterDuration,role:P.role,studentId:P.studentIdentifier,displayName:P.displayName,section:P.section,hasAI:P.hasAI,checkpointSemester2:P.checkpointSemester2})),window.location.href=`${window.location.origin}?code=${z.code}`):a("Failed to generate access code. Please try again.")}catch(A){console.error("Login error:",A),a("System error. Please try again.")}finally{s(!1)}};return u.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",padding:"20px"},children:[u.jsxs("div",{style:{background:"white",padding:"48px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",maxWidth:"480px",width:"100%"},children:[u.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[u.jsxs("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a202c",marginBottom:"8px",lineHeight:"1.2"},children:["Scheduling Challenge:",u.jsx("br",{}),"Can you beat Park?"]}),u.jsx("p",{style:{fontSize:"16px",color:"#718096",marginTop:"12px"},children:"Enter your name to access the game"})]}),u.jsxs("form",{onSubmit:m,children:[u.jsxs("div",{style:{marginBottom:"24px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#2d3748",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.025em"},children:"Your Name:"}),u.jsx("input",{type:"text",value:e,onChange:I=>n(I.target.value),disabled:r,style:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e2e8f0",borderRadius:"8px",boxSizing:"border-box",fontFamily:"'SF Mono', Monaco, 'Courier New', monospace",transition:"all 0.2s ease",background:"#f7fafc",outline:"none"},onFocus:I=>{I.target.style.borderColor="#2196F3",I.target.style.background="white",I.target.style.boxShadow="0 0 0 3px rgba(33, 150, 243, 0.1)"},onBlur:I=>{I.target.style.borderColor="#e2e8f0",I.target.style.background="#f7fafc",I.target.style.boxShadow="none"}}),u.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"#a0aec0",lineHeight:"1.4"},children:"Enter your first and last name (2-50 characters)"})]}),i&&u.jsxs("div",{style:{background:"#fed7d7",color:"#c53030",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",fontSize:"14px",display:"flex",alignItems:"center",border:"1px solid #fc8181"},children:[u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",style:{marginRight:"8px",flexShrink:0},children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i]}),u.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:"600",background:r?"#cbd5e0":"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:r?"none":"0 4px 6px rgba(33, 150, 243, 0.25)",transform:r?"none":"translateY(0)"},onMouseDown:I=>{r||(I.target.style.transform="translateY(2px)",I.target.style.boxShadow="0 2px 4px rgba(33, 150, 243, 0.25)")},onMouseUp:I=>{r||(I.target.style.transform="translateY(0)",I.target.style.boxShadow="0 4px 6px rgba(33, 150, 243, 0.25)")},onMouseOver:I=>{r||(I.target.style.background="#1976D2")},onMouseOut:I=>{r||(I.target.style.background="#2196F3")},children:r?u.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[u.jsxs("svg",{className:"animate-spin",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px",animation:"spin 1s linear infinite"},children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",strokeOpacity:"0.25"}),u.jsx("path",{d:"M4 12a8 8 0 018-8",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),"Verifying Name..."]}):"Access Game"})]}),u.jsxs("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[u.jsx("p",{style:{fontSize:"14px",color:"#718096",marginBottom:"12px"},children:"Having trouble? Contact your instructor:"}),u.jsxs("p",{style:{fontSize:"16px",color:"#2196F3",fontWeight:"500"},children:["Park Sinchaisri",u.jsx("br",{}),u.jsx("a",{href:"mailto:parksinchaisri@haas.berkeley.edu",style:{color:"#2196F3",textDecoration:"none",borderBottom:"1px solid #2196F3",fontSize:"15px"},children:"parksinchaisri@haas.berkeley.edu"})]}),l&&u.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#f7fafc",borderRadius:"8px",fontSize:"11px",color:"#4a5568",lineHeight:"1.8"},children:[u.jsx("strong",{children:"Test Codes:"}),u.jsxs("div",{style:{marginTop:"8px",fontFamily:"monospace"},children:[u.jsx("div",{children:"ADMIN (Standard Game Mode)"}),u.jsx("div",{children:"MASTER (Master interface)"})]})]})]})]}),u.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const im={async checkDailyLimit(t){var r;if(!t)return{allowed:!0};const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);try{const s=fr(Xe,"sessions"),i=nI(s,Zg("studentId","==",t),Zg("startTime",">=",n)),a=await bo(i);if(!a.empty){const l=a.docs[0].data(),c=(r=l.startTime)!=null&&r.toDate?l.startTime.toDate():new Date(l.clientStartTime);return{allowed:!1,reason:"daily_limit",existingSession:l,nextAvailable:new Date(n.getTime()+24*60*60*1e3)}}return{allowed:!0}}catch(s){console.error("Error checking daily limit:",s);const i=`played_${t}_${n.toISOString().split("T")[0]}`;return localStorage.getItem(i)?{allowed:!1,reason:"daily_limit",nextAvailable:new Date(n.getTime()+24*60*60*1e3)}:{allowed:!0}}},async markDailyPlay(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=`played_${t}_${n.toISOString().split("T")[0]}`;localStorage.setItem(r,"true");const s=new Date(Date.now()-7*24*60*60*1e3);for(let i=0;i<localStorage.length;i++){const a=localStorage.key(i);if(a&&a.startsWith("played_")){const l=a.split("_")[2];l&&new Date(l)<s&&localStorage.removeItem(a)}}},async checkAccess(){try{const t=du.getCodeFromURL();if(!t)return{allowed:!1,reason:"Please login with your student ID",requiresCode:!0};const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),n=e.role==="admin"||e.role==="master_admin";if(!n&&e.studentId){const r=await this.checkDailyLimit(e.studentId);if(!r.allowed&&!r.refreshGranted){const i=r.nextAvailable;return{allowed:!1,reason:`You have already completed today's session. Please come back in ${Math.ceil((i-Date.now())/(1e3*60*60))} hours (after midnight).`,dailyLimitReached:!0,nextAvailable:i}}if(sessionStorage.getItem("activeSessionId"))return{allowed:!1,reason:"Page refresh is not allowed during the game. Your session has been terminated.",refreshAttempt:!0}}return e.studentId?(n||await this.markDailyPlay(e.studentId),{allowed:!0,newSession:!0,code:t,codeData:{status:"new",metadata:e},isAdmin:n}):{allowed:!1,reason:"Please login with your Berkeley student ID",requiresCode:!0}}catch(t){console.error("Error in checkAccess:",t);const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");return e.role==="admin"?{allowed:!0,newSession:!0,code:du.getCodeFromURL(),codeData:{status:"error_bypass",metadata:e},isAdmin:!0}:{allowed:!1,reason:"System error. Please try again.",requiresCode:!0}}},async createSession(t=null,e=null,n=!1){try{const r=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),s=r.role==="admin"||r.role==="master_admin",i={id:crypto.randomUUID(),accessCode:t,studentId:r.studentId||null,role:r.role||"student",semesterDuration:r.semesterDuration||72e4,displayName:r.displayName||"Student",startTime:Tn(),clientStartTime:new Date().toISOString(),status:"active",completedTasks:{},isPractice:n,isAdminSession:s,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`,section:r.section,hasAI:r.hasAI,checkpointSemester2:r.checkpointSemester2},l=(await cu(fr(Xe,"sessions"),i)).id;return localStorage.setItem("sessionId",l),sessionStorage.setItem("activeSessionId",l),s||(window.addEventListener("beforeunload",c=>{c.preventDefault(),c.returnValue="Your progress will be lost if you leave this page.",this.handleSessionAbandonment()}),document.addEventListener("visibilitychange",()=>{!s&&document.hidden})),l}catch(r){console.error("Error creating session:",r);const s=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(s.role==="admin"){const i="offline-"+Date.now();localStorage.setItem("sessionId",i),sessionStorage.setItem("activeSessionId",i);const a={id:i,accessCode:t,startTime:Date.now(),status:"active",isOffline:!0,studentId:s.studentId||null,role:s.role||"admin"};return localStorage.setItem("offlineSession",JSON.stringify(a)),i}throw r}},async handleSessionAbandonment(){const t=localStorage.getItem("sessionId");if(t&&!t.startsWith("offline-"))try{await pr(Dt(Xe,"sessions",t),{status:"abandoned",abandonedAt:Tn(),abandonReason:"page_unload"})}catch(e){console.error("Error marking session as abandoned:",e)}sessionStorage.removeItem("activeSessionId"),sessionStorage.removeItem("gameConfig")}};function wI(){const[t,e]=D.useState(""),[n,r]=D.useState(!1),[s,i]=D.useState(""),[a,l]=D.useState(!1),c=async()=>{r(!0),i(""),l(!1);try{const p=await du.createCode({createdBy:"admin",timestamp:new Date().toISOString()});p.success?e(p.code):i("Failed to generate code: "+p.error)}catch(p){i("Error: "+p.message)}finally{r(!1)}},h=()=>{const p=`${window.location.origin}?code=${t}`;navigator.clipboard.writeText(p),l(!0),setTimeout(()=>l(!1),2e3)};return u.jsxs("div",{style:{padding:"40px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, -apple-system, sans-serif"},children:[u.jsx("h1",{style:{color:"#333",marginBottom:"10px"},children:"Admin Dashboard"}),u.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:"Generate access codes for participants"}),u.jsxs("div",{style:{background:"#f8f9fa",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("button",{onClick:c,disabled:n,style:{padding:"12px 30px",fontSize:"16px",background:n?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:"bold"},children:n?"Generating...":"Generate New Access Code"}),t&&u.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"white",borderRadius:"6px",border:"1px solid #e0e0e0"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Generated Code"}),u.jsxs("div",{style:{marginBottom:"20px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Access Code:"}),u.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"18px",fontWeight:"bold"},children:t})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Full URL:"}),u.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"stretch"},children:[u.jsx("input",{type:"text",value:`${window.location.origin}?code=${t}`,readOnly:!0,style:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",background:"#f9f9f9"}}),u.jsx("button",{onClick:h,style:{padding:"10px 20px",background:a?"#4CAF50":"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:a?" Copied!":"Copy URL"})]})]}),u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"4px",fontSize:"14px",color:"#1976d2"},children:[u.jsx("strong",{children:"Note:"})," This code is valid for 24 hours and can only be used once."]})]}),s&&u.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"#ffebee",color:"#c62828",borderRadius:"4px"},children:s})]}),u.jsxs("div",{style:{marginTop:"40px",padding:"20px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666"},children:[u.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"How to use:"}),u.jsxs("ol",{style:{margin:"10px 0",paddingLeft:"20px"},children:[u.jsx("li",{children:"Generate a code using the button above"}),u.jsx("li",{children:"Copy the full URL"}),u.jsx("li",{children:"Share the URL with participants"}),u.jsx("li",{children:"Each participant can use their unique code once"})]})]})]})}function SI({sessionId:t,completedLevels:e,totalTime:n,gameMode:r}){const[s,i]=D.useState(""),[a,l]=D.useState(!1);D.useEffect(()=>{c()},[]);const c=()=>{const p=Date.now().toString(36).toUpperCase(),y=e.toString().padStart(2,"0"),m=r.limit==="time"?"T":"A",I=r.accuracy==="strict"?"S":"L",z=`GAME-${`${t}-${y}-${n}`.split("").reduce((k,S)=>k+S.charCodeAt(0),0).toString(36).toUpperCase().slice(-3)}-${y}-${m}${I}-${p}`;i(z)},h=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(s),l(!0),setTimeout(()=>l(!1),3e3);else{const p=document.createElement("textarea");p.value=s,p.style.position="fixed",p.style.top="0",p.style.left="0",p.style.width="2em",p.style.height="2em",p.style.padding="0",p.style.border="none",p.style.outline="none",p.style.boxShadow="none",p.style.background="transparent",p.style.opacity="0",document.body.appendChild(p),p.focus(),p.select();try{document.execCommand("copy")?(l(!0),setTimeout(()=>l(!1),3e3)):(console.error("Failed to copy using execCommand"),alert("Copy failed. Please manually select and copy the code."))}catch(y){console.error("Failed to copy:",y),alert("Copy failed. Please manually select and copy the code.")}document.body.removeChild(p)}}catch(p){console.error("Clipboard operation failed:",p),alert(`Copy failed. Here's your code to copy manually:

${s}`)}};return u.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"30px",marginTop:"30px",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},children:[u.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:" Your Completion Code"}),u.jsx("p",{style:{marginBottom:"20px",opacity:.9,fontSize:"16px"},children:"Copy this code and paste it into the Qualtrics survey to verify your completion:"}),u.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"20px",marginBottom:"20px",backdropFilter:"blur(10px)"},children:[u.jsx("div",{style:{fontFamily:"monospace",fontSize:"28px",fontWeight:"bold",letterSpacing:"2px",marginBottom:"15px",wordBreak:"break-all",textShadow:"2px 2px 4px rgba(0,0,0,0.2)",userSelect:"text",cursor:"text"},onClick:p=>{const y=window.getSelection(),m=document.createRange();m.selectNodeContents(p.currentTarget),y.removeAllRanges(),y.addRange(m)},title:"Click to select all text",children:s}),u.jsx("button",{onClick:h,style:{padding:"12px 30px",fontSize:"16px",fontWeight:"bold",background:a?"#4CAF50":"white",color:a?"white":"#764ba2",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:a?" Copied!":" Copy Code"})]}),u.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:"6px",padding:"15px",fontSize:"14px",lineHeight:"1.5"},children:[u.jsx("strong",{children:" Important:"})," This code is your proof of completion. Make sure to copy it before closing this window!",u.jsx("br",{}),u.jsx("span",{style:{fontSize:"13px",opacity:.9},children:" Tip: If the Copy button doesn't work, click on the code text to select it, then use Ctrl+C (or Cmd+C on Mac) to copy."})]}),u.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[u.jsx("summary",{style:{cursor:"pointer",opacity:.8,fontSize:"12px",marginBottom:"10px"},children:"Code Details "}),u.jsxs("div",{style:{fontSize:"12px",opacity:.7,background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",fontFamily:"monospace"},children:[u.jsxs("div",{children:["Levels Completed: ",e,"/45"]}),u.jsxs("div",{children:["Game Mode: ",r.limit==="time"?"Time Challenge":"Task Attempts"]}),u.jsxs("div",{children:["Accuracy Mode: ",r.accuracy==="strict"?"Strict (100%)":"Lenient"]}),u.jsxs("div",{children:["Total Time: ",Math.floor(n/60),"m ",n%60,"s"]}),u.jsxs("div",{children:["Generated: ",new Date().toLocaleString()]})]})]})]})}function TI({onClose:t}){const[e,n]=D.useState("config"),[r,s]=D.useState([]),[i,a]=D.useState(!0),[l,c]=D.useState(!1),[h,p]=D.useState(""),[y,m]=D.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,wrongAnswerPenalty:2,switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0,taskOrderStrategy:"sequential_task",difficultyMode:"fixed",scoring:{g1:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g2:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g3:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}}}}),[I,A]=D.useState(!1);D.useEffect(()=>{k(),R()},[]);const[P,z]=D.useState(null),k=async()=>{try{const b=Dt(Xe,"game_settings","global"),V=await Wo(b);if(V.exists()){const $={...y,...V.data()};m($),z($)}}catch(b){console.error("Error loading game config:",b)}},S=async()=>{A(!0);try{const b=Dt(Xe,"game_settings","global"),V=await Wo(b),$=V.exists()?V.data():{},re={};if(Object.keys(y).forEach(Z=>{JSON.stringify($[Z])!==JSON.stringify(y[Z])&&(re[Z]={from:$[Z],to:y[Z]})}),await Yd(b,y,{merge:!0}),Object.keys(re).length>0)try{const Z=fr(Xe,"game_settings_changes");await cu(Z,{timestamp:new Date().toISOString(),changedAt:Tn(),changes:re,changedBy:"master_admin",previousConfig:$,newConfig:y})}catch(Z){console.error("Error logging config changes:",Z)}z({...y}),alert("Configuration saved successfully!")}catch(b){console.error("Error saving config:",b),alert("Failed to save configuration")}finally{A(!1)}},T=(b,V)=>{m($=>({...$,[b]:V}))},[M,H]=D.useState([]),[F,w]=D.useState([]),[g,_]=D.useState([]),[E,x]=D.useState(null),R=async()=>{a(!0);try{const b=fr(Xe,"students"),V=await bo(b),$={},re=V.docs.map(he=>({id:he.id,...he.data()}));_(re),V.docs.forEach(he=>{$[he.id]={id:he.id,...he.data()}});const Z=fr(Xe,"sessions"),se=await bo(Z),X=se.docs.map(he=>({id:he.id,...he.data()}));H(X);const ie=fr(Xe,"events"),xe=(await bo(ie)).docs.map(he=>({id:he.id,...he.data()}));w(xe);const le=Dt(Xe,"game_settings","global"),ke=await Wo(le);ke.exists()&&x({id:ke.id,documentId:"global",...ke.data()}),console.log(`Debug: Found ${V.size} students and ${se.size} sessions`);const Ve=he=>he?/^[A-Za-z0-9]{20,}$/.test(he)&&he.length>=20:!1,Se={};se.docs.forEach(he=>{var rr;const ye=he.data();let Ae=ye.displayName||ye.studentIdentifier||ye.studentId;if(!Ae||Ve(Ae))if(ye.displayName&&Ve(ye.studentId))Ae=ye.displayName;else return;Se[Ae]||(Se[Ae]={totalAccesses:0,scores:[],hasPlayed:!1,lastPlayed:null,section:ye.section||"Unknown",sid:Ae,displayName:ye.displayName||Ae}),Se[Ae].totalAccesses+=1,Se[Ae].hasPlayed=!0;const vn=(rr=ye.startTime)!=null&&rr.toDate?ye.startTime.toDate():new Date(ye.clientStartTime||0);(!Se[Ae].lastPlayed||vn>Se[Ae].lastPlayed)&&(Se[Ae].lastPlayed=vn),ye.finalScore!==void 0&&Se[Ae].scores.push({total:ye.finalScore,learning:ye.studentLearningScore,timestamp:ye.completedAt})});const ze={};Object.keys($).forEach(he=>{const ye=$[he],Ae=ye.displayName||ye.studentIdentifier||ye.sid||he;Ve(Ae)||(ze[Ae]={...ye,id:Ae,sid:Ae,displayName:ye.displayName||Ae})});const at=Object.values(ze).map(he=>{const ye=Se[he.id]||Se[he.sid]||{};return{...he,...ye,scores:ye.scores||he.scores||[],totalAccesses:ye.totalAccesses||0,hasPlayed:ye.hasPlayed||!1,lastPlayed:ye.lastPlayed||null,displayName:ye.displayName||he.displayName||he.id}});Object.keys(Se).forEach(he=>{!Ve(he)&&!ze[he]&&!$[he]&&at.push({id:he,sid:he,...Se[he],displayName:Se[he].displayName||he})}),at.sort((he,ye)=>{const Ae=he.lastPlayed?he.lastPlayed.getTime():0;return(ye.lastPlayed?ye.lastPlayed.getTime():0)-Ae}),s(at)}catch(b){console.error("Error fetching students:",b)}finally{a(!1)}},C=async()=>{if(window.confirm("Are you sure you want to reset ALL student data? This cannot be undone!")){c(!0);try{const b=fr(Xe,"students"),V=await bo(b);for(const $ of V.docs)await Yd(Dt(Xe,"students",$.id),{hasPlayed:!1,totalAccesses:0,scores:[]},{merge:!0});alert("All student data has been reset!"),await R()}catch(b){console.error("Error resetting data:",b),alert("Failed to reset data")}finally{c(!1)}}},ne=async()=>{g.length===0&&await R();const b=["ID","Student ID","Section","Has Played","Last Played","Total Accesses","Highest Score"],V=g.filter(X=>{var ie;return!((ie=X.section)!=null&&ie.includes("ADMIN"))}).map(X=>{const ie=X.scores&&X.scores.length>0?Math.max(...X.scores.map(ve=>ve.total||0)):0;return[X.id||"",X.sid||X.id||"",X.section||"N/A",X.hasPlayed?"Yes":"No",X.lastPlayed?new Date(X.lastPlayed).toLocaleString():"-",X.totalAccesses||0,ie]}),$=[b.join(","),...V.map(X=>X.map(ie=>`"${String(ie).replace(/"/g,'""')}"`).join(","))].join(`
`),re=new Blob([$],{type:"text/csv;charset=utf-8;"}),Z=document.createElement("a"),se=URL.createObjectURL(re);Z.setAttribute("href",se),Z.setAttribute("download",`students_${new Date().toISOString().split("T")[0]}.csv`),Z.style.visibility="hidden",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)},me=async()=>{M.length===0&&await R();const b=["ID","Session ID","Student ID","Section","Start Time","Status","Final Score","Student Learning Score","Completed Tasks","Random Seed"],V=M.map(X=>{var xe;const ie=(xe=X.startTime)!=null&&xe.toDate?X.startTime.toDate().toLocaleString():X.clientStartTime?new Date(X.clientStartTime).toLocaleString():"-",ve=X.completedTasks?Object.keys(X.completedTasks).length:0;return[X.id||"",X.id||"",X.studentId||"",X.section||"N/A",ie,X.status||"unknown",X.finalScore!==void 0?X.finalScore:"",X.studentLearningScore!==void 0?X.studentLearningScore:"",ve,X.randomSeed||""]}),$=[b.join(","),...V.map(X=>X.map(ie=>`"${String(ie).replace(/"/g,'""')}"`).join(","))].join(`
`),re=new Blob([$],{type:"text/csv;charset=utf-8;"}),Z=document.createElement("a"),se=URL.createObjectURL(re);Z.setAttribute("href",se),Z.setAttribute("download",`sessions_${new Date().toISOString().split("T")[0]}.csv`),Z.style.visibility="hidden",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)},Ie=async()=>{F.length===0&&await R();const b=["ID","Session ID","Student ID","Username","Type","Timestamp","Client Timestamp","Time Elapsed Seconds","Readable Time","Current Task","Game Mode","Current Semester","Total Switches","AI Usage Count","Student Learning Score","Total Score","Event Data (JSON)"],V=F.map(X=>{const ie={...X};return delete ie.id,[X.id||"",X.sessionId||"",X.studentId||"",X.username||"",X.type||"",X.timestamp||"",X.clientTimestamp||"",X.timeElapsedSeconds||"",X.readableTime||"",X.currentTask||"",X.gameMode||"",X.currentSemester||"",X.totalSwitches||"",X.aiUsageCount||"",X.studentLearning||X.studentLearningScore||"",X.totalScore||X.finalScore||"",JSON.stringify(ie)]}),$=[b.join(","),...V.map(X=>X.map(ie=>`"${String(ie).replace(/"/g,'""').replace(/\n/g,"\\n").replace(/\r/g,"\\r")}"`).join(","))].join(`
`),re=new Blob([$],{type:"text/csv;charset=utf-8;"}),Z=document.createElement("a"),se=URL.createObjectURL(re);Z.setAttribute("href",se),Z.setAttribute("download",`events_${new Date().toISOString().split("T")[0]}.csv`),Z.style.visibility="hidden",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)},te=async()=>{if(!E&&(await R(),!E)){alert("No game settings found!");return}const b=["ID","Document ID","Setting Name","Setting Value (JSON)"],$=Object.entries(E).filter(([ie])=>ie!=="id"&&ie!=="documentId").map(([ie,ve])=>[E.id||"",E.documentId||"global",ie,typeof ve=="object"?JSON.stringify(ve):String(ve)]),re=[b.join(","),...$.map(ie=>ie.map(ve=>`"${String(ve).replace(/"/g,'""').replace(/\n/g,"\\n").replace(/\r/g,"\\r")}"`).join(","))].join(`
`),Z=new Blob([re],{type:"text/csv;charset=utf-8;"}),se=document.createElement("a"),X=URL.createObjectURL(Z);se.setAttribute("href",X),se.setAttribute("download",`game_settings_${new Date().toISOString().split("T")[0]}.csv`),se.style.visibility="hidden",document.body.appendChild(se),se.click(),document.body.removeChild(se)},N=()=>{ne(),setTimeout(()=>me(),500),setTimeout(()=>Ie(),1e3),setTimeout(()=>te(),1500)},B=b=>({padding:"12px 24px",background:b?"#2196F3":"transparent",color:b?"white":"#666",border:"none",borderBottom:b?"3px solid #2196F3":"3px solid transparent",cursor:"pointer",fontSize:"14px",fontWeight:b?"600":"normal",transition:"all 0.2s"}),G=r.filter(b=>{var V;return!((V=b.section)!=null&&V.includes("ADMIN"))}).length,U=r.filter(b=>{var V;return!((V=b.section)!=null&&V.includes("ADMIN"))&&b.hasPlayed}).length;return u.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h1",{style:{margin:0,color:"#333"},children:" Master Admin Dashboard"}),u.jsx("button",{onClick:t,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:"Exit Admin"})]}),u.jsxs("div",{style:{display:"flex",borderBottom:"1px solid #e0e0e0",marginBottom:"30px"},children:[u.jsx("button",{onClick:()=>n("config"),style:B(e==="config"),children:" Game Configuration"}),u.jsx("button",{onClick:()=>n("scoring"),style:B(e==="scoring"),children:" Scoring Configuration"}),u.jsx("button",{onClick:()=>n("players"),style:B(e==="players"),children:" Player Data"}),u.jsx("button",{onClick:()=>n("advice"),style:B(e==="advice"),children:" Game Advice"})]}),e==="config"&&u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h2",{style:{margin:0,fontSize:"20px",color:"#333"},children:"Game Configuration"}),u.jsx("button",{onClick:S,disabled:I,style:{padding:"10px 24px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:I?"not-allowed":"pointer",fontWeight:"600",fontSize:"14px",opacity:I?.6:1},children:I?"Saving...":" Save Settings"})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"20px",marginBottom:"20px"},children:[u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Time & Semesters"}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Semester Duration (Minutes)"}),u.jsx("input",{type:"number",value:y.semesterDuration,onChange:b=>T("semesterDuration",parseInt(b.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Semesters"}),u.jsx("input",{type:"number",value:y.totalSemesters,onChange:b=>T("totalSemesters",parseInt(b.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("input",{type:"checkbox",checked:y.midtermEnabled,onChange:b=>T("midtermEnabled",b.target.checked),id:"midtermCheck"}),u.jsx("label",{htmlFor:"midtermCheck",style:{fontSize:"13px",cursor:"pointer"},children:"Enable Midterm Checkpoint"})]})]}),u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Task Settings"}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Tasks per Semester"}),u.jsx("input",{type:"number",value:y.totalTasks,onChange:b=>T("totalTasks",parseInt(b.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Difficulty Configuration"}),u.jsxs("select",{value:y.difficultyMode||"fixed",onChange:b=>T("difficultyMode",b.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[u.jsx("option",{value:"fixed",children:"Fixed (50% Easy, 30% Medium, 20% Hard)"}),u.jsx("option",{value:"manual",children:"Manual (User chooses difficulty)"})]})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Task Order Strategy"}),u.jsxs("select",{value:y.taskOrderStrategy,onChange:b=>T("taskOrderStrategy",b.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[u.jsx("option",{value:"sequential_task",children:"Order by Task (Materials  Research  Engagement)"}),u.jsx("option",{value:"sequential_difficulty",children:"Order by Difficulty (Easy  Medium  Hard)"})]})]}),u.jsxs("div",{style:{marginTop:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Game Mode"}),u.jsxs("select",{value:y.gameMode||"knapsack",onChange:b=>T("gameMode",b.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[u.jsx("option",{value:"knapsack",children:"Knapsack Mode (Allocate tasks upfront, limited tasks)"}),u.jsx("option",{value:"sequential",children:"Sequential Mode (Infinite levels, countdown timer)"})]}),u.jsx("p",{style:{fontSize:"11px",color:"#666",marginTop:"5px"},children:"Sequential mode: Timer counts down, infinite levels, can keep playing until time runs out."})]})]}),u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Penalties & Mechanics"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Switch Cost (Points)"}),u.jsx("input",{type:"number",value:y.switchCost||0,onChange:b=>T("switchCost",parseInt(b.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Refill Freeze (Seconds)"}),u.jsx("input",{type:"number",value:y.jarRefillFreezeTime||0,onChange:b=>T("jarRefillFreezeTime",parseInt(b.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Unfinished Jar Penalty (Pts)"}),u.jsx("input",{type:"number",value:y.unfinishedJarPenalty||0,onChange:b=>T("unfinishedJarPenalty",parseInt(b.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"AI Delay (Seconds)"}),u.jsx("input",{type:"number",value:y.aiDelay||0,onChange:b=>T("aiDelay",parseInt(b.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]})]})]})]}),e==="scoring"&&u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h2",{style:{margin:0,fontSize:"20px",color:"#333"},children:"Scoring Configuration"}),u.jsx("button",{onClick:S,disabled:I,style:{padding:"10px 24px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:I?"not-allowed":"pointer",fontWeight:"600",fontSize:"14px",opacity:I?.6:1},children:I?"Saving...":" Save Settings"})]}),u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("p",{style:{fontSize:"13px",color:"#666",marginBottom:"20px"},children:'Configure points for each task type and difficulty level. "Full Correct" = perfect answer, "Half Correct" = partial credit.'}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px"},children:["g1","g2","g3"].map(b=>{const V={g1:"Research",g2:"Materials",g3:"Engagement"},$={g1:"",g2:"",g3:""},re={g1:"#9C27B0",g2:"#4CAF50",g3:"#f44336"};return u.jsxs("div",{style:{background:"#f9f9f9",padding:"15px",borderRadius:"8px",border:`2px solid ${re[b]}`},children:[u.jsxs("div",{style:{fontWeight:"bold",marginBottom:"12px",color:re[b],display:"flex",alignItems:"center",gap:"6px",fontSize:"14px"},children:[u.jsx("span",{children:$[b]}),u.jsx("span",{children:V[b]})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:["easy","medium","hard"].map(Z=>{var X,ie,ve,xe,le,ke;const se={easy:"E",medium:"M",hard:"H"};return u.jsxs("div",{style:{background:"white",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"},children:[u.jsx("div",{style:{fontSize:"10px",fontWeight:"600",marginBottom:"6px",color:"#666",textAlign:"center"},children:se[Z]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",fontSize:"9px",marginBottom:"2px",color:"#666"},children:"Full"}),u.jsx("input",{type:"number",min:"0",value:((ve=(ie=(X=y.scoring)==null?void 0:X[b])==null?void 0:ie[Z])==null?void 0:ve.fullCorrect)??2,onChange:Ve=>{const Se=parseInt(Ve.target.value)||0;m(ze=>{var at,he,ye;return{...ze,scoring:{...ze.scoring,[b]:{...(at=ze.scoring)==null?void 0:at[b],[Z]:{...(ye=(he=ze.scoring)==null?void 0:he[b])==null?void 0:ye[Z],fullCorrect:Se}}}}})},style:{width:"100%",padding:"4px",borderRadius:"3px",border:"1px solid #ddd",fontSize:"12px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",fontSize:"9px",marginBottom:"2px",color:"#666"},children:"Half"}),u.jsx("input",{type:"number",min:"0",value:((ke=(le=(xe=y.scoring)==null?void 0:xe[b])==null?void 0:le[Z])==null?void 0:ke.halfCorrect)??1,onChange:Ve=>{const Se=parseInt(Ve.target.value)||0;m(ze=>{var at,he,ye;return{...ze,scoring:{...ze.scoring,[b]:{...(at=ze.scoring)==null?void 0:at[b],[Z]:{...(ye=(he=ze.scoring)==null?void 0:he[b])==null?void 0:ye[Z],halfCorrect:Se}}}}})},style:{width:"100%",padding:"4px",borderRadius:"3px",border:"1px solid #ddd",fontSize:"12px"}})]})]})]},Z)})})]},b)})})]})]}),e==="players"&&u.jsxs("div",{style:{background:"white",padding:"25px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Active Sessions"}),u.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[u.jsx("button",{onClick:N,style:{padding:"10px 20px",background:"#9C27B0",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"600",fontSize:"14px"},children:" Download All Data"}),u.jsx("button",{onClick:ne,style:{padding:"10px 20px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",fontSize:"13px"},children:" Students"}),u.jsx("button",{onClick:me,style:{padding:"10px 20px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",fontSize:"13px"},children:" Sessions"}),u.jsx("button",{onClick:Ie,style:{padding:"10px 20px",background:"#FF9800",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",fontSize:"13px"},children:" Events"}),u.jsx("button",{onClick:te,style:{padding:"10px 20px",background:"#9E9E9E",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500",fontSize:"13px"},children:" Settings"}),u.jsx("button",{onClick:C,disabled:l,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:l?"not-allowed":"pointer",fontWeight:"500",fontSize:"13px",opacity:l?.6:1},children:l?"Processing...":" Reset All Data"})]})]}),u.jsx("div",{style:{marginBottom:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"6px"},children:u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",textAlign:"center"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:G}),u.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Total Students"})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:U}),u.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Have Played"})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:G-U}),u.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Never Played"})]})]})}),i?u.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"Loading student data..."}):u.jsx("div",{style:{overflowX:"auto"},children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{background:"#f5f5f5",textAlign:"left"},children:[u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Student ID"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Section"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Has Played"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Last Played"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Total Accesses"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Highest Score"})]})}),u.jsx("tbody",{children:r.filter(b=>{var V;return!((V=b.section)!=null&&V.includes("ADMIN"))}).map(b=>u.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[u.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:b.displayName||b.sid||b.id}),u.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:b.section||"N/A"}),u.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:u.jsx("span",{style:{padding:"4px 12px",borderRadius:"12px",background:b.hasPlayed?"#e8f5e9":"#f5f5f5",color:b.hasPlayed?"#4CAF50":"#999",fontSize:"12px",fontWeight:"500"},children:b.hasPlayed?"Yes":"No"})}),u.jsx("td",{style:{padding:"12px",fontSize:"13px",color:"#666"},children:b.lastPlayed?new Date(b.lastPlayed).toLocaleString():"-"}),u.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600"},children:b.totalAccesses||0}),u.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600",color:"#2196F3"},children:b.scores&&b.scores.length>0?Math.max(...b.scores.map(V=>V.total||0)):0})]},b.id))})]})})]}),e==="advice"&&u.jsxs("div",{style:{background:"white",padding:"60px 40px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),u.jsx("h2",{style:{fontSize:"24px",color:"#666",marginBottom:"15px",fontWeight:"500"},children:"Game Advice Configuration"}),u.jsx("p",{style:{color:"#999",maxWidth:"600px",margin:"0 auto 30px",lineHeight:"1.6"},children:"Configure contextual advice prompts based on remaining time and tasks completed. This feature will allow you to define dynamic advice messages for different game states."}),u.jsxs("div",{style:{marginTop:"40px",padding:"30px",background:"#f9f9f9",borderRadius:"8px",maxWidth:"500px",margin:"40px auto 0",border:"2px dashed #ddd"},children:[u.jsx("p",{style:{color:"#666",fontSize:"15px",margin:0,fontWeight:"500"},children:"Coming Soon: Dynamic 2D Advice Matrix"}),u.jsx("p",{style:{color:"#999",fontSize:"13px",margin:"10px 0 0",lineHeight:"1.5"},children:"Define advice based on time remaining  tasks completed thresholds"})]})]})]})}const EI={notifyGameComplete(t={}){try{window.parent.postMessage({type:"gameComplete",status:"finished",timestamp:new Date().toISOString(),...t},"*");try{if(window.parent&&window.parent.document){const e=window.parent.document.querySelector("#NextButton");e&&(e.style.display="inline-block",e.style.visibility="visible",e.disabled=!1)}}catch{window.parent.postMessage({type:"showNextButton",action:"show"},"*")}console.log(" Game completion notification sent to Qualtrics")}catch(e){console.error("Failed to notify Qualtrics:",e)}},notifySemesterComplete(t,e,n={}){try{window.parent.postMessage({type:"semesterComplete",semester:t,totalSemesters:e,timestamp:new Date().toISOString(),...n},"*"),window.parent.postMessage({type:"keepNextButtonVisible",action:"maintain"},"*"),console.log(` Semester ${t} completion notification sent`)}catch(r){console.error("Failed to notify Qualtrics of semester completion:",r)}},ensureNextButtonVisible(){try{window.parent.postMessage({type:"ensureNextButton",action:"show",timestamp:new Date().toISOString()},"*")}catch(t){console.error("Failed to ensure Next button visibility:",t)}}};function II({onStart:t,totalTasks:e=10,orderStrategy:n="sequential_task",durationMinutes:r=12,difficultyMode:s="fixed"}){const[i,a]=D.useState({g2:0,g1:0,g3:0}),[l,c]=D.useState({g2:{easy:0,medium:0,hard:0},g1:{easy:0,medium:0,hard:0},g3:{easy:0,medium:0,hard:0}}),[h,p]=D.useState([]),[y,m]=D.useState(0),[I,A]=D.useState(null),P=["It's generally smart to do roughly an even number of each task.","This is because the tasks that are worth more points take more time to do, so you don't want to only do the shorter tasks or only do the longer tasks.","Of course, you might prefer one task over another, so you could take that into account. Do you feel like you are particularly good at one of the tasks?"],z=()=>{y<P.length?(p(g=>[...g,{sender:"AI",text:P[y]}]),m(g=>g+1)):p(g=>[...g,{sender:"AI",text:"I've shared my best advice! It's up to you now."}])},k=(g,_)=>{const E=parseInt(_)||0;a(x=>({...x,[g]:Math.max(0,E)})),A(null)},S=(g,_,E)=>{const x=parseInt(E)||0;c(R=>({...R,[g]:{...R[g],[_]:Math.max(0,x)}})),A(null)},H=s==="manual"?(()=>{let g=0;return Object.values(l).forEach(_=>{g+=_.easy+_.medium+_.hard}),g})():Object.values(i).reduce((g,_)=>g+_,0),F=H===e,w=()=>{if(H!==e){A(`Total tasks must equal ${e}. Currently: ${H}`);return}let g=[];s==="fixed"?["g2","g1","g3"].forEach(ne=>{const me=i[ne];if(me>0){const Ie=me*.5,te=me*.3,N=me*.2;let B=Math.floor(Ie),G=Math.floor(te),U=Math.floor(N),b=me-B-G-U;for(;b>0;){const $=Ie-B,re=te-G,Z=N-U;$>=re&&$>=Z?B++:re>=Z?G++:U++,b--}const V=B+G+U;if(V!==me){const $=me-V;$>0?B+=$:B=Math.max(0,B+$)}for(let $=0;$<B;$++)g.push({type:ne,difficulty:"easy"});for(let $=0;$<G;$++)g.push({type:ne,difficulty:"medium"});for(let $=0;$<U;$++)g.push({type:ne,difficulty:"hard"})}}):["g2","g1","g3"].forEach(ne=>{const{easy:me,medium:Ie,hard:te}=l[ne];for(let N=0;N<me;N++)g.push({type:ne,difficulty:"easy"});for(let N=0;N<Ie;N++)g.push({type:ne,difficulty:"medium"});for(let N=0;N<te;N++)g.push({type:ne,difficulty:"hard"})});const _={g2:{easy:1,medium:6,hard:11},g1:{easy:1,medium:6,hard:11},g3:{easy:1,medium:6,hard:11}},E=g.map(ne=>{const{type:me,difficulty:Ie}=ne,te=_[me][Ie]++;return{...ne,id:`${me}t${te}`}});let x=[];if(n==="sequential_difficulty"){const ne={easy:1,medium:2,hard:3},me={g2:1,g1:2,g3:3};x=E.sort((Ie,te)=>ne[Ie.difficulty]!==ne[te.difficulty]?ne[Ie.difficulty]-ne[te.difficulty]:me[Ie.type]-me[te.type])}else{const ne={g2:1,g1:2,g3:3},me={easy:1,medium:2,hard:3};x=E.sort((Ie,te)=>ne[Ie.type]!==ne[te.type]?ne[Ie.type]-ne[te.type]:me[Ie.difficulty]-me[te.difficulty])}const R=x.map(ne=>ne.id),C=s==="fixed"?i:{g2:l.g2.easy+l.g2.medium+l.g2.hard,g1:l.g1.easy+l.g1.medium+l.g1.hard,g3:l.g3.easy+l.g3.medium+l.g3.hard};t(R,C)};return u.jsxs("div",{style:{maxWidth:"900px",margin:"40px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[u.jsx("h1",{style:{textAlign:"center",marginBottom:"30px",color:"#333"},children:"Task Allocation Strategy"}),u.jsxs("div",{style:{marginBottom:"30px",lineHeight:"1.6",color:"#555"},children:[u.jsxs("p",{children:["You have ",u.jsxs("strong",{children:[r," minutes"]})," to complete ",u.jsxs("strong",{children:[e," tasks"]}),"."]}),u.jsx("p",{children:"You must decide now how many of each task type you want to perform."}),u.jsxs("p",{children:["Total tasks must add up to ",u.jsx("strong",{children:e}),"."]}),s==="fixed"&&u.jsx("p",{style:{fontSize:"14px",fontStyle:"italic",color:"#666"},children:"* Within each task type, tasks are distributed as 50% Easy, 30% Medium, 20% Hard."})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"40px",marginBottom:"40px"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[s==="fixed"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:Dc,children:[u.jsxs("label",{style:Nc,children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 1: Slider (Materials)"]}),u.jsx("input",{type:"number",min:"0",max:e,value:i.g2,onChange:g=>k("g2",g.target.value),style:Mc})]}),u.jsxs("div",{style:Dc,children:[u.jsxs("label",{style:Nc,children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 2: Counting (Research)"]}),u.jsx("input",{type:"number",min:"0",max:e,value:i.g1,onChange:g=>k("g1",g.target.value),style:Mc})]}),u.jsxs("div",{style:Dc,children:[u.jsxs("label",{style:Nc,children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 3: Typing (Engagement)"]}),u.jsx("input",{type:"number",min:"0",max:e,value:i.g3,onChange:g=>k("g3",g.target.value),style:Mc})]})]}):u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px"},children:[u.jsx(cr,{icon:"",taskName:"Materials",difficulty:"Easy",value:l.g2.easy,onChange:g=>S("g2","easy",g),color:"#4CAF50"}),u.jsx(cr,{icon:"",taskName:"Materials",difficulty:"Medium",value:l.g2.medium,onChange:g=>S("g2","medium",g),color:"#4CAF50"}),u.jsx(cr,{icon:"",taskName:"Materials",difficulty:"Hard",value:l.g2.hard,onChange:g=>S("g2","hard",g),color:"#4CAF50"}),u.jsx(cr,{icon:"",taskName:"Research",difficulty:"Easy",value:l.g1.easy,onChange:g=>S("g1","easy",g),color:"#9C27B0"}),u.jsx(cr,{icon:"",taskName:"Research",difficulty:"Medium",value:l.g1.medium,onChange:g=>S("g1","medium",g),color:"#9C27B0"}),u.jsx(cr,{icon:"",taskName:"Research",difficulty:"Hard",value:l.g1.hard,onChange:g=>S("g1","hard",g),color:"#9C27B0"}),u.jsx(cr,{icon:"",taskName:"Engagement",difficulty:"Easy",value:l.g3.easy,onChange:g=>S("g3","easy",g),color:"#f44336"}),u.jsx(cr,{icon:"",taskName:"Engagement",difficulty:"Medium",value:l.g3.medium,onChange:g=>S("g3","medium",g),color:"#f44336"}),u.jsx(cr,{icon:"",taskName:"Engagement",difficulty:"Hard",value:l.g3.hard,onChange:g=>S("g3","hard",g),color:"#f44336"})]}),u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:F?"#e8f5e9":"#ffebee",borderRadius:"8px",textAlign:"center",fontWeight:"bold",color:F?"#2e7d32":"#c62828"},children:["Total Allocated: ",H," / ",e]}),I&&u.jsx("div",{style:{color:"red",textAlign:"center",fontSize:"14px"},children:I})]}),u.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"12px",padding:"20px",display:"flex",flexDirection:"column"},children:[u.jsxs("div",{style:{flex:1,marginBottom:"15px",overflowY:"auto",maxHeight:"300px",display:"flex",flexDirection:"column",gap:"10px"},children:[h.length===0&&u.jsx("div",{style:{color:"#999",fontStyle:"italic",textAlign:"center",marginTop:"40px"},children:"Need advice? Ask the AI helper."}),h.map((g,_)=>u.jsxs("div",{style:{background:"#f0f7ff",padding:"10px 15px",borderRadius:"12px 12px 12px 0",alignSelf:"flex-start",maxWidth:"90%"},children:[u.jsx("strong",{children:" AI:"})," ",g.text]},_))]}),u.jsxs("button",{onClick:z,style:{background:"#2196F3",color:"white",border:"none",padding:"12px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[u.jsx("span",{children:""})," Ask AI for Recommendation"]})]})]}),u.jsx("div",{style:{textAlign:"center"},children:u.jsx("button",{onClick:w,disabled:!F,style:{background:F?"#4CAF50":"#ccc",color:"white",border:"none",padding:"15px 40px",fontSize:"18px",borderRadius:"30px",cursor:F?"pointer":"not-allowed",fontWeight:"bold",boxShadow:F?"0 4px 15px rgba(76, 175, 80, 0.3)":"none",transition:"all 0.2s"},children:"Start Experiment"})})]})}const cr=({icon:t,taskName:e,difficulty:n,value:r,onChange:s,color:i})=>u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",background:"#f9f9f9",padding:"20px",borderRadius:"12px",border:`2px solid ${i}40`,transition:"all 0.2s"},children:[u.jsx("div",{style:{fontSize:"24px",marginBottom:"8px"},children:t}),u.jsx("div",{style:{fontSize:"14px",fontWeight:"bold",color:i,marginBottom:"4px",textAlign:"center"},children:e}),u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"12px",textAlign:"center"},children:n}),u.jsx("input",{type:"number",min:"0",max:100,value:r,onChange:a=>s(a.target.value),style:{width:"70px",padding:"12px",textAlign:"center",border:`2px solid ${i}`,borderRadius:"8px",fontSize:"18px",fontWeight:"bold",color:i,background:"white"}})]}),Dc={display:"flex",alignItems:"center",justifyContent:"space-between",background:"#f9f9f9",padding:"15px",borderRadius:"8px"},Nc={fontWeight:"bold",color:"#333",display:"flex",alignItems:"center"},Mc={width:"60px",padding:"10px",fontSize:"18px",textAlign:"center",borderRadius:"6px",border:"1px solid #ddd"};function CI({currentTaskIndex:t,totalTasks:e,taskQueue:n,onSwitchTask:r,onRefill:s,onFinishNow:i,children:a,points:l,timeRemaining:c,onTimeUp:h,penalties:p={switch:0,refill:0,unfinished:0},chatInterface:y,difficultyMode:m="fixed",categoryPoints:I={materials:0,research:0,engagement:0},globalConfig:A={},allTasksCompleted:P=!1,engagementInterest:z=0}){const k=n[t];(x=>x.startsWith("g1")?{name:"Research",icon:"",color:"#9C27B0",bg:"#f3e5f5"}:x.startsWith("g2")?{name:"Materials",icon:"",color:"#4CAF50",bg:"#e8f5e9"}:x.startsWith("g3")?{name:"Engagement",icon:"",color:"#f44336",bg:"#ffebee"}:{name:"Unknown",icon:"",color:"#333",bg:"#eee"})(k);const T=n.slice(0,t),M={g1:T.filter(x=>x.startsWith("g1")).length,g2:T.filter(x=>x.startsWith("g2")).length,g3:T.filter(x=>x.startsWith("g3")).length},H=e-t,F=P?[]:n.slice(t),w=x=>{const R=parseInt(x.substring(3))||1;return m==="manual"?R<=5?"easy":R<=10?"medium":"hard":R<=25?"easy":R<=40?"medium":"hard"};let g;m==="manual"?g={"g2-easy":F.filter(x=>x.startsWith("g2")&&w(x)==="easy"),"g2-medium":F.filter(x=>x.startsWith("g2")&&w(x)==="medium"),"g2-hard":F.filter(x=>x.startsWith("g2")&&w(x)==="hard"),"g1-easy":F.filter(x=>x.startsWith("g1")&&w(x)==="easy"),"g1-medium":F.filter(x=>x.startsWith("g1")&&w(x)==="medium"),"g1-hard":F.filter(x=>x.startsWith("g1")&&w(x)==="hard"),"g3-easy":F.filter(x=>x.startsWith("g3")&&w(x)==="easy"),"g3-medium":F.filter(x=>x.startsWith("g3")&&w(x)==="medium"),"g3-hard":F.filter(x=>x.startsWith("g3")&&w(x)==="hard")}:g={g2:F.filter(x=>x.startsWith("g2")),g1:F.filter(x=>x.startsWith("g1")),g3:F.filter(x=>x.startsWith("g3"))};const _=x=>{if(m==="manual"){const R=w(k);return k.startsWith(x.split("-")[0])&&R===x.split("-")[1]}else return k.startsWith(x)},E=(x,R,C,ne,me,Ie,te=null)=>{const N=Ie.length,B=_(x),G=N>0,U=x;return u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",background:me,borderRadius:"10px",padding:m==="manual"?"8px":"10px",border:`2px solid ${B?ne:"transparent"}`,height:m==="manual"?"auto":"100%",minHeight:m==="manual"?"120px":"auto",position:"relative"},children:[u.jsxs("div",{style:{fontSize:m==="manual"?"12px":"14px",fontWeight:"bold",color:ne,marginBottom:m==="manual"?"6px":"10px",display:"flex",alignItems:"center",gap:"5px",justifyContent:"center"},children:[u.jsx("span",{children:C}),u.jsx("span",{children:N})]}),u.jsx("div",{style:{flex:1,width:"100%",display:"flex",flexDirection:"column",gap:"5px",justifyContent:"flex-end",paddingBottom:"10px"},children:G?u.jsxs(u.Fragment,{children:[!B&&Ie.length>0&&u.jsx("div",{style:{width:"90%",height:"25px",border:"2px dashed #999",borderRadius:"4px",margin:"0 auto 8px auto",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",color:"#666",background:"rgba(255, 255, 255, 0.5)",cursor:"pointer"},onClick:()=>r(U),title:"Click to switch to this task type",children:" Switch"}),Ie.map((b,V)=>{const $=V===0&&B;return u.jsx("div",{style:{height:$?"35px":"8px",width:"80%",background:ne,opacity:$?1:.4,borderRadius:"4px",margin:"0 auto",display:$?"flex":"block",alignItems:"center",justifyContent:"center",color:$?"white":"transparent",fontSize:"10px",fontWeight:"bold",cursor:$?"default":"pointer"},onClick:!B&&V===0?()=>r(U):void 0,children:$?"Current":""},V)})]}):u.jsx("button",{onClick:()=>s&&s(U),style:{width:"100%",padding:"10px 5px",background:"white",border:"2px dashed #999",borderRadius:"8px",color:"#666",cursor:"pointer",fontSize:"12px"},children:" Refill"})}),u.jsxs("div",{style:{fontSize:m==="manual"?"11px":"12px",color:"#666",marginTop:m==="manual"?"4px":"5px",textAlign:"center"},children:[R,te&&u.jsx("div",{style:{fontSize:"10px",color:"#999"},children:te})]})]})};return u.jsxs("div",{style:{maxWidth:"95vw",margin:"0 auto",padding:"20px"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"white",padding:"15px 25px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[u.jsx("div",{style:{width:"200px"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""}),u.jsx("div",{children:u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:c<60?"#f44336":"#333",animation:c<60?"pulse 1s infinite":"none"},children:[Math.floor(c/60),":",(c%60).toString().padStart(2,"0")]})})]})}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:"Student Learning Score"}),u.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#2196F3"},children:typeof l=="number"?l.toFixed(1):l}),u.jsxs("div",{style:{marginTop:"10px",fontSize:"10px",color:"#666",textAlign:"center",background:"#f5f5f5",padding:"10px 12px",borderRadius:"6px",width:"280px",margin:"10px auto 0"},children:[u.jsx("div",{style:{fontWeight:"600",marginBottom:"4px",color:"#333",fontSize:"10px"},children:"Rules:"}),u.jsxs("div",{style:{fontSize:"9px",lineHeight:"1.5"},children:["Switch: -",(A==null?void 0:A.switchCost)||0," pts",u.jsx("br",{}),"Refill: ",(A==null?void 0:A.jarRefillFreezeTime)||0,"s pause",u.jsx("br",{}),"Unfinished: -",(A==null?void 0:A.unfinishedTaskPenalty)||0," pts"]})]})]}),u.jsxs("div",{style:{textAlign:"right",minWidth:"300px"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"5px"},children:"Task Progress"}),u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"15px"},children:[u.jsxs("div",{style:{display:"flex",gap:"10px",fontSize:"16px",fontWeight:"500",color:"#555"},children:[u.jsxs("span",{title:"Materials Done",children:[" ",M.g2]}),u.jsx("span",{style:{color:"#ddd"},children:"|"}),u.jsxs("span",{title:"Research Done",children:[" ",M.g1]}),u.jsx("span",{style:{color:"#ddd"},children:"|"}),u.jsxs("span",{title:"Engagement Done",children:[" ",M.g3]})]}),u.jsxs("div",{style:{background:"#eee",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold",color:"#333"},children:["Remaining: ",H]})]})]})]}),u.jsxs("div",{className:"task-runner-layout",style:{display:"grid",gridTemplateColumns:"300px 1fr 340px",gap:"20px",height:"calc(100vh - 140px)",boxSizing:"border-box"},children:[u.jsxs("div",{style:{background:"white",padding:"15px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",height:"fit-content",maxHeight:"100%"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#666",textAlign:"center"},children:"Task Jars"}),m==="manual"?u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",flex:1},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#4CAF50",marginBottom:"4px"},children:"Materials"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:[E("g2-easy","Easy","","#4CAF50","#e8f5e9",g["g2-easy"],null),E("g2-medium","Medium","","#4CAF50","#e8f5e9",g["g2-medium"],null),E("g2-hard","Hard","","#4CAF50","#e8f5e9",g["g2-hard"],null)]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#9C27B0",marginBottom:"4px"},children:"Research"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:[E("g1-easy","Easy","","#9C27B0","#f3e5f5",g["g1-easy"],null),E("g1-medium","Medium","","#9C27B0","#f3e5f5",g["g1-medium"],null),E("g1-hard","Hard","","#9C27B0","#f3e5f5",g["g1-hard"],null)]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#f44336",marginBottom:"4px"},children:"Engagement"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:[E("g3-easy","Easy","","#f44336","#ffebee",g["g3-easy"],null),E("g3-medium","Medium","","#f44336","#ffebee",g["g3-medium"],null),E("g3-hard","Hard","","#f44336","#ffebee",g["g3-hard"],null)]})]})]}):u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px",flex:1},children:[E("g2","Materials","","#4CAF50","#e8f5e9",g.g2),E("g1","Research","","#9C27B0","#f3e5f5",g.g1),E("g3","Engagement","","#f44336","#ffebee",g.g3)]}),P&&u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#fff3cd",borderRadius:"8px",border:"2px solid #ffc107",textAlign:"center"},children:[u.jsx("p",{style:{fontSize:"13px",color:"#856404",margin:"0 0 12px 0",lineHeight:"1.5"},children:" All tasks completed! You can either finish early or continue by refilling jars."}),u.jsx("button",{onClick:i,style:{width:"100%",padding:"12px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",transition:"all 0.2s"},onMouseOver:x=>{x.currentTarget.style.background="#45a049",x.currentTarget.style.transform="translateY(-1px)"},onMouseOut:x=>{x.currentTarget.style.background="#4CAF50",x.currentTarget.style.transform="translateY(0)"},children:" Finish Now"})]})]}),u.jsx("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",overflow:"hidden",display:"flex",flexDirection:"column"},children:a}),u.jsx("div",{style:{height:"100%",overflow:"hidden"},children:y&&u.jsx("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:y})})]}),u.jsx("style",{children:`
        @keyframes pulse {
          0% { opacity: 1; }
          50% { opacity: 0.5; }
          100% { opacity: 1; }
        }
      `})]})}function AI({timeRemaining:t,onSelectTask:e,onFinishEarly:n}){return u.jsxs("div",{style:{maxWidth:"800px",margin:"40px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[u.jsx("h1",{style:{color:"#2196F3",marginBottom:"20px"},children:" All Tasks Completed!"}),u.jsxs("div",{style:{fontSize:"18px",color:"#555",marginBottom:"30px",lineHeight:"1.6"},children:[u.jsx("p",{children:"You have finished all 10 allocated tasks with time to spare."}),u.jsxs("p",{children:["You currently have ",u.jsxs("strong",{children:[Math.floor(t/60)," minutes and ",t%60," seconds"]})," remaining."]}),u.jsxs("p",{children:["You can choose to do more tasks for ",u.jsx("strong",{children:"1/2 credit"})," to increase your score, or finish the experiment now."]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"40px"},children:[u.jsxs("button",{onClick:()=>e("g2"),style:Vc("#4CAF50"),children:[u.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Materials Task",u.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),u.jsxs("button",{onClick:()=>e("g1"),style:Vc("#9C27B0"),children:[u.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Research Task",u.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),u.jsxs("button",{onClick:()=>e("g3"),style:Vc("#f44336"),children:[u.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Engagement Task",u.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]})]}),u.jsx("div",{style:{borderTop:"1px solid #eee",paddingTop:"30px"},children:u.jsx("button",{onClick:n,style:{background:"#f5f5f5",color:"#666",border:"1px solid #ddd",padding:"12px 30px",fontSize:"16px",borderRadius:"30px",cursor:"pointer",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:r=>r.target.style.background="#e0e0e0",onMouseLeave:r=>r.target.style.background="#f5f5f5",children:"No thanks, I'm done"})})]})}const Vc=t=>({background:"white",border:`2px solid ${t}`,color:t,padding:"20px",borderRadius:"12px",cursor:"pointer",fontSize:"16px",fontWeight:"bold",transition:"all 0.2s",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"});function kI(t,e){const n=t.length,r=e.length,s=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let i=0;i<=n;i++)s[i][0]=i;for(let i=0;i<=r;i++)s[0][i]=i;for(let i=1;i<=n;i++)for(let a=1;a<=r;a++)t[i-1]===e[a-1]?s[i][a]=s[i-1][a-1]:s[i][a]=Math.min(s[i-1][a]+1,s[i][a-1]+1,s[i-1][a-1]+1);return s[n][r]}function RI(){const e=new URLSearchParams(window.location.search).get("admin")==="berkeley2024",[n,r]=D.useState("landing"),[s,i]=D.useState(null),[a,l]=D.useState(null),[c,h]=D.useState("g2t1"),[p,y]=D.useState({}),[m,I]=D.useState(0),[A,P]=D.useState(null),[z,k]=D.useState(!1),[S,T]=D.useState(""),[M,H]=D.useState(!0),[F,w]=D.useState(0),[g,_]=D.useState({}),[E,x]=D.useState(0),[R,C]=D.useState(0),[ne,me]=D.useState(!1),[Ie,te]=D.useState(null),[N,B]=D.useState(!1),[G,U]=D.useState(30),[b,V]=D.useState(!1),[$,re]=D.useState(5),[Z,se]=D.useState(!1),[X,ie]=D.useState(0),[ve,xe]=D.useState(!1),[le,ke]=D.useState(1),[Ve]=D.useState(2),[Se,ze]=D.useState([]),[at,he]=D.useState(null),[ye,Ae]=D.useState(!1),[vn,rr]=D.useState(0),[kr,sr]=D.useState({}),[Gs,ft]=D.useState({}),[Ct,Rr]=D.useState({}),[Pa,Qs]=D.useState({}),[fs,qn]=D.useState(null),[nt,ja]=D.useState({g2t1:!1,g1t1:!1,g3t1:!1}),[so,Da]=D.useState(720),[ir,ps]=D.useState(720),[gs,Ks]=D.useState(0),[fe,An]=D.useState({materials:0,research:0,engagement:0,bonus:0}),[or,kn]=D.useState({}),[$u,br]=D.useState({}),[Wu,ar]=D.useState({}),[Rn,pt]=D.useState({switch:0,refill:0,unfinished:0}),[be,ms]=D.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,unfinishedTaskPenalty:0,taskOrderStrategy:"sequential_task",freezePenalty:0,contextAdviceEnabled:!0,difficultyMode:"fixed",switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0,gameMode:"knapsack",scoring:{g1:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g2:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g3:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}}}});D.useEffect(()=>{(async()=>{try{const L=Dt(Xe,"game_settings","global"),Q=await Wo(L);if(Q.exists()){const K=Q.data();if(ms(ue=>({...ue,...K})),localStorage.setItem("globalConfig",JSON.stringify({...K})),K.semesterDuration){const ue=K.semesterDuration*60;Da(ue),ps(ue),vs.current=ue,ao.current=ue}}}catch(L){console.error("Error loading global config:",L)}})()},[]);const[At,Pr]=D.useState([]),[bn,ln]=D.useState(0),[Hu,qu]=D.useState(null),[io,Gu]=D.useState(!1),[Ys,jr]=D.useState([]),[Pn,Xs]=D.useState(!1),[Dr,Js]=D.useState(!0),[Zs,Na]=D.useState(0),ei=D.useRef(Date.now()),ys=D.useRef(null);D.useRef(null),D.useRef(null);const Nr=D.useRef(null),oo=D.useRef(Date.now()),ao=D.useRef(720),vs=D.useRef(720),un=()=>{const q=(be.semesterDuration||12)*60*1e3,L=Math.floor(q/2e3);return Math.floor(L/60)};D.useEffect(()=>{(async()=>{try{const L=new URLSearchParams(window.location.search),Q=L.has("code")||L.has("c");if((L.get("code")||L.get("c"))==="MASTER"){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",section:"master_admin",hasAI:!1,isMasterInterface:!0,displayName:"Master Administrator"})),H(!1);return}if(e&&!sessionStorage.getItem("gameConfig")&&sessionStorage.setItem("gameConfig",JSON.stringify({role:"admin",section:"admin",hasAI:!0,checkpointSemester2:!0,displayName:"Admin User"})),!Q){r("studentLogin"),H(!1);return}const{allowed:ue,reason:ce,resumeSession:pe,newSession:Ce,code:Oe,codeData:Be}=await im.checkAccess();if(!ue){k(!0),T(ce),H(!1);return}if(pe)P(pe),localStorage.setItem("sessionId",pe);else if(Ce){const kt=await im.createSession(Oe,Be);P(kt)}await Ue.syncOfflineEvents(),H(!1)}catch{H(!1)}})()},[]),D.useEffect(()=>{n==="complete"&&le>=Ve&&EI.notifyGameComplete({finalScore:Math.round(jn())+(fe.bonus||0),totalTime:F,semestersCompleted:le,sessionId:A})},[n,le,Ve,F,fe.bonus,A]),D.useEffect(()=>{localStorage.setItem("currentTask",c)},[c]),D.useEffect(()=>{localStorage.setItem("gameMode",JSON.stringify(s))},[s]),D.useEffect(()=>{localStorage.setItem("currentSemester",le.toString())},[le]),D.useEffect(()=>{localStorage.setItem("totalSemesters",Ve.toString())},[Ve]),D.useEffect(()=>{localStorage.setItem("completedTasksCount",Object.keys(p).length.toString())},[p]),D.useEffect(()=>{localStorage.setItem("completedLevels",m.toString())},[m]),D.useEffect(()=>{localStorage.setItem("totalSwitches",E.toString())},[E]),D.useEffect(()=>{localStorage.setItem("categoryPoints",JSON.stringify(fe))},[fe]);const jn=(q=fe,L=or)=>{const Q=q.materials||0,K=q.research||0,ue=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,ce=Q*(1+K*.15),pe=ce+ue+(q.bonus||0);return console.log(` STUDENT LEARNING: ${pe.toFixed(1)} pts | Materials: ${Q}  (1 + ${K}0.15) = ${ce.toFixed(1)} | Interest: ${ue.toFixed(1)} | Total: ${pe.toFixed(1)}`),isNaN(pe)?0:pe};D.useEffect(()=>{const q=setInterval(()=>{Ma(Q=>Q+1);const L=jn();Ks(L)},2e3);return()=>clearInterval(q)},[fe,or,Rn]);const[Df,Ma]=D.useState(0);if(D.useEffect(()=>{localStorage.setItem("studentLearningScore",gs.toString())},[gs]),D.useEffect(()=>{const q=nt.g2t1&&nt.g1t1&&nt.g3t1;localStorage.setItem("practiceCompleted",q.toString())},[nt]),M)return u.jsx("div",{className:"app",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:u.jsx("h2",{children:"Loading..."})});if(window.location.search.includes("master=true")&&JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="master_admin")return u.jsx(TI,{onClose:()=>{window.history.replaceState({},document.title,window.location.pathname),window.location.reload()}});if(window.location.search.includes("admin=true"))return u.jsx(wI,{});const Va=()=>{if(!(le===2&&be.midtermEnabled))return;Ae(!0),jn()>=300?(rr(300),An(K=>({...K,bonus:(K.bonus||0)+300}))):rr(0),me(!0),te("checkpoint")},xs=()=>{const q=(be.semesterDuration||12)*60*1e3,L=Math.floor(q/1e3);Da(L),ps(L),ei.current=Date.now(),ys.current=setInterval(()=>{const K=Date.now()-ei.current,ue=Math.floor(K/1e3);w(ue);const ce=Math.max(0,L-ue);if(ps(ce),ue%10===0&&A&&!A.startsWith("offline-")&&pr(Dt(Xe,"sessions",A),{timeElapsed:ue,lastUpdated:Tn()}).catch(Ce=>console.error("Failed to update session time:",Ce)),le===2&&be.midtermEnabled){const Ce=(be.semesterDuration||12)*60*1e3,Oe=Math.floor(Ce/2e3);ue===Oe&&!ye&&Va()}ce<=0&&(clearInterval(ys.current),ys.current=null,_s("semester_complete"))},1e3)},ti=q=>{const Q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin",K=nt.g2t1&&nt.g1t1&&nt.g3t1;l(q),Ue.logEvent("practice_choice",{choice:q}),q==="no"?!Q&&!K?(Nn("You must complete all three practice tasks first!"),r("practice")):ni():r("practice")},ni=()=>{if(at){if(Object.keys(kr).length===0){ut.initializeSeed(at);const L={},Q={},K={},ue={};for(let ce=1;ce<=100;ce++)L[ce]=ut.generateSliderPattern(ce),Q[ce]=ut.generateCountingPattern(ce),K[ce]=ut.generateTypingPattern(ce),ue[ce]=ut.getTextPassage(ce);sr(L),ft(Q),Rr(K),Qs(ue)}}else{const L=Math.floor(Math.random()*1e6);he(L),ut.initializeSeed(L);const Q={},K={},ue={},ce={};for(let pe=1;pe<=100;pe++)Q[pe]=ut.generateSliderPattern(pe),K[pe]=ut.generateCountingPattern(pe),ue[pe]=ut.generateTypingPattern(pe),ce[pe]=ut.getTextPassage(pe);sr(Q),ft(K),Rr(ue),Qs(ce),A&&!A.startsWith("offline-")&&pr(Dt(Xe,"sessions",A),{randomSeed:L,[`semesterSeeds.semester${le}`]:L})}localStorage.setItem("engagementInterest","0"),An({materials:0,research:0,engagement:0,bonus:0}),kn({}),(be.gameMode||"knapsack")==="sequential"?(r("challenge"),h("g2t1"),y({}),I(0),x(0),C(0),Ae(!1),br({}),ar({}),pt({switch:0,refill:0,unfinished:0}),xs()):(r("allocation"),y({}),I(0),x(0),C(0),Ae(!1),br({}),ar({}),pt({switch:0,refill:0,unfinished:0}))},La=(q,L)=>{Pr(q),qu(L),ln(0),r("challenge");const K=`${q[0]}t1`;h(K),_({[K]:Date.now()}),Ue.setPageStartTime(K),xs(),Ue.logEvent("allocation_complete",{counts:L,queue:q,timestamp:Date.now()})},Fa=q=>{const L=At[bn],Q=L.substring(0,2);let K=q,ue=null;q.includes("-")&&([K,ue]=q.split("-"));const ce=parseInt(L.substring(3))||1,pe=ce<=5?"easy":ce<=10?"medium":"hard";if(be.difficultyMode==="manual"){if(Q===K&&pe===ue)return}else if(Q===K)return;const Ce=be.switchCost||0;Ce>0&&(An(je=>({...je,bonus:(je.bonus||0)-Ce})),pt(je=>({...je,switch:je.switch+Ce})),Nn(`Switching tasks cost ${Ce} points!`));const Oe=[...At],Be=Oe.slice(bn),kt=Oe.slice(0,bn),xt=je=>{const Qn=parseInt(je.substring(3))||1;return Qn<=5?"easy":Qn<=10?"medium":"hard"},Gn=Be.filter(je=>je.startsWith(Q));let gt;be.difficultyMode==="manual"&&ue?gt=Be.filter(je=>{const Qn=je.startsWith(K),za=xt(je)===ue;return Qn&&za}):gt=Be.filter(je=>je.startsWith(K));const Qe=Be.filter(je=>!je.startsWith(Q)&&!je.startsWith(K)),Mr=[...gt,...Qe,...Gn],si=[...kt,...Mr];if(Pr(si),x(je=>je+1),Ue.logEvent("task_switch",{fromTask:At[bn],toTaskType:K,toDifficulty:ue,switchCost:Ce,currentTaskIndex:bn,queueLength:si.length,totalSwitches:E+1,currentScore:Math.round(((fe==null?void 0:fe.materials)||0)+((fe==null?void 0:fe.research)||0)+((fe==null?void 0:fe.engagement)||0)-(Rn.switch+Rn.unfinished))}).catch(je=>console.error("Error tracking switch:",je)),gt.length>0){const je=gt[0];Dn(je).catch(Qn=>console.error("Error tracking switch:",Qn))}},lo=async(q,L)=>{var ai,Ke;oo.current=Date.now();let Q=0;const K=q.startsWith("g1")?"research":q.startsWith("g2")?"materials":"engagement",ue=q.startsWith("g1")?"g1":q.startsWith("g2")?"g2":"g3",ce=parseInt(q.substring(3))||1,pe=ce<=5?"easy":ce<=10?"medium":"hard",Ce=((Ke=(ai=be.scoring)==null?void 0:ai[ue])==null?void 0:Ke[pe])||{fullCorrect:2,halfCorrect:1},Oe=Ce.fullCorrect||2,Be=Ce.halfCorrect||1;let kt=!1,xt=!1;if(K==="materials"){const we=parseFloat(L.userAnswer||L.userValue||0),et=parseFloat(L.correctAnswer||L.targetValue||0),lt=Math.abs(we-et);kt=lt===0,xt=lt>0&&lt<=1}else if(K==="research"){const we=parseInt(L.userAnswer||0),et=parseInt(L.correctAnswer||0),lt=Math.abs(we-et);kt=lt===0,xt=lt>0&&lt<=1}else if(K==="engagement"){const we=L.userAnswer||"",et=L.correctAnswer||"";we===et?kt=!0:xt=kI(we,et)===1}if(kt?Q=Oe:xt?Q=Be:Q=0,An(we=>{const et={...we,[K]:we[K]+Q};return console.log(` Updated ${K}: +${Q} (total: ${et[K]})`),et}),K==="materials"&&Q>0){const we=fe.research;kn(et=>{const lt=et[we]||0;return{...et,[we]:lt+Q}})}const gt=.0015*(K==="engagement"?fe.engagement+Q:fe.engagement),Qe={...fe,[K]:fe[K]+Q};let Mr=or;if(K==="materials"&&Q>0){const we=fe.research,et=or[we]||0;Mr={...or,[we]:et+Q}}const si=Qe.materials||0,je=Qe.research||0,Qn=si*(1+je*.15),Vr=parseFloat(localStorage.getItem("engagementInterest")||"0")+gt*Qn;localStorage.setItem("engagementInterest",Vr.toString()),ar(we=>({...we,[q]:Q})),br(we=>({...we,[q]:(we[q]||0)+1}));const ii={...fe,[K]:fe[K]+Q},oi=jn(ii,Mr);Ks(oi);let Ot="";if(K==="materials"){const we=Math.abs((L.userValue||0)-(L.targetValue||0));we===0?Ot="Perfect materials!":we<=1?Ot=`Off by ${we.toFixed(2)}`:Ot=`Off by ${we.toFixed(2)}`}else if(K==="research"){const we=Math.abs((L.userAnswer||0)-(L.correctAnswer||0));we===0?Ot="Perfect research!":we<=1?Ot=`Off by ${we}`:Ot=`Off by ${we}`}else K==="engagement"&&(Q===2?Ot="Perfect engagement!":Q===1?Ot="One typo":Ot="Multiple errors");Nn(`${Ot} | +${Q} ${K} pts`),y(we=>({...we,[q]:!0})),I(we=>we+1),C(we=>we+1),await Ue.trackTaskComplete(q,L.attempts,L.totalTime,L.accuracy||L.difference||0);const Ss=Math.round((Qe.materials||0)+(Qe.research||0)+(Qe.engagement||0)-(Rn.switch+Rn.unfinished));if(await Ue.logEvent("task_complete",{taskId:q,...L,goal:L.correctAnswer||L.targetValue||L.pattern||null,playerSubmission:L.userAnswer||L.userValue||L.input||null,aiSubmission:L.aiHelpValue||L.aiSuggestion||null,userAnswer:L.userAnswer||L.userValue||L.input||null,correctAnswer:L.correctAnswer||L.targetValue||L.pattern||null,pointsEarned:Q,categoryPoints:Qe,studentLearningScore:oi,engagementInterest:Vr,totalScore:Ss,completionContext:{totalTasksCompleted:Object.keys(p).length+1,currentGameTime:F,switchesBeforeCompletion:E,bonusPromptsEarned:R+1,timeRemaining:ir}}),A&&!A.startsWith("offline-")&&await pr(Dt(Xe,"sessions",A),{[`completedTasks.${q}`]:!0,[`taskPoints.${q}`]:Q,categoryPoints:Qe,studentLearningScore:oi,engagementInterest:Vr,bonusPrompts:R+1,lastActivity:Tn()}),(be.gameMode||"knapsack")==="sequential"){const we=q.substring(0,2),et=parseInt(q.substring(3))||1;if(et<100){const lt=`${we}t${et+1}`;Dn(lt,!0)}else{const lt=["g2","g1","g3"],Ts=lt.indexOf(we);if(Ts<lt.length-1){const Lr=`${lt[Ts+1]}t1`;Dn(Lr,!0)}else Dn("g2t1",!0)}}else{const we=bn+1;if(we<At.length){ln(we);const et=At[we];let lt=Object.keys(p).filter(Lr=>Lr.startsWith(et)).length;et===q.substring(0,2)&&q.startsWith(et)&&(lt+=1);const Ts=lt+1,li=`${et}t${Ts}`;Dn(li,!0)}else xe(!0)}},Dn=async(q,L=!1)=>{if(ne)return;if(p[q]&&!L){Nn("Task already completed! Choose a different task.");return}const Q=c;if(h(q),_(K=>({...K,[q]:Date.now()})),Ue.setPageStartTime(q),oo.current=Date.now(),b&&(V(!1),re(5),Nr.current&&(clearInterval(Nr.current),Nr.current=null)),Q!==q&&!L&&x(K=>K+1),L||Ue.logEvent("manual_tab_switch",{from:Q,to:q,reason:"user_clicked"}).catch(K=>console.error("Error logging tab switch:",K)),Ue.trackPageSwitch(Q,q,L).catch(K=>console.error("Error tracking page switch:",K)),g[Q]){const K=Date.now()-g[Q];Ue.logEvent("task_time",{taskId:Q,timeSpent:K,completed:p[Q]||!1,leftForTask:q}).catch(ue=>console.error("Error logging task time:",ue))}},Nn=q=>{const L=document.createElement("div");L.className="notification-enter",L.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",L.textContent=q,document.body.appendChild(L),setTimeout(()=>{L.className="notification-exit",setTimeout(()=>{document.body.contains(L)&&document.body.removeChild(L)},500)},3e3)},_s=async(q="semester_complete")=>{ys.current&&clearInterval(ys.current);const L=Math.floor((Date.now()-ei.current-X)/1e3),Q=jn(),K=fe.bonus||0,ue=Math.max(0,be.totalTasks-Object.keys(p).length),ce=ue*(be.unfinishedTaskPenalty||0);ce>0&&pt(Ce=>({...Ce,unfinished:ce}));const pe=Math.round(Q)+K-ce;ce>0&&console.log(` Unfinished Penalty: -${ce} pts (${ue} tasks x ${be.unfinishedTaskPenalty})`),await Ue.logEvent("game_complete",{totalTime:L,totalSwitches:E,completedTasks:Object.keys(p).length,completedLevels:m,completionReason:q,gameMode:s,currentSemester:le,categoryPoints:fe,studentLearningScore:Q,totalBonus:K,finalScore:pe,finalContext:{practiceCompleted:a==="yes",totalPrompts:3+R,isAdminMode:e}}),A&&!A.startsWith("offline-")&&await pr(Dt(Xe,"sessions",A),{status:"completed",completedAt:Tn(),finalTime:L,timeElapsed:L,totalSwitches:E,completionReason:q,currentSemester:le,finalScore:pe,studentLearningScore:Q}),r("complete")},Oa=async q=>{const L={sender:"user",text:q,timestamp:Date.now()};jr(K=>[...K,L]),Xs(!0);const Q={currentTask:c,timeRemaining:ir,score:Math.round(gs),completedTasks:Object.keys(p).length,totalTasks:At.length};try{const K=(be.aiDelay||0)*1e3,ue=await bt.getAdvice(q,Q);setTimeout(()=>{const ce={sender:"ai",text:ue,timestamp:Date.now()};jr(pe=>[...pe,ce]),Xs(!1),Dr||Na(pe=>pe+1),Ue.logEvent("ai_chat_message",{userMessage:q,aiResponse:ue,currentTask:c,context:Q,aiDelay:K/1e3,currentScore:Math.round(gs),timeRemaining:ir}).catch(pe=>console.error("Error tracking AI chat:",pe)),be.aiCost>0&&(An(pe=>({...pe,bonus:(pe.bonus||0)-be.aiCost})),Nn(`AI Help Cost: -${be.aiCost} pts`))},Math.max(1e3,K))}catch(K){console.error("AI Error:",K),Xs(!1),jr(ue=>[...ue,{sender:"ai",text:"I'm having trouble connecting right now. Please try again.",timestamp:Date.now()}])}},Qt=(q,L)=>{if(L&&L.points&&L.points===2)ja(Q=>({...Q,[q]:!0})),Nn("Perfect! Practice task completed."),setTimeout(()=>{qn(null)},1500);else{const Q=(L==null?void 0:L.points)||0;Nn(`Practice requires 100% accuracy. You scored ${Q===1?"50%":"0%"}. Try again!`),setTimeout(()=>{qn(null)},2e3)}},xn=()=>{const q=c[1],L=parseInt(c.substring(3)),Q=n==="practice";if(q==="1"){const ue=Gs[L],ce=Pa[L];return u.jsx(Jd,{taskNum:L,onComplete:Q?Qt:lo,currentTaskId:c,isPractice:Q,preGeneratedPattern:ue,preGeneratedText:ce})}if(q==="2"){const ue=kr[L];return u.jsx(Zd,{taskNum:L,onComplete:Q?Qt:lo,currentTaskId:c,isPractice:Q,preGeneratedPattern:ue})}const K=Ct[L];return u.jsx(eh,{taskNum:L,onComplete:Q?Qt:lo,currentTaskId:c,isPractice:Q,preGeneratedPattern:K})};if(n==="studentLogin")return u.jsx(_I,{onLoginSuccess:q=>{window.location.href=`${window.location.origin}?code=${q}`}});if(z)return u.jsx("div",{className:"app",children:u.jsxs("div",{style:{maxWidth:"600px",margin:"50px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[u.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Access Denied"}),u.jsx("p",{style:{fontSize:"18px",marginBottom:"20px"},children:S}),u.jsx("div",{style:{padding:"15px",background:"#ffebee",borderRadius:"8px",border:"1px solid #f44336"},children:u.jsx("p",{style:{color:"#c62828",margin:0},children:"If you believe this is an error, please contact your instructor."})})]})});if(n==="semesterBreak"){const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),L=le===2&&q.checkpointSemester2;return u.jsx("div",{className:"app",children:u.jsxs("div",{style:{maxWidth:"700px",margin:"50px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[u.jsxs("h1",{style:{color:"#2196F3",marginBottom:"30px"},children:[" Semester ",le-1," Complete!"]}),u.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[u.jsx("h3",{style:{color:"#1976d2",marginBottom:"10px"},children:"Take a Break!"}),u.jsxs("p",{style:{fontSize:"16px",color:"#666",marginBottom:"0"},children:["Great job completing Semester ",le-1,"! Take a moment to rest your eyes, stretch, or grab some water before continuing."]})]}),L&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",padding:"25px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #ff9800"},children:[u.jsx("h3",{style:{color:"#f57c00",marginBottom:"15px"},children:" Midterm Checkpoint Coming!"}),u.jsxs("div",{style:{fontSize:"16px",color:"#666",textAlign:"left"},children:[u.jsx("p",{style:{marginBottom:"10px"},children:u.jsxs("strong",{children:["Semester 2 includes a midterm exam at the"," ",un(),"-minute mark!"]})}),u.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"10px"},children:[u.jsx("li",{children:"Your students will be tested at the midpoint"}),u.jsxs("li",{children:["If student learning  300 points:"," ",u.jsx("strong",{children:"+300 bonus points!"})]}),u.jsx("li",{children:"Build up your teaching effectiveness early to maximize the bonus"})]}),u.jsxs("p",{style:{background:"white",padding:"10px",borderRadius:"4px",textAlign:"center",fontWeight:"bold",color:"#f57c00"},children:["Goal: Reach 300+ Student Learning by minute"," ",un()]})]})]}),Se.length>0&&u.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[u.jsx("h4",{style:{color:"#666",marginBottom:"10px"},children:"Your Performance So Far:"}),Se.map((Q,K)=>u.jsxs("div",{style:{marginBottom:"8px",fontSize:"16px"},children:["Semester ",K+1,":"," ",u.jsxs("strong",{children:[Q.finalScore," points"]})]},K))]}),u.jsxs("div",{style:{marginTop:"30px"},children:[u.jsxs("button",{onClick:()=>{ke(K=>K+1),(be.gameMode||"knapsack")==="knapsack"?r("allocation"):(r("challenge"),xs()),y({}),Pr([]),ln(0),xe(!1),Ks(0),An({materials:0,research:0,engagement:0,bonus:0}),xs(),_({g2t1:Date.now()}),Ue.setPageStartTime("g2t1"),Ue.logEvent("semester_start",{semester:le,timestamp:Date.now(),hasCheckpoint:L})},style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:Q=>{Q.currentTarget.style.transform="translateY(-2px)",Q.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:Q=>{Q.currentTarget.style.transform="translateY(0)",Q.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["I'm Ready - Start Semester ",le]}),u.jsx("p",{style:{marginTop:"15px",fontSize:"14px",color:"#999"},children:"Click when you're ready to continue. The timer will start immediately."})]})]})})}if(n==="landing"){s||i({accuracy:"lenient",limit:"time"});const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),L=q.role==="admin",Q=be.gameMode||"knapsack",K=be.semesterDuration||12,ue=be.totalTasks||10;return u.jsx("div",{className:"app",children:u.jsx("div",{style:{maxWidth:"1000px",margin:"40px auto",padding:"0 20px"},children:u.jsxs("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",padding:"40px"},children:[u.jsxs("h1",{style:{color:"#333",marginBottom:"10px",fontSize:"32px",textAlign:"center",fontWeight:"600"},children:["Can you beat Park? - Semester ",le,"/",Ve]}),u.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%)",borderRadius:"12px",padding:"25px",marginBottom:"35px",border:"2px solid #2196F3",boxShadow:"0 2px 8px rgba(33, 150, 243, 0.2)"},children:[u.jsx("h2",{style:{color:"#1976d2",fontSize:"24px",marginBottom:"15px",textAlign:"center",fontWeight:"600"},children:" Game Overview"}),u.jsxs("p",{style:{fontSize:"18px",color:"#333",textAlign:"center",marginBottom:"12px",fontWeight:"500"},children:["You have"," ",u.jsxs("strong",{style:{color:"#1976d2"},children:[K," minutes"]})," ","to do"," ",u.jsxs("strong",{style:{color:"#1976d2"},children:[ue," tasks"]}),", in what order?"]}),Q==="sequential"?u.jsxs("p",{style:{fontSize:"16px",color:"#555",textAlign:"center",fontStyle:"italic",background:"white",padding:"12px",borderRadius:"8px",marginTop:"10px"},children:[" ",u.jsx("strong",{children:"Sequential Mode:"})," Do as much as you can - the timer counts down but levels are infinite!"]}):u.jsxs("p",{style:{fontSize:"16px",color:"#555",textAlign:"center",fontStyle:"italic",background:"white",padding:"12px",borderRadius:"8px",marginTop:"10px"},children:[" ",u.jsx("strong",{children:"Knapsack Mode:"})," You can choose how many of each task to do!"]})]}),u.jsxs("div",{className:"game-info",style:{textAlign:"left"},children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px",marginBottom:"20px"},children:[u.jsxs("div",{style:{background:"#ffebee",borderRadius:"10px",padding:"15px",border:"2px solid #f44336",boxShadow:"0 2px 6px rgba(244, 67, 54, 0.1)"},children:[u.jsxs("h3",{style:{color:"#f44336",fontSize:"16px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""})," Engagement"]}),u.jsx("p",{style:{fontSize:"13px",lineHeight:"1.5",color:"#555",margin:0},children:"Build interest that compounds! Each point adds 0.15% interest after every task completion."})]}),u.jsxs("div",{style:{background:"#f3e5f5",borderRadius:"10px",padding:"15px",border:"2px solid #9C27B0",boxShadow:"0 2px 6px rgba(156, 39, 176, 0.1)"},children:[u.jsxs("h3",{style:{color:"#9C27B0",fontSize:"16px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""})," Research"]}),u.jsx("p",{style:{fontSize:"13px",lineHeight:"1.5",color:"#555",margin:0},children:"Research amplifies your FUTURE materials! Each point adds +15% multiplier to materials earned after the research (order matters!)."})]}),u.jsxs("div",{style:{background:"#e8f5e9",borderRadius:"10px",padding:"15px",border:"2px solid #4CAF50",boxShadow:"0 2px 6px rgba(76, 175, 80, 0.1)"},children:[u.jsxs("h3",{style:{color:"#4CAF50",fontSize:"16px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""})," Materials"]}),u.jsx("p",{style:{fontSize:"13px",lineHeight:"1.5",color:"#555",margin:0},children:"Create teaching materials - each point directly contributes to your goal points!"})]})]}),u.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #f0f8ff 100%)",borderRadius:"12px",padding:"25px",marginBottom:"30px",border:"2px solid #2196F3",boxShadow:"0 2px 8px rgba(33, 150, 243, 0.15)"},children:[u.jsxs("h3",{style:{color:"#1976d2",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px",fontWeight:"600"},children:[u.jsx("span",{style:{fontSize:"22px"},children:""})," Student Learning Formula"]}),u.jsxs("div",{style:{background:"white",padding:"12px",borderRadius:"8px",fontFamily:"monospace",fontSize:"14px",textAlign:"center",marginBottom:"12px",border:"2px solid #2196F3",lineHeight:"1.6"},children:["Goal ="," ",u.jsx("strong",{style:{color:"#1976d2"},children:"Materials  (1 + Research0.15) + Engagement Interest"}),u.jsxs("div",{style:{fontSize:"11px",marginTop:"6px",fontFamily:"sans-serif",color:"#666"},children:["Research multipliers apply only to materials earned"," ",u.jsx("em",{children:"after"})," the research"]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px",fontSize:"12px"},children:[u.jsxs("div",{children:[u.jsx("strong",{children:"Scoring:"})," Exact = 2 pts | Within 1 = 1 pt | Otherwise = 0 pts"]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Timing:"})," Task completion order affects your final score"]})]}),le===2&&u.jsxs("div",{style:{marginTop:"8px",fontSize:"12px",color:"#f57c00",fontWeight:"600"},children:["At minute ",un(),": Exam checkpoint (300+ Student Learning = 300 bonus)"]})]}),q.hasAI&&u.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"1px solid #ffc107"},children:[u.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"AI Assistant Available:"}),u.jsxs("ul",{style:{color:"#856404",lineHeight:"1.6",margin:"0",paddingLeft:"20px",fontSize:"14px"},children:[u.jsx("li",{children:"Click the help buttons below each task for AI assistance"}),u.jsx("li",{children:"Unlimited use but reliability varies"}),u.jsx("li",{children:'Type "strategy" or "order" in chat for strategic advice!'})]})]}),le===2&&u.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"2px solid #ffc107"},children:[u.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:" Semester 2: Midterm Checkpoint!"}),u.jsxs("p",{style:{color:"#856404",fontSize:"14px",margin:0},children:["At the ",un(),"-minute mark, if you have 300+ student learning points, you'll earn a 300-point bonus!"]})]})]}),!L&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)",borderRadius:"12px",padding:"20px",marginTop:"20px",marginBottom:"20px",border:"2px solid #d32f2f",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"12px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""}),u.jsx("h3",{style:{color:"#b71c1c",margin:0,fontSize:"18px",fontWeight:"600"},children:"ONE ATTEMPT ONLY - NO RESTART"})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),u.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[u.jsx("strong",{children:"No refresh/close"})," - Session ends"]})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),u.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[u.jsx("strong",{children:"No tab switching"})," - 30s warning"]})]})]}),u.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"6px",textAlign:"center",fontSize:"14px",color:"#b71c1c",fontWeight:"600"},children:" Ensure 40 minutes uninterrupted before starting"})]}),u.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:u.jsxs("button",{onClick:()=>r("practiceChoice"),style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:ce=>{ce.currentTarget.style.transform="translateY(-2px)",ce.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:ce=>{ce.currentTarget.style.transform="translateY(0)",ce.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",le]})}),e&&u.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#ffcccb",borderRadius:"6px",border:"2px solid #ff0000",fontWeight:"bold",color:"#d00"},children:["ADMIN MODE: ",so/60," minute timer, checkpoint at"," ",un(),"minute"]}),Se.length>0&&u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"6px",fontSize:"14px"},children:[u.jsx("strong",{children:"Previous Semesters:"}),Se.map((ce,pe)=>u.jsxs("div",{style:{marginTop:"5px"},children:["Semester ",pe+1,": ",ce.finalScore," points"]},pe))]})]})})})}if(n==="practiceChoice"){const L=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";return u.jsx("div",{className:"app",children:u.jsx("div",{className:"landing-container",children:u.jsxs("div",{className:"landing-card",children:[u.jsx("h2",{style:{color:"#333",marginBottom:"20px"},children:L?"Practice Mode (Optional for Admin)":"Practice Mode (Required)"}),u.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:L?"As an admin, you can skip practice or try it first.":"You must complete all three practice tasks before starting the main game."}),u.jsx("p",{style:{color:"#888",fontSize:"14px",marginBottom:"30px",fontStyle:"italic"},children:"Practice lets you try each teaching task without time pressure."}),!L&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #1976d2",boxShadow:"0 4px 6px rgba(25, 118, 210, 0.1)"},children:[u.jsxs("h4",{style:{color:"#0d47a1",margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""}),"Required Practice Tasks (100% accuracy needed):"]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:nt.g2t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${nt.g2t1?"#4CAF50":"#e0e0e0"}`},children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),u.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:u.jsx("strong",{children:"Materials"})}),nt.g2t1?u.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):u.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:nt.g1t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${nt.g1t1?"#4CAF50":"#e0e0e0"}`},children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),u.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:u.jsx("strong",{children:"Research"})}),nt.g1t1?u.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):u.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:nt.g3t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${nt.g3t1?"#4CAF50":"#e0e0e0"}`},children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),u.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:u.jsx("strong",{children:"Engagement"})}),nt.g3t1?u.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):u.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]})]}),u.jsx("div",{style:{marginTop:"16px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"6px",fontSize:"13px",color:"#0d47a1",textAlign:"center",fontStyle:"italic"},children:" Each task must be completed perfectly to proceed"})]}),u.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[u.jsx("button",{onClick:()=>ti("yes"),style:{padding:"15px 30px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:L?"Try Practice Mode":"Start Required Practice"}),L&&u.jsx("button",{onClick:()=>ti("no"),style:{padding:"15px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:"Skip Practice (Admin)"})]})]})})})}if(n==="practice"){const L=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";if(!fs)return u.jsxs("div",{className:"app",children:[u.jsx("h1",{children:"Teaching Simulation - Practice Mode"}),u.jsx(vI,{practiceCompleted:nt,onPracticeComplete:Qt,onSelectPractice:qn,onStartMainGame:()=>{const ue=nt.g2t1&&nt.g1t1&&nt.g3t1;!L&&!ue?Nn("You must complete all three practice tasks first!"):ni()},isAdmin:L})]});const Q=fs[1],K=1;return u.jsx("div",{className:"app",children:u.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[u.jsx("button",{onClick:()=>qn(null),style:{marginBottom:"20px",padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:" Back to Practice Menu"}),u.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[u.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),Q==="1"&&u.jsx(Jd,{taskNum:K,onComplete:Qt,currentTaskId:fs,isPractice:!0}),Q==="2"&&u.jsx(Zd,{taskNum:K,onComplete:Qt,currentTaskId:fs,isPractice:!0}),Q==="3"&&u.jsx(eh,{taskNum:K,onComplete:Qt,currentTaskId:fs,isPractice:!0})]})})}if(n==="complete"){const q=Math.floor(F/60),L=F%60,Q=Math.round(jn()),K=fe.bonus||0,ue=Q+K,ce={semester:le,totalTime:F,completedLevels:m,categoryPoints:fe,switches:E,gameMode:s,randomSeed:at,studentLearningScore:Q,finalScore:ue},pe=async()=>{const Oe=[...Se,ce];ze(Oe),localStorage.setItem("engagementInterest","0"),An({materials:0,research:0,engagement:0,bonus:0}),kn({}),A&&!A.startsWith("offline-")&&await pr(Dt(Xe,"sessions",A),{[`semesterHistory.semester${le}`]:ce,currentSemester:le+1,lastActivity:Tn()}),ke(le+1),bt.resetForNewSemester(),r("semesterBreak"),y({}),I(0),x(0),C(0),w(0),ie(0),h("g2t1"),Ae(!1),xe(!1),ln(0),Pr([]);const Be=Math.floor(Math.random()*1e6);he(Be),ut.initializeSeed(Be);const kt={},xt={},Gn={},gt={};for(let Qe=1;Qe<=100;Qe++)kt[Qe]=ut.generateSliderPattern(Qe),xt[Qe]=ut.generateCountingPattern(Qe),Gn[Qe]=ut.generateTypingPattern(Qe),gt[Qe]=ut.getTextPassage(Qe);sr(kt),ft(xt),Rr(Gn),Qs(gt)},Ce=le>=Ve;return u.jsxs("div",{className:"app",children:[u.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[u.jsx("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"8px",border:"2px solid #2196F3"},children:u.jsxs("h2",{style:{color:"#2196F3",margin:0},children:["Semester ",le," of ",Ve," Complete!"]})}),Ce&&u.jsx(SI,{sessionId:A,completedLevels:m,totalTime:F,gameMode:s}),u.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginTop:"20px"},children:[u.jsxs("h2",{style:{color:"#333",marginBottom:"20px"},children:[" Semester ",le," Performance"]}),u.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2196F3",marginBottom:"30px"},children:["Final Score: ",ue," points"]}),u.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[u.jsxs("h3",{style:{margin:"0 0 15px 0",color:"#1976d2"},children:["Student Learning Score: ",Q]}),u.jsxs("div",{style:{fontSize:"16px",color:"#666"},children:["= ",fe.materials||0," (Materials) "," ",(1+(fe.research||0)*.15).toFixed(2)," ","(Research)",parseFloat(localStorage.getItem("engagementInterest")||"0")>0&&` + ${parseFloat(localStorage.getItem("engagementInterest")||"0").toFixed(2)} (Interest)`]}),K>0&&u.jsxs("div",{style:{marginTop:"10px",fontSize:"16px",color:"#1976d2"},children:["+ ",K," Checkpoint Bonus"]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"30px"},children:[u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Total Time"}),u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[q,"m ",L,"s"]})]}),u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Student Learning"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:Q})]})]}),(le===2||K>0)&&u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Checkpoint Bonus"}),u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:["+",K]})]}),u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Tasks Completed"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:m})]})]}),u.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:"Teaching Performance by Category"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"30px"},children:[u.jsxs("div",{style:{background:"#f0f8f0",padding:"15px",borderRadius:"6px",border:"2px solid #4CAF5020"},children:[u.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",marginBottom:"5px"},children:" Materials"}),u.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:fe.materials||0}),u.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Base points"})]}),u.jsxs("div",{style:{background:"#f8f0ff",padding:"15px",borderRadius:"6px",border:"2px solid #9C27B020"},children:[u.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold",marginBottom:"5px"},children:" Research"}),u.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:fe.research||0}),u.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(fe.research||0)*15,"% to future materials"]})]}),u.jsxs("div",{style:{background:"#fff0f0",padding:"15px",borderRadius:"6px",border:"2px solid #f4433620"},children:[u.jsx("div",{style:{color:"#f44336",fontWeight:"bold",marginBottom:"5px"},children:" Engagement"}),u.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:fe.engagement||0}),u.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",((fe.engagement||0)*.15).toFixed(1),"% interest/task"]})]})]})]}),le===2&&fe.bonus>0&&u.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[u.jsx("strong",{style:{color:"#856404"},children:" Exam Season Bonus: "}),u.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#856404"},children:["+",fe.bonus," points"]})]}),Se.length>0&&u.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[u.jsx("h4",{style:{color:"#666",marginBottom:"15px"},children:"Progress Over Semesters"}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px"},children:[...Se,ce].map((Oe,Be)=>u.jsxs("div",{style:{padding:"10px",background:Be===Se.length?"#e3f2fd":"white",borderRadius:"6px",border:"1px solid #e0e0e0",textAlign:"center"},children:[u.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Semester ",Be+1]}),u.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:Oe.finalScore})]},Be))})]}),u.jsx("div",{style:{marginTop:"30px",textAlign:"center"},children:Ce?u.jsxs("div",{style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px",textAlign:"center"},children:[u.jsx("h3",{style:{color:"#856404",marginBottom:"10px"},children:" All semesters complete!"}),u.jsx("p",{style:{color:"#856404",marginBottom:"0"},children:"Return to the Qualtrics survey and enter your completion code to finish the study."})]}):u.jsxs("button",{onClick:pe,style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",le+1," "]})})]})}const lr=be.gameMode||"knapsack";if(n==="allocation"&&lr==="knapsack")return u.jsx(II,{onStart:La,totalTasks:be.totalTasks,orderStrategy:be.taskOrderStrategy,durationMinutes:be.semesterDuration,difficultyMode:be.difficultyMode});if(n==="bonus_round"&&lr==="knapsack")return u.jsx(AI,{timeRemaining:ir,onSelectTask:q=>{const L=[...At,q];Pr(L);const Q=Object.keys(p).filter(ue=>ue.startsWith(q)).length,K=`${q}t${Q+1}`;r("challenge"),Dn(K,!0)},onFinishEarly:()=>_s("finished_early")});const ri=q=>{let L=q,Q=null;q.includes("-")&&([L,Q]=q.split("-"));const K=L==="g1"?"Research":L==="g2"?"Materials":"Engagement",ue=be.jarRefillFreezeTime||0;Ue.logEvent("jar_refill",{jarKey:q,taskType:L,taskTypeName:K,difficulty:Q,freezeTime:ue,currentTaskIndex:bn,queueLength:At.length,allTasksCompleted:ve,currentScore:Math.round(((fe==null?void 0:fe.materials)||0)+((fe==null?void 0:fe.research)||0)+((fe==null?void 0:fe.engagement)||0)-(Rn.switch+Rn.unfinished)),timeRemaining:ir}).catch(ce=>console.error("Error tracking refill:",ce)),ue>0?(se(!0),T(`Refilling ${K}${Q?` (${Q})`:""} Jar...`),setTimeout(()=>{se(!1),T(""),ws(L,Q,1,(ce,pe)=>{xe(!1),ln(pe),Ue.logEvent("jar_refill_complete",{jarKey:q,taskType:L,difficulty:Q,newTaskId:ce,newTaskIndex:pe}).catch(Ce=>console.error("Error tracking refill complete:",Ce)),Dn(ce,!0).catch(Ce=>console.error("Error switching to refilled task:",Ce))})},ue*1e3)):ws(L,Q,1,(ce,pe)=>{xe(!1),ln(pe),Ue.logEvent("jar_refill_complete",{jarKey:q,taskType:L,difficulty:Q,newTaskId:ce,newTaskIndex:pe}).catch(Ce=>console.error("Error tracking refill complete:",Ce)),Dn(ce,!0).catch(Ce=>console.error("Error switching to refilled task:",Ce))})},uo=(q,L="Paused")=>{q>0&&(se(!0),T(`${L}...`),setTimeout(()=>{se(!1),T("")},q*1e3))},He=(q,L)=>q<=5?"easy":q<=10?"medium":"hard",ws=(q,L,Q,K)=>{const ue=be.difficultyMode==="manual";let ce=0;if(!L||!ue){const Ce=Object.keys(p).filter(Oe=>Oe.split("_")[0].startsWith(q));if(Ce.length>0){const Oe=Ce.map(Be=>{const xt=Be.split("_")[0].match(new RegExp(`${q}t(\\d+)`));return xt?parseInt(xt[1]):0});ce=Math.max(...Oe)}}const pe=[];for(let Ce=0;Ce<Q;Ce++){let Oe;if(L&&ue){const xt=Object.keys(p).filter(Gn=>{const gt=Gn.split("_")[0];if(!gt.startsWith(q))return!1;const Qe=gt.match(new RegExp(`${q}t(\\d+)`));if(!Qe)return!1;const Mr=parseInt(Qe[1]);return He(Mr)===L}).length;L==="easy"?Oe=(xt+Ce)%5+1:L==="medium"?Oe=(xt+Ce)%5+6:Oe=11+xt+Ce}else Oe=ce+1+Ce;const Be=Date.now()+Ce,kt=`${q}t${Oe}_${Be}`;pe.push(kt)}Pr(Ce=>{const Oe=[...Ce,...pe];return K&&pe.length>0&&K(pe[0],Oe.length-pe.length),Oe})};if(n==="challenge"&&lr==="sequential")return u.jsxs("div",{className:"app",children:[u.jsx(yI,{current:c,completed:p,onSwitch:Dn,limitMode:"time",categoryPoints:fe,timeRemaining:ir}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 340px",gap:"20px",maxWidth:"1400px",margin:"0 auto",padding:"20px"},children:[u.jsx("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:xn()}),u.jsx("div",{style:{height:"fit-content"},children:u.jsx(sm,{messages:Ys,onSendMessage:Oa,isAiTyping:Pn,isOpen:Dr,onToggle:()=>Js(!Dr),unreadCount:Zs,aiDelay:be.aiDelay,onPauseTimer:uo,currentTask:c,categoryPoints:fe})})]})]});if((n==="challenge"||n==="bonus_round")&&lr==="knapsack")return u.jsxs("div",{className:"app",children:[Z&&u.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"24px",flexDirection:"column",gap:"20px"},children:[u.jsx("div",{style:{fontSize:"48px"},children:""}),u.jsx("div",{children:S}),u.jsx("div",{style:{fontSize:"16px",opacity:.8},children:"Please wait..."})]}),u.jsx(CI,{currentTaskIndex:bn,totalTasks:At.length,taskQueue:At,onSwitchTask:Fa,onRefill:ri,onFinishNow:()=>_s("all_tasks_done"),allocationCounts:Hu,points:Math.round(jn()),timeRemaining:ir,onTimeUp:()=>_s("time_up"),penalties:Rn,difficultyMode:be.difficultyMode,categoryPoints:fe,globalConfig:be,allTasksCompleted:ve,engagementInterest:parseFloat(localStorage.getItem("engagementInterest")||"0")||0,chatInterface:u.jsx(sm,{messages:Ys,onSendMessage:Oa,isAiTyping:Pn,isOpen:Dr,onToggle:()=>Js(!Dr),unreadCount:Zs,aiDelay:be.aiDelay,onPauseTimer:uo,currentTask:At[bn],categoryPoints:fe}),children:xn()})]})}v0(document.getElementById("root")).render(u.jsx(D.StrictMode,{children:u.jsx(RI,{})}));
//# sourceMappingURL=index-CrftAqIW.js.map
