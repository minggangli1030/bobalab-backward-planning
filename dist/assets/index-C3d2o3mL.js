(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Wm={exports:{}},Ol={},Hm={exports:{}},he={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zo=Symbol.for("react.element"),n_=Symbol.for("react.portal"),r_=Symbol.for("react.fragment"),s_=Symbol.for("react.strict_mode"),i_=Symbol.for("react.profiler"),o_=Symbol.for("react.provider"),a_=Symbol.for("react.context"),l_=Symbol.for("react.forward_ref"),u_=Symbol.for("react.suspense"),c_=Symbol.for("react.memo"),d_=Symbol.for("react.lazy"),Mf=Symbol.iterator;function h_(t){return t===null||typeof t!="object"?null:(t=Mf&&t[Mf]||t["@@iterator"],typeof t=="function"?t:null)}var qm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Gm=Object.assign,Qm={};function gi(t,e,n){this.props=t,this.context=e,this.refs=Qm,this.updater=n||qm}gi.prototype.isReactComponent={};gi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};gi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Km(){}Km.prototype=gi.prototype;function kd(t,e,n){this.props=t,this.context=e,this.refs=Qm,this.updater=n||qm}var Rd=kd.prototype=new Km;Rd.constructor=kd;Gm(Rd,gi.prototype);Rd.isPureReactComponent=!0;var Lf=Array.isArray,Ym=Object.prototype.hasOwnProperty,Pd={current:null},Xm={key:!0,ref:!0,__self:!0,__source:!0};function Jm(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)Ym.call(e,r)&&!Xm.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:zo,type:t,key:i,ref:a,props:s,_owner:Pd.current}}function f_(t,e){return{$$typeof:zo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Dd(t){return typeof t=="object"&&t!==null&&t.$$typeof===zo}function p_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Of=/\/+/g;function Tu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?p_(""+t.key):e.toString(36)}function za(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case zo:case n_:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+Tu(a,0):r,Lf(s)?(n="",t!=null&&(n=t.replace(Of,"$&/")+"/"),za(s,e,n,"",function(h){return h})):s!=null&&(Dd(s)&&(s=f_(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Of,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",Lf(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Tu(i,l);a+=za(i,e,n,u,s)}else if(u=h_(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Tu(i,l++),a+=za(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function _a(t,e,n){if(t==null)return t;var r=[],s=0;return za(t,r,"","",function(i){return e.call(n,i,s++)}),r}function m_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Lt={current:null},Ba={transition:null},g_={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:Ba,ReactCurrentOwner:Pd};function Zm(){throw Error("act(...) is not supported in production builds of React.")}he.Children={map:_a,forEach:function(t,e,n){_a(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return _a(t,function(){e++}),e},toArray:function(t){return _a(t,function(e){return e})||[]},only:function(t){if(!Dd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};he.Component=gi;he.Fragment=r_;he.Profiler=i_;he.PureComponent=kd;he.StrictMode=s_;he.Suspense=u_;he.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=g_;he.act=Zm;he.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Gm({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Pd.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Ym.call(e,u)&&!Xm.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:zo,type:t.type,key:s,ref:i,props:r,_owner:a}};he.createContext=function(t){return t={$$typeof:a_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:o_,_context:t},t.Consumer=t};he.createElement=Jm;he.createFactory=function(t){var e=Jm.bind(null,t);return e.type=t,e};he.createRef=function(){return{current:null}};he.forwardRef=function(t){return{$$typeof:l_,render:t}};he.isValidElement=Dd;he.lazy=function(t){return{$$typeof:d_,_payload:{_status:-1,_result:t},_init:m_}};he.memo=function(t,e){return{$$typeof:c_,type:t,compare:e===void 0?null:e}};he.startTransition=function(t){var e=Ba.transition;Ba.transition={};try{t()}finally{Ba.transition=e}};he.unstable_act=Zm;he.useCallback=function(t,e){return Lt.current.useCallback(t,e)};he.useContext=function(t){return Lt.current.useContext(t)};he.useDebugValue=function(){};he.useDeferredValue=function(t){return Lt.current.useDeferredValue(t)};he.useEffect=function(t,e){return Lt.current.useEffect(t,e)};he.useId=function(){return Lt.current.useId()};he.useImperativeHandle=function(t,e,n){return Lt.current.useImperativeHandle(t,e,n)};he.useInsertionEffect=function(t,e){return Lt.current.useInsertionEffect(t,e)};he.useLayoutEffect=function(t,e){return Lt.current.useLayoutEffect(t,e)};he.useMemo=function(t,e){return Lt.current.useMemo(t,e)};he.useReducer=function(t,e,n){return Lt.current.useReducer(t,e,n)};he.useRef=function(t){return Lt.current.useRef(t)};he.useState=function(t){return Lt.current.useState(t)};he.useSyncExternalStore=function(t,e,n){return Lt.current.useSyncExternalStore(t,e,n)};he.useTransition=function(){return Lt.current.useTransition()};he.version="18.3.1";Hm.exports=he;var b=Hm.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y_=b,v_=Symbol.for("react.element"),__=Symbol.for("react.fragment"),x_=Object.prototype.hasOwnProperty,w_=y_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,S_={key:!0,ref:!0,__self:!0,__source:!0};function eg(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)x_.call(e,r)&&!S_.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:v_,type:t,key:i,ref:a,props:s,_owner:w_.current}}Ol.Fragment=__;Ol.jsx=eg;Ol.jsxs=eg;Wm.exports=Ol;var d=Wm.exports,tg={exports:{}},rn={},ng={exports:{}},rg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,O){var L=N.length;N.push(O);e:for(;0<L;){var W=L-1>>>1,X=N[W];if(0<s(X,O))N[W]=O,N[L]=X,L=W;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var O=N[0],L=N.pop();if(L!==O){N[0]=L;e:for(var W=0,X=N.length,oe=X>>>1;W<oe;){var Ce=2*(W+1)-1,xe=N[Ce],fe=Ce+1,de=N[fe];if(0>s(xe,L))fe<X&&0>s(de,xe)?(N[W]=de,N[fe]=L,W=fe):(N[W]=xe,N[Ce]=L,W=Ce);else if(fe<X&&0>s(de,L))N[W]=de,N[fe]=L,W=fe;else break e}}return O}function s(N,O){var L=N.sortIndex-O.sortIndex;return L!==0?L:N.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],h=[],p=1,g=null,m=3,w=!1,C=!1,P=!1,M=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(N){for(var O=n(h);O!==null;){if(O.callback===null)r(h);else if(O.startTime<=N)r(h),O.sortIndex=O.expirationTime,e(u,O);else break;O=n(h)}}function V(N){if(P=!1,R(N),!C)if(n(u)!==null)C=!0,Y(z);else{var O=n(h);O!==null&&U(V,O.startTime-N)}}function z(N,O){C=!1,P&&(P=!1,k(v),v=-1),w=!0;var L=m;try{for(R(O),g=n(u);g!==null&&(!(g.expirationTime>O)||N&&!_());){var W=g.callback;if(typeof W=="function"){g.callback=null,m=g.priorityLevel;var X=W(g.expirationTime<=O);O=t.unstable_now(),typeof X=="function"?g.callback=X:g===n(u)&&r(u),R(O)}else r(u);g=n(u)}if(g!==null)var oe=!0;else{var Ce=n(h);Ce!==null&&U(V,Ce.startTime-O),oe=!1}return oe}finally{g=null,m=L,w=!1}}var B=!1,S=null,v=-1,E=5,I=-1;function _(){return!(t.unstable_now()-I<E)}function T(){if(S!==null){var N=t.unstable_now();I=N;var O=!0;try{O=S(!0,N)}finally{O?x():(B=!1,S=null)}}else B=!1}var x;if(typeof A=="function")x=function(){A(T)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,re=te.port2;te.port1.onmessage=T,x=function(){re.postMessage(null)}}else x=function(){M(T,0)};function Y(N){S=N,B||(B=!0,x())}function U(N,O){v=M(function(){N(t.unstable_now())},O)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){C||w||(C=!0,Y(z))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(N){switch(m){case 1:case 2:case 3:var O=3;break;default:O=m}var L=m;m=O;try{return N()}finally{m=L}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,O){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var L=m;m=N;try{return O()}finally{m=L}},t.unstable_scheduleCallback=function(N,O,L){var W=t.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?W+L:W):L=W,N){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=L+X,N={id:p++,callback:O,priorityLevel:N,startTime:L,expirationTime:X,sortIndex:-1},L>W?(N.sortIndex=L,e(h,N),n(u)===null&&N===n(h)&&(P?(k(v),v=-1):P=!0,U(V,L-W))):(N.sortIndex=X,e(u,N),C||w||(C=!0,Y(z))),N},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(N){var O=m;return function(){var L=m;m=O;try{return N.apply(this,arguments)}finally{m=L}}}})(rg);ng.exports=rg;var E_=ng.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T_=b,nn=E_;function q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var sg=new Set,fo={};function ps(t,e){ni(t,e),ni(t+"Capture",e)}function ni(t,e){for(fo[t]=e,t=0;t<e.length;t++)sg.add(e[t])}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cc=Object.prototype.hasOwnProperty,I_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ff={},zf={};function A_(t){return cc.call(zf,t)?!0:cc.call(Ff,t)?!1:I_.test(t)?zf[t]=!0:(Ff[t]=!0,!1)}function C_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function k_(t,e,n,r){if(e===null||typeof e>"u"||C_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ot(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var _t={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){_t[t]=new Ot(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];_t[e]=new Ot(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){_t[t]=new Ot(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){_t[t]=new Ot(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){_t[t]=new Ot(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){_t[t]=new Ot(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){_t[t]=new Ot(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){_t[t]=new Ot(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){_t[t]=new Ot(t,5,!1,t.toLowerCase(),null,!1,!1)});var Nd=/[\-:]([a-z])/g;function bd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Nd,bd);_t[e]=new Ot(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Nd,bd);_t[e]=new Ot(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Nd,bd);_t[e]=new Ot(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){_t[t]=new Ot(t,1,!1,t.toLowerCase(),null,!1,!1)});_t.xlinkHref=new Ot("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){_t[t]=new Ot(t,1,!1,t.toLowerCase(),null,!0,!0)});function jd(t,e,n,r){var s=_t.hasOwnProperty(e)?_t[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(k_(e,n,s,r)&&(n=null),r||s===null?A_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var lr=T_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xa=Symbol.for("react.element"),Ls=Symbol.for("react.portal"),Os=Symbol.for("react.fragment"),Vd=Symbol.for("react.strict_mode"),dc=Symbol.for("react.profiler"),ig=Symbol.for("react.provider"),og=Symbol.for("react.context"),Md=Symbol.for("react.forward_ref"),hc=Symbol.for("react.suspense"),fc=Symbol.for("react.suspense_list"),Ld=Symbol.for("react.memo"),yr=Symbol.for("react.lazy"),ag=Symbol.for("react.offscreen"),Bf=Symbol.iterator;function Vi(t){return t===null||typeof t!="object"?null:(t=Bf&&t[Bf]||t["@@iterator"],typeof t=="function"?t:null)}var We=Object.assign,Iu;function Wi(t){if(Iu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Iu=e&&e[1]||""}return`
`+Iu+t}var Au=!1;function Cu(t,e){if(!t||Au)return"";Au=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{Au=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Wi(t):""}function R_(t){switch(t.tag){case 5:return Wi(t.type);case 16:return Wi("Lazy");case 13:return Wi("Suspense");case 19:return Wi("SuspenseList");case 0:case 2:case 15:return t=Cu(t.type,!1),t;case 11:return t=Cu(t.type.render,!1),t;case 1:return t=Cu(t.type,!0),t;default:return""}}function pc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Os:return"Fragment";case Ls:return"Portal";case dc:return"Profiler";case Vd:return"StrictMode";case hc:return"Suspense";case fc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case og:return(t.displayName||"Context")+".Consumer";case ig:return(t._context.displayName||"Context")+".Provider";case Md:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ld:return e=t.displayName||null,e!==null?e:pc(t.type)||"Memo";case yr:e=t._payload,t=t._init;try{return pc(t(e))}catch{}}return null}function P_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pc(e);case 8:return e===Vd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Mr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function lg(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function D_(t){var e=lg(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function wa(t){t._valueTracker||(t._valueTracker=D_(t))}function ug(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=lg(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function rl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function mc(t,e){var n=e.checked;return We({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Uf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Mr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function cg(t,e){e=e.checked,e!=null&&jd(t,"checked",e,!1)}function gc(t,e){cg(t,e);var n=Mr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?yc(t,e.type,n):e.hasOwnProperty("defaultValue")&&yc(t,e.type,Mr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function $f(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function yc(t,e,n){(e!=="number"||rl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Hi=Array.isArray;function Ks(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Mr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function vc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(q(91));return We({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Wf(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(q(92));if(Hi(n)){if(1<n.length)throw Error(q(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Mr(n)}}function dg(t,e){var n=Mr(e.value),r=Mr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Hf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function hg(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _c(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?hg(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Sa,fg=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Sa=Sa||document.createElement("div"),Sa.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Sa.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function po(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Zi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},N_=["Webkit","ms","Moz","O"];Object.keys(Zi).forEach(function(t){N_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Zi[e]=Zi[t]})});function pg(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Zi.hasOwnProperty(t)&&Zi[t]?(""+e).trim():e+"px"}function mg(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=pg(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var b_=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xc(t,e){if(e){if(b_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(q(62))}}function wc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sc=null;function Od(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ec=null,Ys=null,Xs=null;function qf(t){if(t=$o(t)){if(typeof Ec!="function")throw Error(q(280));var e=t.stateNode;e&&(e=$l(e),Ec(t.stateNode,t.type,e))}}function gg(t){Ys?Xs?Xs.push(t):Xs=[t]:Ys=t}function yg(){if(Ys){var t=Ys,e=Xs;if(Xs=Ys=null,qf(t),e)for(t=0;t<e.length;t++)qf(e[t])}}function vg(t,e){return t(e)}function _g(){}var ku=!1;function xg(t,e,n){if(ku)return t(e,n);ku=!0;try{return vg(t,e,n)}finally{ku=!1,(Ys!==null||Xs!==null)&&(_g(),yg())}}function mo(t,e){var n=t.stateNode;if(n===null)return null;var r=$l(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(q(231,e,typeof n));return n}var Tc=!1;if(tr)try{var Mi={};Object.defineProperty(Mi,"passive",{get:function(){Tc=!0}}),window.addEventListener("test",Mi,Mi),window.removeEventListener("test",Mi,Mi)}catch{Tc=!1}function j_(t,e,n,r,s,i,a,l,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var eo=!1,sl=null,il=!1,Ic=null,V_={onError:function(t){eo=!0,sl=t}};function M_(t,e,n,r,s,i,a,l,u){eo=!1,sl=null,j_.apply(V_,arguments)}function L_(t,e,n,r,s,i,a,l,u){if(M_.apply(this,arguments),eo){if(eo){var h=sl;eo=!1,sl=null}else throw Error(q(198));il||(il=!0,Ic=h)}}function ms(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function wg(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Gf(t){if(ms(t)!==t)throw Error(q(188))}function O_(t){var e=t.alternate;if(!e){if(e=ms(t),e===null)throw Error(q(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Gf(s),t;if(i===r)return Gf(s),e;i=i.sibling}throw Error(q(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(q(189))}}if(n.alternate!==r)throw Error(q(190))}if(n.tag!==3)throw Error(q(188));return n.stateNode.current===n?t:e}function Sg(t){return t=O_(t),t!==null?Eg(t):null}function Eg(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Eg(t);if(e!==null)return e;t=t.sibling}return null}var Tg=nn.unstable_scheduleCallback,Qf=nn.unstable_cancelCallback,F_=nn.unstable_shouldYield,z_=nn.unstable_requestPaint,Xe=nn.unstable_now,B_=nn.unstable_getCurrentPriorityLevel,Fd=nn.unstable_ImmediatePriority,Ig=nn.unstable_UserBlockingPriority,ol=nn.unstable_NormalPriority,U_=nn.unstable_LowPriority,Ag=nn.unstable_IdlePriority,Fl=null,Vn=null;function $_(t){if(Vn&&typeof Vn.onCommitFiberRoot=="function")try{Vn.onCommitFiberRoot(Fl,t,void 0,(t.current.flags&128)===128)}catch{}}var En=Math.clz32?Math.clz32:q_,W_=Math.log,H_=Math.LN2;function q_(t){return t>>>=0,t===0?32:31-(W_(t)/H_|0)|0}var Ea=64,Ta=4194304;function qi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function al(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=qi(l):(i&=a,i!==0&&(r=qi(i)))}else a=n&~s,a!==0?r=qi(a):i!==0&&(r=qi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-En(e),s=1<<n,r|=t[n],e&=~s;return r}function G_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Q_(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-En(i),l=1<<a,u=s[a];u===-1?(!(l&n)||l&r)&&(s[a]=G_(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Ac(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Cg(){var t=Ea;return Ea<<=1,!(Ea&4194240)&&(Ea=64),t}function Ru(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Bo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-En(e),t[e]=n}function K_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-En(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function zd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-En(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ee=0;function kg(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Rg,Bd,Pg,Dg,Ng,Cc=!1,Ia=[],Tr=null,Ir=null,Ar=null,go=new Map,yo=new Map,_r=[],Y_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Kf(t,e){switch(t){case"focusin":case"focusout":Tr=null;break;case"dragenter":case"dragleave":Ir=null;break;case"mouseover":case"mouseout":Ar=null;break;case"pointerover":case"pointerout":go.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":yo.delete(e.pointerId)}}function Li(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=$o(e),e!==null&&Bd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function X_(t,e,n,r,s){switch(e){case"focusin":return Tr=Li(Tr,t,e,n,r,s),!0;case"dragenter":return Ir=Li(Ir,t,e,n,r,s),!0;case"mouseover":return Ar=Li(Ar,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return go.set(i,Li(go.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,yo.set(i,Li(yo.get(i)||null,t,e,n,r,s)),!0}return!1}function bg(t){var e=Zr(t.target);if(e!==null){var n=ms(e);if(n!==null){if(e=n.tag,e===13){if(e=wg(n),e!==null){t.blockedOn=e,Ng(t.priority,function(){Pg(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ua(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=kc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Sc=r,n.target.dispatchEvent(r),Sc=null}else return e=$o(n),e!==null&&Bd(e),t.blockedOn=n,!1;e.shift()}return!0}function Yf(t,e,n){Ua(t)&&n.delete(e)}function J_(){Cc=!1,Tr!==null&&Ua(Tr)&&(Tr=null),Ir!==null&&Ua(Ir)&&(Ir=null),Ar!==null&&Ua(Ar)&&(Ar=null),go.forEach(Yf),yo.forEach(Yf)}function Oi(t,e){t.blockedOn===e&&(t.blockedOn=null,Cc||(Cc=!0,nn.unstable_scheduleCallback(nn.unstable_NormalPriority,J_)))}function vo(t){function e(s){return Oi(s,t)}if(0<Ia.length){Oi(Ia[0],t);for(var n=1;n<Ia.length;n++){var r=Ia[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Tr!==null&&Oi(Tr,t),Ir!==null&&Oi(Ir,t),Ar!==null&&Oi(Ar,t),go.forEach(e),yo.forEach(e),n=0;n<_r.length;n++)r=_r[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<_r.length&&(n=_r[0],n.blockedOn===null);)bg(n),n.blockedOn===null&&_r.shift()}var Js=lr.ReactCurrentBatchConfig,ll=!0;function Z_(t,e,n,r){var s=Ee,i=Js.transition;Js.transition=null;try{Ee=1,Ud(t,e,n,r)}finally{Ee=s,Js.transition=i}}function ex(t,e,n,r){var s=Ee,i=Js.transition;Js.transition=null;try{Ee=4,Ud(t,e,n,r)}finally{Ee=s,Js.transition=i}}function Ud(t,e,n,r){if(ll){var s=kc(t,e,n,r);if(s===null)Fu(t,e,r,ul,n),Kf(t,r);else if(X_(s,t,e,n,r))r.stopPropagation();else if(Kf(t,r),e&4&&-1<Y_.indexOf(t)){for(;s!==null;){var i=$o(s);if(i!==null&&Rg(i),i=kc(t,e,n,r),i===null&&Fu(t,e,r,ul,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Fu(t,e,r,null,n)}}var ul=null;function kc(t,e,n,r){if(ul=null,t=Od(r),t=Zr(t),t!==null)if(e=ms(t),e===null)t=null;else if(n=e.tag,n===13){if(t=wg(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ul=t,null}function jg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(B_()){case Fd:return 1;case Ig:return 4;case ol:case U_:return 16;case Ag:return 536870912;default:return 16}default:return 16}}var wr=null,$d=null,$a=null;function Vg(){if($a)return $a;var t,e=$d,n=e.length,r,s="value"in wr?wr.value:wr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return $a=s.slice(t,1<r?1-r:void 0)}function Wa(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Aa(){return!0}function Xf(){return!1}function sn(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Aa:Xf,this.isPropagationStopped=Xf,this}return We(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Aa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Aa)},persist:function(){},isPersistent:Aa}),e}var yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wd=sn(yi),Uo=We({},yi,{view:0,detail:0}),tx=sn(Uo),Pu,Du,Fi,zl=We({},Uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Fi&&(Fi&&t.type==="mousemove"?(Pu=t.screenX-Fi.screenX,Du=t.screenY-Fi.screenY):Du=Pu=0,Fi=t),Pu)},movementY:function(t){return"movementY"in t?t.movementY:Du}}),Jf=sn(zl),nx=We({},zl,{dataTransfer:0}),rx=sn(nx),sx=We({},Uo,{relatedTarget:0}),Nu=sn(sx),ix=We({},yi,{animationName:0,elapsedTime:0,pseudoElement:0}),ox=sn(ix),ax=We({},yi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),lx=sn(ax),ux=We({},yi,{data:0}),Zf=sn(ux),cx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fx(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=hx[t])?!!e[t]:!1}function Hd(){return fx}var px=We({},Uo,{key:function(t){if(t.key){var e=cx[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Wa(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?dx[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hd,charCode:function(t){return t.type==="keypress"?Wa(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Wa(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),mx=sn(px),gx=We({},zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ep=sn(gx),yx=We({},Uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hd}),vx=sn(yx),_x=We({},yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),xx=sn(_x),wx=We({},zl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Sx=sn(wx),Ex=[9,13,27,32],qd=tr&&"CompositionEvent"in window,to=null;tr&&"documentMode"in document&&(to=document.documentMode);var Tx=tr&&"TextEvent"in window&&!to,Mg=tr&&(!qd||to&&8<to&&11>=to),tp=" ",np=!1;function Lg(t,e){switch(t){case"keyup":return Ex.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Og(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fs=!1;function Ix(t,e){switch(t){case"compositionend":return Og(e);case"keypress":return e.which!==32?null:(np=!0,tp);case"textInput":return t=e.data,t===tp&&np?null:t;default:return null}}function Ax(t,e){if(Fs)return t==="compositionend"||!qd&&Lg(t,e)?(t=Vg(),$a=$d=wr=null,Fs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Mg&&e.locale!=="ko"?null:e.data;default:return null}}var Cx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Cx[t.type]:e==="textarea"}function Fg(t,e,n,r){gg(r),e=cl(e,"onChange"),0<e.length&&(n=new Wd("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var no=null,_o=null;function kx(t){Yg(t,0)}function Bl(t){var e=Us(t);if(ug(e))return t}function Rx(t,e){if(t==="change")return e}var zg=!1;if(tr){var bu;if(tr){var ju="oninput"in document;if(!ju){var sp=document.createElement("div");sp.setAttribute("oninput","return;"),ju=typeof sp.oninput=="function"}bu=ju}else bu=!1;zg=bu&&(!document.documentMode||9<document.documentMode)}function ip(){no&&(no.detachEvent("onpropertychange",Bg),_o=no=null)}function Bg(t){if(t.propertyName==="value"&&Bl(_o)){var e=[];Fg(e,_o,t,Od(t)),xg(kx,e)}}function Px(t,e,n){t==="focusin"?(ip(),no=e,_o=n,no.attachEvent("onpropertychange",Bg)):t==="focusout"&&ip()}function Dx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Bl(_o)}function Nx(t,e){if(t==="click")return Bl(e)}function bx(t,e){if(t==="input"||t==="change")return Bl(e)}function jx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var In=typeof Object.is=="function"?Object.is:jx;function xo(t,e){if(In(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!cc.call(e,s)||!In(t[s],e[s]))return!1}return!0}function op(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ap(t,e){var n=op(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=op(n)}}function Ug(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ug(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function $g(){for(var t=window,e=rl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=rl(t.document)}return e}function Gd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Vx(t){var e=$g(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Ug(n.ownerDocument.documentElement,n)){if(r!==null&&Gd(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=ap(n,i);var a=ap(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Mx=tr&&"documentMode"in document&&11>=document.documentMode,zs=null,Rc=null,ro=null,Pc=!1;function lp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Pc||zs==null||zs!==rl(r)||(r=zs,"selectionStart"in r&&Gd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ro&&xo(ro,r)||(ro=r,r=cl(Rc,"onSelect"),0<r.length&&(e=new Wd("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=zs)))}function Ca(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Bs={animationend:Ca("Animation","AnimationEnd"),animationiteration:Ca("Animation","AnimationIteration"),animationstart:Ca("Animation","AnimationStart"),transitionend:Ca("Transition","TransitionEnd")},Vu={},Wg={};tr&&(Wg=document.createElement("div").style,"AnimationEvent"in window||(delete Bs.animationend.animation,delete Bs.animationiteration.animation,delete Bs.animationstart.animation),"TransitionEvent"in window||delete Bs.transitionend.transition);function Ul(t){if(Vu[t])return Vu[t];if(!Bs[t])return t;var e=Bs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Wg)return Vu[t]=e[n];return t}var Hg=Ul("animationend"),qg=Ul("animationiteration"),Gg=Ul("animationstart"),Qg=Ul("transitionend"),Kg=new Map,up="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Br(t,e){Kg.set(t,e),ps(e,[t])}for(var Mu=0;Mu<up.length;Mu++){var Lu=up[Mu],Lx=Lu.toLowerCase(),Ox=Lu[0].toUpperCase()+Lu.slice(1);Br(Lx,"on"+Ox)}Br(Hg,"onAnimationEnd");Br(qg,"onAnimationIteration");Br(Gg,"onAnimationStart");Br("dblclick","onDoubleClick");Br("focusin","onFocus");Br("focusout","onBlur");Br(Qg,"onTransitionEnd");ni("onMouseEnter",["mouseout","mouseover"]);ni("onMouseLeave",["mouseout","mouseover"]);ni("onPointerEnter",["pointerout","pointerover"]);ni("onPointerLeave",["pointerout","pointerover"]);ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ps("onBeforeInput",["compositionend","keypress","textInput","paste"]);ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gi));function cp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,L_(r,e,void 0,t),t.currentTarget=null}function Yg(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],u=l.instance,h=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;cp(s,l,h),i=u}else for(a=0;a<r.length;a++){if(l=r[a],u=l.instance,h=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;cp(s,l,h),i=u}}}if(il)throw t=Ic,il=!1,Ic=null,t}function be(t,e){var n=e[Vc];n===void 0&&(n=e[Vc]=new Set);var r=t+"__bubble";n.has(r)||(Xg(e,t,2,!1),n.add(r))}function Ou(t,e,n){var r=0;e&&(r|=4),Xg(n,t,r,e)}var ka="_reactListening"+Math.random().toString(36).slice(2);function wo(t){if(!t[ka]){t[ka]=!0,sg.forEach(function(n){n!=="selectionchange"&&(Fx.has(n)||Ou(n,!1,t),Ou(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ka]||(e[ka]=!0,Ou("selectionchange",!1,e))}}function Xg(t,e,n,r){switch(jg(e)){case 1:var s=Z_;break;case 4:s=ex;break;default:s=Ud}n=s.bind(null,e,n,t),s=void 0,!Tc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Fu(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Zr(l),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}l=l.parentNode}}r=r.return}xg(function(){var h=i,p=Od(n),g=[];e:{var m=Kg.get(t);if(m!==void 0){var w=Wd,C=t;switch(t){case"keypress":if(Wa(n)===0)break e;case"keydown":case"keyup":w=mx;break;case"focusin":C="focus",w=Nu;break;case"focusout":C="blur",w=Nu;break;case"beforeblur":case"afterblur":w=Nu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Jf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=rx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=vx;break;case Hg:case qg:case Gg:w=ox;break;case Qg:w=xx;break;case"scroll":w=tx;break;case"wheel":w=Sx;break;case"copy":case"cut":case"paste":w=lx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=ep}var P=(e&4)!==0,M=!P&&t==="scroll",k=P?m!==null?m+"Capture":null:m;P=[];for(var A=h,R;A!==null;){R=A;var V=R.stateNode;if(R.tag===5&&V!==null&&(R=V,k!==null&&(V=mo(A,k),V!=null&&P.push(So(A,V,R)))),M)break;A=A.return}0<P.length&&(m=new w(m,C,null,n,p),g.push({event:m,listeners:P}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",m&&n!==Sc&&(C=n.relatedTarget||n.fromElement)&&(Zr(C)||C[nr]))break e;if((w||m)&&(m=p.window===p?p:(m=p.ownerDocument)?m.defaultView||m.parentWindow:window,w?(C=n.relatedTarget||n.toElement,w=h,C=C?Zr(C):null,C!==null&&(M=ms(C),C!==M||C.tag!==5&&C.tag!==6)&&(C=null)):(w=null,C=h),w!==C)){if(P=Jf,V="onMouseLeave",k="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(P=ep,V="onPointerLeave",k="onPointerEnter",A="pointer"),M=w==null?m:Us(w),R=C==null?m:Us(C),m=new P(V,A+"leave",w,n,p),m.target=M,m.relatedTarget=R,V=null,Zr(p)===h&&(P=new P(k,A+"enter",C,n,p),P.target=R,P.relatedTarget=M,V=P),M=V,w&&C)t:{for(P=w,k=C,A=0,R=P;R;R=Ns(R))A++;for(R=0,V=k;V;V=Ns(V))R++;for(;0<A-R;)P=Ns(P),A--;for(;0<R-A;)k=Ns(k),R--;for(;A--;){if(P===k||k!==null&&P===k.alternate)break t;P=Ns(P),k=Ns(k)}P=null}else P=null;w!==null&&dp(g,m,w,P,!1),C!==null&&M!==null&&dp(g,M,C,P,!0)}}e:{if(m=h?Us(h):window,w=m.nodeName&&m.nodeName.toLowerCase(),w==="select"||w==="input"&&m.type==="file")var z=Rx;else if(rp(m))if(zg)z=bx;else{z=Dx;var B=Px}else(w=m.nodeName)&&w.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(z=Nx);if(z&&(z=z(t,h))){Fg(g,z,n,p);break e}B&&B(t,m,h),t==="focusout"&&(B=m._wrapperState)&&B.controlled&&m.type==="number"&&yc(m,"number",m.value)}switch(B=h?Us(h):window,t){case"focusin":(rp(B)||B.contentEditable==="true")&&(zs=B,Rc=h,ro=null);break;case"focusout":ro=Rc=zs=null;break;case"mousedown":Pc=!0;break;case"contextmenu":case"mouseup":case"dragend":Pc=!1,lp(g,n,p);break;case"selectionchange":if(Mx)break;case"keydown":case"keyup":lp(g,n,p)}var S;if(qd)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Fs?Lg(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(Mg&&n.locale!=="ko"&&(Fs||v!=="onCompositionStart"?v==="onCompositionEnd"&&Fs&&(S=Vg()):(wr=p,$d="value"in wr?wr.value:wr.textContent,Fs=!0)),B=cl(h,v),0<B.length&&(v=new Zf(v,t,null,n,p),g.push({event:v,listeners:B}),S?v.data=S:(S=Og(n),S!==null&&(v.data=S)))),(S=Tx?Ix(t,n):Ax(t,n))&&(h=cl(h,"onBeforeInput"),0<h.length&&(p=new Zf("onBeforeInput","beforeinput",null,n,p),g.push({event:p,listeners:h}),p.data=S))}Yg(g,e)})}function So(t,e,n){return{instance:t,listener:e,currentTarget:n}}function cl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=mo(t,n),i!=null&&r.unshift(So(t,i,s)),i=mo(t,e),i!=null&&r.push(So(t,i,s))),t=t.return}return r}function Ns(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function dp(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,u=l.alternate,h=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&h!==null&&(l=h,s?(u=mo(n,i),u!=null&&a.unshift(So(n,u,l))):s||(u=mo(n,i),u!=null&&a.push(So(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var zx=/\r\n?/g,Bx=/\u0000|\uFFFD/g;function hp(t){return(typeof t=="string"?t:""+t).replace(zx,`
`).replace(Bx,"")}function Ra(t,e,n){if(e=hp(e),hp(t)!==e&&n)throw Error(q(425))}function dl(){}var Dc=null,Nc=null;function bc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var jc=typeof setTimeout=="function"?setTimeout:void 0,Ux=typeof clearTimeout=="function"?clearTimeout:void 0,fp=typeof Promise=="function"?Promise:void 0,$x=typeof queueMicrotask=="function"?queueMicrotask:typeof fp<"u"?function(t){return fp.resolve(null).then(t).catch(Wx)}:jc;function Wx(t){setTimeout(function(){throw t})}function zu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),vo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);vo(e)}function Cr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function pp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var vi=Math.random().toString(36).slice(2),jn="__reactFiber$"+vi,Eo="__reactProps$"+vi,nr="__reactContainer$"+vi,Vc="__reactEvents$"+vi,Hx="__reactListeners$"+vi,qx="__reactHandles$"+vi;function Zr(t){var e=t[jn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[nr]||n[jn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=pp(t);t!==null;){if(n=t[jn])return n;t=pp(t)}return e}t=n,n=t.parentNode}return null}function $o(t){return t=t[jn]||t[nr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Us(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(q(33))}function $l(t){return t[Eo]||null}var Mc=[],$s=-1;function Ur(t){return{current:t}}function Me(t){0>$s||(t.current=Mc[$s],Mc[$s]=null,$s--)}function De(t,e){$s++,Mc[$s]=t.current,t.current=e}var Lr={},Dt=Ur(Lr),$t=Ur(!1),os=Lr;function ri(t,e){var n=t.type.contextTypes;if(!n)return Lr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Wt(t){return t=t.childContextTypes,t!=null}function hl(){Me($t),Me(Dt)}function mp(t,e,n){if(Dt.current!==Lr)throw Error(q(168));De(Dt,e),De($t,n)}function Jg(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(q(108,P_(t)||"Unknown",s));return We({},n,r)}function fl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Lr,os=Dt.current,De(Dt,t),De($t,$t.current),!0}function gp(t,e,n){var r=t.stateNode;if(!r)throw Error(q(169));n?(t=Jg(t,e,os),r.__reactInternalMemoizedMergedChildContext=t,Me($t),Me(Dt),De(Dt,t)):Me($t),De($t,n)}var Gn=null,Wl=!1,Bu=!1;function Zg(t){Gn===null?Gn=[t]:Gn.push(t)}function Gx(t){Wl=!0,Zg(t)}function $r(){if(!Bu&&Gn!==null){Bu=!0;var t=0,e=Ee;try{var n=Gn;for(Ee=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Gn=null,Wl=!1}catch(s){throw Gn!==null&&(Gn=Gn.slice(t+1)),Tg(Fd,$r),s}finally{Ee=e,Bu=!1}}return null}var Ws=[],Hs=0,pl=null,ml=0,ln=[],un=0,as=null,Yn=1,Xn="";function Yr(t,e){Ws[Hs++]=ml,Ws[Hs++]=pl,pl=t,ml=e}function ey(t,e,n){ln[un++]=Yn,ln[un++]=Xn,ln[un++]=as,as=t;var r=Yn;t=Xn;var s=32-En(r)-1;r&=~(1<<s),n+=1;var i=32-En(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Yn=1<<32-En(e)+s|n<<s|r,Xn=i+t}else Yn=1<<i|n<<s|r,Xn=t}function Qd(t){t.return!==null&&(Yr(t,1),ey(t,1,0))}function Kd(t){for(;t===pl;)pl=Ws[--Hs],Ws[Hs]=null,ml=Ws[--Hs],Ws[Hs]=null;for(;t===as;)as=ln[--un],ln[un]=null,Xn=ln[--un],ln[un]=null,Yn=ln[--un],ln[un]=null}var tn=null,Zt=null,Le=!1,Sn=null;function ty(t,e){var n=dn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function yp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,tn=t,Zt=Cr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,tn=t,Zt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=as!==null?{id:Yn,overflow:Xn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=dn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,tn=t,Zt=null,!0):!1;default:return!1}}function Lc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Oc(t){if(Le){var e=Zt;if(e){var n=e;if(!yp(t,e)){if(Lc(t))throw Error(q(418));e=Cr(n.nextSibling);var r=tn;e&&yp(t,e)?ty(r,n):(t.flags=t.flags&-4097|2,Le=!1,tn=t)}}else{if(Lc(t))throw Error(q(418));t.flags=t.flags&-4097|2,Le=!1,tn=t}}}function vp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;tn=t}function Pa(t){if(t!==tn)return!1;if(!Le)return vp(t),Le=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!bc(t.type,t.memoizedProps)),e&&(e=Zt)){if(Lc(t))throw ny(),Error(q(418));for(;e;)ty(t,e),e=Cr(e.nextSibling)}if(vp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Zt=Cr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Zt=null}}else Zt=tn?Cr(t.stateNode.nextSibling):null;return!0}function ny(){for(var t=Zt;t;)t=Cr(t.nextSibling)}function si(){Zt=tn=null,Le=!1}function Yd(t){Sn===null?Sn=[t]:Sn.push(t)}var Qx=lr.ReactCurrentBatchConfig;function zi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(q(309));var r=n.stateNode}if(!r)throw Error(q(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(q(284));if(!n._owner)throw Error(q(290,t))}return t}function Da(t,e){throw t=Object.prototype.toString.call(e),Error(q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function _p(t){var e=t._init;return e(t._payload)}function ry(t){function e(k,A){if(t){var R=k.deletions;R===null?(k.deletions=[A],k.flags|=16):R.push(A)}}function n(k,A){if(!t)return null;for(;A!==null;)e(k,A),A=A.sibling;return null}function r(k,A){for(k=new Map;A!==null;)A.key!==null?k.set(A.key,A):k.set(A.index,A),A=A.sibling;return k}function s(k,A){return k=Dr(k,A),k.index=0,k.sibling=null,k}function i(k,A,R){return k.index=R,t?(R=k.alternate,R!==null?(R=R.index,R<A?(k.flags|=2,A):R):(k.flags|=2,A)):(k.flags|=1048576,A)}function a(k){return t&&k.alternate===null&&(k.flags|=2),k}function l(k,A,R,V){return A===null||A.tag!==6?(A=Qu(R,k.mode,V),A.return=k,A):(A=s(A,R),A.return=k,A)}function u(k,A,R,V){var z=R.type;return z===Os?p(k,A,R.props.children,V,R.key):A!==null&&(A.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===yr&&_p(z)===A.type)?(V=s(A,R.props),V.ref=zi(k,A,R),V.return=k,V):(V=Xa(R.type,R.key,R.props,null,k.mode,V),V.ref=zi(k,A,R),V.return=k,V)}function h(k,A,R,V){return A===null||A.tag!==4||A.stateNode.containerInfo!==R.containerInfo||A.stateNode.implementation!==R.implementation?(A=Ku(R,k.mode,V),A.return=k,A):(A=s(A,R.children||[]),A.return=k,A)}function p(k,A,R,V,z){return A===null||A.tag!==7?(A=ss(R,k.mode,V,z),A.return=k,A):(A=s(A,R),A.return=k,A)}function g(k,A,R){if(typeof A=="string"&&A!==""||typeof A=="number")return A=Qu(""+A,k.mode,R),A.return=k,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case xa:return R=Xa(A.type,A.key,A.props,null,k.mode,R),R.ref=zi(k,null,A),R.return=k,R;case Ls:return A=Ku(A,k.mode,R),A.return=k,A;case yr:var V=A._init;return g(k,V(A._payload),R)}if(Hi(A)||Vi(A))return A=ss(A,k.mode,R,null),A.return=k,A;Da(k,A)}return null}function m(k,A,R,V){var z=A!==null?A.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return z!==null?null:l(k,A,""+R,V);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case xa:return R.key===z?u(k,A,R,V):null;case Ls:return R.key===z?h(k,A,R,V):null;case yr:return z=R._init,m(k,A,z(R._payload),V)}if(Hi(R)||Vi(R))return z!==null?null:p(k,A,R,V,null);Da(k,R)}return null}function w(k,A,R,V,z){if(typeof V=="string"&&V!==""||typeof V=="number")return k=k.get(R)||null,l(A,k,""+V,z);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case xa:return k=k.get(V.key===null?R:V.key)||null,u(A,k,V,z);case Ls:return k=k.get(V.key===null?R:V.key)||null,h(A,k,V,z);case yr:var B=V._init;return w(k,A,R,B(V._payload),z)}if(Hi(V)||Vi(V))return k=k.get(R)||null,p(A,k,V,z,null);Da(A,V)}return null}function C(k,A,R,V){for(var z=null,B=null,S=A,v=A=0,E=null;S!==null&&v<R.length;v++){S.index>v?(E=S,S=null):E=S.sibling;var I=m(k,S,R[v],V);if(I===null){S===null&&(S=E);break}t&&S&&I.alternate===null&&e(k,S),A=i(I,A,v),B===null?z=I:B.sibling=I,B=I,S=E}if(v===R.length)return n(k,S),Le&&Yr(k,v),z;if(S===null){for(;v<R.length;v++)S=g(k,R[v],V),S!==null&&(A=i(S,A,v),B===null?z=S:B.sibling=S,B=S);return Le&&Yr(k,v),z}for(S=r(k,S);v<R.length;v++)E=w(S,k,v,R[v],V),E!==null&&(t&&E.alternate!==null&&S.delete(E.key===null?v:E.key),A=i(E,A,v),B===null?z=E:B.sibling=E,B=E);return t&&S.forEach(function(_){return e(k,_)}),Le&&Yr(k,v),z}function P(k,A,R,V){var z=Vi(R);if(typeof z!="function")throw Error(q(150));if(R=z.call(R),R==null)throw Error(q(151));for(var B=z=null,S=A,v=A=0,E=null,I=R.next();S!==null&&!I.done;v++,I=R.next()){S.index>v?(E=S,S=null):E=S.sibling;var _=m(k,S,I.value,V);if(_===null){S===null&&(S=E);break}t&&S&&_.alternate===null&&e(k,S),A=i(_,A,v),B===null?z=_:B.sibling=_,B=_,S=E}if(I.done)return n(k,S),Le&&Yr(k,v),z;if(S===null){for(;!I.done;v++,I=R.next())I=g(k,I.value,V),I!==null&&(A=i(I,A,v),B===null?z=I:B.sibling=I,B=I);return Le&&Yr(k,v),z}for(S=r(k,S);!I.done;v++,I=R.next())I=w(S,k,v,I.value,V),I!==null&&(t&&I.alternate!==null&&S.delete(I.key===null?v:I.key),A=i(I,A,v),B===null?z=I:B.sibling=I,B=I);return t&&S.forEach(function(T){return e(k,T)}),Le&&Yr(k,v),z}function M(k,A,R,V){if(typeof R=="object"&&R!==null&&R.type===Os&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case xa:e:{for(var z=R.key,B=A;B!==null;){if(B.key===z){if(z=R.type,z===Os){if(B.tag===7){n(k,B.sibling),A=s(B,R.props.children),A.return=k,k=A;break e}}else if(B.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===yr&&_p(z)===B.type){n(k,B.sibling),A=s(B,R.props),A.ref=zi(k,B,R),A.return=k,k=A;break e}n(k,B);break}else e(k,B);B=B.sibling}R.type===Os?(A=ss(R.props.children,k.mode,V,R.key),A.return=k,k=A):(V=Xa(R.type,R.key,R.props,null,k.mode,V),V.ref=zi(k,A,R),V.return=k,k=V)}return a(k);case Ls:e:{for(B=R.key;A!==null;){if(A.key===B)if(A.tag===4&&A.stateNode.containerInfo===R.containerInfo&&A.stateNode.implementation===R.implementation){n(k,A.sibling),A=s(A,R.children||[]),A.return=k,k=A;break e}else{n(k,A);break}else e(k,A);A=A.sibling}A=Ku(R,k.mode,V),A.return=k,k=A}return a(k);case yr:return B=R._init,M(k,A,B(R._payload),V)}if(Hi(R))return C(k,A,R,V);if(Vi(R))return P(k,A,R,V);Da(k,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,A!==null&&A.tag===6?(n(k,A.sibling),A=s(A,R),A.return=k,k=A):(n(k,A),A=Qu(R,k.mode,V),A.return=k,k=A),a(k)):n(k,A)}return M}var ii=ry(!0),sy=ry(!1),gl=Ur(null),yl=null,qs=null,Xd=null;function Jd(){Xd=qs=yl=null}function Zd(t){var e=gl.current;Me(gl),t._currentValue=e}function Fc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Zs(t,e){yl=t,Xd=qs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ut=!0),t.firstContext=null)}function mn(t){var e=t._currentValue;if(Xd!==t)if(t={context:t,memoizedValue:e,next:null},qs===null){if(yl===null)throw Error(q(308));qs=t,yl.dependencies={lanes:0,firstContext:t}}else qs=qs.next=t;return e}var es=null;function eh(t){es===null?es=[t]:es.push(t)}function iy(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,eh(e)):(n.next=s.next,s.next=n),e.interleaved=n,rr(t,r)}function rr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var vr=!1;function th(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oy(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Jn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function kr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ye&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,rr(t,n)}return s=r.interleaved,s===null?(e.next=e,eh(r)):(e.next=s.next,s.next=e),r.interleaved=e,rr(t,n)}function Ha(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zd(t,n)}}function xp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function vl(t,e,n,r){var s=t.updateQueue;vr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,h=u.next;u.next=null,a===null?i=h:a.next=h,a=u;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==a&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;a=0,p=h=u=null,l=i;do{var m=l.lane,w=l.eventTime;if((r&m)===m){p!==null&&(p=p.next={eventTime:w,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var C=t,P=l;switch(m=e,w=n,P.tag){case 1:if(C=P.payload,typeof C=="function"){g=C.call(w,g,m);break e}g=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=P.payload,m=typeof C=="function"?C.call(w,g,m):C,m==null)break e;g=We({},g,m);break e;case 2:vr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else w={eventTime:w,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=w,u=g):p=p.next=w,a|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(p===null&&(u=g),s.baseState=u,s.firstBaseUpdate=h,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);us|=a,t.lanes=a,t.memoizedState=g}}function wp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(q(191,s));s.call(r)}}}var Wo={},Mn=Ur(Wo),To=Ur(Wo),Io=Ur(Wo);function ts(t){if(t===Wo)throw Error(q(174));return t}function nh(t,e){switch(De(Io,e),De(To,t),De(Mn,Wo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:_c(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=_c(e,t)}Me(Mn),De(Mn,e)}function oi(){Me(Mn),Me(To),Me(Io)}function ay(t){ts(Io.current);var e=ts(Mn.current),n=_c(e,t.type);e!==n&&(De(To,t),De(Mn,n))}function rh(t){To.current===t&&(Me(Mn),Me(To))}var Ue=Ur(0);function _l(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Uu=[];function sh(){for(var t=0;t<Uu.length;t++)Uu[t]._workInProgressVersionPrimary=null;Uu.length=0}var qa=lr.ReactCurrentDispatcher,$u=lr.ReactCurrentBatchConfig,ls=0,$e=null,it=null,dt=null,xl=!1,so=!1,Ao=0,Kx=0;function It(){throw Error(q(321))}function ih(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!In(t[n],e[n]))return!1;return!0}function oh(t,e,n,r,s,i){if(ls=i,$e=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,qa.current=t===null||t.memoizedState===null?Zx:e1,t=n(r,s),so){i=0;do{if(so=!1,Ao=0,25<=i)throw Error(q(301));i+=1,dt=it=null,e.updateQueue=null,qa.current=t1,t=n(r,s)}while(so)}if(qa.current=wl,e=it!==null&&it.next!==null,ls=0,dt=it=$e=null,xl=!1,e)throw Error(q(300));return t}function ah(){var t=Ao!==0;return Ao=0,t}function bn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?$e.memoizedState=dt=t:dt=dt.next=t,dt}function gn(){if(it===null){var t=$e.alternate;t=t!==null?t.memoizedState:null}else t=it.next;var e=dt===null?$e.memoizedState:dt.next;if(e!==null)dt=e,it=t;else{if(t===null)throw Error(q(310));it=t,t={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},dt===null?$e.memoizedState=dt=t:dt=dt.next=t}return dt}function Co(t,e){return typeof e=="function"?e(t):e}function Wu(t){var e=gn(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=it,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,u=null,h=i;do{var p=h.lane;if((ls&p)===p)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var g={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(l=u=g,a=r):u=u.next=g,$e.lanes|=p,us|=p}h=h.next}while(h!==null&&h!==i);u===null?a=r:u.next=l,In(r,e.memoizedState)||(Ut=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,$e.lanes|=i,us|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Hu(t){var e=gn(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);In(i,e.memoizedState)||(Ut=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function ly(){}function uy(t,e){var n=$e,r=gn(),s=e(),i=!In(r.memoizedState,s);if(i&&(r.memoizedState=s,Ut=!0),r=r.queue,lh(hy.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||dt!==null&&dt.memoizedState.tag&1){if(n.flags|=2048,ko(9,dy.bind(null,n,r,s,e),void 0,null),ht===null)throw Error(q(349));ls&30||cy(n,e,s)}return s}function cy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function dy(t,e,n,r){e.value=n,e.getSnapshot=r,fy(e)&&py(t)}function hy(t,e,n){return n(function(){fy(e)&&py(t)})}function fy(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!In(t,n)}catch{return!0}}function py(t){var e=rr(t,1);e!==null&&Tn(e,t,1,-1)}function Sp(t){var e=bn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:t},e.queue=t,t=t.dispatch=Jx.bind(null,$e,t),[e.memoizedState,t]}function ko(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function my(){return gn().memoizedState}function Ga(t,e,n,r){var s=bn();$e.flags|=t,s.memoizedState=ko(1|e,n,void 0,r===void 0?null:r)}function Hl(t,e,n,r){var s=gn();r=r===void 0?null:r;var i=void 0;if(it!==null){var a=it.memoizedState;if(i=a.destroy,r!==null&&ih(r,a.deps)){s.memoizedState=ko(e,n,i,r);return}}$e.flags|=t,s.memoizedState=ko(1|e,n,i,r)}function Ep(t,e){return Ga(8390656,8,t,e)}function lh(t,e){return Hl(2048,8,t,e)}function gy(t,e){return Hl(4,2,t,e)}function yy(t,e){return Hl(4,4,t,e)}function vy(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function _y(t,e,n){return n=n!=null?n.concat([t]):null,Hl(4,4,vy.bind(null,e,t),n)}function uh(){}function xy(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ih(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function wy(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ih(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Sy(t,e,n){return ls&21?(In(n,e)||(n=Cg(),$e.lanes|=n,us|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ut=!0),t.memoizedState=n)}function Yx(t,e){var n=Ee;Ee=n!==0&&4>n?n:4,t(!0);var r=$u.transition;$u.transition={};try{t(!1),e()}finally{Ee=n,$u.transition=r}}function Ey(){return gn().memoizedState}function Xx(t,e,n){var r=Pr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ty(t))Iy(e,n);else if(n=iy(t,e,n,r),n!==null){var s=Vt();Tn(n,t,r,s),Ay(n,e,r)}}function Jx(t,e,n){var r=Pr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ty(t))Iy(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,In(l,a)){var u=e.interleaved;u===null?(s.next=s,eh(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=iy(t,e,s,r),n!==null&&(s=Vt(),Tn(n,t,r,s),Ay(n,e,r))}}function Ty(t){var e=t.alternate;return t===$e||e!==null&&e===$e}function Iy(t,e){so=xl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ay(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zd(t,n)}}var wl={readContext:mn,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useInsertionEffect:It,useLayoutEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useMutableSource:It,useSyncExternalStore:It,useId:It,unstable_isNewReconciler:!1},Zx={readContext:mn,useCallback:function(t,e){return bn().memoizedState=[t,e===void 0?null:e],t},useContext:mn,useEffect:Ep,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ga(4194308,4,vy.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ga(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ga(4,2,t,e)},useMemo:function(t,e){var n=bn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=bn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Xx.bind(null,$e,t),[r.memoizedState,t]},useRef:function(t){var e=bn();return t={current:t},e.memoizedState=t},useState:Sp,useDebugValue:uh,useDeferredValue:function(t){return bn().memoizedState=t},useTransition:function(){var t=Sp(!1),e=t[0];return t=Yx.bind(null,t[1]),bn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=$e,s=bn();if(Le){if(n===void 0)throw Error(q(407));n=n()}else{if(n=e(),ht===null)throw Error(q(349));ls&30||cy(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Ep(hy.bind(null,r,i,t),[t]),r.flags|=2048,ko(9,dy.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=bn(),e=ht.identifierPrefix;if(Le){var n=Xn,r=Yn;n=(r&~(1<<32-En(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ao++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Kx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},e1={readContext:mn,useCallback:xy,useContext:mn,useEffect:lh,useImperativeHandle:_y,useInsertionEffect:gy,useLayoutEffect:yy,useMemo:wy,useReducer:Wu,useRef:my,useState:function(){return Wu(Co)},useDebugValue:uh,useDeferredValue:function(t){var e=gn();return Sy(e,it.memoizedState,t)},useTransition:function(){var t=Wu(Co)[0],e=gn().memoizedState;return[t,e]},useMutableSource:ly,useSyncExternalStore:uy,useId:Ey,unstable_isNewReconciler:!1},t1={readContext:mn,useCallback:xy,useContext:mn,useEffect:lh,useImperativeHandle:_y,useInsertionEffect:gy,useLayoutEffect:yy,useMemo:wy,useReducer:Hu,useRef:my,useState:function(){return Hu(Co)},useDebugValue:uh,useDeferredValue:function(t){var e=gn();return it===null?e.memoizedState=t:Sy(e,it.memoizedState,t)},useTransition:function(){var t=Hu(Co)[0],e=gn().memoizedState;return[t,e]},useMutableSource:ly,useSyncExternalStore:uy,useId:Ey,unstable_isNewReconciler:!1};function xn(t,e){if(t&&t.defaultProps){e=We({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function zc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:We({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ql={isMounted:function(t){return(t=t._reactInternals)?ms(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Vt(),s=Pr(t),i=Jn(r,s);i.payload=e,n!=null&&(i.callback=n),e=kr(t,i,s),e!==null&&(Tn(e,t,s,r),Ha(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Vt(),s=Pr(t),i=Jn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=kr(t,i,s),e!==null&&(Tn(e,t,s,r),Ha(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Vt(),r=Pr(t),s=Jn(n,r);s.tag=2,e!=null&&(s.callback=e),e=kr(t,s,r),e!==null&&(Tn(e,t,r,n),Ha(e,t,r))}};function Tp(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!xo(n,r)||!xo(s,i):!0}function Cy(t,e,n){var r=!1,s=Lr,i=e.contextType;return typeof i=="object"&&i!==null?i=mn(i):(s=Wt(e)?os:Dt.current,r=e.contextTypes,i=(r=r!=null)?ri(t,s):Lr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ql,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Ip(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ql.enqueueReplaceState(e,e.state,null)}function Bc(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},th(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=mn(i):(i=Wt(e)?os:Dt.current,s.context=ri(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(zc(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&ql.enqueueReplaceState(s,s.state,null),vl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ai(t,e){try{var n="",r=e;do n+=R_(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function qu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Uc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var n1=typeof WeakMap=="function"?WeakMap:Map;function ky(t,e,n){n=Jn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){El||(El=!0,Jc=r),Uc(t,e)},n}function Ry(t,e,n){n=Jn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Uc(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Uc(t,e),typeof r!="function"&&(Rr===null?Rr=new Set([this]):Rr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Ap(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new n1;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=g1.bind(null,t,e,n),e.then(t,t))}function Cp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function kp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Jn(-1,1),e.tag=2,kr(n,e,1))),n.lanes|=1),t)}var r1=lr.ReactCurrentOwner,Ut=!1;function jt(t,e,n,r){e.child=t===null?sy(e,null,n,r):ii(e,t.child,n,r)}function Rp(t,e,n,r,s){n=n.render;var i=e.ref;return Zs(e,s),r=oh(t,e,n,r,i,s),n=ah(),t!==null&&!Ut?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,sr(t,e,s)):(Le&&n&&Qd(e),e.flags|=1,jt(t,e,r,s),e.child)}function Pp(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!yh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Py(t,e,i,r,s)):(t=Xa(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:xo,n(a,r)&&t.ref===e.ref)return sr(t,e,s)}return e.flags|=1,t=Dr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Py(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(xo(i,r)&&t.ref===e.ref)if(Ut=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Ut=!0);else return e.lanes=t.lanes,sr(t,e,s)}return $c(t,e,n,r,s)}function Dy(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(Qs,Jt),Jt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,De(Qs,Jt),Jt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,De(Qs,Jt),Jt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,De(Qs,Jt),Jt|=r;return jt(t,e,s,n),e.child}function Ny(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function $c(t,e,n,r,s){var i=Wt(n)?os:Dt.current;return i=ri(e,i),Zs(e,s),n=oh(t,e,n,r,i,s),r=ah(),t!==null&&!Ut?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,sr(t,e,s)):(Le&&r&&Qd(e),e.flags|=1,jt(t,e,n,s),e.child)}function Dp(t,e,n,r,s){if(Wt(n)){var i=!0;fl(e)}else i=!1;if(Zs(e,s),e.stateNode===null)Qa(t,e),Cy(e,n,r),Bc(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=mn(h):(h=Wt(n)?os:Dt.current,h=ri(e,h));var p=n.getDerivedStateFromProps,g=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";g||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||u!==h)&&Ip(e,a,r,h),vr=!1;var m=e.memoizedState;a.state=m,vl(e,r,a,s),u=e.memoizedState,l!==r||m!==u||$t.current||vr?(typeof p=="function"&&(zc(e,n,p,r),u=e.memoizedState),(l=vr||Tp(e,n,l,r,m,u,h))?(g||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,oy(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:xn(e.type,l),a.props=h,g=e.pendingProps,m=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=mn(u):(u=Wt(n)?os:Dt.current,u=ri(e,u));var w=n.getDerivedStateFromProps;(p=typeof w=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==g||m!==u)&&Ip(e,a,r,u),vr=!1,m=e.memoizedState,a.state=m,vl(e,r,a,s);var C=e.memoizedState;l!==g||m!==C||$t.current||vr?(typeof w=="function"&&(zc(e,n,w,r),C=e.memoizedState),(h=vr||Tp(e,n,h,r,m,C,u)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,C,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,C,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=C),a.props=r,a.state=C,a.context=u,r=h):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Wc(t,e,n,r,i,s)}function Wc(t,e,n,r,s,i){Ny(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&gp(e,n,!1),sr(t,e,i);r=e.stateNode,r1.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=ii(e,t.child,null,i),e.child=ii(e,null,l,i)):jt(t,e,l,i),e.memoizedState=r.state,s&&gp(e,n,!0),e.child}function by(t){var e=t.stateNode;e.pendingContext?mp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&mp(t,e.context,!1),nh(t,e.containerInfo)}function Np(t,e,n,r,s){return si(),Yd(s),e.flags|=256,jt(t,e,n,r),e.child}var Hc={dehydrated:null,treeContext:null,retryLane:0};function qc(t){return{baseLanes:t,cachePool:null,transitions:null}}function jy(t,e,n){var r=e.pendingProps,s=Ue.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),De(Ue,s&1),t===null)return Oc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Kl(a,r,0,null),t=ss(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=qc(n),e.memoizedState=Hc,t):ch(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return s1(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Dr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Dr(l,i):(i=ss(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?qc(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=Hc,r}return i=t.child,t=i.sibling,r=Dr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ch(t,e){return e=Kl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Na(t,e,n,r){return r!==null&&Yd(r),ii(e,t.child,null,n),t=ch(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function s1(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=qu(Error(q(422))),Na(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Kl({mode:"visible",children:r.children},s,0,null),i=ss(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ii(e,t.child,null,a),e.child.memoizedState=qc(a),e.memoizedState=Hc,i);if(!(e.mode&1))return Na(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(q(419)),r=qu(i,r,void 0),Na(t,e,a,r)}if(l=(a&t.childLanes)!==0,Ut||l){if(r=ht,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,rr(t,s),Tn(r,t,s,-1))}return gh(),r=qu(Error(q(421))),Na(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=y1.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Zt=Cr(s.nextSibling),tn=e,Le=!0,Sn=null,t!==null&&(ln[un++]=Yn,ln[un++]=Xn,ln[un++]=as,Yn=t.id,Xn=t.overflow,as=e),e=ch(e,r.children),e.flags|=4096,e)}function bp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Fc(t.return,e,n)}function Gu(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Vy(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(jt(t,e,r.children,n),r=Ue.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&bp(t,n,e);else if(t.tag===19)bp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(De(Ue,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&_l(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Gu(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&_l(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Gu(e,!0,n,null,i);break;case"together":Gu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Qa(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function sr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),us|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(q(153));if(e.child!==null){for(t=e.child,n=Dr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Dr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function i1(t,e,n){switch(e.tag){case 3:by(e),si();break;case 5:ay(e);break;case 1:Wt(e.type)&&fl(e);break;case 4:nh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;De(gl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(De(Ue,Ue.current&1),e.flags|=128,null):n&e.child.childLanes?jy(t,e,n):(De(Ue,Ue.current&1),t=sr(t,e,n),t!==null?t.sibling:null);De(Ue,Ue.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Vy(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),De(Ue,Ue.current),r)break;return null;case 22:case 23:return e.lanes=0,Dy(t,e,n)}return sr(t,e,n)}var My,Gc,Ly,Oy;My=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Gc=function(){};Ly=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ts(Mn.current);var i=null;switch(n){case"input":s=mc(t,s),r=mc(t,r),i=[];break;case"select":s=We({},s,{value:void 0}),r=We({},r,{value:void 0}),i=[];break;case"textarea":s=vc(t,s),r=vc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=dl)}xc(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(fo.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var u=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&u!==l&&(u!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(fo.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&be("scroll",t),i||l===u||(i=[])):(i=i||[]).push(h,u))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};Oy=function(t,e,n,r){n!==r&&(e.flags|=4)};function Bi(t,e){if(!Le)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function At(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function o1(t,e,n){var r=e.pendingProps;switch(Kd(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(e),null;case 1:return Wt(e.type)&&hl(),At(e),null;case 3:return r=e.stateNode,oi(),Me($t),Me(Dt),sh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Pa(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Sn!==null&&(td(Sn),Sn=null))),Gc(t,e),At(e),null;case 5:rh(e);var s=ts(Io.current);if(n=e.type,t!==null&&e.stateNode!=null)Ly(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(q(166));return At(e),null}if(t=ts(Mn.current),Pa(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[jn]=e,r[Eo]=i,t=(e.mode&1)!==0,n){case"dialog":be("cancel",r),be("close",r);break;case"iframe":case"object":case"embed":be("load",r);break;case"video":case"audio":for(s=0;s<Gi.length;s++)be(Gi[s],r);break;case"source":be("error",r);break;case"img":case"image":case"link":be("error",r),be("load",r);break;case"details":be("toggle",r);break;case"input":Uf(r,i),be("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},be("invalid",r);break;case"textarea":Wf(r,i),be("invalid",r)}xc(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ra(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ra(r.textContent,l,t),s=["children",""+l]):fo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&be("scroll",r)}switch(n){case"input":wa(r),$f(r,i,!0);break;case"textarea":wa(r),Hf(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=dl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=hg(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[jn]=e,t[Eo]=r,My(t,e,!1,!1),e.stateNode=t;e:{switch(a=wc(n,r),n){case"dialog":be("cancel",t),be("close",t),s=r;break;case"iframe":case"object":case"embed":be("load",t),s=r;break;case"video":case"audio":for(s=0;s<Gi.length;s++)be(Gi[s],t);s=r;break;case"source":be("error",t),s=r;break;case"img":case"image":case"link":be("error",t),be("load",t),s=r;break;case"details":be("toggle",t),s=r;break;case"input":Uf(t,r),s=mc(t,r),be("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=We({},r,{value:void 0}),be("invalid",t);break;case"textarea":Wf(t,r),s=vc(t,r),be("invalid",t);break;default:s=r}xc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?mg(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&fg(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&po(t,u):typeof u=="number"&&po(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(fo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&be("scroll",t):u!=null&&jd(t,i,u,a))}switch(n){case"input":wa(t),$f(t,r,!1);break;case"textarea":wa(t),Hf(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Mr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ks(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ks(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=dl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return At(e),null;case 6:if(t&&e.stateNode!=null)Oy(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(q(166));if(n=ts(Io.current),ts(Mn.current),Pa(e)){if(r=e.stateNode,n=e.memoizedProps,r[jn]=e,(i=r.nodeValue!==n)&&(t=tn,t!==null))switch(t.tag){case 3:Ra(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ra(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[jn]=e,e.stateNode=r}return At(e),null;case 13:if(Me(Ue),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Le&&Zt!==null&&e.mode&1&&!(e.flags&128))ny(),si(),e.flags|=98560,i=!1;else if(i=Pa(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(q(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(q(317));i[jn]=e}else si(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;At(e),i=!1}else Sn!==null&&(td(Sn),Sn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ue.current&1?ot===0&&(ot=3):gh())),e.updateQueue!==null&&(e.flags|=4),At(e),null);case 4:return oi(),Gc(t,e),t===null&&wo(e.stateNode.containerInfo),At(e),null;case 10:return Zd(e.type._context),At(e),null;case 17:return Wt(e.type)&&hl(),At(e),null;case 19:if(Me(Ue),i=e.memoizedState,i===null)return At(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Bi(i,!1);else{if(ot!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=_l(t),a!==null){for(e.flags|=128,Bi(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return De(Ue,Ue.current&1|2),e.child}t=t.sibling}i.tail!==null&&Xe()>li&&(e.flags|=128,r=!0,Bi(i,!1),e.lanes=4194304)}else{if(!r)if(t=_l(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Bi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Le)return At(e),null}else 2*Xe()-i.renderingStartTime>li&&n!==1073741824&&(e.flags|=128,r=!0,Bi(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Xe(),e.sibling=null,n=Ue.current,De(Ue,r?n&1|2:n&1),e):(At(e),null);case 22:case 23:return mh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Jt&1073741824&&(At(e),e.subtreeFlags&6&&(e.flags|=8192)):At(e),null;case 24:return null;case 25:return null}throw Error(q(156,e.tag))}function a1(t,e){switch(Kd(e),e.tag){case 1:return Wt(e.type)&&hl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return oi(),Me($t),Me(Dt),sh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return rh(e),null;case 13:if(Me(Ue),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(q(340));si()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Me(Ue),null;case 4:return oi(),null;case 10:return Zd(e.type._context),null;case 22:case 23:return mh(),null;case 24:return null;default:return null}}var ba=!1,Rt=!1,l1=typeof WeakSet=="function"?WeakSet:Set,Z=null;function Gs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Qe(t,e,r)}else n.current=null}function Qc(t,e,n){try{n()}catch(r){Qe(t,e,r)}}var jp=!1;function u1(t,e){if(Dc=ll,t=$g(),Gd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,u=-1,h=0,p=0,g=t,m=null;t:for(;;){for(var w;g!==n||s!==0&&g.nodeType!==3||(l=a+s),g!==i||r!==0&&g.nodeType!==3||(u=a+r),g.nodeType===3&&(a+=g.nodeValue.length),(w=g.firstChild)!==null;)m=g,g=w;for(;;){if(g===t)break t;if(m===n&&++h===s&&(l=a),m===i&&++p===r&&(u=a),(w=g.nextSibling)!==null)break;g=m,m=g.parentNode}g=w}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Nc={focusedElem:t,selectionRange:n},ll=!1,Z=e;Z!==null;)if(e=Z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Z=t;else for(;Z!==null;){e=Z;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var P=C.memoizedProps,M=C.memoizedState,k=e.stateNode,A=k.getSnapshotBeforeUpdate(e.elementType===e.type?P:xn(e.type,P),M);k.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var R=e.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(V){Qe(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,Z=t;break}Z=e.return}return C=jp,jp=!1,C}function io(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Qc(e,n,i)}s=s.next}while(s!==r)}}function Gl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Kc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Fy(t){var e=t.alternate;e!==null&&(t.alternate=null,Fy(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[jn],delete e[Eo],delete e[Vc],delete e[Hx],delete e[qx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function zy(t){return t.tag===5||t.tag===3||t.tag===4}function Vp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||zy(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Yc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=dl));else if(r!==4&&(t=t.child,t!==null))for(Yc(t,e,n),t=t.sibling;t!==null;)Yc(t,e,n),t=t.sibling}function Xc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Xc(t,e,n),t=t.sibling;t!==null;)Xc(t,e,n),t=t.sibling}var pt=null,wn=!1;function gr(t,e,n){for(n=n.child;n!==null;)By(t,e,n),n=n.sibling}function By(t,e,n){if(Vn&&typeof Vn.onCommitFiberUnmount=="function")try{Vn.onCommitFiberUnmount(Fl,n)}catch{}switch(n.tag){case 5:Rt||Gs(n,e);case 6:var r=pt,s=wn;pt=null,gr(t,e,n),pt=r,wn=s,pt!==null&&(wn?(t=pt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):pt.removeChild(n.stateNode));break;case 18:pt!==null&&(wn?(t=pt,n=n.stateNode,t.nodeType===8?zu(t.parentNode,n):t.nodeType===1&&zu(t,n),vo(t)):zu(pt,n.stateNode));break;case 4:r=pt,s=wn,pt=n.stateNode.containerInfo,wn=!0,gr(t,e,n),pt=r,wn=s;break;case 0:case 11:case 14:case 15:if(!Rt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Qc(n,e,a),s=s.next}while(s!==r)}gr(t,e,n);break;case 1:if(!Rt&&(Gs(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Qe(n,e,l)}gr(t,e,n);break;case 21:gr(t,e,n);break;case 22:n.mode&1?(Rt=(r=Rt)||n.memoizedState!==null,gr(t,e,n),Rt=r):gr(t,e,n);break;default:gr(t,e,n)}}function Mp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new l1),e.forEach(function(r){var s=v1.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function _n(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:pt=l.stateNode,wn=!1;break e;case 3:pt=l.stateNode.containerInfo,wn=!0;break e;case 4:pt=l.stateNode.containerInfo,wn=!0;break e}l=l.return}if(pt===null)throw Error(q(160));By(i,a,s),pt=null,wn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(h){Qe(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Uy(e,t),e=e.sibling}function Uy(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(_n(e,t),Nn(t),r&4){try{io(3,t,t.return),Gl(3,t)}catch(P){Qe(t,t.return,P)}try{io(5,t,t.return)}catch(P){Qe(t,t.return,P)}}break;case 1:_n(e,t),Nn(t),r&512&&n!==null&&Gs(n,n.return);break;case 5:if(_n(e,t),Nn(t),r&512&&n!==null&&Gs(n,n.return),t.flags&32){var s=t.stateNode;try{po(s,"")}catch(P){Qe(t,t.return,P)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&cg(s,i),wc(l,a);var h=wc(l,i);for(a=0;a<u.length;a+=2){var p=u[a],g=u[a+1];p==="style"?mg(s,g):p==="dangerouslySetInnerHTML"?fg(s,g):p==="children"?po(s,g):jd(s,p,g,h)}switch(l){case"input":gc(s,i);break;case"textarea":dg(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?Ks(s,!!i.multiple,w,!1):m!==!!i.multiple&&(i.defaultValue!=null?Ks(s,!!i.multiple,i.defaultValue,!0):Ks(s,!!i.multiple,i.multiple?[]:"",!1))}s[Eo]=i}catch(P){Qe(t,t.return,P)}}break;case 6:if(_n(e,t),Nn(t),r&4){if(t.stateNode===null)throw Error(q(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){Qe(t,t.return,P)}}break;case 3:if(_n(e,t),Nn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{vo(e.containerInfo)}catch(P){Qe(t,t.return,P)}break;case 4:_n(e,t),Nn(t);break;case 13:_n(e,t),Nn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(fh=Xe())),r&4&&Mp(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(Rt=(h=Rt)||p,_n(e,t),Rt=h):_n(e,t),Nn(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(Z=t,p=t.child;p!==null;){for(g=Z=p;Z!==null;){switch(m=Z,w=m.child,m.tag){case 0:case 11:case 14:case 15:io(4,m,m.return);break;case 1:Gs(m,m.return);var C=m.stateNode;if(typeof C.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(P){Qe(r,n,P)}}break;case 5:Gs(m,m.return);break;case 22:if(m.memoizedState!==null){Op(g);continue}}w!==null?(w.return=m,Z=w):Op(g)}p=p.sibling}e:for(p=null,g=t;;){if(g.tag===5){if(p===null){p=g;try{s=g.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=g.stateNode,u=g.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=pg("display",a))}catch(P){Qe(t,t.return,P)}}}else if(g.tag===6){if(p===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(P){Qe(t,t.return,P)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;p===g&&(p=null),g=g.return}p===g&&(p=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:_n(e,t),Nn(t),r&4&&Mp(t);break;case 21:break;default:_n(e,t),Nn(t)}}function Nn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(zy(n)){var r=n;break e}n=n.return}throw Error(q(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(po(s,""),r.flags&=-33);var i=Vp(t);Xc(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Vp(t);Yc(t,l,a);break;default:throw Error(q(161))}}catch(u){Qe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function c1(t,e,n){Z=t,$y(t)}function $y(t,e,n){for(var r=(t.mode&1)!==0;Z!==null;){var s=Z,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||ba;if(!a){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Rt;l=ba;var h=Rt;if(ba=a,(Rt=u)&&!h)for(Z=s;Z!==null;)a=Z,u=a.child,a.tag===22&&a.memoizedState!==null?Fp(s):u!==null?(u.return=a,Z=u):Fp(s);for(;i!==null;)Z=i,$y(i),i=i.sibling;Z=s,ba=l,Rt=h}Lp(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Z=i):Lp(t)}}function Lp(t){for(;Z!==null;){var e=Z;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Rt||Gl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Rt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:xn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&wp(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}wp(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var g=p.dehydrated;g!==null&&vo(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}Rt||e.flags&512&&Kc(e)}catch(m){Qe(e,e.return,m)}}if(e===t){Z=null;break}if(n=e.sibling,n!==null){n.return=e.return,Z=n;break}Z=e.return}}function Op(t){for(;Z!==null;){var e=Z;if(e===t){Z=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Z=n;break}Z=e.return}}function Fp(t){for(;Z!==null;){var e=Z;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Gl(4,e)}catch(u){Qe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Qe(e,s,u)}}var i=e.return;try{Kc(e)}catch(u){Qe(e,i,u)}break;case 5:var a=e.return;try{Kc(e)}catch(u){Qe(e,a,u)}}}catch(u){Qe(e,e.return,u)}if(e===t){Z=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Z=l;break}Z=e.return}}var d1=Math.ceil,Sl=lr.ReactCurrentDispatcher,dh=lr.ReactCurrentOwner,fn=lr.ReactCurrentBatchConfig,ye=0,ht=null,nt=null,yt=0,Jt=0,Qs=Ur(0),ot=0,Ro=null,us=0,Ql=0,hh=0,oo=null,zt=null,fh=0,li=1/0,qn=null,El=!1,Jc=null,Rr=null,ja=!1,Sr=null,Tl=0,ao=0,Zc=null,Ka=-1,Ya=0;function Vt(){return ye&6?Xe():Ka!==-1?Ka:Ka=Xe()}function Pr(t){return t.mode&1?ye&2&&yt!==0?yt&-yt:Qx.transition!==null?(Ya===0&&(Ya=Cg()),Ya):(t=Ee,t!==0||(t=window.event,t=t===void 0?16:jg(t.type)),t):1}function Tn(t,e,n,r){if(50<ao)throw ao=0,Zc=null,Error(q(185));Bo(t,n,r),(!(ye&2)||t!==ht)&&(t===ht&&(!(ye&2)&&(Ql|=n),ot===4&&xr(t,yt)),Ht(t,r),n===1&&ye===0&&!(e.mode&1)&&(li=Xe()+500,Wl&&$r()))}function Ht(t,e){var n=t.callbackNode;Q_(t,e);var r=al(t,t===ht?yt:0);if(r===0)n!==null&&Qf(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Qf(n),e===1)t.tag===0?Gx(zp.bind(null,t)):Zg(zp.bind(null,t)),$x(function(){!(ye&6)&&$r()}),n=null;else{switch(kg(r)){case 1:n=Fd;break;case 4:n=Ig;break;case 16:n=ol;break;case 536870912:n=Ag;break;default:n=ol}n=Xy(n,Wy.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Wy(t,e){if(Ka=-1,Ya=0,ye&6)throw Error(q(327));var n=t.callbackNode;if(ei()&&t.callbackNode!==n)return null;var r=al(t,t===ht?yt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Il(t,r);else{e=r;var s=ye;ye|=2;var i=qy();(ht!==t||yt!==e)&&(qn=null,li=Xe()+500,rs(t,e));do try{p1();break}catch(l){Hy(t,l)}while(!0);Jd(),Sl.current=i,ye=s,nt!==null?e=0:(ht=null,yt=0,e=ot)}if(e!==0){if(e===2&&(s=Ac(t),s!==0&&(r=s,e=ed(t,s))),e===1)throw n=Ro,rs(t,0),xr(t,r),Ht(t,Xe()),n;if(e===6)xr(t,r);else{if(s=t.current.alternate,!(r&30)&&!h1(s)&&(e=Il(t,r),e===2&&(i=Ac(t),i!==0&&(r=i,e=ed(t,i))),e===1))throw n=Ro,rs(t,0),xr(t,r),Ht(t,Xe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(q(345));case 2:Xr(t,zt,qn);break;case 3:if(xr(t,r),(r&130023424)===r&&(e=fh+500-Xe(),10<e)){if(al(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Vt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=jc(Xr.bind(null,t,zt,qn),e);break}Xr(t,zt,qn);break;case 4:if(xr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-En(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=Xe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*d1(r/1960))-r,10<r){t.timeoutHandle=jc(Xr.bind(null,t,zt,qn),r);break}Xr(t,zt,qn);break;case 5:Xr(t,zt,qn);break;default:throw Error(q(329))}}}return Ht(t,Xe()),t.callbackNode===n?Wy.bind(null,t):null}function ed(t,e){var n=oo;return t.current.memoizedState.isDehydrated&&(rs(t,e).flags|=256),t=Il(t,e),t!==2&&(e=zt,zt=n,e!==null&&td(e)),t}function td(t){zt===null?zt=t:zt.push.apply(zt,t)}function h1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!In(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function xr(t,e){for(e&=~hh,e&=~Ql,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-En(e),r=1<<n;t[n]=-1,e&=~r}}function zp(t){if(ye&6)throw Error(q(327));ei();var e=al(t,0);if(!(e&1))return Ht(t,Xe()),null;var n=Il(t,e);if(t.tag!==0&&n===2){var r=Ac(t);r!==0&&(e=r,n=ed(t,r))}if(n===1)throw n=Ro,rs(t,0),xr(t,e),Ht(t,Xe()),n;if(n===6)throw Error(q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Xr(t,zt,qn),Ht(t,Xe()),null}function ph(t,e){var n=ye;ye|=1;try{return t(e)}finally{ye=n,ye===0&&(li=Xe()+500,Wl&&$r())}}function cs(t){Sr!==null&&Sr.tag===0&&!(ye&6)&&ei();var e=ye;ye|=1;var n=fn.transition,r=Ee;try{if(fn.transition=null,Ee=1,t)return t()}finally{Ee=r,fn.transition=n,ye=e,!(ye&6)&&$r()}}function mh(){Jt=Qs.current,Me(Qs)}function rs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Ux(n)),nt!==null)for(n=nt.return;n!==null;){var r=n;switch(Kd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&hl();break;case 3:oi(),Me($t),Me(Dt),sh();break;case 5:rh(r);break;case 4:oi();break;case 13:Me(Ue);break;case 19:Me(Ue);break;case 10:Zd(r.type._context);break;case 22:case 23:mh()}n=n.return}if(ht=t,nt=t=Dr(t.current,null),yt=Jt=e,ot=0,Ro=null,hh=Ql=us=0,zt=oo=null,es!==null){for(e=0;e<es.length;e++)if(n=es[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}es=null}return t}function Hy(t,e){do{var n=nt;try{if(Jd(),qa.current=wl,xl){for(var r=$e.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}xl=!1}if(ls=0,dt=it=$e=null,so=!1,Ao=0,dh.current=null,n===null||n.return===null){ot=1,Ro=e,nt=null;break}e:{var i=t,a=n.return,l=n,u=e;if(e=yt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,p=l,g=p.tag;if(!(p.mode&1)&&(g===0||g===11||g===15)){var m=p.alternate;m?(p.updateQueue=m.updateQueue,p.memoizedState=m.memoizedState,p.lanes=m.lanes):(p.updateQueue=null,p.memoizedState=null)}var w=Cp(a);if(w!==null){w.flags&=-257,kp(w,a,l,i,e),w.mode&1&&Ap(i,h,e),e=w,u=h;var C=e.updateQueue;if(C===null){var P=new Set;P.add(u),e.updateQueue=P}else C.add(u);break e}else{if(!(e&1)){Ap(i,h,e),gh();break e}u=Error(q(426))}}else if(Le&&l.mode&1){var M=Cp(a);if(M!==null){!(M.flags&65536)&&(M.flags|=256),kp(M,a,l,i,e),Yd(ai(u,l));break e}}i=u=ai(u,l),ot!==4&&(ot=2),oo===null?oo=[i]:oo.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var k=ky(i,u,e);xp(i,k);break e;case 1:l=u;var A=i.type,R=i.stateNode;if(!(i.flags&128)&&(typeof A.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(Rr===null||!Rr.has(R)))){i.flags|=65536,e&=-e,i.lanes|=e;var V=Ry(i,l,e);xp(i,V);break e}}i=i.return}while(i!==null)}Qy(n)}catch(z){e=z,nt===n&&n!==null&&(nt=n=n.return);continue}break}while(!0)}function qy(){var t=Sl.current;return Sl.current=wl,t===null?wl:t}function gh(){(ot===0||ot===3||ot===2)&&(ot=4),ht===null||!(us&268435455)&&!(Ql&268435455)||xr(ht,yt)}function Il(t,e){var n=ye;ye|=2;var r=qy();(ht!==t||yt!==e)&&(qn=null,rs(t,e));do try{f1();break}catch(s){Hy(t,s)}while(!0);if(Jd(),ye=n,Sl.current=r,nt!==null)throw Error(q(261));return ht=null,yt=0,ot}function f1(){for(;nt!==null;)Gy(nt)}function p1(){for(;nt!==null&&!F_();)Gy(nt)}function Gy(t){var e=Yy(t.alternate,t,Jt);t.memoizedProps=t.pendingProps,e===null?Qy(t):nt=e,dh.current=null}function Qy(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=a1(n,e),n!==null){n.flags&=32767,nt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ot=6,nt=null;return}}else if(n=o1(n,e,Jt),n!==null){nt=n;return}if(e=e.sibling,e!==null){nt=e;return}nt=e=t}while(e!==null);ot===0&&(ot=5)}function Xr(t,e,n){var r=Ee,s=fn.transition;try{fn.transition=null,Ee=1,m1(t,e,n,r)}finally{fn.transition=s,Ee=r}return null}function m1(t,e,n,r){do ei();while(Sr!==null);if(ye&6)throw Error(q(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(q(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(K_(t,i),t===ht&&(nt=ht=null,yt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ja||(ja=!0,Xy(ol,function(){return ei(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=fn.transition,fn.transition=null;var a=Ee;Ee=1;var l=ye;ye|=4,dh.current=null,u1(t,n),Uy(n,t),Vx(Nc),ll=!!Dc,Nc=Dc=null,t.current=n,c1(n),z_(),ye=l,Ee=a,fn.transition=i}else t.current=n;if(ja&&(ja=!1,Sr=t,Tl=s),i=t.pendingLanes,i===0&&(Rr=null),$_(n.stateNode),Ht(t,Xe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(El)throw El=!1,t=Jc,Jc=null,t;return Tl&1&&t.tag!==0&&ei(),i=t.pendingLanes,i&1?t===Zc?ao++:(ao=0,Zc=t):ao=0,$r(),null}function ei(){if(Sr!==null){var t=kg(Tl),e=fn.transition,n=Ee;try{if(fn.transition=null,Ee=16>t?16:t,Sr===null)var r=!1;else{if(t=Sr,Sr=null,Tl=0,ye&6)throw Error(q(331));var s=ye;for(ye|=4,Z=t.current;Z!==null;){var i=Z,a=i.child;if(Z.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var h=l[u];for(Z=h;Z!==null;){var p=Z;switch(p.tag){case 0:case 11:case 15:io(8,p,i)}var g=p.child;if(g!==null)g.return=p,Z=g;else for(;Z!==null;){p=Z;var m=p.sibling,w=p.return;if(Fy(p),p===h){Z=null;break}if(m!==null){m.return=w,Z=m;break}Z=w}}}var C=i.alternate;if(C!==null){var P=C.child;if(P!==null){C.child=null;do{var M=P.sibling;P.sibling=null,P=M}while(P!==null)}}Z=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Z=a;else e:for(;Z!==null;){if(i=Z,i.flags&2048)switch(i.tag){case 0:case 11:case 15:io(9,i,i.return)}var k=i.sibling;if(k!==null){k.return=i.return,Z=k;break e}Z=i.return}}var A=t.current;for(Z=A;Z!==null;){a=Z;var R=a.child;if(a.subtreeFlags&2064&&R!==null)R.return=a,Z=R;else e:for(a=A;Z!==null;){if(l=Z,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Gl(9,l)}}catch(z){Qe(l,l.return,z)}if(l===a){Z=null;break e}var V=l.sibling;if(V!==null){V.return=l.return,Z=V;break e}Z=l.return}}if(ye=s,$r(),Vn&&typeof Vn.onPostCommitFiberRoot=="function")try{Vn.onPostCommitFiberRoot(Fl,t)}catch{}r=!0}return r}finally{Ee=n,fn.transition=e}}return!1}function Bp(t,e,n){e=ai(n,e),e=ky(t,e,1),t=kr(t,e,1),e=Vt(),t!==null&&(Bo(t,1,e),Ht(t,e))}function Qe(t,e,n){if(t.tag===3)Bp(t,t,n);else for(;e!==null;){if(e.tag===3){Bp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rr===null||!Rr.has(r))){t=ai(n,t),t=Ry(e,t,1),e=kr(e,t,1),t=Vt(),e!==null&&(Bo(e,1,t),Ht(e,t));break}}e=e.return}}function g1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Vt(),t.pingedLanes|=t.suspendedLanes&n,ht===t&&(yt&n)===n&&(ot===4||ot===3&&(yt&130023424)===yt&&500>Xe()-fh?rs(t,0):hh|=n),Ht(t,e)}function Ky(t,e){e===0&&(t.mode&1?(e=Ta,Ta<<=1,!(Ta&130023424)&&(Ta=4194304)):e=1);var n=Vt();t=rr(t,e),t!==null&&(Bo(t,e,n),Ht(t,n))}function y1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Ky(t,n)}function v1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(q(314))}r!==null&&r.delete(e),Ky(t,n)}var Yy;Yy=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||$t.current)Ut=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ut=!1,i1(t,e,n);Ut=!!(t.flags&131072)}else Ut=!1,Le&&e.flags&1048576&&ey(e,ml,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Qa(t,e),t=e.pendingProps;var s=ri(e,Dt.current);Zs(e,n),s=oh(null,e,r,t,s,n);var i=ah();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Wt(r)?(i=!0,fl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,th(e),s.updater=ql,e.stateNode=s,s._reactInternals=e,Bc(e,r,t,n),e=Wc(null,e,r,!0,i,n)):(e.tag=0,Le&&i&&Qd(e),jt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Qa(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=x1(r),t=xn(r,t),s){case 0:e=$c(null,e,r,t,n);break e;case 1:e=Dp(null,e,r,t,n);break e;case 11:e=Rp(null,e,r,t,n);break e;case 14:e=Pp(null,e,r,xn(r.type,t),n);break e}throw Error(q(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),$c(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Dp(t,e,r,s,n);case 3:e:{if(by(e),t===null)throw Error(q(387));r=e.pendingProps,i=e.memoizedState,s=i.element,oy(t,e),vl(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ai(Error(q(423)),e),e=Np(t,e,r,n,s);break e}else if(r!==s){s=ai(Error(q(424)),e),e=Np(t,e,r,n,s);break e}else for(Zt=Cr(e.stateNode.containerInfo.firstChild),tn=e,Le=!0,Sn=null,n=sy(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(si(),r===s){e=sr(t,e,n);break e}jt(t,e,r,n)}e=e.child}return e;case 5:return ay(e),t===null&&Oc(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,bc(r,s)?a=null:i!==null&&bc(r,i)&&(e.flags|=32),Ny(t,e),jt(t,e,a,n),e.child;case 6:return t===null&&Oc(e),null;case 13:return jy(t,e,n);case 4:return nh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ii(e,null,r,n):jt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Rp(t,e,r,s,n);case 7:return jt(t,e,e.pendingProps,n),e.child;case 8:return jt(t,e,e.pendingProps.children,n),e.child;case 12:return jt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,De(gl,r._currentValue),r._currentValue=a,i!==null)if(In(i.value,a)){if(i.children===s.children&&!$t.current){e=sr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Jn(-1,n&-n),u.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?u.next=u:(u.next=p.next,p.next=u),h.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Fc(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(q(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Fc(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}jt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Zs(e,n),s=mn(s),r=r(s),e.flags|=1,jt(t,e,r,n),e.child;case 14:return r=e.type,s=xn(r,e.pendingProps),s=xn(r.type,s),Pp(t,e,r,s,n);case 15:return Py(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:xn(r,s),Qa(t,e),e.tag=1,Wt(r)?(t=!0,fl(e)):t=!1,Zs(e,n),Cy(e,r,s),Bc(e,r,s,n),Wc(null,e,r,!0,t,n);case 19:return Vy(t,e,n);case 22:return Dy(t,e,n)}throw Error(q(156,e.tag))};function Xy(t,e){return Tg(t,e)}function _1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(t,e,n,r){return new _1(t,e,n,r)}function yh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function x1(t){if(typeof t=="function")return yh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Md)return 11;if(t===Ld)return 14}return 2}function Dr(t,e){var n=t.alternate;return n===null?(n=dn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Xa(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")yh(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Os:return ss(n.children,s,i,e);case Vd:a=8,s|=8;break;case dc:return t=dn(12,n,e,s|2),t.elementType=dc,t.lanes=i,t;case hc:return t=dn(13,n,e,s),t.elementType=hc,t.lanes=i,t;case fc:return t=dn(19,n,e,s),t.elementType=fc,t.lanes=i,t;case ag:return Kl(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ig:a=10;break e;case og:a=9;break e;case Md:a=11;break e;case Ld:a=14;break e;case yr:a=16,r=null;break e}throw Error(q(130,t==null?t:typeof t,""))}return e=dn(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ss(t,e,n,r){return t=dn(7,t,r,e),t.lanes=n,t}function Kl(t,e,n,r){return t=dn(22,t,r,e),t.elementType=ag,t.lanes=n,t.stateNode={isHidden:!1},t}function Qu(t,e,n){return t=dn(6,t,null,e),t.lanes=n,t}function Ku(t,e,n){return e=dn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function w1(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ru(0),this.expirationTimes=Ru(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ru(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function vh(t,e,n,r,s,i,a,l,u){return t=new w1(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=dn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},th(i),t}function S1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ls,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Jy(t){if(!t)return Lr;t=t._reactInternals;e:{if(ms(t)!==t||t.tag!==1)throw Error(q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Wt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(q(171))}if(t.tag===1){var n=t.type;if(Wt(n))return Jg(t,n,e)}return e}function Zy(t,e,n,r,s,i,a,l,u){return t=vh(n,r,!0,t,s,i,a,l,u),t.context=Jy(null),n=t.current,r=Vt(),s=Pr(n),i=Jn(r,s),i.callback=e??null,kr(n,i,s),t.current.lanes=s,Bo(t,s,r),Ht(t,r),t}function Yl(t,e,n,r){var s=e.current,i=Vt(),a=Pr(s);return n=Jy(n),e.context===null?e.context=n:e.pendingContext=n,e=Jn(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=kr(s,e,a),t!==null&&(Tn(t,s,a,i),Ha(t,s,a)),a}function Al(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Up(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function _h(t,e){Up(t,e),(t=t.alternate)&&Up(t,e)}function E1(){return null}var e0=typeof reportError=="function"?reportError:function(t){console.error(t)};function xh(t){this._internalRoot=t}Xl.prototype.render=xh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(q(409));Yl(t,e,null,null)};Xl.prototype.unmount=xh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;cs(function(){Yl(null,t,null,null)}),e[nr]=null}};function Xl(t){this._internalRoot=t}Xl.prototype.unstable_scheduleHydration=function(t){if(t){var e=Dg();t={blockedOn:null,target:t,priority:e};for(var n=0;n<_r.length&&e!==0&&e<_r[n].priority;n++);_r.splice(n,0,t),n===0&&bg(t)}};function wh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Jl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function $p(){}function T1(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=Al(a);i.call(h)}}var a=Zy(e,r,t,0,null,!1,!1,"",$p);return t._reactRootContainer=a,t[nr]=a.current,wo(t.nodeType===8?t.parentNode:t),cs(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=Al(u);l.call(h)}}var u=vh(t,0,!1,null,null,!1,!1,"",$p);return t._reactRootContainer=u,t[nr]=u.current,wo(t.nodeType===8?t.parentNode:t),cs(function(){Yl(e,u,n,r)}),u}function Zl(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var u=Al(a);l.call(u)}}Yl(e,a,t,s)}else a=T1(n,e,t,s,r);return Al(a)}Rg=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=qi(e.pendingLanes);n!==0&&(zd(e,n|1),Ht(e,Xe()),!(ye&6)&&(li=Xe()+500,$r()))}break;case 13:cs(function(){var r=rr(t,1);if(r!==null){var s=Vt();Tn(r,t,1,s)}}),_h(t,1)}};Bd=function(t){if(t.tag===13){var e=rr(t,134217728);if(e!==null){var n=Vt();Tn(e,t,134217728,n)}_h(t,134217728)}};Pg=function(t){if(t.tag===13){var e=Pr(t),n=rr(t,e);if(n!==null){var r=Vt();Tn(n,t,e,r)}_h(t,e)}};Dg=function(){return Ee};Ng=function(t,e){var n=Ee;try{return Ee=t,e()}finally{Ee=n}};Ec=function(t,e,n){switch(e){case"input":if(gc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=$l(r);if(!s)throw Error(q(90));ug(r),gc(r,s)}}}break;case"textarea":dg(t,n);break;case"select":e=n.value,e!=null&&Ks(t,!!n.multiple,e,!1)}};vg=ph;_g=cs;var I1={usingClientEntryPoint:!1,Events:[$o,Us,$l,gg,yg,ph]},Ui={findFiberByHostInstance:Zr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},A1={bundleType:Ui.bundleType,version:Ui.version,rendererPackageName:Ui.rendererPackageName,rendererConfig:Ui.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Sg(t),t===null?null:t.stateNode},findFiberByHostInstance:Ui.findFiberByHostInstance||E1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Va=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Va.isDisabled&&Va.supportsFiber)try{Fl=Va.inject(A1),Vn=Va}catch{}}rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I1;rn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!wh(e))throw Error(q(200));return S1(t,e,null,n)};rn.createRoot=function(t,e){if(!wh(t))throw Error(q(299));var n=!1,r="",s=e0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=vh(t,1,!1,null,null,n,!1,r,s),t[nr]=e.current,wo(t.nodeType===8?t.parentNode:t),new xh(e)};rn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(q(188)):(t=Object.keys(t).join(","),Error(q(268,t)));return t=Sg(e),t=t===null?null:t.stateNode,t};rn.flushSync=function(t){return cs(t)};rn.hydrate=function(t,e,n){if(!Jl(e))throw Error(q(200));return Zl(null,t,e,!0,n)};rn.hydrateRoot=function(t,e,n){if(!wh(t))throw Error(q(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=e0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=Zy(e,null,t,1,n??null,s,!1,i,a),t[nr]=e.current,wo(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Xl(e)};rn.render=function(t,e,n){if(!Jl(e))throw Error(q(200));return Zl(null,t,e,!1,n)};rn.unmountComponentAtNode=function(t){if(!Jl(t))throw Error(q(40));return t._reactRootContainer?(cs(function(){Zl(null,null,t,!1,function(){t._reactRootContainer=null,t[nr]=null})}),!0):!1};rn.unstable_batchedUpdates=ph;rn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Jl(n))throw Error(q(200));if(t==null||t._reactInternals===void 0)throw Error(q(38));return Zl(t,e,n,!1,r)};rn.version="18.3.1-next-f1338f8080-20240426";function t0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t0)}catch(t){console.error(t)}}t0(),tg.exports=rn;var C1=tg.exports,n0,Wp=C1;n0=Wp.createRoot,Wp.hydrateRoot;var Hp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},k1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},s0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,p=i>>2,g=(i&3)<<4|l>>4;let m=(l&15)<<2|h>>6,w=h&63;u||(w=64,a||(m=64)),r.push(n[p],n[g],n[m],n[w])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(r0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):k1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||h==null||g==null)throw new R1;const m=i<<2|l>>4;if(r.push(m),h!==64){const w=l<<4&240|h>>2;if(r.push(w),g!==64){const C=h<<6&192|g;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class R1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const P1=function(t){const e=r0(t);return s0.encodeByteArray(e,!0)},i0=function(t){return P1(t).replace(/\./g,"")},D1=function(t){try{return s0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b1=()=>N1().__FIREBASE_DEFAULTS__,j1=()=>{if(typeof process>"u"||typeof Hp>"u")return;const t=Hp.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},V1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&D1(t[1]);return e&&JSON.parse(e)},Sh=()=>{try{return b1()||j1()||V1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},M1=t=>{var e,n;return(n=(e=Sh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},L1=t=>{const e=M1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},o0=()=>{var t;return(t=Sh())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function z1(){var t;const e=(t=Sh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function B1(){return!z1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function U1(){try{return typeof indexedDB=="object"}catch{return!1}}function $1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W1="FirebaseError";class _i extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=W1,Object.setPrototypeOf(this,_i.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,a0.prototype.create)}}class a0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?H1(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new _i(s,l,r)}}function H1(t,e){return t.replace(q1,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const q1=/\{\$([^}]+)}/g;function Cl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(qp(i)&&qp(a)){if(!Cl(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function qp(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function An(t){return t&&t._delegate?t._delegate:t}class ui{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new O1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(K1(e))try{this.getOrInitializeService({instanceIdentifier:Jr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Jr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Jr){return this.instances.has(e)}getOptions(e=Jr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Q1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Jr){return this.component?this.component.multipleInstances?e:Jr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Q1(t){return t===Jr?void 0:t}function K1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new G1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ge;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ge||(ge={}));const X1={debug:ge.DEBUG,verbose:ge.VERBOSE,info:ge.INFO,warn:ge.WARN,error:ge.ERROR,silent:ge.SILENT},J1=ge.INFO,Z1={[ge.DEBUG]:"log",[ge.VERBOSE]:"log",[ge.INFO]:"info",[ge.WARN]:"warn",[ge.ERROR]:"error"},ew=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Z1[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class l0{constructor(e){this.name=e,this._logLevel=J1,this._logHandler=ew,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?X1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ge.DEBUG,...e),this._logHandler(this,ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ge.VERBOSE,...e),this._logHandler(this,ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ge.INFO,...e),this._logHandler(this,ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ge.WARN,...e),this._logHandler(this,ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ge.ERROR,...e),this._logHandler(this,ge.ERROR,...e)}}const tw=(t,e)=>e.some(n=>t instanceof n);let Gp,Qp;function nw(){return Gp||(Gp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function rw(){return Qp||(Qp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const u0=new WeakMap,nd=new WeakMap,c0=new WeakMap,Yu=new WeakMap,Eh=new WeakMap;function sw(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Nr(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&u0.set(n,t)}).catch(()=>{}),Eh.set(e,t),e}function iw(t){if(nd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});nd.set(t,e)}let rd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return nd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||c0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Nr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ow(t){rd=t(rd)}function aw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Xu(this),e,...n);return c0.set(r,e.sort?e.sort():[e]),Nr(r)}:rw().includes(t)?function(...e){return t.apply(Xu(this),e),Nr(u0.get(this))}:function(...e){return Nr(t.apply(Xu(this),e))}}function lw(t){return typeof t=="function"?aw(t):(t instanceof IDBTransaction&&iw(t),tw(t,nw())?new Proxy(t,rd):t)}function Nr(t){if(t instanceof IDBRequest)return sw(t);if(Yu.has(t))return Yu.get(t);const e=lw(t);return e!==t&&(Yu.set(t,e),Eh.set(e,t)),e}const Xu=t=>Eh.get(t);function uw(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=Nr(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Nr(a.result),u.oldVersion,u.newVersion,Nr(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const cw=["get","getKey","getAll","getAllKeys","count"],dw=["put","add","delete","clear"],Ju=new Map;function Kp(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ju.get(e))return Ju.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=dw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||cw.includes(n)))return;const i=async function(a,...l){const u=this.transaction(a,s?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),s&&u.done]))[0]};return Ju.set(e,i),i}ow(t=>({...t,get:(e,n,r)=>Kp(e,n)||t.get(e,n,r),has:(e,n)=>!!Kp(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(fw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function fw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sd="@firebase/app",Yp="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir=new l0("@firebase/app"),pw="@firebase/app-compat",mw="@firebase/analytics-compat",gw="@firebase/analytics",yw="@firebase/app-check-compat",vw="@firebase/app-check",_w="@firebase/auth",xw="@firebase/auth-compat",ww="@firebase/database",Sw="@firebase/data-connect",Ew="@firebase/database-compat",Tw="@firebase/functions",Iw="@firebase/functions-compat",Aw="@firebase/installations",Cw="@firebase/installations-compat",kw="@firebase/messaging",Rw="@firebase/messaging-compat",Pw="@firebase/performance",Dw="@firebase/performance-compat",Nw="@firebase/remote-config",bw="@firebase/remote-config-compat",jw="@firebase/storage",Vw="@firebase/storage-compat",Mw="@firebase/firestore",Lw="@firebase/vertexai-preview",Ow="@firebase/firestore-compat",Fw="firebase",zw="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const id="[DEFAULT]",Bw={[sd]:"fire-core",[pw]:"fire-core-compat",[gw]:"fire-analytics",[mw]:"fire-analytics-compat",[vw]:"fire-app-check",[yw]:"fire-app-check-compat",[_w]:"fire-auth",[xw]:"fire-auth-compat",[ww]:"fire-rtdb",[Sw]:"fire-data-connect",[Ew]:"fire-rtdb-compat",[Tw]:"fire-fn",[Iw]:"fire-fn-compat",[Aw]:"fire-iid",[Cw]:"fire-iid-compat",[kw]:"fire-fcm",[Rw]:"fire-fcm-compat",[Pw]:"fire-perf",[Dw]:"fire-perf-compat",[Nw]:"fire-rc",[bw]:"fire-rc-compat",[jw]:"fire-gcs",[Vw]:"fire-gcs-compat",[Mw]:"fire-fst",[Ow]:"fire-fst-compat",[Lw]:"fire-vertex","fire-js":"fire-js",[Fw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kl=new Map,Uw=new Map,od=new Map;function Xp(t,e){try{t.container.addComponent(e)}catch(n){ir.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Po(t){const e=t.name;if(od.has(e))return ir.debug(`There were multiple attempts to register component ${e}.`),!1;od.set(e,t);for(const n of kl.values())Xp(n,t);for(const n of Uw.values())Xp(n,t);return!0}function d0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},br=new a0("app","Firebase",$w);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ui("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw br.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw=zw;function h0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:id,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw br.create("bad-app-name",{appName:String(s)});if(n||(n=o0()),!n)throw br.create("no-options");const i=kl.get(s);if(i){if(Cl(n,i.options)&&Cl(r,i.config))return i;throw br.create("duplicate-app",{appName:s})}const a=new Y1(s);for(const u of od.values())a.addComponent(u);const l=new Ww(n,r,a);return kl.set(s,l),l}function qw(t=id){const e=kl.get(t);if(!e&&t===id&&o0())return h0();if(!e)throw br.create("no-app",{appName:t});return e}function jr(t,e,n){var r;let s=(r=Bw[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ir.warn(l.join(" "));return}Po(new ui(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gw="firebase-heartbeat-database",Qw=1,Do="firebase-heartbeat-store";let Zu=null;function f0(){return Zu||(Zu=uw(Gw,Qw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Do)}catch(n){console.warn(n)}}}}).catch(t=>{throw br.create("idb-open",{originalErrorMessage:t.message})})),Zu}async function Kw(t){try{const n=(await f0()).transaction(Do),r=await n.objectStore(Do).get(p0(t));return await n.done,r}catch(e){if(e instanceof _i)ir.warn(e.message);else{const n=br.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ir.warn(n.message)}}}async function Jp(t,e){try{const r=(await f0()).transaction(Do,"readwrite");await r.objectStore(Do).put(e,p0(t)),await r.done}catch(n){if(n instanceof _i)ir.warn(n.message);else{const r=br.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ir.warn(r.message)}}}function p0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw=1024,Xw=30*24*60*60*1e3;class Jw{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new eS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Zp();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=Xw}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ir.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Zp(),{heartbeatsToSend:r,unsentEntries:s}=Zw(this._heartbeatsCache.heartbeats),i=i0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return ir.warn(n),""}}}function Zp(){return new Date().toISOString().substring(0,10)}function Zw(t,e=Yw){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),em(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),em(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class eS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return U1()?$1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Kw(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Jp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Jp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function em(t){return i0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(t){Po(new ui("platform-logger",e=>new hw(e),"PRIVATE")),Po(new ui("heartbeat",e=>new Jw(e),"PRIVATE")),jr(sd,Yp,t),jr(sd,Yp,"esm2017"),jr("fire-js","")}tS("");var nS="firebase",rS="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jr(nS,rS,"app");var tm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var is,m0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,v){function E(){}E.prototype=v.prototype,S.D=v.prototype,S.prototype=new E,S.prototype.constructor=S,S.C=function(I,_,T){for(var x=Array(arguments.length-2),te=2;te<arguments.length;te++)x[te-2]=arguments[te];return v.prototype[_].apply(I,x)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,v,E){E||(E=0);var I=Array(16);if(typeof v=="string")for(var _=0;16>_;++_)I[_]=v.charCodeAt(E++)|v.charCodeAt(E++)<<8|v.charCodeAt(E++)<<16|v.charCodeAt(E++)<<24;else for(_=0;16>_;++_)I[_]=v[E++]|v[E++]<<8|v[E++]<<16|v[E++]<<24;v=S.g[0],E=S.g[1],_=S.g[2];var T=S.g[3],x=v+(T^E&(_^T))+I[0]+3614090360&4294967295;v=E+(x<<7&4294967295|x>>>25),x=T+(_^v&(E^_))+I[1]+3905402710&4294967295,T=v+(x<<12&4294967295|x>>>20),x=_+(E^T&(v^E))+I[2]+606105819&4294967295,_=T+(x<<17&4294967295|x>>>15),x=E+(v^_&(T^v))+I[3]+3250441966&4294967295,E=_+(x<<22&4294967295|x>>>10),x=v+(T^E&(_^T))+I[4]+4118548399&4294967295,v=E+(x<<7&4294967295|x>>>25),x=T+(_^v&(E^_))+I[5]+1200080426&4294967295,T=v+(x<<12&4294967295|x>>>20),x=_+(E^T&(v^E))+I[6]+2821735955&4294967295,_=T+(x<<17&4294967295|x>>>15),x=E+(v^_&(T^v))+I[7]+4249261313&4294967295,E=_+(x<<22&4294967295|x>>>10),x=v+(T^E&(_^T))+I[8]+1770035416&4294967295,v=E+(x<<7&4294967295|x>>>25),x=T+(_^v&(E^_))+I[9]+2336552879&4294967295,T=v+(x<<12&4294967295|x>>>20),x=_+(E^T&(v^E))+I[10]+4294925233&4294967295,_=T+(x<<17&4294967295|x>>>15),x=E+(v^_&(T^v))+I[11]+2304563134&4294967295,E=_+(x<<22&4294967295|x>>>10),x=v+(T^E&(_^T))+I[12]+1804603682&4294967295,v=E+(x<<7&4294967295|x>>>25),x=T+(_^v&(E^_))+I[13]+4254626195&4294967295,T=v+(x<<12&4294967295|x>>>20),x=_+(E^T&(v^E))+I[14]+2792965006&4294967295,_=T+(x<<17&4294967295|x>>>15),x=E+(v^_&(T^v))+I[15]+1236535329&4294967295,E=_+(x<<22&4294967295|x>>>10),x=v+(_^T&(E^_))+I[1]+4129170786&4294967295,v=E+(x<<5&4294967295|x>>>27),x=T+(E^_&(v^E))+I[6]+3225465664&4294967295,T=v+(x<<9&4294967295|x>>>23),x=_+(v^E&(T^v))+I[11]+643717713&4294967295,_=T+(x<<14&4294967295|x>>>18),x=E+(T^v&(_^T))+I[0]+3921069994&4294967295,E=_+(x<<20&4294967295|x>>>12),x=v+(_^T&(E^_))+I[5]+3593408605&4294967295,v=E+(x<<5&4294967295|x>>>27),x=T+(E^_&(v^E))+I[10]+38016083&4294967295,T=v+(x<<9&4294967295|x>>>23),x=_+(v^E&(T^v))+I[15]+3634488961&4294967295,_=T+(x<<14&4294967295|x>>>18),x=E+(T^v&(_^T))+I[4]+3889429448&4294967295,E=_+(x<<20&4294967295|x>>>12),x=v+(_^T&(E^_))+I[9]+568446438&4294967295,v=E+(x<<5&4294967295|x>>>27),x=T+(E^_&(v^E))+I[14]+3275163606&4294967295,T=v+(x<<9&4294967295|x>>>23),x=_+(v^E&(T^v))+I[3]+4107603335&4294967295,_=T+(x<<14&4294967295|x>>>18),x=E+(T^v&(_^T))+I[8]+1163531501&4294967295,E=_+(x<<20&4294967295|x>>>12),x=v+(_^T&(E^_))+I[13]+2850285829&4294967295,v=E+(x<<5&4294967295|x>>>27),x=T+(E^_&(v^E))+I[2]+4243563512&4294967295,T=v+(x<<9&4294967295|x>>>23),x=_+(v^E&(T^v))+I[7]+1735328473&4294967295,_=T+(x<<14&4294967295|x>>>18),x=E+(T^v&(_^T))+I[12]+2368359562&4294967295,E=_+(x<<20&4294967295|x>>>12),x=v+(E^_^T)+I[5]+4294588738&4294967295,v=E+(x<<4&4294967295|x>>>28),x=T+(v^E^_)+I[8]+2272392833&4294967295,T=v+(x<<11&4294967295|x>>>21),x=_+(T^v^E)+I[11]+1839030562&4294967295,_=T+(x<<16&4294967295|x>>>16),x=E+(_^T^v)+I[14]+4259657740&4294967295,E=_+(x<<23&4294967295|x>>>9),x=v+(E^_^T)+I[1]+2763975236&4294967295,v=E+(x<<4&4294967295|x>>>28),x=T+(v^E^_)+I[4]+1272893353&4294967295,T=v+(x<<11&4294967295|x>>>21),x=_+(T^v^E)+I[7]+4139469664&4294967295,_=T+(x<<16&4294967295|x>>>16),x=E+(_^T^v)+I[10]+3200236656&4294967295,E=_+(x<<23&4294967295|x>>>9),x=v+(E^_^T)+I[13]+681279174&4294967295,v=E+(x<<4&4294967295|x>>>28),x=T+(v^E^_)+I[0]+3936430074&4294967295,T=v+(x<<11&4294967295|x>>>21),x=_+(T^v^E)+I[3]+3572445317&4294967295,_=T+(x<<16&4294967295|x>>>16),x=E+(_^T^v)+I[6]+76029189&4294967295,E=_+(x<<23&4294967295|x>>>9),x=v+(E^_^T)+I[9]+3654602809&4294967295,v=E+(x<<4&4294967295|x>>>28),x=T+(v^E^_)+I[12]+3873151461&4294967295,T=v+(x<<11&4294967295|x>>>21),x=_+(T^v^E)+I[15]+530742520&4294967295,_=T+(x<<16&4294967295|x>>>16),x=E+(_^T^v)+I[2]+3299628645&4294967295,E=_+(x<<23&4294967295|x>>>9),x=v+(_^(E|~T))+I[0]+4096336452&4294967295,v=E+(x<<6&4294967295|x>>>26),x=T+(E^(v|~_))+I[7]+1126891415&4294967295,T=v+(x<<10&4294967295|x>>>22),x=_+(v^(T|~E))+I[14]+2878612391&4294967295,_=T+(x<<15&4294967295|x>>>17),x=E+(T^(_|~v))+I[5]+4237533241&4294967295,E=_+(x<<21&4294967295|x>>>11),x=v+(_^(E|~T))+I[12]+1700485571&4294967295,v=E+(x<<6&4294967295|x>>>26),x=T+(E^(v|~_))+I[3]+2399980690&4294967295,T=v+(x<<10&4294967295|x>>>22),x=_+(v^(T|~E))+I[10]+4293915773&4294967295,_=T+(x<<15&4294967295|x>>>17),x=E+(T^(_|~v))+I[1]+2240044497&4294967295,E=_+(x<<21&4294967295|x>>>11),x=v+(_^(E|~T))+I[8]+1873313359&4294967295,v=E+(x<<6&4294967295|x>>>26),x=T+(E^(v|~_))+I[15]+4264355552&4294967295,T=v+(x<<10&4294967295|x>>>22),x=_+(v^(T|~E))+I[6]+2734768916&4294967295,_=T+(x<<15&4294967295|x>>>17),x=E+(T^(_|~v))+I[13]+1309151649&4294967295,E=_+(x<<21&4294967295|x>>>11),x=v+(_^(E|~T))+I[4]+4149444226&4294967295,v=E+(x<<6&4294967295|x>>>26),x=T+(E^(v|~_))+I[11]+3174756917&4294967295,T=v+(x<<10&4294967295|x>>>22),x=_+(v^(T|~E))+I[2]+718787259&4294967295,_=T+(x<<15&4294967295|x>>>17),x=E+(T^(_|~v))+I[9]+3951481745&4294967295,S.g[0]=S.g[0]+v&4294967295,S.g[1]=S.g[1]+(_+(x<<21&4294967295|x>>>11))&4294967295,S.g[2]=S.g[2]+_&4294967295,S.g[3]=S.g[3]+T&4294967295}r.prototype.u=function(S,v){v===void 0&&(v=S.length);for(var E=v-this.blockSize,I=this.B,_=this.h,T=0;T<v;){if(_==0)for(;T<=E;)s(this,S,T),T+=this.blockSize;if(typeof S=="string"){for(;T<v;)if(I[_++]=S.charCodeAt(T++),_==this.blockSize){s(this,I),_=0;break}}else for(;T<v;)if(I[_++]=S[T++],_==this.blockSize){s(this,I),_=0;break}}this.h=_,this.o+=v},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var v=1;v<S.length-8;++v)S[v]=0;var E=8*this.o;for(v=S.length-8;v<S.length;++v)S[v]=E&255,E/=256;for(this.u(S),S=Array(16),v=E=0;4>v;++v)for(var I=0;32>I;I+=8)S[E++]=this.g[v]>>>I&255;return S};function i(S,v){var E=l;return Object.prototype.hasOwnProperty.call(E,S)?E[S]:E[S]=v(S)}function a(S,v){this.h=v;for(var E=[],I=!0,_=S.length-1;0<=_;_--){var T=S[_]|0;I&&T==v||(E[_]=T,I=!1)}this.g=E}var l={};function u(S){return-128<=S&&128>S?i(S,function(v){return new a([v|0],0>v?-1:0)}):new a([S|0],0>S?-1:0)}function h(S){if(isNaN(S)||!isFinite(S))return g;if(0>S)return M(h(-S));for(var v=[],E=1,I=0;S>=E;I++)v[I]=S/E|0,E*=4294967296;return new a(v,0)}function p(S,v){if(S.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(S.charAt(0)=="-")return M(p(S.substring(1),v));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=h(Math.pow(v,8)),I=g,_=0;_<S.length;_+=8){var T=Math.min(8,S.length-_),x=parseInt(S.substring(_,_+T),v);8>T?(T=h(Math.pow(v,T)),I=I.j(T).add(h(x))):(I=I.j(E),I=I.add(h(x)))}return I}var g=u(0),m=u(1),w=u(16777216);t=a.prototype,t.m=function(){if(P(this))return-M(this).m();for(var S=0,v=1,E=0;E<this.g.length;E++){var I=this.i(E);S+=(0<=I?I:4294967296+I)*v,v*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(C(this))return"0";if(P(this))return"-"+M(this).toString(S);for(var v=h(Math.pow(S,6)),E=this,I="";;){var _=V(E,v).g;E=k(E,_.j(v));var T=((0<E.g.length?E.g[0]:E.h)>>>0).toString(S);if(E=_,C(E))return T+I;for(;6>T.length;)T="0"+T;I=T+I}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function C(S){if(S.h!=0)return!1;for(var v=0;v<S.g.length;v++)if(S.g[v]!=0)return!1;return!0}function P(S){return S.h==-1}t.l=function(S){return S=k(this,S),P(S)?-1:C(S)?0:1};function M(S){for(var v=S.g.length,E=[],I=0;I<v;I++)E[I]=~S.g[I];return new a(E,~S.h).add(m)}t.abs=function(){return P(this)?M(this):this},t.add=function(S){for(var v=Math.max(this.g.length,S.g.length),E=[],I=0,_=0;_<=v;_++){var T=I+(this.i(_)&65535)+(S.i(_)&65535),x=(T>>>16)+(this.i(_)>>>16)+(S.i(_)>>>16);I=x>>>16,T&=65535,x&=65535,E[_]=x<<16|T}return new a(E,E[E.length-1]&-2147483648?-1:0)};function k(S,v){return S.add(M(v))}t.j=function(S){if(C(this)||C(S))return g;if(P(this))return P(S)?M(this).j(M(S)):M(M(this).j(S));if(P(S))return M(this.j(M(S)));if(0>this.l(w)&&0>S.l(w))return h(this.m()*S.m());for(var v=this.g.length+S.g.length,E=[],I=0;I<2*v;I++)E[I]=0;for(I=0;I<this.g.length;I++)for(var _=0;_<S.g.length;_++){var T=this.i(I)>>>16,x=this.i(I)&65535,te=S.i(_)>>>16,re=S.i(_)&65535;E[2*I+2*_]+=x*re,A(E,2*I+2*_),E[2*I+2*_+1]+=T*re,A(E,2*I+2*_+1),E[2*I+2*_+1]+=x*te,A(E,2*I+2*_+1),E[2*I+2*_+2]+=T*te,A(E,2*I+2*_+2)}for(I=0;I<v;I++)E[I]=E[2*I+1]<<16|E[2*I];for(I=v;I<2*v;I++)E[I]=0;return new a(E,0)};function A(S,v){for(;(S[v]&65535)!=S[v];)S[v+1]+=S[v]>>>16,S[v]&=65535,v++}function R(S,v){this.g=S,this.h=v}function V(S,v){if(C(v))throw Error("division by zero");if(C(S))return new R(g,g);if(P(S))return v=V(M(S),v),new R(M(v.g),M(v.h));if(P(v))return v=V(S,M(v)),new R(M(v.g),v.h);if(30<S.g.length){if(P(S)||P(v))throw Error("slowDivide_ only works with positive integers.");for(var E=m,I=v;0>=I.l(S);)E=z(E),I=z(I);var _=B(E,1),T=B(I,1);for(I=B(I,2),E=B(E,2);!C(I);){var x=T.add(I);0>=x.l(S)&&(_=_.add(E),T=x),I=B(I,1),E=B(E,1)}return v=k(S,_.j(v)),new R(_,v)}for(_=g;0<=S.l(v);){for(E=Math.max(1,Math.floor(S.m()/v.m())),I=Math.ceil(Math.log(E)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),T=h(E),x=T.j(v);P(x)||0<x.l(S);)E-=I,T=h(E),x=T.j(v);C(T)&&(T=m),_=_.add(T),S=k(S,x)}return new R(_,S)}t.A=function(S){return V(this,S).h},t.and=function(S){for(var v=Math.max(this.g.length,S.g.length),E=[],I=0;I<v;I++)E[I]=this.i(I)&S.i(I);return new a(E,this.h&S.h)},t.or=function(S){for(var v=Math.max(this.g.length,S.g.length),E=[],I=0;I<v;I++)E[I]=this.i(I)|S.i(I);return new a(E,this.h|S.h)},t.xor=function(S){for(var v=Math.max(this.g.length,S.g.length),E=[],I=0;I<v;I++)E[I]=this.i(I)^S.i(I);return new a(E,this.h^S.h)};function z(S){for(var v=S.g.length+1,E=[],I=0;I<v;I++)E[I]=S.i(I)<<1|S.i(I-1)>>>31;return new a(E,S.h)}function B(S,v){var E=v>>5;v%=32;for(var I=S.g.length-E,_=[],T=0;T<I;T++)_[T]=0<v?S.i(T+E)>>>v|S.i(T+E+1)<<32-v:S.i(T+E);return new a(_,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,m0=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,is=a}).apply(typeof tm<"u"?tm:typeof self<"u"?self:typeof window<"u"?window:{});var Ma=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var g0,Qi,y0,Ja,ad,v0,_0,x0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,f){return o==Array.prototype||o==Object.prototype||(o[c]=f.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ma=="object"&&Ma];for(var c=0;c<o.length;++c){var f=o[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(o,c){if(c)e:{var f=r;o=o.split(".");for(var y=0;y<o.length-1;y++){var D=o[y];if(!(D in f))break e;f=f[D]}o=o[o.length-1],y=f[o],c=c(y),c!=y&&c!=null&&e(f,o,{configurable:!0,writable:!0,value:c})}}function i(o,c){o instanceof String&&(o+="");var f=0,y=!1,D={next:function(){if(!y&&f<o.length){var j=f++;return{value:c(j,o[j]),done:!1}}return y=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}s("Array.prototype.values",function(o){return o||function(){return i(this,function(c,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function h(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function p(o,c,f){return o.call.apply(o.bind,arguments)}function g(o,c,f){if(!o)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,y),o.apply(c,D)}}return function(){return o.apply(c,arguments)}}function m(o,c,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,m.apply(null,arguments)}function w(o,c){var f=Array.prototype.slice.call(arguments,1);return function(){var y=f.slice();return y.push.apply(y,arguments),o.apply(this,y)}}function C(o,c){function f(){}f.prototype=c.prototype,o.aa=c.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(y,D,j){for(var Q=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)Q[Ae-2]=arguments[Ae];return c.prototype[D].apply(y,Q)}}function P(o){const c=o.length;if(0<c){const f=Array(c);for(let y=0;y<c;y++)f[y]=o[y];return f}return[]}function M(o,c){for(let f=1;f<arguments.length;f++){const y=arguments[f];if(u(y)){const D=o.length||0,j=y.length||0;o.length=D+j;for(let Q=0;Q<j;Q++)o[D+Q]=y[Q]}else o.push(y)}}class k{constructor(c,f){this.i=c,this.j=f,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function A(o){return/^[\s\xa0]*$/.test(o)}function R(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function V(o){return V[" "](o),o}V[" "]=function(){};var z=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function B(o,c,f){for(const y in o)c.call(f,o[y],y,o)}function S(o,c){for(const f in o)c.call(void 0,o[f],f,o)}function v(o){const c={};for(const f in o)c[f]=o[f];return c}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(o,c){let f,y;for(let D=1;D<arguments.length;D++){y=arguments[D];for(f in y)o[f]=y[f];for(let j=0;j<E.length;j++)f=E[j],Object.prototype.hasOwnProperty.call(y,f)&&(o[f]=y[f])}}function _(o){var c=1;o=o.split(":");const f=[];for(;0<c&&o.length;)f.push(o.shift()),c--;return o.length&&f.push(o.join(":")),f}function T(o){l.setTimeout(()=>{throw o},0)}function x(){var o=O;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class te{constructor(){this.h=this.g=null}add(c,f){const y=re.get();y.set(c,f),this.h?this.h.next=y:this.g=y,this.h=y}}var re=new k(()=>new Y,o=>o.reset());class Y{constructor(){this.next=this.g=this.h=null}set(c,f){this.h=c,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let U,N=!1,O=new te,L=()=>{const o=l.Promise.resolve(void 0);U=()=>{o.then(W)}};var W=()=>{for(var o;o=x();){try{o.h.call(o.g)}catch(f){T(f)}var c=re;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}N=!1};function X(){this.s=this.s,this.C=this.C}X.prototype.s=!1,X.prototype.ma=function(){this.s||(this.s=!0,this.N())},X.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function oe(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}oe.prototype.h=function(){this.defaultPrevented=!0};var Ce=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};l.addEventListener("test",f,c),l.removeEventListener("test",f,c)}catch{}return o}();function xe(o,c){if(oe.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,y=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(z){e:{try{V(c.nodeName);var D=!0;break e}catch{}D=!1}D||(c=null)}}else f=="mouseover"?c=o.fromElement:f=="mouseout"&&(c=o.toElement);this.relatedTarget=c,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:fe[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&xe.aa.h.call(this)}}C(xe,oe);var fe={2:"touch",3:"pen",4:"mouse"};xe.prototype.h=function(){xe.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),Oe=0;function we(o,c,f,y,D){this.listener=o,this.proxy=null,this.src=c,this.type=f,this.capture=!!y,this.ha=D,this.key=++Oe,this.da=this.fa=!1}function ne(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function ke(o){this.src=o,this.g={},this.h=0}ke.prototype.add=function(o,c,f,y,D){var j=o.toString();o=this.g[j],o||(o=this.g[j]=[],this.h++);var Q=Re(o,c,y,D);return-1<Q?(c=o[Q],f||(c.fa=!1)):(c=new we(c,this.src,j,!!y,D),c.fa=f,o.push(c)),c};function Fe(o,c){var f=c.type;if(f in o.g){var y=o.g[f],D=Array.prototype.indexOf.call(y,c,void 0),j;(j=0<=D)&&Array.prototype.splice.call(y,D,1),j&&(ne(c),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Re(o,c,f,y){for(var D=0;D<o.length;++D){var j=o[D];if(!j.da&&j.listener==c&&j.capture==!!f&&j.ha==y)return D}return-1}var wt="closure_lm_"+(1e6*Math.random()|0),qt={};function Gt(o,c,f,y,D){if(Array.isArray(c)){for(var j=0;j<c.length;j++)Gt(o,c[j],f,y,D);return null}return f=Zo(f),o&&o[de]?o.K(c,f,h(y)?!!y.capture:!1,D):Qt(o,c,f,!1,y,D)}function Qt(o,c,f,y,D,j){if(!c)throw Error("Invalid event type");var Q=h(D)?!!D.capture:!!D,Ae=Pe(o);if(Ae||(o[wt]=Ae=new ke(o)),f=Ae.add(c,f,y,Q,j),f.proxy)return f;if(y=Kt(),f.proxy=y,y.src=o,y.listener=f,o.addEventListener)Ce||(D=Q),D===void 0&&(D=!1),o.addEventListener(c.toString(),y,D);else if(o.attachEvent)o.attachEvent(kn(c.toString()),y);else if(o.addListener&&o.removeListener)o.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Kt(){function o(f){return c.call(o.src,o.listener,f)}const c=dr;return o}function ur(o,c,f,y,D){if(Array.isArray(c))for(var j=0;j<c.length;j++)ur(o,c[j],f,y,D);else y=h(y)?!!y.capture:!!y,f=Zo(f),o&&o[de]?(o=o.i,c=String(c).toString(),c in o.g&&(j=o.g[c],f=Re(j,f,y,D),-1<f&&(ne(j[f]),Array.prototype.splice.call(j,f,1),j.length==0&&(delete o.g[c],o.h--)))):o&&(o=Pe(o))&&(c=o.g[c.toString()],o=-1,c&&(o=Re(c,f,y,D)),(f=-1<o?c[o]:null)&&cr(f))}function cr(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[de])Fe(c.i,o);else{var f=o.type,y=o.proxy;c.removeEventListener?c.removeEventListener(f,y,o.capture):c.detachEvent?c.detachEvent(kn(f),y):c.addListener&&c.removeListener&&c.removeListener(y),(f=Pe(c))?(Fe(f,o),f.h==0&&(f.src=null,c[wt]=null)):ne(o)}}}function kn(o){return o in qt?qt[o]:qt[o]="on"+o}function dr(o,c){if(o.da)o=!0;else{c=new xe(c,this);var f=o.listener,y=o.ha||o.src;o.fa&&cr(o),o=f.call(y,c)}return o}function Pe(o){return o=o[wt],o instanceof ke?o:null}var Ti="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zo(o){return typeof o=="function"?o:(o[Ti]||(o[Ti]=function(c){return o.handleEvent(c)}),o[Ti])}function lt(){X.call(this),this.i=new ke(this),this.M=this,this.F=null}C(lt,X),lt.prototype[de]=!0,lt.prototype.removeEventListener=function(o,c,f,y){ur(this,o,c,f,y)};function Ke(o,c){var f,y=o.F;if(y)for(f=[];y;y=y.F)f.push(y);if(o=o.M,y=c.type||c,typeof c=="string")c=new oe(c,o);else if(c instanceof oe)c.target=c.target||o;else{var D=c;c=new oe(y,o),I(c,D)}if(D=!0,f)for(var j=f.length-1;0<=j;j--){var Q=c.g=f[j];D=Hr(Q,y,!0,c)&&D}if(Q=c.g=o,D=Hr(Q,y,!0,c)&&D,D=Hr(Q,y,!1,c)&&D,f)for(j=0;j<f.length;j++)Q=c.g=f[j],D=Hr(Q,y,!1,c)&&D}lt.prototype.N=function(){if(lt.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var f=o.g[c],y=0;y<f.length;y++)ne(f[y]);delete o.g[c],o.h--}}this.F=null},lt.prototype.K=function(o,c,f,y){return this.i.add(String(o),c,!1,f,y)},lt.prototype.L=function(o,c,f,y){return this.i.add(String(o),c,!0,f,y)};function Hr(o,c,f,y){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var D=!0,j=0;j<c.length;++j){var Q=c[j];if(Q&&!Q.da&&Q.capture==f){var Ae=Q.listener,ft=Q.ha||Q.src;Q.fa&&Fe(o.i,Q),D=Ae.call(ft,y)!==!1&&D}}return D&&!y.defaultPrevented}function _s(o,c,f){if(typeof o=="function")f&&(o=m(o,f));else if(o&&typeof o.handleEvent=="function")o=m(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(o,c||0)}function ea(o){o.g=_s(()=>{o.g=null,o.i&&(o.i=!1,ea(o))},o.l);const c=o.h;o.h=null,o.m.apply(null,c)}class Se extends X{constructor(c,f){super(),this.m=c,this.l=f,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:ea(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Rn(o){X.call(this),this.h=o,this.g={}}C(Rn,X);var qr=[];function xs(o){B(o.g,function(c,f){this.g.hasOwnProperty(f)&&cr(c)},o),o.g={}}Rn.prototype.N=function(){Rn.aa.N.call(this),xs(this)},Rn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ta=l.JSON.stringify,na=l.JSON.parse,af=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function ws(){}ws.prototype.h=null;function Pn(o){return o.h||(o.h=o.i())}function Ss(){}var on={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Es(){oe.call(this,"d")}C(Es,oe);function ra(){oe.call(this,"c")}C(ra,oe);var Bn={},gu=null;function Ii(){return gu=gu||new lt}Bn.La="serverreachability";function Ts(o){oe.call(this,Bn.La,o)}C(Ts,oe);function yn(o){const c=Ii();Ke(c,new Ts(c))}Bn.STAT_EVENT="statevent";function Is(o,c){oe.call(this,Bn.STAT_EVENT,o),this.stat=c}C(Is,oe);function ut(o){const c=Ii();Ke(c,new Is(c,o))}Bn.Ma="timingevent";function hr(o,c){oe.call(this,Bn.Ma,o),this.size=c}C(hr,oe);function an(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},c)}function Gr(){this.g=!0}Gr.prototype.xa=function(){this.g=!1};function sa(o,c,f,y,D,j){o.info(function(){if(o.g)if(j)for(var Q="",Ae=j.split("&"),ft=0;ft<Ae.length;ft++){var ve=Ae[ft].split("=");if(1<ve.length){var Et=ve[0];ve=ve[1];var Tt=Et.split("_");Q=2<=Tt.length&&Tt[1]=="type"?Q+(Et+"="+ve+"&"):Q+(Et+"=redacted&")}}else Q=null;else Q=j;return"XMLHTTP REQ ("+y+") [attempt "+D+"]: "+c+`
`+f+`
`+Q})}function ia(o,c,f,y,D,j,Q){o.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+D+"]: "+c+`
`+f+`
`+j+" "+Q})}function Un(o,c,f,y){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+vu(o,f)+(y?" "+y:"")})}function yu(o,c){o.info(function(){return"TIMEOUT: "+c})}Gr.prototype.info=function(){};function vu(o,c){if(!o.g)return c;if(!c)return null;try{var f=JSON.parse(c);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var y=f[o];if(!(2>y.length)){var D=y[1];if(Array.isArray(D)&&!(1>D.length)){var j=D[0];if(j!="noop"&&j!="stop"&&j!="close")for(var Q=1;Q<D.length;Q++)D[Q]=""}}}}return ta(f)}catch{return c}}var fr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},As={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Dn;function $n(){}C($n,ws),$n.prototype.g=function(){return new XMLHttpRequest},$n.prototype.i=function(){return{}},Dn=new $n;function St(o,c,f,y){this.j=o,this.i=c,this.l=f,this.R=y||1,this.U=new Rn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new oa}function oa(){this.i=null,this.g="",this.h=!1}var K={},G={};function H(o,c,f){o.L=1,o.v=ca(Wn(c)),o.m=f,o.P=!0,se(o,null)}function se(o,c){o.F=Date.now(),ze(o),o.A=Wn(o.v);var f=o.A,y=o.R;Array.isArray(y)||(y=[String(y)]),pf(f.i,"t",y),o.C=0,f=o.j.J,o.h=new oa,o.g=Nf(o.j,f?c:null,!o.m),0<o.O&&(o.M=new Se(m(o.Y,o,o.g),o.O)),c=o.U,f=o.g,y=o.ca;var D="readystatechange";Array.isArray(D)||(D&&(qr[0]=D.toString()),D=qr);for(var j=0;j<D.length;j++){var Q=Gt(f,D[j],y||c.handleEvent,!1,c.h||c);if(!Q)break;c.g[Q.key]=Q}c=o.H?v(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),yn(),sa(o.i,o.u,o.A,o.l,o.R,o.m)}St.prototype.ca=function(o){o=o.target;const c=this.M;c&&Hn(o)==3?c.j():this.Y(o)},St.prototype.Y=function(o){try{if(o==this.g)e:{const Tt=Hn(this.g);var c=this.g.Ba();const Ds=this.g.Z();if(!(3>Tt)&&(Tt!=3||this.g&&(this.h.h||this.g.oa()||wf(this.g)))){this.J||Tt!=4||c==7||(c==8||0>=Ds?yn(3):yn(2)),Je(this);var f=this.g.Z();this.X=f;t:if(Ie(this)){var y=wf(this.g);o="";var D=y.length,j=Hn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){st(this),Ze(this);var Q="";break t}this.h.i=new l.TextDecoder}for(c=0;c<D;c++)this.h.h=!0,o+=this.h.i.decode(y[c],{stream:!(j&&c==D-1)});y.length=0,this.h.g+=o,this.C=0,Q=this.h.g}else Q=this.g.oa();if(this.o=f==200,ia(this.i,this.u,this.A,this.l,this.R,Tt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ae,ft=this.g;if((Ae=ft.g?ft.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(Ae)){var ve=Ae;break t}}ve=null}if(f=ve)Un(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ai(this,f);else{this.o=!1,this.s=3,ut(12),st(this),Ze(this);break e}}if(this.P){f=!0;let vn;for(;!this.J&&this.C<Q.length;)if(vn=qe(this,Q),vn==G){Tt==4&&(this.s=4,ut(14),f=!1),Un(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==K){this.s=4,ut(15),Un(this.i,this.l,Q,"[Invalid Chunk]"),f=!1;break}else Un(this.i,this.l,vn,null),Ai(this,vn);if(Ie(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Tt!=4||Q.length!=0||this.h.h||(this.s=1,ut(16),f=!1),this.o=this.o&&f,!f)Un(this.i,this.l,Q,"[Invalid Chunked Response]"),st(this),Ze(this);else if(0<Q.length&&!this.W){this.W=!0;var Et=this.j;Et.g==this&&Et.ba&&!Et.M&&(Et.j.info("Great, no buffering proxy detected. Bytes received: "+Q.length),Su(Et),Et.M=!0,ut(11))}}else Un(this.i,this.l,Q,null),Ai(this,Q);Tt==4&&st(this),this.o&&!this.J&&(Tt==4?kf(this.j,this):(this.o=!1,ze(this)))}else e_(this.g),f==400&&0<Q.indexOf("Unknown SID")?(this.s=3,ut(12)):(this.s=0,ut(13)),st(this),Ze(this)}}}catch{}finally{}};function Ie(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function qe(o,c){var f=o.C,y=c.indexOf(`
`,f);return y==-1?G:(f=Number(c.substring(f,y)),isNaN(f)?K:(y+=1,y+f>c.length?G:(c=c.slice(y,y+f),o.C=y+f,c)))}St.prototype.cancel=function(){this.J=!0,st(this)};function ze(o){o.S=Date.now()+o.I,Nt(o,o.I)}function Nt(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=an(m(o.ba,o),c)}function Je(o){o.B&&(l.clearTimeout(o.B),o.B=null)}St.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(yu(this.i,this.A),this.L!=2&&(yn(),ut(17)),st(this),this.s=2,Ze(this)):Nt(this,this.S-o)};function Ze(o){o.j.G==0||o.J||kf(o.j,o)}function st(o){Je(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,xs(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function Ai(o,c){try{var f=o.j;if(f.G!=0&&(f.g==o||Be(f.h,o))){if(!o.K&&Be(f.h,o)&&f.G==3){try{var y=f.Da.g.parse(c)}catch{y=null}if(Array.isArray(y)&&y.length==3){var D=y;if(D[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)ga(f),pa(f);else break e;wu(f),ut(18)}}else f.za=D[1],0<f.za-f.T&&37500>D[2]&&f.F&&f.v==0&&!f.C&&(f.C=an(m(f.Za,f),6e3));if(1>=ae(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Kr(f,11)}else if((o.K||f.g==o)&&ga(f),!A(c))for(D=f.Da.g.parse(c),c=0;c<D.length;c++){let ve=D[c];if(f.T=ve[0],ve=ve[1],f.G==2)if(ve[0]=="c"){f.K=ve[1],f.ia=ve[2];const Et=ve[3];Et!=null&&(f.la=Et,f.j.info("VER="+f.la));const Tt=ve[4];Tt!=null&&(f.Aa=Tt,f.j.info("SVER="+f.Aa));const Ds=ve[5];Ds!=null&&typeof Ds=="number"&&0<Ds&&(y=1.5*Ds,f.L=y,f.j.info("backChannelRequestTimeoutMs_="+y)),y=f;const vn=o.g;if(vn){const va=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(va){var j=y.h;j.g||va.indexOf("spdy")==-1&&va.indexOf("quic")==-1&&va.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(bt(j,j.h),j.h=null))}if(y.D){const Eu=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;Eu&&(y.ya=Eu,Ne(y.I,y.D,Eu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),y=f;var Q=o;if(y.qa=Df(y,y.J?y.ia:null,y.W),Q.K){ks(y.h,Q);var Ae=Q,ft=y.L;ft&&(Ae.I=ft),Ae.B&&(Je(Ae),ze(Ae)),y.g=Q}else Af(y);0<f.i.length&&ma(f)}else ve[0]!="stop"&&ve[0]!="close"||Kr(f,7);else f.G==3&&(ve[0]=="stop"||ve[0]=="close"?ve[0]=="stop"?Kr(f,7):xu(f):ve[0]!="noop"&&f.l&&f.l.ta(ve),f.v=0)}}yn(4)}catch{}}var Ci=class{constructor(o,c){this.g=o,this.map=c}};function Yt(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Cs(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function ae(o){return o.h?1:o.g?o.g.size:0}function Be(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function bt(o,c){o.g?o.g.add(c):o.h=c}function ks(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Yt.prototype.cancel=function(){if(this.i=aa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function aa(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(const f of o.g.values())c=c.concat(f.D);return c}return P(o.i)}function Fv(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var c=[],f=o.length,y=0;y<f;y++)c.push(o[y]);return c}c=[],f=0;for(y in o)c[f++]=o[y];return c}function zv(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var c=[];o=o.length;for(var f=0;f<o;f++)c.push(f);return c}c=[],f=0;for(const y in o)c[f++]=y;return c}}}function lf(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var f=zv(o),y=Fv(o),D=y.length,j=0;j<D;j++)c.call(void 0,y[j],f&&f[j],o)}var uf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Bv(o,c){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var y=o[f].indexOf("="),D=null;if(0<=y){var j=o[f].substring(0,y);D=o[f].substring(y+1)}else j=o[f];c(j,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function Qr(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Qr){this.h=o.h,la(this,o.j),this.o=o.o,this.g=o.g,ua(this,o.s),this.l=o.l;var c=o.i,f=new Pi;f.i=c.i,c.g&&(f.g=new Map(c.g),f.h=c.h),cf(this,f),this.m=o.m}else o&&(c=String(o).match(uf))?(this.h=!1,la(this,c[1]||"",!0),this.o=ki(c[2]||""),this.g=ki(c[3]||"",!0),ua(this,c[4]),this.l=ki(c[5]||"",!0),cf(this,c[6]||"",!0),this.m=ki(c[7]||"")):(this.h=!1,this.i=new Pi(null,this.h))}Qr.prototype.toString=function(){var o=[],c=this.j;c&&o.push(Ri(c,df,!0),":");var f=this.g;return(f||c=="file")&&(o.push("//"),(c=this.o)&&o.push(Ri(c,df,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(Ri(f,f.charAt(0)=="/"?Wv:$v,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",Ri(f,qv)),o.join("")};function Wn(o){return new Qr(o)}function la(o,c,f){o.j=f?ki(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function ua(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function cf(o,c,f){c instanceof Pi?(o.i=c,Gv(o.i,o.h)):(f||(c=Ri(c,Hv)),o.i=new Pi(c,o.h))}function Ne(o,c,f){o.i.set(c,f)}function ca(o){return Ne(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function ki(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Ri(o,c,f){return typeof o=="string"?(o=encodeURI(o).replace(c,Uv),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Uv(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var df=/[#\/\?@]/g,$v=/[#\?:]/g,Wv=/[#\?]/g,Hv=/[#\?@]/g,qv=/#/g;function Pi(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function pr(o){o.g||(o.g=new Map,o.h=0,o.i&&Bv(o.i,function(c,f){o.add(decodeURIComponent(c.replace(/\+/g," ")),f)}))}t=Pi.prototype,t.add=function(o,c){pr(this),this.i=null,o=Rs(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(c),this.h+=1,this};function hf(o,c){pr(o),c=Rs(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function ff(o,c){return pr(o),c=Rs(o,c),o.g.has(c)}t.forEach=function(o,c){pr(this),this.g.forEach(function(f,y){f.forEach(function(D){o.call(c,D,y,this)},this)},this)},t.na=function(){pr(this);const o=Array.from(this.g.values()),c=Array.from(this.g.keys()),f=[];for(let y=0;y<c.length;y++){const D=o[y];for(let j=0;j<D.length;j++)f.push(c[y])}return f},t.V=function(o){pr(this);let c=[];if(typeof o=="string")ff(this,o)&&(c=c.concat(this.g.get(Rs(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)c=c.concat(o[f])}return c},t.set=function(o,c){return pr(this),this.i=null,o=Rs(this,o),ff(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},t.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function pf(o,c,f){hf(o,c),0<f.length&&(o.i=null,o.g.set(Rs(o,c),P(f)),o.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],c=Array.from(this.g.keys());for(var f=0;f<c.length;f++){var y=c[f];const j=encodeURIComponent(String(y)),Q=this.V(y);for(y=0;y<Q.length;y++){var D=j;Q[y]!==""&&(D+="="+encodeURIComponent(String(Q[y]))),o.push(D)}}return this.i=o.join("&")};function Rs(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function Gv(o,c){c&&!o.j&&(pr(o),o.i=null,o.g.forEach(function(f,y){var D=y.toLowerCase();y!=D&&(hf(this,y),pf(this,D,f))},o)),o.j=c}function Qv(o,c){const f=new Gr;if(l.Image){const y=new Image;y.onload=w(mr,f,"TestLoadImage: loaded",!0,c,y),y.onerror=w(mr,f,"TestLoadImage: error",!1,c,y),y.onabort=w(mr,f,"TestLoadImage: abort",!1,c,y),y.ontimeout=w(mr,f,"TestLoadImage: timeout",!1,c,y),l.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=o}else c(!1)}function Kv(o,c){const f=new Gr,y=new AbortController,D=setTimeout(()=>{y.abort(),mr(f,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:y.signal}).then(j=>{clearTimeout(D),j.ok?mr(f,"TestPingServer: ok",!0,c):mr(f,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(D),mr(f,"TestPingServer: error",!1,c)})}function mr(o,c,f,y,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),y(f)}catch{}}function Yv(){this.g=new af}function Xv(o,c,f){const y=f||"";try{lf(o,function(D,j){let Q=D;h(D)&&(Q=ta(D)),c.push(y+j+"="+encodeURIComponent(Q))})}catch(D){throw c.push(y+"type="+encodeURIComponent("_badmap")),D}}function da(o){this.l=o.Ub||null,this.j=o.eb||!1}C(da,ws),da.prototype.g=function(){return new ha(this.l,this.j)},da.prototype.i=function(o){return function(){return o}}({});function ha(o,c){lt.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(ha,lt),t=ha.prototype,t.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,Ni(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Di(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Ni(this)),this.g&&(this.readyState=3,Ni(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;mf(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function mf(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Di(this):Ni(this),this.readyState==3&&mf(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,Di(this))},t.Qa=function(o){this.g&&(this.response=o,Di(this))},t.ga=function(){this.g&&Di(this)};function Di(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Ni(o)}t.setRequestHeader=function(o,c){this.u.append(o,c)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],c=this.h.entries();for(var f=c.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=c.next();return o.join(`\r
`)};function Ni(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(ha.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function gf(o){let c="";return B(o,function(f,y){c+=y,c+=":",c+=f,c+=`\r
`}),c}function _u(o,c,f){e:{for(y in f){var y=!1;break e}y=!0}y||(f=gf(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):Ne(o,c,f))}function Ge(o){lt.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(Ge,lt);var Jv=/^https?$/i,Zv=["POST","PUT"];t=Ge.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,c,f,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Dn.g(),this.v=this.o?Pn(this.o):Pn(Dn),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(j){yf(this,j);return}if(o=f||"",f=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var D in y)f.set(D,y[D]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const j of y.keys())f.set(j,y.get(j));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(f.keys()).find(j=>j.toLowerCase()=="content-type"),D=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Zv,c,void 0))||y||D||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,Q]of f)this.g.setRequestHeader(j,Q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{xf(this),this.u=!0,this.g.send(o),this.u=!1}catch(j){yf(this,j)}};function yf(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,vf(o),fa(o)}function vf(o){o.A||(o.A=!0,Ke(o,"complete"),Ke(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Ke(this,"complete"),Ke(this,"abort"),fa(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fa(this,!0)),Ge.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?_f(this):this.bb())},t.bb=function(){_f(this)};function _f(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Hn(o)!=4||o.Z()!=2)){if(o.u&&Hn(o)==4)_s(o.Ea,0,o);else if(Ke(o,"readystatechange"),Hn(o)==4){o.h=!1;try{const Q=o.Z();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var f;if(!(f=c)){var y;if(y=Q===0){var D=String(o.D).match(uf)[1]||null;!D&&l.self&&l.self.location&&(D=l.self.location.protocol.slice(0,-1)),y=!Jv.test(D?D.toLowerCase():"")}f=y}if(f)Ke(o,"complete"),Ke(o,"success");else{o.m=6;try{var j=2<Hn(o)?o.g.statusText:""}catch{j=""}o.l=j+" ["+o.Z()+"]",vf(o)}}finally{fa(o)}}}}function fa(o,c){if(o.g){xf(o);const f=o.g,y=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||Ke(o,"ready");try{f.onreadystatechange=y}catch{}}}function xf(o){o.I&&(l.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function Hn(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<Hn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),na(c)}};function wf(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function e_(o){const c={};o=(o.g&&2<=Hn(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<o.length;y++){if(A(o[y]))continue;var f=_(o[y]);const D=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const j=c[D]||[];c[D]=j,j.push(f)}S(c,function(y){return y.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function bi(o,c,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||c}function Sf(o){this.Aa=0,this.i=[],this.j=new Gr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=bi("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=bi("baseRetryDelayMs",5e3,o),this.cb=bi("retryDelaySeedMs",1e4,o),this.Wa=bi("forwardChannelMaxRetries",2,o),this.wa=bi("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Yt(o&&o.concurrentRequestLimit),this.Da=new Yv,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Sf.prototype,t.la=8,t.G=1,t.connect=function(o,c,f,y){ut(0),this.W=o,this.H=c||{},f&&y!==void 0&&(this.H.OSID=f,this.H.OAID=y),this.F=this.X,this.I=Df(this,null,this.W),ma(this)};function xu(o){if(Ef(o),o.G==3){var c=o.U++,f=Wn(o.I);if(Ne(f,"SID",o.K),Ne(f,"RID",c),Ne(f,"TYPE","terminate"),ji(o,f),c=new St(o,o.j,c),c.L=2,c.v=ca(Wn(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=c.v,f=!0),f||(c.g=Nf(c.j,null),c.g.ea(c.v)),c.F=Date.now(),ze(c)}Pf(o)}function pa(o){o.g&&(Su(o),o.g.cancel(),o.g=null)}function Ef(o){pa(o),o.u&&(l.clearTimeout(o.u),o.u=null),ga(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function ma(o){if(!Cs(o.h)&&!o.s){o.s=!0;var c=o.Ga;U||L(),N||(U(),N=!0),O.add(c,o),o.B=0}}function t_(o,c){return ae(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=an(m(o.Ga,o,c),Rf(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const D=new St(this,this.j,o);let j=this.o;if(this.S&&(j?(j=v(j),I(j,this.S)):j=this.S),this.m!==null||this.O||(D.H=j,j=null),this.P)e:{for(var c=0,f=0;f<this.i.length;f++){t:{var y=this.i[f];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(c+=y,4096<c){c=f;break e}if(c===4096||f===this.i.length-1){c=f+1;break e}}c=1e3}else c=1e3;c=If(this,D,c),f=Wn(this.I),Ne(f,"RID",o),Ne(f,"CVER",22),this.D&&Ne(f,"X-HTTP-Session-Id",this.D),ji(this,f),j&&(this.O?c="headers="+encodeURIComponent(String(gf(j)))+"&"+c:this.m&&_u(f,this.m,j)),bt(this.h,D),this.Ua&&Ne(f,"TYPE","init"),this.P?(Ne(f,"$req",c),Ne(f,"SID","null"),D.T=!0,H(D,f,null)):H(D,f,c),this.G=2}}else this.G==3&&(o?Tf(this,o):this.i.length==0||Cs(this.h)||Tf(this))};function Tf(o,c){var f;c?f=c.l:f=o.U++;const y=Wn(o.I);Ne(y,"SID",o.K),Ne(y,"RID",f),Ne(y,"AID",o.T),ji(o,y),o.m&&o.o&&_u(y,o.m,o.o),f=new St(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),c&&(o.i=c.D.concat(o.i)),c=If(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),bt(o.h,f),H(f,y,c)}function ji(o,c){o.H&&B(o.H,function(f,y){Ne(c,y,f)}),o.l&&lf({},function(f,y){Ne(c,y,f)})}function If(o,c,f){f=Math.min(o.i.length,f);var y=o.l?m(o.l.Na,o.l,o):null;e:{var D=o.i;let j=-1;for(;;){const Q=["count="+f];j==-1?0<f?(j=D[0].g,Q.push("ofs="+j)):j=0:Q.push("ofs="+j);let Ae=!0;for(let ft=0;ft<f;ft++){let ve=D[ft].g;const Et=D[ft].map;if(ve-=j,0>ve)j=Math.max(0,D[ft].g-100),Ae=!1;else try{Xv(Et,Q,"req"+ve+"_")}catch{y&&y(Et)}}if(Ae){y=Q.join("&");break e}}}return o=o.i.splice(0,f),c.D=o,y}function Af(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;U||L(),N||(U(),N=!0),O.add(c,o),o.v=0}}function wu(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=an(m(o.Fa,o),Rf(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,Cf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=an(m(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ut(10),pa(this),Cf(this))};function Su(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function Cf(o){o.g=new St(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=Wn(o.qa);Ne(c,"RID","rpc"),Ne(c,"SID",o.K),Ne(c,"AID",o.T),Ne(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&Ne(c,"TO",o.ja),Ne(c,"TYPE","xmlhttp"),ji(o,c),o.m&&o.o&&_u(c,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=ca(Wn(c)),f.m=null,f.P=!0,se(f,o)}t.Za=function(){this.C!=null&&(this.C=null,pa(this),wu(this),ut(19))};function ga(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function kf(o,c){var f=null;if(o.g==c){ga(o),Su(o),o.g=null;var y=2}else if(Be(o.h,c))f=c.D,ks(o.h,c),y=1;else return;if(o.G!=0){if(c.o)if(y==1){f=c.m?c.m.length:0,c=Date.now()-c.F;var D=o.B;y=Ii(),Ke(y,new hr(y,f)),ma(o)}else Af(o);else if(D=c.s,D==3||D==0&&0<c.X||!(y==1&&t_(o,c)||y==2&&wu(o)))switch(f&&0<f.length&&(c=o.h,c.i=c.i.concat(f)),D){case 1:Kr(o,5);break;case 4:Kr(o,10);break;case 3:Kr(o,6);break;default:Kr(o,2)}}}function Rf(o,c){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*c}function Kr(o,c){if(o.j.info("Error code "+c),c==2){var f=m(o.fb,o),y=o.Xa;const D=!y;y=new Qr(y||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||la(y,"https"),ca(y),D?Qv(y.toString(),f):Kv(y.toString(),f)}else ut(2);o.G=0,o.l&&o.l.sa(c),Pf(o),Ef(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))};function Pf(o){if(o.G=0,o.ka=[],o.l){const c=aa(o.h);(c.length!=0||o.i.length!=0)&&(M(o.ka,c),M(o.ka,o.i),o.h.i.length=0,P(o.i),o.i.length=0),o.l.ra()}}function Df(o,c,f){var y=f instanceof Qr?Wn(f):new Qr(f);if(y.g!="")c&&(y.g=c+"."+y.g),ua(y,y.s);else{var D=l.location;y=D.protocol,c=c?c+"."+D.hostname:D.hostname,D=+D.port;var j=new Qr(null);y&&la(j,y),c&&(j.g=c),D&&ua(j,D),f&&(j.l=f),y=j}return f=o.D,c=o.ya,f&&c&&Ne(y,f,c),Ne(y,"VER",o.la),ji(o,y),y}function Nf(o,c,f){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new Ge(new da({eb:f})):new Ge(o.pa),c.Ha(o.J),c}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function bf(){}t=bf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ya(){}ya.prototype.g=function(o,c){return new Xt(o,c)};function Xt(o,c){lt.call(this),this.g=new Sf(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!A(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!A(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new Ps(this)}C(Xt,lt),Xt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Xt.prototype.close=function(){xu(this.g)},Xt.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=ta(o),o=f);c.i.push(new Ci(c.Ya++,o)),c.G==3&&ma(c)},Xt.prototype.N=function(){this.g.l=null,delete this.j,xu(this.g),delete this.g,Xt.aa.N.call(this)};function jf(o){Es.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(const f in c){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}C(jf,Es);function Vf(){ra.call(this),this.status=1}C(Vf,ra);function Ps(o){this.g=o}C(Ps,bf),Ps.prototype.ua=function(){Ke(this.g,"a")},Ps.prototype.ta=function(o){Ke(this.g,new jf(o))},Ps.prototype.sa=function(o){Ke(this.g,new Vf)},Ps.prototype.ra=function(){Ke(this.g,"b")},ya.prototype.createWebChannel=ya.prototype.g,Xt.prototype.send=Xt.prototype.o,Xt.prototype.open=Xt.prototype.m,Xt.prototype.close=Xt.prototype.close,x0=function(){return new ya},_0=function(){return Ii()},v0=Bn,ad={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},fr.NO_ERROR=0,fr.TIMEOUT=8,fr.HTTP_ERROR=6,Ja=fr,As.COMPLETE="complete",y0=As,Ss.EventType=on,on.OPEN="a",on.CLOSE="b",on.ERROR="c",on.MESSAGE="d",lt.prototype.listen=lt.prototype.K,Qi=Ss,Ge.prototype.listenOnce=Ge.prototype.L,Ge.prototype.getLastError=Ge.prototype.Ka,Ge.prototype.getLastErrorCode=Ge.prototype.Ba,Ge.prototype.getStatus=Ge.prototype.Z,Ge.prototype.getResponseJson=Ge.prototype.Oa,Ge.prototype.getResponseText=Ge.prototype.oa,Ge.prototype.send=Ge.prototype.ea,Ge.prototype.setWithCredentials=Ge.prototype.Ha,g0=Ge}).apply(typeof Ma<"u"?Ma:typeof self<"u"?self:typeof window<"u"?window:{});const nm="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ft.UNAUTHENTICATED=new Ft(null),Ft.GOOGLE_CREDENTIALS=new Ft("google-credentials-uid"),Ft.FIRST_PARTY=new Ft("first-party-uid"),Ft.MOCK_USER=new Ft("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xi="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ds=new l0("@firebase/firestore");function $i(){return ds.logLevel}function ee(t,...e){if(ds.logLevel<=ge.DEBUG){const n=e.map(Th);ds.debug(`Firestore (${xi}): ${t}`,...n)}}function or(t,...e){if(ds.logLevel<=ge.ERROR){const n=e.map(Th);ds.error(`Firestore (${xi}): ${t}`,...n)}}function No(t,...e){if(ds.logLevel<=ge.WARN){const n=e.map(Th);ds.warn(`Firestore (${xi}): ${t}`,...n)}}function Th(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function le(t="Unexpected state"){const e=`FIRESTORE (${xi}) INTERNAL ASSERTION FAILED: `+t;throw or(e),new Error(e)}function Te(t,e){t||le()}function ce(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class J extends _i{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ft.UNAUTHENTICATED))}shutdown(){}}class oS{constructor(e){this.t=e,this.currentUser=Ft.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Te(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Zn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Zn,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Zn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Te(typeof r.accessToken=="string"),new sS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Te(e===null||typeof e=="string"),new Ft(e)}}class aS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ft.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class lS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new aS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ft.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class uS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Te(this.o===void 0);const r=i=>{i.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,ee("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Te(typeof n.token=="string"),this.R=n.token,new uS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=dS(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function _e(t,e){return t<e?-1:t>e?1:0}function ci(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new J(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new J(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new J(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new J(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return at.fromMillis(Date.now())}static fromDate(e){return at.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new at(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?_e(this.nanoseconds,e.nanoseconds):_e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ue(e)}static min(){return new ue(new at(0,0))}static max(){return new ue(new at(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e,n,r){n===void 0?n=0:n>e.length&&le(),r===void 0?r=e.length-n:r>e.length-n&&le(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return bo.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof bo?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ve extends bo{construct(e,n,r){return new Ve(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new J(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ve(n)}static emptyPath(){return new Ve([])}}const hS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gt extends bo{construct(e,n,r){return new gt(e,n,r)}static isValidIdentifier(e){return hS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new gt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new J(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new J(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new J(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new J(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gt(n)}static emptyPath(){return new gt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.path=e}static fromPath(e){return new ie(Ve.fromString(e))}static fromName(e){return new ie(Ve.fromString(e).popFirst(5))}static empty(){return new ie(Ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ve.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ve.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new Ve(e.slice()))}}function fS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ue.fromTimestamp(r===1e9?new at(n+1,0):new at(n,r));return new Or(s,ie.empty(),e)}function pS(t){return new Or(t.readTime,t.key,-1)}class Or{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Or(ue.min(),ie.empty(),-1)}static max(){return new Or(ue.max(),ie.empty(),-1)}}function mS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ie.comparator(t.documentKey,e.documentKey),n!==0?n:_e(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ho(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==gS)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new $((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof $?n:$.resolve(n)}catch(n){return $.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):$.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):$.reject(n)}static resolve(e){return new $((n,r)=>{n(e)})}static reject(e){return new $((n,r)=>{r(e)})}static waitFor(e){return new $((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(e){let n=$.resolve(!1);for(const r of e)n=n.next(s=>s?$.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new $((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let u=0;u<i;u++){const h=u;n(e[h]).next(p=>{a[h]=p,++l,l===i&&r(a)},p=>s(p))}})}static doWhile(e,n){return new $((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function vS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function qo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Ih.oe=-1;function eu(t){return t==null}function Rl(t){return t===0&&1/t==-1/0}function _S(t){return typeof t=="number"&&Number.isInteger(t)&&!Rl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rm(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function gs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function S0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e,n){this.comparator=e,this.root=n||mt.EMPTY}insert(e,n){return new He(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,mt.BLACK,null,null))}remove(e){return new He(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new La(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new La(this.root,e,this.comparator,!1)}getReverseIterator(){return new La(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new La(this.root,e,this.comparator,!0)}}class La{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??mt.RED,this.left=s??mt.EMPTY,this.right=i??mt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new mt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return mt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return mt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw le();const e=this.left.check();if(e!==this.right.check())throw le();return e+(this.isRed()?0:1)}}mt.EMPTY=null,mt.RED=!0,mt.BLACK=!1;mt.EMPTY=new class{constructor(){this.size=0}get key(){throw le()}get value(){throw le()}get color(){throw le()}get left(){throw le()}get right(){throw le()}copy(e,n,r,s,i){return this}insert(e,n,r){return new mt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.comparator=e,this.data=new He(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new sm(this.data.getIterator())}getIteratorFrom(e){return new sm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof vt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new vt(this.comparator);return n.data=e,n}}class sm{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.fields=e,e.sort(gt.comparator)}static empty(){return new en([])}unionWith(e){let n=new vt(gt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new en(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ci(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new E0("Invalid base64 string: "+i):i}}(e);return new xt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new xt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return _e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}xt.EMPTY_BYTE_STRING=new xt("");const xS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fr(t){if(Te(!!t),typeof t=="string"){let e=0;const n=xS.exec(t);if(Te(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ye(t.seconds),nanos:Ye(t.nanos)}}function Ye(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function hs(t){return typeof t=="string"?xt.fromBase64String(t):xt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ah(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Ch(t){const e=t.mapValue.fields.__previous_value__;return Ah(e)?Ch(e):e}function jo(t){const e=Fr(t.mapValue.fields.__local_write_time__.timestampValue);return new at(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e,n,r,s,i,a,l,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}}class Vo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Vo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Vo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oa={mapValue:{}};function fs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ah(t)?4:ES(t)?9007199254740991:SS(t)?10:11:le()}function Fn(t,e){if(t===e)return!0;const n=fs(t);if(n!==fs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return jo(t).isEqual(jo(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Fr(s.timestampValue),l=Fr(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return hs(s.bytesValue).isEqual(hs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ye(s.geoPointValue.latitude)===Ye(i.geoPointValue.latitude)&&Ye(s.geoPointValue.longitude)===Ye(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ye(s.integerValue)===Ye(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Ye(s.doubleValue),l=Ye(i.doubleValue);return a===l?Rl(a)===Rl(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return ci(t.arrayValue.values||[],e.arrayValue.values||[],Fn);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(rm(a)!==rm(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!Fn(a[u],l[u])))return!1;return!0}(t,e);default:return le()}}function Mo(t,e){return(t.values||[]).find(n=>Fn(n,e))!==void 0}function di(t,e){if(t===e)return 0;const n=fs(t),r=fs(e);if(n!==r)return _e(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return _e(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=Ye(i.integerValue||i.doubleValue),u=Ye(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return im(t.timestampValue,e.timestampValue);case 4:return im(jo(t),jo(e));case 5:return _e(t.stringValue,e.stringValue);case 6:return function(i,a){const l=hs(i),u=hs(a);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),u=a.split("/");for(let h=0;h<l.length&&h<u.length;h++){const p=_e(l[h],u[h]);if(p!==0)return p}return _e(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=_e(Ye(i.latitude),Ye(a.latitude));return l!==0?l:_e(Ye(i.longitude),Ye(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return om(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,u,h,p;const g=i.fields||{},m=a.fields||{},w=(l=g.value)===null||l===void 0?void 0:l.arrayValue,C=(u=m.value)===null||u===void 0?void 0:u.arrayValue,P=_e(((h=w==null?void 0:w.values)===null||h===void 0?void 0:h.length)||0,((p=C==null?void 0:C.values)===null||p===void 0?void 0:p.length)||0);return P!==0?P:om(w,C)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Oa.mapValue&&a===Oa.mapValue)return 0;if(i===Oa.mapValue)return 1;if(a===Oa.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),h=a.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let g=0;g<u.length&&g<p.length;++g){const m=_e(u[g],p[g]);if(m!==0)return m;const w=di(l[u[g]],h[p[g]]);if(w!==0)return w}return _e(u.length,p.length)}(t.mapValue,e.mapValue);default:throw le()}}function im(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return _e(t,e);const n=Fr(t),r=Fr(e),s=_e(n.seconds,r.seconds);return s!==0?s:_e(n.nanos,r.nanos)}function om(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=di(n[s],r[s]);if(i)return i}return _e(n.length,r.length)}function hi(t){return ld(t)}function ld(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Fr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return hs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ie.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=ld(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${ld(n.fields[a])}`;return s+"}"}(t.mapValue):le()}function am(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ud(t){return!!t&&"integerValue"in t}function kh(t){return!!t&&"arrayValue"in t}function lm(t){return!!t&&"nullValue"in t}function um(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Za(t){return!!t&&"mapValue"in t}function SS(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function lo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return gs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=lo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=lo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function ES(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.value=e}static empty(){return new Bt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Za(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=lo(n)}setAll(e){let n=gt.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=lo(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Za(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Fn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Za(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){gs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Bt(lo(this.value))}}function T0(t){const e=[];return gs(t.fields,(n,r)=>{const s=new gt([n]);if(Za(r)){const i=T0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new en(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Pt(e,0,ue.min(),ue.min(),ue.min(),Bt.empty(),0)}static newFoundDocument(e,n,r,s){return new Pt(e,1,n,ue.min(),r,s,0)}static newNoDocument(e,n){return new Pt(e,2,n,ue.min(),ue.min(),Bt.empty(),0)}static newUnknownDocument(e,n){return new Pt(e,3,n,ue.min(),ue.min(),Bt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Pt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e,n){this.position=e,this.inclusive=n}}function cm(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=ie.comparator(ie.fromName(a.referenceValue),n.key):r=di(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function dm(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Fn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,n="asc"){this.field=e,this.dir=n}}function TS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{}class rt extends I0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new AS(e,n,r):n==="array-contains"?new RS(e,r):n==="in"?new PS(e,r):n==="not-in"?new DS(e,r):n==="array-contains-any"?new NS(e,r):new rt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new CS(e,r):new kS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(di(n,this.value)):n!==null&&fs(this.value)===fs(n)&&this.matchesComparison(di(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Cn extends I0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Cn(e,n)}matches(e){return A0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function A0(t){return t.op==="and"}function C0(t){return IS(t)&&A0(t)}function IS(t){for(const e of t.filters)if(e instanceof Cn)return!1;return!0}function cd(t){if(t instanceof rt)return t.field.canonicalString()+t.op.toString()+hi(t.value);if(C0(t))return t.filters.map(e=>cd(e)).join(",");{const e=t.filters.map(n=>cd(n)).join(",");return`${t.op}(${e})`}}function k0(t,e){return t instanceof rt?function(r,s){return s instanceof rt&&r.op===s.op&&r.field.isEqual(s.field)&&Fn(r.value,s.value)}(t,e):t instanceof Cn?function(r,s){return s instanceof Cn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&k0(a,s.filters[l]),!0):!1}(t,e):void le()}function R0(t){return t instanceof rt?function(n){return`${n.field.canonicalString()} ${n.op} ${hi(n.value)}`}(t):t instanceof Cn?function(n){return n.op.toString()+" {"+n.getFilters().map(R0).join(" ,")+"}"}(t):"Filter"}class AS extends rt{constructor(e,n,r){super(e,n,r),this.key=ie.fromName(r.referenceValue)}matches(e){const n=ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class CS extends rt{constructor(e,n){super(e,"in",n),this.keys=P0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class kS extends rt{constructor(e,n){super(e,"not-in",n),this.keys=P0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function P0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ie.fromName(r.referenceValue))}class RS extends rt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return kh(n)&&Mo(n.arrayValue,this.value)}}class PS extends rt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Mo(this.value.arrayValue,n)}}class DS extends rt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Mo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Mo(this.value.arrayValue,n)}}class NS extends rt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!kh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Mo(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function hm(t,e=null,n=[],r=[],s=null,i=null,a=null){return new bS(t,e,n,r,s,i,a)}function Rh(t){const e=ce(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>cd(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),eu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>hi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>hi(r)).join(",")),e.ue=n}return e.ue}function Ph(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!TS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!k0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!dm(t.startAt,e.startAt)&&dm(t.endAt,e.endAt)}function dd(t){return ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function jS(t,e,n,r,s,i,a,l){return new Go(t,e,n,r,s,i,a,l)}function Dh(t){return new Go(t)}function fm(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function D0(t){return t.collectionGroup!==null}function uo(t){const e=ce(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new vt(gt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Dl(i,r))}),n.has(gt.keyField().canonicalString())||e.ce.push(new Dl(gt.keyField(),r))}return e.ce}function Ln(t){const e=ce(t);return e.le||(e.le=VS(e,uo(t))),e.le}function VS(t,e){if(t.limitType==="F")return hm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Dl(s.field,i)});const n=t.endAt?new Pl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Pl(t.startAt.position,t.startAt.inclusive):null;return hm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function hd(t,e){const n=t.filters.concat([e]);return new Go(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function fd(t,e,n){return new Go(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function tu(t,e){return Ph(Ln(t),Ln(e))&&t.limitType===e.limitType}function N0(t){return`${Rh(Ln(t))}|lt:${t.limitType}`}function bs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>R0(s)).join(", ")}]`),eu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>hi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>hi(s)).join(",")),`Target(${r})`}(Ln(t))}; limitType=${t.limitType})`}function nu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ie.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of uo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,u){const h=cm(a,l,u);return a.inclusive?h<=0:h<0}(r.startAt,uo(r),s)||r.endAt&&!function(a,l,u){const h=cm(a,l,u);return a.inclusive?h>=0:h>0}(r.endAt,uo(r),s))}(t,e)}function MS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function b0(t){return(e,n)=>{let r=!1;for(const s of uo(t)){const i=LS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function LS(t,e,n){const r=t.field.isKeyField()?ie.comparator(e.key,n.key):function(i,a,l){const u=a.data.field(i),h=l.data.field(i);return u!==null&&h!==null?di(u,h):le()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){gs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return S0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=new He(ie.comparator);function ar(){return OS}const j0=new He(ie.comparator);function Ki(...t){let e=j0;for(const n of t)e=e.insert(n.key,n);return e}function V0(t){let e=j0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ns(){return co()}function M0(){return co()}function co(){return new wi(t=>t.toString(),(t,e)=>t.isEqual(e))}const FS=new He(ie.comparator),zS=new vt(ie.comparator);function pe(...t){let e=zS;for(const n of t)e=e.add(n);return e}const BS=new vt(_e);function US(){return BS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rl(e)?"-0":e}}function L0(t){return{integerValue:""+t}}function $S(t,e){return _S(e)?L0(e):Nh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(){this._=void 0}}function WS(t,e,n){return t instanceof Lo?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Ah(i)&&(i=Ch(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof Oo?F0(t,e):t instanceof Fo?z0(t,e):function(s,i){const a=O0(s,i),l=pm(a)+pm(s.Pe);return ud(a)&&ud(s.Pe)?L0(l):Nh(s.serializer,l)}(t,e)}function HS(t,e,n){return t instanceof Oo?F0(t,e):t instanceof Fo?z0(t,e):n}function O0(t,e){return t instanceof Nl?function(r){return ud(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Lo extends ru{}class Oo extends ru{constructor(e){super(),this.elements=e}}function F0(t,e){const n=B0(e);for(const r of t.elements)n.some(s=>Fn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Fo extends ru{constructor(e){super(),this.elements=e}}function z0(t,e){let n=B0(e);for(const r of t.elements)n=n.filter(s=>!Fn(s,r));return{arrayValue:{values:n}}}class Nl extends ru{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function pm(t){return Ye(t.integerValue||t.doubleValue)}function B0(t){return kh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(e,n){this.field=e,this.transform=n}}function GS(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Oo&&s instanceof Oo||r instanceof Fo&&s instanceof Fo?ci(r.elements,s.elements,Fn):r instanceof Nl&&s instanceof Nl?Fn(r.Pe,s.Pe):r instanceof Lo&&s instanceof Lo}(t.transform,e.transform)}class QS{constructor(e,n){this.version=e,this.transformResults=n}}class pn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new pn}static exists(e){return new pn(void 0,e)}static updateTime(e){return new pn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function el(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class su{}function U0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new bh(t.key,pn.none()):new Qo(t.key,t.data,pn.none());{const n=t.data,r=Bt.empty();let s=new vt(gt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Wr(t.key,r,new en(s.toArray()),pn.none())}}function KS(t,e,n){t instanceof Qo?function(s,i,a){const l=s.value.clone(),u=gm(s.fieldTransforms,i,a.transformResults);l.setAll(u),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Wr?function(s,i,a){if(!el(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=gm(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll($0(s)),u.setAll(l),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function ho(t,e,n,r){return t instanceof Qo?function(i,a,l,u){if(!el(i.precondition,a))return l;const h=i.value.clone(),p=ym(i.fieldTransforms,u,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof Wr?function(i,a,l,u){if(!el(i.precondition,a))return l;const h=ym(i.fieldTransforms,u,a),p=a.data;return p.setAll($0(i)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,a,l){return el(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function YS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=O0(r.transform,s||null);i!=null&&(n===null&&(n=Bt.empty()),n.set(r.field,i))}return n||null}function mm(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ci(r,s,(i,a)=>GS(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Qo extends su{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Wr extends su{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function $0(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function gm(t,e,n){const r=new Map;Te(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,HS(a,l,n[s]))}return r}function ym(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,WS(i,a,e))}return r}class bh extends su{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class XS extends su{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&KS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ho(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ho(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=M0();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const u=U0(a,l);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(ue.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),pe())}isEqual(e){return this.batchId===e.batchId&&ci(this.mutations,e.mutations,(n,r)=>mm(n,r))&&ci(this.baseMutations,e.baseMutations,(n,r)=>mm(n,r))}}class jh{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Te(e.mutations.length===r.length);let s=function(){return FS}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new jh(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et,me;function tE(t){switch(t){default:return le();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function W0(t){if(t===void 0)return or("GRPC error has no .code"),F.UNKNOWN;switch(t){case et.OK:return F.OK;case et.CANCELLED:return F.CANCELLED;case et.UNKNOWN:return F.UNKNOWN;case et.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case et.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case et.INTERNAL:return F.INTERNAL;case et.UNAVAILABLE:return F.UNAVAILABLE;case et.UNAUTHENTICATED:return F.UNAUTHENTICATED;case et.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case et.NOT_FOUND:return F.NOT_FOUND;case et.ALREADY_EXISTS:return F.ALREADY_EXISTS;case et.PERMISSION_DENIED:return F.PERMISSION_DENIED;case et.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case et.ABORTED:return F.ABORTED;case et.OUT_OF_RANGE:return F.OUT_OF_RANGE;case et.UNIMPLEMENTED:return F.UNIMPLEMENTED;case et.DATA_LOSS:return F.DATA_LOSS;default:return le()}}(me=et||(et={}))[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rE=new is([4294967295,4294967295],0);function vm(t){const e=nE().encode(t),n=new m0;return n.update(e),new Uint8Array(n.digest())}function _m(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new is([n,r],0),new is([s,i],0)]}class Vh{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Yi(`Invalid padding: ${n}`);if(r<0)throw new Yi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Yi(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Yi(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=is.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(is.fromNumber(r)));return s.compare(rE)===1&&(s=new is([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=vm(e),[r,s]=_m(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Vh(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=vm(e),[r,s]=_m(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Yi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ko.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new iu(ue.min(),s,new He(_e),ar(),pe())}}class Ko{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ko(r,n,pe(),pe(),pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class H0{constructor(e,n){this.targetId=e,this.me=n}}class q0{constructor(e,n,r=xt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class xm{constructor(){this.fe=0,this.ge=Sm(),this.pe=xt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=pe(),n=pe(),r=pe();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:le()}}),new Ko(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Sm()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class sE{constructor(e){this.Le=e,this.Be=new Map,this.ke=ar(),this.qe=wm(),this.Qe=new He(_e)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:le()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(dd(i))if(r===0){const a=new ie(i.path);this.Ue(n,a,Pt.newNoDocument(a,ue.min()))}else Te(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),u=l?this.Xe(l,e,a):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=hs(r).toUint8Array()}catch(u){if(u instanceof E0)return No("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Vh(a,s,i)}catch(u){return No(u instanceof Yi?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&dd(l.target)){const u=new ie(l.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,Pt.newNoDocument(u,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=pe();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new iu(e,n,this.Qe,this.ke,r);return this.ke=ar(),this.qe=wm(),this.Qe=new He(_e),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new xm,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new vt(_e),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new xm),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function wm(){return new He(ie.comparator)}function Sm(){return new He(ie.comparator)}const iE={asc:"ASCENDING",desc:"DESCENDING"},oE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},aE={and:"AND",or:"OR"};class lE{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function pd(t,e){return t.useProto3Json||eu(e)?e:{value:e}}function bl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function G0(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function uE(t,e){return bl(t,e.toTimestamp())}function On(t){return Te(!!t),ue.fromTimestamp(function(n){const r=Fr(n);return new at(r.seconds,r.nanos)}(t))}function Mh(t,e){return md(t,e).canonicalString()}function md(t,e){const n=function(s){return new Ve(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Q0(t){const e=Ve.fromString(t);return Te(Z0(e)),e}function gd(t,e){return Mh(t.databaseId,e.path)}function ec(t,e){const n=Q0(e);if(n.get(1)!==t.databaseId.projectId)throw new J(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new J(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ie(Y0(n))}function K0(t,e){return Mh(t.databaseId,e)}function cE(t){const e=Q0(t);return e.length===4?Ve.emptyPath():Y0(e)}function yd(t){return new Ve(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Y0(t){return Te(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Em(t,e,n){return{name:gd(t,e),fields:n.value.mapValue.fields}}function dE(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:le()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,p){return h.useProto3Json?(Te(p===void 0||typeof p=="string"),xt.fromBase64String(p||"")):(Te(p===void 0||p instanceof Buffer||p instanceof Uint8Array),xt.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){const p=h.code===void 0?F.UNKNOWN:W0(h.code);return new J(p,h.message||"")}(a);n=new q0(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ec(t,r.document.name),i=On(r.document.updateTime),a=r.document.createTime?On(r.document.createTime):ue.min(),l=new Bt({mapValue:{fields:r.document.fields}}),u=Pt.newFoundDocument(s,i,a,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new tl(h,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ec(t,r.document),i=r.readTime?On(r.readTime):ue.min(),a=Pt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new tl([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ec(t,r.document),i=r.removedTargetIds||[];n=new tl([],i,s,null)}else{if(!("filter"in e))return le();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new eE(s,i),l=r.targetId;n=new H0(l,a)}}return n}function hE(t,e){let n;if(e instanceof Qo)n={update:Em(t,e.key,e.value)};else if(e instanceof bh)n={delete:gd(t,e.key)};else if(e instanceof Wr)n={update:Em(t,e.key,e.data),updateMask:wE(e.fieldMask)};else{if(!(e instanceof XS))return le();n={verify:gd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof Lo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Oo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Fo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Nl)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw le()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:uE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:le()}(t,e.precondition)),n}function fE(t,e){return t&&t.length>0?(Te(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?On(s.updateTime):On(i);return a.isEqual(ue.min())&&(a=On(i)),new QS(a,s.transformResults||[])}(n,e))):[]}function pE(t,e){return{documents:[K0(t,e.path)]}}function mE(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=K0(t,s);const i=function(h){if(h.length!==0)return J0(Cn.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(h){if(h.length!==0)return h.map(p=>function(m){return{field:js(m.field),direction:vE(m.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=pd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function gE(t){let e=cE(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Te(r===1);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(g){const m=X0(g);return m instanceof Cn&&C0(m)?m.getFilters():[m]}(n.where));let a=[];n.orderBy&&(a=function(g){return g.map(m=>function(C){return new Dl(Vs(C.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(g){let m;return m=typeof g=="object"?g.value:g,eu(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(g){const m=!!g.before,w=g.values||[];return new Pl(w,m)}(n.startAt));let h=null;return n.endAt&&(h=function(g){const m=!g.before,w=g.values||[];return new Pl(w,m)}(n.endAt)),jS(e,s,a,i,l,"F",u,h)}function yE(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return le()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function X0(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Vs(n.unaryFilter.field);return rt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Vs(n.unaryFilter.field);return rt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Vs(n.unaryFilter.field);return rt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Vs(n.unaryFilter.field);return rt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return le()}}(t):t.fieldFilter!==void 0?function(n){return rt.create(Vs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return le()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Cn.create(n.compositeFilter.filters.map(r=>X0(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return le()}}(n.compositeFilter.op))}(t):le()}function vE(t){return iE[t]}function _E(t){return oE[t]}function xE(t){return aE[t]}function js(t){return{fieldPath:t.canonicalString()}}function Vs(t){return gt.fromServerFormat(t.fieldPath)}function J0(t){return t instanceof rt?function(n){if(n.op==="=="){if(um(n.value))return{unaryFilter:{field:js(n.field),op:"IS_NAN"}};if(lm(n.value))return{unaryFilter:{field:js(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(um(n.value))return{unaryFilter:{field:js(n.field),op:"IS_NOT_NAN"}};if(lm(n.value))return{unaryFilter:{field:js(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:js(n.field),op:_E(n.op),value:n.value}}}(t):t instanceof Cn?function(n){const r=n.getFilters().map(s=>J0(s));return r.length===1?r[0]:{compositeFilter:{op:xE(n.op),filters:r}}}(t):le()}function wE(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Z0(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,n,r,s,i=ue.min(),a=ue.min(),l=xt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Er(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e){this.ct=e}}function EE(t){const e=gE({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?fd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(){this.un=new IE}addToCollectionParentIndex(e,n){return this.un.add(n),$.resolve()}getCollectionParents(e,n){return $.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return $.resolve()}deleteFieldIndex(e,n){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,n){return $.resolve()}getDocumentsMatchingTarget(e,n){return $.resolve(null)}getIndexType(e,n){return $.resolve(0)}getFieldIndexes(e,n){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,n){return $.resolve(Or.min())}getMinOffsetFromCollectionGroup(e,n){return $.resolve(Or.min())}updateCollectionGroup(e,n,r){return $.resolve()}updateIndexEntries(e,n){return $.resolve()}}class IE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new vt(Ve.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new vt(Ve.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new fi(0)}static kn(){return new fi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(){this.changes=new wi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Pt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?$.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CE{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ho(r.mutation,s,en.empty(),at.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=pe()){const s=ns();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=Ki();return i.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=ns();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,pe()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=ar();const a=co(),l=function(){return co()}();return n.forEach((u,h)=>{const p=r.get(h.key);s.has(h.key)&&(p===void 0||p.mutation instanceof Wr)?i=i.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),ho(p.mutation,h,p.mutation.getFieldMask(),at.now())):a.set(h.key,en.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,p)=>a.set(h,p)),n.forEach((h,p)=>{var g;return l.set(h,new CE(p,(g=a.get(h))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=co();let s=new He((a,l)=>a-l),i=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let p=r.get(u)||en.empty();p=l.applyToLocalView(h,p),r.set(u,p);const g=(s.get(l.batchId)||pe()).add(u);s=s.insert(l.batchId,g)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,p=u.value,g=M0();p.forEach(m=>{if(!i.has(m)){const w=U0(n.get(m),r.get(m));w!==null&&g.set(m,w),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return $.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return ie.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):D0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):$.resolve(ns());let l=-1,u=i;return a.next(h=>$.forEach(h,(p,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),i.get(p)?$.resolve():this.remoteDocumentCache.getEntry(e,p).next(m=>{u=u.insert(p,m)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,pe())).next(p=>({batchId:l,changes:V0(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ie(n)).next(r=>{let s=Ki();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=Ki();return this.indexManager.getCollectionParents(e,i).next(l=>$.forEach(l,u=>{const h=function(g,m){return new Go(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(p=>{p.forEach((g,m)=>{a=a.insert(g,m)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((u,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,Pt.newInvalidDocument(p)))});let l=Ki();return a.forEach((u,h)=>{const p=i.get(u);p!==void 0&&ho(p.mutation,h,en.empty(),at.now()),nu(n,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return $.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:On(s.createTime)}}(n)),$.resolve()}getNamedQuery(e,n){return $.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:EE(s.bundledQuery),readTime:On(s.readTime)}}(n)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(){this.overlays=new He(ie.comparator),this.Ir=new Map}getOverlay(e,n){return $.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ns();return $.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),$.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),$.resolve()}getOverlaysForCollection(e,n,r){const s=ns(),i=n.length+1,a=new ie(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return $.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new He((h,p)=>h-p);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=i.get(h.largestBatchId);p===null&&(p=ns(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=ns(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=s)););return $.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new ZS(n,r));let i=this.Ir.get(n);i===void 0&&(i=pe(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(){this.sessionToken=xt.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(){this.Tr=new vt(ct.Er),this.dr=new vt(ct.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new ct(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new ct(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ie(new Ve([])),r=new ct(n,e),s=new ct(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ie(new Ve([])),r=new ct(n,e),s=new ct(n,e+1);let i=pe();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new ct(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ct{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ie.comparator(e.key,n.key)||_e(e.wr,n.wr)}static Ar(e,n){return _e(e.wr,n.wr)||ie.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new vt(ct.Er)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new JS(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new ct(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return $.resolve(a)}lookupMutationBatch(e,n){return $.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ct(n,0),s=new ct(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new vt(_e);return n.forEach(s=>{const i=new ct(s,0),a=new ct(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),$.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ie.isDocumentKey(i)||(i=i.child(""));const a=new ct(new ie(i),0);let l=new vt(_e);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(l=l.add(u.wr)),!0)},a),$.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Te(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return $.forEach(n.mutations,s=>{const i=new ct(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new ct(n,0),s=this.br.firstAfterOrEqual(r);return $.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(e){this.Mr=e,this.docs=function(){return new He(ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return $.resolve(r?r.document.mutableCopy():Pt.newInvalidDocument(n))}getEntries(e,n){let r=ar();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Pt.newInvalidDocument(s))}),$.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=ar();const a=n.path,l=new ie(a.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||mS(pS(p),r)<=0||(s.has(p.key)||nu(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,n,r,s){le()}Or(e,n){return $.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new jE(this)}getSize(e){return $.resolve(this.size)}}class jE extends AE{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),$.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e){this.persistence=e,this.Nr=new wi(n=>Rh(n),Ph),this.lastRemoteSnapshotVersion=ue.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Lh,this.targetCount=0,this.kr=fi.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),$.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new fi(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,$.resolve()}updateTargetData(e,n){return this.Kn(n),$.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),$.waitFor(i).next(()=>s)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return $.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),$.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),$.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return $.resolve(r)}containsKey(e,n){return $.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Ih(0),this.Kr=!1,this.Kr=!0,this.$r=new DE,this.referenceDelegate=e(this),this.Ur=new VE(this),this.indexManager=new TE,this.remoteDocumentCache=function(s){return new bE(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new SE(n),this.Gr=new RE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new PE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new NE(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const s=new LE(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return $.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class LE extends yS{constructor(e){super(),this.currentSequenceNumber=e}}class Oh{constructor(e){this.persistence=e,this.Jr=new Lh,this.Yr=null}static Zr(e){return new Oh(e)}get Xr(){if(this.Yr)return this.Yr;throw le()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),$.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),$.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.Xr,r=>{const s=ie.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ue.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return $.or([()=>$.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=pe(),s=pe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Fh(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return B1()?8:vS(F1())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new OE;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?($i()<=ge.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",bs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),$.resolve()):($i()<=ge.DEBUG&&ee("QueryEngine","Query:",bs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?($i()<=ge.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",bs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ln(n))):$.resolve())}Yi(e,n){if(fm(n))return $.resolve(null);let r=Ln(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=fd(n,null,"F"),r=Ln(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=pe(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,l);return this.ns(n,h,a,u.readTime)?this.Yi(e,fd(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,s){return fm(n)||s.isEqual(ue.min())?$.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?$.resolve(null):($i()<=ge.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),bs(n)),this.rs(e,a,n,fS(s,-1)).next(l=>l))})}ts(e,n){let r=new vt(b0(e));return n.forEach((s,i)=>{nu(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return $i()<=ge.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",bs(n)),this.Ji.getDocumentsMatchingQuery(e,n,Or.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new He(_e),this._s=new wi(i=>Rh(i),Ph),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new kE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function BE(t,e,n,r){return new zE(t,e,n,r)}async function ev(t,e){const n=ce(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let u=pe();for(const h of s){a.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of i){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:a,addedBatchIds:l}))})})}function UE(t,e){const n=ce(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,h,p){const g=h.batch,m=g.keys();let w=$.resolve();return m.forEach(C=>{w=w.next(()=>p.getEntry(u,C)).next(P=>{const M=h.docVersions.get(C);Te(M!==null),P.version.compareTo(M)<0&&(g.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),p.addEntry(P)))})}),w.next(()=>l.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=pe();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function tv(t){const e=ce(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function $E(t,e){const n=ce(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((p,g)=>{const m=s.get(g);if(!m)return;l.push(n.Ur.removeMatchingKeys(i,p.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(i,p.addedDocuments,g)));let w=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?w=w.withResumeToken(xt.EMPTY_BYTE_STRING,ue.min()).withLastLimboFreeSnapshotVersion(ue.min()):p.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(p.resumeToken,r)),s=s.insert(g,w),function(P,M,k){return P.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(m,w,p)&&l.push(n.Ur.updateTargetData(i,w))});let u=ar(),h=pe();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),l.push(WE(i,a,e.documentUpdates).next(p=>{u=p.Ps,h=p.Is})),!r.isEqual(ue.min())){const p=n.Ur.getLastRemoteSnapshotVersion(i).next(g=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(p)}return $.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(n.os=s,i))}function WE(t,e,n){let r=pe(),s=pe();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=ar();return n.forEach((l,u)=>{const h=i.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(ue.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):ee("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ps:a,Is:s}})}function HE(t,e){const n=ce(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function qE(t,e){const n=ce(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,$.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new Er(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function vd(t,e,n){const r=ce(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!qo(a))throw a;ee("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Tm(t,e,n){const r=ce(t);let s=ue.min(),i=pe();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,p){const g=ce(u),m=g._s.get(p);return m!==void 0?$.resolve(g.os.get(m)):g.Ur.getTargetData(h,p)}(r,a,Ln(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:ue.min(),n?i:pe())).next(l=>(GE(r,MS(e),l),{documents:l,Ts:i})))}function GE(t,e,n){let r=t.us.get(e)||ue.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Im{constructor(){this.activeTargetIds=US()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class QE{constructor(){this.so=new Im,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Im,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ee("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ee("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fa=null;function tc(){return Fa===null?Fa=function(){return 268435456+Math.round(2147483648*Math.random())}():Fa++,"0x"+Fa.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ct="WebChannelConnection";class JE extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=tc(),u=this.xo(n,r.toUriEncodedString());ee("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,a),this.No(n,u,h,s).then(p=>(ee("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw No("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",u,"request:",s),p})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+xi}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=YE[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=tc();return new Promise((a,l)=>{const u=new g0;u.setWithCredentials(!0),u.listenOnce(y0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Ja.NO_ERROR:const p=u.getResponseJson();ee(Ct,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(p)),a(p);break;case Ja.TIMEOUT:ee(Ct,`RPC '${e}' ${i} timed out`),l(new J(F.DEADLINE_EXCEEDED,"Request time out"));break;case Ja.HTTP_ERROR:const g=u.getStatus();if(ee(Ct,`RPC '${e}' ${i} failed with status:`,g,"response text:",u.getResponseText()),g>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const w=m==null?void 0:m.error;if(w&&w.status&&w.message){const C=function(M){const k=M.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(k)>=0?k:F.UNKNOWN}(w.status);l(new J(C,w.message))}else l(new J(F.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new J(F.UNAVAILABLE,"Connection failed."));break;default:le()}}finally{ee(Ct,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);ee(Ct,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=tc(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=x0(),l=_0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const p=i.join("");ee(Ct,`Creating RPC '${e}' stream ${s}: ${p}`,u);const g=a.createWebChannel(p,u);let m=!1,w=!1;const C=new XE({Io:M=>{w?ee(Ct,`Not sending because RPC '${e}' stream ${s} is closed:`,M):(m||(ee(Ct,`Opening RPC '${e}' stream ${s} transport.`),g.open(),m=!0),ee(Ct,`RPC '${e}' stream ${s} sending:`,M),g.send(M))},To:()=>g.close()}),P=(M,k,A)=>{M.listen(k,R=>{try{A(R)}catch(V){setTimeout(()=>{throw V},0)}})};return P(g,Qi.EventType.OPEN,()=>{w||(ee(Ct,`RPC '${e}' stream ${s} transport opened.`),C.yo())}),P(g,Qi.EventType.CLOSE,()=>{w||(w=!0,ee(Ct,`RPC '${e}' stream ${s} transport closed`),C.So())}),P(g,Qi.EventType.ERROR,M=>{w||(w=!0,No(Ct,`RPC '${e}' stream ${s} transport errored:`,M),C.So(new J(F.UNAVAILABLE,"The operation could not be completed")))}),P(g,Qi.EventType.MESSAGE,M=>{var k;if(!w){const A=M.data[0];Te(!!A);const R=A,V=R.error||((k=R[0])===null||k===void 0?void 0:k.error);if(V){ee(Ct,`RPC '${e}' stream ${s} received error:`,V);const z=V.status;let B=function(E){const I=et[E];if(I!==void 0)return W0(I)}(z),S=V.message;B===void 0&&(B=F.INTERNAL,S="Unknown error status: "+z+" with message "+V.message),w=!0,C.So(new J(B,S)),g.close()}else ee(Ct,`RPC '${e}' stream ${s} received:`,A),C.bo(A)}}),P(l,v0.STAT_EVENT,M=>{M.stat===ad.PROXY?ee(Ct,`RPC '${e}' stream ${s} detected buffering proxy`):M.stat===ad.NOPROXY&&ee(Ct,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{C.wo()},0),C}}function nc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(t){return new lE(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&ee("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e,n,r,s,i,a,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new nv(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===F.RESOURCE_EXHAUSTED?(or(n.toString()),or("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new J(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ee("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ee("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ZE extends rv{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=dE(this.serializer,e),r=function(i){if(!("targetChange"in i))return ue.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?ue.min():a.readTime?On(a.readTime):ue.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=yd(this.serializer),n.addTarget=function(i,a){let l;const u=a.target;if(l=dd(u)?{documents:pE(i,u)}:{query:mE(i,u)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=G0(i,a.resumeToken);const h=pd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(ue.min())>0){l.readTime=bl(i,a.snapshotVersion.toTimestamp());const h=pd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=yE(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=yd(this.serializer),n.removeTarget=e,this.a_(n)}}class eT extends rv{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Te(!!e.streamToken),this.lastStreamToken=e.streamToken,Te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=fE(e.writeResults,e.commitTime),r=On(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=yd(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>hE(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new J(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,md(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new J(F.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,md(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new J(F.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class nT{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(or(n),this.D_=!1):ee("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{ys(this)&&(ee("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=ce(u);h.L_.add(4),await Yo(h),h.q_.set("Unknown"),h.L_.delete(4),await au(h)}(this))})}),this.q_=new nT(r,s)}}async function au(t){if(ys(t))for(const e of t.B_)await e(!0)}async function Yo(t){for(const e of t.B_)await e(!1)}function sv(t,e){const n=ce(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),$h(n)?Uh(n):Si(n).r_()&&Bh(n,e))}function zh(t,e){const n=ce(t),r=Si(n);n.N_.delete(e),r.r_()&&iv(n,e),n.N_.size===0&&(r.r_()?r.o_():ys(n)&&n.q_.set("Unknown"))}function Bh(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Si(t).A_(e)}function iv(t,e){t.Q_.xe(e),Si(t).R_(e)}function Uh(t){t.Q_=new sE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Si(t).start(),t.q_.v_()}function $h(t){return ys(t)&&!Si(t).n_()&&t.N_.size>0}function ys(t){return ce(t).L_.size===0}function ov(t){t.Q_=void 0}async function sT(t){t.q_.set("Online")}async function iT(t){t.N_.forEach((e,n)=>{Bh(t,e)})}async function oT(t,e){ov(t),$h(t)?(t.q_.M_(e),Uh(t)):t.q_.set("Unknown")}async function aT(t,e,n){if(t.q_.set("Online"),e instanceof q0&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){ee("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await jl(t,r)}else if(e instanceof tl?t.Q_.Ke(e):e instanceof H0?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ue.min()))try{const r=await tv(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=i.N_.get(h);p&&i.N_.set(h,p.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,h)=>{const p=i.N_.get(u);if(!p)return;i.N_.set(u,p.withResumeToken(xt.EMPTY_BYTE_STRING,p.snapshotVersion)),iv(i,u);const g=new Er(p.target,u,h,p.sequenceNumber);Bh(i,g)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ee("RemoteStore","Failed to raise snapshot:",r),await jl(t,r)}}async function jl(t,e,n){if(!qo(e))throw e;t.L_.add(1),await Yo(t),t.q_.set("Offline"),n||(n=()=>tv(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await au(t)})}function av(t,e){return e().catch(n=>jl(t,n,e))}async function lu(t){const e=ce(t),n=zr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;lT(e);)try{const s=await HE(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,uT(e,s)}catch(s){await jl(e,s)}lv(e)&&uv(e)}function lT(t){return ys(t)&&t.O_.length<10}function uT(t,e){t.O_.push(e);const n=zr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function lv(t){return ys(t)&&!zr(t).n_()&&t.O_.length>0}function uv(t){zr(t).start()}async function cT(t){zr(t).p_()}async function dT(t){const e=zr(t);for(const n of t.O_)e.m_(n.mutations)}async function hT(t,e,n){const r=t.O_.shift(),s=jh.from(r,e,n);await av(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await lu(t)}async function fT(t,e){e&&zr(t).V_&&await async function(r,s){if(function(a){return tE(a)&&a!==F.ABORTED}(s.code)){const i=r.O_.shift();zr(r).s_(),await av(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await lu(r)}}(t,e),lv(t)&&uv(t)}async function Cm(t,e){const n=ce(t);n.asyncQueue.verifyOperationInProgress(),ee("RemoteStore","RemoteStore received new credentials");const r=ys(n);n.L_.add(3),await Yo(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await au(n)}async function pT(t,e){const n=ce(t);e?(n.L_.delete(2),await au(n)):e||(n.L_.add(2),await Yo(n),n.q_.set("Unknown"))}function Si(t){return t.K_||(t.K_=function(n,r,s){const i=ce(n);return i.w_(),new ZE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:sT.bind(null,t),Ro:iT.bind(null,t),mo:oT.bind(null,t),d_:aT.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),$h(t)?Uh(t):t.q_.set("Unknown")):(await t.K_.stop(),ov(t))})),t.K_}function zr(t){return t.U_||(t.U_=function(n,r,s){const i=ce(n);return i.w_(),new eT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:cT.bind(null,t),mo:fT.bind(null,t),f_:dT.bind(null,t),g_:hT.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await lu(t)):(await t.U_.stop(),t.O_.length>0&&(ee("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Zn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new Wh(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new J(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hh(t,e){if(or("AsyncQueue",`${e}: ${t}`),qo(t))return new J(F.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ie.comparator(n.key,r.key):(n,r)=>ie.comparator(n.key,r.key),this.keyedMap=Ki(),this.sortedSet=new He(this.comparator)}static emptySet(e){return new ti(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ti)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ti;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(){this.W_=new He(ie.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):le():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class pi{constructor(e,n,r,s,i,a,l,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new pi(e,n,ti.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&tu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class gT{constructor(){this.queries=Rm(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ce(n),i=s.queries;s.queries=Rm(),i.forEach((a,l)=>{for(const u of l.j_)u.onError(r)})})(this,new J(F.ABORTED,"Firestore shutting down"))}}function Rm(){return new wi(t=>N0(t),tu)}async function cv(t,e){const n=ce(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new mT,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=Hh(a,`Initialization of query '${bs(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&qh(n)}async function dv(t,e){const n=ce(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function yT(t,e){const n=ce(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&qh(n)}function vT(t,e,n){const r=ce(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function qh(t){t.Y_.forEach(e=>{e.next()})}var _d,Pm;(Pm=_d||(_d={})).ea="default",Pm.Cache="cache";class hv{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new pi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=pi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==_d.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e){this.key=e}}class pv{constructor(e){this.key=e}}class _T{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=pe(),this.mutatedKeys=pe(),this.Aa=b0(e),this.Ra=new ti(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new km,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,g)=>{const m=s.get(p),w=nu(this.query,g)?g:null,C=!!m&&this.mutatedKeys.has(m.key),P=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let M=!1;m&&w?m.data.isEqual(w.data)?C!==P&&(r.track({type:3,doc:w}),M=!0):this.ga(m,w)||(r.track({type:2,doc:w}),M=!0,(u&&this.Aa(w,u)>0||h&&this.Aa(w,h)<0)&&(l=!0)):!m&&w?(r.track({type:0,doc:w}),M=!0):m&&!w&&(r.track({type:1,doc:m}),M=!0,(u||h)&&(l=!0)),M&&(w?(a=a.add(w),i=P?i.add(p):i.delete(p)):(a=a.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((p,g)=>function(w,C){const P=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return le()}};return P(w)-P(C)}(p.type,g.type)||this.Aa(p.doc,g.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,h=u!==this.Ea;return this.Ea=u,a.length!==0||h?{snapshot:new pi(this.query,e.Ra,i,a,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new km,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=pe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new pv(r))}),this.da.forEach(r=>{e.has(r)||n.push(new fv(r))}),n}ba(e){this.Ta=e.Ts,this.da=pe();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return pi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class xT{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class wT{constructor(e){this.key=e,this.va=!1}}class ST{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new wi(l=>N0(l),tu),this.Ma=new Map,this.xa=new Set,this.Oa=new He(ie.comparator),this.Na=new Map,this.La=new Lh,this.Ba={},this.ka=new Map,this.qa=fi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function ET(t,e,n=!0){const r=xv(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await mv(r,e,n,!0),s}async function TT(t,e){const n=xv(t);await mv(n,e,!0,!1)}async function mv(t,e,n,r){const s=await qE(t.localStore,Ln(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await IT(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&sv(t.remoteStore,s),l}async function IT(t,e,n,r,s){t.Ka=(g,m,w)=>async function(P,M,k,A){let R=M.view.ma(k);R.ns&&(R=await Tm(P.localStore,M.query,!1).then(({documents:S})=>M.view.ma(S,R)));const V=A&&A.targetChanges.get(M.targetId),z=A&&A.targetMismatches.get(M.targetId)!=null,B=M.view.applyChanges(R,P.isPrimaryClient,V,z);return Nm(P,M.targetId,B.wa),B.snapshot}(t,g,m,w);const i=await Tm(t.localStore,e,!0),a=new _T(e,i.Ts),l=a.ma(i.documents),u=Ko.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=a.applyChanges(l,t.isPrimaryClient,u);Nm(t,n,h.wa);const p=new xT(e,n,a);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function AT(t,e,n){const r=ce(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!tu(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await vd(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&zh(r.remoteStore,s.targetId),xd(r,s.targetId)}).catch(Ho)):(xd(r,s.targetId),await vd(r.localStore,s.targetId,!0))}async function CT(t,e){const n=ce(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),zh(n.remoteStore,r.targetId))}async function kT(t,e,n){const r=VT(t);try{const s=await function(a,l){const u=ce(a),h=at.now(),p=l.reduce((w,C)=>w.add(C.key),pe());let g,m;return u.persistence.runTransaction("Locally write mutations","readwrite",w=>{let C=ar(),P=pe();return u.cs.getEntries(w,p).next(M=>{C=M,C.forEach((k,A)=>{A.isValidDocument()||(P=P.add(k))})}).next(()=>u.localDocuments.getOverlayedDocuments(w,C)).next(M=>{g=M;const k=[];for(const A of l){const R=YS(A,g.get(A.key).overlayedDocument);R!=null&&k.push(new Wr(A.key,R,T0(R.value.mapValue),pn.exists(!0)))}return u.mutationQueue.addMutationBatch(w,h,k,l)}).next(M=>{m=M;const k=M.applyToLocalDocumentSet(g,P);return u.documentOverlayCache.saveOverlays(w,M.batchId,k)})}).then(()=>({batchId:m.batchId,changes:V0(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,u){let h=a.Ba[a.currentUser.toKey()];h||(h=new He(_e)),h=h.insert(l,u),a.Ba[a.currentUser.toKey()]=h}(r,s.batchId,n),await Xo(r,s.changes),await lu(r.remoteStore)}catch(s){const i=Hh(s,"Failed to persist write");n.reject(i)}}async function gv(t,e){const n=ce(t);try{const r=await $E(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(Te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?Te(a.va):s.removedDocuments.size>0&&(Te(a.va),a.va=!1))}),await Xo(n,r,e)}catch(r){await Ho(r)}}function Dm(t,e,n){const r=ce(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const u=ce(a);u.onlineState=l;let h=!1;u.queries.forEach((p,g)=>{for(const m of g.j_)m.Z_(l)&&(h=!0)}),h&&qh(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function RT(t,e,n){const r=ce(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new He(ie.comparator);a=a.insert(i,Pt.newNoDocument(i,ue.min()));const l=pe().add(i),u=new iu(ue.min(),new Map,new He(_e),a,l);await gv(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Gh(r)}else await vd(r.localStore,e,!1).then(()=>xd(r,e,n)).catch(Ho)}async function PT(t,e){const n=ce(t),r=e.batch.batchId;try{const s=await UE(n.localStore,e);vv(n,r,null),yv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Xo(n,s)}catch(s){await Ho(s)}}async function DT(t,e,n){const r=ce(t);try{const s=await function(a,l){const u=ce(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,l).next(g=>(Te(g!==null),p=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(r.localStore,e);vv(r,e,n),yv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Xo(r,s)}catch(s){await Ho(s)}}function yv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function vv(t,e,n){const r=ce(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function xd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||_v(t,r)})}function _v(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(zh(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Gh(t))}function Nm(t,e,n){for(const r of n)r instanceof fv?(t.La.addReference(r.key,e),NT(t,r)):r instanceof pv?(ee("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||_v(t,r.key)):le()}function NT(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ee("SyncEngine","New document in limbo: "+n),t.xa.add(r),Gh(t))}function Gh(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ie(Ve.fromString(e)),r=t.qa.next();t.Na.set(r,new wT(n)),t.Oa=t.Oa.insert(n,r),sv(t.remoteStore,new Er(Ln(Dh(n.path)),r,"TargetPurposeLimboResolution",Ih.oe))}}async function Xo(t,e,n){const r=ce(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{a.push(r.Ka(u,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const g=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){s.push(h);const g=Fh.Wi(u.targetId,h);i.push(g)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(u,h){const p=ce(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>$.forEach(h,m=>$.forEach(m.$i,w=>p.persistence.referenceDelegate.addReference(g,m.targetId,w)).next(()=>$.forEach(m.Ui,w=>p.persistence.referenceDelegate.removeReference(g,m.targetId,w)))))}catch(g){if(!qo(g))throw g;ee("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const m=g.targetId;if(!g.fromCache){const w=p.os.get(m),C=w.snapshotVersion,P=w.withLastLimboFreeSnapshotVersion(C);p.os=p.os.insert(m,P)}}}(r.localStore,i))}async function bT(t,e){const n=ce(t);if(!n.currentUser.isEqual(e)){ee("SyncEngine","User change. New user:",e.toKey());const r=await ev(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new J(F.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Xo(n,r.hs)}}function jT(t,e){const n=ce(t),r=n.Na.get(e);if(r&&r.va)return pe().add(r.key);{let s=pe();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}function xv(t){const e=ce(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=gv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=jT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RT.bind(null,e),e.Ca.d_=yT.bind(null,e.eventManager),e.Ca.$a=vT.bind(null,e.eventManager),e}function VT(t){const e=ce(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=PT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DT.bind(null,e),e}class Vl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ou(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return BE(this.persistence,new FE,e.initialUser,this.serializer)}Ga(e){return new ME(Oh.Zr,this.serializer)}Wa(e){return new QE}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Vl.provider={build:()=>new Vl};class wd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Dm(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=bT.bind(null,this.syncEngine),await pT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new gT}()}createDatastore(e){const n=ou(e.databaseInfo.databaseId),r=function(i){return new JE(i)}(e.databaseInfo);return function(i,a,l,u){return new tT(i,a,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new rT(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Dm(this.syncEngine,n,0),function(){return Am.D()?new Am:new KE}())}createSyncEngine(e,n){return function(s,i,a,l,u,h,p){const g=new ST(s,i,a,l,u,h);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ce(s);ee("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Yo(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}wd.provider={build:()=>new wd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):or("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ft.UNAUTHENTICATED,this.clientId=w0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{ee("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(ee("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Hh(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function rc(t,e){t.asyncQueue.verifyOperationInProgress(),ee("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await ev(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function bm(t,e){t.asyncQueue.verifyOperationInProgress();const n=await LT(t);ee("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Cm(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Cm(e.remoteStore,s)),t._onlineComponents=e}async function LT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee("FirestoreClient","Using user provided OfflineComponentProvider");try{await rc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===F.FAILED_PRECONDITION||s.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;No("Error using user provided cache. Falling back to memory cache: "+n),await rc(t,new Vl)}}else ee("FirestoreClient","Using default OfflineComponentProvider"),await rc(t,new Vl);return t._offlineComponents}async function Sv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee("FirestoreClient","Using user provided OnlineComponentProvider"),await bm(t,t._uninitializedComponentsProvider._online)):(ee("FirestoreClient","Using default OnlineComponentProvider"),await bm(t,new wd))),t._onlineComponents}function OT(t){return Sv(t).then(e=>e.syncEngine)}async function Ev(t){const e=await Sv(t),n=e.eventManager;return n.onListen=ET.bind(null,e.syncEngine),n.onUnlisten=AT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=TT.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=CT.bind(null,e.syncEngine),n}function FT(t,e,n={}){const r=new Zn;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,h){const p=new wv({next:m=>{p.Za(),a.enqueueAndForget(()=>dv(i,g));const w=m.docs.has(l);!w&&m.fromCache?h.reject(new J(F.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&m.fromCache&&u&&u.source==="server"?h.reject(new J(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(m)},error:m=>h.reject(m)}),g=new hv(Dh(l.path),p,{includeMetadataChanges:!0,_a:!0});return cv(i,g)}(await Ev(t),t.asyncQueue,e,n,r)),r.promise}function zT(t,e,n={}){const r=new Zn;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,h){const p=new wv({next:m=>{p.Za(),a.enqueueAndForget(()=>dv(i,g)),m.fromCache&&u.source==="server"?h.reject(new J(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(m)},error:m=>h.reject(m)}),g=new hv(l,p,{includeMetadataChanges:!0,_a:!0});return cv(i,g)}(await Ev(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tv(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jm=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iv(t,e,n){if(!n)throw new J(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function BT(t,e,n,r){if(e===!0&&r===!0)throw new J(F.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Vm(t){if(!ie.isDocumentKey(t))throw new J(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Mm(t){if(ie.isDocumentKey(t))throw new J(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function uu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":le()}function zn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new J(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=uu(t);throw new J(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new J(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new J(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}BT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Tv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new J(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new J(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new J(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Qh{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Lm({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new J(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new J(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Lm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new iS;switch(r.type){case"firstParty":return new lS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new J(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=jm.get(n);r&&(ee("ComponentProvider","Removing Datastore"),jm.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ei(this.firestore,e,this._query)}}class Mt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Mt(this.firestore,e,this._key)}}class Vr extends Ei{constructor(e,n,r){super(e,n,Dh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Mt(this.firestore,null,new ie(e))}withConverter(e){return new Vr(this.firestore,e,this._path)}}function Qn(t,e,...n){if(t=An(t),Iv("collection","path",e),t instanceof Qh){const r=Ve.fromString(e,...n);return Mm(r),new Vr(t,null,r)}{if(!(t instanceof Mt||t instanceof Vr))throw new J(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ve.fromString(e,...n));return Mm(r),new Vr(t.firestore,null,r)}}function cn(t,e,...n){if(t=An(t),arguments.length===1&&(e=w0.newId()),Iv("doc","path",e),t instanceof Qh){const r=Ve.fromString(e,...n);return Vm(r),new Mt(t,null,new ie(r))}{if(!(t instanceof Mt||t instanceof Vr))throw new J(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ve.fromString(e,...n));return Vm(r),new Mt(t.firestore,t instanceof Vr?t.converter:null,new ie(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new nv(this,"async_queue_retry"),this.Vu=()=>{const r=nc();r&&ee("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=nc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=nc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Zn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!qo(e))throw e;ee("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw or("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Wh.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&le()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class vs extends Qh{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Om,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Om(e),this._firestoreClient=void 0,await e}}}function UT(t,e,n){n||(n="(default)");const r=d0(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Cl(i,e))return s;throw new J(F.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new J(F.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new J(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function Kh(t){if(t._terminated)throw new J(F.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||$T(t),t._firestoreClient}function $T(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,h,p){return new wS(l,u,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Tv(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new MT(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new mi(xt.fromBase64String(e))}catch(n){throw new J(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new mi(xt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new J(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new J(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new J(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return _e(this._lat,e._lat)||_e(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT=/^__.*__$/;class HT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Wr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Qo(e,this.data,n,this.fieldTransforms)}}class Av{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Wr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Cv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw le()}}class Jh{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Jh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ml(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Cv(this.Cu)&&WT.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class qT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ou(e)}Qu(e,n,r,s=!1){return new Jh({Cu:e,methodName:n,qu:r,path:gt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function hu(t){const e=t._freezeSettings(),n=ou(t._databaseId);return new qT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function kv(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);ef("Data must be an object, but it was:",a,r);const l=Rv(r,a);let u,h;if(i.merge)u=new en(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const p=[];for(const g of i.mergeFields){const m=Sd(e,g,n);if(!a.contains(m))throw new J(F.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Dv(p,m)||p.push(m)}u=new en(p),h=a.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=a.fieldTransforms;return new HT(new Bt(l),u,h)}class fu extends du{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fu}}class Zh extends du{_toFieldTransform(e){return new qS(e.path,new Lo)}isEqual(e){return e instanceof Zh}}function GT(t,e,n,r){const s=t.Qu(1,e,n);ef("Data must be an object, but it was:",s,r);const i=[],a=Bt.empty();gs(r,(u,h)=>{const p=tf(e,u,n);h=An(h);const g=s.Nu(p);if(h instanceof fu)i.push(p);else{const m=Jo(h,g);m!=null&&(i.push(p),a.set(p,m))}});const l=new en(i);return new Av(a,l,s.fieldTransforms)}function QT(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[Sd(e,r,n)],u=[s];if(i.length%2!=0)throw new J(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(Sd(e,i[m])),u.push(i[m+1]);const h=[],p=Bt.empty();for(let m=l.length-1;m>=0;--m)if(!Dv(h,l[m])){const w=l[m];let C=u[m];C=An(C);const P=a.Nu(w);if(C instanceof fu)h.push(w);else{const M=Jo(C,P);M!=null&&(h.push(w),p.set(w,M))}}const g=new en(h);return new Av(p,g,a.fieldTransforms)}function KT(t,e,n,r=!1){return Jo(n,t.Qu(r?4:3,e))}function Jo(t,e){if(Pv(t=An(t)))return ef("Unsupported field value:",e,t),Rv(t,e);if(t instanceof du)return function(r,s){if(!Cv(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let u=Jo(l,s.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=An(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return $S(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=at.fromDate(r);return{timestampValue:bl(s.serializer,i)}}if(r instanceof at){const i=new at(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:bl(s.serializer,i)}}if(r instanceof Yh)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof mi)return{bytesValue:G0(s.serializer,r._byteString)};if(r instanceof Mt){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Mh(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Xh)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return Nh(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${uu(r)}`)}(t,e)}function Rv(t,e){const n={};return S0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gs(t,(r,s)=>{const i=Jo(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Pv(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof at||t instanceof Yh||t instanceof mi||t instanceof Mt||t instanceof du||t instanceof Xh)}function ef(t,e,n){if(!Pv(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=uu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Sd(t,e,n){if((e=An(e))instanceof cu)return e._internalPath;if(typeof e=="string")return tf(t,e);throw Ml("Field path arguments must be of type string or ",t,!1,void 0,n)}const YT=new RegExp("[~\\*/\\[\\]]");function tf(t,e,n){if(e.search(YT)>=0)throw Ml(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new cu(...e.split("."))._internalPath}catch{throw Ml(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ml(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new J(F.INVALID_ARGUMENT,l+t+u)}function Dv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Mt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new XT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(nf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class XT extends Nv{data(){return super.data()}}function nf(t,e){return typeof e=="string"?tf(t,e):e instanceof cu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new J(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class rf{}class ZT extends rf{}function Xi(t,e,...n){let r=[];e instanceof rf&&r.push(e),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof sf).length,l=i.filter(u=>u instanceof pu).length;if(a>1||a>0&&l>0)throw new J(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class pu extends ZT{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new pu(e,n,r)}_apply(e){const n=this._parse(e);return bv(e._query,n),new Ei(e.firestore,e.converter,hd(e._query,n))}_parse(e){const n=hu(e.firestore);return function(i,a,l,u,h,p,g){let m;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new J(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){zm(g,p);const w=[];for(const C of g)w.push(Fm(u,i,C));m={arrayValue:{values:w}}}else m=Fm(u,i,g)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||zm(g,p),m=KT(l,a,g,p==="in"||p==="not-in");return rt.create(h,p,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ed(t,e,n){const r=e,s=nf("where",t);return pu._create(s,r,n)}class sf extends rf{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new sf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Cn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const u of l)bv(a,u),a=hd(a,u)}(e._query,n),new Ei(e.firestore,e.converter,hd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Fm(t,e,n){if(typeof(n=An(n))=="string"){if(n==="")throw new J(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!D0(e)&&n.indexOf("/")!==-1)throw new J(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ve.fromString(n));if(!ie.isDocumentKey(r))throw new J(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return am(t,new ie(r))}if(n instanceof Mt)return am(t,n._key);throw new J(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uu(n)}.`)}function zm(t,e){if(!Array.isArray(t)||t.length===0)throw new J(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bv(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new J(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new J(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class eI{convertValue(e,n="none"){switch(fs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ye(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(hs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw le()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return gs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>Ye(a.doubleValue));return new Xh(i)}convertGeoPoint(e){return new Yh(Ye(e.latitude),Ye(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Ch(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(jo(e));default:return null}}convertTimestamp(e){const n=Fr(e);return new at(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ve.fromString(e);Te(Z0(r));const s=new Vo(r.get(1),r.get(3)),i=new ie(r.popFirst(5));return s.isEqual(n)||or(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jv(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Vv extends Nv{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new nl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(nf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class nl extends Vv{data(e={}){return super.data(e)}}class tI{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ji(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new nl(this._firestore,this._userDataWriter,r.key,r,new Ji(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new J(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const u=new nl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Ji(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new nl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Ji(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,p=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:nI(l.type),doc:u,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function nI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return le()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rI(t){t=zn(t,Mt);const e=zn(t.firestore,vs);return FT(Kh(e),t._key).then(n=>iI(e,t,n))}class Mv extends eI{constructor(e){super(),this.firestore=e}convertBytes(e){return new mi(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Mt(this.firestore,null,n)}}function Ms(t){t=zn(t,Ei);const e=zn(t.firestore,vs),n=Kh(e),r=new Mv(e);return JT(t._query),zT(n,t._query).then(s=>new tI(e,r,t,s))}function sI(t,e,n){t=zn(t,Mt);const r=zn(t.firestore,vs),s=jv(t.converter,e);return mu(r,[kv(hu(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,pn.none())])}function Kn(t,e,n,...r){t=zn(t,Mt);const s=zn(t.firestore,vs),i=hu(s);let a;return a=typeof(e=An(e))=="string"||e instanceof cu?QT(i,"updateDoc",t._key,e,n,r):GT(i,"updateDoc",t._key,e),mu(s,[a.toMutation(t._key,pn.exists(!0))])}function sc(t){return mu(zn(t.firestore,vs),[new bh(t._key,pn.none())])}function of(t,e){const n=zn(t.firestore,vs),r=cn(t),s=jv(t.converter,e);return mu(n,[kv(hu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,pn.exists(!1))]).then(()=>r)}function mu(t,e){return function(r,s){const i=new Zn;return r.asyncQueue.enqueueAndForget(async()=>kT(await OT(r),s,i)),i.promise}(Kh(t),e)}function iI(t,e,n){const r=n.docs.get(e._key),s=new Mv(t);return new Vv(t,s,e._key,r,new Ji(n.hasPendingWrites,n.fromCache),e.converter)}function hn(){return new Zh("serverTimestamp")}(function(e,n=!0){(function(s){xi=s})(Hw),Po(new ui("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new vs(new oS(r.getProvider("auth-internal")),new cS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new J(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vo(h.options.projectId,p)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),jr(nm,"4.7.3",e),jr(nm,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Td="us-central1";class aI{constructor(e,n,r,s,i=Td,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new oI(n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Td}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function lI(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const Bm="@firebase/functions",Um="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI="auth-internal",cI="app-check-internal",dI="messaging-internal";function hI(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),a=r.getProvider(uI),l=r.getProvider(dI),u=r.getProvider(cI);return new aI(i,a,l,u,s,t)};Po(new ui(Lv,n,"PUBLIC").setMultipleInstances(!0)),jr(Bm,Um,e),jr(Bm,Um,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(t=qw(),e=Td){const r=d0(An(t),Lv).getImmediate({identifier:e}),s=L1("functions");return s&&pI(r,...s),r}function pI(t,e,n){lI(An(t),e,n)}hI(fetch.bind(self));const mI={apiKey:'"AIzaSyDRdl4zhwoZumVtphmJ19orZ8HoR0WQQZM",',authDomain:'"qualtrics-game-backend.firebaseapp.com",',projectId:'"qualtrics-game-backend",',storageBucket:'"qualtrics-game-backend.firebasestorage.app",',messagingSenderId:'"441267092549",',appId:"1:441267092549:web:6ce075f5f3ea7cf958772c"},Ov=h0(mI),tt=UT(Ov,{experimentalForceLongPolling:!1,useFetchStreams:!1});fI(Ov);const je={init(){localStorage.getItem("sessionId")||(localStorage.setItem("sessionId",this.generateSessionId()),localStorage.setItem("sessionStartTime",Date.now().toString())),localStorage.getItem("semesterStartTime")||localStorage.setItem("semesterStartTime",Date.now().toString())},generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},async logEvent(t,e){const n=localStorage.getItem("sessionId")||this.generateSessionId(),r=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),s=Date.now(),i=s-r,a=(i/1e3).toFixed(1),l=Math.floor(i/6e4),u=Math.floor(i%6e4/1e3),h=`${l}:${u.toString().padStart(2,"0")}`,p=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),g=this.getFullGameContext(),m={sessionId:n,studentId:p.studentId||null,type:t,timestamp:new Date().toISOString(),clientTimestamp:s,timeElapsedSeconds:parseFloat(a),readableTime:h,semesterTime:this.getSemesterTime(),...g,isAdminMode:p.role==="admin",hasCheckpoint:p.checkpointSemester2||!1,hasAI:p.hasAI||!1,section:p.section||null,...this.convertTimesToSeconds(e)};(t==="user_action"||t==="task_attempt")&&console.log(`DEBUG: Event ${t} - studentId: ${m.studentId}, role: ${p.role}`);try{await of(Qn(tt,"events"),m)}catch(w){console.error("Failed to log event:",w),this.storeOfflineEvent(m)}},convertTimesToSeconds(t){const e={...t},n=["timeTaken","timeSpent","totalTime","timeOnPreviousPage","averageTime","timeBetweenHelpAndSubmit"];for(const r of n)e[r]!==void 0&&e[r]!==null&&(e[`${r}Seconds`]=(e[r]/1e3).toFixed(1),delete e[r]);return e.timeProgression&&(e.timeProgressionSeconds=e.timeProgression.map(r=>(r/1e3).toFixed(1)),delete e.timeProgression),e.timePerAttempt&&(e.timePerAttemptSeconds=e.timePerAttempt.map(r=>(r/1e3).toFixed(1)),delete e.timePerAttempt),e},getSemesterTime(){const t=parseInt(localStorage.getItem("semesterStartTime")||Date.now()),e=Date.now()-t,n=(e/1e3).toFixed(1),r=Math.floor(e/6e4),s=Math.floor(e%6e4/1e3);return{elapsedSeconds:parseFloat(n),readable:`${r}:${s.toString().padStart(2,"0")}`,minutes:r,seconds:s}},getCurrentContext(){const t=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),e=((Date.now()-t)/1e3).toFixed(1);return{currentTask:localStorage.getItem("currentTask"),gameMode:localStorage.getItem("gameMode"),totalCompleted:this.getCompletedTaskCount(),currentStreak:this.getCurrentStreak(),sessionDurationSeconds:parseFloat(e)}},getFullGameContext(){const t=localStorage.getItem("currentTask")||"",e=localStorage.getItem("gameMode")||"",n=parseInt(localStorage.getItem("currentSemester")||"1"),r=parseInt(localStorage.getItem("totalSemesters")||"2"),s=localStorage.getItem("practiceCompleted")==="true",i=parseInt(localStorage.getItem("completedTasksCount")||"0"),a=parseInt(localStorage.getItem("completedLevels")||"0"),l=parseInt(localStorage.getItem("totalSwitches")||"0"),u=parseInt(localStorage.getItem("aiUsageCount")||"0"),h=JSON.parse(localStorage.getItem("categoryPoints")||"{}"),p=parseFloat(localStorage.getItem("studentLearningScore")||"0");return{currentTask:t,gameMode:e,currentSemester:n,totalSemesters:r,practiceCompleted:s,completedTasks:i,completedLevels:a,totalSwitches:l,aiUsageCount:u,studentLearning:p,totalBonus:h.bonus||0,finalScore:Math.round(p)+(h.bonus||0),semester:n}},calculateImprovementTrend(t){if(!t||t.length<3)return"needs_more_data";const n=t.slice(-5).map(s=>s.accuracy),r=this.calculateTrend(n);return r>5?"rapid_improvement":r>2?"steady_improvement":r>0?"slight_improvement":r>-2?"stable":r>-5?"slight_decline":"rapid_decline"},calculateImprovementRate(t){if(!t||t.length<2)return{overall:0,trend:0,isImproving:!1,dataPoints:t?t.length:0};const e=t[0].accuracy,r=t[t.length-1].accuracy-e;if(t.length<3)return{overall:r,trend:r,isImproving:r>0,dataPoints:t.length};const s=Math.floor(t.length/2),i=t.slice(0,s).reduce((u,h)=>u+h.accuracy,0)/s,l=t.slice(s).reduce((u,h)=>u+h.accuracy,0)/(t.length-s)-i;return{overall:r,trend:l,isImproving:l>0,dataPoints:t.length}},setPageStartTime(t){t&&localStorage.setItem(`pageStartTime_${t}`,Date.now().toString())},getTimeOnCurrentPage(t){if(!t)return 0;const e=localStorage.getItem(`pageStartTime_${t}`);return e?Date.now()-parseInt(e):0},ensureSession(){localStorage.getItem("sessionId")||this.init()},async trackAIHelpResponse(t,e,n,r,s,i){const a=parseInt(localStorage.getItem("aiUsageCount")||"0");return localStorage.setItem("aiUsageCount",(a+1).toString()),this.logEvent("ai_help_response",{taskId:t,helpType:e,suggestion:n,playerAction:r,playerValue:s,timeBetween:i})},async trackTaskAttempt(t,e){return this.logEvent("task_attempt",{taskId:t,...e})},async trackUserAction(t,e){return this.logEvent("user_action",{action:t,response:e.response||"",query:e.query||"",queryType:e.queryType||"",choice:e.choice||"",currentMode:e.currentMode||"",...e})},async syncOfflineEvents(){return console.log("Syncing offline events..."),Promise.resolve()},async trackTaskComplete(t,e){return this.logEvent("task_complete",{taskId:t,...e})},async trackPageSwitch(t,e,n){return this.logEvent("page_switch",{from:t,to:e,isAutoAdvance:n})},trackAITaskHelp(t,e,n,r,s){return this.logEvent("ai_task_help",{taskId:t,taskType:e,suggestion:n,wasCorrect:r,attemptNumber:s})}};je.init();const er={seedRandom:null,currentSeed:null,initializeSeed(t){this.currentSeed=t;let e=t;this.seedRandom=function(){return e=(e*9301+49297)%233280,e/233280}},getRandom(){return this.seedRandom?this.seedRandom():Math.random()},generateCountingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n;e==="easy"?n=(t-1)%5+1:e==="medium"?n=(t-11)%5+6:n=(t-25)%5+11;const s={easy:{1:{target:"the",type:"word"},2:{target:"and",type:"word"},3:{target:"of",type:"word"},4:{target:"to",type:"word"},5:{target:"in",type:"word"}},medium:{6:{target:"e",type:"letter"},7:{target:"a",type:"letter"},8:{target:"i",type:"letter"},9:{target:"o",type:"letter"},10:{target:"s",type:"letter"}},hard:{11:{targets:["a","e"],type:"multi-letter"},12:{targets:["i","o"],type:"multi-letter"},13:{targets:["s","t"],type:"multi-letter"},14:{targets:["n","r"],type:"multi-letter"},15:{targets:["l","d"],type:"multi-letter"}}}[e][n];let i="";return s.type==="word"?i=`Count how many times the word "${s.target}" appears:`:s.type==="letter"?i=`Count how many times the letter "${s.target}" appears (case-insensitive):`:i=`Count how many times the letters "${s.targets[0]}" and "${s.targets[1]}" appear in total:`,{...s,instruction:i,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},generateSliderPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n,r,s;return e==="easy"?(n=Math.floor(this.getRandom()*11),r=1,s=!0):e==="medium"?(n=Math.round(this.getRandom()*10*10)/10,r=.1,s=!0):(n=Math.round(this.getRandom()*10*100)/100,r=.01,s=(t-25)%5!==0),{target:n,step:r,showValue:s,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1),precision:e==="easy"?0:e==="medium"?1:2}},generateTypingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard",n={easy:["hello world","quick test","type this","easy mode","simple text","good job","keep going","nice work","almost done","level up"],medium:["HeLLo WoRLd","QuIcK tEsT","TyPe ThIs","MeDiUm MoDe","MiXeD cAsE","KeEp GoInG","NiCe WoRk","AlMoSt DoNe","LeVeL uP","ChAlLeNgE","TeSt RuN","NeXt LeVeL","TrY aGaIn","GoOd LuCk","FiNaL tEsT"],hard:["Test@123","Go4It!Now","X9%Y8&Z7*","P6!Q5?R4+","Z1@Y2#X3$","M7&N8*O9!","J4%K5^L6&","D1!E2@F3#","A7$B8%C9^","V3*W4+X5=","Q2#R3$S4%","H5^I6&J7*","K8(L9)M0!","N1@O2#P3$","T4%U5^V6&","W7*X8(Y9)","C0!D1@E2#","F3$G4%H5^","I6&J7*K8(","L9)M0!N1@","O2#P3$Q4%","R5^S6&T7*","U8(V9)W0!","X1@Y2#Z3$","A4%B5^C6&"]};let r;if(e==="easy"){const s=(t-1)%n.easy.length;r=n.easy[s]}else if(e==="medium"){const s=(t-11)%n.medium.length;r=n.medium[s]}else{const s=(t-25)%n.hard.length;r=n.hard[s]}return{pattern:r,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},textPassages:["The University of California, Berkeley (UC Berkeley, Berkeley, Cal, or California) is a public land-grant research university in Berkeley, California, United States. Founded in 1868 and named after the Anglo-Irish philosopher George Berkeley, it is the state's first land-grant university and is the founding campus of the University of California system.","Berkeley has an enrollment of more than 45,000 students. The university is organized around fifteen schools of study on the same campus, including the College of Chemistry, the College of Engineering, College of Letters and Science, and the Haas School of Business.",'The Berkeley campus encompasses approximately 1,232 acres, though the "central campus" occupies only the low-lying western 178 acres. The campus contains numerous wooded areas, including the Eucalyptus Grove and Strawberry Creek, which runs through the center of campus.',"Oski the Bear (Oski) is the official mascot of the University of California, Berkeley, representing the California Golden Bears. Named after the Oski Yell, he made his debut at a freshman rally in the Greek Theatre on September 25, 1941.","Berkeley faculty, alumni, and researchers have won 111 Nobel laureates, 25 Turing Award winners, and 19 Academy Award winners. The university has produced many notable alumni in various fields including science, politics, business, and entertainment.","The university's athletic teams compete as the California Golden Bears and are members of the Atlantic Coast Conference for most sports. Berkeley teams have won 107 national championships, including 45 NCAA national championships.","Research at Berkeley is conducted within departments, organized research units, and interdisciplinary research centers. Berkeley operates Lawrence Berkeley National Laboratory, manages Los Alamos National Laboratory, and is a founding partner of the Space Sciences Laboratory.","The Berkeley campus offers over 350 degree programs through its 14 colleges and schools. Popular majors include Computer Science, Economics, Political Science, and Business Administration. The student-faculty ratio is 17:1.","Berkeley's libraries contain more than 13 million volumes and maintain special collections including the Mark Twain Papers, the Oral History Center, and the Bancroft Library, which houses the largest collection of materials on California history.","The campus is home to several museums including the Berkeley Art Museum and Pacific Film Archive, the Lawrence Hall of Science, and the UC Botanical Garden. These facilities serve both educational and public outreach purposes.","Notable Berkeley inventions and discoveries include the cyclotron, the atomic bomb, the flu vaccine, and vitamin E. Berkeley researchers discovered 16 chemical elements of the periodic table, more than any other university.","The Free Speech Movement, which took place during the 1964-65 academic year, was a pivotal moment in the history of civil liberties in the United States. It began when students protested a ban on political activities on campus.","Berkeley's Campanile, known as Sather Tower, is the third-tallest clock tower in the world at 307 feet. It was completed in 1914 and is visible for miles, serving as a symbol of the university.","The university operates on a semester system, with fall semester beginning in late August and spring semester beginning in mid-January. Berkeley offers over 5,000 courses each semester across all disciplines.",`Cal Bears have won at least one team national title in 13 different sports. The university's traditional rival is Stanford University, with the annual football game known as "The Big Game" dating back to 1892.`],getTextPassage(t){if(this.seedRandom){const e=Math.floor(this.getRandom()*this.textPassages.length),n=(t-1+e)%this.textPassages.length;return this.textPassages[n]}else{const e=(t-1)%this.textPassages.length;return this.textPassages[e]}}};function Id({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=b.useState(""),[a,l]=b.useState(""),[u,h]=b.useState(null),[p,g]=b.useState(""),[m,w]=b.useState(null),[C,P]=b.useState(""),[M,k]=b.useState(""),[A]=b.useState(Date.now()),[R,V]=b.useState(""),[z,B]=b.useState(!1),[S,v]=b.useState(new Set),E=b.useRef(0);b.useRef(null);const I=(re,Y=null,U=null)=>{const N=document.createElement("canvas"),O=N.getContext("2d");N.width=900,N.height=400,O.fillStyle="#fafafa",O.fillRect(0,0,N.width,N.height),O.strokeStyle="#e0e0e0",O.lineWidth=2,O.strokeRect(0,0,N.width,N.height),O.font="24px monospace",O.fillStyle="#333";const L=36,W=25,X=N.width-W*2;return((xe,fe)=>{const de=xe.split(" "),Oe=[];let we="";for(let ne of de){const ke=we+(we?" ":"")+ne;O.measureText(ke).width>fe&&we?(Oe.push(we),we=ne):we=ke}return we&&Oe.push(we),Oe})(re,X).forEach((xe,fe)=>{const de=W+(fe+1)*L;let Oe=W;if(t<=5){const we=xe.split(" ");let ne=0;we.forEach(ke=>{const Fe=U&&U.has(ne),Re=Y&&Y.some(wt=>ke.toLowerCase()===wt.toLowerCase());if(Fe){const wt=O.measureText(ke).width;O.fillStyle="yellow",O.fillRect(Oe-2,de-18,wt+4,24)}else if(Re){const wt=O.measureText(ke).width;O.fillStyle="rgba(255, 215, 0, 0.4)",O.fillRect(Oe-2,de-18,wt+4,24)}O.fillStyle="#333",O.fillText(ke,Oe,de),Oe+=O.measureText(ke+" ").width,ne++})}else for(let we=0;we<xe.length;we++){const ne=xe[we],ke=O.measureText(ne).width;Y&&Y.some(Re=>ne.toLowerCase()===Re.toLowerCase())&&(O.fillStyle="rgba(255, 215, 0, 0.4)",O.fillRect(Oe-1,de-18,ke+2,24)),O.fillStyle="#333",O.fillText(ne,Oe,de),Oe+=ke}}),N.toDataURL()};b.useEffect(()=>{g(0),w(null),E.current=0},[t]),b.useEffect(()=>{const re=async(U,N)=>{const O=document.createElement("canvas"),L=O.getContext("2d");O.width=900,O.height=350,L.fillStyle="#fafafa",L.fillRect(0,0,O.width,O.height),L.strokeStyle="#e0e0e0",L.lineWidth=2,L.strokeRect(0,0,O.width,O.height),L.font="24px monospace";const W=36,X=20,oe=O.width-X*2,xe=((fe,de)=>{const Oe=fe.split(" "),we=[];let ne="";for(let ke of Oe){const Fe=ne+(ne?" ":"")+ke;L.measureText(Fe).width>de&&ne?(we.push(ne),ne=ke):ne=Fe}return ne&&we.push(ne),we})(C,oe);for(let fe=0;fe<U.length;fe++)U[fe],xe.forEach((de,Oe)=>{const we=X+(Oe+1)*W;let ne=X;for(let ke=0;ke<de.length;ke++){const Fe=de[ke],Re=L.measureText(Fe).width;U.some(qt=>Fe.toLowerCase()===qt.toLowerCase())&&(L.fillStyle="rgba(255, 255, 0, 0.6)",L.fillRect(ne-1,we-20,Re+2,26)),L.fillStyle="#333",L.fillText(Fe,ne,we),ne+=Re}}),V(O.toDataURL()),await new Promise(de=>setTimeout(de,300));setTimeout(()=>{g(N.toString())},300)},Y=async U=>{const{action:N,highlightWords:O,suggestedCount:L,animate:W,isMultiLetter:X,targetLetters:oe}=U.detail||{};if(N==="highlightAndCount"){if(X&&Array.isArray(oe)){W&&await re(oe,L);return}if(Array.isArray(O)&&W){C.split(" ");let Ce=[];for(let xe=0;xe<O.length;xe++){Ce.push(O[xe]);const fe=document.createElement("canvas"),de=fe.getContext("2d");fe.width=900,fe.height=350,de.fillStyle="#fafafa",de.fillRect(0,0,fe.width,fe.height),de.strokeStyle="#e0e0e0",de.lineWidth=2,de.strokeRect(0,0,fe.width,fe.height),de.font="24px monospace";const Oe=36,we=20,ne=fe.width-we*2;((Re,wt)=>{const qt=Re.split(" "),Gt=[];let Qt="";for(let Kt of qt){const ur=Qt+(Qt?" ":"")+Kt;de.measureText(ur).width>wt&&Qt?(Gt.push(Qt),Qt=Kt):Qt=ur}return Qt&&Gt.push(Qt),Gt})(C,ne).forEach((Re,wt)=>{const qt=we+(wt+1)*Oe;let Gt=we;Re.split(" ").forEach(Kt=>{const ur=de.measureText(Kt).width;Ce.some(kn=>{const dr=Kt.replace(/[.,;!?]/g,"").toLowerCase(),Pe=kn.replace(/[.,;!?]/g,"").toLowerCase();return dr===Pe})&&(de.fillStyle="rgba(255, 255, 0, 0.5)",de.fillRect(Gt-2,qt-18,ur+4,24)),de.fillStyle="#333",de.fillText(Kt,Gt,qt),Gt+=de.measureText(Kt+" ").width})}),V(fe.toDataURL()),await new Promise(Re=>setTimeout(Re,200))}setTimeout(()=>{g(L.toString())},300)}}};return window.addEventListener("aiCountingHelp",Y),()=>window.removeEventListener("aiCountingHelp",Y)},[C,t]),b.useEffect(()=>{var O;const re=er.generateCountingPattern(t),Y=er.getTextPassage(t);P(Y),i(re.target||((O=re.targets)==null?void 0:O.join(", "))),l(re.instruction);let U=0;if(re.type==="word"){const L=new RegExp(`\\b${re.target}\\b`,"gi"),W=Y.match(L);U=W?W.length:0}else if(re.type==="letter"){const L=new RegExp(re.target,"gi"),W=Y.match(L);U=W?W.length:0}else re.type==="multi-letter"&&re.targets.forEach(L=>{const W=new RegExp(L,"gi"),X=Y.match(W);U+=X?X.length:0});h(U);const N=I(Y,null);V(N)},[t]);const _=async()=>{const re=Date.now()-A,Y=parseInt(p,10)||0,U=u??0,N=Math.abs(Y-U),O=`g1t${t}`,L=localStorage.getItem(`lastAIHelp_${O}`);if(L){const oe=JSON.parse(L),Ce=Date.now()-oe.timestamp,xe=Y===oe.suggestion?"accepted":"modified";await je.trackAIHelpResponse(O,oe.type,oe.suggestion,xe,Y,Ce),localStorage.removeItem(`lastAIHelp_${O}`)}let W=0;N===0?W=2:N<=1?W=1:W=0,E.current+=1,await je.trackTaskAttempt(O,E.current,!0,re,Y,U);const X=localStorage.getItem("sessionId");if(X&&!X.startsWith("offline-"))try{await Kn(cn(tt,"sessions",X),{[`taskAccuracies.g1t${t}`]:W===2?100:W===1?70:0,[`taskTimes.g1t${t}`]:re,[`taskPoints.g1t${t}`]:W,lastActivity:hn()})}catch(oe){console.error("Error storing accuracy:",oe)}w(W===2?" Perfect! 2 points earned!":W===1?` Off by ${N} - 1 point earned!`:` Off by ${N} - 0 points earned.`),setTimeout(()=>{e==null||e(`g1t${t}`,{attempts:E.current,totalTime:re,accuracy:W===2?100:W===1?70:0,userAnswer:Y,correctAnswer:U,points:W})},500)},x=er.generateCountingPattern(t).difficultyLabel,te=t<=5?"easy":t<=10?"medium":"hard";return d.jsxs("div",{className:"task counting",children:[d.jsxs("h3",{children:["Research Content - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${te}`,children:x}),d.jsxs("p",{className:"instruction",children:[d.jsx("strong",{children:a}),d.jsx("br",{}),d.jsx("span",{className:"hint",children:"(Case-insensitive)"})]}),d.jsxs("div",{className:"text-display text-to-count","data-counting-text":C,children:[d.jsx("div",{className:"count-target","data-pattern":s,style:{display:"none"},children:s}),R?d.jsx("img",{src:R,alt:"Text passage for counting",style:{width:"100%",maxWidth:"900px",height:"auto",maxHeight:"350px",objectFit:"contain",border:"none",userSelect:"none",pointerEvents:"none"},onContextMenu:re=>re.preventDefault(),draggable:!1}):d.jsx("div",{dangerouslySetInnerHTML:{__html:M}})]}),d.jsxs("div",{className:"input-section",children:[d.jsx("label",{children:"Your answer:"}),d.jsx("input",{type:"number",min:"0",max:"999",value:p,onChange:re=>g(re.target.value),onKeyPress:re=>{re.key==="Enter"&&_()},placeholder:"Enter count"})]}),d.jsx("button",{onClick:_,className:"submit-btn",style:{display:"block",margin:"20px auto 0"},children:"Submit"}),m&&d.jsx("div",{className:`feedback ${m.includes("2 points")?"correct":m.includes("0 points")?"incorrect":"partial"}`,children:m})]})}function Ad({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=b.useState(5),[a,l]=b.useState(0),[u,h]=b.useState(null),[p]=b.useState(Date.now()),[g,m]=b.useState(1),[w,C]=b.useState(!0),[P,M]=b.useState(!1),[k,A]=b.useState(!1),[R,V]=b.useState(!1),[z,B]=b.useState(!1),S=b.useRef(null),v=b.useRef(0);b.useEffect(()=>{if(n)i(3),m(1),C(!0);else{const U=er.generateSliderPattern(t);i(U.target),m(U.step),C(U.showValue)}l(0),h(null),v.current=0},[t,n]),b.useEffect(()=>{const U=N=>{const{action:O,value:L,animate:W}=N.detail;if(O==="moveSlider")if(A(!0),W){const X=parseFloat(a),oe=parseFloat(L),Ce=1e3,xe=30;let fe=0;const de=setInterval(()=>{fe++;const Oe=fe/xe,we=1-Math.pow(1-Oe,3),ne=X+(oe-X)*we;l(parseFloat(ne.toFixed(2))),fe>=xe&&(clearInterval(de),A(!1),l(parseFloat(oe.toFixed(2))))},Ce/xe)}else l(parseFloat(L.toFixed(2))),A(!1)};return window.addEventListener("aiSliderHelp",U),()=>window.removeEventListener("aiSliderHelp",U)},[a]),b.useEffect(()=>{const U=N=>{N.key==="Enter"&&!k&&T()};return document.addEventListener("keypress",U),()=>document.removeEventListener("keypress",U)},[k,a,s]);const E=U=>{if(k)return;const N=S.current;if(!N)return;U.preventDefault();const O=N.getBoundingClientRect(),L=a/10,W=O.left+O.width*L,X=U.clientX||U.touches&&U.touches[0].clientX;Math.abs(X-W)<30&&(V(!0),B(!0))},I=U=>{if(!R||k)return;const N=S.current;if(!N)return;const O=N.getBoundingClientRect(),L=U.clientX||U.touches&&U.touches[0].clientX,X=Math.max(0,Math.min(1,(L-O.left)/O.width))*10,oe=Math.round(X/g)*g;l(parseFloat(oe.toFixed(2)))},_=()=>{V(!1)};b.useEffect(()=>{if(R){const U=O=>I(O),N=()=>_();return document.addEventListener("mousemove",U),document.addEventListener("mouseup",N),document.addEventListener("touchmove",U),document.addEventListener("touchend",N),()=>{document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",N),document.removeEventListener("touchmove",U),document.removeEventListener("touchend",N)}}},[R,g,k]);const T=async()=>{const U=Date.now()-p,N=parseFloat(a),O=Math.abs(N-s),L=`g2t${t}`,W=localStorage.getItem(`lastAIHelp_${L}`);if(W){const Ce=JSON.parse(W),xe=Date.now()-Ce.timestamp,fe=N===Ce.suggestion?"accepted":"modified";await je.trackAIHelpResponse(L,Ce.type,Ce.suggestion,fe,N,xe),localStorage.removeItem(`lastAIHelp_${L}`)}let X=0;O===0?X=2:O<=1?X=1:X=0,v.current+=1,await je.trackTaskAttempt(L,v.current,!0,U,N,s);const oe=localStorage.getItem("sessionId");if(oe&&!oe.startsWith("offline-"))try{await Kn(cn(tt,"sessions",oe),{[`taskDifferences.g2t${t}`]:O,[`taskTimes.g2t${t}`]:U,[`taskPoints.g2t${t}`]:X,lastActivity:hn()})}catch(Ce){console.error("Error storing difference:",Ce)}h(X===2?" Perfect! 2 points earned!":X===1?` Off by ${O.toFixed(2)} - 1 point earned!`:` Off by ${O.toFixed(2)} - 0 points earned.`),setTimeout(()=>{e(`g2t${t}`,{attempts:v.current,totalTime:U,accuracy:X===2?100:X===1?70:0,userAnswer:N,correctAnswer:s,points:X})},500)},x=er.generateSliderPattern(t),te=x.difficultyLabel,re=x.difficulty,Y=()=>{const U=[];for(let N=0;N<=10;N++)U.push(d.jsxs("div",{style:{position:"absolute",left:`${N*10}%`,transform:"translateX(-50%)",textAlign:"center"},children:[d.jsx("div",{style:{width:"2px",height:"12px",background:"#666",margin:"0 auto"}}),d.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:N})]},N));return U};return d.jsxs("div",{className:`task slider ${k?"ai-controlled":""}`,children:[d.jsxs("h3",{children:["Material Creation - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${re}`,children:te}),d.jsxs("p",{className:"instruction",children:["Move the slider to:"," ",d.jsx("strong",{className:"target-value","data-target-value":s,children:s}),d.jsx("br",{}),d.jsx("span",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:!z&&"Hold and drag the slider handle to move it"})]}),d.jsxs("div",{className:"slider-container",children:[d.jsxs("div",{className:"range-labels",children:[d.jsx("span",{children:"0"}),d.jsx("span",{children:"10"})]}),d.jsxs("div",{style:{position:"relative",padding:"20px 0 30px 0"},children:[d.jsx("div",{style:{position:"absolute",width:"100%",height:"20px",top:"0"},children:Y()}),d.jsx("div",{style:{position:"relative",marginTop:"20px"},children:d.jsx("input",{ref:S,type:"range",min:"0",max:"10",step:g,value:a,onChange:U=>{!R&&!k&&(l(parseFloat(U.target.value)),B(!0))},className:"slider-input",style:{width:"100%",cursor:R?"grabbing":"grab"},onMouseDown:E,onTouchStart:E})})]}),d.jsx("div",{className:"current-value",children:w?parseFloat(a).toFixed(n?0:x.precision):"??"})]}),d.jsx("button",{onClick:T,className:"submit-btn",disabled:k,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function Cd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=b.useState(""),[a,l]=b.useState(""),[u,h]=b.useState(null),[p]=b.useState(Date.now()),[g,m]=b.useState(""),[w,C]=b.useState(!1),P=b.useRef(0),M=z=>{const B=document.createElement("canvas"),S=B.getContext("2d");return B.width=600,B.height=150,S.fillStyle="#f5f5f5",S.fillRect(0,0,B.width,B.height),S.font='bold 40px "Courier New", monospace',S.fillStyle="#333",S.textAlign="center",S.textBaseline="middle",S.fillText(z,B.width/2,B.height/2),B.toDataURL()};b.useEffect(()=>{const B=er.generateTypingPattern(t).pattern;i(B);const S=M(B);m(S)},[t]),b.useEffect(()=>{l(""),h(null),P.current=0},[t]),b.useEffect(()=>{const z=B=>{const{action:S,text:v,typeSpeed:E}=B.detail;if(S==="autoType"&&v){C(!0),l("");let I="",_=0;const T=setInterval(()=>{_<v.length?(I+=v[_],l(I),_++):(clearInterval(T),C(!1))},E||50);return()=>clearInterval(T)}};return window.addEventListener("aiTypingHelp",z),()=>window.removeEventListener("aiTypingHelp",z)},[]);const k=async()=>{const z=Date.now()-p,B=`g3t${t}`,S=localStorage.getItem(`lastAIHelp_${B}`);if(S){const T=JSON.parse(S),x=Date.now()-T.timestamp,te=a===T.suggestion?"accepted":"modified";await je.trackAIHelpResponse(B,T.type,T.suggestion,te,a,x),localStorage.removeItem(`lastAIHelp_${B}`)}const E=((T,x)=>{const te=T.length,re=x.length,Y=Array(te+1).fill(null).map(()=>Array(re+1).fill(0));for(let U=0;U<=te;U++)Y[U][0]=U;for(let U=0;U<=re;U++)Y[0][U]=U;for(let U=1;U<=te;U++)for(let N=1;N<=re;N++)T[U-1]===x[N-1]?Y[U][N]=Y[U-1][N-1]:Y[U][N]=Math.min(Y[U-1][N]+1,Y[U][N-1]+1,Y[U-1][N-1]+1);return Y[te][re]})(a,s);let I=0;E===0?I=2:E===1?I=1:I=0,P.current+=1,await je.trackTaskAttempt(B,P.current,!0,z,a,s);const _=localStorage.getItem("sessionId");if(_&&!_.startsWith("offline-"))try{await Kn(cn(tt,"sessions",_),{[`taskAccuracies.g3t${t}`]:I===2?100:I===1?70:0,[`taskTimes.g3t${t}`]:z,[`taskPoints.g3t${t}`]:I,lastActivity:hn()})}catch(T){console.error("Error storing accuracy:",T)}h(I===2?" Perfect! 2 points earned!":I===1?" 1 typo - 1 point earned!":` ${E} errors - 0 points earned.`),setTimeout(()=>{e(`g3t${t}`,{attempts:P.current,totalTime:z,accuracy:I===2?100:I===1?70:0,userAnswer:a,correctAnswer:s,points:I})},500)},A=er.generateTypingPattern(t),R=A.difficultyLabel,V=A.difficulty;return d.jsxs("div",{className:"task typing",style:{maxWidth:"100%"},children:[d.jsxs("h3",{children:["Student Engagement - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${V}`,children:R}),d.jsx("p",{className:"instruction",children:"Type this pattern exactly:"}),d.jsxs("div",{className:"pattern-display",children:[d.jsx("div",{className:"typing-pattern","data-typing-pattern":s,style:{display:"none"},children:s}),g?d.jsx("img",{src:g,alt:"Pattern to type",style:{width:"100%",maxWidth:"600px",height:"auto",userSelect:"none",pointerEvents:"none"},onContextMenu:z=>z.preventDefault(),draggable:!1}):d.jsx("span",{className:"pattern-text",children:s})]}),d.jsx("div",{className:"input-section",style:{width:"90%",maxWidth:"900px",margin:"20px auto 0"},children:d.jsx("input",{type:"text",inputMode:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:a,onChange:z=>!w&&l(z.target.value),onKeyPress:z=>{z.key==="Enter"&&!w&&(z.preventDefault(),k())},placeholder:"Type here...",className:"typing-input",disabled:w,style:{backgroundColor:w?"#e3f2fd":"white",transition:"background-color 0.3s",width:"100%",maxWidth:"100%",fontFamily:'"Courier New", monospace',fontSize:"28px",padding:"12px 14px",border:"2px solid #e0e0e0",borderRadius:"8px",boxSizing:"border-box"}})}),d.jsx("button",{onClick:k,className:"submit-btn",disabled:w,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function gI({practiceCompleted:t={},onPracticeComplete:e,onStartMainGame:n,onSelectPractice:r,isAdmin:s=!1}){const[i,a]=b.useState(null),l=(m,w)=>{if(w&&w.points===2){typeof e=="function"&&e(m,w);const C=document.createElement("div");C.className="notification-enter",C.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",C.textContent="Perfect! Practice task completed. Returning to menu...",document.body.appendChild(C),setTimeout(()=>{a(null),document.body.contains(C)&&document.body.removeChild(C)},1500)}else{const C=(w==null?void 0:w.points)||0,P=document.createElement("div");P.className="notification-enter",P.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #ff9800; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",P.textContent=`Practice requires 100% accuracy. You scored ${C===1?"50%":"0%"}. Try again!`,document.body.appendChild(P),setTimeout(()=>{document.body.contains(P)&&document.body.removeChild(P)},3e3)}},u=t.g2t1&&t.g1t1&&t.g3t1,h=()=>d.jsxs("div",{className:"practice-menu",children:[d.jsxs("h2",{children:["Practice Mode ",!s&&"(Required)"]}),!s&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",borderRadius:"12px",padding:"16px",marginBottom:"25px",border:"2px solid #f57c00",boxShadow:"0 4px 6px rgba(245, 124, 0, 0.1)",textAlign:"center"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:""}),d.jsx("strong",{style:{color:"#e65100",fontSize:"18px"},children:"100% PERFECT ACCURACY REQUIRED"})]}),d.jsxs("div",{style:{color:"#e65100",fontSize:"14px"},children:["You must score 2/2 points (exact answer) on all three practice tasks to proceed.",d.jsx("br",{}),d.jsx("strong",{children:"No partial credit in practice mode!"})]}),d.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"12px"},children:[d.jsxs("span",{style:{padding:"4px 12px",background:t.g2t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g2t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g2t1?"#4CAF50":"#ffb74d"}`},children:["Materials ",t.g2t1?"":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g1t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g1t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g1t1?"#4CAF50":"#ffb74d"}`},children:["Research ",t.g1t1?"":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g3t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g3t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g3t1?"#4CAF50":"#ffb74d"}`},children:["Engagement ",t.g3t1?"":"Required"]})]})]}),d.jsx("p",{className:"practice-hint",style:{textAlign:"center",fontSize:"16px",color:"#666",marginBottom:"30px"},children:"Try each task type before starting the main challenge. No time pressure!"}),d.jsxs("div",{className:"practice-cards",children:[d.jsxs("div",{className:"practice-card materials",children:[d.jsx("h3",{children:" Materials"}),d.jsx("p",{children:"Hold and drag slider to match target values"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Base points - directly added to score"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g2t1"),r&&r("g2t1")},className:t.g2t1?"completed":"",disabled:!1,children:t.g2t1?" Completed":"Try Materials"})})]}),d.jsxs("div",{className:"practice-card research",children:[d.jsx("h3",{children:" Research"}),d.jsx("p",{children:"Count words or letters in text passages"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 15% multiplier per point in main game"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g1t1"),r&&r("g1t1")},className:t.g1t1?"completed":"",disabled:!1,children:t.g1t1?" Completed":"Try Research"})})]}),d.jsxs("div",{className:"practice-card engagement",children:[d.jsx("h3",{children:" Engagement"}),d.jsx("p",{children:"Type patterns exactly as shown"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 0.15% compound interest per point"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g3t1"),r&&r("g3t1")},className:t.g3t1?"completed":"",disabled:!1,children:t.g3t1?" Completed":"Try Engagement"})})]})]}),d.jsxs("div",{style:{marginTop:"25px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h4",{style:{margin:"0 0 10px 0",color:"#333",fontSize:"16px"},children:"Practice Progress:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[d.jsxs("div",{style:{padding:"8px 15px",background:t.g2t1?"#4CAF50":"#e0e0e0",color:t.g2t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Materials ",t.g2t1&&""]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g1t1?"#9C27B0":"#e0e0e0",color:t.g1t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Research ",t.g1t1&&""]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g3t1?"#f44336":"#e0e0e0",color:t.g3t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Engagement ",t.g3t1&&""]})]}),d.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#666"},children:[d.jsx("strong",{children:"100% accuracy required"})," to complete each practice task"]})]}),d.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:d.jsx("button",{className:"start-main-game-btn",onClick:n,style:{opacity:!s&&!u?.5:1,cursor:!s&&!u?"not-allowed":"pointer"},disabled:!s&&!u,children:s?"Start Main Game (Admin)":u?"Start Main Game - You're Ready! ":"Complete Practice First"})})]});if(!i)return h();const p=i[1],g=1;return d.jsxs("div",{className:"practice-container",children:[d.jsx("button",{className:"back-to-menu",onClick:()=>a(null),children:" Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),d.jsxs("div",{className:"practice-task-wrapper",children:[p==="1"&&d.jsx(Id,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i}),p==="2"&&d.jsx(Ad,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i}),p==="3"&&d.jsx(Cd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i})]})]})}class yI{constructor(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={}}getUniversalAttemptNumber(){return this.totalAIUsage}shouldAIBeCorrect(e){let n;return e===1||e===2||e===4||e===5?n=!0:e===3?n=!1:n=Math.random()<.75,n}getTaskUsageCount(e){return this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]}incrementTaskUsage(e,n){this.totalAIUsage++,this.usageCount[n]++,this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]++}resetForNewSemester(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={},console.log(" AI Help usage reset for new semester")}helpWithSlider(e,n){this.incrementTaskUsage(n,"materials");const r=this.getUniversalAttemptNumber();let s;if(this.shouldAIBeCorrect(r))s=e;else if(r===3){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else if(Math.random()<.5){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else{const i=(Math.random()<.5?-1:1)*(2+Math.random()*2);s=Math.max(0,Math.min(10,e+i))}return{action:"moveSlider",value:s,animate:!0}}helpWithCounting(e,n,r){this.incrementTaskUsage(r,"research");const s=this.getUniversalAttemptNumber(),i=this.shouldAIBeCorrect(s);return n.length===1||n.includes(" and ")||n.includes(",")?this.helpWithLetterCounting(e,n,s,i):this.helpWithWordCounting(e,n,s,i)}helpWithLetterCounting(e,n,r,s){let i=[];n.includes(" and ")||n.includes(",")?i=n.match(/[a-z]/gi)||[]:i=[n];let a=0;i.forEach(h=>{const p=new RegExp(h,"gi"),g=e.match(p);a+=g?g.length:0});let l=a,u=[...i];if(!s){r===3||Math.random()<.5?l=a+1:l=a+Math.floor(Math.random()*3)+2,l=Math.max(0,l);const p="abcdefghijklmnopqrstuvwxyz".split("").filter(m=>!i.includes(m.toLowerCase())),g=Math.floor(Math.random()*2)+1;for(let m=0;m<g&&p.length>0;m++){const w=Math.floor(Math.random()*p.length);u.push(p[w]),p.splice(w,1)}}return{action:"highlightAndCount",highlightWords:[],suggestedCount:l,animate:!0,isMultiLetter:!0,targetLetters:u}}helpWithWordCounting(e,n,r,s){const i=e.split(/\s+/),a=[];let l=0,u=0;if(i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&u++}),s)i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&(a.push(h),l++)});else if(r===3){l=u+1,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());if(h.length>0&&a.length<l){const p=h[Math.floor(Math.random()*h.length)];a.push(p)}}else{Math.random()<.5?l=u+1:l=u+Math.floor(Math.random()*3)+2,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());for(;a.length<l&&h.length>0;){const p=Math.floor(Math.random()*h.length),g=h[p];a.includes(g)||a.push(g),h.splice(p,1)}}return{action:"highlightAndCount",highlightWords:a,suggestedCount:l,animate:!0}}helpWithTyping(e,n){this.incrementTaskUsage(n,"engagement");const r=this.getUniversalAttemptNumber();let s=e;const i={0:["o","O"],o:["0"],O:["0"],1:["l","I","i"],l:["1","I","i"],I:["1","l","i"],i:["1","l","I"],e:["3"],3:["e"],a:["@"],"@":["a"],s:["5","$"],S:["5","$"],5:["s","S"],$:["s","S"],g:["9"],9:["g"],b:["6"],6:["b"],z:["2"],2:["z"],B:["8"],8:["B"]},a=l=>{const u=l.split(""),h=u.map((p,g)=>i[p]?g:-1).filter(p=>p!==-1);if(h.length>0){const p=h[Math.floor(Math.random()*h.length)],g=u[p],m=i[g];m&&m.length>0&&(u[p]=m[Math.floor(Math.random()*m.length)])}else{const p=["transpose","duplicate","missing"],g=p[Math.floor(Math.random()*p.length)],m=Math.floor(Math.random()*u.length);switch(g){case"transpose":m<u.length-1&&([u[m],u[m+1]]=[u[m+1],u[m]]);break;case"duplicate":u.splice(m,0,u[m]);break;case"missing":u.splice(m,1);break}}return u.join("")};if(this.shouldAIBeCorrect(r))s=e;else if(r===3)s=a(e);else if(Math.random()<.5)s=a(e);else{let l=e;const u=Math.floor(Math.random()*3)+2;for(let h=0;h<u;h++)l=a(l);s=l}return{action:"autoType",text:s,typeSpeed:50,perfect:this.shouldAIBeCorrect(r)}}}const kt=new yI;function vI({bonusPrompts:t=0,currentTask:e="",categoryPoints:n=null,timeRemaining:r=null,calculateStudentLearning:s=()=>0}){const[i,a]=b.useState(!0),[l,u]=b.useState(0),[h,p]=b.useState(!1);b.useEffect(()=>{const T=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");a(T.hasAI!==!1)},[]),b.useEffect(()=>{if(e){const T=kt.getTaskUsageCount(e)>=1;p(T)}},[e]),b.useEffect(()=>{const T=()=>{u(kt.totalAIUsage)},x=setInterval(T,1e3);return T(),()=>clearInterval(x)},[]);const[g,m]=b.useState([{sender:"bot",text:i?"Hello! I'm your AI teaching assistant. You get ONE AI help attempt per task - use it wisely!":"Hello! This is the chat interface. AI assistance is not available for this session."}]),[w,C]=b.useState(""),[P,M]=b.useState(!1),[k,A]=b.useState({materials:0,research:0,engagement:0}),R=b.useRef(null),V=()=>e?e.startsWith("g1")?"research":e.startsWith("g2")?"materials":e.startsWith("g3")?"engagement":null:null,z=(T=null)=>{const x=T||V();if(!x){m(Y=>[...Y,{sender:"bot",text:"Please start a task first, then I can help you!"}]);return}if(kt.getTaskUsageCount(e)>=1){m(Y=>[...Y,{sender:"bot",text:" You've already used AI help for this task. Only 1 AI attempt allowed per task!"}]);return}const re=Date.now();if(re-k[x]<3e3){m(Y=>[...Y,{sender:"bot",text:"Please wait a moment before requesting help again!"}]);return}switch(A(Y=>({...Y,[x]:re})),x){case"materials":B();break;case"research":S();break;case"engagement":E();break;default:m(Y=>[...Y,{sender:"bot",text:"I'm not sure which task you're on. Please try again!"}])}},B=()=>{var Y,U;const T=((Y=document.querySelector("[data-target-value]"))==null?void 0:Y.getAttribute("data-target-value"))||((U=document.querySelector(".target-value"))==null?void 0:U.textContent)||5,x=kt.helpWithSlider(parseFloat(T),e),te=kt.getUniversalAttemptNumber(),re=kt.shouldAIBeCorrect(te);je.trackAITaskHelp(e,"slider",x.value,re,te),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"slider",suggestion:x.value,timestamp:Date.now(),wasCorrect:re})),window.dispatchEvent(new CustomEvent("aiSliderHelp",{detail:x})),u(kt.totalAIUsage),p(!0),m(N=>[...N,{sender:"bot",text:` Helping with materials...
Suggested value: ${x.value.toFixed(2)}`}])},S=()=>{var te;const T=document.querySelector(".text-to-count"),x=document.querySelector(".count-target");if(T&&x){const re=T.getAttribute("data-counting-text")||"";let Y=((te=x.getAttribute("data-pattern"))==null?void 0:te.replace(/['"]/g,"").trim())||"";const U=kt.helpWithCounting(re,Y,e),N=U.suggestedCount;window.dispatchEvent(new CustomEvent("aiCountingHelp",{detail:U}));const O=kt.getUniversalAttemptNumber(),L=kt.shouldAIBeCorrect(O);je.trackAITaskHelp(e,"counting",N,L,O),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"counting",suggestion:N,timestamp:Date.now(),wasCorrect:L,highlightedWords:U.highlightWords||[],targetLetters:U.targetLetters||[]})),u(kt.totalAIUsage),p(!0);const W=U.isMultiLetter?"letters/characters":"words";m(X=>[...X,{sender:"bot",text:` Helping with research...
Found ${N} ${W}`}])}},v=()=>{const T=[" CRITICAL STRATEGY: Do tasks in this EXACT order  1 Engagement (builds interest from the start) 2 Research (multiplies future materials) 3 Materials (gets all multipliers). Materials done early = WASTED points!"," MAXIMUM SCORE ORDER: Engagement FIRST  Research SECOND  Materials LAST! Why? Engagement compounds every task, Research only multiplies FUTURE materials. Doing materials early gets ZERO multiplier!"," WARNING: Research multipliers ONLY apply to materials earned AFTER! If you do materials first, you get NO bonus. Always do ALL engagement & research before touching ANY materials!"," PRO TIP: Complete 100% of Engagement tasks first (builds interest early), then 100% of Research (sets up multipliers), THEN do Materials. This order can DOUBLE your score vs doing materials first!"," OPTIMAL PATH: Think of it like this - Engagement = compound interest (starts early), Research = multiplier (affects future only), Materials = base score (save for last). Wrong order = lost points forever!"],x=T[Math.floor(Math.random()*T.length)];m(te=>[...te,{sender:"bot",text:x}]),je.trackUserAction("planning_help_requested",{response:x,currentTask:e,timestamp:Date.now()})},E=()=>{const T=document.querySelector("[data-typing-pattern]");if(T){const x=T.getAttribute("data-typing-pattern");if(x){const te=kt.helpWithTyping(x,e),re=kt.getUniversalAttemptNumber(),Y=te.perfect;je.trackAITaskHelp(e,"typing",te.text,Y,re),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"typing",suggestion:te.text,timestamp:Date.now(),wasCorrect:Y,originalPattern:x})),window.dispatchEvent(new CustomEvent("aiTypingHelp",{detail:te})),u(kt.totalAIUsage),p(!0),m(U=>[...U,{sender:"bot",text:` Helping with engagement...
Typing: "${te.text.substring(0,30)}${te.text.length>30?"...":""}"`}])}}else m(x=>[...x,{sender:"bot",text:"Please navigate to the engagement tab first!"}])},I=()=>{if(!w.trim())return;if(!i){m(te=>[...te,{sender:"user",text:w},{sender:"bot",text:"AI assistance is not available for this session."}]),C("");return}const T=w.toLowerCase().trim(),x=w;m(te=>[...te,{sender:"user",text:w}]),C(""),M(!0),setTimeout(()=>{let te="",re="general";if(T.includes("help"))if(re="help_request",T.includes("material")||T.includes("slider")){z("materials"),M(!1);return}else if(T.includes("research")||T.includes("count")){z("research"),M(!1);return}else if(T.includes("engagement")||T.includes("typ")){z("engagement"),M(!1);return}else te="Click the help buttons below for task assistance!";else if(T.includes("strategy")||T.includes("plan")||T.includes("order")){re="strategy";const Y=[" CRITICAL STRATEGY: Do tasks in this EXACT order  1 Engagement (builds interest from the start) 2 Research (multiplies future materials) 3 Materials (gets all multipliers). Materials done early = WASTED points!"," MAXIMUM SCORE ORDER: Engagement FIRST  Research SECOND  Materials LAST! Why? Engagement compounds every task, Research only multiplies FUTURE materials. Doing materials early gets ZERO multiplier!"," WARNING: Research multipliers ONLY apply to materials earned AFTER! If you do materials first, you get NO bonus. Always do ALL engagement & research before touching ANY materials!"," PRO TIP: Complete 100% of Engagement tasks first (builds interest early), then 100% of Research (sets up multipliers), THEN do Materials. This order can DOUBLE your score vs doing materials first!"," OPTIMAL PATH: Think of it like this - Engagement = compound interest (starts early), Research = multiplier (affects future only), Materials = base score (save for last). Wrong order = lost points forever!"];te=Y[Math.floor(Math.random()*Y.length)]}else if(T.includes("tip")||T.includes("advice"))re="advice",te="Strategic tip: Do Research tasks first for the multiplier effect, then Materials for base points, finally Engagement for compound interest!";else{const Y=["Keep pushing! You're doing great!","Remember: Materials  Research  Engagement = Success!","Focus on accuracy for those 2-point rewards!",`The checkpoint at minute ${(()=>{const N=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").semesterDuration||12e5,O=Math.floor(N/2e3);return Math.floor(O/60)})()} can give huge bonuses!`,"Try the help buttons below for task assistance!"];te=Y[Math.floor(Math.random()*Y.length)]}je.trackUserAction("chat_message",{query:x,queryType:re,response:te,currentTask:e,categoryPoints:n,studentLearning:s(),aiUsageCount:kt.totalAIUsage}),m(Y=>[...Y,{sender:"bot",text:te}]),M(!1)},800)},_=V();return d.jsxs("div",{className:"chat-container-sidebar",style:{height:"100%",display:"flex",flexDirection:"column"},children:[d.jsxs("div",{className:"chat-header",children:[d.jsx("h3",{children:i?"AI Teaching Assistant":"Chat Interface"}),d.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"2px"},children:i?"1 AI help per task (reliability varies)":"AI assistance disabled for this session"}),d.jsxs("div",{style:{marginTop:"10px",padding:"8px",background:"#e3f2fd",borderRadius:"6px",border:"1px solid #2196F3"},children:[d.jsxs("div",{style:{fontSize:"12px",color:"#1976d2",fontWeight:"bold"},children:["Student Learning: ",Math.round(s())," pts"]}),d.jsxs("div",{style:{fontSize:"10px",color:"#666",marginTop:"2px"},children:[n.materials||0," "," ",(1+(n.research||0)*.15).toFixed(2)," + Interest"]})]})]}),d.jsxs("div",{className:"messages-sidebar",children:[g.map((T,x)=>d.jsxs("div",{className:`message ${T.sender}`,children:[d.jsxs("div",{className:"message-sender",children:[T.sender==="user"?"You":i?"AI":"System",":"]}),d.jsx("div",{className:"message-text",children:T.text})]},x)),P&&i&&d.jsxs("div",{className:"message bot",children:[d.jsx("div",{className:"message-sender",children:"AI:"}),d.jsx("div",{className:"message-text typing",children:"..."})]}),d.jsx("div",{ref:R})]}),d.jsxs("div",{className:"chat-input-sidebar",children:[d.jsx("input",{type:"text",placeholder:i?"Ask about strategy and tips here...":"Chat disabled - no AI available",value:w,onChange:T=>C(T.target.value),onKeyPress:T=>T.key==="Enter"&&I(),disabled:!i}),d.jsx("button",{onClick:I,disabled:!w.trim()||!i,children:"Send"})]}),i&&d.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f8f9fa"},children:[d.jsxs("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:["AI Usage: ",l," total attempts",h&&d.jsxs("span",{style:{color:"#ff9800",fontWeight:"bold"},children:[" ","| Current task: 1/1 used"]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"10px"},children:[d.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[d.jsxs("button",{onClick:()=>z(),disabled:!_||h,style:{padding:"12px",background:h?"#ff9800":_?"#2196F3":"#ccc",color:"white",border:"none",borderRadius:"8px",cursor:_&&!h?"pointer":"not-allowed",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[d.jsx("span",{style:{fontSize:"18px"},children:""}),h?"AI Used (1/1)":_?"Help Task":"Start task first"]}),d.jsxs("button",{onClick:v,style:{padding:"12px",background:"#FF9800",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[d.jsx("span",{style:{fontSize:"18px"},children:""}),"Help Plan"]})]}),d.jsx("button",{onClick:()=>z("research"),disabled:!e.startsWith("g1")||h,style:{padding:"10px",background:e.startsWith("g1")&&!h?"#9C27B0":h&&e.startsWith("g1")?"#ff9800":"#e0e0e0",color:e.startsWith("g1")||h?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g1")&&!h?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Research"}),d.jsx("button",{onClick:()=>z("materials"),disabled:!e.startsWith("g2")||h,style:{padding:"10px",background:e.startsWith("g2")&&!h?"#4CAF50":h&&e.startsWith("g2")?"#ff9800":"#e0e0e0",color:e.startsWith("g2")||h?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g2")&&!h?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Materials"}),d.jsx("button",{onClick:()=>z("engagement"),disabled:!e.startsWith("g3")||h,style:{padding:"10px",background:e.startsWith("g3")&&!h?"#f44336":h&&e.startsWith("g3")?"#ff9800":"#e0e0e0",color:e.startsWith("g3")||h?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g3")&&!h?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Engage"})]}),d.jsx("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:_?d.jsx("span",{style:{color:"#4CAF50"},children:" AI ready to help"}):d.jsx("span",{style:{color:"#999"},children:" Navigate to a task to enable AI help"})})]}),!i&&d.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f5f5f5",textAlign:"center",color:"#666",fontSize:"14px"},children:[d.jsx("div",{style:{marginBottom:"5px"},children:" No AI Assistant"}),d.jsx("div",{style:{fontSize:"12px"},children:"Complete tasks using your own judgment"})]})]})}const Ll={generateCode(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`${t}-${e}`.toUpperCase()},async createCode(t={}){return{success:!0,code:this.generateCode(),data:t}},async markCodeAsUsed(t,e){if(!t)return{success:!1,error:"No code provided"};try{const n={code:t,status:"used",usedAt:hn(),sessionId:e,createdAt:hn()};return await sI(cn(tt,"accessCodes",t),n),{success:!0}}catch(n){return console.error("Error marking code as used:",n),{success:!1,error:n.message}}},async checkCodeUsage(t){if(!t)return{used:!1};try{const e=await rI(cn(tt,"accessCodes",t));if(e.exists()){const n=e.data();return{used:n.status==="used",sessionId:n.sessionId,usedAt:n.usedAt}}return{used:!1}}catch(e){return console.error("Error checking code usage:",e),{used:!1,error:e.message}}},getCodeFromURL(){const t=new URLSearchParams(window.location.search);return t.get("code")||t.get("c")||null},async verifyQualtricsCode(t){return{valid:!1,reason:"Qualtrics codes not yet supported"}}};function _I({onLoginSuccess:t}){const[e,n]=b.useState(""),[r,s]=b.useState(!1),[i,a]=b.useState(""),[l,u]=b.useState(!1),h={"ADMIN-MASTER":{role:"master_admin",name:"Master Administrator",hasAI:!1,isMasterInterface:!0},...Array.from({length:10},(w,C)=>({[`ADMIN-TEST${C+1}`]:{role:"test",semesterDuration:72e4,name:`Test User ${C+1}`,hasAI:!0,checkpointSemester2:!0,isTestCode:!0}})).reduce((w,C)=>({...w,...C}),{}),"ADMIN-REGULAR":{role:"admin",semesterDuration:72e4,name:"Admin Regular Mode",hasAI:!0,checkpointSemester2:!0},"ADMIN-FAST":{role:"admin",semesterDuration:12e4,name:"Admin Fast Mode",hasAI:!0,checkpointSemester2:!0},"ADMIN-1-CP":{role:"admin",semesterDuration:12e4,name:"Admin Section 1 WITH Checkpoint",hasAI:!1,checkpointSemester2:!0},"ADMIN-1-NCP":{role:"admin",semesterDuration:12e4,name:"Admin Section 1 NO Checkpoint",hasAI:!1,checkpointSemester2:!1},"ADMIN-2-CP":{role:"admin",semesterDuration:12e4,name:"Admin Section 2 WITH Checkpoint",hasAI:!0,checkpointSemester2:!0},"ADMIN-2-NCP":{role:"admin",semesterDuration:12e4,name:"Admin Section 2 NO Checkpoint",hasAI:!0,checkpointSemester2:!1}},p=w=>({section:"TESTING-AI-CP",hasAI:!0,checkpointSemester2:!0,displayName:`${w} (Internal Tester - AI + Checkpoint)`}),g=w=>{if(h[w])return{valid:!0,type:"master",data:h[w]};const C=w.trim().replace(/[^a-zA-Z0-9\s\-_]/g,"");return C.length<2?{valid:!1,error:"Please enter a name with at least 2 characters"}:C.length>50?{valid:!1,error:"Name too long. Please use 50 characters or less"}:{valid:!0,type:"tester",condition:p(C),cleanName:C}},m=async w=>{if(w.preventDefault(),!e.trim()){a("Please enter your name");return}s(!0),a("");try{const C=g(e.trim());if(!C.valid){a(C.error||"Invalid Student ID"),s(!1);return}let P={timestamp:new Date().toISOString()};if(C.type==="master"){if(P={...P,studentIdentifier:e,role:C.data.role,semesterDuration:C.data.semesterDuration,displayName:C.data.name,section:C.data.isTestCode?"ADMIN-TEST":"ADMIN",hasAI:C.data.hasAI,checkpointSemester2:C.data.checkpointSemester2,isMasterCode:!0,isTestCode:C.data.isTestCode||!1,isMasterInterface:C.data.isMasterInterface||!1},C.data.isMasterInterface){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",displayName:C.data.name,section:"master_admin",hasAI:!0,checkpointSemester2:!0})),window.location.href=`${window.location.origin}?master=true`;return}}else if(C.type==="tester"){const k=C.condition,A=C.cleanName;P={...P,studentIdentifier:A,role:"tester",semesterDuration:72e4,displayName:k.displayName,section:k.section,hasAI:k.hasAI,checkpointSemester2:k.checkpointSemester2,isMasterCode:!1,isTestUser:!0}}const M=await Ll.createCode(P);M.success?(sessionStorage.setItem("gameConfig",JSON.stringify({semesterDuration:P.semesterDuration,role:P.role,studentId:P.studentIdentifier,displayName:P.displayName,section:P.section,hasAI:P.hasAI,checkpointSemester2:P.checkpointSemester2})),window.location.href=`${window.location.origin}?code=${M.code}`):a("Failed to generate access code. Please try again.")}catch(C){console.error("Login error:",C),a("System error. Please try again.")}finally{s(!1)}};return d.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",padding:"20px"},children:[d.jsxs("div",{style:{background:"white",padding:"48px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",maxWidth:"480px",width:"100%"},children:[d.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[d.jsxs("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a202c",marginBottom:"8px",lineHeight:"1.2"},children:["Scheduling Challenge:",d.jsx("br",{}),"Can you beat Park?"]}),d.jsx("p",{style:{fontSize:"16px",color:"#718096",marginTop:"12px"},children:"Enter your name to access the game"})]}),d.jsxs("form",{onSubmit:m,children:[d.jsxs("div",{style:{marginBottom:"24px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#2d3748",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.025em"},children:"Your Name:"}),d.jsx("input",{type:"text",value:e,onChange:w=>n(w.target.value),disabled:r,style:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e2e8f0",borderRadius:"8px",boxSizing:"border-box",fontFamily:"'SF Mono', Monaco, 'Courier New', monospace",transition:"all 0.2s ease",background:"#f7fafc",outline:"none"},onFocus:w=>{w.target.style.borderColor="#2196F3",w.target.style.background="white",w.target.style.boxShadow="0 0 0 3px rgba(33, 150, 243, 0.1)"},onBlur:w=>{w.target.style.borderColor="#e2e8f0",w.target.style.background="#f7fafc",w.target.style.boxShadow="none"}}),d.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"#a0aec0",lineHeight:"1.4"},children:"Enter your first and last name (2-50 characters)"})]}),i&&d.jsxs("div",{style:{background:"#fed7d7",color:"#c53030",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",fontSize:"14px",display:"flex",alignItems:"center",border:"1px solid #fc8181"},children:[d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",style:{marginRight:"8px",flexShrink:0},children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i]}),d.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:"600",background:r?"#cbd5e0":"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:r?"none":"0 4px 6px rgba(33, 150, 243, 0.25)",transform:r?"none":"translateY(0)"},onMouseDown:w=>{r||(w.target.style.transform="translateY(2px)",w.target.style.boxShadow="0 2px 4px rgba(33, 150, 243, 0.25)")},onMouseUp:w=>{r||(w.target.style.transform="translateY(0)",w.target.style.boxShadow="0 4px 6px rgba(33, 150, 243, 0.25)")},onMouseOver:w=>{r||(w.target.style.background="#1976D2")},onMouseOut:w=>{r||(w.target.style.background="#2196F3")},children:r?d.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[d.jsxs("svg",{className:"animate-spin",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px",animation:"spin 1s linear infinite"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",strokeOpacity:"0.25"}),d.jsx("path",{d:"M4 12a8 8 0 018-8",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),"Verifying Name..."]}):"Access Game"})]}),d.jsxs("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[d.jsx("p",{style:{fontSize:"14px",color:"#718096",marginBottom:"12px"},children:"Having trouble? Contact your instructor:"}),d.jsxs("p",{style:{fontSize:"16px",color:"#2196F3",fontWeight:"500"},children:["Park Sinchaisri",d.jsx("br",{}),d.jsx("a",{href:"mailto:parksinchaisri@haas.berkeley.edu",style:{color:"#2196F3",textDecoration:"none",borderBottom:"1px solid #2196F3",fontSize:"15px"},children:"parksinchaisri@haas.berkeley.edu"})]}),l&&d.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#f7fafc",borderRadius:"8px",fontSize:"11px",color:"#4a5568",lineHeight:"1.8"},children:[d.jsx("strong",{children:"Test Codes:"}),d.jsxs("div",{style:{marginTop:"8px",fontFamily:"monospace"},children:[d.jsx("div",{children:"ADMIN-TEST1 to ADMIN-TEST10 (Test users)"}),d.jsx("div",{children:"ADMIN-1-CP (No AI, With Checkpoint)"}),d.jsx("div",{children:"ADMIN-1-NCP (No AI, No Checkpoint)"}),d.jsx("div",{children:"ADMIN-2-CP (AI, With Checkpoint)"}),d.jsx("div",{children:"ADMIN-2-NCP (AI, No Checkpoint)"}),d.jsx("div",{children:"ADMIN-REGULAR (Original)"}),d.jsx("div",{children:"ADMIN-FAST (2 min test)"}),d.jsx("div",{children:"ADMIN-MASTER (Master interface)"})]})]})]})]}),d.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const $m={async checkDailyLimit(t){var r;if(!t)return{allowed:!0};const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);try{const s=Qn(tt,"sessions"),i=Xi(s,Ed("studentId","==",t),Ed("startTime",">=",n)),a=await Ms(i);if(!a.empty){const l=a.docs[0].data(),u=(r=l.startTime)!=null&&r.toDate?l.startTime.toDate():new Date(l.clientStartTime);return{allowed:!1,reason:"daily_limit",existingSession:l,nextAvailable:new Date(n.getTime()+24*60*60*1e3)}}return{allowed:!0}}catch(s){console.error("Error checking daily limit:",s);const i=`played_${t}_${n.toISOString().split("T")[0]}`;return localStorage.getItem(i)?{allowed:!1,reason:"daily_limit",nextAvailable:new Date(n.getTime()+24*60*60*1e3)}:{allowed:!0}}},async markDailyPlay(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=`played_${t}_${n.toISOString().split("T")[0]}`;localStorage.setItem(r,"true");const s=new Date(Date.now()-7*24*60*60*1e3);for(let i=0;i<localStorage.length;i++){const a=localStorage.key(i);if(a&&a.startsWith("played_")){const l=a.split("_")[2];l&&new Date(l)<s&&localStorage.removeItem(a)}}},async checkAccess(){try{const t=Ll.getCodeFromURL();if(!t)return{allowed:!1,reason:"Please login with your student ID",requiresCode:!0};const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),n=e.role==="admin"||e.role==="master_admin";if(!n&&e.studentId){const r=await this.checkDailyLimit(e.studentId);if(!r.allowed&&!r.refreshGranted){const i=r.nextAvailable;return{allowed:!1,reason:`You have already completed today's session. Please come back in ${Math.ceil((i-Date.now())/(1e3*60*60))} hours (after midnight).`,dailyLimitReached:!0,nextAvailable:i}}if(sessionStorage.getItem("activeSessionId"))return{allowed:!1,reason:"Page refresh is not allowed during the game. Your session has been terminated.",refreshAttempt:!0}}return e.studentId?(n||await this.markDailyPlay(e.studentId),{allowed:!0,newSession:!0,code:t,codeData:{status:"new",metadata:e},isAdmin:n}):{allowed:!1,reason:"Please login with your Berkeley student ID",requiresCode:!0}}catch(t){console.error("Error in checkAccess:",t);const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");return e.role==="admin"?{allowed:!0,newSession:!0,code:Ll.getCodeFromURL(),codeData:{status:"error_bypass",metadata:e},isAdmin:!0}:{allowed:!1,reason:"System error. Please try again.",requiresCode:!0}}},async createSession(t=null,e=null,n=!1){try{const r=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),s=r.role==="admin"||r.role==="master_admin",i={id:crypto.randomUUID(),accessCode:t,studentId:r.studentId||null,role:r.role||"student",semesterDuration:r.semesterDuration||72e4,displayName:r.displayName||"Student",startTime:hn(),clientStartTime:new Date().toISOString(),status:"active",completedTasks:{},isPractice:n,isAdminSession:s,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`,section:r.section,hasAI:r.hasAI,checkpointSemester2:r.checkpointSemester2},l=(await of(Qn(tt,"sessions"),i)).id;return localStorage.setItem("sessionId",l),sessionStorage.setItem("activeSessionId",l),s||(window.addEventListener("beforeunload",u=>{u.preventDefault(),u.returnValue="Your progress will be lost if you leave this page.",this.handleSessionAbandonment()}),document.addEventListener("visibilitychange",()=>{!s&&document.hidden})),l}catch(r){console.error("Error creating session:",r);const s=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(s.role==="admin"){const i="offline-"+Date.now();localStorage.setItem("sessionId",i),sessionStorage.setItem("activeSessionId",i);const a={id:i,accessCode:t,startTime:Date.now(),status:"active",isOffline:!0,studentId:s.studentId||null,role:s.role||"admin"};return localStorage.setItem("offlineSession",JSON.stringify(a)),i}throw r}},async handleSessionAbandonment(){const t=localStorage.getItem("sessionId");if(t&&!t.startsWith("offline-"))try{await Kn(cn(tt,"sessions",t),{status:"abandoned",abandonedAt:hn(),abandonReason:"page_unload"})}catch(e){console.error("Error marking session as abandoned:",e)}sessionStorage.removeItem("activeSessionId"),sessionStorage.removeItem("gameConfig")}};function xI(){const[t,e]=b.useState(""),[n,r]=b.useState(!1),[s,i]=b.useState(""),[a,l]=b.useState(!1),u=async()=>{r(!0),i(""),l(!1);try{const p=await Ll.createCode({createdBy:"admin",timestamp:new Date().toISOString()});p.success?e(p.code):i("Failed to generate code: "+p.error)}catch(p){i("Error: "+p.message)}finally{r(!1)}},h=()=>{const p=`${window.location.origin}?code=${t}`;navigator.clipboard.writeText(p),l(!0),setTimeout(()=>l(!1),2e3)};return d.jsxs("div",{style:{padding:"40px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, -apple-system, sans-serif"},children:[d.jsx("h1",{style:{color:"#333",marginBottom:"10px"},children:"Admin Dashboard"}),d.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:"Generate access codes for participants"}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("button",{onClick:u,disabled:n,style:{padding:"12px 30px",fontSize:"16px",background:n?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:"bold"},children:n?"Generating...":"Generate New Access Code"}),t&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"white",borderRadius:"6px",border:"1px solid #e0e0e0"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Generated Code"}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Access Code:"}),d.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"18px",fontWeight:"bold"},children:t})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Full URL:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"stretch"},children:[d.jsx("input",{type:"text",value:`${window.location.origin}?code=${t}`,readOnly:!0,style:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",background:"#f9f9f9"}}),d.jsx("button",{onClick:h,style:{padding:"10px 20px",background:a?"#4CAF50":"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:a?" Copied!":"Copy URL"})]})]}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"4px",fontSize:"14px",color:"#1976d2"},children:[d.jsx("strong",{children:"Note:"})," This code is valid for 24 hours and can only be used once."]})]}),s&&d.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"#ffebee",color:"#c62828",borderRadius:"4px"},children:s})]}),d.jsxs("div",{style:{marginTop:"40px",padding:"20px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"How to use:"}),d.jsxs("ol",{style:{margin:"10px 0",paddingLeft:"20px"},children:[d.jsx("li",{children:"Generate a code using the button above"}),d.jsx("li",{children:"Copy the full URL"}),d.jsx("li",{children:"Share the URL with participants"}),d.jsx("li",{children:"Each participant can use their unique code once"})]})]})]})}function wI({sessionId:t,completedLevels:e,totalTime:n,gameMode:r}){const[s,i]=b.useState(""),[a,l]=b.useState(!1);b.useEffect(()=>{u()},[]);const u=()=>{const p=Date.now().toString(36).toUpperCase(),g=e.toString().padStart(2,"0"),m=r.limit==="time"?"T":"A",w=r.accuracy==="strict"?"S":"L",M=`GAME-${`${t}-${g}-${n}`.split("").reduce((k,A)=>k+A.charCodeAt(0),0).toString(36).toUpperCase().slice(-3)}-${g}-${m}${w}-${p}`;i(M)},h=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(s),l(!0),setTimeout(()=>l(!1),3e3);else{const p=document.createElement("textarea");p.value=s,p.style.position="fixed",p.style.top="0",p.style.left="0",p.style.width="2em",p.style.height="2em",p.style.padding="0",p.style.border="none",p.style.outline="none",p.style.boxShadow="none",p.style.background="transparent",p.style.opacity="0",document.body.appendChild(p),p.focus(),p.select();try{document.execCommand("copy")?(l(!0),setTimeout(()=>l(!1),3e3)):(console.error("Failed to copy using execCommand"),alert("Copy failed. Please manually select and copy the code."))}catch(g){console.error("Failed to copy:",g),alert("Copy failed. Please manually select and copy the code.")}document.body.removeChild(p)}}catch(p){console.error("Clipboard operation failed:",p),alert(`Copy failed. Here's your code to copy manually:

${s}`)}};return d.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"30px",marginTop:"30px",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},children:[d.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:" Your Completion Code"}),d.jsx("p",{style:{marginBottom:"20px",opacity:.9,fontSize:"16px"},children:"Copy this code and paste it into the Qualtrics survey to verify your completion:"}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"20px",marginBottom:"20px",backdropFilter:"blur(10px)"},children:[d.jsx("div",{style:{fontFamily:"monospace",fontSize:"28px",fontWeight:"bold",letterSpacing:"2px",marginBottom:"15px",wordBreak:"break-all",textShadow:"2px 2px 4px rgba(0,0,0,0.2)",userSelect:"text",cursor:"text"},onClick:p=>{const g=window.getSelection(),m=document.createRange();m.selectNodeContents(p.currentTarget),g.removeAllRanges(),g.addRange(m)},title:"Click to select all text",children:s}),d.jsx("button",{onClick:h,style:{padding:"12px 30px",fontSize:"16px",fontWeight:"bold",background:a?"#4CAF50":"white",color:a?"white":"#764ba2",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:a?" Copied!":" Copy Code"})]}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:"6px",padding:"15px",fontSize:"14px",lineHeight:"1.5"},children:[d.jsx("strong",{children:" Important:"})," This code is your proof of completion. Make sure to copy it before closing this window!",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"13px",opacity:.9},children:" Tip: If the Copy button doesn't work, click on the code text to select it, then use Ctrl+C (or Cmd+C on Mac) to copy."})]}),d.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[d.jsx("summary",{style:{cursor:"pointer",opacity:.8,fontSize:"12px",marginBottom:"10px"},children:"Code Details "}),d.jsxs("div",{style:{fontSize:"12px",opacity:.7,background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",fontFamily:"monospace"},children:[d.jsxs("div",{children:["Levels Completed: ",e,"/45"]}),d.jsxs("div",{children:["Game Mode: ",r.limit==="time"?"Time Challenge":"Task Attempts"]}),d.jsxs("div",{children:["Accuracy Mode: ",r.accuracy==="strict"?"Strict (100%)":"Lenient"]}),d.jsxs("div",{children:["Total Time: ",Math.floor(n/60),"m ",n%60,"s"]}),d.jsxs("div",{children:["Generated: ",new Date().toLocaleString()]})]})]})]})}function SI(){const[t,e]=b.useState([]),[n,r]=b.useState(!0),[s,i]=b.useState(null),[a,l]=b.useState(!1),[u,h]=b.useState(""),p=["3040748714","3040729812","3040859968","3040852909","3040869211","3040849958","3039838870","15177695","3040849997","3039845630","3040682661","26416809","3039850622","3040869510","3031977170","3040806629","3040848528","3039840443","3040848749","3040849893","3039850830","3039850713"],g=["3040850023","22900589","3039850570","3040882302","3040815651","3040701758","3040852077","3036343361","3040869458","3040705047","3040702343","3039842887","3040848593","3040702603","3039840222","3039840209","3040861190","18565110","3040869302","3040814338","3039754031"],m=["3040705476","3040697715","3039753992","3040729513","3040681595","3040850010","3032682772","3039842484","3040869445","3040814455","3039840781","3040696831","3040705125","3034184066","3039843004","3039842835","3040860072","3040871018","3039839026","3040814429","3040869094","3040748064","3040875945","3040701589","3040682193","3040729422","3040836165","21798975","3038626424","3039753017","3039840287","3040806382"],w=["25958106","3040814351","3040848697","3040684039","3040869289","22971551","3040837218","3040864570","3040705099","3034288430","3040848541","3040864531","3040869237","3032342054","3040682479","3039840170","3032397447","3039850856","3039840118","3040729552","3040683181","3040861073","3031968434","3040882575","3035320237","3040823815","3039842575","24261697","23420611","3032000089","3040882341"],C=_=>p.includes(_)?{section:"01A-Checkpoint",hasCheckpoint:!0,isAdmin:!1}:g.includes(_)?{section:"01A-No Checkpoint",hasCheckpoint:!1,isAdmin:!1}:m.includes(_)?{section:"02A-Checkpoint",hasCheckpoint:!0,isAdmin:!1}:w.includes(_)?{section:"02A-No Checkpoint",hasCheckpoint:!1,isAdmin:!1}:_.startsWith("ADMIN-TEST")?{section:"ADMIN-TEST",hasCheckpoint:!0,isAdmin:!0}:_.includes("ADMIN")||_.includes("admin")?{section:"ADMIN",hasCheckpoint:!1,isAdmin:!0}:{section:"Unknown",hasCheckpoint:!1,isAdmin:!1};b.useEffect(()=>{P()},[]);const P=async()=>{r(!0);try{const _=await Ms(Qn(tt,"sessions")),T=new Date,x=`${T.getFullYear()}-${String(T.getMonth()+1).padStart(2,"0")}-${String(T.getDate()).padStart(2,"0")}`,te=Xi(Qn(tt,"accessRefreshes"),Ed("refreshedAt",">=",new Date(x))),re=await Ms(te),Y=new Set;re.forEach(L=>{const W=L.data();Y.add(W.studentId)});const U={};_.forEach(L=>{var X;const W=L.data();if(W.role!=="master_admin"&&W.studentId){const oe=C(W.studentId);U[W.studentId]||(U[W.studentId]={studentId:W.studentId,sessions:[],latestAccess:null,totalAccesses:0,displayName:`Student ${W.studentId}`,section:oe.section,hasCheckpoint:oe.hasCheckpoint,hasPlayed:!0,isAdmin:oe.isAdmin,hasBeenRefreshedToday:Y.has(W.studentId)}),U[W.studentId].sessions.push({id:L.id,timestamp:(X=W.startTime)!=null&&X.toDate?W.startTime.toDate():new Date(W.clientStartTime),status:W.status,completedTasks:Object.keys(W.completedTasks||{}).length,finalScore:W.finalScore||0,currentSemester:W.currentSemester||1,timeElapsed:W.timeElapsed||W.totalTime||0})}}),Object.values(U).forEach(L=>{var W;L.sessions.sort((X,oe)=>oe.timestamp-X.timestamp),L.latestAccess=((W=L.sessions[0])==null?void 0:W.timestamp)||null,L.totalAccesses=L.sessions.length});const N=[];[...p,...g,...m,...w].forEach(L=>{if(U[L])N.push(U[L]);else{const W=C(L);N.push({studentId:L,sessions:[],latestAccess:null,totalAccesses:0,displayName:`Student ${L}`,section:W.section,hasCheckpoint:W.hasCheckpoint,hasPlayed:!1,isAdmin:W.isAdmin,hasBeenRefreshedToday:Y.has(L)})}}),N.sort((L,W)=>L.hasPlayed&&!W.hasPlayed?-1:!L.hasPlayed&&W.hasPlayed?1:L.latestAccess&&W.latestAccess?W.latestAccess-L.latestAccess:L.studentId.localeCompare(W.studentId)),e(N)}catch(_){console.error("Error loading student data:",_)}finally{r(!1)}},M=async _=>{l(!0);try{const x=new Date().toISOString().split("T")[0],te=`played_${_}_${x}`;localStorage.removeItem(te),await of(Qn(tt,"accessRefreshes"),{studentId:_,refreshedBy:"MASTER_ADMIN",refreshedAt:hn(),reason:"Manual refresh by admin"}),alert(`Access refreshed for student ${_}. They can now play again today.`),await P()}catch(T){console.error("Error refreshing access:",T),alert(`Failed to refresh access: ${T.message}`)}finally{l(!1)}},k=async()=>{if(confirm(` DANGER: This will permanently delete ALL student sessions, events, and access data.

This action cannot be undone. Are you absolutely sure?`)){l(!0);try{const _=Xi(Qn(tt,"sessions")),T=await Ms(_),x=T.docs.map(L=>sc(L.ref)),te=Xi(Qn(tt,"events")),re=await Ms(te),Y=re.docs.map(L=>sc(L.ref)),U=Xi(Qn(tt,"accessRefreshes")),N=await Ms(U),O=N.docs.map(L=>sc(L.ref));Object.keys(localStorage).forEach(L=>{L.startsWith("played_")&&localStorage.removeItem(L)}),await Promise.all([...x,...Y,...O]),alert(` All data reset complete!

Deleted:
- ${T.size} sessions
- ${re.size} events
- ${N.size} access refreshes
- All localStorage data`),await P()}catch(_){console.error("Error resetting all data:",_),alert("Failed to reset data. Please check console for details.")}finally{l(!1)}}},A=t.filter(_=>_.studentId.toLowerCase().includes(u.toLowerCase())),R=_=>_?new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).format(_):"Never",V=_=>!_.sessions||_.sessions.length===0?0:Math.max(..._.sessions.map(T=>T.finalScore||0)),z=_=>!_.sessions||_.sessions.length===0?0:_.sessions.reduce((x,te)=>(te.finalScore||0)>(x.finalScore||0)?te:x,_.sessions[0]).timeElapsed||0,B=_=>{if(!_)return"N/A";const T=Math.floor(_/60),x=_%60;return`${T}:${x.toString().padStart(2,"0")}`},S=t.filter(_=>!_.section.includes("ADMIN")).length,v=t.filter(_=>!_.section.includes("ADMIN")&&_.hasPlayed).length,E=t.filter(_=>!_.section.includes("ADMIN")).reduce((_,T)=>_+T.totalAccesses,0);t.filter(_=>!_.section.includes("ADMIN")&&_.hasPlayed).reduce((_,T)=>_+V(T),0)/(v||1);const I=t.filter(_=>!_.section.includes("ADMIN")&&!_.hasPlayed).length;return d.jsxs("div",{style:{padding:"20px",maxWidth:"1400px",margin:"0 auto"},children:[d.jsx("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"30px",borderRadius:"12px",marginBottom:"30px",color:"white"},children:d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("div",{children:[d.jsx("h1",{style:{margin:"0 0 10px 0"},children:" Master Admin Dashboard"}),d.jsx("p",{style:{margin:0,opacity:.9},children:"Manage student access and view activity logs"})]}),d.jsx("button",{onClick:k,disabled:a,style:{padding:"12px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",opacity:a?.6:1},children:a?"Processing...":" Reset All Data"})]})}),d.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"25px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"30px"},children:[d.jsx("h2",{style:{margin:"0 0 20px 0",color:"#333",fontSize:"20px"},children:" Admin Code Reference"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px"},children:[d.jsxs("div",{style:{border:"2px solid #4CAF50",borderRadius:"8px",padding:"15px",background:"#f8fff8"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#4CAF50",fontSize:"16px"},children:" Test Codes (Internal Use)"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px"},children:[d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-TEST1"})," to ",d.jsx("code",{children:"ADMIN-TEST10"})]}),d.jsx("li",{children:"Student-like experience with infinite attempts"}),d.jsx("li",{children:"12-minute duration, AI enabled, checkpoints"}),d.jsx("li",{children:"Data tracked like regular students"})]})]}),d.jsxs("div",{style:{border:"2px solid #2196F3",borderRadius:"8px",padding:"15px",background:"#f8fcff"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#2196F3",fontSize:"16px"},children:" Admin Codes (Testing)"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px"},children:[d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-REGULAR"})," - Standard 12min, AI enabled"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-FAST"})," - Quick 2min test mode"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-1-CP"})," - No AI, with checkpoint"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-1-NCP"})," - No AI, no checkpoint"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-2-CP"})," - AI enabled, with checkpoint"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-2-NCP"})," - AI enabled, no checkpoint"]})]})]}),d.jsxs("div",{style:{border:"2px solid #9C27B0",borderRadius:"8px",padding:"15px",background:"#fdf8ff"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#9C27B0",fontSize:"16px"},children:" Master Admin"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px"},children:[d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-MASTER"})," - Access to this interface"]}),d.jsx("li",{children:"Student data management and analysis"}),d.jsx("li",{children:"Access refresh and data reset capabilities"}),d.jsx("li",{children:"No gameplay, admin interface only"})]})]})]})]}),d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"12px",marginBottom:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[d.jsxs("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[d.jsx("input",{type:"text",placeholder:"Search by Student ID...",value:u,onChange:_=>h(_.target.value),style:{flex:1,padding:"10px 15px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"14px"}}),d.jsx("button",{onClick:P,disabled:n,style:{padding:"10px 20px",background:"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold"},children:" Refresh Data"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"15px",marginTop:"20px"},children:[d.jsxs("div",{style:{padding:"15px",background:"#e3f2fd",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:S}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Students"})]}),d.jsxs("div",{style:{padding:"15px",background:"#e8f5e9",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:v}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Have Played"})]}),d.jsxs("div",{style:{padding:"15px",background:"#fff3e0",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:E}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Sessions"})]}),d.jsxs("div",{style:{padding:"15px",background:"#fce4ec",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#e91e63"},children:I}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Never Played"})]}),d.jsxs("div",{style:{padding:"15px",background:"#f3e5f5",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#9c27b0"},children:I}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Never Played"})]})]})]}),d.jsx("div",{style:{background:"white",borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:d.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[d.jsx("thead",{children:d.jsxs("tr",{style:{background:"#f5f5f5"},children:[d.jsx("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600"},children:"Student ID"}),d.jsx("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600"},children:"Section"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Status"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Latest Access"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Highest Score"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Time Taken"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Total"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Actions"})]})}),d.jsx("tbody",{children:n?d.jsx("tr",{children:d.jsx("td",{colSpan:"8",style:{padding:"40px",textAlign:"center"},children:"Loading student data..."})}):A.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:"8",style:{padding:"40px",textAlign:"center"},children:"No students found"})}):A.map(_=>{const T=V(_);return d.jsxs("tr",{style:{borderBottom:"1px solid #e0e0e0",background:s===_.studentId?"#f0f8ff":_.hasPlayed?_.isAdmin?"#fff9c4":"white":"#fafafa"},children:[d.jsx("td",{style:{padding:"15px",fontFamily:"monospace"},children:_.studentId}),d.jsx("td",{style:{padding:"15px"},children:d.jsx("span",{style:{padding:"4px 8px",background:_.isAdmin?"#ffeb3b":_.section.includes("01A")?"#e3f2fd":_.section.includes("02A")?"#f3e5f5":"#f5f5f5",borderRadius:"4px",fontSize:"12px",fontWeight:_.isAdmin?"bold":"normal",color:_.isAdmin?"#333":"inherit"},children:_.section})}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:_.isAdmin?d.jsx("span",{style:{padding:"4px 8px",background:"#9C27B0",color:"white",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:"Unlimited"}):!_.hasPlayed||_.hasBeenRefreshedToday?d.jsx("span",{style:{padding:"4px 8px",background:"#e8f5e9",color:"#2e7d32",borderRadius:"12px",fontSize:"12px"},children:"Active"}):d.jsx("span",{style:{padding:"4px 8px",background:"#ffeb3b",color:"#f57c00",borderRadius:"12px",fontSize:"12px"},children:"Restricted"})}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:R(_.latestAccess)}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:d.jsx("span",{style:{padding:"4px 8px",background:T>=1e3?"#e8f5e9":T>0?"#fff3e0":"#f5f5f5",color:T>=1e3?"#2e7d32":T>0?"#f57c00":"#999",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:T})}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:d.jsx("span",{style:{fontFamily:"monospace",fontSize:"12px",color:"#666",fontWeight:"bold"},children:B(z(_))})}),d.jsx("td",{style:{padding:"15px",textAlign:"center",fontWeight:"bold"},children:_.totalAccesses}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:_.isAdmin?d.jsx("span",{style:{color:"#999",fontSize:"12px"},children:"N/A"}):d.jsx("button",{onClick:()=>{i(_.studentId),confirm(`Reset access for Student ${_.studentId} (${_.section})?

This will allow them to play again today.`)&&M(_.studentId)},disabled:a,style:{padding:"6px 12px",background:"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:" Reset"})})]},_.studentId)})})]})}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",fontSize:"12px",color:"#666",textAlign:"center"},children:["Daily automatic reset is disabled. Use refresh button to manually grant access to students who have already played.",d.jsx("br",{}),"Total roster: ",S," students across 4 conditions (01A-Checkpoint, 01A-No Checkpoint, 02A-Checkpoint, 02A-No Checkpoint)"]})]})}const EI={notifyGameComplete(t={}){try{window.parent.postMessage({type:"gameComplete",status:"finished",timestamp:new Date().toISOString(),...t},"*");try{if(window.parent&&window.parent.document){const e=window.parent.document.querySelector("#NextButton");e&&(e.style.display="inline-block",e.style.visibility="visible",e.disabled=!1)}}catch{window.parent.postMessage({type:"showNextButton",action:"show"},"*")}console.log(" Game completion notification sent to Qualtrics")}catch(e){console.error("Failed to notify Qualtrics:",e)}},notifySemesterComplete(t,e,n={}){try{window.parent.postMessage({type:"semesterComplete",semester:t,totalSemesters:e,timestamp:new Date().toISOString(),...n},"*"),window.parent.postMessage({type:"keepNextButtonVisible",action:"maintain"},"*"),console.log(` Semester ${t} completion notification sent`)}catch(r){console.error("Failed to notify Qualtrics of semester completion:",r)}},ensureNextButtonVisible(){try{window.parent.postMessage({type:"ensureNextButton",action:"show",timestamp:new Date().toISOString()},"*")}catch(t){console.error("Failed to ensure Next button visibility:",t)}}};function TI({onStart:t}){const[e,n]=b.useState({task1:0,task2:0,task3:0}),[r,s]=b.useState([]),[i,a]=b.useState(0),l=["It's generally smart to do roughly an even number of each task.","This is because the tasks that are worth more points take more time to do, so you don't want to only do the shorter tasks or only do the longer tasks.","Of course, you might prefer one task over another, so you could take that into account. Do you feel like you are particularly good at one of the tasks?"],u=()=>{i<l.length?(s(w=>[...w,{sender:"AI",text:l[i]}]),a(w=>w+1)):s(w=>[...w,{sender:"AI",text:"I've shared my best advice! It's up to you now."}])},h=(w,C)=>{const P=parseInt(C)||0;n(M=>({...M,[w]:Math.max(0,P)}))},p=e.task1+e.task2+e.task3,g=p===10,m=()=>{if(!g)return;const w=[];for(let C=0;C<e.task1;C++)w.push("g2");for(let C=0;C<e.task2;C++)w.push("g1");for(let C=0;C<e.task3;C++)w.push("g3");t(w,e)};return d.jsxs("div",{style:{maxWidth:"800px",margin:"40px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[d.jsx("h1",{style:{textAlign:"center",marginBottom:"30px",color:"#333"},children:"Task Allocation Strategy"}),d.jsxs("div",{style:{marginBottom:"30px",lineHeight:"1.6",color:"#555"},children:[d.jsxs("p",{children:["You have ",d.jsx("strong",{children:"12 minutes"})," to complete ",d.jsx("strong",{children:"10 tasks"}),"."]}),d.jsx("p",{children:"You must decide now how many of each task type you want to perform."}),d.jsxs("p",{children:["Total tasks must add up to ",d.jsx("strong",{children:"10"}),"."]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"40px",marginBottom:"40px"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[d.jsxs("div",{style:ic,children:[d.jsxs("label",{style:oc,children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 1: Slider (Materials)"]}),d.jsx("input",{type:"number",min:"0",max:"10",value:e.task1,onChange:w=>h("task1",w.target.value),style:ac})]}),d.jsxs("div",{style:ic,children:[d.jsxs("label",{style:oc,children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 2: Counting (Research)"]}),d.jsx("input",{type:"number",min:"0",max:"10",value:e.task2,onChange:w=>h("task2",w.target.value),style:ac})]}),d.jsxs("div",{style:ic,children:[d.jsxs("label",{style:oc,children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 3: Typing (Engagement)"]}),d.jsx("input",{type:"number",min:"0",max:"10",value:e.task3,onChange:w=>h("task3",w.target.value),style:ac})]}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:g?"#e8f5e9":"#ffebee",borderRadius:"8px",textAlign:"center",fontWeight:"bold",color:g?"#2e7d32":"#c62828"},children:["Total Allocated: ",p," / 10"]})]}),d.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"12px",padding:"20px",display:"flex",flexDirection:"column"},children:[d.jsxs("div",{style:{flex:1,marginBottom:"15px",overflowY:"auto",maxHeight:"300px",display:"flex",flexDirection:"column",gap:"10px"},children:[r.length===0&&d.jsx("div",{style:{color:"#999",fontStyle:"italic",textAlign:"center",marginTop:"40px"},children:"Need advice? Ask the AI helper."}),r.map((w,C)=>d.jsxs("div",{style:{background:"#f0f7ff",padding:"10px 15px",borderRadius:"12px 12px 12px 0",alignSelf:"flex-start",maxWidth:"90%"},children:[d.jsx("strong",{children:" AI:"})," ",w.text]},C))]}),d.jsxs("button",{onClick:u,style:{background:"#2196F3",color:"white",border:"none",padding:"12px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[d.jsx("span",{children:""})," Ask AI for Recommendation"]})]})]}),d.jsx("div",{style:{textAlign:"center"},children:d.jsx("button",{onClick:m,disabled:!g,style:{background:g?"#4CAF50":"#ccc",color:"white",border:"none",padding:"15px 40px",fontSize:"18px",borderRadius:"30px",cursor:g?"pointer":"not-allowed",fontWeight:"bold",boxShadow:g?"0 4px 15px rgba(76, 175, 80, 0.3)":"none",transition:"all 0.2s"},children:"Start Experiment"})})]})}const ic={display:"flex",alignItems:"center",justifyContent:"space-between",background:"#f9f9f9",padding:"15px",borderRadius:"8px"},oc={fontWeight:"bold",color:"#333",display:"flex",alignItems:"center"},ac={width:"60px",padding:"10px",fontSize:"18px",textAlign:"center",borderRadius:"6px",border:"1px solid #ddd"};function II({currentTaskIndex:t,totalTasks:e,taskQueue:n,onSwitchTask:r,children:s,points:i,timeRemaining:a,onTimeUp:l,chatInterface:u}){const h=n[t],p=k=>k.startsWith("g1")?{name:"Research",icon:"",color:"#9C27B0"}:k.startsWith("g2")?{name:"Materials",icon:"",color:"#4CAF50"}:k.startsWith("g3")?{name:"Engagement",icon:"",color:"#f44336"}:{name:"Unknown",icon:"",color:"#333"},g=p(h),m=n.slice(t+1),w=m.some(k=>k.startsWith("g1")),C=m.some(k=>k.startsWith("g2")),P=m.some(k=>k.startsWith("g3")),M=t;return d.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",padding:"20px"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"white",padding:"15px 25px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[d.jsx("div",{style:{width:"200px"},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""}),d.jsx("div",{children:d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:a<60?"#f44336":"#333",animation:a<60?"pulse 1s infinite":"none"},children:[Math.floor(a/60),":",(a%60).toString().padStart(2,"0")]})})]})}),d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Points"}),d.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#2196F3"},children:i})]}),d.jsxs("div",{style:{textAlign:"right",width:"200px"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Task Progress"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[M," / ",e]})]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr 320px",gap:"20px",alignItems:"start"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)"},children:[d.jsx("h3",{style:{marginTop:0,fontSize:"16px",color:"#555"},children:"Switch Task"}),d.jsx("p",{style:{fontSize:"13px",color:"#777",marginBottom:"15px"},children:"Pause current task and switch to another type. The current task will be moved to the end of the queue."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[d.jsxs("button",{disabled:!C||h.startsWith("g2"),onClick:()=>r("g2"),style:lc(C&&!h.startsWith("g2"),"#4CAF50"),children:[d.jsx("span",{children:""})," Switch to Materials"]}),d.jsxs("button",{disabled:!w||h.startsWith("g1"),onClick:()=>r("g1"),style:lc(w&&!h.startsWith("g1"),"#9C27B0"),children:[d.jsx("span",{children:""})," Switch to Research"]}),d.jsxs("button",{disabled:!P||h.startsWith("g3"),onClick:()=>r("g3"),style:lc(P&&!h.startsWith("g3"),"#f44336"),children:[d.jsx("span",{children:""})," Switch to Engagement"]})]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"15px",borderRadius:"12px",fontSize:"12px",color:"#666"},children:[d.jsx("strong",{children:"Next up:"}),d.jsxs("div",{style:{marginTop:"10px",display:"flex",gap:"5px",flexWrap:"wrap"},children:[m.slice(0,5).map((k,A)=>d.jsx("span",{style:{background:p(k).color,color:"white",padding:"2px 6px",borderRadius:"4px",opacity:.7},children:p(k).icon},A)),m.length>5&&d.jsxs("span",{children:["+",m.length-5," more"]})]})]})]}),d.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",minHeight:"500px"},children:[d.jsxs("div",{style:{marginBottom:"20px",paddingBottom:"15px",borderBottom:"1px solid #eee",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:g.icon}),d.jsxs("h2",{style:{margin:0,color:g.color},children:["Current: ",g.name]})]}),s]}),d.jsx("div",{children:u&&d.jsx("div",{style:{position:"sticky",top:"20px"},children:u})})]}),d.jsx("style",{children:`
        @keyframes pulse {
          0% { opacity: 1; }
          50% { opacity: 0.5; }
          100% { opacity: 1; }
        }
      `})]})}const lc=(t,e)=>({display:"flex",alignItems:"center",gap:"10px",padding:"12px",border:`1px solid ${t?e:"#ddd"}`,borderRadius:"8px",background:t?"white":"#f5f5f5",color:t?e:"#999",cursor:t?"pointer":"not-allowed",fontWeight:"bold",transition:"all 0.2s",opacity:t?1:.7});function AI({timeRemaining:t,onSelectTask:e,onFinishEarly:n}){return d.jsxs("div",{style:{maxWidth:"800px",margin:"40px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsx("h1",{style:{color:"#2196F3",marginBottom:"20px"},children:" All Tasks Completed!"}),d.jsxs("div",{style:{fontSize:"18px",color:"#555",marginBottom:"30px",lineHeight:"1.6"},children:[d.jsx("p",{children:"You have finished all 10 allocated tasks with time to spare."}),d.jsxs("p",{children:["You currently have ",d.jsxs("strong",{children:[Math.floor(t/60)," minutes and ",t%60," seconds"]})," remaining."]}),d.jsxs("p",{children:["You can choose to do more tasks for ",d.jsx("strong",{children:"1/2 credit"})," to increase your score, or finish the experiment now."]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"40px"},children:[d.jsxs("button",{onClick:()=>e("g2"),style:uc("#4CAF50"),children:[d.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Materials Task",d.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),d.jsxs("button",{onClick:()=>e("g1"),style:uc("#9C27B0"),children:[d.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Research Task",d.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),d.jsxs("button",{onClick:()=>e("g3"),style:uc("#f44336"),children:[d.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Engagement Task",d.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]})]}),d.jsx("div",{style:{borderTop:"1px solid #eee",paddingTop:"30px"},children:d.jsx("button",{onClick:n,style:{background:"#f5f5f5",color:"#666",border:"1px solid #ddd",padding:"12px 30px",fontSize:"16px",borderRadius:"30px",cursor:"pointer",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:r=>r.target.style.background="#e0e0e0",onMouseLeave:r=>r.target.style.background="#f5f5f5",children:"No thanks, I'm done"})})]})}const uc=t=>({background:"white",border:`2px solid ${t}`,color:t,padding:"20px",borderRadius:"12px",cursor:"pointer",fontSize:"16px",fontWeight:"bold",transition:"all 0.2s",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"});function CI(t,e){const n=t.length,r=e.length,s=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let i=0;i<=n;i++)s[i][0]=i;for(let i=0;i<=r;i++)s[0][i]=i;for(let i=1;i<=n;i++)for(let a=1;a<=r;a++)t[i-1]===e[a-1]?s[i][a]=s[i-1][a-1]:s[i][a]=Math.min(s[i-1][a]+1,s[i][a-1]+1,s[i-1][a-1]+1);return s[n][r]}function kI(){const e=new URLSearchParams(window.location.search).get("admin")==="berkeley2024",[n,r]=b.useState("landing"),[s,i]=b.useState(null),[a,l]=b.useState(null),[u,h]=b.useState("g2t1"),[p,g]=b.useState({}),[m,w]=b.useState(0),[C,P]=b.useState(null),[M,k]=b.useState(!1),[A,R]=b.useState(""),[V,z]=b.useState(!0),[B,S]=b.useState(0),[v,E]=b.useState({}),[I,_]=b.useState(0),[T,x]=b.useState(0),[te,re]=b.useState(!1),[Y,U]=b.useState(null),[N,O]=b.useState(!1),[L,W]=b.useState(30),[X,oe]=b.useState(!1),[Ce,xe]=b.useState(5),[fe,de]=b.useState(!1),[Oe,we]=b.useState(0),[ne,ke]=b.useState(1),[Fe]=b.useState(2),[Re,wt]=b.useState([]),[qt,Gt]=b.useState(null),[Qt,Kt]=b.useState(!1),[ur,cr]=b.useState(0),[kn,dr]=b.useState(null),[Pe,Ti]=b.useState({g2t1:!1,g1t1:!1,g3t1:!1}),[Zo,lt]=b.useState(720),[Ke,Hr]=b.useState(720),[_s,ea]=b.useState(0),[Se,Rn]=b.useState({materials:0,research:0,engagement:0,bonus:0}),[qr,xs]=b.useState({}),[ta,na]=b.useState({}),[af,ws]=b.useState({}),[Pn,Ss]=b.useState([]),[on,Es]=b.useState(0),[ra,Bn]=b.useState(null),[gu,Ii]=b.useState(!1),Ts=b.useRef(Date.now()),yn=b.useRef(null);b.useRef(null),b.useRef(null);const Is=b.useRef(null),ut=b.useRef(Date.now());b.useRef(720),b.useRef(720);const hr=()=>{const G=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").semesterDuration||72e4,H=Math.floor(G/2e3);return Math.floor(H/60)};if(b.useEffect(()=>{(async()=>{try{const G=new URLSearchParams(window.location.search),H=G.has("code")||G.has("c");if((G.get("code")||G.get("c"))==="ADMIN-MASTER"){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",section:"master_admin",hasAI:!1,isMasterInterface:!0,displayName:"Master Administrator"})),z(!1);return}if(e&&!sessionStorage.getItem("gameConfig")&&sessionStorage.setItem("gameConfig",JSON.stringify({role:"admin",section:"admin",hasAI:!0,checkpointSemester2:!0,displayName:"Admin User"})),!H){r("studentLogin"),z(!1);return}const{allowed:Ie,reason:qe,resumeSession:ze,newSession:Nt,code:Je,codeData:Ze}=await $m.checkAccess();if(!Ie){k(!0),R(qe),z(!1);return}if(ze)P(ze),localStorage.setItem("sessionId",ze);else if(Nt){const st=await $m.createSession(Je,Ze);P(st)}await je.syncOfflineEvents(),z(!1)}catch{z(!1)}})()},[]),b.useEffect(()=>{n==="complete"&&ne>=Fe&&EI.notifyGameComplete({finalScore:Math.round(an())+(Se.bonus||0),totalTime:B,semestersCompleted:ne,sessionId:C})},[n,ne,Fe,B,Se.bonus,C]),b.useEffect(()=>{localStorage.setItem("currentTask",u)},[u]),b.useEffect(()=>{localStorage.setItem("gameMode",JSON.stringify(s))},[s]),b.useEffect(()=>{localStorage.setItem("currentSemester",ne.toString())},[ne]),b.useEffect(()=>{localStorage.setItem("totalSemesters",Fe.toString())},[Fe]),b.useEffect(()=>{localStorage.setItem("completedTasksCount",Object.keys(p).length.toString())},[p]),b.useEffect(()=>{localStorage.setItem("completedLevels",m.toString())},[m]),b.useEffect(()=>{localStorage.setItem("totalSwitches",I.toString())},[I]),b.useEffect(()=>{localStorage.setItem("categoryPoints",JSON.stringify(Se))},[Se]),b.useEffect(()=>{localStorage.setItem("studentLearningScore",_s.toString())},[_s]),b.useEffect(()=>{const K=Pe.g2t1&&Pe.g1t1&&Pe.g3t1;localStorage.setItem("practiceCompleted",K.toString())},[Pe]),V)return d.jsx("div",{className:"app",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:d.jsx("h2",{children:"Loading..."})});if(window.location.search.includes("master=true")&&JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="master_admin")return d.jsx(SI,{});if(window.location.search.includes("admin=true"))return d.jsx(xI,{});const an=(K=Se,G=qr)=>{let H=0;Object.entries(G).forEach(([Nt,Je])=>{const st=1+parseInt(Nt)*.15;H+=Je*st});const se=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,Ie=H+se,qe=K.materials||0,ze=K.research||0;return console.log(` STUDENT LEARNING: ${Ie.toFixed(1)} pts | Materials: ${qe} (with sequential multipliers) | Research: ${ze} | Interest: ${se.toFixed(1)} = ${Ie.toFixed(1)}`),isNaN(Ie)?0:Ie},Gr=()=>{const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(!(ne===2&&K.checkpointSemester2))return;Kt(!0),an()>=300?(cr(300),Rn(Ie=>({...Ie,bonus:(Ie.bonus||0)+300}))):cr(0),re(!0),U("checkpoint")},sa=()=>{const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),G=K.semesterDuration||72e4,H=Math.floor(G/1e3);lt(H),Hr(H),Ts.current=Date.now(),yn.current=setInterval(()=>{const Ie=Date.now()-Ts.current,qe=Math.floor(Ie/1e3);S(qe);const ze=Math.max(0,H-qe);if(Hr(ze),qe%10===0&&C&&!C.startsWith("offline-")&&Kn(cn(tt,"sessions",C),{timeElapsed:qe,lastUpdated:hn()}).catch(Je=>console.error("Failed to update session time:",Je)),ne===2&&K.checkpointSemester2){const Je=K.semesterDuration||72e4,Ze=Math.floor(Je/2e3);qe===Ze&&!Qt&&Gr()}ze<=0&&(clearInterval(yn.current),yn.current=null,$n("semester_complete"))},1e3)},ia=K=>{const H=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin",se=Pe.g2t1&&Pe.g1t1&&Pe.g3t1;l(K),je.logEvent("practice_choice",{choice:K}),K==="no"?!H&&!se?(Dn("You must complete all three practice tasks first!"),r("practice")):Un():r("practice")},Un=()=>{if(!qt){const K=Math.floor(Math.random()*1e6);Gt(K),er.initializeSeed(K),C&&!C.startsWith("offline-")&&Kn(cn(tt,"sessions",C),{randomSeed:K,[`semesterSeeds.semester${ne}`]:K})}localStorage.setItem("engagementInterest","0"),Rn({materials:0,research:0,engagement:0,bonus:0}),xs({}),r("allocation"),g({}),w(0),_(0),x(0),Kt(!1),na({}),ws({})},yu=(K,G)=>{Ss(K),Bn(G),Es(0),r("challenge");const se=`${K[0]}t1`;h(se),E({[se]:Date.now()}),je.setPageStartTime(se),sa(),je.logEvent("allocation_complete",{counts:G,queue:K,timestamp:Date.now()})},vu=K=>{if(Pn[on]===K)return;const H=[...Pn],se=H.splice(on,1)[0];H.push(se);const Ie=H.findIndex((qe,ze)=>ze>=on&&qe.startsWith(K));if(Ie!==-1){const qe=H.splice(Ie,1)[0];H.splice(on,0,qe),Ss(H),_(st=>st+1);const ze=qe,Je=Object.keys(p).filter(st=>st.startsWith(ze)).length+1,Ze=`${ze}t${Je}`;As(Ze)}},fr=async(K,G)=>{ut.current=Date.now();let H=0;const se=K.startsWith("g1")?"research":K.startsWith("g2")?"materials":"engagement";if(se==="materials")if(G.points!==void 0)H=G.points;else{const ae=parseFloat(G.userAnswer||G.userValue||0),Be=parseFloat(G.correctAnswer||G.targetValue||0),bt=Math.abs(ae-Be);bt===0?H=2:bt<=1?H=1:H=0}else if(se==="research")if(G.points!==void 0)H=G.points;else{const ae=parseInt(G.userAnswer||0),Be=parseInt(G.correctAnswer||0),bt=Math.abs(ae-Be);bt===0?H=2:bt<=1?H=1:H=0}else if(se==="engagement")if(G.points!==void 0)H=G.points;else{const ae=G.userAnswer||"",Be=G.correctAnswer||"";ae===Be?H=2:CI(ae,Be)===1?H=1:H=0}if(Rn(ae=>{const Be={...ae,[se]:ae[se]+H};return console.log(` Updated ${se}: +${H} (total: ${Be[se]})`),Be}),se==="materials"&&H>0){const ae=Se.research;xs(Be=>{const bt=Be[ae]||0;return{...Be,[ae]:bt+H}})}const qe=.0015*(se==="engagement"?Se.engagement+H:Se.engagement),ze={...Se,[se]:Se[se]+H};let Nt=qr;if(se==="materials"&&H>0){const ae=Se.research,Be=qr[ae]||0;Nt={...qr,[ae]:Be+H}}let Je=0;Object.entries(Nt).forEach(([ae,Be])=>{const ks=1+parseInt(ae)*.15;Je+=Be*ks});const st=parseFloat(localStorage.getItem("engagementInterest")||"0")+qe*Je;localStorage.setItem("engagementInterest",st.toString()),ws(ae=>({...ae,[K]:H})),na(ae=>({...ae,[K]:(ae[K]||0)+1}));const Ai={...Se,[se]:Se[se]+H},Ci=an(Ai,Nt);ea(Ci);let Yt="";if(se==="materials"){const ae=Math.abs((G.userValue||0)-(G.targetValue||0));ae===0?Yt="Perfect materials!":ae<=1?Yt=`Off by ${ae.toFixed(2)}`:Yt=`Off by ${ae.toFixed(2)}`}else if(se==="research"){const ae=Math.abs((G.userAnswer||0)-(G.correctAnswer||0));ae===0?Yt="Perfect research!":ae<=1?Yt=`Off by ${ae}`:Yt=`Off by ${ae}`}else se==="engagement"&&(H===2?Yt="Perfect engagement!":H===1?Yt="One typo":Yt="Multiple errors");Dn(`${Yt} | +${H} ${se} pts`),g(ae=>({...ae,[K]:!0})),w(ae=>ae+1),x(ae=>ae+1),await je.trackTaskComplete(K,G.attempts,G.totalTime,G.accuracy||G.difference||0),await je.logEvent("task_complete",{taskId:K,...G,pointsEarned:H,categoryPoints:ze,studentLearningScore:Ci,engagementInterest:st,completionContext:{totalTasksCompleted:Object.keys(p).length+1,currentGameTime:B,switchesBeforeCompletion:I,bonusPromptsEarned:T+1,timeRemaining:Ke}}),C&&!C.startsWith("offline-")&&await Kn(cn(tt,"sessions",C),{[`completedTasks.${K}`]:!0,[`taskPoints.${K}`]:H,categoryPoints:ze,studentLearningScore:Ci,engagementInterest:st,bonusPrompts:T+1,lastActivity:hn()});const Cs=on+1;if(Cs<Pn.length){Es(Cs);const ae=Pn[Cs];let Be=Object.keys(p).filter(aa=>aa.startsWith(ae)).length;ae===K.substring(0,2)&&K.startsWith(ae)&&(Be+=1);const bt=Be+1,ks=`${ae}t${bt}`;As(ks,!0)}else Ke>0?r("bonus_round"):$n("all_tasks_done")},As=async(K,G=!1)=>{if(!te){if(p[K]&&!G){Dn("Task already completed! Choose a different task.");return}if(G||await je.logEvent("manual_tab_switch",{from:u,to:K,reason:"user_clicked"}),ut.current=Date.now(),X&&(oe(!1),xe(5),Is.current&&(clearInterval(Is.current),Is.current=null)),u!==K&&!G&&_(H=>H+1),await je.trackPageSwitch(u,K,G),v[u]){const H=Date.now()-v[u];await je.logEvent("task_time",{taskId:u,timeSpent:H,completed:p[u]||!1,leftForTask:K})}h(K),E(H=>({...H,[K]:Date.now()})),je.setPageStartTime(K)}},Dn=K=>{const G=document.createElement("div");G.className="notification-enter",G.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",G.textContent=K,document.body.appendChild(G),setTimeout(()=>{G.className="notification-exit",setTimeout(()=>{document.body.contains(G)&&document.body.removeChild(G)},500)},3e3)},$n=async(K="semester_complete")=>{yn.current&&clearInterval(yn.current);const G=Math.floor((Date.now()-Ts.current-Oe)/1e3),H=an(),se=Se.bonus||0,Ie=Math.round(H)+se;await je.logEvent("game_complete",{totalTime:G,totalSwitches:I,completedTasks:Object.keys(p).length,completedLevels:m,completionReason:K,gameMode:s,currentSemester:ne,categoryPoints:Se,studentLearningScore:H,totalBonus:se,finalScore:Ie,finalContext:{practiceCompleted:a==="yes",totalPrompts:3+T,isAdminMode:e}}),C&&!C.startsWith("offline-")&&await Kn(cn(tt,"sessions",C),{status:"completed",completedAt:hn(),finalTime:G,timeElapsed:G,totalSwitches:I,completionReason:K,currentSemester:ne,finalScore:Ie,studentLearningScore:H}),r("complete")},St=(K,G)=>{if(G&&G.points&&G.points===2)Ti(H=>({...H,[K]:!0})),Dn("Perfect! Practice task completed."),setTimeout(()=>{dr(null)},1500);else{const H=(G==null?void 0:G.points)||0;Dn(`Practice requires 100% accuracy. You scored ${H===1?"50%":"0%"}. Try again!`),setTimeout(()=>{dr(null)},2e3)}},oa=()=>{const K=u[1],G=parseInt(u.substring(3)),H=n==="practice";return K==="1"?d.jsx(Id,{taskNum:G,onComplete:H?St:fr,currentTaskId:u,isPractice:H}):K==="2"?d.jsx(Ad,{taskNum:G,onComplete:H?St:fr,currentTaskId:u,isPractice:H}):d.jsx(Cd,{taskNum:G,onComplete:H?St:fr,currentTaskId:u,isPractice:H})};if(n==="studentLogin")return d.jsx(_I,{onLoginSuccess:K=>{window.location.href=`${window.location.origin}?code=${K}`}});if(M)return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"600px",margin:"50px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[d.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Access Denied"}),d.jsx("p",{style:{fontSize:"18px",marginBottom:"20px"},children:A}),d.jsx("div",{style:{padding:"15px",background:"#ffebee",borderRadius:"8px",border:"1px solid #f44336"},children:d.jsx("p",{style:{color:"#c62828",margin:0},children:"If you believe this is an error, please contact your instructor."})})]})});if(n==="semesterBreak"){const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),G=ne===2&&K.checkpointSemester2;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"700px",margin:"50px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsxs("h1",{style:{color:"#2196F3",marginBottom:"30px"},children:[" Semester ",ne-1," Complete!"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsx("h3",{style:{color:"#1976d2",marginBottom:"10px"},children:"Take a Break!"}),d.jsxs("p",{style:{fontSize:"16px",color:"#666",marginBottom:"0"},children:["Great job completing Semester ",ne-1,"! Take a moment to rest your eyes, stretch, or grab some water before continuing."]})]}),G&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",padding:"25px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #ff9800"},children:[d.jsx("h3",{style:{color:"#f57c00",marginBottom:"15px"},children:" Midterm Checkpoint Coming!"}),d.jsxs("div",{style:{fontSize:"16px",color:"#666",textAlign:"left"},children:[d.jsx("p",{style:{marginBottom:"10px"},children:d.jsxs("strong",{children:["Semester 2 includes a midterm exam at the"," ",hr(),"-minute mark!"]})}),d.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"10px"},children:[d.jsx("li",{children:"Your students will be tested at the midpoint"}),d.jsxs("li",{children:["If student learning  300 points:"," ",d.jsx("strong",{children:"+300 bonus points!"})]}),d.jsx("li",{children:"Build up your teaching effectiveness early to maximize the bonus"})]}),d.jsxs("p",{style:{background:"white",padding:"10px",borderRadius:"4px",textAlign:"center",fontWeight:"bold",color:"#f57c00"},children:["Goal: Reach 300+ Student Learning by minute"," ",hr()]})]})]}),Re.length>0&&d.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"10px"},children:"Your Performance So Far:"}),Re.map((H,se)=>d.jsxs("div",{style:{marginBottom:"8px",fontSize:"16px"},children:["Semester ",se+1,":"," ",d.jsxs("strong",{children:[H.finalScore," points"]})]},se))]}),d.jsxs("div",{style:{marginTop:"30px"},children:[d.jsxs("button",{onClick:()=>{r("challenge"),sa(),E({g2t1:Date.now()}),je.setPageStartTime("g2t1"),je.logEvent("semester_start",{semester:ne,timestamp:Date.now(),hasCheckpoint:G})},style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:H=>{H.currentTarget.style.transform="translateY(-2px)",H.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:H=>{H.currentTarget.style.transform="translateY(0)",H.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["I'm Ready - Start Semester ",ne]}),d.jsx("p",{style:{marginTop:"15px",fontSize:"14px",color:"#999"},children:"Click when you're ready to continue. The timer will start immediately."})]})]})})}if(n==="landing"){s||i({accuracy:"lenient",limit:"time"});const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),G=K.role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",style:{padding:"40px",maxWidth:"900px"},children:[d.jsxs("h1",{style:{color:"#333",marginBottom:"30px",fontSize:"32px",textAlign:"left"},children:["Can you beat Park? - Semester ",ne,"/",Fe]}),d.jsxs("div",{className:"game-info",style:{textAlign:"left"},children:[d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#f44336",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Engagement"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Build interest that compounds! Each point adds 0.15% interest after every task completion."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#9C27B0",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Research"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Research amplifies your FUTURE materials! Each point adds +15% multiplier to materials earned after the research (order matters!)."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#4CAF50",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Materials"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Create teaching materials - each point directly contributes to your goal points!"})]}),d.jsxs("div",{style:{background:"#f0f8ff",borderRadius:"8px",padding:"25px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{color:"#2196F3",fontSize:"20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Student Learning Formula"]}),d.jsxs("div",{style:{background:"white",padding:"18px",borderRadius:"6px",fontFamily:"monospace",fontSize:"18px",textAlign:"center",marginBottom:"20px",border:"1px solid #e0e0e0",lineHeight:"1.8"},children:["Goal ="," ",d.jsx("strong",{children:"Materials  (1 + Research0.15) + Engagement Interest"}),d.jsx("br",{}),d.jsxs("div",{style:{fontSize:"14px",marginTop:"10px",fontFamily:"sans-serif"},children:["Research multipliers apply only to materials earned"," ",d.jsx("em",{children:"after"})," the research"]})]}),d.jsxs("ul",{style:{color:"#333",lineHeight:"2",margin:"0",paddingLeft:"25px",fontSize:"15px",textAlign:"left"},children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Scoring:"})," Exact = 2 pts | Within 1 = 1 pt | Otherwise = 0 pts"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Timing:"})," Task completion order affects your final score"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Strategy:"})," Think carefully about when to complete each task type!"]}),ne===2&&d.jsxs("li",{children:["At minute ",hr(),": Exam checkpoint with bonus opportunity (300+ Student Learning = 300 bonus)"]})]})]}),K.hasAI&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"1px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"AI Assistant Available:"}),d.jsxs("ul",{style:{color:"#856404",lineHeight:"1.6",margin:"0",paddingLeft:"20px",fontSize:"14px"},children:[d.jsx("li",{children:"Click the help buttons below each task for AI assistance"}),d.jsx("li",{children:"Unlimited use but reliability varies"}),d.jsx("li",{children:'Type "strategy" or "order" in chat for strategic advice!'})]})]}),ne===2&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"2px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:" Semester 2: Midterm Checkpoint!"}),d.jsxs("p",{style:{color:"#856404",fontSize:"14px",margin:0},children:["At the ",hr(),"-minute mark, if you have 300+ student learning points, you'll earn a 300-point bonus!"]})]})]}),!G&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)",borderRadius:"12px",padding:"20px",marginTop:"20px",marginBottom:"20px",border:"2px solid #d32f2f",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"12px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""}),d.jsx("h3",{style:{color:"#b71c1c",margin:0,fontSize:"18px",fontWeight:"600"},children:"ONE ATTEMPT ONLY - NO RESTART"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No refresh/close"})," - Session ends"]})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No tab switching"})," - 30s warning"]})]})]}),d.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"6px",textAlign:"center",fontSize:"14px",color:"#b71c1c",fontWeight:"600"},children:" Ensure 40 minutes uninterrupted before starting"})]}),d.jsxs("button",{className:"start-button",onClick:()=>r("practiceChoice"),children:["Start Semester ",ne]}),e&&d.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#ffcccb",borderRadius:"6px",border:"2px solid #ff0000",fontWeight:"bold",color:"#d00"},children:["ADMIN MODE: ",Zo/60," minute timer, checkpoint at"," ",hr(),"minute"]}),Re.length>0&&d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"6px",fontSize:"14px"},children:[d.jsx("strong",{children:"Previous Semesters:"}),Re.map((H,se)=>d.jsxs("div",{style:{marginTop:"5px"},children:["Semester ",se+1,": ",H.finalScore," points"]},se))]})]})})})}if(n==="practiceChoice"){const G=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",children:[d.jsx("h2",{style:{color:"#333",marginBottom:"20px"},children:G?"Practice Mode (Optional for Admin)":"Practice Mode (Required)"}),d.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:G?"As an admin, you can skip practice or try it first.":"You must complete all three practice tasks before starting the main game."}),d.jsx("p",{style:{color:"#888",fontSize:"14px",marginBottom:"30px",fontStyle:"italic"},children:"Practice lets you try each teaching task without time pressure."}),!G&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #1976d2",boxShadow:"0 4px 6px rgba(25, 118, 210, 0.1)"},children:[d.jsxs("h4",{style:{color:"#0d47a1",margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:""}),"Required Practice Tasks (100% accuracy needed):"]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Pe.g2t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Pe.g2t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Materials"})}),Pe.g2t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Pe.g1t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Pe.g1t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Research"})}),Pe.g1t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Pe.g3t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Pe.g3t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Engagement"})}),Pe.g3t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]})]}),d.jsx("div",{style:{marginTop:"16px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"6px",fontSize:"13px",color:"#0d47a1",textAlign:"center",fontStyle:"italic"},children:" Each task must be completed perfectly to proceed"})]}),d.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[d.jsx("button",{onClick:()=>ia("yes"),style:{padding:"15px 30px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:G?"Try Practice Mode":"Start Required Practice"}),G&&d.jsx("button",{onClick:()=>ia("no"),style:{padding:"15px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:"Skip Practice (Admin)"})]})]})})})}if(n==="practice"){const G=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";if(!kn)return d.jsxs("div",{className:"app",children:[d.jsx("h1",{children:"Teaching Simulation - Practice Mode"}),d.jsx(gI,{practiceCompleted:Pe,onPracticeComplete:St,onSelectPractice:dr,onStartMainGame:()=>{const Ie=Pe.g2t1&&Pe.g1t1&&Pe.g3t1;!G&&!Ie?Dn("You must complete all three practice tasks first!"):Un()},isAdmin:G})]});const H=kn[1],se=1;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[d.jsx("button",{onClick:()=>dr(null),style:{marginBottom:"20px",padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:" Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),H==="1"&&d.jsx(Id,{taskNum:se,onComplete:St,currentTaskId:kn,isPractice:!0}),H==="2"&&d.jsx(Ad,{taskNum:se,onComplete:St,currentTaskId:kn,isPractice:!0}),H==="3"&&d.jsx(Cd,{taskNum:se,onComplete:St,currentTaskId:kn,isPractice:!0})]})})}if(n==="complete"){const K=Math.floor(B/60),G=B%60,H=Math.round(an()),se=Se.bonus||0,Ie=H+se,qe={semester:ne,totalTime:B,completedLevels:m,categoryPoints:Se,switches:I,gameMode:s,randomSeed:qt,studentLearningScore:H,finalScore:Ie},ze=async()=>{const Je=[...Re,qe];wt(Je),localStorage.setItem("engagementInterest","0"),Rn({materials:0,research:0,engagement:0,bonus:0}),xs({}),C&&!C.startsWith("offline-")&&await Kn(cn(tt,"sessions",C),{[`semesterHistory.semester${ne}`]:qe,currentSemester:ne+1,lastActivity:hn()}),ke(ne+1),kt.resetForNewSemester(),r("semesterBreak"),g({}),w(0),_(0),x(0),S(0),we(0),h("g2t1"),Kt(!1);const Ze=Math.floor(Math.random()*1e6);Gt(Ze),er.initializeSeed(Ze)},Nt=ne>=Fe;return d.jsxs("div",{className:"app",children:[d.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[d.jsx("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"8px",border:"2px solid #2196F3"},children:d.jsxs("h2",{style:{color:"#2196F3",margin:0},children:["Semester ",ne," of ",Fe," Complete!"]})}),Nt&&d.jsx(wI,{sessionId:C,completedLevels:m,totalTime:B,gameMode:s}),d.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginTop:"20px"},children:[d.jsxs("h2",{style:{color:"#333",marginBottom:"20px"},children:[" Semester ",ne," Performance"]}),d.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2196F3",marginBottom:"30px"},children:["Final Score: ",Ie," points"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{margin:"0 0 15px 0",color:"#1976d2"},children:["Student Learning Score: ",H]}),d.jsxs("div",{style:{fontSize:"16px",color:"#666"},children:["= ",Se.materials||0," (Materials) "," ",(1+(Se.research||0)*.15).toFixed(2)," ","(Research)",parseFloat(localStorage.getItem("engagementInterest")||"0")>0&&` + ${parseFloat(localStorage.getItem("engagementInterest")||"0").toFixed(2)} (Interest)`]}),se>0&&d.jsxs("div",{style:{marginTop:"10px",fontSize:"16px",color:"#1976d2"},children:["+ ",se," Checkpoint Bonus"]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Total Time"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[K,"m ",G,"s"]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Student Learning"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:H})]})]}),(ne===2||se>0)&&d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Checkpoint Bonus"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:["+",se]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Tasks Completed"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:m})]})]}),d.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:"Teaching Performance by Category"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f0f8f0",padding:"15px",borderRadius:"6px",border:"2px solid #4CAF5020"},children:[d.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",marginBottom:"5px"},children:" Materials"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Se.materials||0}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Base points"})]}),d.jsxs("div",{style:{background:"#f8f0ff",padding:"15px",borderRadius:"6px",border:"2px solid #9C27B020"},children:[d.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold",marginBottom:"5px"},children:" Research"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Se.research||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(Se.research||0)*15,"% to future materials"]})]}),d.jsxs("div",{style:{background:"#fff0f0",padding:"15px",borderRadius:"6px",border:"2px solid #f4433620"},children:[d.jsx("div",{style:{color:"#f44336",fontWeight:"bold",marginBottom:"5px"},children:" Engagement"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Se.engagement||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",((Se.engagement||0)*.15).toFixed(1),"% interest/task"]})]})]})]}),ne===2&&Se.bonus>0&&d.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[d.jsxs("strong",{style:{color:"#856404"},children:[" Exam Season Bonus:"," "]}),d.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#856404"},children:["+",Se.bonus," points"]})]}),Re.length>0&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"15px"},children:"Progress Over Semesters"}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px"},children:[...Re,qe].map((Je,Ze)=>d.jsxs("div",{style:{padding:"10px",background:Ze===Re.length?"#e3f2fd":"white",borderRadius:"6px",border:"1px solid #e0e0e0",textAlign:"center"},children:[d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Semester ",Ze+1]}),d.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:Je.finalScore})]},Ze))})]}),d.jsx("div",{style:{marginTop:"30px",textAlign:"center"},children:Nt?d.jsxs("div",{style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h3",{style:{color:"#856404",marginBottom:"10px"},children:" All semesters complete!"}),d.jsx("p",{style:{color:"#856404",marginBottom:"0"},children:"Return to the Qualtrics survey and enter your completion code to finish the study."})]}):d.jsxs("button",{onClick:ze,style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",ne+1," "]})})]})}return n==="allocation"?d.jsx(TI,{onStart:yu}):n==="bonus_round"?d.jsx(AI,{timeRemaining:Ke,onSelectTask:K=>{const G=[...Pn,K];Ss(G);const H=Object.keys(p).filter(Ie=>Ie.startsWith(K)).length,se=`${K}t${H+1}`;r("challenge"),As(se,!0)},onFinishEarly:()=>$n("finished_early")}):d.jsx("div",{className:"app",children:d.jsx(II,{currentTaskIndex:on,totalTasks:Pn.length,taskQueue:Pn,onSwitchTask:vu,points:Math.round(_s),timeRemaining:Ke,onTimeUp:()=>$n("time_up"),chatInterface:d.jsx(vI,{bonusPrompts:T,currentTask:u,categoryPoints:Se,timeRemaining:Ke,calculateStudentLearning:an}),children:oa()})})}n0(document.getElementById("root")).render(d.jsx(b.StrictMode,{children:d.jsx(kI,{})}));
//# sourceMappingURL=index-C3d2o3mL.js.map
