(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var nm={exports:{}},su={},rm={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ha=Symbol.for("react.element"),rx=Symbol.for("react.portal"),sx=Symbol.for("react.fragment"),ix=Symbol.for("react.strict_mode"),ox=Symbol.for("react.profiler"),ax=Symbol.for("react.provider"),lx=Symbol.for("react.context"),ux=Symbol.for("react.forward_ref"),cx=Symbol.for("react.suspense"),dx=Symbol.for("react.memo"),hx=Symbol.for("react.lazy"),qf=Symbol.iterator;function fx(t){return t===null||typeof t!="object"?null:(t=qf&&t[qf]||t["@@iterator"],typeof t=="function"?t:null)}var sm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},im=Object.assign,om={};function Li(t,e,n){this.props=t,this.context=e,this.refs=om,this.updater=n||sm}Li.prototype.isReactComponent={};Li.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Li.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function am(){}am.prototype=Li.prototype;function Hd(t,e,n){this.props=t,this.context=e,this.refs=om,this.updater=n||sm}var qd=Hd.prototype=new am;qd.constructor=Hd;im(qd,Li.prototype);qd.isPureReactComponent=!0;var Gf=Array.isArray,lm=Object.prototype.hasOwnProperty,Gd={current:null},um={key:!0,ref:!0,__self:!0,__source:!0};function cm(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)lm.call(e,r)&&!um.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),h=0;h<l;h++)c[h]=arguments[h+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ha,type:t,key:i,ref:a,props:s,_owner:Gd.current}}function px(t,e){return{$$typeof:ha,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Qd(t){return typeof t=="object"&&t!==null&&t.$$typeof===ha}function gx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Qf=/\/+/g;function $u(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gx(""+t.key):e.toString(36)}function il(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case ha:case rx:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+$u(a,0):r,Gf(s)?(n="",t!=null&&(n=t.replace(Qf,"$&/")+"/"),il(s,e,n,"",function(h){return h})):s!=null&&(Qd(s)&&(s=px(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Qf,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",Gf(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+$u(i,l);a+=il(i,e,n,c,s)}else if(c=fx(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+$u(i,l++),a+=il(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Fa(t,e,n){if(t==null)return t;var r=[],s=0;return il(t,r,"","",function(i){return e.call(n,i,s++)}),r}function mx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var $t={current:null},ol={transition:null},yx={ReactCurrentDispatcher:$t,ReactCurrentBatchConfig:ol,ReactCurrentOwner:Gd};function dm(){throw Error("act(...) is not supported in production builds of React.")}me.Children={map:Fa,forEach:function(t,e,n){Fa(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Fa(t,function(){e++}),e},toArray:function(t){return Fa(t,function(e){return e})||[]},only:function(t){if(!Qd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};me.Component=Li;me.Fragment=sx;me.Profiler=ox;me.PureComponent=Hd;me.StrictMode=ix;me.Suspense=cx;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yx;me.act=dm;me.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=im({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Gd.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)lm.call(e,c)&&!um.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var h=0;h<c;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:ha,type:t.type,key:s,ref:i,props:r,_owner:a}};me.createContext=function(t){return t={$$typeof:lx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ax,_context:t},t.Consumer=t};me.createElement=cm;me.createFactory=function(t){var e=cm.bind(null,t);return e.type=t,e};me.createRef=function(){return{current:null}};me.forwardRef=function(t){return{$$typeof:ux,render:t}};me.isValidElement=Qd;me.lazy=function(t){return{$$typeof:hx,_payload:{_status:-1,_result:t},_init:mx}};me.memo=function(t,e){return{$$typeof:dx,type:t,compare:e===void 0?null:e}};me.startTransition=function(t){var e=ol.transition;ol.transition={};try{t()}finally{ol.transition=e}};me.unstable_act=dm;me.useCallback=function(t,e){return $t.current.useCallback(t,e)};me.useContext=function(t){return $t.current.useContext(t)};me.useDebugValue=function(){};me.useDeferredValue=function(t){return $t.current.useDeferredValue(t)};me.useEffect=function(t,e){return $t.current.useEffect(t,e)};me.useId=function(){return $t.current.useId()};me.useImperativeHandle=function(t,e,n){return $t.current.useImperativeHandle(t,e,n)};me.useInsertionEffect=function(t,e){return $t.current.useInsertionEffect(t,e)};me.useLayoutEffect=function(t,e){return $t.current.useLayoutEffect(t,e)};me.useMemo=function(t,e){return $t.current.useMemo(t,e)};me.useReducer=function(t,e,n){return $t.current.useReducer(t,e,n)};me.useRef=function(t){return $t.current.useRef(t)};me.useState=function(t){return $t.current.useState(t)};me.useSyncExternalStore=function(t,e,n){return $t.current.useSyncExternalStore(t,e,n)};me.useTransition=function(){return $t.current.useTransition()};me.version="18.3.1";rm.exports=me;var M=rm.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vx=M,xx=Symbol.for("react.element"),_x=Symbol.for("react.fragment"),wx=Object.prototype.hasOwnProperty,Sx=vx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ex={key:!0,ref:!0,__self:!0,__source:!0};function hm(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)wx.call(e,r)&&!Ex.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:xx,type:t,key:i,ref:a,props:s,_owner:Sx.current}}su.Fragment=_x;su.jsx=hm;su.jsxs=hm;nm.exports=su;var u=nm.exports,fm={exports:{}},cn={},pm={exports:{}},gm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(b,D){var L=b.length;b.push(D);e:for(;0<L;){var O=L-1>>>1,Y=b[O];if(0<s(Y,D))b[O]=D,b[L]=Y,L=O;else break e}}function n(b){return b.length===0?null:b[0]}function r(b){if(b.length===0)return null;var D=b[0],L=b.pop();if(L!==D){b[0]=L;e:for(var O=0,Y=b.length,q=Y>>>1;O<q;){var ne=2*(O+1)-1,oe=b[ne],ye=ne+1,ge=b[ye];if(0>s(oe,L))ye<Y&&0>s(ge,oe)?(b[O]=ge,b[ye]=L,O=ye):(b[O]=oe,b[ne]=L,O=ne);else if(ye<Y&&0>s(ge,L))b[O]=ge,b[ye]=L,O=ye;else break e}}return D}function s(b,D){var L=b.sortIndex-D.sortIndex;return L!==0?L:b.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],h=[],p=1,m=null,y=3,C=!1,k=!1,P=!1,z=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(b){for(var D=n(h);D!==null;){if(D.callback===null)r(h);else if(D.startTime<=b)r(h),D.sortIndex=D.expirationTime,e(c,D);else break;D=n(h)}}function V(b){if(P=!1,T(b),!k)if(n(c)!==null)k=!0,ce($);else{var D=n(h);D!==null&&U(V,D.startTime-b)}}function $(b,D){k=!1,P&&(P=!1,A(g),g=-1),C=!0;var L=y;try{for(T(D),m=n(c);m!==null&&(!(m.expirationTime>D)||b&&!v());){var O=m.callback;if(typeof O=="function"){m.callback=null,y=m.priorityLevel;var Y=O(m.expirationTime<=D);D=t.unstable_now(),typeof Y=="function"?m.callback=Y:m===n(c)&&r(c),T(D)}else r(c);m=n(c)}if(m!==null)var q=!0;else{var ne=n(h);ne!==null&&U(V,ne.startTime-D),q=!1}return q}finally{m=null,y=L,C=!1}}var j=!1,E=null,g=-1,S=5,I=-1;function v(){return!(t.unstable_now()-I<S)}function R(){if(E!==null){var b=t.unstable_now();I=b;var D=!0;try{D=E(!0,b)}finally{D?_():(j=!1,E=null)}}else j=!1}var _;if(typeof w=="function")_=function(){w(R)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,Z=ee.port2;ee.port1.onmessage=R,_=function(){Z.postMessage(null)}}else _=function(){z(R,0)};function ce(b){E=b,j||(j=!0,_())}function U(b,D){g=z(function(){b(t.unstable_now())},D)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(b){b.callback=null},t.unstable_continueExecution=function(){k||C||(k=!0,ce($))},t.unstable_forceFrameRate=function(b){0>b||125<b?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<b?Math.floor(1e3/b):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(b){switch(y){case 1:case 2:case 3:var D=3;break;default:D=y}var L=y;y=D;try{return b()}finally{y=L}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(b,D){switch(b){case 1:case 2:case 3:case 4:case 5:break;default:b=3}var L=y;y=b;try{return D()}finally{y=L}},t.unstable_scheduleCallback=function(b,D,L){var O=t.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?O+L:O):L=O,b){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=L+Y,b={id:p++,callback:D,priorityLevel:b,startTime:L,expirationTime:Y,sortIndex:-1},L>O?(b.sortIndex=L,e(h,b),n(c)===null&&b===n(h)&&(P?(A(g),g=-1):P=!0,U(V,L-O))):(b.sortIndex=Y,e(c,b),k||C||(k=!0,ce($))),b},t.unstable_shouldYield=v,t.unstable_wrapCallback=function(b){var D=y;return function(){var L=y;y=D;try{return b.apply(this,arguments)}finally{y=L}}}})(gm);pm.exports=gm;var Tx=pm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ix=M,un=Tx;function K(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mm=new Set,Oo={};function Vs(t,e){Ei(t,e),Ei(t+"Capture",e)}function Ei(t,e){for(Oo[t]=e,t=0;t<e.length;t++)mm.add(e[t])}var pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ac=Object.prototype.hasOwnProperty,Cx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Kf={},Yf={};function Ax(t){return Ac.call(Yf,t)?!0:Ac.call(Kf,t)?!1:Cx.test(t)?Yf[t]=!0:(Kf[t]=!0,!1)}function kx(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Rx(t,e,n,r){if(e===null||typeof e>"u"||kx(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Wt(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Tt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tt[t]=new Wt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tt[e]=new Wt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tt[t]=new Wt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tt[t]=new Wt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tt[t]=new Wt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tt[t]=new Wt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tt[t]=new Wt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tt[t]=new Wt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tt[t]=new Wt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Kd=/[\-:]([a-z])/g;function Yd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Kd,Yd);Tt[e]=new Wt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Kd,Yd);Tt[e]=new Wt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Kd,Yd);Tt[e]=new Wt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tt[t]=new Wt(t,1,!1,t.toLowerCase(),null,!1,!1)});Tt.xlinkHref=new Wt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tt[t]=new Wt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Xd(t,e,n,r){var s=Tt.hasOwnProperty(e)?Tt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Rx(e,n,s,r)&&(n=null),r||s===null?Ax(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Sr=Ix.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oa=Symbol.for("react.element"),ri=Symbol.for("react.portal"),si=Symbol.for("react.fragment"),Jd=Symbol.for("react.strict_mode"),kc=Symbol.for("react.profiler"),ym=Symbol.for("react.provider"),vm=Symbol.for("react.context"),Zd=Symbol.for("react.forward_ref"),Rc=Symbol.for("react.suspense"),Pc=Symbol.for("react.suspense_list"),eh=Symbol.for("react.memo"),Pr=Symbol.for("react.lazy"),xm=Symbol.for("react.offscreen"),Xf=Symbol.iterator;function lo(t){return t===null||typeof t!="object"?null:(t=Xf&&t[Xf]||t["@@iterator"],typeof t=="function"?t:null)}var qe=Object.assign,Wu;function vo(t){if(Wu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Wu=e&&e[1]||""}return`
`+Wu+t}var Hu=!1;function qu(t,e){if(!t||Hu)return"";Hu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{Hu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?vo(t):""}function Px(t){switch(t.tag){case 5:return vo(t.type);case 16:return vo("Lazy");case 13:return vo("Suspense");case 19:return vo("SuspenseList");case 0:case 2:case 15:return t=qu(t.type,!1),t;case 11:return t=qu(t.type.render,!1),t;case 1:return t=qu(t.type,!0),t;default:return""}}function bc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case si:return"Fragment";case ri:return"Portal";case kc:return"Profiler";case Jd:return"StrictMode";case Rc:return"Suspense";case Pc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case vm:return(t.displayName||"Context")+".Consumer";case ym:return(t._context.displayName||"Context")+".Provider";case Zd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case eh:return e=t.displayName||null,e!==null?e:bc(t.type)||"Memo";case Pr:e=t._payload,t=t._init;try{return bc(t(e))}catch{}}return null}function bx(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bc(e);case 8:return e===Jd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Kr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _m(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Dx(t){var e=_m(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function za(t){t._valueTracker||(t._valueTracker=Dx(t))}function wm(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_m(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function El(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Dc(t,e){var n=e.checked;return qe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Jf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Kr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Sm(t,e){e=e.checked,e!=null&&Xd(t,"checked",e,!1)}function jc(t,e){Sm(t,e);var n=Kr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Nc(t,e.type,n):e.hasOwnProperty("defaultValue")&&Nc(t,e.type,Kr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Zf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Nc(t,e,n){(e!=="number"||El(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var xo=Array.isArray;function gi(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Kr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Mc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(K(91));return qe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ep(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(K(92));if(xo(n)){if(1<n.length)throw Error(K(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Kr(n)}}function Em(t,e){var n=Kr(e.value),r=Kr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function tp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Tm(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Tm(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ba,Im=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ba=Ba||document.createElement("div"),Ba.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ba.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Co={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jx=["Webkit","ms","Moz","O"];Object.keys(Co).forEach(function(t){jx.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Co[e]=Co[t]})});function Cm(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Co.hasOwnProperty(t)&&Co[t]?(""+e).trim():e+"px"}function Am(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Cm(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Nx=qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lc(t,e){if(e){if(Nx[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(K(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(K(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(K(61))}if(e.style!=null&&typeof e.style!="object")throw Error(K(62))}}function Fc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Oc=null;function th(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var zc=null,mi=null,yi=null;function np(t){if(t=ga(t)){if(typeof zc!="function")throw Error(K(280));var e=t.stateNode;e&&(e=uu(e),zc(t.stateNode,t.type,e))}}function km(t){mi?yi?yi.push(t):yi=[t]:mi=t}function Rm(){if(mi){var t=mi,e=yi;if(yi=mi=null,np(t),e)for(t=0;t<e.length;t++)np(e[t])}}function Pm(t,e){return t(e)}function bm(){}var Gu=!1;function Dm(t,e,n){if(Gu)return t(e,n);Gu=!0;try{return Pm(t,e,n)}finally{Gu=!1,(mi!==null||yi!==null)&&(bm(),Rm())}}function Bo(t,e){var n=t.stateNode;if(n===null)return null;var r=uu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(K(231,e,typeof n));return n}var Bc=!1;if(pr)try{var uo={};Object.defineProperty(uo,"passive",{get:function(){Bc=!0}}),window.addEventListener("test",uo,uo),window.removeEventListener("test",uo,uo)}catch{Bc=!1}function Mx(t,e,n,r,s,i,a,l,c){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var Ao=!1,Tl=null,Il=!1,Uc=null,Vx={onError:function(t){Ao=!0,Tl=t}};function Lx(t,e,n,r,s,i,a,l,c){Ao=!1,Tl=null,Mx.apply(Vx,arguments)}function Fx(t,e,n,r,s,i,a,l,c){if(Lx.apply(this,arguments),Ao){if(Ao){var h=Tl;Ao=!1,Tl=null}else throw Error(K(198));Il||(Il=!0,Uc=h)}}function Ls(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function jm(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function rp(t){if(Ls(t)!==t)throw Error(K(188))}function Ox(t){var e=t.alternate;if(!e){if(e=Ls(t),e===null)throw Error(K(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return rp(s),t;if(i===r)return rp(s),e;i=i.sibling}throw Error(K(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(K(189))}}if(n.alternate!==r)throw Error(K(190))}if(n.tag!==3)throw Error(K(188));return n.stateNode.current===n?t:e}function Nm(t){return t=Ox(t),t!==null?Mm(t):null}function Mm(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Mm(t);if(e!==null)return e;t=t.sibling}return null}var Vm=un.unstable_scheduleCallback,sp=un.unstable_cancelCallback,zx=un.unstable_shouldYield,Bx=un.unstable_requestPaint,tt=un.unstable_now,Ux=un.unstable_getCurrentPriorityLevel,nh=un.unstable_ImmediatePriority,Lm=un.unstable_UserBlockingPriority,Cl=un.unstable_NormalPriority,$x=un.unstable_LowPriority,Fm=un.unstable_IdlePriority,iu=null,Kn=null;function Wx(t){if(Kn&&typeof Kn.onCommitFiberRoot=="function")try{Kn.onCommitFiberRoot(iu,t,void 0,(t.current.flags&128)===128)}catch{}}var Nn=Math.clz32?Math.clz32:Gx,Hx=Math.log,qx=Math.LN2;function Gx(t){return t>>>=0,t===0?32:31-(Hx(t)/qx|0)|0}var Ua=64,$a=4194304;function _o(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Al(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=_o(l):(i&=a,i!==0&&(r=_o(i)))}else a=n&~s,a!==0?r=_o(a):i!==0&&(r=_o(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Nn(e),s=1<<n,r|=t[n],e&=~s;return r}function Qx(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kx(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Nn(i),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=Qx(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function $c(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Om(){var t=Ua;return Ua<<=1,!(Ua&4194240)&&(Ua=64),t}function Qu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function fa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Nn(e),t[e]=n}function Yx(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Nn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function rh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Nn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var De=0;function zm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Bm,sh,Um,$m,Wm,Wc=!1,Wa=[],Lr=null,Fr=null,Or=null,Uo=new Map,$o=new Map,Dr=[],Xx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ip(t,e){switch(t){case"focusin":case"focusout":Lr=null;break;case"dragenter":case"dragleave":Fr=null;break;case"mouseover":case"mouseout":Or=null;break;case"pointerover":case"pointerout":Uo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$o.delete(e.pointerId)}}function co(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=ga(e),e!==null&&sh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Jx(t,e,n,r,s){switch(e){case"focusin":return Lr=co(Lr,t,e,n,r,s),!0;case"dragenter":return Fr=co(Fr,t,e,n,r,s),!0;case"mouseover":return Or=co(Or,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Uo.set(i,co(Uo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,$o.set(i,co($o.get(i)||null,t,e,n,r,s)),!0}return!1}function Hm(t){var e=ws(t.target);if(e!==null){var n=Ls(e);if(n!==null){if(e=n.tag,e===13){if(e=jm(n),e!==null){t.blockedOn=e,Wm(t.priority,function(){Um(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function al(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Hc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Oc=r,n.target.dispatchEvent(r),Oc=null}else return e=ga(n),e!==null&&sh(e),t.blockedOn=n,!1;e.shift()}return!0}function op(t,e,n){al(t)&&n.delete(e)}function Zx(){Wc=!1,Lr!==null&&al(Lr)&&(Lr=null),Fr!==null&&al(Fr)&&(Fr=null),Or!==null&&al(Or)&&(Or=null),Uo.forEach(op),$o.forEach(op)}function ho(t,e){t.blockedOn===e&&(t.blockedOn=null,Wc||(Wc=!0,un.unstable_scheduleCallback(un.unstable_NormalPriority,Zx)))}function Wo(t){function e(s){return ho(s,t)}if(0<Wa.length){ho(Wa[0],t);for(var n=1;n<Wa.length;n++){var r=Wa[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Lr!==null&&ho(Lr,t),Fr!==null&&ho(Fr,t),Or!==null&&ho(Or,t),Uo.forEach(e),$o.forEach(e),n=0;n<Dr.length;n++)r=Dr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Dr.length&&(n=Dr[0],n.blockedOn===null);)Hm(n),n.blockedOn===null&&Dr.shift()}var vi=Sr.ReactCurrentBatchConfig,kl=!0;function e_(t,e,n,r){var s=De,i=vi.transition;vi.transition=null;try{De=1,ih(t,e,n,r)}finally{De=s,vi.transition=i}}function t_(t,e,n,r){var s=De,i=vi.transition;vi.transition=null;try{De=4,ih(t,e,n,r)}finally{De=s,vi.transition=i}}function ih(t,e,n,r){if(kl){var s=Hc(t,e,n,r);if(s===null)sc(t,e,r,Rl,n),ip(t,r);else if(Jx(s,t,e,n,r))r.stopPropagation();else if(ip(t,r),e&4&&-1<Xx.indexOf(t)){for(;s!==null;){var i=ga(s);if(i!==null&&Bm(i),i=Hc(t,e,n,r),i===null&&sc(t,e,r,Rl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else sc(t,e,r,null,n)}}var Rl=null;function Hc(t,e,n,r){if(Rl=null,t=th(r),t=ws(t),t!==null)if(e=Ls(t),e===null)t=null;else if(n=e.tag,n===13){if(t=jm(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Rl=t,null}function qm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ux()){case nh:return 1;case Lm:return 4;case Cl:case $x:return 16;case Fm:return 536870912;default:return 16}default:return 16}}var Nr=null,oh=null,ll=null;function Gm(){if(ll)return ll;var t,e=oh,n=e.length,r,s="value"in Nr?Nr.value:Nr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return ll=s.slice(t,1<r?1-r:void 0)}function ul(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ha(){return!0}function ap(){return!1}function dn(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ha:ap,this.isPropagationStopped=ap,this}return qe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ha)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ha)},persist:function(){},isPersistent:Ha}),e}var Fi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ah=dn(Fi),pa=qe({},Fi,{view:0,detail:0}),n_=dn(pa),Ku,Yu,fo,ou=qe({},pa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fo&&(fo&&t.type==="mousemove"?(Ku=t.screenX-fo.screenX,Yu=t.screenY-fo.screenY):Yu=Ku=0,fo=t),Ku)},movementY:function(t){return"movementY"in t?t.movementY:Yu}}),lp=dn(ou),r_=qe({},ou,{dataTransfer:0}),s_=dn(r_),i_=qe({},pa,{relatedTarget:0}),Xu=dn(i_),o_=qe({},Fi,{animationName:0,elapsedTime:0,pseudoElement:0}),a_=dn(o_),l_=qe({},Fi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),u_=dn(l_),c_=qe({},Fi,{data:0}),up=dn(c_),d_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},h_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},f_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function p_(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=f_[t])?!!e[t]:!1}function lh(){return p_}var g_=qe({},pa,{key:function(t){if(t.key){var e=d_[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ul(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?h_[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lh,charCode:function(t){return t.type==="keypress"?ul(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ul(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),m_=dn(g_),y_=qe({},ou,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cp=dn(y_),v_=qe({},pa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lh}),x_=dn(v_),__=qe({},Fi,{propertyName:0,elapsedTime:0,pseudoElement:0}),w_=dn(__),S_=qe({},ou,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),E_=dn(S_),T_=[9,13,27,32],uh=pr&&"CompositionEvent"in window,ko=null;pr&&"documentMode"in document&&(ko=document.documentMode);var I_=pr&&"TextEvent"in window&&!ko,Qm=pr&&(!uh||ko&&8<ko&&11>=ko),dp=" ",hp=!1;function Km(t,e){switch(t){case"keyup":return T_.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ym(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ii=!1;function C_(t,e){switch(t){case"compositionend":return Ym(e);case"keypress":return e.which!==32?null:(hp=!0,dp);case"textInput":return t=e.data,t===dp&&hp?null:t;default:return null}}function A_(t,e){if(ii)return t==="compositionend"||!uh&&Km(t,e)?(t=Gm(),ll=oh=Nr=null,ii=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Qm&&e.locale!=="ko"?null:e.data;default:return null}}var k_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!k_[t.type]:e==="textarea"}function Xm(t,e,n,r){km(r),e=Pl(e,"onChange"),0<e.length&&(n=new ah("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ro=null,Ho=null;function R_(t){ly(t,0)}function au(t){var e=li(t);if(wm(e))return t}function P_(t,e){if(t==="change")return e}var Jm=!1;if(pr){var Ju;if(pr){var Zu="oninput"in document;if(!Zu){var pp=document.createElement("div");pp.setAttribute("oninput","return;"),Zu=typeof pp.oninput=="function"}Ju=Zu}else Ju=!1;Jm=Ju&&(!document.documentMode||9<document.documentMode)}function gp(){Ro&&(Ro.detachEvent("onpropertychange",Zm),Ho=Ro=null)}function Zm(t){if(t.propertyName==="value"&&au(Ho)){var e=[];Xm(e,Ho,t,th(t)),Dm(R_,e)}}function b_(t,e,n){t==="focusin"?(gp(),Ro=e,Ho=n,Ro.attachEvent("onpropertychange",Zm)):t==="focusout"&&gp()}function D_(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return au(Ho)}function j_(t,e){if(t==="click")return au(e)}function N_(t,e){if(t==="input"||t==="change")return au(e)}function M_(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ln=typeof Object.is=="function"?Object.is:M_;function qo(t,e){if(Ln(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ac.call(e,s)||!Ln(t[s],e[s]))return!1}return!0}function mp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function yp(t,e){var n=mp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=mp(n)}}function ey(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ey(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ty(){for(var t=window,e=El();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=El(t.document)}return e}function ch(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function V_(t){var e=ty(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&ey(n.ownerDocument.documentElement,n)){if(r!==null&&ch(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=yp(n,i);var a=yp(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var L_=pr&&"documentMode"in document&&11>=document.documentMode,oi=null,qc=null,Po=null,Gc=!1;function vp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Gc||oi==null||oi!==El(r)||(r=oi,"selectionStart"in r&&ch(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Po&&qo(Po,r)||(Po=r,r=Pl(qc,"onSelect"),0<r.length&&(e=new ah("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=oi)))}function qa(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ai={animationend:qa("Animation","AnimationEnd"),animationiteration:qa("Animation","AnimationIteration"),animationstart:qa("Animation","AnimationStart"),transitionend:qa("Transition","TransitionEnd")},ec={},ny={};pr&&(ny=document.createElement("div").style,"AnimationEvent"in window||(delete ai.animationend.animation,delete ai.animationiteration.animation,delete ai.animationstart.animation),"TransitionEvent"in window||delete ai.transitionend.transition);function lu(t){if(ec[t])return ec[t];if(!ai[t])return t;var e=ai[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in ny)return ec[t]=e[n];return t}var ry=lu("animationend"),sy=lu("animationiteration"),iy=lu("animationstart"),oy=lu("transitionend"),ay=new Map,xp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function es(t,e){ay.set(t,e),Vs(e,[t])}for(var tc=0;tc<xp.length;tc++){var nc=xp[tc],F_=nc.toLowerCase(),O_=nc[0].toUpperCase()+nc.slice(1);es(F_,"on"+O_)}es(ry,"onAnimationEnd");es(sy,"onAnimationIteration");es(iy,"onAnimationStart");es("dblclick","onDoubleClick");es("focusin","onFocus");es("focusout","onBlur");es(oy,"onTransitionEnd");Ei("onMouseEnter",["mouseout","mouseover"]);Ei("onMouseLeave",["mouseout","mouseover"]);Ei("onPointerEnter",["pointerout","pointerover"]);Ei("onPointerLeave",["pointerout","pointerover"]);Vs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),z_=new Set("cancel close invalid load scroll toggle".split(" ").concat(wo));function _p(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Fx(r,e,void 0,t),t.currentTarget=null}function ly(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,h=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;_p(s,l,h),i=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,h=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;_p(s,l,h),i=c}}}if(Il)throw t=Uc,Il=!1,Uc=null,t}function Oe(t,e){var n=e[Jc];n===void 0&&(n=e[Jc]=new Set);var r=t+"__bubble";n.has(r)||(uy(e,t,2,!1),n.add(r))}function rc(t,e,n){var r=0;e&&(r|=4),uy(n,t,r,e)}var Ga="_reactListening"+Math.random().toString(36).slice(2);function Go(t){if(!t[Ga]){t[Ga]=!0,mm.forEach(function(n){n!=="selectionchange"&&(z_.has(n)||rc(n,!1,t),rc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ga]||(e[Ga]=!0,rc("selectionchange",!1,e))}}function uy(t,e,n,r){switch(qm(e)){case 1:var s=e_;break;case 4:s=t_;break;default:s=ih}n=s.bind(null,e,n,t),s=void 0,!Bc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function sc(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=ws(l),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}l=l.parentNode}}r=r.return}Dm(function(){var h=i,p=th(n),m=[];e:{var y=ay.get(t);if(y!==void 0){var C=ah,k=t;switch(t){case"keypress":if(ul(n)===0)break e;case"keydown":case"keyup":C=m_;break;case"focusin":k="focus",C=Xu;break;case"focusout":k="blur",C=Xu;break;case"beforeblur":case"afterblur":C=Xu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=lp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=s_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=x_;break;case ry:case sy:case iy:C=a_;break;case oy:C=w_;break;case"scroll":C=n_;break;case"wheel":C=E_;break;case"copy":case"cut":case"paste":C=u_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=cp}var P=(e&4)!==0,z=!P&&t==="scroll",A=P?y!==null?y+"Capture":null:y;P=[];for(var w=h,T;w!==null;){T=w;var V=T.stateNode;if(T.tag===5&&V!==null&&(T=V,A!==null&&(V=Bo(w,A),V!=null&&P.push(Qo(w,V,T)))),z)break;w=w.return}0<P.length&&(y=new C(y,k,null,n,p),m.push({event:y,listeners:P}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",C=t==="mouseout"||t==="pointerout",y&&n!==Oc&&(k=n.relatedTarget||n.fromElement)&&(ws(k)||k[gr]))break e;if((C||y)&&(y=p.window===p?p:(y=p.ownerDocument)?y.defaultView||y.parentWindow:window,C?(k=n.relatedTarget||n.toElement,C=h,k=k?ws(k):null,k!==null&&(z=Ls(k),k!==z||k.tag!==5&&k.tag!==6)&&(k=null)):(C=null,k=h),C!==k)){if(P=lp,V="onMouseLeave",A="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(P=cp,V="onPointerLeave",A="onPointerEnter",w="pointer"),z=C==null?y:li(C),T=k==null?y:li(k),y=new P(V,w+"leave",C,n,p),y.target=z,y.relatedTarget=T,V=null,ws(p)===h&&(P=new P(A,w+"enter",k,n,p),P.target=T,P.relatedTarget=z,V=P),z=V,C&&k)t:{for(P=C,A=k,w=0,T=P;T;T=Zs(T))w++;for(T=0,V=A;V;V=Zs(V))T++;for(;0<w-T;)P=Zs(P),w--;for(;0<T-w;)A=Zs(A),T--;for(;w--;){if(P===A||A!==null&&P===A.alternate)break t;P=Zs(P),A=Zs(A)}P=null}else P=null;C!==null&&wp(m,y,C,P,!1),k!==null&&z!==null&&wp(m,z,k,P,!0)}}e:{if(y=h?li(h):window,C=y.nodeName&&y.nodeName.toLowerCase(),C==="select"||C==="input"&&y.type==="file")var $=P_;else if(fp(y))if(Jm)$=N_;else{$=D_;var j=b_}else(C=y.nodeName)&&C.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&($=j_);if($&&($=$(t,h))){Xm(m,$,n,p);break e}j&&j(t,y,h),t==="focusout"&&(j=y._wrapperState)&&j.controlled&&y.type==="number"&&Nc(y,"number",y.value)}switch(j=h?li(h):window,t){case"focusin":(fp(j)||j.contentEditable==="true")&&(oi=j,qc=h,Po=null);break;case"focusout":Po=qc=oi=null;break;case"mousedown":Gc=!0;break;case"contextmenu":case"mouseup":case"dragend":Gc=!1,vp(m,n,p);break;case"selectionchange":if(L_)break;case"keydown":case"keyup":vp(m,n,p)}var E;if(uh)e:{switch(t){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else ii?Km(t,n)&&(g="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(g="onCompositionStart");g&&(Qm&&n.locale!=="ko"&&(ii||g!=="onCompositionStart"?g==="onCompositionEnd"&&ii&&(E=Gm()):(Nr=p,oh="value"in Nr?Nr.value:Nr.textContent,ii=!0)),j=Pl(h,g),0<j.length&&(g=new up(g,t,null,n,p),m.push({event:g,listeners:j}),E?g.data=E:(E=Ym(n),E!==null&&(g.data=E)))),(E=I_?C_(t,n):A_(t,n))&&(h=Pl(h,"onBeforeInput"),0<h.length&&(p=new up("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:h}),p.data=E))}ly(m,e)})}function Qo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Pl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Bo(t,n),i!=null&&r.unshift(Qo(t,i,s)),i=Bo(t,e),i!=null&&r.push(Qo(t,i,s))),t=t.return}return r}function Zs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function wp(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,h=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&h!==null&&(l=h,s?(c=Bo(n,i),c!=null&&a.unshift(Qo(n,c,l))):s||(c=Bo(n,i),c!=null&&a.push(Qo(n,c,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var B_=/\r\n?/g,U_=/\u0000|\uFFFD/g;function Sp(t){return(typeof t=="string"?t:""+t).replace(B_,`
`).replace(U_,"")}function Qa(t,e,n){if(e=Sp(e),Sp(t)!==e&&n)throw Error(K(425))}function bl(){}var Qc=null,Kc=null;function Yc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Xc=typeof setTimeout=="function"?setTimeout:void 0,$_=typeof clearTimeout=="function"?clearTimeout:void 0,Ep=typeof Promise=="function"?Promise:void 0,W_=typeof queueMicrotask=="function"?queueMicrotask:typeof Ep<"u"?function(t){return Ep.resolve(null).then(t).catch(H_)}:Xc;function H_(t){setTimeout(function(){throw t})}function ic(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Wo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Wo(e)}function zr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Tp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Oi=Math.random().toString(36).slice(2),Qn="__reactFiber$"+Oi,Ko="__reactProps$"+Oi,gr="__reactContainer$"+Oi,Jc="__reactEvents$"+Oi,q_="__reactListeners$"+Oi,G_="__reactHandles$"+Oi;function ws(t){var e=t[Qn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[gr]||n[Qn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Tp(t);t!==null;){if(n=t[Qn])return n;t=Tp(t)}return e}t=n,n=t.parentNode}return null}function ga(t){return t=t[Qn]||t[gr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function li(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(K(33))}function uu(t){return t[Ko]||null}var Zc=[],ui=-1;function ts(t){return{current:t}}function Be(t){0>ui||(t.current=Zc[ui],Zc[ui]=null,ui--)}function Fe(t,e){ui++,Zc[ui]=t.current,t.current=e}var Yr={},Vt=ts(Yr),Jt=ts(!1),ks=Yr;function Ti(t,e){var n=t.type.contextTypes;if(!n)return Yr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Zt(t){return t=t.childContextTypes,t!=null}function Dl(){Be(Jt),Be(Vt)}function Ip(t,e,n){if(Vt.current!==Yr)throw Error(K(168));Fe(Vt,e),Fe(Jt,n)}function cy(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(K(108,bx(t)||"Unknown",s));return qe({},n,r)}function jl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Yr,ks=Vt.current,Fe(Vt,t),Fe(Jt,Jt.current),!0}function Cp(t,e,n){var r=t.stateNode;if(!r)throw Error(K(169));n?(t=cy(t,e,ks),r.__reactInternalMemoizedMergedChildContext=t,Be(Jt),Be(Vt),Fe(Vt,t)):Be(Jt),Fe(Jt,n)}var lr=null,cu=!1,oc=!1;function dy(t){lr===null?lr=[t]:lr.push(t)}function Q_(t){cu=!0,dy(t)}function ns(){if(!oc&&lr!==null){oc=!0;var t=0,e=De;try{var n=lr;for(De=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}lr=null,cu=!1}catch(s){throw lr!==null&&(lr=lr.slice(t+1)),Vm(nh,ns),s}finally{De=e,oc=!1}}return null}var ci=[],di=0,Nl=null,Ml=0,mn=[],yn=0,Rs=null,cr=1,dr="";function vs(t,e){ci[di++]=Ml,ci[di++]=Nl,Nl=t,Ml=e}function hy(t,e,n){mn[yn++]=cr,mn[yn++]=dr,mn[yn++]=Rs,Rs=t;var r=cr;t=dr;var s=32-Nn(r)-1;r&=~(1<<s),n+=1;var i=32-Nn(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,cr=1<<32-Nn(e)+s|n<<s|r,dr=i+t}else cr=1<<i|n<<s|r,dr=t}function dh(t){t.return!==null&&(vs(t,1),hy(t,1,0))}function hh(t){for(;t===Nl;)Nl=ci[--di],ci[di]=null,Ml=ci[--di],ci[di]=null;for(;t===Rs;)Rs=mn[--yn],mn[yn]=null,dr=mn[--yn],mn[yn]=null,cr=mn[--yn],mn[yn]=null}var ln=null,on=null,$e=!1,Dn=null;function fy(t,e){var n=vn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ap(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ln=t,on=zr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ln=t,on=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Rs!==null?{id:cr,overflow:dr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=vn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ln=t,on=null,!0):!1;default:return!1}}function ed(t){return(t.mode&1)!==0&&(t.flags&128)===0}function td(t){if($e){var e=on;if(e){var n=e;if(!Ap(t,e)){if(ed(t))throw Error(K(418));e=zr(n.nextSibling);var r=ln;e&&Ap(t,e)?fy(r,n):(t.flags=t.flags&-4097|2,$e=!1,ln=t)}}else{if(ed(t))throw Error(K(418));t.flags=t.flags&-4097|2,$e=!1,ln=t}}}function kp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ln=t}function Ka(t){if(t!==ln)return!1;if(!$e)return kp(t),$e=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Yc(t.type,t.memoizedProps)),e&&(e=on)){if(ed(t))throw py(),Error(K(418));for(;e;)fy(t,e),e=zr(e.nextSibling)}if(kp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){on=zr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}on=null}}else on=ln?zr(t.stateNode.nextSibling):null;return!0}function py(){for(var t=on;t;)t=zr(t.nextSibling)}function Ii(){on=ln=null,$e=!1}function fh(t){Dn===null?Dn=[t]:Dn.push(t)}var K_=Sr.ReactCurrentBatchConfig;function po(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(K(309));var r=n.stateNode}if(!r)throw Error(K(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(K(284));if(!n._owner)throw Error(K(290,t))}return t}function Ya(t,e){throw t=Object.prototype.toString.call(e),Error(K(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Rp(t){var e=t._init;return e(t._payload)}function gy(t){function e(A,w){if(t){var T=A.deletions;T===null?(A.deletions=[w],A.flags|=16):T.push(w)}}function n(A,w){if(!t)return null;for(;w!==null;)e(A,w),w=w.sibling;return null}function r(A,w){for(A=new Map;w!==null;)w.key!==null?A.set(w.key,w):A.set(w.index,w),w=w.sibling;return A}function s(A,w){return A=Wr(A,w),A.index=0,A.sibling=null,A}function i(A,w,T){return A.index=T,t?(T=A.alternate,T!==null?(T=T.index,T<w?(A.flags|=2,w):T):(A.flags|=2,w)):(A.flags|=1048576,w)}function a(A){return t&&A.alternate===null&&(A.flags|=2),A}function l(A,w,T,V){return w===null||w.tag!==6?(w=fc(T,A.mode,V),w.return=A,w):(w=s(w,T),w.return=A,w)}function c(A,w,T,V){var $=T.type;return $===si?p(A,w,T.props.children,V,T.key):w!==null&&(w.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Pr&&Rp($)===w.type)?(V=s(w,T.props),V.ref=po(A,w,T),V.return=A,V):(V=ml(T.type,T.key,T.props,null,A.mode,V),V.ref=po(A,w,T),V.return=A,V)}function h(A,w,T,V){return w===null||w.tag!==4||w.stateNode.containerInfo!==T.containerInfo||w.stateNode.implementation!==T.implementation?(w=pc(T,A.mode,V),w.return=A,w):(w=s(w,T.children||[]),w.return=A,w)}function p(A,w,T,V,$){return w===null||w.tag!==7?(w=Cs(T,A.mode,V,$),w.return=A,w):(w=s(w,T),w.return=A,w)}function m(A,w,T){if(typeof w=="string"&&w!==""||typeof w=="number")return w=fc(""+w,A.mode,T),w.return=A,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Oa:return T=ml(w.type,w.key,w.props,null,A.mode,T),T.ref=po(A,null,w),T.return=A,T;case ri:return w=pc(w,A.mode,T),w.return=A,w;case Pr:var V=w._init;return m(A,V(w._payload),T)}if(xo(w)||lo(w))return w=Cs(w,A.mode,T,null),w.return=A,w;Ya(A,w)}return null}function y(A,w,T,V){var $=w!==null?w.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return $!==null?null:l(A,w,""+T,V);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Oa:return T.key===$?c(A,w,T,V):null;case ri:return T.key===$?h(A,w,T,V):null;case Pr:return $=T._init,y(A,w,$(T._payload),V)}if(xo(T)||lo(T))return $!==null?null:p(A,w,T,V,null);Ya(A,T)}return null}function C(A,w,T,V,$){if(typeof V=="string"&&V!==""||typeof V=="number")return A=A.get(T)||null,l(w,A,""+V,$);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Oa:return A=A.get(V.key===null?T:V.key)||null,c(w,A,V,$);case ri:return A=A.get(V.key===null?T:V.key)||null,h(w,A,V,$);case Pr:var j=V._init;return C(A,w,T,j(V._payload),$)}if(xo(V)||lo(V))return A=A.get(T)||null,p(w,A,V,$,null);Ya(w,V)}return null}function k(A,w,T,V){for(var $=null,j=null,E=w,g=w=0,S=null;E!==null&&g<T.length;g++){E.index>g?(S=E,E=null):S=E.sibling;var I=y(A,E,T[g],V);if(I===null){E===null&&(E=S);break}t&&E&&I.alternate===null&&e(A,E),w=i(I,w,g),j===null?$=I:j.sibling=I,j=I,E=S}if(g===T.length)return n(A,E),$e&&vs(A,g),$;if(E===null){for(;g<T.length;g++)E=m(A,T[g],V),E!==null&&(w=i(E,w,g),j===null?$=E:j.sibling=E,j=E);return $e&&vs(A,g),$}for(E=r(A,E);g<T.length;g++)S=C(E,A,g,T[g],V),S!==null&&(t&&S.alternate!==null&&E.delete(S.key===null?g:S.key),w=i(S,w,g),j===null?$=S:j.sibling=S,j=S);return t&&E.forEach(function(v){return e(A,v)}),$e&&vs(A,g),$}function P(A,w,T,V){var $=lo(T);if(typeof $!="function")throw Error(K(150));if(T=$.call(T),T==null)throw Error(K(151));for(var j=$=null,E=w,g=w=0,S=null,I=T.next();E!==null&&!I.done;g++,I=T.next()){E.index>g?(S=E,E=null):S=E.sibling;var v=y(A,E,I.value,V);if(v===null){E===null&&(E=S);break}t&&E&&v.alternate===null&&e(A,E),w=i(v,w,g),j===null?$=v:j.sibling=v,j=v,E=S}if(I.done)return n(A,E),$e&&vs(A,g),$;if(E===null){for(;!I.done;g++,I=T.next())I=m(A,I.value,V),I!==null&&(w=i(I,w,g),j===null?$=I:j.sibling=I,j=I);return $e&&vs(A,g),$}for(E=r(A,E);!I.done;g++,I=T.next())I=C(E,A,g,I.value,V),I!==null&&(t&&I.alternate!==null&&E.delete(I.key===null?g:I.key),w=i(I,w,g),j===null?$=I:j.sibling=I,j=I);return t&&E.forEach(function(R){return e(A,R)}),$e&&vs(A,g),$}function z(A,w,T,V){if(typeof T=="object"&&T!==null&&T.type===si&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Oa:e:{for(var $=T.key,j=w;j!==null;){if(j.key===$){if($=T.type,$===si){if(j.tag===7){n(A,j.sibling),w=s(j,T.props.children),w.return=A,A=w;break e}}else if(j.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Pr&&Rp($)===j.type){n(A,j.sibling),w=s(j,T.props),w.ref=po(A,j,T),w.return=A,A=w;break e}n(A,j);break}else e(A,j);j=j.sibling}T.type===si?(w=Cs(T.props.children,A.mode,V,T.key),w.return=A,A=w):(V=ml(T.type,T.key,T.props,null,A.mode,V),V.ref=po(A,w,T),V.return=A,A=V)}return a(A);case ri:e:{for(j=T.key;w!==null;){if(w.key===j)if(w.tag===4&&w.stateNode.containerInfo===T.containerInfo&&w.stateNode.implementation===T.implementation){n(A,w.sibling),w=s(w,T.children||[]),w.return=A,A=w;break e}else{n(A,w);break}else e(A,w);w=w.sibling}w=pc(T,A.mode,V),w.return=A,A=w}return a(A);case Pr:return j=T._init,z(A,w,j(T._payload),V)}if(xo(T))return k(A,w,T,V);if(lo(T))return P(A,w,T,V);Ya(A,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,w!==null&&w.tag===6?(n(A,w.sibling),w=s(w,T),w.return=A,A=w):(n(A,w),w=fc(T,A.mode,V),w.return=A,A=w),a(A)):n(A,w)}return z}var Ci=gy(!0),my=gy(!1),Vl=ts(null),Ll=null,hi=null,ph=null;function gh(){ph=hi=Ll=null}function mh(t){var e=Vl.current;Be(Vl),t._currentValue=e}function nd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function xi(t,e){Ll=t,ph=hi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Xt=!0),t.firstContext=null)}function _n(t){var e=t._currentValue;if(ph!==t)if(t={context:t,memoizedValue:e,next:null},hi===null){if(Ll===null)throw Error(K(308));hi=t,Ll.dependencies={lanes:0,firstContext:t}}else hi=hi.next=t;return e}var Ss=null;function yh(t){Ss===null?Ss=[t]:Ss.push(t)}function yy(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,yh(e)):(n.next=s.next,s.next=n),e.interleaved=n,mr(t,r)}function mr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var br=!1;function vh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vy(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function hr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Br(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ce&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,mr(t,n)}return s=r.interleaved,s===null?(e.next=e,yh(r)):(e.next=s.next,s.next=e),r.interleaved=e,mr(t,n)}function cl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rh(t,n)}}function Pp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Fl(t,e,n,r){var s=t.updateQueue;br=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,h=c.next;c.next=null,a===null?i=h:a.next=h,a=c;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==a&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;a=0,p=h=c=null,l=i;do{var y=l.lane,C=l.eventTime;if((r&y)===y){p!==null&&(p=p.next={eventTime:C,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var k=t,P=l;switch(y=e,C=n,P.tag){case 1:if(k=P.payload,typeof k=="function"){m=k.call(C,m,y);break e}m=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=P.payload,y=typeof k=="function"?k.call(C,m,y):k,y==null)break e;m=qe({},m,y);break e;case 2:br=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[l]:y.push(l))}else C={eventTime:C,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=C,c=m):p=p.next=C,a|=y;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;y=l,l=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(p===null&&(c=m),s.baseState=c,s.firstBaseUpdate=h,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);bs|=a,t.lanes=a,t.memoizedState=m}}function bp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(K(191,s));s.call(r)}}}var ma={},Yn=ts(ma),Yo=ts(ma),Xo=ts(ma);function Es(t){if(t===ma)throw Error(K(174));return t}function xh(t,e){switch(Fe(Xo,e),Fe(Yo,t),Fe(Yn,ma),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Vc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Vc(e,t)}Be(Yn),Fe(Yn,e)}function Ai(){Be(Yn),Be(Yo),Be(Xo)}function xy(t){Es(Xo.current);var e=Es(Yn.current),n=Vc(e,t.type);e!==n&&(Fe(Yo,t),Fe(Yn,n))}function _h(t){Yo.current===t&&(Be(Yn),Be(Yo))}var We=ts(0);function Ol(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ac=[];function wh(){for(var t=0;t<ac.length;t++)ac[t]._workInProgressVersionPrimary=null;ac.length=0}var dl=Sr.ReactCurrentDispatcher,lc=Sr.ReactCurrentBatchConfig,Ps=0,He=null,lt=null,ht=null,zl=!1,bo=!1,Jo=0,Y_=0;function Pt(){throw Error(K(321))}function Sh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ln(t[n],e[n]))return!1;return!0}function Eh(t,e,n,r,s,i){if(Ps=i,He=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,dl.current=t===null||t.memoizedState===null?e1:t1,t=n(r,s),bo){i=0;do{if(bo=!1,Jo=0,25<=i)throw Error(K(301));i+=1,ht=lt=null,e.updateQueue=null,dl.current=n1,t=n(r,s)}while(bo)}if(dl.current=Bl,e=lt!==null&&lt.next!==null,Ps=0,ht=lt=He=null,zl=!1,e)throw Error(K(300));return t}function Th(){var t=Jo!==0;return Jo=0,t}function Gn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?He.memoizedState=ht=t:ht=ht.next=t,ht}function wn(){if(lt===null){var t=He.alternate;t=t!==null?t.memoizedState:null}else t=lt.next;var e=ht===null?He.memoizedState:ht.next;if(e!==null)ht=e,lt=t;else{if(t===null)throw Error(K(310));lt=t,t={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},ht===null?He.memoizedState=ht=t:ht=ht.next=t}return ht}function Zo(t,e){return typeof e=="function"?e(t):e}function uc(t){var e=wn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=lt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,c=null,h=i;do{var p=h.lane;if((Ps&p)===p)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var m={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(l=c=m,a=r):c=c.next=m,He.lanes|=p,bs|=p}h=h.next}while(h!==null&&h!==i);c===null?a=r:c.next=l,Ln(r,e.memoizedState)||(Xt=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,He.lanes|=i,bs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function cc(t){var e=wn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Ln(i,e.memoizedState)||(Xt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function _y(){}function wy(t,e){var n=He,r=wn(),s=e(),i=!Ln(r.memoizedState,s);if(i&&(r.memoizedState=s,Xt=!0),r=r.queue,Ih(Ty.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ht!==null&&ht.memoizedState.tag&1){if(n.flags|=2048,ea(9,Ey.bind(null,n,r,s,e),void 0,null),ft===null)throw Error(K(349));Ps&30||Sy(n,e,s)}return s}function Sy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=He.updateQueue,e===null?(e={lastEffect:null,stores:null},He.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Ey(t,e,n,r){e.value=n,e.getSnapshot=r,Iy(e)&&Cy(t)}function Ty(t,e,n){return n(function(){Iy(e)&&Cy(t)})}function Iy(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ln(t,n)}catch{return!0}}function Cy(t){var e=mr(t,1);e!==null&&Mn(e,t,1,-1)}function Dp(t){var e=Gn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zo,lastRenderedState:t},e.queue=t,t=t.dispatch=Z_.bind(null,He,t),[e.memoizedState,t]}function ea(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=He.updateQueue,e===null?(e={lastEffect:null,stores:null},He.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Ay(){return wn().memoizedState}function hl(t,e,n,r){var s=Gn();He.flags|=t,s.memoizedState=ea(1|e,n,void 0,r===void 0?null:r)}function du(t,e,n,r){var s=wn();r=r===void 0?null:r;var i=void 0;if(lt!==null){var a=lt.memoizedState;if(i=a.destroy,r!==null&&Sh(r,a.deps)){s.memoizedState=ea(e,n,i,r);return}}He.flags|=t,s.memoizedState=ea(1|e,n,i,r)}function jp(t,e){return hl(8390656,8,t,e)}function Ih(t,e){return du(2048,8,t,e)}function ky(t,e){return du(4,2,t,e)}function Ry(t,e){return du(4,4,t,e)}function Py(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function by(t,e,n){return n=n!=null?n.concat([t]):null,du(4,4,Py.bind(null,e,t),n)}function Ch(){}function Dy(t,e){var n=wn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Sh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function jy(t,e){var n=wn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Sh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ny(t,e,n){return Ps&21?(Ln(n,e)||(n=Om(),He.lanes|=n,bs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Xt=!0),t.memoizedState=n)}function X_(t,e){var n=De;De=n!==0&&4>n?n:4,t(!0);var r=lc.transition;lc.transition={};try{t(!1),e()}finally{De=n,lc.transition=r}}function My(){return wn().memoizedState}function J_(t,e,n){var r=$r(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Vy(t))Ly(e,n);else if(n=yy(t,e,n,r),n!==null){var s=Bt();Mn(n,t,r,s),Fy(n,e,r)}}function Z_(t,e,n){var r=$r(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Vy(t))Ly(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,Ln(l,a)){var c=e.interleaved;c===null?(s.next=s,yh(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=yy(t,e,s,r),n!==null&&(s=Bt(),Mn(n,t,r,s),Fy(n,e,r))}}function Vy(t){var e=t.alternate;return t===He||e!==null&&e===He}function Ly(t,e){bo=zl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Fy(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rh(t,n)}}var Bl={readContext:_n,useCallback:Pt,useContext:Pt,useEffect:Pt,useImperativeHandle:Pt,useInsertionEffect:Pt,useLayoutEffect:Pt,useMemo:Pt,useReducer:Pt,useRef:Pt,useState:Pt,useDebugValue:Pt,useDeferredValue:Pt,useTransition:Pt,useMutableSource:Pt,useSyncExternalStore:Pt,useId:Pt,unstable_isNewReconciler:!1},e1={readContext:_n,useCallback:function(t,e){return Gn().memoizedState=[t,e===void 0?null:e],t},useContext:_n,useEffect:jp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,hl(4194308,4,Py.bind(null,e,t),n)},useLayoutEffect:function(t,e){return hl(4194308,4,t,e)},useInsertionEffect:function(t,e){return hl(4,2,t,e)},useMemo:function(t,e){var n=Gn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Gn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=J_.bind(null,He,t),[r.memoizedState,t]},useRef:function(t){var e=Gn();return t={current:t},e.memoizedState=t},useState:Dp,useDebugValue:Ch,useDeferredValue:function(t){return Gn().memoizedState=t},useTransition:function(){var t=Dp(!1),e=t[0];return t=X_.bind(null,t[1]),Gn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=He,s=Gn();if($e){if(n===void 0)throw Error(K(407));n=n()}else{if(n=e(),ft===null)throw Error(K(349));Ps&30||Sy(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,jp(Ty.bind(null,r,i,t),[t]),r.flags|=2048,ea(9,Ey.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Gn(),e=ft.identifierPrefix;if($e){var n=dr,r=cr;n=(r&~(1<<32-Nn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Jo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Y_++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},t1={readContext:_n,useCallback:Dy,useContext:_n,useEffect:Ih,useImperativeHandle:by,useInsertionEffect:ky,useLayoutEffect:Ry,useMemo:jy,useReducer:uc,useRef:Ay,useState:function(){return uc(Zo)},useDebugValue:Ch,useDeferredValue:function(t){var e=wn();return Ny(e,lt.memoizedState,t)},useTransition:function(){var t=uc(Zo)[0],e=wn().memoizedState;return[t,e]},useMutableSource:_y,useSyncExternalStore:wy,useId:My,unstable_isNewReconciler:!1},n1={readContext:_n,useCallback:Dy,useContext:_n,useEffect:Ih,useImperativeHandle:by,useInsertionEffect:ky,useLayoutEffect:Ry,useMemo:jy,useReducer:cc,useRef:Ay,useState:function(){return cc(Zo)},useDebugValue:Ch,useDeferredValue:function(t){var e=wn();return lt===null?e.memoizedState=t:Ny(e,lt.memoizedState,t)},useTransition:function(){var t=cc(Zo)[0],e=wn().memoizedState;return[t,e]},useMutableSource:_y,useSyncExternalStore:wy,useId:My,unstable_isNewReconciler:!1};function Pn(t,e){if(t&&t.defaultProps){e=qe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function rd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:qe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var hu={isMounted:function(t){return(t=t._reactInternals)?Ls(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Bt(),s=$r(t),i=hr(r,s);i.payload=e,n!=null&&(i.callback=n),e=Br(t,i,s),e!==null&&(Mn(e,t,s,r),cl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Bt(),s=$r(t),i=hr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Br(t,i,s),e!==null&&(Mn(e,t,s,r),cl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Bt(),r=$r(t),s=hr(n,r);s.tag=2,e!=null&&(s.callback=e),e=Br(t,s,r),e!==null&&(Mn(e,t,r,n),cl(e,t,r))}};function Np(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!qo(n,r)||!qo(s,i):!0}function Oy(t,e,n){var r=!1,s=Yr,i=e.contextType;return typeof i=="object"&&i!==null?i=_n(i):(s=Zt(e)?ks:Vt.current,r=e.contextTypes,i=(r=r!=null)?Ti(t,s):Yr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=hu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Mp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&hu.enqueueReplaceState(e,e.state,null)}function sd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},vh(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=_n(i):(i=Zt(e)?ks:Vt.current,s.context=Ti(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(rd(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&hu.enqueueReplaceState(s,s.state,null),Fl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ki(t,e){try{var n="",r=e;do n+=Px(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function dc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function id(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var r1=typeof WeakMap=="function"?WeakMap:Map;function zy(t,e,n){n=hr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){$l||($l=!0,gd=r),id(t,e)},n}function By(t,e,n){n=hr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){id(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){id(t,e),typeof r!="function"&&(Ur===null?Ur=new Set([this]):Ur.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Vp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new r1;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=y1.bind(null,t,e,n),e.then(t,t))}function Lp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Fp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=hr(-1,1),e.tag=2,Br(n,e,1))),n.lanes|=1),t)}var s1=Sr.ReactCurrentOwner,Xt=!1;function zt(t,e,n,r){e.child=t===null?my(e,null,n,r):Ci(e,t.child,n,r)}function Op(t,e,n,r,s){n=n.render;var i=e.ref;return xi(e,s),r=Eh(t,e,n,r,i,s),n=Th(),t!==null&&!Xt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,yr(t,e,s)):($e&&n&&dh(e),e.flags|=1,zt(t,e,r,s),e.child)}function zp(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Nh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Uy(t,e,i,r,s)):(t=ml(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:qo,n(a,r)&&t.ref===e.ref)return yr(t,e,s)}return e.flags|=1,t=Wr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Uy(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(qo(i,r)&&t.ref===e.ref)if(Xt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Xt=!0);else return e.lanes=t.lanes,yr(t,e,s)}return od(t,e,n,r,s)}function $y(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fe(pi,sn),sn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Fe(pi,sn),sn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Fe(pi,sn),sn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Fe(pi,sn),sn|=r;return zt(t,e,s,n),e.child}function Wy(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function od(t,e,n,r,s){var i=Zt(n)?ks:Vt.current;return i=Ti(e,i),xi(e,s),n=Eh(t,e,n,r,i,s),r=Th(),t!==null&&!Xt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,yr(t,e,s)):($e&&r&&dh(e),e.flags|=1,zt(t,e,n,s),e.child)}function Bp(t,e,n,r,s){if(Zt(n)){var i=!0;jl(e)}else i=!1;if(xi(e,s),e.stateNode===null)fl(t,e),Oy(e,n,r),sd(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=_n(h):(h=Zt(n)?ks:Vt.current,h=Ti(e,h));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==h)&&Mp(e,a,r,h),br=!1;var y=e.memoizedState;a.state=y,Fl(e,r,a,s),c=e.memoizedState,l!==r||y!==c||Jt.current||br?(typeof p=="function"&&(rd(e,n,p,r),c=e.memoizedState),(l=br||Np(e,n,l,r,y,c,h))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),a.props=r,a.state=c,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,vy(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:Pn(e.type,l),a.props=h,m=e.pendingProps,y=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=_n(c):(c=Zt(n)?ks:Vt.current,c=Ti(e,c));var C=n.getDerivedStateFromProps;(p=typeof C=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==m||y!==c)&&Mp(e,a,r,c),br=!1,y=e.memoizedState,a.state=y,Fl(e,r,a,s);var k=e.memoizedState;l!==m||y!==k||Jt.current||br?(typeof C=="function"&&(rd(e,n,C,r),k=e.memoizedState),(h=br||Np(e,n,h,r,y,k,c)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,k,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,k,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=k),a.props=r,a.state=k,a.context=c,r=h):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return ad(t,e,n,r,i,s)}function ad(t,e,n,r,s,i){Wy(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&Cp(e,n,!1),yr(t,e,i);r=e.stateNode,s1.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Ci(e,t.child,null,i),e.child=Ci(e,null,l,i)):zt(t,e,l,i),e.memoizedState=r.state,s&&Cp(e,n,!0),e.child}function Hy(t){var e=t.stateNode;e.pendingContext?Ip(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ip(t,e.context,!1),xh(t,e.containerInfo)}function Up(t,e,n,r,s){return Ii(),fh(s),e.flags|=256,zt(t,e,n,r),e.child}var ld={dehydrated:null,treeContext:null,retryLane:0};function ud(t){return{baseLanes:t,cachePool:null,transitions:null}}function qy(t,e,n){var r=e.pendingProps,s=We.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Fe(We,s&1),t===null)return td(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=gu(a,r,0,null),t=Cs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=ud(n),e.memoizedState=ld,t):Ah(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return i1(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Wr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Wr(l,i):(i=Cs(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?ud(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=ld,r}return i=t.child,t=i.sibling,r=Wr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ah(t,e){return e=gu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Xa(t,e,n,r){return r!==null&&fh(r),Ci(e,t.child,null,n),t=Ah(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function i1(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=dc(Error(K(422))),Xa(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=gu({mode:"visible",children:r.children},s,0,null),i=Cs(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ci(e,t.child,null,a),e.child.memoizedState=ud(a),e.memoizedState=ld,i);if(!(e.mode&1))return Xa(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(K(419)),r=dc(i,r,void 0),Xa(t,e,a,r)}if(l=(a&t.childLanes)!==0,Xt||l){if(r=ft,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,mr(t,s),Mn(r,t,s,-1))}return jh(),r=dc(Error(K(421))),Xa(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=v1.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,on=zr(s.nextSibling),ln=e,$e=!0,Dn=null,t!==null&&(mn[yn++]=cr,mn[yn++]=dr,mn[yn++]=Rs,cr=t.id,dr=t.overflow,Rs=e),e=Ah(e,r.children),e.flags|=4096,e)}function $p(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),nd(t.return,e,n)}function hc(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Gy(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(zt(t,e,r.children,n),r=We.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&$p(t,n,e);else if(t.tag===19)$p(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Fe(We,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ol(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),hc(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ol(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}hc(e,!0,n,null,i);break;case"together":hc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function fl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function yr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),bs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(K(153));if(e.child!==null){for(t=e.child,n=Wr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Wr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function o1(t,e,n){switch(e.tag){case 3:Hy(e),Ii();break;case 5:xy(e);break;case 1:Zt(e.type)&&jl(e);break;case 4:xh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Fe(Vl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Fe(We,We.current&1),e.flags|=128,null):n&e.child.childLanes?qy(t,e,n):(Fe(We,We.current&1),t=yr(t,e,n),t!==null?t.sibling:null);Fe(We,We.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Gy(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Fe(We,We.current),r)break;return null;case 22:case 23:return e.lanes=0,$y(t,e,n)}return yr(t,e,n)}var Qy,cd,Ky,Yy;Qy=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};cd=function(){};Ky=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Es(Yn.current);var i=null;switch(n){case"input":s=Dc(t,s),r=Dc(t,r),i=[];break;case"select":s=qe({},s,{value:void 0}),r=qe({},r,{value:void 0}),i=[];break;case"textarea":s=Mc(t,s),r=Mc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=bl)}Lc(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Oo.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var c=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&c!==l&&(c!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(h,n)),n=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Oo.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&Oe("scroll",t),i||l===c||(i=[])):(i=i||[]).push(h,c))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};Yy=function(t,e,n,r){n!==r&&(e.flags|=4)};function go(t,e){if(!$e)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function a1(t,e,n){var r=e.pendingProps;switch(hh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(e),null;case 1:return Zt(e.type)&&Dl(),bt(e),null;case 3:return r=e.stateNode,Ai(),Be(Jt),Be(Vt),wh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ka(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Dn!==null&&(vd(Dn),Dn=null))),cd(t,e),bt(e),null;case 5:_h(e);var s=Es(Xo.current);if(n=e.type,t!==null&&e.stateNode!=null)Ky(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(K(166));return bt(e),null}if(t=Es(Yn.current),Ka(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Qn]=e,r[Ko]=i,t=(e.mode&1)!==0,n){case"dialog":Oe("cancel",r),Oe("close",r);break;case"iframe":case"object":case"embed":Oe("load",r);break;case"video":case"audio":for(s=0;s<wo.length;s++)Oe(wo[s],r);break;case"source":Oe("error",r);break;case"img":case"image":case"link":Oe("error",r),Oe("load",r);break;case"details":Oe("toggle",r);break;case"input":Jf(r,i),Oe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Oe("invalid",r);break;case"textarea":ep(r,i),Oe("invalid",r)}Lc(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Qa(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Qa(r.textContent,l,t),s=["children",""+l]):Oo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Oe("scroll",r)}switch(n){case"input":za(r),Zf(r,i,!0);break;case"textarea":za(r),tp(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=bl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Tm(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Qn]=e,t[Ko]=r,Qy(t,e,!1,!1),e.stateNode=t;e:{switch(a=Fc(n,r),n){case"dialog":Oe("cancel",t),Oe("close",t),s=r;break;case"iframe":case"object":case"embed":Oe("load",t),s=r;break;case"video":case"audio":for(s=0;s<wo.length;s++)Oe(wo[s],t);s=r;break;case"source":Oe("error",t),s=r;break;case"img":case"image":case"link":Oe("error",t),Oe("load",t),s=r;break;case"details":Oe("toggle",t),s=r;break;case"input":Jf(t,r),s=Dc(t,r),Oe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=qe({},r,{value:void 0}),Oe("invalid",t);break;case"textarea":ep(t,r),s=Mc(t,r),Oe("invalid",t);break;default:s=r}Lc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Am(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Im(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&zo(t,c):typeof c=="number"&&zo(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Oo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Oe("scroll",t):c!=null&&Xd(t,i,c,a))}switch(n){case"input":za(t),Zf(t,r,!1);break;case"textarea":za(t),tp(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Kr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?gi(t,!!r.multiple,i,!1):r.defaultValue!=null&&gi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=bl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bt(e),null;case 6:if(t&&e.stateNode!=null)Yy(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(K(166));if(n=Es(Xo.current),Es(Yn.current),Ka(e)){if(r=e.stateNode,n=e.memoizedProps,r[Qn]=e,(i=r.nodeValue!==n)&&(t=ln,t!==null))switch(t.tag){case 3:Qa(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Qa(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Qn]=e,e.stateNode=r}return bt(e),null;case 13:if(Be(We),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if($e&&on!==null&&e.mode&1&&!(e.flags&128))py(),Ii(),e.flags|=98560,i=!1;else if(i=Ka(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(K(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(K(317));i[Qn]=e}else Ii(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bt(e),i=!1}else Dn!==null&&(vd(Dn),Dn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||We.current&1?ut===0&&(ut=3):jh())),e.updateQueue!==null&&(e.flags|=4),bt(e),null);case 4:return Ai(),cd(t,e),t===null&&Go(e.stateNode.containerInfo),bt(e),null;case 10:return mh(e.type._context),bt(e),null;case 17:return Zt(e.type)&&Dl(),bt(e),null;case 19:if(Be(We),i=e.memoizedState,i===null)return bt(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)go(i,!1);else{if(ut!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Ol(t),a!==null){for(e.flags|=128,go(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Fe(We,We.current&1|2),e.child}t=t.sibling}i.tail!==null&&tt()>Ri&&(e.flags|=128,r=!0,go(i,!1),e.lanes=4194304)}else{if(!r)if(t=Ol(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),go(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!$e)return bt(e),null}else 2*tt()-i.renderingStartTime>Ri&&n!==1073741824&&(e.flags|=128,r=!0,go(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=tt(),e.sibling=null,n=We.current,Fe(We,r?n&1|2:n&1),e):(bt(e),null);case 22:case 23:return Dh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?sn&1073741824&&(bt(e),e.subtreeFlags&6&&(e.flags|=8192)):bt(e),null;case 24:return null;case 25:return null}throw Error(K(156,e.tag))}function l1(t,e){switch(hh(e),e.tag){case 1:return Zt(e.type)&&Dl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ai(),Be(Jt),Be(Vt),wh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _h(e),null;case 13:if(Be(We),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(K(340));Ii()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Be(We),null;case 4:return Ai(),null;case 10:return mh(e.type._context),null;case 22:case 23:return Dh(),null;case 24:return null;default:return null}}var Ja=!1,jt=!1,u1=typeof WeakSet=="function"?WeakSet:Set,re=null;function fi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Je(t,e,r)}else n.current=null}function dd(t,e,n){try{n()}catch(r){Je(t,e,r)}}var Wp=!1;function c1(t,e){if(Qc=kl,t=ty(),ch(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,h=0,p=0,m=t,y=null;t:for(;;){for(var C;m!==n||s!==0&&m.nodeType!==3||(l=a+s),m!==i||r!==0&&m.nodeType!==3||(c=a+r),m.nodeType===3&&(a+=m.nodeValue.length),(C=m.firstChild)!==null;)y=m,m=C;for(;;){if(m===t)break t;if(y===n&&++h===s&&(l=a),y===i&&++p===r&&(c=a),(C=m.nextSibling)!==null)break;m=y,y=m.parentNode}m=C}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Kc={focusedElem:t,selectionRange:n},kl=!1,re=e;re!==null;)if(e=re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,re=t;else for(;re!==null;){e=re;try{var k=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var P=k.memoizedProps,z=k.memoizedState,A=e.stateNode,w=A.getSnapshotBeforeUpdate(e.elementType===e.type?P:Pn(e.type,P),z);A.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(V){Je(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,re=t;break}re=e.return}return k=Wp,Wp=!1,k}function Do(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&dd(e,n,i)}s=s.next}while(s!==r)}}function fu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function hd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Xy(t){var e=t.alternate;e!==null&&(t.alternate=null,Xy(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Qn],delete e[Ko],delete e[Jc],delete e[q_],delete e[G_])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Jy(t){return t.tag===5||t.tag===3||t.tag===4}function Hp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Jy(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function fd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=bl));else if(r!==4&&(t=t.child,t!==null))for(fd(t,e,n),t=t.sibling;t!==null;)fd(t,e,n),t=t.sibling}function pd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(pd(t,e,n),t=t.sibling;t!==null;)pd(t,e,n),t=t.sibling}var xt=null,bn=!1;function Rr(t,e,n){for(n=n.child;n!==null;)Zy(t,e,n),n=n.sibling}function Zy(t,e,n){if(Kn&&typeof Kn.onCommitFiberUnmount=="function")try{Kn.onCommitFiberUnmount(iu,n)}catch{}switch(n.tag){case 5:jt||fi(n,e);case 6:var r=xt,s=bn;xt=null,Rr(t,e,n),xt=r,bn=s,xt!==null&&(bn?(t=xt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):xt.removeChild(n.stateNode));break;case 18:xt!==null&&(bn?(t=xt,n=n.stateNode,t.nodeType===8?ic(t.parentNode,n):t.nodeType===1&&ic(t,n),Wo(t)):ic(xt,n.stateNode));break;case 4:r=xt,s=bn,xt=n.stateNode.containerInfo,bn=!0,Rr(t,e,n),xt=r,bn=s;break;case 0:case 11:case 14:case 15:if(!jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&dd(n,e,a),s=s.next}while(s!==r)}Rr(t,e,n);break;case 1:if(!jt&&(fi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Je(n,e,l)}Rr(t,e,n);break;case 21:Rr(t,e,n);break;case 22:n.mode&1?(jt=(r=jt)||n.memoizedState!==null,Rr(t,e,n),jt=r):Rr(t,e,n);break;default:Rr(t,e,n)}}function qp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new u1),e.forEach(function(r){var s=x1.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Rn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:xt=l.stateNode,bn=!1;break e;case 3:xt=l.stateNode.containerInfo,bn=!0;break e;case 4:xt=l.stateNode.containerInfo,bn=!0;break e}l=l.return}if(xt===null)throw Error(K(160));Zy(i,a,s),xt=null,bn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(h){Je(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)e0(e,t),e=e.sibling}function e0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Rn(e,t),qn(t),r&4){try{Do(3,t,t.return),fu(3,t)}catch(P){Je(t,t.return,P)}try{Do(5,t,t.return)}catch(P){Je(t,t.return,P)}}break;case 1:Rn(e,t),qn(t),r&512&&n!==null&&fi(n,n.return);break;case 5:if(Rn(e,t),qn(t),r&512&&n!==null&&fi(n,n.return),t.flags&32){var s=t.stateNode;try{zo(s,"")}catch(P){Je(t,t.return,P)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Sm(s,i),Fc(l,a);var h=Fc(l,i);for(a=0;a<c.length;a+=2){var p=c[a],m=c[a+1];p==="style"?Am(s,m):p==="dangerouslySetInnerHTML"?Im(s,m):p==="children"?zo(s,m):Xd(s,p,m,h)}switch(l){case"input":jc(s,i);break;case"textarea":Em(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var C=i.value;C!=null?gi(s,!!i.multiple,C,!1):y!==!!i.multiple&&(i.defaultValue!=null?gi(s,!!i.multiple,i.defaultValue,!0):gi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ko]=i}catch(P){Je(t,t.return,P)}}break;case 6:if(Rn(e,t),qn(t),r&4){if(t.stateNode===null)throw Error(K(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){Je(t,t.return,P)}}break;case 3:if(Rn(e,t),qn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Wo(e.containerInfo)}catch(P){Je(t,t.return,P)}break;case 4:Rn(e,t),qn(t);break;case 13:Rn(e,t),qn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Ph=tt())),r&4&&qp(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(jt=(h=jt)||p,Rn(e,t),jt=h):Rn(e,t),qn(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(re=t,p=t.child;p!==null;){for(m=re=p;re!==null;){switch(y=re,C=y.child,y.tag){case 0:case 11:case 14:case 15:Do(4,y,y.return);break;case 1:fi(y,y.return);var k=y.stateNode;if(typeof k.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,k.props=e.memoizedProps,k.state=e.memoizedState,k.componentWillUnmount()}catch(P){Je(r,n,P)}}break;case 5:fi(y,y.return);break;case 22:if(y.memoizedState!==null){Qp(m);continue}}C!==null?(C.return=y,re=C):Qp(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{s=m.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Cm("display",a))}catch(P){Je(t,t.return,P)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=h?"":m.memoizedProps}catch(P){Je(t,t.return,P)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Rn(e,t),qn(t),r&4&&qp(t);break;case 21:break;default:Rn(e,t),qn(t)}}function qn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Jy(n)){var r=n;break e}n=n.return}throw Error(K(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(zo(s,""),r.flags&=-33);var i=Hp(t);pd(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Hp(t);fd(t,l,a);break;default:throw Error(K(161))}}catch(c){Je(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function d1(t,e,n){re=t,t0(t)}function t0(t,e,n){for(var r=(t.mode&1)!==0;re!==null;){var s=re,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Ja;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||jt;l=Ja;var h=jt;if(Ja=a,(jt=c)&&!h)for(re=s;re!==null;)a=re,c=a.child,a.tag===22&&a.memoizedState!==null?Kp(s):c!==null?(c.return=a,re=c):Kp(s);for(;i!==null;)re=i,t0(i),i=i.sibling;re=s,Ja=l,jt=h}Gp(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,re=i):Gp(t)}}function Gp(t){for(;re!==null;){var e=re;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jt||fu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!jt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Pn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&bp(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}bp(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&Wo(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}jt||e.flags&512&&hd(e)}catch(y){Je(e,e.return,y)}}if(e===t){re=null;break}if(n=e.sibling,n!==null){n.return=e.return,re=n;break}re=e.return}}function Qp(t){for(;re!==null;){var e=re;if(e===t){re=null;break}var n=e.sibling;if(n!==null){n.return=e.return,re=n;break}re=e.return}}function Kp(t){for(;re!==null;){var e=re;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{fu(4,e)}catch(c){Je(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Je(e,s,c)}}var i=e.return;try{hd(e)}catch(c){Je(e,i,c)}break;case 5:var a=e.return;try{hd(e)}catch(c){Je(e,a,c)}}}catch(c){Je(e,e.return,c)}if(e===t){re=null;break}var l=e.sibling;if(l!==null){l.return=e.return,re=l;break}re=e.return}}var h1=Math.ceil,Ul=Sr.ReactCurrentDispatcher,kh=Sr.ReactCurrentOwner,xn=Sr.ReactCurrentBatchConfig,Ce=0,ft=null,it=null,St=0,sn=0,pi=ts(0),ut=0,ta=null,bs=0,pu=0,Rh=0,jo=null,Kt=null,Ph=0,Ri=1/0,ar=null,$l=!1,gd=null,Ur=null,Za=!1,Mr=null,Wl=0,No=0,md=null,pl=-1,gl=0;function Bt(){return Ce&6?tt():pl!==-1?pl:pl=tt()}function $r(t){return t.mode&1?Ce&2&&St!==0?St&-St:K_.transition!==null?(gl===0&&(gl=Om()),gl):(t=De,t!==0||(t=window.event,t=t===void 0?16:qm(t.type)),t):1}function Mn(t,e,n,r){if(50<No)throw No=0,md=null,Error(K(185));fa(t,n,r),(!(Ce&2)||t!==ft)&&(t===ft&&(!(Ce&2)&&(pu|=n),ut===4&&jr(t,St)),en(t,r),n===1&&Ce===0&&!(e.mode&1)&&(Ri=tt()+500,cu&&ns()))}function en(t,e){var n=t.callbackNode;Kx(t,e);var r=Al(t,t===ft?St:0);if(r===0)n!==null&&sp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&sp(n),e===1)t.tag===0?Q_(Yp.bind(null,t)):dy(Yp.bind(null,t)),W_(function(){!(Ce&6)&&ns()}),n=null;else{switch(zm(r)){case 1:n=nh;break;case 4:n=Lm;break;case 16:n=Cl;break;case 536870912:n=Fm;break;default:n=Cl}n=u0(n,n0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function n0(t,e){if(pl=-1,gl=0,Ce&6)throw Error(K(327));var n=t.callbackNode;if(_i()&&t.callbackNode!==n)return null;var r=Al(t,t===ft?St:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Hl(t,r);else{e=r;var s=Ce;Ce|=2;var i=s0();(ft!==t||St!==e)&&(ar=null,Ri=tt()+500,Is(t,e));do try{g1();break}catch(l){r0(t,l)}while(!0);gh(),Ul.current=i,Ce=s,it!==null?e=0:(ft=null,St=0,e=ut)}if(e!==0){if(e===2&&(s=$c(t),s!==0&&(r=s,e=yd(t,s))),e===1)throw n=ta,Is(t,0),jr(t,r),en(t,tt()),n;if(e===6)jr(t,r);else{if(s=t.current.alternate,!(r&30)&&!f1(s)&&(e=Hl(t,r),e===2&&(i=$c(t),i!==0&&(r=i,e=yd(t,i))),e===1))throw n=ta,Is(t,0),jr(t,r),en(t,tt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(K(345));case 2:xs(t,Kt,ar);break;case 3:if(jr(t,r),(r&130023424)===r&&(e=Ph+500-tt(),10<e)){if(Al(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Bt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Xc(xs.bind(null,t,Kt,ar),e);break}xs(t,Kt,ar);break;case 4:if(jr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Nn(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*h1(r/1960))-r,10<r){t.timeoutHandle=Xc(xs.bind(null,t,Kt,ar),r);break}xs(t,Kt,ar);break;case 5:xs(t,Kt,ar);break;default:throw Error(K(329))}}}return en(t,tt()),t.callbackNode===n?n0.bind(null,t):null}function yd(t,e){var n=jo;return t.current.memoizedState.isDehydrated&&(Is(t,e).flags|=256),t=Hl(t,e),t!==2&&(e=Kt,Kt=n,e!==null&&vd(e)),t}function vd(t){Kt===null?Kt=t:Kt.push.apply(Kt,t)}function f1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ln(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function jr(t,e){for(e&=~Rh,e&=~pu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Nn(e),r=1<<n;t[n]=-1,e&=~r}}function Yp(t){if(Ce&6)throw Error(K(327));_i();var e=Al(t,0);if(!(e&1))return en(t,tt()),null;var n=Hl(t,e);if(t.tag!==0&&n===2){var r=$c(t);r!==0&&(e=r,n=yd(t,r))}if(n===1)throw n=ta,Is(t,0),jr(t,e),en(t,tt()),n;if(n===6)throw Error(K(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xs(t,Kt,ar),en(t,tt()),null}function bh(t,e){var n=Ce;Ce|=1;try{return t(e)}finally{Ce=n,Ce===0&&(Ri=tt()+500,cu&&ns())}}function Ds(t){Mr!==null&&Mr.tag===0&&!(Ce&6)&&_i();var e=Ce;Ce|=1;var n=xn.transition,r=De;try{if(xn.transition=null,De=1,t)return t()}finally{De=r,xn.transition=n,Ce=e,!(Ce&6)&&ns()}}function Dh(){sn=pi.current,Be(pi)}function Is(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$_(n)),it!==null)for(n=it.return;n!==null;){var r=n;switch(hh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Dl();break;case 3:Ai(),Be(Jt),Be(Vt),wh();break;case 5:_h(r);break;case 4:Ai();break;case 13:Be(We);break;case 19:Be(We);break;case 10:mh(r.type._context);break;case 22:case 23:Dh()}n=n.return}if(ft=t,it=t=Wr(t.current,null),St=sn=e,ut=0,ta=null,Rh=pu=bs=0,Kt=jo=null,Ss!==null){for(e=0;e<Ss.length;e++)if(n=Ss[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}Ss=null}return t}function r0(t,e){do{var n=it;try{if(gh(),dl.current=Bl,zl){for(var r=He.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}zl=!1}if(Ps=0,ht=lt=He=null,bo=!1,Jo=0,kh.current=null,n===null||n.return===null){ut=1,ta=e,it=null;break}e:{var i=t,a=n.return,l=n,c=e;if(e=St,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,p=l,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var y=p.alternate;y?(p.updateQueue=y.updateQueue,p.memoizedState=y.memoizedState,p.lanes=y.lanes):(p.updateQueue=null,p.memoizedState=null)}var C=Lp(a);if(C!==null){C.flags&=-257,Fp(C,a,l,i,e),C.mode&1&&Vp(i,h,e),e=C,c=h;var k=e.updateQueue;if(k===null){var P=new Set;P.add(c),e.updateQueue=P}else k.add(c);break e}else{if(!(e&1)){Vp(i,h,e),jh();break e}c=Error(K(426))}}else if($e&&l.mode&1){var z=Lp(a);if(z!==null){!(z.flags&65536)&&(z.flags|=256),Fp(z,a,l,i,e),fh(ki(c,l));break e}}i=c=ki(c,l),ut!==4&&(ut=2),jo===null?jo=[i]:jo.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var A=zy(i,c,e);Pp(i,A);break e;case 1:l=c;var w=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Ur===null||!Ur.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var V=By(i,l,e);Pp(i,V);break e}}i=i.return}while(i!==null)}o0(n)}catch($){e=$,it===n&&n!==null&&(it=n=n.return);continue}break}while(!0)}function s0(){var t=Ul.current;return Ul.current=Bl,t===null?Bl:t}function jh(){(ut===0||ut===3||ut===2)&&(ut=4),ft===null||!(bs&268435455)&&!(pu&268435455)||jr(ft,St)}function Hl(t,e){var n=Ce;Ce|=2;var r=s0();(ft!==t||St!==e)&&(ar=null,Is(t,e));do try{p1();break}catch(s){r0(t,s)}while(!0);if(gh(),Ce=n,Ul.current=r,it!==null)throw Error(K(261));return ft=null,St=0,ut}function p1(){for(;it!==null;)i0(it)}function g1(){for(;it!==null&&!zx();)i0(it)}function i0(t){var e=l0(t.alternate,t,sn);t.memoizedProps=t.pendingProps,e===null?o0(t):it=e,kh.current=null}function o0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=l1(n,e),n!==null){n.flags&=32767,it=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ut=6,it=null;return}}else if(n=a1(n,e,sn),n!==null){it=n;return}if(e=e.sibling,e!==null){it=e;return}it=e=t}while(e!==null);ut===0&&(ut=5)}function xs(t,e,n){var r=De,s=xn.transition;try{xn.transition=null,De=1,m1(t,e,n,r)}finally{xn.transition=s,De=r}return null}function m1(t,e,n,r){do _i();while(Mr!==null);if(Ce&6)throw Error(K(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(K(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Yx(t,i),t===ft&&(it=ft=null,St=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Za||(Za=!0,u0(Cl,function(){return _i(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=xn.transition,xn.transition=null;var a=De;De=1;var l=Ce;Ce|=4,kh.current=null,c1(t,n),e0(n,t),V_(Kc),kl=!!Qc,Kc=Qc=null,t.current=n,d1(n),Bx(),Ce=l,De=a,xn.transition=i}else t.current=n;if(Za&&(Za=!1,Mr=t,Wl=s),i=t.pendingLanes,i===0&&(Ur=null),Wx(n.stateNode),en(t,tt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if($l)throw $l=!1,t=gd,gd=null,t;return Wl&1&&t.tag!==0&&_i(),i=t.pendingLanes,i&1?t===md?No++:(No=0,md=t):No=0,ns(),null}function _i(){if(Mr!==null){var t=zm(Wl),e=xn.transition,n=De;try{if(xn.transition=null,De=16>t?16:t,Mr===null)var r=!1;else{if(t=Mr,Mr=null,Wl=0,Ce&6)throw Error(K(331));var s=Ce;for(Ce|=4,re=t.current;re!==null;){var i=re,a=i.child;if(re.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var h=l[c];for(re=h;re!==null;){var p=re;switch(p.tag){case 0:case 11:case 15:Do(8,p,i)}var m=p.child;if(m!==null)m.return=p,re=m;else for(;re!==null;){p=re;var y=p.sibling,C=p.return;if(Xy(p),p===h){re=null;break}if(y!==null){y.return=C,re=y;break}re=C}}}var k=i.alternate;if(k!==null){var P=k.child;if(P!==null){k.child=null;do{var z=P.sibling;P.sibling=null,P=z}while(P!==null)}}re=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,re=a;else e:for(;re!==null;){if(i=re,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Do(9,i,i.return)}var A=i.sibling;if(A!==null){A.return=i.return,re=A;break e}re=i.return}}var w=t.current;for(re=w;re!==null;){a=re;var T=a.child;if(a.subtreeFlags&2064&&T!==null)T.return=a,re=T;else e:for(a=w;re!==null;){if(l=re,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:fu(9,l)}}catch($){Je(l,l.return,$)}if(l===a){re=null;break e}var V=l.sibling;if(V!==null){V.return=l.return,re=V;break e}re=l.return}}if(Ce=s,ns(),Kn&&typeof Kn.onPostCommitFiberRoot=="function")try{Kn.onPostCommitFiberRoot(iu,t)}catch{}r=!0}return r}finally{De=n,xn.transition=e}}return!1}function Xp(t,e,n){e=ki(n,e),e=zy(t,e,1),t=Br(t,e,1),e=Bt(),t!==null&&(fa(t,1,e),en(t,e))}function Je(t,e,n){if(t.tag===3)Xp(t,t,n);else for(;e!==null;){if(e.tag===3){Xp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ur===null||!Ur.has(r))){t=ki(n,t),t=By(e,t,1),e=Br(e,t,1),t=Bt(),e!==null&&(fa(e,1,t),en(e,t));break}}e=e.return}}function y1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Bt(),t.pingedLanes|=t.suspendedLanes&n,ft===t&&(St&n)===n&&(ut===4||ut===3&&(St&130023424)===St&&500>tt()-Ph?Is(t,0):Rh|=n),en(t,e)}function a0(t,e){e===0&&(t.mode&1?(e=$a,$a<<=1,!($a&130023424)&&($a=4194304)):e=1);var n=Bt();t=mr(t,e),t!==null&&(fa(t,e,n),en(t,n))}function v1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),a0(t,n)}function x1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(K(314))}r!==null&&r.delete(e),a0(t,n)}var l0;l0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Jt.current)Xt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Xt=!1,o1(t,e,n);Xt=!!(t.flags&131072)}else Xt=!1,$e&&e.flags&1048576&&hy(e,Ml,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;fl(t,e),t=e.pendingProps;var s=Ti(e,Vt.current);xi(e,n),s=Eh(null,e,r,t,s,n);var i=Th();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zt(r)?(i=!0,jl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,vh(e),s.updater=hu,e.stateNode=s,s._reactInternals=e,sd(e,r,t,n),e=ad(null,e,r,!0,i,n)):(e.tag=0,$e&&i&&dh(e),zt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(fl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=w1(r),t=Pn(r,t),s){case 0:e=od(null,e,r,t,n);break e;case 1:e=Bp(null,e,r,t,n);break e;case 11:e=Op(null,e,r,t,n);break e;case 14:e=zp(null,e,r,Pn(r.type,t),n);break e}throw Error(K(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Pn(r,s),od(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Pn(r,s),Bp(t,e,r,s,n);case 3:e:{if(Hy(e),t===null)throw Error(K(387));r=e.pendingProps,i=e.memoizedState,s=i.element,vy(t,e),Fl(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ki(Error(K(423)),e),e=Up(t,e,r,n,s);break e}else if(r!==s){s=ki(Error(K(424)),e),e=Up(t,e,r,n,s);break e}else for(on=zr(e.stateNode.containerInfo.firstChild),ln=e,$e=!0,Dn=null,n=my(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ii(),r===s){e=yr(t,e,n);break e}zt(t,e,r,n)}e=e.child}return e;case 5:return xy(e),t===null&&td(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Yc(r,s)?a=null:i!==null&&Yc(r,i)&&(e.flags|=32),Wy(t,e),zt(t,e,a,n),e.child;case 6:return t===null&&td(e),null;case 13:return qy(t,e,n);case 4:return xh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ci(e,null,r,n):zt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Pn(r,s),Op(t,e,r,s,n);case 7:return zt(t,e,e.pendingProps,n),e.child;case 8:return zt(t,e,e.pendingProps.children,n),e.child;case 12:return zt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Fe(Vl,r._currentValue),r._currentValue=a,i!==null)if(Ln(i.value,a)){if(i.children===s.children&&!Jt.current){e=yr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=hr(-1,n&-n),c.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?c.next=c:(c.next=p.next,p.next=c),h.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),nd(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(K(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),nd(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}zt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,xi(e,n),s=_n(s),r=r(s),e.flags|=1,zt(t,e,r,n),e.child;case 14:return r=e.type,s=Pn(r,e.pendingProps),s=Pn(r.type,s),zp(t,e,r,s,n);case 15:return Uy(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Pn(r,s),fl(t,e),e.tag=1,Zt(r)?(t=!0,jl(e)):t=!1,xi(e,n),Oy(e,r,s),sd(e,r,s,n),ad(null,e,r,!0,t,n);case 19:return Gy(t,e,n);case 22:return $y(t,e,n)}throw Error(K(156,e.tag))};function u0(t,e){return Vm(t,e)}function _1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vn(t,e,n,r){return new _1(t,e,n,r)}function Nh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function w1(t){if(typeof t=="function")return Nh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zd)return 11;if(t===eh)return 14}return 2}function Wr(t,e){var n=t.alternate;return n===null?(n=vn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ml(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")Nh(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case si:return Cs(n.children,s,i,e);case Jd:a=8,s|=8;break;case kc:return t=vn(12,n,e,s|2),t.elementType=kc,t.lanes=i,t;case Rc:return t=vn(13,n,e,s),t.elementType=Rc,t.lanes=i,t;case Pc:return t=vn(19,n,e,s),t.elementType=Pc,t.lanes=i,t;case xm:return gu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ym:a=10;break e;case vm:a=9;break e;case Zd:a=11;break e;case eh:a=14;break e;case Pr:a=16,r=null;break e}throw Error(K(130,t==null?t:typeof t,""))}return e=vn(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Cs(t,e,n,r){return t=vn(7,t,r,e),t.lanes=n,t}function gu(t,e,n,r){return t=vn(22,t,r,e),t.elementType=xm,t.lanes=n,t.stateNode={isHidden:!1},t}function fc(t,e,n){return t=vn(6,t,null,e),t.lanes=n,t}function pc(t,e,n){return e=vn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function S1(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qu(0),this.expirationTimes=Qu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Mh(t,e,n,r,s,i,a,l,c){return t=new S1(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=vn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vh(i),t}function E1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ri,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function c0(t){if(!t)return Yr;t=t._reactInternals;e:{if(Ls(t)!==t||t.tag!==1)throw Error(K(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(K(171))}if(t.tag===1){var n=t.type;if(Zt(n))return cy(t,n,e)}return e}function d0(t,e,n,r,s,i,a,l,c){return t=Mh(n,r,!0,t,s,i,a,l,c),t.context=c0(null),n=t.current,r=Bt(),s=$r(n),i=hr(r,s),i.callback=e??null,Br(n,i,s),t.current.lanes=s,fa(t,s,r),en(t,r),t}function mu(t,e,n,r){var s=e.current,i=Bt(),a=$r(s);return n=c0(n),e.context===null?e.context=n:e.pendingContext=n,e=hr(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Br(s,e,a),t!==null&&(Mn(t,s,a,i),cl(t,s,a)),a}function ql(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Jp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Vh(t,e){Jp(t,e),(t=t.alternate)&&Jp(t,e)}function T1(){return null}var h0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Lh(t){this._internalRoot=t}yu.prototype.render=Lh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(K(409));mu(t,e,null,null)};yu.prototype.unmount=Lh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ds(function(){mu(null,t,null,null)}),e[gr]=null}};function yu(t){this._internalRoot=t}yu.prototype.unstable_scheduleHydration=function(t){if(t){var e=$m();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Dr.length&&e!==0&&e<Dr[n].priority;n++);Dr.splice(n,0,t),n===0&&Hm(t)}};function Fh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function vu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Zp(){}function I1(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=ql(a);i.call(h)}}var a=d0(e,r,t,0,null,!1,!1,"",Zp);return t._reactRootContainer=a,t[gr]=a.current,Go(t.nodeType===8?t.parentNode:t),Ds(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=ql(c);l.call(h)}}var c=Mh(t,0,!1,null,null,!1,!1,"",Zp);return t._reactRootContainer=c,t[gr]=c.current,Go(t.nodeType===8?t.parentNode:t),Ds(function(){mu(e,c,n,r)}),c}function xu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=ql(a);l.call(c)}}mu(e,a,t,s)}else a=I1(n,e,t,s,r);return ql(a)}Bm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=_o(e.pendingLanes);n!==0&&(rh(e,n|1),en(e,tt()),!(Ce&6)&&(Ri=tt()+500,ns()))}break;case 13:Ds(function(){var r=mr(t,1);if(r!==null){var s=Bt();Mn(r,t,1,s)}}),Vh(t,1)}};sh=function(t){if(t.tag===13){var e=mr(t,134217728);if(e!==null){var n=Bt();Mn(e,t,134217728,n)}Vh(t,134217728)}};Um=function(t){if(t.tag===13){var e=$r(t),n=mr(t,e);if(n!==null){var r=Bt();Mn(n,t,e,r)}Vh(t,e)}};$m=function(){return De};Wm=function(t,e){var n=De;try{return De=t,e()}finally{De=n}};zc=function(t,e,n){switch(e){case"input":if(jc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=uu(r);if(!s)throw Error(K(90));wm(r),jc(r,s)}}}break;case"textarea":Em(t,n);break;case"select":e=n.value,e!=null&&gi(t,!!n.multiple,e,!1)}};Pm=bh;bm=Ds;var C1={usingClientEntryPoint:!1,Events:[ga,li,uu,km,Rm,bh]},mo={findFiberByHostInstance:ws,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},A1={bundleType:mo.bundleType,version:mo.version,rendererPackageName:mo.rendererPackageName,rendererConfig:mo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Nm(t),t===null?null:t.stateNode},findFiberByHostInstance:mo.findFiberByHostInstance||T1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var el=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!el.isDisabled&&el.supportsFiber)try{iu=el.inject(A1),Kn=el}catch{}}cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C1;cn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fh(e))throw Error(K(200));return E1(t,e,null,n)};cn.createRoot=function(t,e){if(!Fh(t))throw Error(K(299));var n=!1,r="",s=h0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Mh(t,1,!1,null,null,n,!1,r,s),t[gr]=e.current,Go(t.nodeType===8?t.parentNode:t),new Lh(e)};cn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(K(188)):(t=Object.keys(t).join(","),Error(K(268,t)));return t=Nm(e),t=t===null?null:t.stateNode,t};cn.flushSync=function(t){return Ds(t)};cn.hydrate=function(t,e,n){if(!vu(e))throw Error(K(200));return xu(null,t,e,!0,n)};cn.hydrateRoot=function(t,e,n){if(!Fh(t))throw Error(K(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=h0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=d0(e,null,t,1,n??null,s,!1,i,a),t[gr]=e.current,Go(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new yu(e)};cn.render=function(t,e,n){if(!vu(e))throw Error(K(200));return xu(null,t,e,!1,n)};cn.unmountComponentAtNode=function(t){if(!vu(t))throw Error(K(40));return t._reactRootContainer?(Ds(function(){xu(null,null,t,!1,function(){t._reactRootContainer=null,t[gr]=null})}),!0):!1};cn.unstable_batchedUpdates=bh;cn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!vu(n))throw Error(K(200));if(t==null||t._reactInternals===void 0)throw Error(K(38));return xu(t,e,n,!1,r)};cn.version="18.3.1-next-f1338f8080-20240426";function f0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(f0)}catch(t){console.error(t)}}f0(),fm.exports=cn;var k1=fm.exports,p0,eg=k1;p0=eg.createRoot,eg.hydrateRoot;var tg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},R1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},m0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,c=s+2<t.length,h=c?t[s+2]:0,p=i>>2,m=(i&3)<<4|l>>4;let y=(l&15)<<2|h>>6,C=h&63;c||(C=64,a||(y=64)),r.push(n[p],n[m],n[y],n[C])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(g0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):R1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||h==null||m==null)throw new P1;const y=i<<2|l>>4;if(r.push(y),h!==64){const C=l<<4&240|h>>2;if(r.push(C),m!==64){const k=h<<6&192|m;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class P1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const b1=function(t){const e=g0(t);return m0.encodeByteArray(e,!0)},y0=function(t){return b1(t).replace(/\./g,"")},D1=function(t){try{return m0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N1=()=>j1().__FIREBASE_DEFAULTS__,M1=()=>{if(typeof process>"u"||typeof tg>"u")return;const t=tg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},V1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&D1(t[1]);return e&&JSON.parse(e)},Oh=()=>{try{return N1()||M1()||V1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},L1=t=>{var e,n;return(n=(e=Oh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},F1=t=>{const e=L1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},v0=()=>{var t;return(t=Oh())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function B1(){var t;const e=(t=Oh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function U1(){return!B1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $1(){try{return typeof indexedDB=="object"}catch{return!1}}function W1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1="FirebaseError";class zi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=H1,Object.setPrototypeOf(this,zi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,x0.prototype.create)}}class x0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?q1(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new zi(s,l,r)}}function q1(t,e){return t.replace(G1,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const G1=/\{\$([^}]+)}/g;function Gl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(ng(i)&&ng(a)){if(!Gl(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function ng(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(t){return t&&t._delegate?t._delegate:t}class Pi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _s="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new O1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Y1(e))try{this.getOrInitializeService({instanceIdentifier:_s})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=_s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_s){return this.instances.has(e)}getOptions(e=_s){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:K1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=_s){return this.component?this.component.multipleInstances?e:_s:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function K1(t){return t===_s?void 0:t}function Y1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Q1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ie||(Ie={}));const J1={debug:Ie.DEBUG,verbose:Ie.VERBOSE,info:Ie.INFO,warn:Ie.WARN,error:Ie.ERROR,silent:Ie.SILENT},Z1=Ie.INFO,ew={[Ie.DEBUG]:"log",[Ie.VERBOSE]:"log",[Ie.INFO]:"info",[Ie.WARN]:"warn",[Ie.ERROR]:"error"},tw=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=ew[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _0{constructor(e){this.name=e,this._logLevel=Z1,this._logHandler=tw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?J1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ie.DEBUG,...e),this._logHandler(this,Ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ie.VERBOSE,...e),this._logHandler(this,Ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ie.INFO,...e),this._logHandler(this,Ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ie.WARN,...e),this._logHandler(this,Ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ie.ERROR,...e),this._logHandler(this,Ie.ERROR,...e)}}const nw=(t,e)=>e.some(n=>t instanceof n);let rg,sg;function rw(){return rg||(rg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sw(){return sg||(sg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const w0=new WeakMap,xd=new WeakMap,S0=new WeakMap,gc=new WeakMap,zh=new WeakMap;function iw(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Hr(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&w0.set(n,t)}).catch(()=>{}),zh.set(e,t),e}function ow(t){if(xd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});xd.set(t,e)}let _d={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return xd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||S0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Hr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function aw(t){_d=t(_d)}function lw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(mc(this),e,...n);return S0.set(r,e.sort?e.sort():[e]),Hr(r)}:sw().includes(t)?function(...e){return t.apply(mc(this),e),Hr(w0.get(this))}:function(...e){return Hr(t.apply(mc(this),e))}}function uw(t){return typeof t=="function"?lw(t):(t instanceof IDBTransaction&&ow(t),nw(t,rw())?new Proxy(t,_d):t)}function Hr(t){if(t instanceof IDBRequest)return iw(t);if(gc.has(t))return gc.get(t);const e=uw(t);return e!==t&&(gc.set(t,e),zh.set(e,t)),e}const mc=t=>zh.get(t);function cw(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=Hr(a);return r&&a.addEventListener("upgradeneeded",c=>{r(Hr(a.result),c.oldVersion,c.newVersion,Hr(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const dw=["get","getKey","getAll","getAllKeys","count"],hw=["put","add","delete","clear"],yc=new Map;function ig(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(yc.get(e))return yc.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=hw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||dw.includes(n)))return;const i=async function(a,...l){const c=this.transaction(a,s?"readwrite":"readonly");let h=c.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),s&&c.done]))[0]};return yc.set(e,i),i}aw(t=>({...t,get:(e,n,r)=>ig(e,n)||t.get(e,n,r),has:(e,n)=>!!ig(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(pw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function pw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const wd="@firebase/app",og="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vr=new _0("@firebase/app"),gw="@firebase/app-compat",mw="@firebase/analytics-compat",yw="@firebase/analytics",vw="@firebase/app-check-compat",xw="@firebase/app-check",_w="@firebase/auth",ww="@firebase/auth-compat",Sw="@firebase/database",Ew="@firebase/data-connect",Tw="@firebase/database-compat",Iw="@firebase/functions",Cw="@firebase/functions-compat",Aw="@firebase/installations",kw="@firebase/installations-compat",Rw="@firebase/messaging",Pw="@firebase/messaging-compat",bw="@firebase/performance",Dw="@firebase/performance-compat",jw="@firebase/remote-config",Nw="@firebase/remote-config-compat",Mw="@firebase/storage",Vw="@firebase/storage-compat",Lw="@firebase/firestore",Fw="@firebase/vertexai-preview",Ow="@firebase/firestore-compat",zw="firebase",Bw="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sd="[DEFAULT]",Uw={[wd]:"fire-core",[gw]:"fire-core-compat",[yw]:"fire-analytics",[mw]:"fire-analytics-compat",[xw]:"fire-app-check",[vw]:"fire-app-check-compat",[_w]:"fire-auth",[ww]:"fire-auth-compat",[Sw]:"fire-rtdb",[Ew]:"fire-data-connect",[Tw]:"fire-rtdb-compat",[Iw]:"fire-fn",[Cw]:"fire-fn-compat",[Aw]:"fire-iid",[kw]:"fire-iid-compat",[Rw]:"fire-fcm",[Pw]:"fire-fcm-compat",[bw]:"fire-perf",[Dw]:"fire-perf-compat",[jw]:"fire-rc",[Nw]:"fire-rc-compat",[Mw]:"fire-gcs",[Vw]:"fire-gcs-compat",[Lw]:"fire-fst",[Ow]:"fire-fst-compat",[Fw]:"fire-vertex","fire-js":"fire-js",[zw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ql=new Map,$w=new Map,Ed=new Map;function ag(t,e){try{t.container.addComponent(e)}catch(n){vr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function na(t){const e=t.name;if(Ed.has(e))return vr.debug(`There were multiple attempts to register component ${e}.`),!1;Ed.set(e,t);for(const n of Ql.values())ag(n,t);for(const n of $w.values())ag(n,t);return!0}function E0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ww={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qr=new x0("app","Firebase",Ww);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Pi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw=Bw;function T0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Sd,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw qr.create("bad-app-name",{appName:String(s)});if(n||(n=v0()),!n)throw qr.create("no-options");const i=Ql.get(s);if(i){if(Gl(n,i.options)&&Gl(r,i.config))return i;throw qr.create("duplicate-app",{appName:s})}const a=new X1(s);for(const c of Ed.values())a.addComponent(c);const l=new Hw(n,r,a);return Ql.set(s,l),l}function Gw(t=Sd){const e=Ql.get(t);if(!e&&t===Sd&&v0())return T0();if(!e)throw qr.create("no-app",{appName:t});return e}function Gr(t,e,n){var r;let s=(r=Uw[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),vr.warn(l.join(" "));return}na(new Pi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw="firebase-heartbeat-database",Kw=1,ra="firebase-heartbeat-store";let vc=null;function I0(){return vc||(vc=cw(Qw,Kw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ra)}catch(n){console.warn(n)}}}}).catch(t=>{throw qr.create("idb-open",{originalErrorMessage:t.message})})),vc}async function Yw(t){try{const n=(await I0()).transaction(ra),r=await n.objectStore(ra).get(C0(t));return await n.done,r}catch(e){if(e instanceof zi)vr.warn(e.message);else{const n=qr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});vr.warn(n.message)}}}async function lg(t,e){try{const r=(await I0()).transaction(ra,"readwrite");await r.objectStore(ra).put(e,C0(t)),await r.done}catch(n){if(n instanceof zi)vr.warn(n.message);else{const r=qr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});vr.warn(r.message)}}}function C0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw=1024,Jw=30*24*60*60*1e3;class Zw{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new tS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ug();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=Jw}),this._storage.overwrite(this._heartbeatsCache))}catch(r){vr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=ug(),{heartbeatsToSend:r,unsentEntries:s}=eS(this._heartbeatsCache.heartbeats),i=y0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return vr.warn(n),""}}}function ug(){return new Date().toISOString().substring(0,10)}function eS(t,e=Xw){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),cg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),cg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class tS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $1()?W1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Yw(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return lg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return lg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function cg(t){return y0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(t){na(new Pi("platform-logger",e=>new fw(e),"PRIVATE")),na(new Pi("heartbeat",e=>new Zw(e),"PRIVATE")),Gr(wd,og,t),Gr(wd,og,"esm2017"),Gr("fire-js","")}nS("");var rS="firebase",sS="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gr(rS,sS,"app");var dg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var As,A0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,g){function S(){}S.prototype=g.prototype,E.D=g.prototype,E.prototype=new S,E.prototype.constructor=E,E.C=function(I,v,R){for(var _=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)_[ee-2]=arguments[ee];return g.prototype[v].apply(I,_)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,g,S){S||(S=0);var I=Array(16);if(typeof g=="string")for(var v=0;16>v;++v)I[v]=g.charCodeAt(S++)|g.charCodeAt(S++)<<8|g.charCodeAt(S++)<<16|g.charCodeAt(S++)<<24;else for(v=0;16>v;++v)I[v]=g[S++]|g[S++]<<8|g[S++]<<16|g[S++]<<24;g=E.g[0],S=E.g[1],v=E.g[2];var R=E.g[3],_=g+(R^S&(v^R))+I[0]+3614090360&4294967295;g=S+(_<<7&4294967295|_>>>25),_=R+(v^g&(S^v))+I[1]+3905402710&4294967295,R=g+(_<<12&4294967295|_>>>20),_=v+(S^R&(g^S))+I[2]+606105819&4294967295,v=R+(_<<17&4294967295|_>>>15),_=S+(g^v&(R^g))+I[3]+3250441966&4294967295,S=v+(_<<22&4294967295|_>>>10),_=g+(R^S&(v^R))+I[4]+4118548399&4294967295,g=S+(_<<7&4294967295|_>>>25),_=R+(v^g&(S^v))+I[5]+1200080426&4294967295,R=g+(_<<12&4294967295|_>>>20),_=v+(S^R&(g^S))+I[6]+2821735955&4294967295,v=R+(_<<17&4294967295|_>>>15),_=S+(g^v&(R^g))+I[7]+4249261313&4294967295,S=v+(_<<22&4294967295|_>>>10),_=g+(R^S&(v^R))+I[8]+1770035416&4294967295,g=S+(_<<7&4294967295|_>>>25),_=R+(v^g&(S^v))+I[9]+2336552879&4294967295,R=g+(_<<12&4294967295|_>>>20),_=v+(S^R&(g^S))+I[10]+4294925233&4294967295,v=R+(_<<17&4294967295|_>>>15),_=S+(g^v&(R^g))+I[11]+2304563134&4294967295,S=v+(_<<22&4294967295|_>>>10),_=g+(R^S&(v^R))+I[12]+1804603682&4294967295,g=S+(_<<7&4294967295|_>>>25),_=R+(v^g&(S^v))+I[13]+4254626195&4294967295,R=g+(_<<12&4294967295|_>>>20),_=v+(S^R&(g^S))+I[14]+2792965006&4294967295,v=R+(_<<17&4294967295|_>>>15),_=S+(g^v&(R^g))+I[15]+1236535329&4294967295,S=v+(_<<22&4294967295|_>>>10),_=g+(v^R&(S^v))+I[1]+4129170786&4294967295,g=S+(_<<5&4294967295|_>>>27),_=R+(S^v&(g^S))+I[6]+3225465664&4294967295,R=g+(_<<9&4294967295|_>>>23),_=v+(g^S&(R^g))+I[11]+643717713&4294967295,v=R+(_<<14&4294967295|_>>>18),_=S+(R^g&(v^R))+I[0]+3921069994&4294967295,S=v+(_<<20&4294967295|_>>>12),_=g+(v^R&(S^v))+I[5]+3593408605&4294967295,g=S+(_<<5&4294967295|_>>>27),_=R+(S^v&(g^S))+I[10]+38016083&4294967295,R=g+(_<<9&4294967295|_>>>23),_=v+(g^S&(R^g))+I[15]+3634488961&4294967295,v=R+(_<<14&4294967295|_>>>18),_=S+(R^g&(v^R))+I[4]+3889429448&4294967295,S=v+(_<<20&4294967295|_>>>12),_=g+(v^R&(S^v))+I[9]+568446438&4294967295,g=S+(_<<5&4294967295|_>>>27),_=R+(S^v&(g^S))+I[14]+3275163606&4294967295,R=g+(_<<9&4294967295|_>>>23),_=v+(g^S&(R^g))+I[3]+4107603335&4294967295,v=R+(_<<14&4294967295|_>>>18),_=S+(R^g&(v^R))+I[8]+1163531501&4294967295,S=v+(_<<20&4294967295|_>>>12),_=g+(v^R&(S^v))+I[13]+2850285829&4294967295,g=S+(_<<5&4294967295|_>>>27),_=R+(S^v&(g^S))+I[2]+4243563512&4294967295,R=g+(_<<9&4294967295|_>>>23),_=v+(g^S&(R^g))+I[7]+1735328473&4294967295,v=R+(_<<14&4294967295|_>>>18),_=S+(R^g&(v^R))+I[12]+2368359562&4294967295,S=v+(_<<20&4294967295|_>>>12),_=g+(S^v^R)+I[5]+4294588738&4294967295,g=S+(_<<4&4294967295|_>>>28),_=R+(g^S^v)+I[8]+2272392833&4294967295,R=g+(_<<11&4294967295|_>>>21),_=v+(R^g^S)+I[11]+1839030562&4294967295,v=R+(_<<16&4294967295|_>>>16),_=S+(v^R^g)+I[14]+4259657740&4294967295,S=v+(_<<23&4294967295|_>>>9),_=g+(S^v^R)+I[1]+2763975236&4294967295,g=S+(_<<4&4294967295|_>>>28),_=R+(g^S^v)+I[4]+1272893353&4294967295,R=g+(_<<11&4294967295|_>>>21),_=v+(R^g^S)+I[7]+4139469664&4294967295,v=R+(_<<16&4294967295|_>>>16),_=S+(v^R^g)+I[10]+3200236656&4294967295,S=v+(_<<23&4294967295|_>>>9),_=g+(S^v^R)+I[13]+681279174&4294967295,g=S+(_<<4&4294967295|_>>>28),_=R+(g^S^v)+I[0]+3936430074&4294967295,R=g+(_<<11&4294967295|_>>>21),_=v+(R^g^S)+I[3]+3572445317&4294967295,v=R+(_<<16&4294967295|_>>>16),_=S+(v^R^g)+I[6]+76029189&4294967295,S=v+(_<<23&4294967295|_>>>9),_=g+(S^v^R)+I[9]+3654602809&4294967295,g=S+(_<<4&4294967295|_>>>28),_=R+(g^S^v)+I[12]+3873151461&4294967295,R=g+(_<<11&4294967295|_>>>21),_=v+(R^g^S)+I[15]+530742520&4294967295,v=R+(_<<16&4294967295|_>>>16),_=S+(v^R^g)+I[2]+3299628645&4294967295,S=v+(_<<23&4294967295|_>>>9),_=g+(v^(S|~R))+I[0]+4096336452&4294967295,g=S+(_<<6&4294967295|_>>>26),_=R+(S^(g|~v))+I[7]+1126891415&4294967295,R=g+(_<<10&4294967295|_>>>22),_=v+(g^(R|~S))+I[14]+2878612391&4294967295,v=R+(_<<15&4294967295|_>>>17),_=S+(R^(v|~g))+I[5]+4237533241&4294967295,S=v+(_<<21&4294967295|_>>>11),_=g+(v^(S|~R))+I[12]+1700485571&4294967295,g=S+(_<<6&4294967295|_>>>26),_=R+(S^(g|~v))+I[3]+2399980690&4294967295,R=g+(_<<10&4294967295|_>>>22),_=v+(g^(R|~S))+I[10]+4293915773&4294967295,v=R+(_<<15&4294967295|_>>>17),_=S+(R^(v|~g))+I[1]+2240044497&4294967295,S=v+(_<<21&4294967295|_>>>11),_=g+(v^(S|~R))+I[8]+1873313359&4294967295,g=S+(_<<6&4294967295|_>>>26),_=R+(S^(g|~v))+I[15]+4264355552&4294967295,R=g+(_<<10&4294967295|_>>>22),_=v+(g^(R|~S))+I[6]+2734768916&4294967295,v=R+(_<<15&4294967295|_>>>17),_=S+(R^(v|~g))+I[13]+1309151649&4294967295,S=v+(_<<21&4294967295|_>>>11),_=g+(v^(S|~R))+I[4]+4149444226&4294967295,g=S+(_<<6&4294967295|_>>>26),_=R+(S^(g|~v))+I[11]+3174756917&4294967295,R=g+(_<<10&4294967295|_>>>22),_=v+(g^(R|~S))+I[2]+718787259&4294967295,v=R+(_<<15&4294967295|_>>>17),_=S+(R^(v|~g))+I[9]+3951481745&4294967295,E.g[0]=E.g[0]+g&4294967295,E.g[1]=E.g[1]+(v+(_<<21&4294967295|_>>>11))&4294967295,E.g[2]=E.g[2]+v&4294967295,E.g[3]=E.g[3]+R&4294967295}r.prototype.u=function(E,g){g===void 0&&(g=E.length);for(var S=g-this.blockSize,I=this.B,v=this.h,R=0;R<g;){if(v==0)for(;R<=S;)s(this,E,R),R+=this.blockSize;if(typeof E=="string"){for(;R<g;)if(I[v++]=E.charCodeAt(R++),v==this.blockSize){s(this,I),v=0;break}}else for(;R<g;)if(I[v++]=E[R++],v==this.blockSize){s(this,I),v=0;break}}this.h=v,this.o+=g},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var g=1;g<E.length-8;++g)E[g]=0;var S=8*this.o;for(g=E.length-8;g<E.length;++g)E[g]=S&255,S/=256;for(this.u(E),E=Array(16),g=S=0;4>g;++g)for(var I=0;32>I;I+=8)E[S++]=this.g[g]>>>I&255;return E};function i(E,g){var S=l;return Object.prototype.hasOwnProperty.call(S,E)?S[E]:S[E]=g(E)}function a(E,g){this.h=g;for(var S=[],I=!0,v=E.length-1;0<=v;v--){var R=E[v]|0;I&&R==g||(S[v]=R,I=!1)}this.g=S}var l={};function c(E){return-128<=E&&128>E?i(E,function(g){return new a([g|0],0>g?-1:0)}):new a([E|0],0>E?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return m;if(0>E)return z(h(-E));for(var g=[],S=1,I=0;E>=S;I++)g[I]=E/S|0,S*=4294967296;return new a(g,0)}function p(E,g){if(E.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(E.charAt(0)=="-")return z(p(E.substring(1),g));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=h(Math.pow(g,8)),I=m,v=0;v<E.length;v+=8){var R=Math.min(8,E.length-v),_=parseInt(E.substring(v,v+R),g);8>R?(R=h(Math.pow(g,R)),I=I.j(R).add(h(_))):(I=I.j(S),I=I.add(h(_)))}return I}var m=c(0),y=c(1),C=c(16777216);t=a.prototype,t.m=function(){if(P(this))return-z(this).m();for(var E=0,g=1,S=0;S<this.g.length;S++){var I=this.i(S);E+=(0<=I?I:4294967296+I)*g,g*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(k(this))return"0";if(P(this))return"-"+z(this).toString(E);for(var g=h(Math.pow(E,6)),S=this,I="";;){var v=V(S,g).g;S=A(S,v.j(g));var R=((0<S.g.length?S.g[0]:S.h)>>>0).toString(E);if(S=v,k(S))return R+I;for(;6>R.length;)R="0"+R;I=R+I}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function k(E){if(E.h!=0)return!1;for(var g=0;g<E.g.length;g++)if(E.g[g]!=0)return!1;return!0}function P(E){return E.h==-1}t.l=function(E){return E=A(this,E),P(E)?-1:k(E)?0:1};function z(E){for(var g=E.g.length,S=[],I=0;I<g;I++)S[I]=~E.g[I];return new a(S,~E.h).add(y)}t.abs=function(){return P(this)?z(this):this},t.add=function(E){for(var g=Math.max(this.g.length,E.g.length),S=[],I=0,v=0;v<=g;v++){var R=I+(this.i(v)&65535)+(E.i(v)&65535),_=(R>>>16)+(this.i(v)>>>16)+(E.i(v)>>>16);I=_>>>16,R&=65535,_&=65535,S[v]=_<<16|R}return new a(S,S[S.length-1]&-2147483648?-1:0)};function A(E,g){return E.add(z(g))}t.j=function(E){if(k(this)||k(E))return m;if(P(this))return P(E)?z(this).j(z(E)):z(z(this).j(E));if(P(E))return z(this.j(z(E)));if(0>this.l(C)&&0>E.l(C))return h(this.m()*E.m());for(var g=this.g.length+E.g.length,S=[],I=0;I<2*g;I++)S[I]=0;for(I=0;I<this.g.length;I++)for(var v=0;v<E.g.length;v++){var R=this.i(I)>>>16,_=this.i(I)&65535,ee=E.i(v)>>>16,Z=E.i(v)&65535;S[2*I+2*v]+=_*Z,w(S,2*I+2*v),S[2*I+2*v+1]+=R*Z,w(S,2*I+2*v+1),S[2*I+2*v+1]+=_*ee,w(S,2*I+2*v+1),S[2*I+2*v+2]+=R*ee,w(S,2*I+2*v+2)}for(I=0;I<g;I++)S[I]=S[2*I+1]<<16|S[2*I];for(I=g;I<2*g;I++)S[I]=0;return new a(S,0)};function w(E,g){for(;(E[g]&65535)!=E[g];)E[g+1]+=E[g]>>>16,E[g]&=65535,g++}function T(E,g){this.g=E,this.h=g}function V(E,g){if(k(g))throw Error("division by zero");if(k(E))return new T(m,m);if(P(E))return g=V(z(E),g),new T(z(g.g),z(g.h));if(P(g))return g=V(E,z(g)),new T(z(g.g),g.h);if(30<E.g.length){if(P(E)||P(g))throw Error("slowDivide_ only works with positive integers.");for(var S=y,I=g;0>=I.l(E);)S=$(S),I=$(I);var v=j(S,1),R=j(I,1);for(I=j(I,2),S=j(S,2);!k(I);){var _=R.add(I);0>=_.l(E)&&(v=v.add(S),R=_),I=j(I,1),S=j(S,1)}return g=A(E,v.j(g)),new T(v,g)}for(v=m;0<=E.l(g);){for(S=Math.max(1,Math.floor(E.m()/g.m())),I=Math.ceil(Math.log(S)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),R=h(S),_=R.j(g);P(_)||0<_.l(E);)S-=I,R=h(S),_=R.j(g);k(R)&&(R=y),v=v.add(R),E=A(E,_)}return new T(v,E)}t.A=function(E){return V(this,E).h},t.and=function(E){for(var g=Math.max(this.g.length,E.g.length),S=[],I=0;I<g;I++)S[I]=this.i(I)&E.i(I);return new a(S,this.h&E.h)},t.or=function(E){for(var g=Math.max(this.g.length,E.g.length),S=[],I=0;I<g;I++)S[I]=this.i(I)|E.i(I);return new a(S,this.h|E.h)},t.xor=function(E){for(var g=Math.max(this.g.length,E.g.length),S=[],I=0;I<g;I++)S[I]=this.i(I)^E.i(I);return new a(S,this.h^E.h)};function $(E){for(var g=E.g.length+1,S=[],I=0;I<g;I++)S[I]=E.i(I)<<1|E.i(I-1)>>>31;return new a(S,E.h)}function j(E,g){var S=g>>5;g%=32;for(var I=E.g.length-S,v=[],R=0;R<I;R++)v[R]=0<g?E.i(R+S)>>>g|E.i(R+S+1)<<32-g:E.i(R+S);return new a(v,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,A0=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,As=a}).apply(typeof dg<"u"?dg:typeof self<"u"?self:typeof window<"u"?window:{});var tl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var k0,So,R0,yl,Td,P0,b0,D0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,d,f){return o==Array.prototype||o==Object.prototype||(o[d]=f.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof tl=="object"&&tl];for(var d=0;d<o.length;++d){var f=o[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(o,d){if(d)e:{var f=r;o=o.split(".");for(var x=0;x<o.length-1;x++){var N=o[x];if(!(N in f))break e;f=f[N]}o=o[o.length-1],x=f[o],d=d(x),d!=x&&d!=null&&e(f,o,{configurable:!0,writable:!0,value:d})}}function i(o,d){o instanceof String&&(o+="");var f=0,x=!1,N={next:function(){if(!x&&f<o.length){var F=f++;return{value:d(F,o[F]),done:!1}}return x=!0,{done:!0,value:void 0}}};return N[Symbol.iterator]=function(){return N},N}s("Array.prototype.values",function(o){return o||function(){return i(this,function(d,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function c(o){var d=typeof o;return d=d!="object"?d:o?Array.isArray(o)?"array":d:"null",d=="array"||d=="object"&&typeof o.length=="number"}function h(o){var d=typeof o;return d=="object"&&o!=null||d=="function"}function p(o,d,f){return o.call.apply(o.bind,arguments)}function m(o,d,f){if(!o)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var N=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(N,x),o.apply(d,N)}}return function(){return o.apply(d,arguments)}}function y(o,d,f){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,y.apply(null,arguments)}function C(o,d){var f=Array.prototype.slice.call(arguments,1);return function(){var x=f.slice();return x.push.apply(x,arguments),o.apply(this,x)}}function k(o,d){function f(){}f.prototype=d.prototype,o.aa=d.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(x,N,F){for(var J=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)J[Me-2]=arguments[Me];return d.prototype[N].apply(x,J)}}function P(o){const d=o.length;if(0<d){const f=Array(d);for(let x=0;x<d;x++)f[x]=o[x];return f}return[]}function z(o,d){for(let f=1;f<arguments.length;f++){const x=arguments[f];if(c(x)){const N=o.length||0,F=x.length||0;o.length=N+F;for(let J=0;J<F;J++)o[N+J]=x[J]}else o.push(x)}}class A{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function w(o){return/^[\s\xa0]*$/.test(o)}function T(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function V(o){return V[" "](o),o}V[" "]=function(){};var $=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function j(o,d,f){for(const x in o)d.call(f,o[x],x,o)}function E(o,d){for(const f in o)d.call(void 0,o[f],f,o)}function g(o){const d={};for(const f in o)d[f]=o[f];return d}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(o,d){let f,x;for(let N=1;N<arguments.length;N++){x=arguments[N];for(f in x)o[f]=x[f];for(let F=0;F<S.length;F++)f=S[F],Object.prototype.hasOwnProperty.call(x,f)&&(o[f]=x[f])}}function v(o){var d=1;o=o.split(":");const f=[];for(;0<d&&o.length;)f.push(o.shift()),d--;return o.length&&f.push(o.join(":")),f}function R(o){l.setTimeout(()=>{throw o},0)}function _(){var o=D;let d=null;return o.g&&(d=o.g,o.g=o.g.next,o.g||(o.h=null),d.next=null),d}class ee{constructor(){this.h=this.g=null}add(d,f){const x=Z.get();x.set(d,f),this.h?this.h.next=x:this.g=x,this.h=x}}var Z=new A(()=>new ce,o=>o.reset());class ce{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let U,b=!1,D=new ee,L=()=>{const o=l.Promise.resolve(void 0);U=()=>{o.then(O)}};var O=()=>{for(var o;o=_();){try{o.h.call(o.g)}catch(f){R(f)}var d=Z;d.j(o),100>d.h&&(d.h++,o.next=d.g,d.g=o)}b=!1};function Y(){this.s=this.s,this.C=this.C}Y.prototype.s=!1,Y.prototype.ma=function(){this.s||(this.s=!0,this.N())},Y.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(o,d){this.type=o,this.g=this.target=d,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var ne=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,d=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};l.addEventListener("test",f,d),l.removeEventListener("test",f,d)}catch{}return o}();function oe(o,d){if(q.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,x=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=d,d=o.relatedTarget){if($){e:{try{V(d.nodeName);var N=!0;break e}catch{}N=!1}N||(d=null)}}else f=="mouseover"?d=o.fromElement:f=="mouseout"&&(d=o.toElement);this.relatedTarget=d,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:ye[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&oe.aa.h.call(this)}}k(oe,q);var ye={2:"touch",3:"pen",4:"mouse"};oe.prototype.h=function(){oe.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var ge="closure_listenable_"+(1e6*Math.random()|0),Te=0;function ve(o,d,f,x,N){this.listener=o,this.proxy=null,this.src=d,this.type=f,this.capture=!!x,this.ha=N,this.key=++Te,this.da=this.fa=!1}function ae(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function we(o){this.src=o,this.g={},this.h=0}we.prototype.add=function(o,d,f,x,N){var F=o.toString();o=this.g[F],o||(o=this.g[F]=[],this.h++);var J=Ae(o,d,x,N);return-1<J?(d=o[J],f||(d.fa=!1)):(d=new ve(d,this.src,F,!!x,N),d.fa=f,o.push(d)),d};function xe(o,d){var f=d.type;if(f in o.g){var x=o.g[f],N=Array.prototype.indexOf.call(x,d,void 0),F;(F=0<=N)&&Array.prototype.splice.call(x,N,1),F&&(ae(d),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Ae(o,d,f,x){for(var N=0;N<o.length;++N){var F=o[N];if(!F.da&&F.listener==d&&F.capture==!!f&&F.ha==x)return N}return-1}var pt="closure_lm_"+(1e6*Math.random()|0),Ze={};function Ct(o,d,f,x,N){if(Array.isArray(d)){for(var F=0;F<d.length;F++)Ct(o,d[F],f,x,N);return null}return f=zs(f),o&&o[ge]?o.K(d,f,h(x)?!!x.capture:!1,N):zn(o,d,f,!1,x,N)}function zn(o,d,f,x,N,F){if(!d)throw Error("Invalid event type");var J=h(N)?!!N.capture:!!N,Me=is(o);if(Me||(o[pt]=Me=new we(o)),f=Me.add(d,f,x,J,F),f.proxy)return f;if(x=Ht(),f.proxy=x,x.src=o,x.listener=f,o.addEventListener)ne||(N=J),N===void 0&&(N=!1),o.addEventListener(d.toString(),x,N);else if(o.attachEvent)o.attachEvent(Bn(d.toString()),x);else if(o.addListener&&o.removeListener)o.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Ht(){function o(f){return d.call(o.src,o.listener,f)}const d=ss;return o}function tn(o,d,f,x,N){if(Array.isArray(d))for(var F=0;F<d.length;F++)tn(o,d[F],f,x,N);else x=h(x)?!!x.capture:!!x,f=zs(f),o&&o[ge]?(o=o.i,d=String(d).toString(),d in o.g&&(F=o.g[d],f=Ae(F,f,x,N),-1<f&&(ae(F[f]),Array.prototype.splice.call(F,f,1),F.length==0&&(delete o.g[d],o.h--)))):o&&(o=is(o))&&(d=o.g[d.toString()],o=-1,d&&(o=Ae(d,f,x,N)),(f=-1<o?d[o]:null)&&qt(f))}function qt(o){if(typeof o!="number"&&o&&!o.da){var d=o.src;if(d&&d[ge])xe(d.i,o);else{var f=o.type,x=o.proxy;d.removeEventListener?d.removeEventListener(f,x,o.capture):d.detachEvent?d.detachEvent(Bn(f),x):d.addListener&&d.removeListener&&d.removeListener(x),(f=is(d))?(xe(f,o),f.h==0&&(f.src=null,d[pt]=null)):ae(o)}}}function Bn(o){return o in Ze?Ze[o]:Ze[o]="on"+o}function ss(o,d){if(o.da)o=!0;else{d=new oe(d,this);var f=o.listener,x=o.ha||o.src;o.fa&&qt(o),o=f.call(x,d)}return o}function is(o){return o=o[pt],o instanceof we?o:null}var er="__closure_events_fn_"+(1e9*Math.random()>>>0);function zs(o){return typeof o=="function"?o:(o[er]||(o[er]=function(d){return o.handleEvent(d)}),o[er])}function rt(){Y.call(this),this.i=new we(this),this.M=this,this.F=null}k(rt,Y),rt.prototype[ge]=!0,rt.prototype.removeEventListener=function(o,d,f,x){tn(this,o,d,f,x)};function gt(o,d){var f,x=o.F;if(x)for(f=[];x;x=x.F)f.push(x);if(o=o.M,x=d.type||d,typeof d=="string")d=new q(d,o);else if(d instanceof q)d.target=d.target||o;else{var N=d;d=new q(x,o),I(d,N)}if(N=!0,f)for(var F=f.length-1;0<=F;F--){var J=d.g=f[F];N=Er(J,x,!0,d)&&N}if(J=d.g=o,N=Er(J,x,!0,d)&&N,N=Er(J,x,!1,d)&&N,f)for(F=0;F<f.length;F++)J=d.g=f[F],N=Er(J,x,!1,d)&&N}rt.prototype.N=function(){if(rt.aa.N.call(this),this.i){var o=this.i,d;for(d in o.g){for(var f=o.g[d],x=0;x<f.length;x++)ae(f[x]);delete o.g[d],o.h--}}this.F=null},rt.prototype.K=function(o,d,f,x){return this.i.add(String(o),d,!1,f,x)},rt.prototype.L=function(o,d,f,x){return this.i.add(String(o),d,!0,f,x)};function Er(o,d,f,x){if(d=o.i.g[String(d)],!d)return!0;d=d.concat();for(var N=!0,F=0;F<d.length;++F){var J=d[F];if(J&&!J.da&&J.capture==f){var Me=J.listener,yt=J.ha||J.src;J.fa&&xe(o.i,J),N=Me.call(yt,x)!==!1&&N}}return N&&!x.defaultPrevented}function Tr(o,d,f){if(typeof o=="function")f&&(o=y(o,f));else if(o&&typeof o.handleEvent=="function")o=y(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:l.setTimeout(o,d||0)}function os(o){o.g=Tr(()=>{o.g=null,o.i&&(o.i=!1,os(o))},o.l);const d=o.h;o.h=null,o.m.apply(null,d)}class Qe extends Y{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:os(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function as(o){Y.call(this),this.h=o,this.g={}}k(as,Y);var Ia=[];function qi(o){j(o.g,function(d,f){this.g.hasOwnProperty(f)&&qt(d)},o),o.g={}}as.prototype.N=function(){as.aa.N.call(this),qi(this)},as.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var tr=l.JSON.stringify,Gi=l.JSON.parse,Bs=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function ls(){}ls.prototype.h=null;function ke(o){return o.h||(o.h=o.i())}function Sn(){}var Un={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function us(){q.call(this,"d")}k(us,q);function Ca(){q.call(this,"c")}k(Ca,q);var En={},Mu=null;function Ir(){return Mu=Mu||new rt}En.La="serverreachability";function Aa(o){q.call(this,En.La,o)}k(Aa,q);function Tn(o){const d=Ir();gt(d,new Aa(d))}En.STAT_EVENT="statevent";function be(o,d){q.call(this,En.STAT_EVENT,o),this.stat=d}k(be,q);function mt(o){const d=Ir();gt(d,new be(d,o))}En.Ma="timingevent";function hn(o,d){q.call(this,En.Ma,o),this.size=d}k(hn,q);function In(o,d){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},d)}function fn(){this.g=!0}fn.prototype.xa=function(){this.g=!1};function Qi(o,d,f,x,N,F){o.info(function(){if(o.g)if(F)for(var J="",Me=F.split("&"),yt=0;yt<Me.length;yt++){var Re=Me[yt].split("=");if(1<Re.length){var kt=Re[0];Re=Re[1];var Rt=kt.split("_");J=2<=Rt.length&&Rt[1]=="type"?J+(kt+"="+Re+"&"):J+(kt+"=redacted&")}}else J=null;else J=F;return"XMLHTTP REQ ("+x+") [attempt "+N+"]: "+d+`
`+f+`
`+J})}function Vu(o,d,f,x,N,F,J){o.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+N+"]: "+d+`
`+f+`
`+F+" "+J})}function Cr(o,d,f,x){o.info(function(){return"XMLHTTP TEXT ("+d+"): "+If(o,f)+(x?" "+x:"")})}function Tf(o,d){o.info(function(){return"TIMEOUT: "+d})}fn.prototype.info=function(){};function If(o,d){if(!o.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var x=f[o];if(!(2>x.length)){var N=x[1];if(Array.isArray(N)&&!(1>N.length)){var F=N[0];if(F!="noop"&&F!="stop"&&F!="close")for(var J=1;J<N.length;J++)N[J]=""}}}}return tr(f)}catch{return d}}var cs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Us={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},$s;function Ar(){}k(Ar,ls),Ar.prototype.g=function(){return new XMLHttpRequest},Ar.prototype.i=function(){return{}},$s=new Ar;function Gt(o,d,f,x){this.j=o,this.i=d,this.l=f,this.R=x||1,this.U=new as(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ki}function Ki(){this.i=null,this.g="",this.h=!1}var Yi={},Xi={};function ds(o,d,f){o.L=1,o.v=X(An(d)),o.m=f,o.P=!0,kr(o,null)}function kr(o,d){o.F=Date.now(),Hs(o),o.A=An(o.v);var f=o.A,x=o.R;Array.isArray(x)||(x=[String(x)]),ro(f.i,"t",x),o.C=0,f=o.j.J,o.h=new Ki,o.g=Uf(o.j,f?d:null,!o.m),0<o.O&&(o.M=new Qe(y(o.Y,o,o.g),o.O)),d=o.U,f=o.g,x=o.ca;var N="readystatechange";Array.isArray(N)||(N&&(Ia[0]=N.toString()),N=Ia);for(var F=0;F<N.length;F++){var J=Ct(f,N[F],x||d.handleEvent,!1,d.h||d);if(!J)break;d.g[J.key]=J}d=o.H?g(o.H):{},o.m?(o.u||(o.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,d)):(o.u="GET",o.g.ea(o.A,o.u,null,d)),Tn(),Qi(o.i,o.u,o.A,o.l,o.R,o.m)}Gt.prototype.ca=function(o){o=o.target;const d=this.M;d&&ir(o)==3?d.j():this.Y(o)},Gt.prototype.Y=function(o){try{if(o==this.g)e:{const Rt=ir(this.g);var d=this.g.Ba();const Js=this.g.Z();if(!(3>Rt)&&(Rt!=3||this.g&&(this.h.h||this.g.oa()||bf(this.g)))){this.J||Rt!=4||d==7||(d==8||0>=Js?Tn(3):Tn(2)),nr(this);var f=this.g.Z();this.X=f;t:if(Ws(this)){var x=bf(this.g);o="";var N=x.length,F=ir(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){rr(this),qs(this);var J="";break t}this.h.i=new l.TextDecoder}for(d=0;d<N;d++)this.h.h=!0,o+=this.h.i.decode(x[d],{stream:!(F&&d==N-1)});x.length=0,this.h.g+=o,this.C=0,J=this.h.g}else J=this.g.oa();if(this.o=f==200,Vu(this.i,this.u,this.A,this.l,this.R,Rt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Me,yt=this.g;if((Me=yt.g?yt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Me)){var Re=Me;break t}}Re=null}if(f=Re)Cr(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$n(this,f);else{this.o=!1,this.s=3,mt(12),rr(this),qs(this);break e}}if(this.P){f=!0;let kn;for(;!this.J&&this.C<J.length;)if(kn=ka(this,J),kn==Xi){Rt==4&&(this.s=4,mt(14),f=!1),Cr(this.i,this.l,null,"[Incomplete Response]");break}else if(kn==Yi){this.s=4,mt(15),Cr(this.i,this.l,J,"[Invalid Chunk]"),f=!1;break}else Cr(this.i,this.l,kn,null),$n(this,kn);if(Ws(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Rt!=4||J.length!=0||this.h.h||(this.s=1,mt(16),f=!1),this.o=this.o&&f,!f)Cr(this.i,this.l,J,"[Invalid Chunked Response]"),rr(this),qs(this);else if(0<J.length&&!this.W){this.W=!0;var kt=this.j;kt.g==this&&kt.ba&&!kt.M&&(kt.j.info("Great, no buffering proxy detected. Bytes received: "+J.length),Bu(kt),kt.M=!0,mt(11))}}else Cr(this.i,this.l,J,null),$n(this,J);Rt==4&&rr(this),this.o&&!this.J&&(Rt==4?Ff(this.j,this):(this.o=!1,Hs(this)))}else tx(this.g),f==400&&0<J.indexOf("Unknown SID")?(this.s=3,mt(12)):(this.s=0,mt(13)),rr(this),qs(this)}}}catch{}finally{}};function Ws(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function ka(o,d){var f=o.C,x=d.indexOf(`
`,f);return x==-1?Xi:(f=Number(d.substring(f,x)),isNaN(f)?Yi:(x+=1,x+f>d.length?Xi:(d=d.slice(x,x+f),o.C=x+f,d)))}Gt.prototype.cancel=function(){this.J=!0,rr(this)};function Hs(o){o.S=Date.now()+o.I,Ra(o,o.I)}function Ra(o,d){if(o.B!=null)throw Error("WatchDog timer not null");o.B=In(y(o.ba,o),d)}function nr(o){o.B&&(l.clearTimeout(o.B),o.B=null)}Gt.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(Tf(this.i,this.A),this.L!=2&&(Tn(),mt(17)),rr(this),this.s=2,qs(this)):Ra(this,this.S-o)};function qs(o){o.j.G==0||o.J||Ff(o.j,o)}function rr(o){nr(o);var d=o.M;d&&typeof d.ma=="function"&&d.ma(),o.M=null,qi(o.U),o.g&&(d=o.g,o.g=null,d.abort(),d.ma())}function $n(o,d){try{var f=o.j;if(f.G!=0&&(f.g==o||eo(f.h,o))){if(!o.K&&eo(f.h,o)&&f.G==3){try{var x=f.Da.g.parse(d)}catch{x=null}if(Array.isArray(x)&&x.length==3){var N=x;if(N[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)Ma(f),ja(f);else break e;zu(f),mt(18)}}else f.za=N[1],0<f.za-f.T&&37500>N[2]&&f.F&&f.v==0&&!f.C&&(f.C=In(y(f.Za,f),6e3));if(1>=Zi(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else ys(f,11)}else if((o.K||f.g==o)&&Ma(f),!w(d))for(N=f.Da.g.parse(d),d=0;d<N.length;d++){let Re=N[d];if(f.T=Re[0],Re=Re[1],f.G==2)if(Re[0]=="c"){f.K=Re[1],f.ia=Re[2];const kt=Re[3];kt!=null&&(f.la=kt,f.j.info("VER="+f.la));const Rt=Re[4];Rt!=null&&(f.Aa=Rt,f.j.info("SVER="+f.Aa));const Js=Re[5];Js!=null&&typeof Js=="number"&&0<Js&&(x=1.5*Js,f.L=x,f.j.info("backChannelRequestTimeoutMs_="+x)),x=f;const kn=o.g;if(kn){const La=kn.g?kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(La){var F=x.h;F.g||La.indexOf("spdy")==-1&&La.indexOf("quic")==-1&&La.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(to(F,F.h),F.h=null))}if(x.D){const Uu=kn.g?kn.g.getResponseHeader("X-HTTP-Session-Id"):null;Uu&&(x.ya=Uu,B(x.I,x.D,Uu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),x=f;var J=o;if(x.qa=Bf(x,x.J?x.ia:null,x.W),J.K){Gs(x.h,J);var Me=J,yt=x.L;yt&&(Me.I=yt),Me.B&&(nr(Me),Hs(Me)),x.g=J}else Vf(x);0<f.i.length&&Na(f)}else Re[0]!="stop"&&Re[0]!="close"||ys(f,7);else f.G==3&&(Re[0]=="stop"||Re[0]=="close"?Re[0]=="stop"?ys(f,7):Ou(f):Re[0]!="noop"&&f.l&&f.l.ta(Re),f.v=0)}}Tn(4)}catch{}}var Lu=class{constructor(o,d){this.g=o,this.map=d}};function hs(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ji(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Zi(o){return o.h?1:o.g?o.g.size:0}function eo(o,d){return o.h?o.h==d:o.g?o.g.has(d):!1}function to(o,d){o.g?o.g.add(d):o.h=d}function Gs(o,d){o.h&&o.h==d?o.h=null:o.g&&o.g.has(d)&&o.g.delete(d)}hs.prototype.cancel=function(){if(this.i=Wn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Wn(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let d=o.i;for(const f of o.g.values())d=d.concat(f.D);return d}return P(o.i)}function Cn(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(c(o)){for(var d=[],f=o.length,x=0;x<f;x++)d.push(o[x]);return d}d=[],f=0;for(x in o)d[f++]=o[x];return d}function Qs(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(c(o)||typeof o=="string"){var d=[];o=o.length;for(var f=0;f<o;f++)d.push(f);return d}d=[],f=0;for(const x in o)d[f++]=x;return d}}}function no(o,d){if(o.forEach&&typeof o.forEach=="function")o.forEach(d,void 0);else if(c(o)||typeof o=="string")Array.prototype.forEach.call(o,d,void 0);else for(var f=Qs(o),x=Cn(o),N=x.length,F=0;F<N;F++)d.call(void 0,x[F],f&&f[F],o)}var Hn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pa(o,d){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var x=o[f].indexOf("="),N=null;if(0<=x){var F=o[f].substring(0,x);N=o[f].substring(x+1)}else F=o[f];d(F,N?decodeURIComponent(N.replace(/\+/g," ")):"")}}}function pn(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof pn){this.h=o.h,fs(this,o.j),this.o=o.o,this.g=o.g,Q(this,o.s),this.l=o.l;var d=o.i,f=new sr;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),W(this,f),this.m=o.m}else o&&(d=String(o).match(Hn))?(this.h=!1,fs(this,d[1]||"",!0),this.o=ie(d[2]||""),this.g=ie(d[3]||"",!0),Q(this,d[4]),this.l=ie(d[5]||"",!0),W(this,d[6]||"",!0),this.m=ie(d[7]||"")):(this.h=!1,this.i=new sr(null,this.h))}pn.prototype.toString=function(){var o=[],d=this.j;d&&o.push(he(d,Ke,!0),":");var f=this.g;return(f||d=="file")&&(o.push("//"),(d=this.o)&&o.push(he(d,Ke,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(he(f,f.charAt(0)=="/"?Ft:Lt,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",he(f,Ve)),o.join("")};function An(o){return new pn(o)}function fs(o,d,f){o.j=f?ie(d,!0):d,o.j&&(o.j=o.j.replace(/:$/,""))}function Q(o,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);o.s=d}else o.s=null}function W(o,d,f){d instanceof sr?(o.i=d,so(o.i,o.h)):(f||(d=he(d,Ot)),o.i=new sr(d,o.h))}function B(o,d,f){o.i.set(d,f)}function X(o){return B(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function ie(o,d){return o?d?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function he(o,d,f){return typeof o=="string"?(o=encodeURI(o).replace(d,Se),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Se(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Ke=/[#\/\?@]/g,Lt=/[#\?:]/g,Ft=/[#\?]/g,Ot=/[#\?@]/g,Ve=/#/g;function sr(o,d){this.h=this.g=null,this.i=o||null,this.j=!!d}function nn(o){o.g||(o.g=new Map,o.h=0,o.i&&Pa(o.i,function(d,f){o.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}t=sr.prototype,t.add=function(o,d){nn(this),this.i=null,o=ps(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(d),this.h+=1,this};function At(o,d){nn(o),d=ps(o,d),o.g.has(d)&&(o.i=null,o.h-=o.g.get(d).length,o.g.delete(d))}function Ks(o,d){return nn(o),d=ps(o,d),o.g.has(d)}t.forEach=function(o,d){nn(this),this.g.forEach(function(f,x){f.forEach(function(N){o.call(d,N,x,this)},this)},this)},t.na=function(){nn(this);const o=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let x=0;x<d.length;x++){const N=o[x];for(let F=0;F<N.length;F++)f.push(d[x])}return f},t.V=function(o){nn(this);let d=[];if(typeof o=="string")Ks(this,o)&&(d=d.concat(this.g.get(ps(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)d=d.concat(o[f])}return d},t.set=function(o,d){return nn(this),this.i=null,o=ps(this,o),Ks(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[d]),this.h+=1,this},t.get=function(o,d){return o?(o=this.V(o),0<o.length?String(o[0]):d):d};function ro(o,d,f){At(o,d),0<f.length&&(o.i=null,o.g.set(ps(o,d),P(f)),o.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var x=d[f];const F=encodeURIComponent(String(x)),J=this.V(x);for(x=0;x<J.length;x++){var N=F;J[x]!==""&&(N+="="+encodeURIComponent(String(J[x]))),o.push(N)}}return this.i=o.join("&")};function ps(o,d){return d=String(d),o.j&&(d=d.toLowerCase()),d}function so(o,d){d&&!o.j&&(nn(o),o.i=null,o.g.forEach(function(f,x){var N=x.toLowerCase();x!=N&&(At(this,x),ro(this,N,f))},o)),o.j=d}function Fu(o,d){const f=new fn;if(l.Image){const x=new Image;x.onload=C(at,f,"TestLoadImage: loaded",!0,d,x),x.onerror=C(at,f,"TestLoadImage: error",!1,d,x),x.onabort=C(at,f,"TestLoadImage: abort",!1,d,x),x.ontimeout=C(at,f,"TestLoadImage: timeout",!1,d,x),l.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=o}else d(!1)}function io(o,d){const f=new fn,x=new AbortController,N=setTimeout(()=>{x.abort(),at(f,"TestPingServer: timeout",!1,d)},1e4);fetch(o,{signal:x.signal}).then(F=>{clearTimeout(N),F.ok?at(f,"TestPingServer: ok",!0,d):at(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(N),at(f,"TestPingServer: error",!1,d)})}function at(o,d,f,x,N){try{N&&(N.onload=null,N.onerror=null,N.onabort=null,N.ontimeout=null),x(f)}catch{}}function Cf(){this.g=new Bs}function ba(o,d,f){const x=f||"";try{no(o,function(N,F){let J=N;h(N)&&(J=tr(N)),d.push(x+F+"="+encodeURIComponent(J))})}catch(N){throw d.push(x+"type="+encodeURIComponent("_badmap")),N}}function gs(o){this.l=o.Ub||null,this.j=o.eb||!1}k(gs,ls),gs.prototype.g=function(){return new ue(this.l,this.j)},gs.prototype.i=function(o){return function(){return o}}({});function ue(o,d){rt.call(this),this.D=o,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(ue,rt),t=ue.prototype,t.open=function(o,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=d,this.readyState=1,gn(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(d.body=o),(this.D||l).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Le(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,gn(this)),this.g&&(this.readyState=3,gn(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ne(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ne(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var d=o.value?o.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!o.done}))&&(this.response=this.responseText+=d)}o.done?Le(this):gn(this),this.readyState==3&&Ne(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,Le(this))},t.Qa=function(o){this.g&&(this.response=o,Le(this))},t.ga=function(){this.g&&Le(this)};function Le(o){o.readyState=4,o.l=null,o.j=null,o.v=null,gn(o)}t.setRequestHeader=function(o,d){this.u.append(o,d)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=d.next();return o.join(`\r
`)};function gn(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(ue.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Ys(o){let d="";return j(o,function(f,x){d+=x,d+=":",d+=f,d+=`\r
`}),d}function ms(o,d,f){e:{for(x in f){var x=!1;break e}x=!0}x||(f=Ys(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):B(o,d,f))}function Ye(o){rt.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(Ye,rt);var Zv=/^https?$/i,ex=["POST","PUT"];t=Ye.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,d,f,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);d=d?d.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():$s.g(),this.v=this.o?ke(this.o):ke($s),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(d,String(o),!0),this.B=!1}catch(F){Af(this,F);return}if(o=f||"",f=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var N in x)f.set(N,x[N]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const F of x.keys())f.set(F,x.get(F));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(f.keys()).find(F=>F.toLowerCase()=="content-type"),N=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(ex,d,void 0))||x||N||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,J]of f)this.g.setRequestHeader(F,J);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Pf(this),this.u=!0,this.g.send(o),this.u=!1}catch(F){Af(this,F)}};function Af(o,d){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=d,o.m=5,kf(o),Da(o)}function kf(o){o.A||(o.A=!0,gt(o,"complete"),gt(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,gt(this,"complete"),gt(this,"abort"),Da(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Da(this,!0)),Ye.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Rf(this):this.bb())},t.bb=function(){Rf(this)};function Rf(o){if(o.h&&typeof a<"u"&&(!o.v[1]||ir(o)!=4||o.Z()!=2)){if(o.u&&ir(o)==4)Tr(o.Ea,0,o);else if(gt(o,"readystatechange"),ir(o)==4){o.h=!1;try{const J=o.Z();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var x;if(x=J===0){var N=String(o.D).match(Hn)[1]||null;!N&&l.self&&l.self.location&&(N=l.self.location.protocol.slice(0,-1)),x=!Zv.test(N?N.toLowerCase():"")}f=x}if(f)gt(o,"complete"),gt(o,"success");else{o.m=6;try{var F=2<ir(o)?o.g.statusText:""}catch{F=""}o.l=F+" ["+o.Z()+"]",kf(o)}}finally{Da(o)}}}}function Da(o,d){if(o.g){Pf(o);const f=o.g,x=o.v[0]?()=>{}:null;o.g=null,o.v=null,d||gt(o,"ready");try{f.onreadystatechange=x}catch{}}}function Pf(o){o.I&&(l.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function ir(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<ir(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var d=this.g.responseText;return o&&d.indexOf(o)==0&&(d=d.substring(o.length)),Gi(d)}};function bf(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function tx(o){const d={};o=(o.g&&2<=ir(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<o.length;x++){if(w(o[x]))continue;var f=v(o[x]);const N=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const F=d[N]||[];d[N]=F,F.push(f)}E(d,function(x){return x.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function oo(o,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||d}function Df(o){this.Aa=0,this.i=[],this.j=new fn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=oo("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=oo("baseRetryDelayMs",5e3,o),this.cb=oo("retryDelaySeedMs",1e4,o),this.Wa=oo("forwardChannelMaxRetries",2,o),this.wa=oo("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new hs(o&&o.concurrentRequestLimit),this.Da=new Cf,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Df.prototype,t.la=8,t.G=1,t.connect=function(o,d,f,x){mt(0),this.W=o,this.H=d||{},f&&x!==void 0&&(this.H.OSID=f,this.H.OAID=x),this.F=this.X,this.I=Bf(this,null,this.W),Na(this)};function Ou(o){if(jf(o),o.G==3){var d=o.U++,f=An(o.I);if(B(f,"SID",o.K),B(f,"RID",d),B(f,"TYPE","terminate"),ao(o,f),d=new Gt(o,o.j,d),d.L=2,d.v=X(An(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=d.v,f=!0),f||(d.g=Uf(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Hs(d)}zf(o)}function ja(o){o.g&&(Bu(o),o.g.cancel(),o.g=null)}function jf(o){ja(o),o.u&&(l.clearTimeout(o.u),o.u=null),Ma(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function Na(o){if(!Ji(o.h)&&!o.s){o.s=!0;var d=o.Ga;U||L(),b||(U(),b=!0),D.add(d,o),o.B=0}}function nx(o,d){return Zi(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=d.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=In(y(o.Ga,o,d),Of(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const N=new Gt(this,this.j,o);let F=this.o;if(this.S&&(F?(F=g(F),I(F,this.S)):F=this.S),this.m!==null||this.O||(N.H=F,F=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var x=this.i[f];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(d+=x,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=Mf(this,N,d),f=An(this.I),B(f,"RID",o),B(f,"CVER",22),this.D&&B(f,"X-HTTP-Session-Id",this.D),ao(this,f),F&&(this.O?d="headers="+encodeURIComponent(String(Ys(F)))+"&"+d:this.m&&ms(f,this.m,F)),to(this.h,N),this.Ua&&B(f,"TYPE","init"),this.P?(B(f,"$req",d),B(f,"SID","null"),N.T=!0,ds(N,f,null)):ds(N,f,d),this.G=2}}else this.G==3&&(o?Nf(this,o):this.i.length==0||Ji(this.h)||Nf(this))};function Nf(o,d){var f;d?f=d.l:f=o.U++;const x=An(o.I);B(x,"SID",o.K),B(x,"RID",f),B(x,"AID",o.T),ao(o,x),o.m&&o.o&&ms(x,o.m,o.o),f=new Gt(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),d&&(o.i=d.D.concat(o.i)),d=Mf(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),to(o.h,f),ds(f,x,d)}function ao(o,d){o.H&&j(o.H,function(f,x){B(d,x,f)}),o.l&&no({},function(f,x){B(d,x,f)})}function Mf(o,d,f){f=Math.min(o.i.length,f);var x=o.l?y(o.l.Na,o.l,o):null;e:{var N=o.i;let F=-1;for(;;){const J=["count="+f];F==-1?0<f?(F=N[0].g,J.push("ofs="+F)):F=0:J.push("ofs="+F);let Me=!0;for(let yt=0;yt<f;yt++){let Re=N[yt].g;const kt=N[yt].map;if(Re-=F,0>Re)F=Math.max(0,N[yt].g-100),Me=!1;else try{ba(kt,J,"req"+Re+"_")}catch{x&&x(kt)}}if(Me){x=J.join("&");break e}}}return o=o.i.splice(0,f),d.D=o,x}function Vf(o){if(!o.g&&!o.u){o.Y=1;var d=o.Fa;U||L(),b||(U(),b=!0),D.add(d,o),o.v=0}}function zu(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=In(y(o.Fa,o),Of(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,Lf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=In(y(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,mt(10),ja(this),Lf(this))};function Bu(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function Lf(o){o.g=new Gt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var d=An(o.qa);B(d,"RID","rpc"),B(d,"SID",o.K),B(d,"AID",o.T),B(d,"CI",o.F?"0":"1"),!o.F&&o.ja&&B(d,"TO",o.ja),B(d,"TYPE","xmlhttp"),ao(o,d),o.m&&o.o&&ms(d,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=X(An(d)),f.m=null,f.P=!0,kr(f,o)}t.Za=function(){this.C!=null&&(this.C=null,ja(this),zu(this),mt(19))};function Ma(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function Ff(o,d){var f=null;if(o.g==d){Ma(o),Bu(o),o.g=null;var x=2}else if(eo(o.h,d))f=d.D,Gs(o.h,d),x=1;else return;if(o.G!=0){if(d.o)if(x==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var N=o.B;x=Ir(),gt(x,new hn(x,f)),Na(o)}else Vf(o);else if(N=d.s,N==3||N==0&&0<d.X||!(x==1&&nx(o,d)||x==2&&zu(o)))switch(f&&0<f.length&&(d=o.h,d.i=d.i.concat(f)),N){case 1:ys(o,5);break;case 4:ys(o,10);break;case 3:ys(o,6);break;default:ys(o,2)}}}function Of(o,d){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*d}function ys(o,d){if(o.j.info("Error code "+d),d==2){var f=y(o.fb,o),x=o.Xa;const N=!x;x=new pn(x||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||fs(x,"https"),X(x),N?Fu(x.toString(),f):io(x.toString(),f)}else mt(2);o.G=0,o.l&&o.l.sa(d),zf(o),jf(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),mt(2)):(this.j.info("Failed to ping google.com"),mt(1))};function zf(o){if(o.G=0,o.ka=[],o.l){const d=Wn(o.h);(d.length!=0||o.i.length!=0)&&(z(o.ka,d),z(o.ka,o.i),o.h.i.length=0,P(o.i),o.i.length=0),o.l.ra()}}function Bf(o,d,f){var x=f instanceof pn?An(f):new pn(f);if(x.g!="")d&&(x.g=d+"."+x.g),Q(x,x.s);else{var N=l.location;x=N.protocol,d=d?d+"."+N.hostname:N.hostname,N=+N.port;var F=new pn(null);x&&fs(F,x),d&&(F.g=d),N&&Q(F,N),f&&(F.l=f),x=F}return f=o.D,d=o.ya,f&&d&&B(x,f,d),B(x,"VER",o.la),ao(o,x),x}function Uf(o,d,f){if(d&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=o.Ca&&!o.pa?new Ye(new gs({eb:f})):new Ye(o.pa),d.Ha(o.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function $f(){}t=$f.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Va(){}Va.prototype.g=function(o,d){return new rn(o,d)};function rn(o,d){rt.call(this),this.g=new Df(d),this.l=o,this.h=d&&d.messageUrlParams||null,o=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(o?o["X-WebChannel-Content-Type"]=d.messageContentType:o={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(o?o["X-WebChannel-Client-Profile"]=d.va:o={"X-WebChannel-Client-Profile":d.va}),this.g.S=o,(o=d&&d.Sb)&&!w(o)&&(this.g.m=o),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!w(d)&&(this.g.D=d,o=this.h,o!==null&&d in o&&(o=this.h,d in o&&delete o[d])),this.j=new Xs(this)}k(rn,rt),rn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},rn.prototype.close=function(){Ou(this.g)},rn.prototype.o=function(o){var d=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=tr(o),o=f);d.i.push(new Lu(d.Ya++,o)),d.G==3&&Na(d)},rn.prototype.N=function(){this.g.l=null,delete this.j,Ou(this.g),delete this.g,rn.aa.N.call(this)};function Wf(o){us.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var d=o.__sm__;if(d){e:{for(const f in d){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,d=d!==null&&o in d?d[o]:void 0),this.data=d}else this.data=o}k(Wf,us);function Hf(){Ca.call(this),this.status=1}k(Hf,Ca);function Xs(o){this.g=o}k(Xs,$f),Xs.prototype.ua=function(){gt(this.g,"a")},Xs.prototype.ta=function(o){gt(this.g,new Wf(o))},Xs.prototype.sa=function(o){gt(this.g,new Hf)},Xs.prototype.ra=function(){gt(this.g,"b")},Va.prototype.createWebChannel=Va.prototype.g,rn.prototype.send=rn.prototype.o,rn.prototype.open=rn.prototype.m,rn.prototype.close=rn.prototype.close,D0=function(){return new Va},b0=function(){return Ir()},P0=En,Td={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},cs.NO_ERROR=0,cs.TIMEOUT=8,cs.HTTP_ERROR=6,yl=cs,Us.COMPLETE="complete",R0=Us,Sn.EventType=Un,Un.OPEN="a",Un.CLOSE="b",Un.ERROR="c",Un.MESSAGE="d",rt.prototype.listen=rt.prototype.K,So=Sn,Ye.prototype.listenOnce=Ye.prototype.L,Ye.prototype.getLastError=Ye.prototype.Ka,Ye.prototype.getLastErrorCode=Ye.prototype.Ba,Ye.prototype.getStatus=Ye.prototype.Z,Ye.prototype.getResponseJson=Ye.prototype.Oa,Ye.prototype.getResponseText=Ye.prototype.oa,Ye.prototype.send=Ye.prototype.ea,Ye.prototype.setWithCredentials=Ye.prototype.Ha,k0=Ye}).apply(typeof tl<"u"?tl:typeof self<"u"?self:typeof window<"u"?window:{});const hg="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qt.UNAUTHENTICATED=new Qt(null),Qt.GOOGLE_CREDENTIALS=new Qt("google-credentials-uid"),Qt.FIRST_PARTY=new Qt("first-party-uid"),Qt.MOCK_USER=new Qt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bi="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js=new _0("@firebase/firestore");function yo(){return js.logLevel}function se(t,...e){if(js.logLevel<=Ie.DEBUG){const n=e.map(Bh);js.debug(`Firestore (${Bi}): ${t}`,...n)}}function xr(t,...e){if(js.logLevel<=Ie.ERROR){const n=e.map(Bh);js.error(`Firestore (${Bi}): ${t}`,...n)}}function sa(t,...e){if(js.logLevel<=Ie.WARN){const n=e.map(Bh);js.warn(`Firestore (${Bi}): ${t}`,...n)}}function Bh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function de(t="Unexpected state"){const e=`FIRESTORE (${Bi}) INTERNAL ASSERTION FAILED: `+t;throw xr(e),new Error(e)}function je(t,e){t||de()}function pe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends zi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Qt.UNAUTHENTICATED))}shutdown(){}}class aS{constructor(e){this.t=e,this.currentUser=Qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){je(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new fr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new fr,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(se("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new fr)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(je(typeof r.accessToken=="string"),new iS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return je(e===null||typeof e=="string"),new Qt(e)}}class lS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Qt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class uS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new lS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Qt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){je(this.o===void 0);const r=i=>{i.error!=null&&se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,se("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(je(typeof n.token=="string"),this.R=n.token,new cS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=hS(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Pe(t,e){return t<e?-1:t>e?1:0}function bi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new te(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new te(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new te(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ct.fromMillis(Date.now())}static fromDate(e){return ct.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new ct(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Pe(this.nanoseconds,e.nanoseconds):Pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new fe(e)}static min(){return new fe(new ct(0,0))}static max(){return new fe(new ct(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,n,r){n===void 0?n=0:n>e.length&&de(),r===void 0?r=e.length-n:r>e.length-n&&de(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ia.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ia?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ze extends ia{construct(e,n,r){return new ze(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new te(H.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ze(n)}static emptyPath(){return new ze([])}}const fS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wt extends ia{construct(e,n,r){return new wt(e,n,r)}static isValidIdentifier(e){return fS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new wt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new te(H.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new te(H.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new te(H.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new te(H.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wt(n)}static emptyPath(){return new wt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.path=e}static fromPath(e){return new le(ze.fromString(e))}static fromName(e){return new le(ze.fromString(e).popFirst(5))}static empty(){return new le(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ze.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new le(new ze(e.slice()))}}function pS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=fe.fromTimestamp(r===1e9?new ct(n+1,0):new ct(n,r));return new Xr(s,le.empty(),e)}function gS(t){return new Xr(t.readTime,t.key,-1)}class Xr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Xr(fe.min(),le.empty(),-1)}static max(){return new Xr(fe.max(),le.empty(),-1)}}function mS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=le.comparator(t.documentKey,e.documentKey),n!==0?n:Pe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ya(t){if(t.code!==H.FAILED_PRECONDITION||t.message!==yS)throw t;se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&de(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new G((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof G?n:G.resolve(n)}catch(n){return G.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):G.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):G.reject(n)}static resolve(e){return new G((n,r)=>{n(e)})}static reject(e){return new G((n,r)=>{r(e)})}static waitFor(e){return new G((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},c=>r(c))}),a=!0,i===s&&n()})}static or(e){let n=G.resolve(!1);for(const r of e)n=n.next(s=>s?G.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new G((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let c=0;c<i;c++){const h=c;n(e[h]).next(p=>{a[h]=p,++l,l===i&&r(a)},p=>s(p))}})}static doWhile(e,n){return new G((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function xS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function va(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Uh.oe=-1;function _u(t){return t==null}function Kl(t){return t===0&&1/t==-1/0}function _S(t){return typeof t=="number"&&Number.isInteger(t)&&!Kl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Fs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function N0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e,n){this.comparator=e,this.root=n||_t.EMPTY}insert(e,n){return new Ge(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_t.BLACK,null,null))}remove(e){return new Ge(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_t.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nl(this.root,e,this.comparator,!1)}getReverseIterator(){return new nl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nl(this.root,e,this.comparator,!0)}}class nl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _t{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??_t.RED,this.left=s??_t.EMPTY,this.right=i??_t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new _t(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return _t.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw de();const e=this.left.check();if(e!==this.right.check())throw de();return e+(this.isRed()?0:1)}}_t.EMPTY=null,_t.RED=!0,_t.BLACK=!1;_t.EMPTY=new class{constructor(){this.size=0}get key(){throw de()}get value(){throw de()}get color(){throw de()}get left(){throw de()}get right(){throw de()}copy(e,n,r,s,i){return this}insert(e,n,r){return new _t(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.comparator=e,this.data=new Ge(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new pg(this.data.getIterator())}getIteratorFrom(e){return new pg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Et)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Et(this.comparator);return n.data=e,n}}class pg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.fields=e,e.sort(wt.comparator)}static empty(){return new an([])}unionWith(e){let n=new Et(wt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new an(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return bi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new M0("Invalid base64 string: "+i):i}}(e);return new It(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new It(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}It.EMPTY_BYTE_STRING=new It("");const wS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Jr(t){if(je(!!t),typeof t=="string"){let e=0;const n=wS.exec(t);if(je(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:et(t.seconds),nanos:et(t.nanos)}}function et(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ns(t){return typeof t=="string"?It.fromBase64String(t):It.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Wh(t){const e=t.mapValue.fields.__previous_value__;return $h(e)?Wh(e):e}function oa(t){const e=Jr(t.mapValue.fields.__local_write_time__.timestampValue);return new ct(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,n,r,s,i,a,l,c,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=h}}class aa{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new aa("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof aa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rl={mapValue:{}};function Ms(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?$h(t)?4:TS(t)?9007199254740991:ES(t)?10:11:de()}function Zn(t,e){if(t===e)return!0;const n=Ms(t);if(n!==Ms(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return oa(t).isEqual(oa(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Jr(s.timestampValue),l=Jr(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Ns(s.bytesValue).isEqual(Ns(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return et(s.geoPointValue.latitude)===et(i.geoPointValue.latitude)&&et(s.geoPointValue.longitude)===et(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return et(s.integerValue)===et(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=et(s.doubleValue),l=et(i.doubleValue);return a===l?Kl(a)===Kl(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return bi(t.arrayValue.values||[],e.arrayValue.values||[],Zn);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(fg(a)!==fg(l))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(l[c]===void 0||!Zn(a[c],l[c])))return!1;return!0}(t,e);default:return de()}}function la(t,e){return(t.values||[]).find(n=>Zn(n,e))!==void 0}function Di(t,e){if(t===e)return 0;const n=Ms(t),r=Ms(e);if(n!==r)return Pe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Pe(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=et(i.integerValue||i.doubleValue),c=et(a.integerValue||a.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return gg(t.timestampValue,e.timestampValue);case 4:return gg(oa(t),oa(e));case 5:return Pe(t.stringValue,e.stringValue);case 6:return function(i,a){const l=Ns(i),c=Ns(a);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),c=a.split("/");for(let h=0;h<l.length&&h<c.length;h++){const p=Pe(l[h],c[h]);if(p!==0)return p}return Pe(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=Pe(et(i.latitude),et(a.latitude));return l!==0?l:Pe(et(i.longitude),et(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return mg(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,c,h,p;const m=i.fields||{},y=a.fields||{},C=(l=m.value)===null||l===void 0?void 0:l.arrayValue,k=(c=y.value)===null||c===void 0?void 0:c.arrayValue,P=Pe(((h=C==null?void 0:C.values)===null||h===void 0?void 0:h.length)||0,((p=k==null?void 0:k.values)===null||p===void 0?void 0:p.length)||0);return P!==0?P:mg(C,k)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===rl.mapValue&&a===rl.mapValue)return 0;if(i===rl.mapValue)return 1;if(a===rl.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),h=a.fields||{},p=Object.keys(h);c.sort(),p.sort();for(let m=0;m<c.length&&m<p.length;++m){const y=Pe(c[m],p[m]);if(y!==0)return y;const C=Di(l[c[m]],h[p[m]]);if(C!==0)return C}return Pe(c.length,p.length)}(t.mapValue,e.mapValue);default:throw de()}}function gg(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Pe(t,e);const n=Jr(t),r=Jr(e),s=Pe(n.seconds,r.seconds);return s!==0?s:Pe(n.nanos,r.nanos)}function mg(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Di(n[s],r[s]);if(i)return i}return Pe(n.length,r.length)}function ji(t){return Id(t)}function Id(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Jr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ns(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return le.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Id(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Id(n.fields[a])}`;return s+"}"}(t.mapValue):de()}function yg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Cd(t){return!!t&&"integerValue"in t}function Hh(t){return!!t&&"arrayValue"in t}function vg(t){return!!t&&"nullValue"in t}function xg(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function vl(t){return!!t&&"mapValue"in t}function ES(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Mo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Fs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Mo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Mo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function TS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.value=e}static empty(){return new Yt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!vl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Mo(n)}setAll(e){let n=wt.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=Mo(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());vl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Zn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];vl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Fs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Yt(Mo(this.value))}}function V0(t){const e=[];return Fs(t.fields,(n,r)=>{const s=new wt([n]);if(vl(r)){const i=V0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new an(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Nt(e,0,fe.min(),fe.min(),fe.min(),Yt.empty(),0)}static newFoundDocument(e,n,r,s){return new Nt(e,1,n,fe.min(),r,s,0)}static newNoDocument(e,n){return new Nt(e,2,n,fe.min(),fe.min(),Yt.empty(),0)}static newUnknownDocument(e,n){return new Nt(e,3,n,fe.min(),fe.min(),Yt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Yt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Yt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Nt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,n){this.position=e,this.inclusive=n}}function _g(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=le.comparator(le.fromName(a.referenceValue),n.key):r=Di(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function wg(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Zn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e,n="asc"){this.field=e,this.dir=n}}function IS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{}class ot extends L0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new AS(e,n,r):n==="array-contains"?new PS(e,r):n==="in"?new bS(e,r):n==="not-in"?new DS(e,r):n==="array-contains-any"?new jS(e,r):new ot(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new kS(e,r):new RS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Di(n,this.value)):n!==null&&Ms(this.value)===Ms(n)&&this.matchesComparison(Di(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return de()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class On extends L0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new On(e,n)}matches(e){return F0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function F0(t){return t.op==="and"}function O0(t){return CS(t)&&F0(t)}function CS(t){for(const e of t.filters)if(e instanceof On)return!1;return!0}function Ad(t){if(t instanceof ot)return t.field.canonicalString()+t.op.toString()+ji(t.value);if(O0(t))return t.filters.map(e=>Ad(e)).join(",");{const e=t.filters.map(n=>Ad(n)).join(",");return`${t.op}(${e})`}}function z0(t,e){return t instanceof ot?function(r,s){return s instanceof ot&&r.op===s.op&&r.field.isEqual(s.field)&&Zn(r.value,s.value)}(t,e):t instanceof On?function(r,s){return s instanceof On&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&z0(a,s.filters[l]),!0):!1}(t,e):void de()}function B0(t){return t instanceof ot?function(n){return`${n.field.canonicalString()} ${n.op} ${ji(n.value)}`}(t):t instanceof On?function(n){return n.op.toString()+" {"+n.getFilters().map(B0).join(" ,")+"}"}(t):"Filter"}class AS extends ot{constructor(e,n,r){super(e,n,r),this.key=le.fromName(r.referenceValue)}matches(e){const n=le.comparator(e.key,this.key);return this.matchesComparison(n)}}class kS extends ot{constructor(e,n){super(e,"in",n),this.keys=U0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class RS extends ot{constructor(e,n){super(e,"not-in",n),this.keys=U0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function U0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>le.fromName(r.referenceValue))}class PS extends ot{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Hh(n)&&la(n.arrayValue,this.value)}}class bS extends ot{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&la(this.value.arrayValue,n)}}class DS extends ot{constructor(e,n){super(e,"not-in",n)}matches(e){if(la(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!la(this.value.arrayValue,n)}}class jS extends ot{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Hh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>la(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function Sg(t,e=null,n=[],r=[],s=null,i=null,a=null){return new NS(t,e,n,r,s,i,a)}function qh(t){const e=pe(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Ad(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),_u(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ji(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ji(r)).join(",")),e.ue=n}return e.ue}function Gh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!IS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!z0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!wg(t.startAt,e.startAt)&&wg(t.endAt,e.endAt)}function kd(t){return le.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function MS(t,e,n,r,s,i,a,l){return new xa(t,e,n,r,s,i,a,l)}function Qh(t){return new xa(t)}function Eg(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function $0(t){return t.collectionGroup!==null}function Vo(t){const e=pe(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Et(wt.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Xl(i,r))}),n.has(wt.keyField().canonicalString())||e.ce.push(new Xl(wt.keyField(),r))}return e.ce}function Xn(t){const e=pe(t);return e.le||(e.le=VS(e,Vo(t))),e.le}function VS(t,e){if(t.limitType==="F")return Sg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Xl(s.field,i)});const n=t.endAt?new Yl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Yl(t.startAt.position,t.startAt.inclusive):null;return Sg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Rd(t,e){const n=t.filters.concat([e]);return new xa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Pd(t,e,n){return new xa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function wu(t,e){return Gh(Xn(t),Xn(e))&&t.limitType===e.limitType}function W0(t){return`${qh(Xn(t))}|lt:${t.limitType}`}function ei(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>B0(s)).join(", ")}]`),_u(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ji(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ji(s)).join(",")),`Target(${r})`}(Xn(t))}; limitType=${t.limitType})`}function Su(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):le.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Vo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,c){const h=_g(a,l,c);return a.inclusive?h<=0:h<0}(r.startAt,Vo(r),s)||r.endAt&&!function(a,l,c){const h=_g(a,l,c);return a.inclusive?h>=0:h>0}(r.endAt,Vo(r),s))}(t,e)}function LS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function H0(t){return(e,n)=>{let r=!1;for(const s of Vo(t)){const i=FS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function FS(t,e,n){const r=t.field.isKeyField()?le.comparator(e.key,n.key):function(i,a,l){const c=a.data.field(i),h=l.data.field(i);return c!==null&&h!==null?Di(c,h):de()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return de()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Fs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return N0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=new Ge(le.comparator);function _r(){return OS}const q0=new Ge(le.comparator);function Eo(...t){let e=q0;for(const n of t)e=e.insert(n.key,n);return e}function G0(t){let e=q0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ts(){return Lo()}function Q0(){return Lo()}function Lo(){return new Ui(t=>t.toString(),(t,e)=>t.isEqual(e))}const zS=new Ge(le.comparator),BS=new Et(le.comparator);function _e(...t){let e=BS;for(const n of t)e=e.add(n);return e}const US=new Et(Pe);function $S(){return US}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Kl(e)?"-0":e}}function K0(t){return{integerValue:""+t}}function WS(t,e){return _S(e)?K0(e):Kh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(){this._=void 0}}function HS(t,e,n){return t instanceof ua?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&$h(i)&&(i=Wh(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof ca?X0(t,e):t instanceof da?J0(t,e):function(s,i){const a=Y0(s,i),l=Tg(a)+Tg(s.Pe);return Cd(a)&&Cd(s.Pe)?K0(l):Kh(s.serializer,l)}(t,e)}function qS(t,e,n){return t instanceof ca?X0(t,e):t instanceof da?J0(t,e):n}function Y0(t,e){return t instanceof Jl?function(r){return Cd(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ua extends Eu{}class ca extends Eu{constructor(e){super(),this.elements=e}}function X0(t,e){const n=Z0(e);for(const r of t.elements)n.some(s=>Zn(s,r))||n.push(r);return{arrayValue:{values:n}}}class da extends Eu{constructor(e){super(),this.elements=e}}function J0(t,e){let n=Z0(e);for(const r of t.elements)n=n.filter(s=>!Zn(s,r));return{arrayValue:{values:n}}}class Jl extends Eu{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Tg(t){return et(t.integerValue||t.doubleValue)}function Z0(t){return Hh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,n){this.field=e,this.transform=n}}function QS(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof ca&&s instanceof ca||r instanceof da&&s instanceof da?bi(r.elements,s.elements,Zn):r instanceof Jl&&s instanceof Jl?Zn(r.Pe,s.Pe):r instanceof ua&&s instanceof ua}(t.transform,e.transform)}class KS{constructor(e,n){this.version=e,this.transformResults=n}}class Vn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Vn}static exists(e){return new Vn(void 0,e)}static updateTime(e){return new Vn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Tu{}function ev(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new nv(t.key,Vn.none()):new _a(t.key,t.data,Vn.none());{const n=t.data,r=Yt.empty();let s=new Et(wt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new rs(t.key,r,new an(s.toArray()),Vn.none())}}function YS(t,e,n){t instanceof _a?function(s,i,a){const l=s.value.clone(),c=Cg(s.fieldTransforms,i,a.transformResults);l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof rs?function(s,i,a){if(!xl(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=Cg(s.fieldTransforms,i,a.transformResults),c=i.data;c.setAll(tv(s)),c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Fo(t,e,n,r){return t instanceof _a?function(i,a,l,c){if(!xl(i.precondition,a))return l;const h=i.value.clone(),p=Ag(i.fieldTransforms,c,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof rs?function(i,a,l,c){if(!xl(i.precondition,a))return l;const h=Ag(i.fieldTransforms,c,a),p=a.data;return p.setAll(tv(i)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,a,l){return xl(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function XS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Y0(r.transform,s||null);i!=null&&(n===null&&(n=Yt.empty()),n.set(r.field,i))}return n||null}function Ig(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&bi(r,s,(i,a)=>QS(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class _a extends Tu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class rs extends Tu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function tv(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Cg(t,e,n){const r=new Map;je(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,qS(a,l,n[s]))}return r}function Ag(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,HS(i,a,e))}return r}class nv extends Tu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class JS extends Tu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&YS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Fo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Fo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Q0();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const c=ev(a,l);c!==null&&r.set(s.key,c),a.isValidDocument()||a.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),_e())}isEqual(e){return this.batchId===e.batchId&&bi(this.mutations,e.mutations,(n,r)=>Ig(n,r))&&bi(this.baseMutations,e.baseMutations,(n,r)=>Ig(n,r))}}class Yh{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){je(e.mutations.length===r.length);let s=function(){return zS}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Yh(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st,Ee;function nE(t){switch(t){default:return de();case H.CANCELLED:case H.UNKNOWN:case H.DEADLINE_EXCEEDED:case H.RESOURCE_EXHAUSTED:case H.INTERNAL:case H.UNAVAILABLE:case H.UNAUTHENTICATED:return!1;case H.INVALID_ARGUMENT:case H.NOT_FOUND:case H.ALREADY_EXISTS:case H.PERMISSION_DENIED:case H.FAILED_PRECONDITION:case H.ABORTED:case H.OUT_OF_RANGE:case H.UNIMPLEMENTED:case H.DATA_LOSS:return!0}}function rv(t){if(t===void 0)return xr("GRPC error has no .code"),H.UNKNOWN;switch(t){case st.OK:return H.OK;case st.CANCELLED:return H.CANCELLED;case st.UNKNOWN:return H.UNKNOWN;case st.DEADLINE_EXCEEDED:return H.DEADLINE_EXCEEDED;case st.RESOURCE_EXHAUSTED:return H.RESOURCE_EXHAUSTED;case st.INTERNAL:return H.INTERNAL;case st.UNAVAILABLE:return H.UNAVAILABLE;case st.UNAUTHENTICATED:return H.UNAUTHENTICATED;case st.INVALID_ARGUMENT:return H.INVALID_ARGUMENT;case st.NOT_FOUND:return H.NOT_FOUND;case st.ALREADY_EXISTS:return H.ALREADY_EXISTS;case st.PERMISSION_DENIED:return H.PERMISSION_DENIED;case st.FAILED_PRECONDITION:return H.FAILED_PRECONDITION;case st.ABORTED:return H.ABORTED;case st.OUT_OF_RANGE:return H.OUT_OF_RANGE;case st.UNIMPLEMENTED:return H.UNIMPLEMENTED;case st.DATA_LOSS:return H.DATA_LOSS;default:return de()}}(Ee=st||(st={}))[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE=new As([4294967295,4294967295],0);function kg(t){const e=rE().encode(t),n=new A0;return n.update(e),new Uint8Array(n.digest())}function Rg(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new As([n,r],0),new As([s,i],0)]}class Xh{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new To(`Invalid padding: ${n}`);if(r<0)throw new To(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new To(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new To(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=As.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(As.fromNumber(r)));return s.compare(sE)===1&&(s=new As([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=kg(e),[r,s]=Rg(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Xh(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=kg(e),[r,s]=Rg(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class To extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,wa.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Iu(fe.min(),s,new Ge(Pe),_r(),_e())}}class wa{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new wa(r,n,_e(),_e(),_e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class sv{constructor(e,n){this.targetId=e,this.me=n}}class iv{constructor(e,n,r=It.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Pg{constructor(){this.fe=0,this.ge=Dg(),this.pe=It.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=_e(),n=_e(),r=_e();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:de()}}),new wa(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Dg()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,je(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class iE{constructor(e){this.Le=e,this.Be=new Map,this.ke=_r(),this.qe=bg(),this.Qe=new Ge(Pe)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:de()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(kd(i))if(r===0){const a=new le(i.path);this.Ue(n,a,Nt.newNoDocument(a,fe.min()))}else je(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),c=l?this.Xe(l,e,a):1;if(c!==0){this.je(n);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=Ns(r).toUint8Array()}catch(c){if(c instanceof M0)return sa("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Xh(a,s,i)}catch(c){return sa(c instanceof To?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&kd(l.target)){const c=new le(l.target.path);this.ke.get(c)!==null||this.it(a,c)||this.Ue(a,c,Nt.newNoDocument(c,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=_e();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(c=>{const h=this.Je(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new Iu(e,n,this.Qe,this.ke,r);return this.ke=_r(),this.qe=bg(),this.Qe=new Ge(Pe),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Pg,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Et(Pe),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||se("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Pg),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function bg(){return new Ge(le.comparator)}function Dg(){return new Ge(le.comparator)}const oE={asc:"ASCENDING",desc:"DESCENDING"},aE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lE={and:"AND",or:"OR"};class uE{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function bd(t,e){return t.useProto3Json||_u(e)?e:{value:e}}function Zl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ov(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function cE(t,e){return Zl(t,e.toTimestamp())}function Jn(t){return je(!!t),fe.fromTimestamp(function(n){const r=Jr(n);return new ct(r.seconds,r.nanos)}(t))}function Jh(t,e){return Dd(t,e).canonicalString()}function Dd(t,e){const n=function(s){return new ze(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function av(t){const e=ze.fromString(t);return je(hv(e)),e}function jd(t,e){return Jh(t.databaseId,e.path)}function xc(t,e){const n=av(e);if(n.get(1)!==t.databaseId.projectId)throw new te(H.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new te(H.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new le(uv(n))}function lv(t,e){return Jh(t.databaseId,e)}function dE(t){const e=av(t);return e.length===4?ze.emptyPath():uv(e)}function Nd(t){return new ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function uv(t){return je(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function jg(t,e,n){return{name:jd(t,e),fields:n.value.mapValue.fields}}function hE(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:de()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,p){return h.useProto3Json?(je(p===void 0||typeof p=="string"),It.fromBase64String(p||"")):(je(p===void 0||p instanceof Buffer||p instanceof Uint8Array),It.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){const p=h.code===void 0?H.UNKNOWN:rv(h.code);return new te(p,h.message||"")}(a);n=new iv(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=xc(t,r.document.name),i=Jn(r.document.updateTime),a=r.document.createTime?Jn(r.document.createTime):fe.min(),l=new Yt({mapValue:{fields:r.document.fields}}),c=Nt.newFoundDocument(s,i,a,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new _l(h,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=xc(t,r.document),i=r.readTime?Jn(r.readTime):fe.min(),a=Nt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new _l([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=xc(t,r.document),i=r.removedTargetIds||[];n=new _l([],i,s,null)}else{if(!("filter"in e))return de();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new tE(s,i),l=r.targetId;n=new sv(l,a)}}return n}function fE(t,e){let n;if(e instanceof _a)n={update:jg(t,e.key,e.value)};else if(e instanceof nv)n={delete:jd(t,e.key)};else if(e instanceof rs)n={update:jg(t,e.key,e.data),updateMask:SE(e.fieldMask)};else{if(!(e instanceof JS))return de();n={verify:jd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof ua)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ca)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof da)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Jl)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw de()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:cE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:de()}(t,e.precondition)),n}function pE(t,e){return t&&t.length>0?(je(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?Jn(s.updateTime):Jn(i);return a.isEqual(fe.min())&&(a=Jn(i)),new KS(a,s.transformResults||[])}(n,e))):[]}function gE(t,e){return{documents:[lv(t,e.path)]}}function mE(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=lv(t,s);const i=function(h){if(h.length!==0)return dv(On.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(h){if(h.length!==0)return h.map(p=>function(y){return{field:ti(y.field),direction:xE(y.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=bd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function yE(t){let e=dE(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){je(r===1);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(m){const y=cv(m);return y instanceof On&&O0(y)?y.getFilters():[y]}(n.where));let a=[];n.orderBy&&(a=function(m){return m.map(y=>function(k){return new Xl(ni(k.field),function(z){switch(z){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(k.direction))}(y))}(n.orderBy));let l=null;n.limit&&(l=function(m){let y;return y=typeof m=="object"?m.value:m,_u(y)?null:y}(n.limit));let c=null;n.startAt&&(c=function(m){const y=!!m.before,C=m.values||[];return new Yl(C,y)}(n.startAt));let h=null;return n.endAt&&(h=function(m){const y=!m.before,C=m.values||[];return new Yl(C,y)}(n.endAt)),MS(e,s,a,i,l,"F",c,h)}function vE(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return de()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function cv(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ni(n.unaryFilter.field);return ot.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ni(n.unaryFilter.field);return ot.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ni(n.unaryFilter.field);return ot.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ni(n.unaryFilter.field);return ot.create(a,"!=",{nullValue:"NULL_VALUE"});default:return de()}}(t):t.fieldFilter!==void 0?function(n){return ot.create(ni(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return de()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return On.create(n.compositeFilter.filters.map(r=>cv(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return de()}}(n.compositeFilter.op))}(t):de()}function xE(t){return oE[t]}function _E(t){return aE[t]}function wE(t){return lE[t]}function ti(t){return{fieldPath:t.canonicalString()}}function ni(t){return wt.fromServerFormat(t.fieldPath)}function dv(t){return t instanceof ot?function(n){if(n.op==="=="){if(xg(n.value))return{unaryFilter:{field:ti(n.field),op:"IS_NAN"}};if(vg(n.value))return{unaryFilter:{field:ti(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(xg(n.value))return{unaryFilter:{field:ti(n.field),op:"IS_NOT_NAN"}};if(vg(n.value))return{unaryFilter:{field:ti(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ti(n.field),op:_E(n.op),value:n.value}}}(t):t instanceof On?function(n){const r=n.getFilters().map(s=>dv(s));return r.length===1?r[0]:{compositeFilter:{op:wE(n.op),filters:r}}}(t):de()}function SE(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function hv(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,n,r,s,i=fe.min(),a=fe.min(),l=It.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Vr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Vr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Vr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Vr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e){this.ct=e}}function TE(t){const e=yE({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Pd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(){this.un=new CE}addToCollectionParentIndex(e,n){return this.un.add(n),G.resolve()}getCollectionParents(e,n){return G.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return G.resolve()}deleteFieldIndex(e,n){return G.resolve()}deleteAllFieldIndexes(e){return G.resolve()}createTargetIndexes(e,n){return G.resolve()}getDocumentsMatchingTarget(e,n){return G.resolve(null)}getIndexType(e,n){return G.resolve(0)}getFieldIndexes(e,n){return G.resolve([])}getNextCollectionGroupToUpdate(e){return G.resolve(null)}getMinOffset(e,n){return G.resolve(Xr.min())}getMinOffsetFromCollectionGroup(e,n){return G.resolve(Xr.min())}updateCollectionGroup(e,n,r){return G.resolve()}updateIndexEntries(e,n){return G.resolve()}}class CE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Et(ze.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Et(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ni(0)}static kn(){return new Ni(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(){this.changes=new Ui(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Nt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?G.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Fo(r.mutation,s,an.empty(),ct.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,_e()).next(()=>r))}getLocalViewOfDocuments(e,n,r=_e()){const s=Ts();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=Eo();return i.forEach((l,c)=>{a=a.insert(l,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Ts();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,_e()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=_r();const a=Lo(),l=function(){return Lo()}();return n.forEach((c,h)=>{const p=r.get(h.key);s.has(h.key)&&(p===void 0||p.mutation instanceof rs)?i=i.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),Fo(p.mutation,h,p.mutation.getFieldMask(),ct.now())):a.set(h.key,an.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((h,p)=>a.set(h,p)),n.forEach((h,p)=>{var m;return l.set(h,new kE(p,(m=a.get(h))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Lo();let s=new Ge((a,l)=>a-l),i=_e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(c=>{const h=n.get(c);if(h===null)return;let p=r.get(c)||an.empty();p=l.applyToLocalView(h,p),r.set(c,p);const m=(s.get(l.batchId)||_e()).add(c);s=s.insert(l.batchId,m)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),h=c.key,p=c.value,m=Q0();p.forEach(y=>{if(!i.has(y)){const C=ev(n.get(y),r.get(y));C!==null&&m.set(y,C),i=i.add(y)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return G.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return le.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):$0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):G.resolve(Ts());let l=-1,c=i;return a.next(h=>G.forEach(h,(p,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(p)?G.resolve():this.remoteDocumentCache.getEntry(e,p).next(y=>{c=c.insert(p,y)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,c,h,_e())).next(p=>({batchId:l,changes:G0(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new le(n)).next(r=>{let s=Eo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=Eo();return this.indexManager.getCollectionParents(e,i).next(l=>G.forEach(l,c=>{const h=function(m,y){return new xa(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(p=>{p.forEach((m,y)=>{a=a.insert(m,y)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((c,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,Nt.newInvalidDocument(p)))});let l=Eo();return a.forEach((c,h)=>{const p=i.get(c);p!==void 0&&Fo(p.mutation,h,an.empty(),ct.now()),Su(n,h)&&(l=l.insert(c,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return G.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Jn(s.createTime)}}(n)),G.resolve()}getNamedQuery(e,n){return G.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:TE(s.bundledQuery),readTime:Jn(s.readTime)}}(n)),G.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(){this.overlays=new Ge(le.comparator),this.Ir=new Map}getOverlay(e,n){return G.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ts();return G.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),G.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),G.resolve()}getOverlaysForCollection(e,n,r){const s=Ts(),i=n.length+1,a=new le(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const c=l.getNext().value,h=c.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return G.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ge((h,p)=>h-p);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=i.get(h.largestBatchId);p===null&&(p=Ts(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=Ts(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=s)););return G.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new eE(n,r));let i=this.Ir.get(n);i===void 0&&(i=_e(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(){this.sessionToken=It.EMPTY_BYTE_STRING}getSessionToken(e){return G.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,G.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(){this.Tr=new Et(dt.Er),this.dr=new Et(dt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new dt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new dt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new le(new ze([])),r=new dt(n,e),s=new dt(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new le(new ze([])),r=new dt(n,e),s=new dt(n,e+1);let i=_e();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new dt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class dt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return le.comparator(e.key,n.key)||Pe(e.wr,n.wr)}static Ar(e,n){return Pe(e.wr,n.wr)||le.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Et(dt.Er)}checkEmpty(e){return G.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new ZS(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new dt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return G.resolve(a)}lookupMutationBatch(e,n){return G.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return G.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return G.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return G.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new dt(n,0),s=new dt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),G.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Et(Pe);return n.forEach(s=>{const i=new dt(s,0),a=new dt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),G.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;le.isDocumentKey(i)||(i=i.child(""));const a=new dt(new le(i),0);let l=new Et(Pe);return this.br.forEachWhile(c=>{const h=c.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(l=l.add(c.wr)),!0)},a),G.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){je(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return G.forEach(n.mutations,s=>{const i=new dt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new dt(n,0),s=this.br.firstAfterOrEqual(r);return G.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,G.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e){this.Mr=e,this.docs=function(){return new Ge(le.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return G.resolve(r?r.document.mutableCopy():Nt.newInvalidDocument(n))}getEntries(e,n){let r=_r();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Nt.newInvalidDocument(s))}),G.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=_r();const a=n.path,l=new le(a.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:h,value:{document:p}}=c.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||mS(gS(p),r)<=0||(s.has(p.key)||Su(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return G.resolve(i)}getAllFromCollectionGroup(e,n,r,s){de()}Or(e,n){return G.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new ME(this)}getSize(e){return G.resolve(this.size)}}class ME extends AE{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),G.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e){this.persistence=e,this.Nr=new Ui(n=>qh(n),Gh),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Zh,this.targetCount=0,this.kr=Ni.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),G.resolve()}getLastRemoteSnapshotVersion(e){return G.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return G.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),G.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),G.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Ni(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,G.resolve()}updateTargetData(e,n){return this.Kn(n),G.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,G.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),G.waitFor(i).next(()=>s)}getTargetCount(e){return G.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return G.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),G.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),G.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),G.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return G.resolve(r)}containsKey(e,n){return G.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Uh(0),this.Kr=!1,this.Kr=!0,this.$r=new DE,this.referenceDelegate=e(this),this.Ur=new VE(this),this.indexManager=new IE,this.remoteDocumentCache=function(s){return new NE(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new EE(n),this.Gr=new PE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new bE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new jE(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){se("MemoryPersistence","Starting transaction:",e);const s=new FE(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return G.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class FE extends vS{constructor(e){super(),this.currentSequenceNumber=e}}class ef{constructor(e){this.persistence=e,this.Jr=new Zh,this.Yr=null}static Zr(e){return new ef(e)}get Xr(){if(this.Yr)return this.Yr;throw de()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),G.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),G.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),G.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return G.forEach(this.Xr,r=>{const s=le.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,fe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return G.or([()=>G.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=_e(),s=_e();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new tf(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return U1()?8:xS(z1())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new OE;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(yo()<=Ie.DEBUG&&se("QueryEngine","SDK will not create cache indexes for query:",ei(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),G.resolve()):(yo()<=Ie.DEBUG&&se("QueryEngine","Query:",ei(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(yo()<=Ie.DEBUG&&se("QueryEngine","The SDK decides to create cache indexes for query:",ei(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Xn(n))):G.resolve())}Yi(e,n){if(Eg(n))return G.resolve(null);let r=Xn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Pd(n,null,"F"),r=Xn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=_e(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const h=this.ts(n,l);return this.ns(n,h,a,c.readTime)?this.Yi(e,Pd(n,null,"F")):this.rs(e,h,n,c)}))})))}Zi(e,n,r,s){return Eg(n)||s.isEqual(fe.min())?G.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?G.resolve(null):(yo()<=Ie.DEBUG&&se("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ei(n)),this.rs(e,a,n,pS(s,-1)).next(l=>l))})}ts(e,n){let r=new Et(H0(e));return n.forEach((s,i)=>{Su(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return yo()<=Ie.DEBUG&&se("QueryEngine","Using full collection scan to execute query:",ei(n)),this.Ji.getDocumentsMatchingQuery(e,n,Xr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new Ge(Pe),this._s=new Ui(i=>qh(i),Gh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function UE(t,e,n,r){return new BE(t,e,n,r)}async function fv(t,e){const n=pe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let c=_e();for(const h of s){a.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}for(const h of i){l.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}return n.localDocuments.getDocuments(r,c).next(h=>({hs:h,removedBatchIds:a,addedBatchIds:l}))})})}function $E(t,e){const n=pe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,h,p){const m=h.batch,y=m.keys();let C=G.resolve();return y.forEach(k=>{C=C.next(()=>p.getEntry(c,k)).next(P=>{const z=h.docVersions.get(k);je(z!==null),P.version.compareTo(z)<0&&(m.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),p.addEntry(P)))})}),C.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=_e();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(c=c.add(l.batch.mutations[h].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function pv(t){const e=pe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function WE(t,e){const n=pe(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((p,m)=>{const y=s.get(m);if(!y)return;l.push(n.Ur.removeMatchingKeys(i,p.removedDocuments,m).next(()=>n.Ur.addMatchingKeys(i,p.addedDocuments,m)));let C=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?C=C.withResumeToken(It.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):p.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(p.resumeToken,r)),s=s.insert(m,C),function(P,z,A){return P.resumeToken.approximateByteSize()===0||z.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(y,C,p)&&l.push(n.Ur.updateTargetData(i,C))});let c=_r(),h=_e();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),l.push(HE(i,a,e.documentUpdates).next(p=>{c=p.Ps,h=p.Is})),!r.isEqual(fe.min())){const p=n.Ur.getLastRemoteSnapshotVersion(i).next(m=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(p)}return G.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,h)).next(()=>c)}).then(i=>(n.os=s,i))}function HE(t,e,n){let r=_e(),s=_e();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=_r();return n.forEach((l,c)=>{const h=i.get(l);c.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(fe.min())?(e.removeEntry(l,c.readTime),a=a.insert(l,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),a=a.insert(l,c)):se("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",c.version)}),{Ps:a,Is:s}})}function qE(t,e){const n=pe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function GE(t,e){const n=pe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,G.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new Vr(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Md(t,e,n){const r=pe(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!va(a))throw a;se("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Ng(t,e,n){const r=pe(t);let s=fe.min(),i=_e();return r.persistence.runTransaction("Execute query","readwrite",a=>function(c,h,p){const m=pe(c),y=m._s.get(p);return y!==void 0?G.resolve(m.os.get(y)):m.Ur.getTargetData(h,p)}(r,a,Xn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:fe.min(),n?i:_e())).next(l=>(QE(r,LS(e),l),{documents:l,Ts:i})))}function QE(t,e,n){let r=t.us.get(e)||fe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Mg{constructor(){this.activeTargetIds=$S()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class KE{constructor(){this.so=new Mg,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Mg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){se("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){se("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sl=null;function _c(){return sl===null?sl=function(){return 268435456+Math.round(2147483648*Math.random())}():sl++,"0x"+sl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dt="WebChannelConnection";class ZE extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=_c(),c=this.xo(n,r.toUriEncodedString());se("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,a),this.No(n,c,h,s).then(p=>(se("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw sa("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",c,"request:",s),p})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Bi}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=XE[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=_c();return new Promise((a,l)=>{const c=new k0;c.setWithCredentials(!0),c.listenOnce(R0.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case yl.NO_ERROR:const p=c.getResponseJson();se(Dt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(p)),a(p);break;case yl.TIMEOUT:se(Dt,`RPC '${e}' ${i} timed out`),l(new te(H.DEADLINE_EXCEEDED,"Request time out"));break;case yl.HTTP_ERROR:const m=c.getStatus();if(se(Dt,`RPC '${e}' ${i} failed with status:`,m,"response text:",c.getResponseText()),m>0){let y=c.getResponseJson();Array.isArray(y)&&(y=y[0]);const C=y==null?void 0:y.error;if(C&&C.status&&C.message){const k=function(z){const A=z.toLowerCase().replace(/_/g,"-");return Object.values(H).indexOf(A)>=0?A:H.UNKNOWN}(C.status);l(new te(k,C.message))}else l(new te(H.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new te(H.UNAVAILABLE,"Connection failed."));break;default:de()}}finally{se(Dt,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);se(Dt,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=_c(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=D0(),l=b0(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const p=i.join("");se(Dt,`Creating RPC '${e}' stream ${s}: ${p}`,c);const m=a.createWebChannel(p,c);let y=!1,C=!1;const k=new JE({Io:z=>{C?se(Dt,`Not sending because RPC '${e}' stream ${s} is closed:`,z):(y||(se(Dt,`Opening RPC '${e}' stream ${s} transport.`),m.open(),y=!0),se(Dt,`RPC '${e}' stream ${s} sending:`,z),m.send(z))},To:()=>m.close()}),P=(z,A,w)=>{z.listen(A,T=>{try{w(T)}catch(V){setTimeout(()=>{throw V},0)}})};return P(m,So.EventType.OPEN,()=>{C||(se(Dt,`RPC '${e}' stream ${s} transport opened.`),k.yo())}),P(m,So.EventType.CLOSE,()=>{C||(C=!0,se(Dt,`RPC '${e}' stream ${s} transport closed`),k.So())}),P(m,So.EventType.ERROR,z=>{C||(C=!0,sa(Dt,`RPC '${e}' stream ${s} transport errored:`,z),k.So(new te(H.UNAVAILABLE,"The operation could not be completed")))}),P(m,So.EventType.MESSAGE,z=>{var A;if(!C){const w=z.data[0];je(!!w);const T=w,V=T.error||((A=T[0])===null||A===void 0?void 0:A.error);if(V){se(Dt,`RPC '${e}' stream ${s} received error:`,V);const $=V.status;let j=function(S){const I=st[S];if(I!==void 0)return rv(I)}($),E=V.message;j===void 0&&(j=H.INTERNAL,E="Unknown error status: "+$+" with message "+V.message),C=!0,k.So(new te(j,E)),m.close()}else se(Dt,`RPC '${e}' stream ${s} received:`,w),k.bo(w)}}),P(l,P0.STAT_EVENT,z=>{z.stat===Td.PROXY?se(Dt,`RPC '${e}' stream ${s} detected buffering proxy`):z.stat===Td.NOPROXY&&se(Dt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{k.wo()},0),k}}function wc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(t){return new uE(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&se("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e,n,r,s,i,a,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new gv(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===H.RESOURCE_EXHAUSTED?(xr(n.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===H.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new te(H.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return se("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(se("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class eT extends mv{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=hE(this.serializer,e),r=function(i){if(!("targetChange"in i))return fe.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?fe.min():a.readTime?Jn(a.readTime):fe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Nd(this.serializer),n.addTarget=function(i,a){let l;const c=a.target;if(l=kd(c)?{documents:gE(i,c)}:{query:mE(i,c)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=ov(i,a.resumeToken);const h=bd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(fe.min())>0){l.readTime=Zl(i,a.snapshotVersion.toTimestamp());const h=bd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=vE(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Nd(this.serializer),n.removeTarget=e,this.a_(n)}}class tT extends mv{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return je(!!e.streamToken),this.lastStreamToken=e.streamToken,je(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){je(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=pE(e.writeResults,e.commitTime),r=Jn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Nd(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>fE(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new te(H.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,Dd(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new te(H.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,Dd(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new te(H.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class rT{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(xr(n),this.D_=!1):se("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{Os(this)&&(se("RemoteStore","Restarting streams for network reachability change."),await async function(c){const h=pe(c);h.L_.add(4),await Sa(h),h.q_.set("Unknown"),h.L_.delete(4),await Au(h)}(this))})}),this.q_=new rT(r,s)}}async function Au(t){if(Os(t))for(const e of t.B_)await e(!0)}async function Sa(t){for(const e of t.B_)await e(!1)}function yv(t,e){const n=pe(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),of(n)?sf(n):$i(n).r_()&&rf(n,e))}function nf(t,e){const n=pe(t),r=$i(n);n.N_.delete(e),r.r_()&&vv(n,e),n.N_.size===0&&(r.r_()?r.o_():Os(n)&&n.q_.set("Unknown"))}function rf(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}$i(t).A_(e)}function vv(t,e){t.Q_.xe(e),$i(t).R_(e)}function sf(t){t.Q_=new iE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),$i(t).start(),t.q_.v_()}function of(t){return Os(t)&&!$i(t).n_()&&t.N_.size>0}function Os(t){return pe(t).L_.size===0}function xv(t){t.Q_=void 0}async function iT(t){t.q_.set("Online")}async function oT(t){t.N_.forEach((e,n)=>{rf(t,e)})}async function aT(t,e){xv(t),of(t)?(t.q_.M_(e),sf(t)):t.q_.set("Unknown")}async function lT(t,e,n){if(t.q_.set("Online"),e instanceof iv&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){se("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await eu(t,r)}else if(e instanceof _l?t.Q_.Ke(e):e instanceof sv?t.Q_.He(e):t.Q_.We(e),!n.isEqual(fe.min()))try{const r=await pv(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const p=i.N_.get(h);p&&i.N_.set(h,p.withResumeToken(c.resumeToken,a))}}),l.targetMismatches.forEach((c,h)=>{const p=i.N_.get(c);if(!p)return;i.N_.set(c,p.withResumeToken(It.EMPTY_BYTE_STRING,p.snapshotVersion)),vv(i,c);const m=new Vr(p.target,c,h,p.sequenceNumber);rf(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){se("RemoteStore","Failed to raise snapshot:",r),await eu(t,r)}}async function eu(t,e,n){if(!va(e))throw e;t.L_.add(1),await Sa(t),t.q_.set("Offline"),n||(n=()=>pv(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{se("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Au(t)})}function _v(t,e){return e().catch(n=>eu(t,n,e))}async function ku(t){const e=pe(t),n=Zr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;uT(e);)try{const s=await qE(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,cT(e,s)}catch(s){await eu(e,s)}wv(e)&&Sv(e)}function uT(t){return Os(t)&&t.O_.length<10}function cT(t,e){t.O_.push(e);const n=Zr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function wv(t){return Os(t)&&!Zr(t).n_()&&t.O_.length>0}function Sv(t){Zr(t).start()}async function dT(t){Zr(t).p_()}async function hT(t){const e=Zr(t);for(const n of t.O_)e.m_(n.mutations)}async function fT(t,e,n){const r=t.O_.shift(),s=Yh.from(r,e,n);await _v(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ku(t)}async function pT(t,e){e&&Zr(t).V_&&await async function(r,s){if(function(a){return nE(a)&&a!==H.ABORTED}(s.code)){const i=r.O_.shift();Zr(r).s_(),await _v(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ku(r)}}(t,e),wv(t)&&Sv(t)}async function Lg(t,e){const n=pe(t);n.asyncQueue.verifyOperationInProgress(),se("RemoteStore","RemoteStore received new credentials");const r=Os(n);n.L_.add(3),await Sa(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Au(n)}async function gT(t,e){const n=pe(t);e?(n.L_.delete(2),await Au(n)):e||(n.L_.add(2),await Sa(n),n.q_.set("Unknown"))}function $i(t){return t.K_||(t.K_=function(n,r,s){const i=pe(n);return i.w_(),new eT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:iT.bind(null,t),Ro:oT.bind(null,t),mo:aT.bind(null,t),d_:lT.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),of(t)?sf(t):t.q_.set("Unknown")):(await t.K_.stop(),xv(t))})),t.K_}function Zr(t){return t.U_||(t.U_=function(n,r,s){const i=pe(n);return i.w_(),new tT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:dT.bind(null,t),mo:pT.bind(null,t),f_:hT.bind(null,t),g_:fT.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await ku(t)):(await t.U_.stop(),t.O_.length>0&&(se("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new fr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new af(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(H.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function lf(t,e){if(xr("AsyncQueue",`${e}: ${t}`),va(t))return new te(H.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e){this.comparator=e?(n,r)=>e(n,r)||le.comparator(n.key,r.key):(n,r)=>le.comparator(n.key,r.key),this.keyedMap=Eo(),this.sortedSet=new Ge(this.comparator)}static emptySet(e){return new wi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof wi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new wi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(){this.W_=new Ge(le.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):de():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Mi{constructor(e,n,r,s,i,a,l,c,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new Mi(e,n,wi.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class yT{constructor(){this.queries=Og(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=pe(n),i=s.queries;s.queries=Og(),i.forEach((a,l)=>{for(const c of l.j_)c.onError(r)})})(this,new te(H.ABORTED,"Firestore shutting down"))}}function Og(){return new Ui(t=>W0(t),wu)}async function Ev(t,e){const n=pe(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new mT,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=lf(a,`Initialization of query '${ei(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&uf(n)}async function Tv(t,e){const n=pe(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function vT(t,e){const n=pe(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&uf(n)}function xT(t,e,n){const r=pe(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function uf(t){t.Y_.forEach(e=>{e.next()})}var Vd,zg;(zg=Vd||(Vd={})).ea="default",zg.Cache="cache";class Iv{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Mi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Mi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Vd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e){this.key=e}}class Av{constructor(e){this.key=e}}class _T{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=_e(),this.mutatedKeys=_e(),this.Aa=H0(e),this.Ra=new wi(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Fg,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,m)=>{const y=s.get(p),C=Su(this.query,m)?m:null,k=!!y&&this.mutatedKeys.has(y.key),P=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let z=!1;y&&C?y.data.isEqual(C.data)?k!==P&&(r.track({type:3,doc:C}),z=!0):this.ga(y,C)||(r.track({type:2,doc:C}),z=!0,(c&&this.Aa(C,c)>0||h&&this.Aa(C,h)<0)&&(l=!0)):!y&&C?(r.track({type:0,doc:C}),z=!0):y&&!C&&(r.track({type:1,doc:y}),z=!0,(c||h)&&(l=!0)),z&&(C?(a=a.add(C),i=P?i.add(p):i.delete(p)):(a=a.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((p,m)=>function(C,k){const P=z=>{switch(z){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return de()}};return P(C)-P(k)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,h=c!==this.Ea;return this.Ea=c,a.length!==0||h?{snapshot:new Mi(this.query,e.Ra,i,a,e.mutatedKeys,c===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Fg,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=_e(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Av(r))}),this.da.forEach(r=>{e.has(r)||n.push(new Cv(r))}),n}ba(e){this.Ta=e.Ts,this.da=_e();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Mi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class wT{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class ST{constructor(e){this.key=e,this.va=!1}}class ET{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Ui(l=>W0(l),wu),this.Ma=new Map,this.xa=new Set,this.Oa=new Ge(le.comparator),this.Na=new Map,this.La=new Zh,this.Ba={},this.ka=new Map,this.qa=Ni.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function TT(t,e,n=!0){const r=jv(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await kv(r,e,n,!0),s}async function IT(t,e){const n=jv(t);await kv(n,e,!0,!1)}async function kv(t,e,n,r){const s=await GE(t.localStore,Xn(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await CT(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&yv(t.remoteStore,s),l}async function CT(t,e,n,r,s){t.Ka=(m,y,C)=>async function(P,z,A,w){let T=z.view.ma(A);T.ns&&(T=await Ng(P.localStore,z.query,!1).then(({documents:E})=>z.view.ma(E,T)));const V=w&&w.targetChanges.get(z.targetId),$=w&&w.targetMismatches.get(z.targetId)!=null,j=z.view.applyChanges(T,P.isPrimaryClient,V,$);return Ug(P,z.targetId,j.wa),j.snapshot}(t,m,y,C);const i=await Ng(t.localStore,e,!0),a=new _T(e,i.Ts),l=a.ma(i.documents),c=wa.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=a.applyChanges(l,t.isPrimaryClient,c);Ug(t,n,h.wa);const p=new wT(e,n,a);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function AT(t,e,n){const r=pe(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!wu(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Md(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&nf(r.remoteStore,s.targetId),Ld(r,s.targetId)}).catch(ya)):(Ld(r,s.targetId),await Md(r.localStore,s.targetId,!0))}async function kT(t,e){const n=pe(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),nf(n.remoteStore,r.targetId))}async function RT(t,e,n){const r=VT(t);try{const s=await function(a,l){const c=pe(a),h=ct.now(),p=l.reduce((C,k)=>C.add(k.key),_e());let m,y;return c.persistence.runTransaction("Locally write mutations","readwrite",C=>{let k=_r(),P=_e();return c.cs.getEntries(C,p).next(z=>{k=z,k.forEach((A,w)=>{w.isValidDocument()||(P=P.add(A))})}).next(()=>c.localDocuments.getOverlayedDocuments(C,k)).next(z=>{m=z;const A=[];for(const w of l){const T=XS(w,m.get(w.key).overlayedDocument);T!=null&&A.push(new rs(w.key,T,V0(T.value.mapValue),Vn.exists(!0)))}return c.mutationQueue.addMutationBatch(C,h,A,l)}).next(z=>{y=z;const A=z.applyToLocalDocumentSet(m,P);return c.documentOverlayCache.saveOverlays(C,z.batchId,A)})}).then(()=>({batchId:y.batchId,changes:G0(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,c){let h=a.Ba[a.currentUser.toKey()];h||(h=new Ge(Pe)),h=h.insert(l,c),a.Ba[a.currentUser.toKey()]=h}(r,s.batchId,n),await Ea(r,s.changes),await ku(r.remoteStore)}catch(s){const i=lf(s,"Failed to persist write");n.reject(i)}}async function Rv(t,e){const n=pe(t);try{const r=await WE(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(je(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?je(a.va):s.removedDocuments.size>0&&(je(a.va),a.va=!1))}),await Ea(n,r,e)}catch(r){await ya(r)}}function Bg(t,e,n){const r=pe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const c=pe(a);c.onlineState=l;let h=!1;c.queries.forEach((p,m)=>{for(const y of m.j_)y.Z_(l)&&(h=!0)}),h&&uf(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function PT(t,e,n){const r=pe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new Ge(le.comparator);a=a.insert(i,Nt.newNoDocument(i,fe.min()));const l=_e().add(i),c=new Iu(fe.min(),new Map,new Ge(Pe),a,l);await Rv(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),cf(r)}else await Md(r.localStore,e,!1).then(()=>Ld(r,e,n)).catch(ya)}async function bT(t,e){const n=pe(t),r=e.batch.batchId;try{const s=await $E(n.localStore,e);bv(n,r,null),Pv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ea(n,s)}catch(s){await ya(s)}}async function DT(t,e,n){const r=pe(t);try{const s=await function(a,l){const c=pe(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return c.mutationQueue.lookupMutationBatch(h,l).next(m=>(je(m!==null),p=m.keys(),c.mutationQueue.removeMutationBatch(h,m))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>c.localDocuments.getDocuments(h,p))})}(r.localStore,e);bv(r,e,n),Pv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ea(r,s)}catch(s){await ya(s)}}function Pv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function bv(t,e,n){const r=pe(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Ld(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Dv(t,r)})}function Dv(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(nf(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),cf(t))}function Ug(t,e,n){for(const r of n)r instanceof Cv?(t.La.addReference(r.key,e),jT(t,r)):r instanceof Av?(se("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Dv(t,r.key)):de()}function jT(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(se("SyncEngine","New document in limbo: "+n),t.xa.add(r),cf(t))}function cf(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new le(ze.fromString(e)),r=t.qa.next();t.Na.set(r,new ST(n)),t.Oa=t.Oa.insert(n,r),yv(t.remoteStore,new Vr(Xn(Qh(n.path)),r,"TargetPurposeLimboResolution",Uh.oe))}}async function Ea(t,e,n){const r=pe(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{a.push(r.Ka(c,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const m=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(h){s.push(h);const m=tf.Wi(c.targetId,h);i.push(m)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(c,h){const p=pe(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>G.forEach(h,y=>G.forEach(y.$i,C=>p.persistence.referenceDelegate.addReference(m,y.targetId,C)).next(()=>G.forEach(y.Ui,C=>p.persistence.referenceDelegate.removeReference(m,y.targetId,C)))))}catch(m){if(!va(m))throw m;se("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const y=m.targetId;if(!m.fromCache){const C=p.os.get(y),k=C.snapshotVersion,P=C.withLastLimboFreeSnapshotVersion(k);p.os=p.os.insert(y,P)}}}(r.localStore,i))}async function NT(t,e){const n=pe(t);if(!n.currentUser.isEqual(e)){se("SyncEngine","User change. New user:",e.toKey());const r=await fv(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new te(H.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ea(n,r.hs)}}function MT(t,e){const n=pe(t),r=n.Na.get(e);if(r&&r.va)return _e().add(r.key);{let s=_e();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}function jv(t){const e=pe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=MT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=PT.bind(null,e),e.Ca.d_=vT.bind(null,e.eventManager),e.Ca.$a=xT.bind(null,e.eventManager),e}function VT(t){const e=pe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=bT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DT.bind(null,e),e}class tu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return UE(this.persistence,new zE,e.initialUser,this.serializer)}Ga(e){return new LE(ef.Zr,this.serializer)}Wa(e){return new KE}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}tu.provider={build:()=>new tu};class Fd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Bg(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=NT.bind(null,this.syncEngine),await gT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new yT}()}createDatastore(e){const n=Cu(e.databaseInfo.databaseId),r=function(i){return new ZE(i)}(e.databaseInfo);return function(i,a,l,c){return new nT(i,a,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new sT(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Bg(this.syncEngine,n,0),function(){return Vg.D()?new Vg:new YE}())}createSyncEngine(e,n){return function(s,i,a,l,c,h,p){const m=new ET(s,i,a,l,c,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=pe(s);se("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Sa(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Fd.provider={build:()=>new Fd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):xr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Qt.UNAUTHENTICATED,this.clientId=j0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{se("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(se("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=lf(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Sc(t,e){t.asyncQueue.verifyOperationInProgress(),se("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await fv(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function $g(t,e){t.asyncQueue.verifyOperationInProgress();const n=await FT(t);se("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Lg(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Lg(e.remoteStore,s)),t._onlineComponents=e}async function FT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){se("FirestoreClient","Using user provided OfflineComponentProvider");try{await Sc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===H.FAILED_PRECONDITION||s.code===H.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;sa("Error using user provided cache. Falling back to memory cache: "+n),await Sc(t,new tu)}}else se("FirestoreClient","Using default OfflineComponentProvider"),await Sc(t,new tu);return t._offlineComponents}async function Mv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(se("FirestoreClient","Using user provided OnlineComponentProvider"),await $g(t,t._uninitializedComponentsProvider._online)):(se("FirestoreClient","Using default OnlineComponentProvider"),await $g(t,new Fd))),t._onlineComponents}function OT(t){return Mv(t).then(e=>e.syncEngine)}async function Vv(t){const e=await Mv(t),n=e.eventManager;return n.onListen=TT.bind(null,e.syncEngine),n.onUnlisten=AT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=IT.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=kT.bind(null,e.syncEngine),n}function zT(t,e,n={}){const r=new fr;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,h){const p=new Nv({next:y=>{p.Za(),a.enqueueAndForget(()=>Tv(i,m));const C=y.docs.has(l);!C&&y.fromCache?h.reject(new te(H.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&y.fromCache&&c&&c.source==="server"?h.reject(new te(H.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(y)},error:y=>h.reject(y)}),m=new Iv(Qh(l.path),p,{includeMetadataChanges:!0,_a:!0});return Ev(i,m)}(await Vv(t),t.asyncQueue,e,n,r)),r.promise}function BT(t,e,n={}){const r=new fr;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,h){const p=new Nv({next:y=>{p.Za(),a.enqueueAndForget(()=>Tv(i,m)),y.fromCache&&c.source==="server"?h.reject(new te(H.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(y)},error:y=>h.reject(y)}),m=new Iv(l,p,{includeMetadataChanges:!0,_a:!0});return Ev(i,m)}(await Vv(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wg=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fv(t,e,n){if(!n)throw new te(H.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function UT(t,e,n,r){if(e===!0&&r===!0)throw new te(H.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Hg(t){if(!le.isDocumentKey(t))throw new te(H.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function qg(t){if(le.isDocumentKey(t))throw new te(H.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ru(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":de()}function wr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new te(H.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ru(t);throw new te(H.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new te(H.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}UT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Lv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new te(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new te(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new te(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class df{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gg({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te(H.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te(H.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new oS;switch(r.type){case"firstParty":return new uS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new te(H.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Wg.get(n);r&&(se("ComponentProvider","Removing Datastore"),Wg.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Wi(this.firestore,e,this._query)}}class Ut{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ut(this.firestore,e,this._key)}}class Qr extends Wi{constructor(e,n,r){super(e,n,Qh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ut(this.firestore,null,new le(e))}withConverter(e){return new Qr(this.firestore,e,this._path)}}function Si(t,e,...n){if(t=Fn(t),Fv("collection","path",e),t instanceof df){const r=ze.fromString(e,...n);return qg(r),new Qr(t,null,r)}{if(!(t instanceof Ut||t instanceof Qr))throw new te(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return qg(r),new Qr(t.firestore,null,r)}}function Mt(t,e,...n){if(t=Fn(t),arguments.length===1&&(e=j0.newId()),Fv("doc","path",e),t instanceof df){const r=ze.fromString(e,...n);return Hg(r),new Ut(t,null,new le(r))}{if(!(t instanceof Ut||t instanceof Qr))throw new te(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return Hg(r),new Ut(t.firestore,t instanceof Qr?t.converter:null,new le(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new gv(this,"async_queue_retry"),this.Vu=()=>{const r=wc();r&&se("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=wc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=wc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new fr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!va(e))throw e;se("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw xr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=af.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&de()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Hi extends df{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Qg,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Qg(e),this._firestoreClient=void 0,await e}}}function $T(t,e,n){n||(n="(default)");const r=E0(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Gl(i,e))return s;throw new te(H.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new te(H.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function hf(t){if(t._terminated)throw new te(H.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||WT(t),t._firestoreClient}function WT(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,h,p){return new SS(l,c,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Lv(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new LT(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vi(It.fromBase64String(e))}catch(n){throw new te(H.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Vi(It.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new te(H.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new te(H.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new te(H.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Pe(this._lat,e._lat)||Pe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT=/^__.*__$/;class qT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new rs(e,this.data,this.fieldMask,n,this.fieldTransforms):new _a(e,this.data,n,this.fieldTransforms)}}class Ov{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new rs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function zv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw de()}}class gf{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new gf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return nu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(zv(this.Cu)&&HT.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class GT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Cu(e)}Qu(e,n,r,s=!1){return new gf({Cu:e,methodName:n,qu:r,path:wt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Du(t){const e=t._freezeSettings(),n=Cu(t._databaseId);return new GT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Bv(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);yf("Data must be an object, but it was:",a,r);const l=Uv(r,a);let c,h;if(i.merge)c=new an(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const p=[];for(const m of i.mergeFields){const y=Od(e,m,n);if(!a.contains(y))throw new te(H.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Wv(p,y)||p.push(y)}c=new an(p),h=a.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,h=a.fieldTransforms;return new qT(new Yt(l),c,h)}class ju extends bu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ju}}class mf extends bu{_toFieldTransform(e){return new GS(e.path,new ua)}isEqual(e){return e instanceof mf}}function QT(t,e,n,r){const s=t.Qu(1,e,n);yf("Data must be an object, but it was:",s,r);const i=[],a=Yt.empty();Fs(r,(c,h)=>{const p=vf(e,c,n);h=Fn(h);const m=s.Nu(p);if(h instanceof ju)i.push(p);else{const y=Ta(h,m);y!=null&&(i.push(p),a.set(p,y))}});const l=new an(i);return new Ov(a,l,s.fieldTransforms)}function KT(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[Od(e,r,n)],c=[s];if(i.length%2!=0)throw new te(H.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)l.push(Od(e,i[y])),c.push(i[y+1]);const h=[],p=Yt.empty();for(let y=l.length-1;y>=0;--y)if(!Wv(h,l[y])){const C=l[y];let k=c[y];k=Fn(k);const P=a.Nu(C);if(k instanceof ju)h.push(C);else{const z=Ta(k,P);z!=null&&(h.push(C),p.set(C,z))}}const m=new an(h);return new Ov(p,m,a.fieldTransforms)}function YT(t,e,n,r=!1){return Ta(n,t.Qu(r?4:3,e))}function Ta(t,e){if($v(t=Fn(t)))return yf("Unsupported field value:",e,t),Uv(t,e);if(t instanceof bu)return function(r,s){if(!zv(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let c=Ta(l,s.Lu(a));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Fn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return WS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ct.fromDate(r);return{timestampValue:Zl(s.serializer,i)}}if(r instanceof ct){const i=new ct(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Zl(s.serializer,i)}}if(r instanceof ff)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Vi)return{bytesValue:ov(s.serializer,r._byteString)};if(r instanceof Ut){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Jh(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof pf)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Kh(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Ru(r)}`)}(t,e)}function Uv(t,e){const n={};return N0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fs(t,(r,s)=>{const i=Ta(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function $v(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ct||t instanceof ff||t instanceof Vi||t instanceof Ut||t instanceof bu||t instanceof pf)}function yf(t,e,n){if(!$v(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Ru(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Od(t,e,n){if((e=Fn(e))instanceof Pu)return e._internalPath;if(typeof e=="string")return vf(t,e);throw nu("Field path arguments must be of type string or ",t,!1,void 0,n)}const XT=new RegExp("[~\\*/\\[\\]]");function vf(t,e,n){if(e.search(XT)>=0)throw nu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Pu(...e.split("."))._internalPath}catch{throw nu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function nu(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||a)&&(c+=" (found",i&&(c+=` in field ${r}`),a&&(c+=` in document ${s}`),c+=")"),new te(H.INVALID_ARGUMENT,l+t+c)}function Wv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ut(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(xf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class JT extends Hv{data(){return super.data()}}function xf(t,e){return typeof e=="string"?vf(t,e):e instanceof Pu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new te(H.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _f{}class eI extends _f{}function tI(t,e,...n){let r=[];e instanceof _f&&r.push(e),r=r.concat(n),function(i){const a=i.filter(c=>c instanceof wf).length,l=i.filter(c=>c instanceof Nu).length;if(a>1||a>0&&l>0)throw new te(H.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Nu extends eI{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Nu(e,n,r)}_apply(e){const n=this._parse(e);return qv(e._query,n),new Wi(e.firestore,e.converter,Rd(e._query,n))}_parse(e){const n=Du(e.firestore);return function(i,a,l,c,h,p,m){let y;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new te(H.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Xg(m,p);const C=[];for(const k of m)C.push(Yg(c,i,k));y={arrayValue:{values:C}}}else y=Yg(c,i,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Xg(m,p),y=YT(l,a,m,p==="in"||p==="not-in");return ot.create(h,p,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Kg(t,e,n){const r=e,s=xf("where",t);return Nu._create(s,r,n)}class wf extends _f{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new wf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:On.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const c of l)qv(a,c),a=Rd(a,c)}(e._query,n),new Wi(e.firestore,e.converter,Rd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Yg(t,e,n){if(typeof(n=Fn(n))=="string"){if(n==="")throw new te(H.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$0(e)&&n.indexOf("/")!==-1)throw new te(H.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ze.fromString(n));if(!le.isDocumentKey(r))throw new te(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yg(t,new le(r))}if(n instanceof Ut)return yg(t,n._key);throw new te(H.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ru(n)}.`)}function Xg(t,e){if(!Array.isArray(t)||t.length===0)throw new te(H.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qv(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new te(H.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new te(H.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class nI{convertValue(e,n="none"){switch(Ms(e)){case 0:return null;case 1:return e.booleanValue;case 2:return et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ns(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw de()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Fs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>et(a.doubleValue));return new pf(i)}convertGeoPoint(e){return new ff(et(e.latitude),et(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Wh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(oa(e));default:return null}}convertTimestamp(e){const n=Jr(e);return new ct(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ze.fromString(e);je(hv(r));const s=new aa(r.get(1),r.get(3)),i=new le(r.popFirst(5));return s.isEqual(n)||xr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gv(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qv extends Hv{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new wl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(xf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class wl extends Qv{data(e={}){return super.data(e)}}class rI{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Io(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new wl(this._firestore,this._userDataWriter,r.key,r,new Io(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new te(H.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const c=new wl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Io(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new wl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Io(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,p=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:sI(l.type),doc:c,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function sI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return de()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(t){t=wr(t,Ut);const e=wr(t.firestore,Hi);return zT(hf(e),t._key).then(n=>iI(e,t,n))}class Kv extends nI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vi(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ut(this.firestore,null,n)}}function Sl(t){t=wr(t,Wi);const e=wr(t.firestore,Hi),n=hf(e),r=new Kv(e);return ZT(t._query),BT(n,t._query).then(s=>new rI(e,r,t,s))}function zd(t,e,n){t=wr(t,Ut);const r=wr(t.firestore,Hi),s=Gv(t.converter,e,n);return Ef(r,[Bv(Du(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Vn.none())])}function ur(t,e,n,...r){t=wr(t,Ut);const s=wr(t.firestore,Hi),i=Du(s);let a;return a=typeof(e=Fn(e))=="string"||e instanceof Pu?KT(i,"updateDoc",t._key,e,n,r):QT(i,"updateDoc",t._key,e),Ef(s,[a.toMutation(t._key,Vn.exists(!0))])}function Yv(t,e){const n=wr(t.firestore,Hi),r=Mt(t),s=Gv(t.converter,e);return Ef(n,[Bv(Du(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Vn.exists(!1))]).then(()=>r)}function Ef(t,e){return function(r,s){const i=new fr;return r.asyncQueue.enqueueAndForget(async()=>RT(await OT(r),s,i)),i.promise}(hf(t),e)}function iI(t,e,n){const r=n.docs.get(e._key),s=new Kv(t);return new Qv(t,s,e._key,r,new Io(n.hasPendingWrites,n.fromCache),e.converter)}function jn(){return new mf("serverTimestamp")}(function(e,n=!0){(function(s){Bi=s})(qw),na(new Pi("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new Hi(new aS(r.getProvider("auth-internal")),new dS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new te(H.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new aa(h.options.projectId,p)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Gr(hg,"4.7.3",e),Gr(hg,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bd="us-central1";class aI{constructor(e,n,r,s,i=Bd,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new oI(n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Bd}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function lI(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const Jg="@firebase/functions",Zg="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI="auth-internal",cI="app-check-internal",dI="messaging-internal";function hI(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),a=r.getProvider(uI),l=r.getProvider(dI),c=r.getProvider(cI);return new aI(i,a,l,c,s,t)};na(new Pi(Xv,n,"PUBLIC").setMultipleInstances(!0)),Gr(Jg,Zg,e),Gr(Jg,Zg,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(t=Gw(),e=Bd){const r=E0(Fn(t),Xv).getImmediate({identifier:e}),s=F1("functions");return s&&pI(r,...s),r}function pI(t,e,n){lI(Fn(t),e,n)}hI(fetch.bind(self));const gI={apiKey:'"AIzaSyDRdl4zhwoZumVtphmJ19orZ8HoR0WQQZM",',authDomain:'"qualtrics-game-backend.firebaseapp.com",',projectId:'"qualtrics-game-backend",',storageBucket:'"qualtrics-game-backend.firebasestorage.app",',messagingSenderId:'"441267092549",',appId:"1:441267092549:web:6ce075f5f3ea7cf958772c"},Jv=T0(gI),nt=$T(Jv,{experimentalForceLongPolling:!1,useFetchStreams:!1});fI(Jv);const Ue={init(){localStorage.getItem("sessionId")||(localStorage.setItem("sessionId",this.generateSessionId()),localStorage.setItem("sessionStartTime",Date.now().toString())),localStorage.getItem("semesterStartTime")||localStorage.setItem("semesterStartTime",Date.now().toString())},generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},async logEvent(t,e){const n=localStorage.getItem("sessionId")||this.generateSessionId(),r=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),s=Date.now(),i=s-r,a=(i/1e3).toFixed(1),l=Math.floor(i/6e4),c=Math.floor(i%6e4/1e3),h=`${l}:${c.toString().padStart(2,"0")}`,p=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),m=this.getFullGameContext(),y={sessionId:n,studentId:p.studentId||null,type:t,timestamp:new Date().toISOString(),clientTimestamp:s,timeElapsedSeconds:parseFloat(a),readableTime:h,semesterTime:this.getSemesterTime(),...m,isAdminMode:p.role==="admin",hasCheckpoint:p.checkpointSemester2||!1,hasAI:p.hasAI||!1,section:p.section||null,...this.convertTimesToSeconds(e)};(t==="user_action"||t==="task_attempt")&&console.log(`DEBUG: Event ${t} - studentId: ${y.studentId}, role: ${p.role}`);try{await Yv(Si(nt,"events"),y)}catch(C){console.error("Failed to log event:",C),this.storeOfflineEvent(y)}},convertTimesToSeconds(t){const e={...t},n=["timeTaken","timeSpent","totalTime","timeOnPreviousPage","averageTime","timeBetweenHelpAndSubmit"];for(const r of n)e[r]!==void 0&&e[r]!==null&&(e[`${r}Seconds`]=(e[r]/1e3).toFixed(1),delete e[r]);return e.timeProgression&&(e.timeProgressionSeconds=e.timeProgression.map(r=>(r/1e3).toFixed(1)),delete e.timeProgression),e.timePerAttempt&&(e.timePerAttemptSeconds=e.timePerAttempt.map(r=>(r/1e3).toFixed(1)),delete e.timePerAttempt),e},getSemesterTime(){const t=parseInt(localStorage.getItem("semesterStartTime")||Date.now()),e=Date.now()-t,n=(e/1e3).toFixed(1),r=Math.floor(e/6e4),s=Math.floor(e%6e4/1e3);return{elapsedSeconds:parseFloat(n),readable:`${r}:${s.toString().padStart(2,"0")}`,minutes:r,seconds:s}},getCurrentContext(){const t=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),e=((Date.now()-t)/1e3).toFixed(1);return{currentTask:localStorage.getItem("currentTask"),gameMode:localStorage.getItem("gameMode"),totalCompleted:this.getCompletedTaskCount(),currentStreak:this.getCurrentStreak(),sessionDurationSeconds:parseFloat(e)}},getFullGameContext(){const t=localStorage.getItem("currentTask")||"",e=localStorage.getItem("gameMode")||"",n=parseInt(localStorage.getItem("currentSemester")||"1"),r=parseInt(localStorage.getItem("totalSemesters")||"2"),s=localStorage.getItem("practiceCompleted")==="true",i=parseInt(localStorage.getItem("completedTasksCount")||"0"),a=parseInt(localStorage.getItem("completedLevels")||"0"),l=parseInt(localStorage.getItem("totalSwitches")||"0"),c=parseInt(localStorage.getItem("aiUsageCount")||"0"),h=JSON.parse(localStorage.getItem("categoryPoints")||"{}"),p=parseFloat(localStorage.getItem("studentLearningScore")||"0");return{currentTask:t,gameMode:e,currentSemester:n,totalSemesters:r,practiceCompleted:s,completedTasks:i,completedLevels:a,totalSwitches:l,aiUsageCount:c,studentLearning:p,totalBonus:h.bonus||0,finalScore:Math.round(p)+(h.bonus||0),semester:n}},calculateImprovementTrend(t){if(!t||t.length<3)return"needs_more_data";const n=t.slice(-5).map(s=>s.accuracy),r=this.calculateTrend(n);return r>5?"rapid_improvement":r>2?"steady_improvement":r>0?"slight_improvement":r>-2?"stable":r>-5?"slight_decline":"rapid_decline"},calculateImprovementRate(t){if(!t||t.length<2)return{overall:0,trend:0,isImproving:!1,dataPoints:t?t.length:0};const e=t[0].accuracy,r=t[t.length-1].accuracy-e;if(t.length<3)return{overall:r,trend:r,isImproving:r>0,dataPoints:t.length};const s=Math.floor(t.length/2),i=t.slice(0,s).reduce((c,h)=>c+h.accuracy,0)/s,l=t.slice(s).reduce((c,h)=>c+h.accuracy,0)/(t.length-s)-i;return{overall:r,trend:l,isImproving:l>0,dataPoints:t.length}},setPageStartTime(t){t&&localStorage.setItem(`pageStartTime_${t}`,Date.now().toString())},getTimeOnCurrentPage(t){if(!t)return 0;const e=localStorage.getItem(`pageStartTime_${t}`);return e?Date.now()-parseInt(e):0},ensureSession(){localStorage.getItem("sessionId")||this.init()},async trackAIHelpResponse(t,e,n,r,s,i){const a=parseInt(localStorage.getItem("aiUsageCount")||"0");return localStorage.setItem("aiUsageCount",(a+1).toString()),this.logEvent("ai_help_response",{taskId:t,helpType:e,suggestion:n,playerAction:r,playerValue:s,timeBetween:i})},async trackTaskAttempt(t,e){return this.logEvent("task_attempt",{taskId:t,...e})},async trackUserAction(t,e){return this.logEvent("user_action",{action:t,response:e.response||"",query:e.query||"",queryType:e.queryType||"",choice:e.choice||"",currentMode:e.currentMode||"",...e})},async syncOfflineEvents(){return console.log("Syncing offline events..."),Promise.resolve()},async trackTaskComplete(t,e){return this.logEvent("task_complete",{taskId:t,...e})},async trackPageSwitch(t,e,n){return this.logEvent("page_switch",{from:t,to:e,isAutoAdvance:n})},trackAITaskHelp(t,e,n,r,s){return this.logEvent("ai_task_help",{taskId:t,taskType:e,suggestion:n,wasCorrect:r,attemptNumber:s})}};Ue.init();const Xe={seedRandom:null,currentSeed:null,initializeSeed(t){this.currentSeed=t;let e=t;this.seedRandom=function(){return e=(e*9301+49297)%233280,e/233280}},getRandom(){return this.seedRandom?this.seedRandom():Math.random()},generateCountingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n;e==="easy"?n=(t-1)%5+1:e==="medium"?n=(t-11)%5+6:n=(t-25)%5+11;const s={easy:{1:{target:"the",type:"word"},2:{target:"and",type:"word"},3:{target:"of",type:"word"},4:{target:"to",type:"word"},5:{target:"in",type:"word"}},medium:{6:{target:"e",type:"letter"},7:{target:"a",type:"letter"},8:{target:"i",type:"letter"},9:{target:"o",type:"letter"},10:{target:"s",type:"letter"}},hard:{11:{targets:["a","e"],type:"multi-letter"},12:{targets:["i","o"],type:"multi-letter"},13:{targets:["s","t"],type:"multi-letter"},14:{targets:["n","r"],type:"multi-letter"},15:{targets:["l","d"],type:"multi-letter"}}}[e][n];let i="";return s.type==="word"?i=`Count how many times the word "${s.target}" appears:`:s.type==="letter"?i=`Count how many times the letter "${s.target}" appears (case-insensitive):`:i=`Count how many times the letters "${s.targets[0]}" and "${s.targets[1]}" appear in total:`,{...s,instruction:i,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},generateSliderPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n,r,s;return e==="easy"?(n=Math.floor(this.getRandom()*11),r=1,s=!0):e==="medium"?(n=Math.round(this.getRandom()*10*10)/10,r=.1,s=!0):(n=Math.round(this.getRandom()*10*100)/100,r=.01,s=(t-25)%5!==0),{target:n,step:r,showValue:s,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1),precision:e==="easy"?0:e==="medium"?1:2}},generateTypingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard",n={easy:["hello world","quick test","type this","easy mode","simple text","good job","keep going","nice work","almost done","level up"],medium:["HeLLo WoRLd","QuIcK tEsT","TyPe ThIs","MeDiUm MoDe","MiXeD cAsE","KeEp GoInG","NiCe WoRk","AlMoSt DoNe","LeVeL uP","ChAlLeNgE","TeSt RuN","NeXt LeVeL","TrY aGaIn","GoOd LuCk","FiNaL tEsT"],hard:["Test@123","Go4It!Now","X9%Y8&Z7*","P6!Q5?R4+","Z1@Y2#X3$","M7&N8*O9!","J4%K5^L6&","D1!E2@F3#","A7$B8%C9^","V3*W4+X5=","Q2#R3$S4%","H5^I6&J7*","K8(L9)M0!","N1@O2#P3$","T4%U5^V6&","W7*X8(Y9)","C0!D1@E2#","F3$G4%H5^","I6&J7*K8(","L9)M0!N1@","O2#P3$Q4%","R5^S6&T7*","U8(V9)W0!","X1@Y2#Z3$","A4%B5^C6&"]};let r;if(e==="easy"){const s=(t-1)%n.easy.length;r=n.easy[s]}else if(e==="medium"){const s=(t-11)%n.medium.length;r=n.medium[s]}else{const s=(t-25)%n.hard.length;r=n.hard[s]}return{pattern:r,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},textPassages:["The University of California, Berkeley (UC Berkeley, Berkeley, Cal, or California) is a public land-grant research university in Berkeley, California, United States. Founded in 1868 and named after the Anglo-Irish philosopher George Berkeley, it is the state's first land-grant university and is the founding campus of the University of California system.","Berkeley has an enrollment of more than 45,000 students. The university is organized around fifteen schools of study on the same campus, including the College of Chemistry, the College of Engineering, College of Letters and Science, and the Haas School of Business.",'The Berkeley campus encompasses approximately 1,232 acres, though the "central campus" occupies only the low-lying western 178 acres. The campus contains numerous wooded areas, including the Eucalyptus Grove and Strawberry Creek, which runs through the center of campus.',"Oski the Bear (Oski) is the official mascot of the University of California, Berkeley, representing the California Golden Bears. Named after the Oski Yell, he made his debut at a freshman rally in the Greek Theatre on September 25, 1941.","Berkeley faculty, alumni, and researchers have won 111 Nobel laureates, 25 Turing Award winners, and 19 Academy Award winners. The university has produced many notable alumni in various fields including science, politics, business, and entertainment.","The university's athletic teams compete as the California Golden Bears and are members of the Atlantic Coast Conference for most sports. Berkeley teams have won 107 national championships, including 45 NCAA national championships.","Research at Berkeley is conducted within departments, organized research units, and interdisciplinary research centers. Berkeley operates Lawrence Berkeley National Laboratory, manages Los Alamos National Laboratory, and is a founding partner of the Space Sciences Laboratory.","The Berkeley campus offers over 350 degree programs through its 14 colleges and schools. Popular majors include Computer Science, Economics, Political Science, and Business Administration. The student-faculty ratio is 17:1.","Berkeley's libraries contain more than 13 million volumes and maintain special collections including the Mark Twain Papers, the Oral History Center, and the Bancroft Library, which houses the largest collection of materials on California history.","The campus is home to several museums including the Berkeley Art Museum and Pacific Film Archive, the Lawrence Hall of Science, and the UC Botanical Garden. These facilities serve both educational and public outreach purposes.","Notable Berkeley inventions and discoveries include the cyclotron, the atomic bomb, the flu vaccine, and vitamin E. Berkeley researchers discovered 16 chemical elements of the periodic table, more than any other university.","The Free Speech Movement, which took place during the 1964-65 academic year, was a pivotal moment in the history of civil liberties in the United States. It began when students protested a ban on political activities on campus.","Berkeley's Campanile, known as Sather Tower, is the third-tallest clock tower in the world at 307 feet. It was completed in 1914 and is visible for miles, serving as a symbol of the university.","The university operates on a semester system, with fall semester beginning in late August and spring semester beginning in mid-January. Berkeley offers over 5,000 courses each semester across all disciplines.",`Cal Bears have won at least one team national title in 13 different sports. The university's traditional rival is Stanford University, with the annual football game known as "The Big Game" dating back to 1892.`],getTextPassage(t){if(this.seedRandom){const e=Math.floor(this.getRandom()*this.textPassages.length),n=(t-1+e)%this.textPassages.length;return this.textPassages[n]}else{const e=(t-1)%this.textPassages.length;return this.textPassages[e]}}};function Ud({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r,preGeneratedPattern:s=null,preGeneratedText:i=null}){const[a,l]=M.useState(""),[c,h]=M.useState(""),[p,m]=M.useState(null),[y,C]=M.useState(""),[k,P]=M.useState(null),[z,A]=M.useState(""),[w,T]=M.useState(""),[V]=M.useState(Date.now()),[$,j]=M.useState(""),[E,g]=M.useState(!1),[S,I]=M.useState(new Set),v=M.useRef(0);M.useRef(null);const R=(U,b=null,D=null)=>{const L=document.createElement("canvas"),O=L.getContext("2d");L.width=900,L.height=400,O.fillStyle="#fafafa",O.fillRect(0,0,L.width,L.height),O.strokeStyle="#e0e0e0",O.lineWidth=2,O.strokeRect(0,0,L.width,L.height),O.font="24px monospace",O.fillStyle="#333";const Y=36,q=25,ne=L.width-q*2;return((ge,Te)=>{const ve=ge.split(" "),ae=[];let we="";for(let xe of ve){const Ae=we+(we?" ":"")+xe;O.measureText(Ae).width>Te&&we?(ae.push(we),we=xe):we=Ae}return we&&ae.push(we),ae})(U,ne).forEach((ge,Te)=>{const ve=q+(Te+1)*Y;let ae=q;if(t<=5){const we=ge.split(" ");let xe=0;we.forEach(Ae=>{const pt=D&&D.has(xe),Ze=b&&b.some(Ct=>Ae.toLowerCase()===Ct.toLowerCase());if(pt){const Ct=O.measureText(Ae).width;O.fillStyle="yellow",O.fillRect(ae-2,ve-18,Ct+4,24)}else if(Ze){const Ct=O.measureText(Ae).width;O.fillStyle="rgba(255, 215, 0, 0.4)",O.fillRect(ae-2,ve-18,Ct+4,24)}O.fillStyle="#333",O.fillText(Ae,ae,ve),ae+=O.measureText(Ae+" ").width,xe++})}else for(let we=0;we<ge.length;we++){const xe=ge[we],Ae=O.measureText(xe).width;b&&b.some(Ze=>xe.toLowerCase()===Ze.toLowerCase())&&(O.fillStyle="rgba(255, 215, 0, 0.4)",O.fillRect(ae-1,ve-18,Ae+2,24)),O.fillStyle="#333",O.fillText(xe,ae,ve),ae+=Ae}}),L.toDataURL()};M.useEffect(()=>{C(0),P(null),v.current=0},[t]),M.useEffect(()=>{const U=async(D,L)=>{const O=document.createElement("canvas"),Y=O.getContext("2d");O.width=900,O.height=350,Y.fillStyle="#fafafa",Y.fillRect(0,0,O.width,O.height),Y.strokeStyle="#e0e0e0",Y.lineWidth=2,Y.strokeRect(0,0,O.width,O.height),Y.font="24px monospace";const q=36,ne=20,oe=O.width-ne*2,ge=((Te,ve)=>{const ae=Te.split(" "),we=[];let xe="";for(let Ae of ae){const pt=xe+(xe?" ":"")+Ae;Y.measureText(pt).width>ve&&xe?(we.push(xe),xe=Ae):xe=pt}return xe&&we.push(xe),we})(z,oe);for(let Te=0;Te<D.length;Te++)D[Te],ge.forEach((ve,ae)=>{const we=ne+(ae+1)*q;let xe=ne;for(let Ae=0;Ae<ve.length;Ae++){const pt=ve[Ae],Ze=Y.measureText(pt).width;D.some(zn=>pt.toLowerCase()===zn.toLowerCase())&&(Y.fillStyle="rgba(255, 255, 0, 0.6)",Y.fillRect(xe-1,we-20,Ze+2,26)),Y.fillStyle="#333",Y.fillText(pt,xe,we),xe+=Ze}}),j(O.toDataURL()),await new Promise(ve=>setTimeout(ve,300));setTimeout(()=>{C(L.toString())},300)},b=async D=>{const{action:L,highlightWords:O,suggestedCount:Y,animate:q,isMultiLetter:ne,targetLetters:oe}=D.detail||{};if(L==="highlightAndCount"){if(ne&&Array.isArray(oe)){q&&await U(oe,Y);return}if(Array.isArray(O)&&q){z.split(" ");let ye=[];for(let ge=0;ge<O.length;ge++){ye.push(O[ge]);const Te=document.createElement("canvas"),ve=Te.getContext("2d");Te.width=900,Te.height=350,ve.fillStyle="#fafafa",ve.fillRect(0,0,Te.width,Te.height),ve.strokeStyle="#e0e0e0",ve.lineWidth=2,ve.strokeRect(0,0,Te.width,Te.height),ve.font="24px monospace";const ae=36,we=20,xe=Te.width-we*2;((Ze,Ct)=>{const zn=Ze.split(" "),Ht=[];let tn="";for(let qt of zn){const Bn=tn+(tn?" ":"")+qt;ve.measureText(Bn).width>Ct&&tn?(Ht.push(tn),tn=qt):tn=Bn}return tn&&Ht.push(tn),Ht})(z,xe).forEach((Ze,Ct)=>{const zn=we+(Ct+1)*ae;let Ht=we;Ze.split(" ").forEach(qt=>{const Bn=ve.measureText(qt).width;ye.some(is=>{const er=qt.replace(/[.,;!?]/g,"").toLowerCase(),zs=is.replace(/[.,;!?]/g,"").toLowerCase();return er===zs})&&(ve.fillStyle="rgba(255, 255, 0, 0.5)",ve.fillRect(Ht-2,zn-18,Bn+4,24)),ve.fillStyle="#333",ve.fillText(qt,Ht,zn),Ht+=ve.measureText(qt+" ").width})}),j(Te.toDataURL()),await new Promise(Ze=>setTimeout(Ze,200))}setTimeout(()=>{C(Y.toString())},300)}}};return window.addEventListener("aiCountingHelp",b),()=>window.removeEventListener("aiCountingHelp",b)},[z,t]),M.useEffect(()=>{var O;const U=s||Xe.generateCountingPattern(t),b=i||Xe.getTextPassage(t);A(b),l(U.target||((O=U.targets)==null?void 0:O.join(", "))),h(U.instruction);let D=0;if(U.type==="word"){const Y=new RegExp(`\\b${U.target}\\b`,"gi"),q=b.match(Y);D=q?q.length:0}else if(U.type==="letter"){const Y=new RegExp(U.target,"gi"),q=b.match(Y);D=q?q.length:0}else U.type==="multi-letter"&&U.targets.forEach(Y=>{const q=new RegExp(Y,"gi"),ne=b.match(q);D+=ne?ne.length:0});m(D);const L=R(b,null);j(L)},[t,s,i]);const _=async()=>{const U=Date.now()-V,b=parseInt(y,10)||0,D=p??0,L=Math.abs(b-D),O=`g1t${t}`,Y=localStorage.getItem(`lastAIHelp_${O}`);if(Y){const oe=JSON.parse(Y),ye=Date.now()-oe.timestamp,ge=b===oe.suggestion?"accepted":"modified";await Ue.trackAIHelpResponse(O,oe.type,oe.suggestion,ge,b,ye),localStorage.removeItem(`lastAIHelp_${O}`)}let q=0;L===0?q=2:L<=1?q=1:q=0,v.current+=1,await Ue.trackTaskAttempt(O,v.current,!0,U,b,D);const ne=localStorage.getItem("sessionId");if(ne&&!ne.startsWith("offline-"))try{await ur(Mt(nt,"sessions",ne),{[`taskAccuracies.g1t${t}`]:q===2?100:q===1?70:0,[`taskTimes.g1t${t}`]:U,[`taskPoints.g1t${t}`]:q,lastActivity:jn()})}catch(oe){console.error("Error storing accuracy:",oe)}P(q===2?" Perfect! 2 points earned!":q===1?` Off by ${L} - 1 point earned!`:` Off by ${L} - 0 points earned.`),setTimeout(()=>{e==null||e(`g1t${t}`,{attempts:v.current,totalTime:U,accuracy:q===2?100:q===1?70:0,userAnswer:b,correctAnswer:D,points:q})},500)},Z=Xe.generateCountingPattern(t).difficultyLabel,ce=t<=5?"easy":t<=10?"medium":"hard";return u.jsxs("div",{className:"task counting",children:[u.jsxs("h3",{children:["Research Content - Level ",t]}),u.jsx("div",{className:`difficulty-badge ${ce}`,children:Z}),u.jsxs("p",{className:"instruction",children:[u.jsx("strong",{children:c}),u.jsx("br",{}),u.jsx("span",{className:"hint",children:"(Case-insensitive)"})]}),u.jsxs("div",{className:"text-display text-to-count","data-counting-text":z,children:[u.jsx("div",{className:"count-target","data-pattern":a,style:{display:"none"},children:a}),$?u.jsx("img",{src:$,alt:"Text passage for counting",style:{width:"100%",maxWidth:"900px",height:"auto",maxHeight:"350px",objectFit:"contain",border:"none",userSelect:"none",pointerEvents:"none"},onContextMenu:U=>U.preventDefault(),draggable:!1}):u.jsx("div",{dangerouslySetInnerHTML:{__html:w}})]}),u.jsxs("div",{className:"input-section",children:[u.jsx("label",{children:"Your answer:"}),u.jsx("input",{type:"number",min:"0",max:"999",value:y,onChange:U=>C(U.target.value),onKeyPress:U=>{U.key==="Enter"&&_()},placeholder:"Enter count"})]}),u.jsx("button",{onClick:_,className:"submit-btn",style:{display:"block",margin:"20px auto 0"},children:"Submit"}),k&&u.jsx("div",{className:`feedback ${k.includes("2 points")?"correct":k.includes("0 points")?"incorrect":"partial"}`,children:k})]})}function $d({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r,preGeneratedPattern:s=null}){const[i,a]=M.useState(5),[l,c]=M.useState(0),[h,p]=M.useState(null),[m]=M.useState(Date.now()),[y,C]=M.useState(1),[k,P]=M.useState(!0),[z,A]=M.useState(!1),[w,T]=M.useState(!1),[V,$]=M.useState(!1),[j,E]=M.useState(!1),g=M.useRef(null),S=M.useRef(0);M.useEffect(()=>{if(n)a(3),C(1),P(!0);else{const b=s||Xe.generateSliderPattern(t);a(b.target),C(b.step),P(b.showValue)}c(0),p(null),S.current=0},[t,n,s]),M.useEffect(()=>{const b=D=>{const{action:L,value:O,animate:Y}=D.detail;if(L==="moveSlider")if(T(!0),Y){const q=parseFloat(l),ne=parseFloat(O),oe=1e3,ye=30;let ge=0;const Te=setInterval(()=>{ge++;const ve=ge/ye,ae=1-Math.pow(1-ve,3),we=q+(ne-q)*ae;c(parseFloat(we.toFixed(2))),ge>=ye&&(clearInterval(Te),T(!1),c(parseFloat(ne.toFixed(2))))},oe/ye)}else c(parseFloat(O.toFixed(2))),T(!1)};return window.addEventListener("aiSliderHelp",b),()=>window.removeEventListener("aiSliderHelp",b)},[l]),M.useEffect(()=>{const b=D=>{D.key==="Enter"&&!w&&_()};return document.addEventListener("keypress",b),()=>document.removeEventListener("keypress",b)},[w,l,i]);const I=b=>{if(w)return;const D=g.current;if(!D)return;b.preventDefault();const L=D.getBoundingClientRect(),O=l/10,Y=L.left+L.width*O,q=b.clientX||b.touches&&b.touches[0].clientX;Math.abs(q-Y)<30&&($(!0),E(!0))},v=b=>{if(!V||w)return;const D=g.current;if(!D)return;const L=D.getBoundingClientRect(),O=b.clientX||b.touches&&b.touches[0].clientX,q=Math.max(0,Math.min(1,(O-L.left)/L.width))*10,ne=Math.round(q/y)*y;c(parseFloat(ne.toFixed(2)))},R=()=>{$(!1)};M.useEffect(()=>{if(V){const b=L=>v(L),D=()=>R();return document.addEventListener("mousemove",b),document.addEventListener("mouseup",D),document.addEventListener("touchmove",b),document.addEventListener("touchend",D),()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",D),document.removeEventListener("touchmove",b),document.removeEventListener("touchend",D)}}},[V,y,w]);const _=async()=>{const b=Date.now()-m,D=parseFloat(l),L=Math.abs(D-i),O=`g2t${t}`,Y=localStorage.getItem(`lastAIHelp_${O}`);if(Y){const oe=JSON.parse(Y),ye=Date.now()-oe.timestamp,ge=D===oe.suggestion?"accepted":"modified";await Ue.trackAIHelpResponse(O,oe.type,oe.suggestion,ge,D,ye),localStorage.removeItem(`lastAIHelp_${O}`)}let q=0;L===0?q=2:L<=1?q=1:q=0,S.current+=1,await Ue.trackTaskAttempt(O,S.current,!0,b,D,i);const ne=localStorage.getItem("sessionId");if(ne&&!ne.startsWith("offline-"))try{await ur(Mt(nt,"sessions",ne),{[`taskDifferences.g2t${t}`]:L,[`taskTimes.g2t${t}`]:b,[`taskPoints.g2t${t}`]:q,lastActivity:jn()})}catch(oe){console.error("Error storing difference:",oe)}p(q===2?" Perfect! 2 points earned!":q===1?` Off by ${L.toFixed(2)} - 1 point earned!`:` Off by ${L.toFixed(2)} - 0 points earned.`),setTimeout(()=>{e(`g2t${t}`,{attempts:S.current,totalTime:b,accuracy:q===2?100:q===1?70:0,userAnswer:D,correctAnswer:i,points:q})},500)},ee=Xe.generateSliderPattern(t),Z=ee.difficultyLabel,ce=ee.difficulty,U=()=>{const b=[];for(let D=0;D<=10;D++)b.push(u.jsxs("div",{style:{position:"absolute",left:`${D*10}%`,transform:"translateX(-50%)",textAlign:"center"},children:[u.jsx("div",{style:{width:"2px",height:"12px",background:"#666",margin:"0 auto"}}),u.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:D})]},D));return b};return u.jsxs("div",{className:`task slider ${w?"ai-controlled":""}`,children:[u.jsxs("h3",{children:["Material Creation - Level ",t]}),u.jsx("div",{className:`difficulty-badge ${ce}`,children:Z}),u.jsxs("p",{className:"instruction",children:["Move the slider to:"," ",u.jsx("strong",{className:"target-value","data-target-value":i,children:i}),u.jsx("br",{}),u.jsx("span",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:!j&&"Hold and drag the slider handle to move it"})]}),u.jsxs("div",{className:"slider-container",children:[u.jsxs("div",{className:"range-labels",children:[u.jsx("span",{children:"0"}),u.jsx("span",{children:"10"})]}),u.jsxs("div",{style:{position:"relative",padding:"20px 0 30px 0"},children:[u.jsx("div",{style:{position:"absolute",width:"100%",height:"20px",top:"0"},children:U()}),u.jsx("div",{style:{position:"relative",marginTop:"20px"},children:u.jsx("input",{ref:g,type:"range",min:"0",max:"10",step:y,value:l,onChange:b=>{!V&&!w&&(c(parseFloat(b.target.value)),E(!0))},className:"slider-input",style:{width:"100%",cursor:V?"grabbing":"grab"},onMouseDown:I,onTouchStart:I})})]}),u.jsx("div",{className:"current-value",children:k?parseFloat(l).toFixed(n?0:ee.precision):"??"})]}),u.jsx("button",{onClick:_,className:"submit-btn",disabled:w,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),h&&u.jsx("div",{className:`feedback ${h.includes("2 points")?"correct":h.includes("0 points")?"incorrect":"partial"}`,children:h})]})}function Wd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r,preGeneratedPattern:s=null}){const[i,a]=M.useState(""),[l,c]=M.useState(""),[h,p]=M.useState(null),[m]=M.useState(Date.now()),[y,C]=M.useState(""),[k,P]=M.useState(!1),z=M.useRef(0),A=j=>{const E=document.createElement("canvas"),g=E.getContext("2d");return E.width=600,E.height=150,g.fillStyle="#f5f5f5",g.fillRect(0,0,E.width,E.height),g.font='bold 40px "Courier New", monospace',g.fillStyle="#333",g.textAlign="center",g.textBaseline="middle",g.fillText(j,E.width/2,E.height/2),E.toDataURL()};M.useEffect(()=>{const E=(s||Xe.generateTypingPattern(t)).pattern;a(E);const g=A(E);C(g)},[t,s]),M.useEffect(()=>{c(""),p(null),z.current=0},[t]),M.useEffect(()=>{const j=E=>{const{action:g,text:S,typeSpeed:I}=E.detail;if(g==="autoType"&&S){P(!0),c("");let v="",R=0;const _=setInterval(()=>{R<S.length?(v+=S[R],c(v),R++):(clearInterval(_),P(!1))},I||50);return()=>clearInterval(_)}};return window.addEventListener("aiTypingHelp",j),()=>window.removeEventListener("aiTypingHelp",j)},[]);const w=async()=>{const j=Date.now()-m,E=`g3t${t}`,g=localStorage.getItem(`lastAIHelp_${E}`);if(g){const _=JSON.parse(g),ee=Date.now()-_.timestamp,Z=l===_.suggestion?"accepted":"modified";await Ue.trackAIHelpResponse(E,_.type,_.suggestion,Z,l,ee),localStorage.removeItem(`lastAIHelp_${E}`)}const I=((_,ee)=>{const Z=_.length,ce=ee.length,U=Array(Z+1).fill(null).map(()=>Array(ce+1).fill(0));for(let b=0;b<=Z;b++)U[b][0]=b;for(let b=0;b<=ce;b++)U[0][b]=b;for(let b=1;b<=Z;b++)for(let D=1;D<=ce;D++)_[b-1]===ee[D-1]?U[b][D]=U[b-1][D-1]:U[b][D]=Math.min(U[b-1][D]+1,U[b][D-1]+1,U[b-1][D-1]+1);return U[Z][ce]})(l,i);let v=0;I===0?v=2:I===1?v=1:v=0,z.current+=1,await Ue.trackTaskAttempt(E,z.current,!0,j,l,i);const R=localStorage.getItem("sessionId");if(R&&!R.startsWith("offline-"))try{await ur(Mt(nt,"sessions",R),{[`taskAccuracies.g3t${t}`]:v===2?100:v===1?70:0,[`taskTimes.g3t${t}`]:j,[`taskPoints.g3t${t}`]:v,lastActivity:jn()})}catch(_){console.error("Error storing accuracy:",_)}p(v===2?" Perfect! 2 points earned!":v===1?" 1 typo - 1 point earned!":` ${I} errors - 0 points earned.`),setTimeout(()=>{e(`g3t${t}`,{attempts:z.current,totalTime:j,accuracy:v===2?100:v===1?70:0,userAnswer:l,correctAnswer:i,points:v})},500)},T=Xe.generateTypingPattern(t),V=T.difficultyLabel,$=T.difficulty;return u.jsxs("div",{className:"task typing",style:{maxWidth:"100%"},children:[u.jsxs("h3",{children:["Student Engagement - Level ",t]}),u.jsx("div",{className:`difficulty-badge ${$}`,children:V}),u.jsx("p",{className:"instruction",children:"Type this pattern exactly:"}),u.jsxs("div",{className:"pattern-display",children:[u.jsx("div",{className:"typing-pattern","data-typing-pattern":i,style:{display:"none"},children:i}),y?u.jsx("img",{src:y,alt:"Pattern to type",style:{width:"100%",maxWidth:"600px",height:"auto",userSelect:"none",pointerEvents:"none"},onContextMenu:j=>j.preventDefault(),draggable:!1}):u.jsx("span",{className:"pattern-text",children:i})]}),u.jsx("div",{className:"input-section",style:{width:"90%",maxWidth:"900px",margin:"20px auto 0"},children:u.jsx("input",{type:"text",inputMode:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:l,onChange:j=>!k&&c(j.target.value),onKeyPress:j=>{j.key==="Enter"&&!k&&(j.preventDefault(),w())},placeholder:"Type here...",className:"typing-input",disabled:k,style:{backgroundColor:k?"#e3f2fd":"white",transition:"background-color 0.3s",width:"100%",maxWidth:"100%",fontFamily:'"Courier New", monospace',fontSize:"28px",padding:"12px 14px",border:"2px solid #e0e0e0",borderRadius:"8px",boxSizing:"border-box"}})}),u.jsx("button",{onClick:w,className:"submit-btn",disabled:k,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),h&&u.jsx("div",{className:`feedback ${h.includes("2 points")?"correct":h.includes("0 points")?"incorrect":"partial"}`,children:h})]})}function mI({current:t,completed:e,onSwitch:n,limitMode:r,taskPoints:s={},categoryMultipliers:i={},starGoals:a={},categoryPoints:l={},timeRemaining:c=null}){const h=()=>{const T=l.materials||0,V=1+(l.research||0)*.15,$=parseFloat(localStorage.getItem("engagementInterest")||"0")||0;return T*V+$},p=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,m=1+(l.research||0)*.15,y=[];for(let T=1;T<=3;T++)for(let V=1;V<=100;V++){const $=["Research","Materials","Engage"][T-1];y.push({id:`g${T}t${V}`,label:`${$} ${V}`,game:T})}const C=T=>{const V=T.id[1],$=parseInt(T.id.substring(3));if($===1)return!0;const j=`g${V}t${$-1}`;return e[j]===!0},k={2:y.filter(T=>T.game===2),1:y.filter(T=>T.game===1),3:y.filter(T=>T.game===3)},P={1:"#9C27B0",2:"#4CAF50",3:"#f44336"},z={1:"",2:"",3:""},A={1:"Research",2:"Materials",3:"Engagement"},w={1:"research",2:"materials",3:"engagement"};return u.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"25px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"25px"},children:[2,1,3].map(T=>{const V=k[T],$=V.filter(v=>e[v.id]).length,j=w[T],E=$+1,g=T==="1"?(l.research||0)*.15:0,S=T==="3"?(l.engagement||0)*.0015:0,I=g>0||S>0;return u.jsxs("div",{style:{background:`linear-gradient(135deg, ${P[T]}10 0%, ${P[T]}05 100%)`,borderRadius:"12px",border:`2px solid ${P[T]}20`,padding:"20px",position:"relative",overflow:"hidden",boxShadow:I?`0 0 20px ${P[T]}20`:"none",transition:"all 0.3s ease"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"15px"},children:[u.jsx("span",{style:{fontSize:"28px"},children:z[T]}),u.jsxs("div",{style:{flex:1},children:[u.jsx("h3",{style:{margin:0,color:P[T],fontSize:"18px",fontWeight:"bold"},children:A[T]}),u.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:["Level ",Math.min(E,30)]})]}),l&&l[j]>0&&u.jsxs("div",{style:{background:P[T],color:"white",padding:"6px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[l[j]," pts"]})]}),T==="1"&&(l.research||0)>0&&u.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",(l.research*15).toFixed(0),"%"]}),T==="3"&&(l.engagement||0)>0&&u.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",((l.engagement||0)*.15).toFixed(1),"% interest/task"]}),u.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:V.filter(v=>parseInt(v.id.substring(3))<=E).map(v=>{const R=C(v),_=e[v.id],ee=t===v.id,Z=parseInt(v.id.substring(3)),ce=s[v.id]||0;return u.jsxs("button",{disabled:!R||_,onClick:()=>R&&!_&&n(v.id),style:{position:"relative",width:"40px",height:"40px",padding:"0",fontSize:"14px",fontWeight:ee?"bold":"500",border:`2px solid ${ee?P[T]:_?`${P[T]}40`:"#e0e0e0"}`,borderRadius:"8px",background:ee?P[T]:_?`${P[T]}10`:"white",color:ee?"white":_?P[T]:"#333",cursor:R&&!_?"pointer":"not-allowed",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",opacity:_?.7:1,boxShadow:ee?`0 2px 8px ${P[T]}40`:"none",transform:"translateY(0)",willChange:"transform, box-shadow"},onMouseEnter:U=>{R&&!ee&&!_&&requestAnimationFrame(()=>{U.currentTarget.style.transform="translateY(-2px)",U.currentTarget.style.boxShadow=`0 4px 12px ${P[T]}30`})},onMouseLeave:U=>{R&&!ee&&!_&&requestAnimationFrame(()=>{U.currentTarget.style.transform="translateY(0)",U.currentTarget.style.boxShadow="none"})},title:_?`Level ${Z} completed (${ce} pts)`:R?`Start Level ${Z}`:`Complete Level ${Z-1} first`,children:[Z,_&&u.jsx("span",{style:{position:"absolute",top:"-4px",right:"-4px",background:P[T],color:"white",width:"16px",height:"16px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"bold"},children:""}),_&&u.jsx("div",{style:{position:"absolute",bottom:"2px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"2px"},children:ce===0?u.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",border:`1px solid ${P[T]}`,background:"transparent"}}):[...Array(Math.min(ce,2))].map((U,b)=>u.jsx("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:P[T]}},b))})]},v.id)})})]},T)})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",background:"#f8f9fa",borderRadius:"8px",flexWrap:"wrap",gap:"20px"},children:[c!==null&&u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""}),u.jsxs("div",{children:[u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:c<60?"#f44336":"#333"},children:[Math.floor(c/60),":",(c%60).toString().padStart(2,"0")]}),c<180&&c>0&&u.jsx("div",{style:{fontSize:"11px",color:"#ff9800"},children:"Hurry up!"})]})]}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Tasks Completed"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:Object.keys(e).length})]}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Student Learning"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:Math.round(h())}),u.jsxs("div",{style:{fontSize:"10px",color:"#999"},children:[l.materials||0," (materials)  ",m.toFixed(2)," (research) + ",p.toFixed(1)," (cumulative engagement interest)"]})]}),t&&u.jsxs("div",{style:{padding:"8px 16px",background:t.startsWith("g1")?"#9C27B0":t.startsWith("g2")?"#4CAF50":"#f44336",color:"white",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:["Current:"," ",t.replace("g1t","Research ").replace("g2t","Materials ").replace("g3t","Engage ")]})]})]})}function yI({practiceCompleted:t={},onPracticeComplete:e,onStartMainGame:n,onSelectPractice:r,isAdmin:s=!1}){const[i,a]=M.useState(null),l=(y,C)=>{if(C&&C.points===2){typeof e=="function"&&e(y,C);const k=document.createElement("div");k.className="notification-enter",k.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",k.textContent="Perfect! Practice task completed. Returning to menu...",document.body.appendChild(k),setTimeout(()=>{a(null),document.body.contains(k)&&document.body.removeChild(k)},1500)}else{const k=(C==null?void 0:C.points)||0,P=document.createElement("div");P.className="notification-enter",P.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #ff9800; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",P.textContent=`Practice requires 100% accuracy. You scored ${k===1?"50%":"0%"}. Try again!`,document.body.appendChild(P),setTimeout(()=>{document.body.contains(P)&&document.body.removeChild(P)},3e3)}},c=t.g2t1&&t.g1t1&&t.g3t1,h=()=>u.jsxs("div",{className:"practice-menu",children:[u.jsxs("h2",{children:["Practice Mode ",!s&&"(Required)"]}),!s&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",borderRadius:"12px",padding:"16px",marginBottom:"25px",border:"2px solid #f57c00",boxShadow:"0 4px 6px rgba(245, 124, 0, 0.1)",textAlign:"center"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""}),u.jsx("strong",{style:{color:"#e65100",fontSize:"18px"},children:"100% PERFECT ACCURACY REQUIRED"})]}),u.jsxs("div",{style:{color:"#e65100",fontSize:"14px"},children:["You must score 2/2 points (exact answer) on all three practice tasks to proceed.",u.jsx("br",{}),u.jsx("strong",{children:"No partial credit in practice mode!"})]}),u.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"12px"},children:[u.jsxs("span",{style:{padding:"4px 12px",background:t.g2t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g2t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g2t1?"#4CAF50":"#ffb74d"}`},children:["Materials ",t.g2t1?"":"Required"]}),u.jsxs("span",{style:{padding:"4px 12px",background:t.g1t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g1t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g1t1?"#4CAF50":"#ffb74d"}`},children:["Research ",t.g1t1?"":"Required"]}),u.jsxs("span",{style:{padding:"4px 12px",background:t.g3t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g3t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g3t1?"#4CAF50":"#ffb74d"}`},children:["Engagement ",t.g3t1?"":"Required"]})]})]}),u.jsx("p",{className:"practice-hint",style:{textAlign:"center",fontSize:"16px",color:"#666",marginBottom:"30px"},children:"Try each task type before starting the main challenge. No time pressure!"}),u.jsxs("div",{className:"practice-cards",children:[u.jsxs("div",{className:"practice-card materials",children:[u.jsx("h3",{children:" Materials"}),u.jsx("p",{children:"Hold and drag slider to match target values"}),u.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Base points - directly added to score"}),u.jsx("div",{className:"practice-buttons",children:u.jsx("button",{onClick:()=>{a("g2t1"),r&&r("g2t1")},className:t.g2t1?"completed":"",disabled:!1,children:t.g2t1?" Completed":"Try Materials"})})]}),u.jsxs("div",{className:"practice-card research",children:[u.jsx("h3",{children:" Research"}),u.jsx("p",{children:"Count words or letters in text passages"}),u.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 15% multiplier per point in main game"}),u.jsx("div",{className:"practice-buttons",children:u.jsx("button",{onClick:()=>{a("g1t1"),r&&r("g1t1")},className:t.g1t1?"completed":"",disabled:!1,children:t.g1t1?" Completed":"Try Research"})})]}),u.jsxs("div",{className:"practice-card engagement",children:[u.jsx("h3",{children:" Engagement"}),u.jsx("p",{children:"Type patterns exactly as shown"}),u.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 0.15% compound interest per point"}),u.jsx("div",{className:"practice-buttons",children:u.jsx("button",{onClick:()=>{a("g3t1"),r&&r("g3t1")},className:t.g3t1?"completed":"",disabled:!1,children:t.g3t1?" Completed":"Try Engagement"})})]})]}),u.jsxs("div",{style:{marginTop:"25px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",textAlign:"center"},children:[u.jsx("h4",{style:{margin:"0 0 10px 0",color:"#333",fontSize:"16px"},children:"Practice Progress:"}),u.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[u.jsxs("div",{style:{padding:"8px 15px",background:t.g2t1?"#4CAF50":"#e0e0e0",color:t.g2t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Materials ",t.g2t1&&""]}),u.jsxs("div",{style:{padding:"8px 15px",background:t.g1t1?"#9C27B0":"#e0e0e0",color:t.g1t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Research ",t.g1t1&&""]}),u.jsxs("div",{style:{padding:"8px 15px",background:t.g3t1?"#f44336":"#e0e0e0",color:t.g3t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Engagement ",t.g3t1&&""]})]}),u.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#666"},children:[u.jsx("strong",{children:"100% accuracy required"})," to complete each practice task"]})]}),u.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:u.jsx("button",{className:"start-main-game-btn",onClick:n,style:{opacity:!s&&!c?.5:1,cursor:!s&&!c?"not-allowed":"pointer"},disabled:!s&&!c,children:s?"Start Main Game (Admin)":c?"Start Main Game - You're Ready! ":"Complete Practice First"})})]});if(!i)return h();const p=i[1],m=1;return u.jsxs("div",{className:"practice-container",children:[u.jsx("button",{className:"back-to-menu",onClick:()=>a(null),children:" Back to Practice Menu"}),u.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[u.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),u.jsxs("div",{className:"practice-task-wrapper",children:[p==="1"&&u.jsx(Ud,{taskNum:m,onComplete:l,isPractice:!0,currentTaskId:i}),p==="2"&&u.jsx($d,{taskNum:m,onComplete:l,isPractice:!0,currentTaskId:i}),p==="3"&&u.jsx(Wd,{taskNum:m,onComplete:l,isPractice:!0,currentTaskId:i})]})]})}class vI{constructor(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={}}getUniversalAttemptNumber(){return this.totalAIUsage}shouldAIBeCorrect(e){let n;return e===1||e===2||e===4||e===5?n=!0:e===3?n=!1:n=Math.random()<.75,n}getTaskUsageCount(e){return this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]}incrementTaskUsage(e,n){this.totalAIUsage++,this.usageCount[n]++,this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]++}resetForNewSemester(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={},console.log(" AI Help usage reset for new semester")}helpWithSlider(e,n){this.incrementTaskUsage(n,"materials");const r=this.getUniversalAttemptNumber();let s;if(this.shouldAIBeCorrect(r))s=e;else if(r===3){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else if(Math.random()<.5){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else{const i=(Math.random()<.5?-1:1)*(2+Math.random()*2);s=Math.max(0,Math.min(10,e+i))}return{action:"moveSlider",value:s,animate:!0}}helpWithCounting(e,n,r){this.incrementTaskUsage(r,"research");const s=this.getUniversalAttemptNumber(),i=this.shouldAIBeCorrect(s);return n.length===1||n.includes(" and ")||n.includes(",")?this.helpWithLetterCounting(e,n,s,i):this.helpWithWordCounting(e,n,s,i)}helpWithLetterCounting(e,n,r,s){let i=[];n.includes(" and ")||n.includes(",")?i=n.match(/[a-z]/gi)||[]:i=[n];let a=0;i.forEach(h=>{const p=new RegExp(h,"gi"),m=e.match(p);a+=m?m.length:0});let l=a,c=[...i];if(!s){r===3||Math.random()<.5?l=a+1:l=a+Math.floor(Math.random()*3)+2,l=Math.max(0,l);const p="abcdefghijklmnopqrstuvwxyz".split("").filter(y=>!i.includes(y.toLowerCase())),m=Math.floor(Math.random()*2)+1;for(let y=0;y<m&&p.length>0;y++){const C=Math.floor(Math.random()*p.length);c.push(p[C]),p.splice(C,1)}}return{action:"highlightAndCount",highlightWords:[],suggestedCount:l,animate:!0,isMultiLetter:!0,targetLetters:c}}helpWithWordCounting(e,n,r,s){const i=e.split(/\s+/),a=[];let l=0,c=0;if(i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&c++}),s)i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&(a.push(h),l++)});else if(r===3){l=c+1,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());if(h.length>0&&a.length<l){const p=h[Math.floor(Math.random()*h.length)];a.push(p)}}else{Math.random()<.5?l=c+1:l=c+Math.floor(Math.random()*3)+2,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());for(;a.length<l&&h.length>0;){const p=Math.floor(Math.random()*h.length),m=h[p];a.includes(m)||a.push(m),h.splice(p,1)}}return{action:"highlightAndCount",highlightWords:a,suggestedCount:l,animate:!0}}helpWithTyping(e,n){this.incrementTaskUsage(n,"engagement");const r=this.getUniversalAttemptNumber();let s=e;const i={0:["o","O"],o:["0"],O:["0"],1:["l","I","i"],l:["1","I","i"],I:["1","l","i"],i:["1","l","I"],e:["3"],3:["e"],a:["@"],"@":["a"],s:["5","$"],S:["5","$"],5:["s","S"],$:["s","S"],g:["9"],9:["g"],b:["6"],6:["b"],z:["2"],2:["z"],B:["8"],8:["B"]},a=l=>{const c=l.split(""),h=c.map((p,m)=>i[p]?m:-1).filter(p=>p!==-1);if(h.length>0){const p=h[Math.floor(Math.random()*h.length)],m=c[p],y=i[m];y&&y.length>0&&(c[p]=y[Math.floor(Math.random()*y.length)])}else{const p=["transpose","duplicate","missing"],m=p[Math.floor(Math.random()*p.length)],y=Math.floor(Math.random()*c.length);switch(m){case"transpose":y<c.length-1&&([c[y],c[y+1]]=[c[y+1],c[y]]);break;case"duplicate":c.splice(y,0,c[y]);break;case"missing":c.splice(y,1);break}}return c.join("")};if(this.shouldAIBeCorrect(r))s=e;else if(r===3)s=a(e);else if(Math.random()<.5)s=a(e);else{let l=e;const c=Math.floor(Math.random()*3)+2;for(let h=0;h<c;h++)l=a(l);s=l}return{action:"autoType",text:s,typeSpeed:50,perfect:this.shouldAIBeCorrect(r)}}}const vt=new vI;function em({bonusPrompts:t=0,currentTask:e="",categoryPoints:n=null,timeRemaining:r=null,calculateStudentLearning:s=()=>0,aiCost:i=0,onAiCost:a}){const[l,c]=M.useState(!0),[h,p]=M.useState(0),[m,y]=M.useState(!1);M.useEffect(()=>{const D=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");c(D.hasAI!==!1)},[]),M.useEffect(()=>{if(e){const D=vt.getTaskUsageCount(e)>=1;y(D)}},[e]),M.useEffect(()=>{const D=()=>{p(vt.totalAIUsage)},L=setInterval(D,1e3);return D(),()=>clearInterval(L)},[]);const[C,k]=M.useState([{sender:"bot",text:l?"Hello! I'm your AI teaching assistant. You get ONE AI help attempt per task - use it wisely!":"Hello! This is the chat interface. AI assistance is not available for this session."}]),[P,z]=M.useState(""),[A,w]=M.useState(!1),[T,V]=M.useState(0),[$,j]=M.useState(!1),[E,g]=M.useState({materials:0,research:0,engagement:0}),S=M.useRef(null),I=()=>e?e.startsWith("g1")?"research":e.startsWith("g2")?"materials":e.startsWith("g3")?"engagement":null:null,v=(D=null)=>{const L=D||I();if(!L){k(q=>[...q,{sender:"bot",text:"Please start a task first, then I can help you!"}]);return}if(vt.getTaskUsageCount(e)>=1){k(q=>[...q,{sender:"bot",text:" You've already used AI help for this task. Only 1 AI attempt allowed per task!"}]);return}const Y=Date.now();if(Y-E[L]<3e3){k(q=>[...q,{sender:"bot",text:"Please wait a moment before requesting help again!"}]);return}switch(g(q=>({...q,[L]:Y})),L){case"materials":R();break;case"research":_();break;case"engagement":Z();break;default:k(q=>[...q,{sender:"bot",text:"I'm not sure which task you're on. Please try again!"}])}},R=()=>{var q,ne;const D=((q=document.querySelector("[data-target-value]"))==null?void 0:q.getAttribute("data-target-value"))||((ne=document.querySelector(".target-value"))==null?void 0:ne.textContent)||5,L=vt.helpWithSlider(parseFloat(D),e),O=vt.getUniversalAttemptNumber(),Y=vt.shouldAIBeCorrect(O);Ue.trackAITaskHelp(e,"slider",L.value,Y,O),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"slider",suggestion:L.value,timestamp:Date.now(),wasCorrect:Y})),window.dispatchEvent(new CustomEvent("aiSliderHelp",{detail:L})),p(vt.totalAIUsage),y(!0),k(oe=>[...oe,{sender:"bot",text:` Helping with materials...
Suggested value: ${L.value.toFixed(2)}`}])},_=()=>{var O;const D=document.querySelector(".text-to-count"),L=document.querySelector(".count-target");if(D&&L){const Y=D.getAttribute("data-counting-text")||"";let q=((O=L.getAttribute("data-pattern"))==null?void 0:O.replace(/['"]/g,"").trim())||"";const ne=vt.helpWithCounting(Y,q,e),oe=ne.suggestedCount;window.dispatchEvent(new CustomEvent("aiCountingHelp",{detail:ne}));const ye=vt.getUniversalAttemptNumber(),ge=vt.shouldAIBeCorrect(ye);Ue.trackAITaskHelp(e,"counting",oe,ge,ye),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"counting",suggestion:oe,timestamp:Date.now(),wasCorrect:ge,highlightedWords:ne.highlightWords||[],targetLetters:ne.targetLetters||[]})),p(vt.totalAIUsage),y(!0);const Te=ne.isMultiLetter?"letters/characters":"words";k(ve=>[...ve,{sender:"bot",text:` Helping with research...
Found ${oe} ${Te}`}])}},ee=()=>{const D=[" CRITICAL STRATEGY: Do tasks in this EXACT order  1 Engagement (builds interest from the start) 2 Research (multiplies future materials) 3 Materials (gets all multipliers). Materials done early = WASTED points!"," MAXIMUM SCORE ORDER: Engagement FIRST  Research SECOND  Materials LAST! Why? Engagement compounds every task, Research only multiplies FUTURE materials. Doing materials early gets ZERO multiplier!"," WARNING: Research multipliers ONLY apply to materials earned AFTER! If you do materials first, you get NO bonus. Always do ALL engagement & research before touching ANY materials!"," PRO TIP: Complete 100% of Engagement tasks first (builds interest early), then 100% of Research (sets up multipliers), THEN do Materials. This order can DOUBLE your score vs doing materials first!"," OPTIMAL PATH: Think of it like this - Engagement = compound interest (starts early), Research = multiplier (affects future only), Materials = base score (save for last). Wrong order = lost points forever!"],L=D[Math.floor(Math.random()*D.length)];k(O=>[...O,{sender:"bot",text:L}]),Ue.trackUserAction("planning_help_requested",{response:L,currentTask:e,timestamp:Date.now()})},Z=()=>{const D=document.querySelector("[data-typing-pattern]");if(D){const L=D.getAttribute("data-typing-pattern");if(L){const O=vt.helpWithTyping(L,e),Y=vt.getUniversalAttemptNumber(),q=O.perfect;Ue.trackAITaskHelp(e,"typing",O.text,q,Y),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"typing",suggestion:O.text,timestamp:Date.now(),wasCorrect:q,originalPattern:L})),window.dispatchEvent(new CustomEvent("aiTypingHelp",{detail:O})),p(vt.totalAIUsage),y(!0),k(ne=>[...ne,{sender:"bot",text:` Helping with engagement...
Typing: "${O.text.substring(0,30)}${O.text.length>30?"...":""}"`}])}}};M.useEffect(()=>{S.current&&S.current.scrollIntoView({behavior:"smooth"})},[C]);const ce=async()=>{if(!P.trim()||A)return;if(i>0&&points<i){k(O=>[...O,{id:Date.now(),text:`Not enough points! You need ${i} points to use AI help.`,sender:"system"}]);return}const D={id:Date.now(),text:P,sender:"user"};k(O=>[...O,D]),z(""),w(!0),V(0);const L=(globalConfig==null?void 0:globalConfig.aiDelay)||0;if(L>0){const Y=L*1e3/100;let q=0;const ne=setInterval(()=>{q++;const oe=q/Y*100;V(oe),q>=Y&&(clearInterval(ne),U(D.text))},100)}else U(D.text)},U=async D=>{try{a&&a(i);const L=await vt.getHelp(currentTaskId,D,taskContext),O={id:Date.now()+1,text:L,sender:"ai"};k(Y=>[...Y,O])}catch(L){console.error("Error getting AI response:",L),k(O=>[...O,{id:Date.now()+1,text:"Sorry, I encountered an error. Please try again.",sender:"ai"}])}finally{w(!1),V(0)}},b=I();return u.jsxs("div",{className:"chat-container-sidebar",style:{height:"100%",display:"flex",flexDirection:"column"},children:[u.jsxs("div",{className:"chat-header",children:[u.jsx("h3",{children:l?"AI Teaching Assistant":"Chat Interface"}),u.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"2px"},children:l?"1 AI help per task (reliability varies)":"AI assistance disabled for this session"}),u.jsxs("div",{style:{marginTop:"10px",padding:"8px",background:"#e3f2fd",borderRadius:"6px",border:"1px solid #2196F3"},children:[u.jsxs("div",{style:{fontSize:"12px",color:"#1976d2",fontWeight:"bold"},children:["Student Learning: ",Math.round(s())," pts"]}),u.jsxs("div",{style:{fontSize:"10px",color:"#666",marginTop:"2px"},children:["Mat: ",(n==null?void 0:n.materials)||0,"  ",(1+((n==null?void 0:n.research)||0)*.15).toFixed(2),n!=null&&n.bonus?` ${n.bonus>=0?"+":"-"} ${Math.abs(n.bonus)} (Penalties)`:"","+ Interest"]})]})]}),u.jsx("div",{className:"messages-sidebar",children:u.jsxs("div",{className:"messages-list",children:[C.map(D=>u.jsx("div",{className:`message ${D.sender}`,children:u.jsx("div",{className:"message-content",children:D.text})},D.id)),A&&u.jsxs("div",{className:"message ai loading",children:[u.jsxs("div",{className:"typing-indicator",children:[u.jsx("span",{}),u.jsx("span",{}),u.jsx("span",{})]}),T>0&&u.jsx("div",{style:{width:"100%",height:"4px",background:"#eee",marginTop:"5px",borderRadius:"2px"},children:u.jsx("div",{style:{width:`${T}%`,height:"100%",background:"#2196F3",borderRadius:"2px",transition:"width 0.1s linear"}})})]}),u.jsx("div",{ref:S})]})}),u.jsxs("div",{className:"chat-input-sidebar",children:[u.jsx("input",{type:"text",placeholder:l?"Ask about strategy and tips here...":"Chat disabled - no AI available",value:P,onChange:D=>z(D.target.value),onKeyPress:D=>D.key==="Enter"&&ce(),disabled:!l}),u.jsx("button",{onClick:ce,disabled:!P.trim()||!l,children:"Send"})]}),l&&u.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f8f9fa"},children:[u.jsxs("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:["AI Usage: ",h," total attempts",m&&u.jsxs("span",{style:{color:"#ff9800",fontWeight:"bold"},children:[" ","| Current task: 1/1 used"]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"10px"},children:[u.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[u.jsxs("button",{onClick:()=>v(),disabled:!b||m,style:{padding:"12px",background:m?"#ff9800":b?"#2196F3":"#ccc",color:"white",border:"none",borderRadius:"8px",cursor:b&&!m?"pointer":"not-allowed",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[u.jsx("span",{style:{fontSize:"18px"},children:""}),m?"AI Used (1/1)":b?"Help Task":"Start task first"]}),u.jsxs("button",{onClick:ee,style:{padding:"12px",background:"#FF9800",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[u.jsx("span",{style:{fontSize:"18px"},children:""}),"Help Plan"]})]}),u.jsx("button",{onClick:()=>v("materials"),disabled:!e.startsWith("g2")||m,style:{padding:"10px",background:e.startsWith("g2")&&!m?"#4CAF50":m&&e.startsWith("g2")?"#ff9800":"#e0e0e0",color:e.startsWith("g2")||m?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g2")&&!m?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Materials"}),u.jsx("button",{onClick:()=>v("research"),disabled:!e.startsWith("g1")||m,style:{padding:"10px",background:e.startsWith("g1")&&!m?"#9C27B0":m&&e.startsWith("g1")?"#ff9800":"#e0e0e0",color:e.startsWith("g1")||m?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g1")&&!m?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Research"}),u.jsx("button",{onClick:()=>v("engagement"),disabled:!e.startsWith("g3")||m,style:{padding:"10px",background:e.startsWith("g3")&&!m?"#f44336":m&&e.startsWith("g3")?"#ff9800":"#e0e0e0",color:e.startsWith("g3")||m?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g3")&&!m?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Engage"})]}),u.jsx("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:b?u.jsx("span",{style:{color:"#4CAF50"},children:" AI ready to help"}):u.jsx("span",{style:{color:"#999"},children:" Navigate to a task to enable AI help"})})]}),!l&&u.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f5f5f5",textAlign:"center",color:"#666",fontSize:"14px"},children:[u.jsx("div",{style:{marginBottom:"5px"},children:" No AI Assistant"}),u.jsx("div",{style:{fontSize:"12px"},children:"Complete tasks using your own judgment"})]})]})}const ru={generateCode(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`${t}-${e}`.toUpperCase()},async createCode(t={}){return{success:!0,code:this.generateCode(),data:t}},async markCodeAsUsed(t,e){if(!t)return{success:!1,error:"No code provided"};try{const n={code:t,status:"used",usedAt:jn(),sessionId:e,createdAt:jn()};return await zd(Mt(nt,"accessCodes",t),n),{success:!0}}catch(n){return console.error("Error marking code as used:",n),{success:!1,error:n.message}}},async checkCodeUsage(t){if(!t)return{used:!1};try{const e=await Sf(Mt(nt,"accessCodes",t));if(e.exists()){const n=e.data();return{used:n.status==="used",sessionId:n.sessionId,usedAt:n.usedAt}}return{used:!1}}catch(e){return console.error("Error checking code usage:",e),{used:!1,error:e.message}}},getCodeFromURL(){const t=new URLSearchParams(window.location.search);return t.get("code")||t.get("c")||null},async verifyQualtricsCode(t){return{valid:!1,reason:"Qualtrics codes not yet supported"}}};function xI({onLoginSuccess:t}){const[e,n]=M.useState(""),[r,s]=M.useState(!1),[i,a]=M.useState(""),[l,c]=M.useState(!1),h={MASTER:{section:"ADMIN-MASTER",role:"master_admin",name:"Master Administrator",hasAI:!1,isMasterInterface:!0},ADMIN:{role:"admin",semesterDuration:72e4,name:"Admin User",hasAI:!0,checkpointSemester2:!0}},p=C=>({section:"TESTING-AI-CP",hasAI:!0,checkpointSemester2:!0,displayName:`${C} (Internal Tester - AI + Checkpoint)`}),m=C=>{if(h[C])return{valid:!0,type:"master",data:h[C]};const k=C.trim().replace(/[^a-zA-Z0-9\s\-_]/g,"");return k.length<2?{valid:!1,error:"Please enter a name with at least 2 characters"}:k.length>50?{valid:!1,error:"Name too long. Please use 50 characters or less"}:{valid:!0,type:"tester",condition:p(k),cleanName:k}},y=async C=>{if(C.preventDefault(),!e.trim()){a("Please enter your name");return}s(!0),a("");try{const k=m(e.trim());if(!k.valid){a(k.error||"Invalid Student ID"),s(!1);return}let P={timestamp:new Date().toISOString()};if(k.type==="master"){if(P={...P,studentIdentifier:e,role:k.data.role,semesterDuration:k.data.semesterDuration,displayName:k.data.name,section:k.data.isTestCode?"ADMIN-TEST":"ADMIN",hasAI:k.data.hasAI,checkpointSemester2:k.data.checkpointSemester2,isMasterCode:!0,isTestCode:k.data.isTestCode||!1,isMasterInterface:k.data.isMasterInterface||!1},k.data.isMasterInterface){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",displayName:k.data.name,section:"master_admin",hasAI:!0,checkpointSemester2:!0})),window.location.href=`${window.location.origin}?master=true`;return}}else if(k.type==="tester"){const A=k.condition,w=k.cleanName;P={...P,studentIdentifier:w,role:"tester",semesterDuration:72e4,displayName:A.displayName,section:A.section,hasAI:A.hasAI,checkpointSemester2:A.checkpointSemester2,isMasterCode:!1,isTestUser:!0}}const z=await ru.createCode(P);z.success?(sessionStorage.setItem("gameConfig",JSON.stringify({semesterDuration:P.semesterDuration,role:P.role,studentId:P.studentIdentifier,displayName:P.displayName,section:P.section,hasAI:P.hasAI,checkpointSemester2:P.checkpointSemester2})),window.location.href=`${window.location.origin}?code=${z.code}`):a("Failed to generate access code. Please try again.")}catch(k){console.error("Login error:",k),a("System error. Please try again.")}finally{s(!1)}};return u.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",padding:"20px"},children:[u.jsxs("div",{style:{background:"white",padding:"48px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",maxWidth:"480px",width:"100%"},children:[u.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[u.jsxs("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a202c",marginBottom:"8px",lineHeight:"1.2"},children:["Scheduling Challenge:",u.jsx("br",{}),"Can you beat Park?"]}),u.jsx("p",{style:{fontSize:"16px",color:"#718096",marginTop:"12px"},children:"Enter your name to access the game"})]}),u.jsxs("form",{onSubmit:y,children:[u.jsxs("div",{style:{marginBottom:"24px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#2d3748",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.025em"},children:"Your Name:"}),u.jsx("input",{type:"text",value:e,onChange:C=>n(C.target.value),disabled:r,style:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e2e8f0",borderRadius:"8px",boxSizing:"border-box",fontFamily:"'SF Mono', Monaco, 'Courier New', monospace",transition:"all 0.2s ease",background:"#f7fafc",outline:"none"},onFocus:C=>{C.target.style.borderColor="#2196F3",C.target.style.background="white",C.target.style.boxShadow="0 0 0 3px rgba(33, 150, 243, 0.1)"},onBlur:C=>{C.target.style.borderColor="#e2e8f0",C.target.style.background="#f7fafc",C.target.style.boxShadow="none"}}),u.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"#a0aec0",lineHeight:"1.4"},children:"Enter your first and last name (2-50 characters)"})]}),i&&u.jsxs("div",{style:{background:"#fed7d7",color:"#c53030",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",fontSize:"14px",display:"flex",alignItems:"center",border:"1px solid #fc8181"},children:[u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",style:{marginRight:"8px",flexShrink:0},children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i]}),u.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:"600",background:r?"#cbd5e0":"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:r?"none":"0 4px 6px rgba(33, 150, 243, 0.25)",transform:r?"none":"translateY(0)"},onMouseDown:C=>{r||(C.target.style.transform="translateY(2px)",C.target.style.boxShadow="0 2px 4px rgba(33, 150, 243, 0.25)")},onMouseUp:C=>{r||(C.target.style.transform="translateY(0)",C.target.style.boxShadow="0 4px 6px rgba(33, 150, 243, 0.25)")},onMouseOver:C=>{r||(C.target.style.background="#1976D2")},onMouseOut:C=>{r||(C.target.style.background="#2196F3")},children:r?u.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[u.jsxs("svg",{className:"animate-spin",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px",animation:"spin 1s linear infinite"},children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",strokeOpacity:"0.25"}),u.jsx("path",{d:"M4 12a8 8 0 018-8",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),"Verifying Name..."]}):"Access Game"})]}),u.jsxs("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[u.jsx("p",{style:{fontSize:"14px",color:"#718096",marginBottom:"12px"},children:"Having trouble? Contact your instructor:"}),u.jsxs("p",{style:{fontSize:"16px",color:"#2196F3",fontWeight:"500"},children:["Park Sinchaisri",u.jsx("br",{}),u.jsx("a",{href:"mailto:parksinchaisri@haas.berkeley.edu",style:{color:"#2196F3",textDecoration:"none",borderBottom:"1px solid #2196F3",fontSize:"15px"},children:"parksinchaisri@haas.berkeley.edu"})]}),l&&u.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#f7fafc",borderRadius:"8px",fontSize:"11px",color:"#4a5568",lineHeight:"1.8"},children:[u.jsx("strong",{children:"Test Codes:"}),u.jsxs("div",{style:{marginTop:"8px",fontFamily:"monospace"},children:[u.jsx("div",{children:"ADMIN (Standard Game Mode)"}),u.jsx("div",{children:"MASTER (Master interface)"})]})]})]})]}),u.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const tm={async checkDailyLimit(t){var r;if(!t)return{allowed:!0};const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);try{const s=Si(nt,"sessions"),i=tI(s,Kg("studentId","==",t),Kg("startTime",">=",n)),a=await Sl(i);if(!a.empty){const l=a.docs[0].data(),c=(r=l.startTime)!=null&&r.toDate?l.startTime.toDate():new Date(l.clientStartTime);return{allowed:!1,reason:"daily_limit",existingSession:l,nextAvailable:new Date(n.getTime()+24*60*60*1e3)}}return{allowed:!0}}catch(s){console.error("Error checking daily limit:",s);const i=`played_${t}_${n.toISOString().split("T")[0]}`;return localStorage.getItem(i)?{allowed:!1,reason:"daily_limit",nextAvailable:new Date(n.getTime()+24*60*60*1e3)}:{allowed:!0}}},async markDailyPlay(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=`played_${t}_${n.toISOString().split("T")[0]}`;localStorage.setItem(r,"true");const s=new Date(Date.now()-7*24*60*60*1e3);for(let i=0;i<localStorage.length;i++){const a=localStorage.key(i);if(a&&a.startsWith("played_")){const l=a.split("_")[2];l&&new Date(l)<s&&localStorage.removeItem(a)}}},async checkAccess(){try{const t=ru.getCodeFromURL();if(!t)return{allowed:!1,reason:"Please login with your student ID",requiresCode:!0};const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),n=e.role==="admin"||e.role==="master_admin";if(!n&&e.studentId){const r=await this.checkDailyLimit(e.studentId);if(!r.allowed&&!r.refreshGranted){const i=r.nextAvailable;return{allowed:!1,reason:`You have already completed today's session. Please come back in ${Math.ceil((i-Date.now())/(1e3*60*60))} hours (after midnight).`,dailyLimitReached:!0,nextAvailable:i}}if(sessionStorage.getItem("activeSessionId"))return{allowed:!1,reason:"Page refresh is not allowed during the game. Your session has been terminated.",refreshAttempt:!0}}return e.studentId?(n||await this.markDailyPlay(e.studentId),{allowed:!0,newSession:!0,code:t,codeData:{status:"new",metadata:e},isAdmin:n}):{allowed:!1,reason:"Please login with your Berkeley student ID",requiresCode:!0}}catch(t){console.error("Error in checkAccess:",t);const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");return e.role==="admin"?{allowed:!0,newSession:!0,code:ru.getCodeFromURL(),codeData:{status:"error_bypass",metadata:e},isAdmin:!0}:{allowed:!1,reason:"System error. Please try again.",requiresCode:!0}}},async createSession(t=null,e=null,n=!1){try{const r=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),s=r.role==="admin"||r.role==="master_admin",i={id:crypto.randomUUID(),accessCode:t,studentId:r.studentId||null,role:r.role||"student",semesterDuration:r.semesterDuration||72e4,displayName:r.displayName||"Student",startTime:jn(),clientStartTime:new Date().toISOString(),status:"active",completedTasks:{},isPractice:n,isAdminSession:s,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`,section:r.section,hasAI:r.hasAI,checkpointSemester2:r.checkpointSemester2},l=(await Yv(Si(nt,"sessions"),i)).id;return localStorage.setItem("sessionId",l),sessionStorage.setItem("activeSessionId",l),s||(window.addEventListener("beforeunload",c=>{c.preventDefault(),c.returnValue="Your progress will be lost if you leave this page.",this.handleSessionAbandonment()}),document.addEventListener("visibilitychange",()=>{!s&&document.hidden})),l}catch(r){console.error("Error creating session:",r);const s=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(s.role==="admin"){const i="offline-"+Date.now();localStorage.setItem("sessionId",i),sessionStorage.setItem("activeSessionId",i);const a={id:i,accessCode:t,startTime:Date.now(),status:"active",isOffline:!0,studentId:s.studentId||null,role:s.role||"admin"};return localStorage.setItem("offlineSession",JSON.stringify(a)),i}throw r}},async handleSessionAbandonment(){const t=localStorage.getItem("sessionId");if(t&&!t.startsWith("offline-"))try{await ur(Mt(nt,"sessions",t),{status:"abandoned",abandonedAt:jn(),abandonReason:"page_unload"})}catch(e){console.error("Error marking session as abandoned:",e)}sessionStorage.removeItem("activeSessionId"),sessionStorage.removeItem("gameConfig")}};function _I(){const[t,e]=M.useState(""),[n,r]=M.useState(!1),[s,i]=M.useState(""),[a,l]=M.useState(!1),c=async()=>{r(!0),i(""),l(!1);try{const p=await ru.createCode({createdBy:"admin",timestamp:new Date().toISOString()});p.success?e(p.code):i("Failed to generate code: "+p.error)}catch(p){i("Error: "+p.message)}finally{r(!1)}},h=()=>{const p=`${window.location.origin}?code=${t}`;navigator.clipboard.writeText(p),l(!0),setTimeout(()=>l(!1),2e3)};return u.jsxs("div",{style:{padding:"40px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, -apple-system, sans-serif"},children:[u.jsx("h1",{style:{color:"#333",marginBottom:"10px"},children:"Admin Dashboard"}),u.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:"Generate access codes for participants"}),u.jsxs("div",{style:{background:"#f8f9fa",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("button",{onClick:c,disabled:n,style:{padding:"12px 30px",fontSize:"16px",background:n?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:"bold"},children:n?"Generating...":"Generate New Access Code"}),t&&u.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"white",borderRadius:"6px",border:"1px solid #e0e0e0"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Generated Code"}),u.jsxs("div",{style:{marginBottom:"20px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Access Code:"}),u.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"18px",fontWeight:"bold"},children:t})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Full URL:"}),u.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"stretch"},children:[u.jsx("input",{type:"text",value:`${window.location.origin}?code=${t}`,readOnly:!0,style:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",background:"#f9f9f9"}}),u.jsx("button",{onClick:h,style:{padding:"10px 20px",background:a?"#4CAF50":"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:a?" Copied!":"Copy URL"})]})]}),u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"4px",fontSize:"14px",color:"#1976d2"},children:[u.jsx("strong",{children:"Note:"})," This code is valid for 24 hours and can only be used once."]})]}),s&&u.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"#ffebee",color:"#c62828",borderRadius:"4px"},children:s})]}),u.jsxs("div",{style:{marginTop:"40px",padding:"20px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666"},children:[u.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"How to use:"}),u.jsxs("ol",{style:{margin:"10px 0",paddingLeft:"20px"},children:[u.jsx("li",{children:"Generate a code using the button above"}),u.jsx("li",{children:"Copy the full URL"}),u.jsx("li",{children:"Share the URL with participants"}),u.jsx("li",{children:"Each participant can use their unique code once"})]})]})]})}function wI({sessionId:t,completedLevels:e,totalTime:n,gameMode:r}){const[s,i]=M.useState(""),[a,l]=M.useState(!1);M.useEffect(()=>{c()},[]);const c=()=>{const p=Date.now().toString(36).toUpperCase(),m=e.toString().padStart(2,"0"),y=r.limit==="time"?"T":"A",C=r.accuracy==="strict"?"S":"L",z=`GAME-${`${t}-${m}-${n}`.split("").reduce((A,w)=>A+w.charCodeAt(0),0).toString(36).toUpperCase().slice(-3)}-${m}-${y}${C}-${p}`;i(z)},h=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(s),l(!0),setTimeout(()=>l(!1),3e3);else{const p=document.createElement("textarea");p.value=s,p.style.position="fixed",p.style.top="0",p.style.left="0",p.style.width="2em",p.style.height="2em",p.style.padding="0",p.style.border="none",p.style.outline="none",p.style.boxShadow="none",p.style.background="transparent",p.style.opacity="0",document.body.appendChild(p),p.focus(),p.select();try{document.execCommand("copy")?(l(!0),setTimeout(()=>l(!1),3e3)):(console.error("Failed to copy using execCommand"),alert("Copy failed. Please manually select and copy the code."))}catch(m){console.error("Failed to copy:",m),alert("Copy failed. Please manually select and copy the code.")}document.body.removeChild(p)}}catch(p){console.error("Clipboard operation failed:",p),alert(`Copy failed. Here's your code to copy manually:

${s}`)}};return u.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"30px",marginTop:"30px",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},children:[u.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:" Your Completion Code"}),u.jsx("p",{style:{marginBottom:"20px",opacity:.9,fontSize:"16px"},children:"Copy this code and paste it into the Qualtrics survey to verify your completion:"}),u.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"20px",marginBottom:"20px",backdropFilter:"blur(10px)"},children:[u.jsx("div",{style:{fontFamily:"monospace",fontSize:"28px",fontWeight:"bold",letterSpacing:"2px",marginBottom:"15px",wordBreak:"break-all",textShadow:"2px 2px 4px rgba(0,0,0,0.2)",userSelect:"text",cursor:"text"},onClick:p=>{const m=window.getSelection(),y=document.createRange();y.selectNodeContents(p.currentTarget),m.removeAllRanges(),m.addRange(y)},title:"Click to select all text",children:s}),u.jsx("button",{onClick:h,style:{padding:"12px 30px",fontSize:"16px",fontWeight:"bold",background:a?"#4CAF50":"white",color:a?"white":"#764ba2",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:a?" Copied!":" Copy Code"})]}),u.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:"6px",padding:"15px",fontSize:"14px",lineHeight:"1.5"},children:[u.jsx("strong",{children:" Important:"})," This code is your proof of completion. Make sure to copy it before closing this window!",u.jsx("br",{}),u.jsx("span",{style:{fontSize:"13px",opacity:.9},children:" Tip: If the Copy button doesn't work, click on the code text to select it, then use Ctrl+C (or Cmd+C on Mac) to copy."})]}),u.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[u.jsx("summary",{style:{cursor:"pointer",opacity:.8,fontSize:"12px",marginBottom:"10px"},children:"Code Details "}),u.jsxs("div",{style:{fontSize:"12px",opacity:.7,background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",fontFamily:"monospace"},children:[u.jsxs("div",{children:["Levels Completed: ",e,"/45"]}),u.jsxs("div",{children:["Game Mode: ",r.limit==="time"?"Time Challenge":"Task Attempts"]}),u.jsxs("div",{children:["Accuracy Mode: ",r.accuracy==="strict"?"Strict (100%)":"Lenient"]}),u.jsxs("div",{children:["Total Time: ",Math.floor(n/60),"m ",n%60,"s"]}),u.jsxs("div",{children:["Generated: ",new Date().toLocaleString()]})]})]})]})}function SI({onClose:t}){const[e,n]=M.useState("config"),[r,s]=M.useState([]),[i,a]=M.useState(!0),[l,c]=M.useState(!1),[h,p]=M.useState(""),[m,y]=M.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,wrongAnswerPenalty:2,switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0,taskOrderStrategy:"sequential_task",difficultyMode:"fixed",scoring:{g1:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g2:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g3:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}}}}),[C,k]=M.useState(!1);M.useEffect(()=>{P(),V()},[]);const P=async()=>{try{const v=Mt(nt,"game_settings","global"),R=await Sf(v);R.exists()&&y({...m,...R.data()})}catch(v){console.error("Error loading game config:",v)}},z=async()=>{k(!0);try{const v=Mt(nt,"game_settings","global");await zd(v,m,{merge:!0}),alert("Configuration saved successfully!")}catch(v){console.error("Error saving config:",v),alert("Failed to save configuration")}finally{k(!1)}},A=(v,R)=>{y(_=>({..._,[v]:R}))},[w,T]=M.useState([]),V=async()=>{a(!0);try{const v=Si(nt,"students"),R=await Sl(v),_={};R.docs.forEach(D=>{_[D.id]={id:D.id,...D.data()}});const ee=Si(nt,"sessions"),Z=await Sl(ee),ce=Z.docs.map(D=>({id:D.id,...D.data()}));T(ce),console.log(`Debug: Found ${R.size} students and ${Z.size} sessions`);const U={};Z.docs.forEach(D=>{var q;const L=D.data(),O=L.studentId;if(!O)return;U[O]||(U[O]={totalAccesses:0,scores:[],hasPlayed:!1,lastPlayed:null,section:L.section||"Unknown",sid:O}),U[O].totalAccesses+=1,U[O].hasPlayed=!0;const Y=(q=L.startTime)!=null&&q.toDate?L.startTime.toDate():new Date(L.clientStartTime||0);(!U[O].lastPlayed||Y>U[O].lastPlayed)&&(U[O].lastPlayed=Y),L.finalScore!==void 0&&U[O].scores.push({total:L.finalScore,learning:L.studentLearningScore,timestamp:L.completedAt})});const b=Object.values(_).map(D=>{const L=U[D.id]||{};return{...D,...L,scores:L.scores||D.scores||[],totalAccesses:L.totalAccesses||0,hasPlayed:L.hasPlayed||!1,lastPlayed:L.lastPlayed||null}});Object.keys(U).forEach(D=>{_[D]||b.push({id:D,sid:D,...U[D]})}),b.sort((D,L)=>{const O=D.lastPlayed?D.lastPlayed.getTime():0;return(L.lastPlayed?L.lastPlayed.getTime():0)-O}),s(b)}catch(v){console.error("Error fetching students:",v)}finally{a(!1)}},$=async()=>{if(window.confirm("Are you sure you want to reset ALL student data? This cannot be undone!")){c(!0);try{const v=Si(nt,"students"),R=await Sl(v);for(const _ of R.docs)await zd(Mt(nt,"students",_.id),{hasPlayed:!1,totalAccesses:0,scores:[]},{merge:!0});alert("All student data has been reset!"),await V()}catch(v){console.error("Error resetting data:",v),alert("Failed to reset data")}finally{c(!1)}}},j=()=>{const v=["Student ID","Section","Has Played","Last Played","Total Accesses","Highest Score"],R=r.filter(U=>{var b;return!((b=U.section)!=null&&b.includes("ADMIN"))}).map(U=>{const b=U.scores&&U.scores.length>0?Math.max(...U.scores.map(D=>D.total||0)):0;return[U.sid||U.id||"",U.section||"N/A",U.hasPlayed?"Yes":"No",U.lastPlayed?new Date(U.lastPlayed).toLocaleString():"-",U.totalAccesses||0,b]}),_=[v.join(","),...R.map(U=>U.map(b=>`"${String(b).replace(/"/g,'""')}"`).join(","))].join(`
`),ee=new Blob([_],{type:"text/csv;charset=utf-8;"}),Z=document.createElement("a"),ce=URL.createObjectURL(ee);Z.setAttribute("href",ce),Z.setAttribute("download",`student_data_${new Date().toISOString().split("T")[0]}.csv`),Z.style.visibility="hidden",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)},E=()=>{const v=["Session ID","Student ID","Section","Start Time","Status","Final Score","Student Learning Score","Completed Tasks","Random Seed"],R=w.map(U=>{var L;const b=(L=U.startTime)!=null&&L.toDate?U.startTime.toDate().toLocaleString():U.clientStartTime?new Date(U.clientStartTime).toLocaleString():"-",D=U.completedTasks?Object.keys(U.completedTasks).length:0;return[U.id||"",U.studentId||"",U.section||"N/A",b,U.status||"unknown",U.finalScore!==void 0?U.finalScore:"",U.studentLearningScore!==void 0?U.studentLearningScore:"",D,U.randomSeed||""]}),_=[v.join(","),...R.map(U=>U.map(b=>`"${String(b).replace(/"/g,'""')}"`).join(","))].join(`
`),ee=new Blob([_],{type:"text/csv;charset=utf-8;"}),Z=document.createElement("a"),ce=URL.createObjectURL(ee);Z.setAttribute("href",ce),Z.setAttribute("download",`sessions_data_${new Date().toISOString().split("T")[0]}.csv`),Z.style.visibility="hidden",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)},g=v=>({padding:"12px 24px",background:v?"#2196F3":"transparent",color:v?"white":"#666",border:"none",borderBottom:v?"3px solid #2196F3":"3px solid transparent",cursor:"pointer",fontSize:"14px",fontWeight:v?"600":"normal",transition:"all 0.2s"}),S=r.filter(v=>{var R;return!((R=v.section)!=null&&R.includes("ADMIN"))}).length,I=r.filter(v=>{var R;return!((R=v.section)!=null&&R.includes("ADMIN"))&&v.hasPlayed}).length;return u.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h1",{style:{margin:0,color:"#333"},children:" Master Admin Dashboard"}),u.jsx("button",{onClick:t,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:"Exit Admin"})]}),u.jsxs("div",{style:{display:"flex",borderBottom:"1px solid #e0e0e0",marginBottom:"30px"},children:[u.jsx("button",{onClick:()=>n("config"),style:g(e==="config"),children:" Game Configuration"}),u.jsx("button",{onClick:()=>n("players"),style:g(e==="players"),children:" Player Data"}),u.jsx("button",{onClick:()=>n("advice"),style:g(e==="advice"),children:" Game Advice"})]}),e==="config"&&u.jsxs("div",{children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"20px",marginBottom:"20px"},children:[u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Time & Semesters"}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Semester Duration (Minutes)"}),u.jsx("input",{type:"number",value:m.semesterDuration,onChange:v=>A("semesterDuration",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Semesters"}),u.jsx("input",{type:"number",value:m.totalSemesters,onChange:v=>A("totalSemesters",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("input",{type:"checkbox",checked:m.midtermEnabled,onChange:v=>A("midtermEnabled",v.target.checked),id:"midtermCheck"}),u.jsx("label",{htmlFor:"midtermCheck",style:{fontSize:"13px",cursor:"pointer"},children:"Enable Midterm Checkpoint"})]})]}),u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Task Settings"}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Tasks per Semester"}),u.jsx("input",{type:"number",value:m.totalTasks,onChange:v=>A("totalTasks",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Difficulty Configuration"}),u.jsxs("select",{value:m.difficultyMode||"fixed",onChange:v=>A("difficultyMode",v.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[u.jsx("option",{value:"fixed",children:"Fixed (50% Easy, 30% Medium, 20% Hard)"}),u.jsx("option",{value:"manual",children:"Manual (User chooses difficulty)"})]})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Task Order Strategy"}),u.jsxs("select",{value:m.taskOrderStrategy,onChange:v=>A("taskOrderStrategy",v.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[u.jsx("option",{value:"sequential_task",children:"Order by Task (Materials  Research  Engagement)"}),u.jsx("option",{value:"sequential_difficulty",children:"Order by Difficulty (Easy  Medium  Hard)"})]})]}),u.jsxs("div",{style:{marginTop:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Game Mode"}),u.jsxs("select",{value:m.gameMode||"knapsack",onChange:v=>A("gameMode",v.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[u.jsx("option",{value:"knapsack",children:"Knapsack Mode (Allocate tasks upfront, limited tasks)"}),u.jsx("option",{value:"sequential",children:"Sequential Mode (Infinite levels, countdown timer)"})]}),u.jsx("p",{style:{fontSize:"11px",color:"#666",marginTop:"5px"},children:"Sequential mode: Timer counts down, infinite levels, can keep playing until time runs out."})]})]}),u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Penalties & Mechanics"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Switch Cost (Points)"}),u.jsx("input",{type:"number",value:m.switchCost||0,onChange:v=>A("switchCost",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Refill Freeze (Seconds)"}),u.jsx("input",{type:"number",value:m.jarRefillFreezeTime||0,onChange:v=>A("jarRefillFreezeTime",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Unfinished Jar Penalty (Pts)"}),u.jsx("input",{type:"number",value:m.unfinishedJarPenalty||0,onChange:v=>A("unfinishedJarPenalty",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"AI Delay (Seconds)"}),u.jsx("input",{type:"number",value:m.aiDelay||0,onChange:v=>A("aiDelay",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]})]})]}),u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",marginTop:"20px"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Scoring Configuration"}),u.jsx("p",{style:{fontSize:"12px",color:"#666",marginBottom:"20px"},children:'Configure points for each task type and difficulty level. "Full Correct" = perfect answer, "Half Correct" = partial credit.'}),["g1","g2","g3"].map(v=>{const R={g1:"Research (Counting)",g2:"Materials (Slider)",g3:"Engagement (Typing)"},_={g1:"",g2:"",g3:""},ee={g1:"#9C27B0",g2:"#4CAF50",g3:"#f44336"};return u.jsxs("div",{style:{marginBottom:"25px",padding:"15px",background:"#f9f9f9",borderRadius:"8px"},children:[u.jsxs("div",{style:{fontWeight:"bold",marginBottom:"12px",color:ee[v],display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{children:_[v]}),u.jsx("span",{children:R[v]})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px"},children:["easy","medium","hard"].map(Z=>{var U,b,D,L,O,Y;const ce={easy:"Easy",medium:"Medium",hard:"Hard"};return u.jsxs("div",{style:{background:"white",padding:"12px",borderRadius:"6px",border:"1px solid #ddd"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",marginBottom:"8px",color:"#666"},children:ce[Z]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",fontSize:"11px",marginBottom:"4px",color:"#666"},children:"Full Correct"}),u.jsx("input",{type:"number",min:"0",value:((D=(b=(U=m.scoring)==null?void 0:U[v])==null?void 0:b[Z])==null?void 0:D.fullCorrect)??2,onChange:q=>{const ne=parseInt(q.target.value)||0;y(oe=>{var ye,ge,Te;return{...oe,scoring:{...oe.scoring,[v]:{...(ye=oe.scoring)==null?void 0:ye[v],[Z]:{...(Te=(ge=oe.scoring)==null?void 0:ge[v])==null?void 0:Te[Z],fullCorrect:ne}}}}})},style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",fontSize:"11px",marginBottom:"4px",color:"#666"},children:"Half Correct"}),u.jsx("input",{type:"number",min:"0",value:((Y=(O=(L=m.scoring)==null?void 0:L[v])==null?void 0:O[Z])==null?void 0:Y.halfCorrect)??1,onChange:q=>{const ne=parseInt(q.target.value)||0;y(oe=>{var ye,ge,Te;return{...oe,scoring:{...oe.scoring,[v]:{...(ye=oe.scoring)==null?void 0:ye[v],[Z]:{...(Te=(ge=oe.scoring)==null?void 0:ge[v])==null?void 0:Te[Z],halfCorrect:ne}}}}})},style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]})]},Z)})})]},v)})]}),u.jsx("div",{style:{textAlign:"right",marginTop:"20px"},children:u.jsx("button",{onClick:z,disabled:C,style:{padding:"12px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:C?"not-allowed":"pointer",fontWeight:"600",fontSize:"14px",opacity:C?.6:1},children:C?"Saving...":" Save Settings"})})]}),e==="players"&&u.jsxs("div",{style:{background:"white",padding:"25px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Active Sessions"}),u.jsxs("div",{style:{display:"flex",gap:"10px"},children:[u.jsx("button",{onClick:j,style:{padding:"10px 20px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:" Download Student Data"}),u.jsx("button",{onClick:E,style:{padding:"10px 20px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:" Download Sessions Data"}),u.jsx("button",{onClick:$,disabled:l,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:l?"not-allowed":"pointer",fontWeight:"500",opacity:l?.6:1},children:l?"Processing...":" Reset All Data"})]})]}),u.jsx("div",{style:{marginBottom:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"6px"},children:u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",textAlign:"center"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:S}),u.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Total Students"})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:I}),u.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Have Played"})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:S-I}),u.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Never Played"})]})]})}),i?u.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"Loading student data..."}):u.jsx("div",{style:{overflowX:"auto"},children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{background:"#f5f5f5",textAlign:"left"},children:[u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Student ID"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Section"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Has Played"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Last Played"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Total Accesses"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Highest Score"})]})}),u.jsx("tbody",{children:r.filter(v=>{var R;return!((R=v.section)!=null&&R.includes("ADMIN"))}).map(v=>u.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[u.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:v.sid||v.id}),u.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:v.section||"N/A"}),u.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:u.jsx("span",{style:{padding:"4px 12px",borderRadius:"12px",background:v.hasPlayed?"#e8f5e9":"#f5f5f5",color:v.hasPlayed?"#4CAF50":"#999",fontSize:"12px",fontWeight:"500"},children:v.hasPlayed?"Yes":"No"})}),u.jsx("td",{style:{padding:"12px",fontSize:"13px",color:"#666"},children:v.lastPlayed?new Date(v.lastPlayed).toLocaleString():"-"}),u.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600"},children:v.totalAccesses||0}),u.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600",color:"#2196F3"},children:v.scores&&v.scores.length>0?Math.max(...v.scores.map(R=>R.total||0)):0})]},v.id))})]})})]}),e==="advice"&&u.jsxs("div",{style:{background:"white",padding:"60px 40px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),u.jsx("h2",{style:{fontSize:"24px",color:"#666",marginBottom:"15px",fontWeight:"500"},children:"Game Advice Configuration"}),u.jsx("p",{style:{color:"#999",maxWidth:"600px",margin:"0 auto 30px",lineHeight:"1.6"},children:"Configure contextual advice prompts based on remaining time and tasks completed. This feature will allow you to define dynamic advice messages for different game states."}),u.jsxs("div",{style:{marginTop:"40px",padding:"30px",background:"#f9f9f9",borderRadius:"8px",maxWidth:"500px",margin:"40px auto 0",border:"2px dashed #ddd"},children:[u.jsx("p",{style:{color:"#666",fontSize:"15px",margin:0,fontWeight:"500"},children:"Coming Soon: Dynamic 2D Advice Matrix"}),u.jsx("p",{style:{color:"#999",fontSize:"13px",margin:"10px 0 0",lineHeight:"1.5"},children:"Define advice based on time remaining  tasks completed thresholds"})]})]})]})}const EI={notifyGameComplete(t={}){try{window.parent.postMessage({type:"gameComplete",status:"finished",timestamp:new Date().toISOString(),...t},"*");try{if(window.parent&&window.parent.document){const e=window.parent.document.querySelector("#NextButton");e&&(e.style.display="inline-block",e.style.visibility="visible",e.disabled=!1)}}catch{window.parent.postMessage({type:"showNextButton",action:"show"},"*")}console.log(" Game completion notification sent to Qualtrics")}catch(e){console.error("Failed to notify Qualtrics:",e)}},notifySemesterComplete(t,e,n={}){try{window.parent.postMessage({type:"semesterComplete",semester:t,totalSemesters:e,timestamp:new Date().toISOString(),...n},"*"),window.parent.postMessage({type:"keepNextButtonVisible",action:"maintain"},"*"),console.log(` Semester ${t} completion notification sent`)}catch(r){console.error("Failed to notify Qualtrics of semester completion:",r)}},ensureNextButtonVisible(){try{window.parent.postMessage({type:"ensureNextButton",action:"show",timestamp:new Date().toISOString()},"*")}catch(t){console.error("Failed to ensure Next button visibility:",t)}}};function TI({onStart:t,totalTasks:e=10,orderStrategy:n="sequential_task",durationMinutes:r=12,difficultyMode:s="fixed"}){const[i,a]=M.useState({g2:0,g1:0,g3:0}),[l,c]=M.useState({g2:{easy:0,medium:0,hard:0},g1:{easy:0,medium:0,hard:0},g3:{easy:0,medium:0,hard:0}}),[h,p]=M.useState([]),[m,y]=M.useState(0),[C,k]=M.useState(null),P=["It's generally smart to do roughly an even number of each task.","This is because the tasks that are worth more points take more time to do, so you don't want to only do the shorter tasks or only do the longer tasks.","Of course, you might prefer one task over another, so you could take that into account. Do you feel like you are particularly good at one of the tasks?"],z=()=>{m<P.length?(p(g=>[...g,{sender:"AI",text:P[m]}]),y(g=>g+1)):p(g=>[...g,{sender:"AI",text:"I've shared my best advice! It's up to you now."}])},A=(g,S)=>{const I=parseInt(S)||0;a(v=>({...v,[g]:Math.max(0,I)})),k(null)},w=(g,S,I)=>{const v=parseInt(I)||0;c(R=>({...R,[g]:{...R[g],[S]:Math.max(0,v)}})),k(null)},$=s==="manual"?(()=>{let g=0;return Object.values(l).forEach(S=>{g+=S.easy+S.medium+S.hard}),g})():Object.values(i).reduce((g,S)=>g+S,0),j=$===e,E=()=>{if($!==e){k(`Total tasks must equal ${e}. Currently: ${$}`);return}let g=[];s==="fixed"?["g2","g1","g3"].forEach(ee=>{const Z=i[ee];if(Z>0){const ce=Z*.5,U=Z*.3,b=Z*.2;let D=Math.floor(ce),L=Math.floor(U),O=Math.floor(b),Y=Z-D-L-O;for(;Y>0;){const ne=ce-D,oe=U-L,ye=b-O;ne>=oe&&ne>=ye?D++:oe>=ye?L++:O++,Y--}const q=D+L+O;if(q!==Z){const ne=Z-q;ne>0?D+=ne:D=Math.max(0,D+ne)}for(let ne=0;ne<D;ne++)g.push({type:ee,difficulty:"easy"});for(let ne=0;ne<L;ne++)g.push({type:ee,difficulty:"medium"});for(let ne=0;ne<O;ne++)g.push({type:ee,difficulty:"hard"})}}):["g2","g1","g3"].forEach(ee=>{const{easy:Z,medium:ce,hard:U}=l[ee];for(let b=0;b<Z;b++)g.push({type:ee,difficulty:"easy"});for(let b=0;b<ce;b++)g.push({type:ee,difficulty:"medium"});for(let b=0;b<U;b++)g.push({type:ee,difficulty:"hard"})});const S={g2:{easy:1,medium:6,hard:11},g1:{easy:1,medium:6,hard:11},g3:{easy:1,medium:6,hard:11}},I=g.map(ee=>{const{type:Z,difficulty:ce}=ee,U=S[Z][ce]++;return{...ee,id:`${Z}t${U}`}});let v=[];if(n==="sequential_difficulty"){const ee={easy:1,medium:2,hard:3},Z={g2:1,g1:2,g3:3};v=I.sort((ce,U)=>ee[ce.difficulty]!==ee[U.difficulty]?ee[ce.difficulty]-ee[U.difficulty]:Z[ce.type]-Z[U.type])}else{const ee={g2:1,g1:2,g3:3},Z={easy:1,medium:2,hard:3};v=I.sort((ce,U)=>ee[ce.type]!==ee[U.type]?ee[ce.type]-ee[U.type]:Z[ce.difficulty]-Z[U.difficulty])}const R=v.map(ee=>ee.id),_=s==="fixed"?i:{g2:l.g2.easy+l.g2.medium+l.g2.hard,g1:l.g1.easy+l.g1.medium+l.g1.hard,g3:l.g3.easy+l.g3.medium+l.g3.hard};t(R,_)};return u.jsxs("div",{style:{maxWidth:"900px",margin:"40px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[u.jsx("h1",{style:{textAlign:"center",marginBottom:"30px",color:"#333"},children:"Task Allocation Strategy"}),u.jsxs("div",{style:{marginBottom:"30px",lineHeight:"1.6",color:"#555"},children:[u.jsxs("p",{children:["You have ",u.jsxs("strong",{children:[r," minutes"]})," to complete ",u.jsxs("strong",{children:[e," tasks"]}),"."]}),u.jsx("p",{children:"You must decide now how many of each task type you want to perform."}),u.jsxs("p",{children:["Total tasks must add up to ",u.jsx("strong",{children:e}),"."]}),s==="fixed"&&u.jsx("p",{style:{fontSize:"14px",fontStyle:"italic",color:"#666"},children:"* Within each task type, tasks are distributed as 50% Easy, 30% Medium, 20% Hard."})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"40px",marginBottom:"40px"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[s==="fixed"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:Ec,children:[u.jsxs("label",{style:Tc,children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 1: Slider (Materials)"]}),u.jsx("input",{type:"number",min:"0",max:e,value:i.g2,onChange:g=>A("g2",g.target.value),style:Ic})]}),u.jsxs("div",{style:Ec,children:[u.jsxs("label",{style:Tc,children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 2: Counting (Research)"]}),u.jsx("input",{type:"number",min:"0",max:e,value:i.g1,onChange:g=>A("g1",g.target.value),style:Ic})]}),u.jsxs("div",{style:Ec,children:[u.jsxs("label",{style:Tc,children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 3: Typing (Engagement)"]}),u.jsx("input",{type:"number",min:"0",max:e,value:i.g3,onChange:g=>A("g3",g.target.value),style:Ic})]})]}):u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px"},children:[u.jsx(or,{icon:"",taskName:"Materials",difficulty:"Easy",value:l.g2.easy,onChange:g=>w("g2","easy",g),color:"#4CAF50"}),u.jsx(or,{icon:"",taskName:"Materials",difficulty:"Medium",value:l.g2.medium,onChange:g=>w("g2","medium",g),color:"#4CAF50"}),u.jsx(or,{icon:"",taskName:"Materials",difficulty:"Hard",value:l.g2.hard,onChange:g=>w("g2","hard",g),color:"#4CAF50"}),u.jsx(or,{icon:"",taskName:"Research",difficulty:"Easy",value:l.g1.easy,onChange:g=>w("g1","easy",g),color:"#9C27B0"}),u.jsx(or,{icon:"",taskName:"Research",difficulty:"Medium",value:l.g1.medium,onChange:g=>w("g1","medium",g),color:"#9C27B0"}),u.jsx(or,{icon:"",taskName:"Research",difficulty:"Hard",value:l.g1.hard,onChange:g=>w("g1","hard",g),color:"#9C27B0"}),u.jsx(or,{icon:"",taskName:"Engagement",difficulty:"Easy",value:l.g3.easy,onChange:g=>w("g3","easy",g),color:"#f44336"}),u.jsx(or,{icon:"",taskName:"Engagement",difficulty:"Medium",value:l.g3.medium,onChange:g=>w("g3","medium",g),color:"#f44336"}),u.jsx(or,{icon:"",taskName:"Engagement",difficulty:"Hard",value:l.g3.hard,onChange:g=>w("g3","hard",g),color:"#f44336"})]}),u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:j?"#e8f5e9":"#ffebee",borderRadius:"8px",textAlign:"center",fontWeight:"bold",color:j?"#2e7d32":"#c62828"},children:["Total Allocated: ",$," / ",e]}),C&&u.jsx("div",{style:{color:"red",textAlign:"center",fontSize:"14px"},children:C})]}),u.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"12px",padding:"20px",display:"flex",flexDirection:"column"},children:[u.jsxs("div",{style:{flex:1,marginBottom:"15px",overflowY:"auto",maxHeight:"300px",display:"flex",flexDirection:"column",gap:"10px"},children:[h.length===0&&u.jsx("div",{style:{color:"#999",fontStyle:"italic",textAlign:"center",marginTop:"40px"},children:"Need advice? Ask the AI helper."}),h.map((g,S)=>u.jsxs("div",{style:{background:"#f0f7ff",padding:"10px 15px",borderRadius:"12px 12px 12px 0",alignSelf:"flex-start",maxWidth:"90%"},children:[u.jsx("strong",{children:" AI:"})," ",g.text]},S))]}),u.jsxs("button",{onClick:z,style:{background:"#2196F3",color:"white",border:"none",padding:"12px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[u.jsx("span",{children:""})," Ask AI for Recommendation"]})]})]}),u.jsx("div",{style:{textAlign:"center"},children:u.jsx("button",{onClick:E,disabled:!j,style:{background:j?"#4CAF50":"#ccc",color:"white",border:"none",padding:"15px 40px",fontSize:"18px",borderRadius:"30px",cursor:j?"pointer":"not-allowed",fontWeight:"bold",boxShadow:j?"0 4px 15px rgba(76, 175, 80, 0.3)":"none",transition:"all 0.2s"},children:"Start Experiment"})})]})}const or=({icon:t,taskName:e,difficulty:n,value:r,onChange:s,color:i})=>u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",background:"#f9f9f9",padding:"20px",borderRadius:"12px",border:`2px solid ${i}40`,transition:"all 0.2s"},children:[u.jsx("div",{style:{fontSize:"24px",marginBottom:"8px"},children:t}),u.jsx("div",{style:{fontSize:"14px",fontWeight:"bold",color:i,marginBottom:"4px",textAlign:"center"},children:e}),u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"12px",textAlign:"center"},children:n}),u.jsx("input",{type:"number",min:"0",max:100,value:r,onChange:a=>s(a.target.value),style:{width:"70px",padding:"12px",textAlign:"center",border:`2px solid ${i}`,borderRadius:"8px",fontSize:"18px",fontWeight:"bold",color:i,background:"white"}})]}),Ec={display:"flex",alignItems:"center",justifyContent:"space-between",background:"#f9f9f9",padding:"15px",borderRadius:"8px"},Tc={fontWeight:"bold",color:"#333",display:"flex",alignItems:"center"},Ic={width:"60px",padding:"10px",fontSize:"18px",textAlign:"center",borderRadius:"6px",border:"1px solid #ddd"};function II({currentTaskIndex:t,totalTasks:e,taskQueue:n,onSwitchTask:r,onRefill:s,children:i,points:a,timeRemaining:l,onTimeUp:c,penalties:h={switch:0,refill:0,unfinished:0},chatInterface:p,difficultyMode:m="fixed"}){const y=n[t];(j=>j.startsWith("g1")?{name:"Research",icon:"",color:"#9C27B0",bg:"#f3e5f5"}:j.startsWith("g2")?{name:"Materials",icon:"",color:"#4CAF50",bg:"#e8f5e9"}:j.startsWith("g3")?{name:"Engagement",icon:"",color:"#f44336",bg:"#ffebee"}:{name:"Unknown",icon:"",color:"#333",bg:"#eee"})(y);const k=n.slice(0,t),P={g1:k.filter(j=>j.startsWith("g1")).length,g2:k.filter(j=>j.startsWith("g2")).length,g3:k.filter(j=>j.startsWith("g3")).length},z=e-t,A=n.slice(t),w=j=>{const E=parseInt(j.substring(3))||1;return E<=5?"easy":E<=10?"medium":"hard"};let T;m==="manual"?T={"g2-easy":A.filter(j=>j.startsWith("g2")&&w(j)==="easy"),"g2-medium":A.filter(j=>j.startsWith("g2")&&w(j)==="medium"),"g2-hard":A.filter(j=>j.startsWith("g2")&&w(j)==="hard"),"g1-easy":A.filter(j=>j.startsWith("g1")&&w(j)==="easy"),"g1-medium":A.filter(j=>j.startsWith("g1")&&w(j)==="medium"),"g1-hard":A.filter(j=>j.startsWith("g1")&&w(j)==="hard"),"g3-easy":A.filter(j=>j.startsWith("g3")&&w(j)==="easy"),"g3-medium":A.filter(j=>j.startsWith("g3")&&w(j)==="medium"),"g3-hard":A.filter(j=>j.startsWith("g3")&&w(j)==="hard")}:T={g2:A.filter(j=>j.startsWith("g2")),g1:A.filter(j=>j.startsWith("g1")),g3:A.filter(j=>j.startsWith("g3"))};const V=j=>{if(m==="manual"){const E=w(y);return y.startsWith(j.split("-")[0])&&E===j.split("-")[1]}else return y.startsWith(j)},$=(j,E,g,S,I,v,R=null)=>{const _=v.length,ee=V(j),Z=_>0,ce=m==="manual"?j.split("-")[0]:j;return u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",background:I,borderRadius:"12px",padding:"10px",border:`2px solid ${ee?S:"transparent"}`,height:"100%",position:"relative"},children:[u.jsxs("div",{style:{fontSize:"14px",fontWeight:"bold",color:S,marginBottom:"10px",display:"flex",alignItems:"center",gap:"5px"},children:[u.jsx("span",{children:g}),u.jsx("span",{children:_})]}),u.jsx("div",{style:{flex:1,width:"100%",display:"flex",flexDirection:"column",gap:"5px",justifyContent:"flex-end",paddingBottom:"10px"},children:Z?u.jsx(u.Fragment,{children:v.map((U,b)=>{const D=b===0&&ee;return u.jsx("div",{style:{height:D?"35px":"8px",width:"80%",background:S,opacity:D?1:.4,borderRadius:"4px",margin:"0 auto",display:D?"flex":"block",alignItems:"center",justifyContent:"center",color:D?"white":"transparent",fontSize:"10px",fontWeight:"bold",cursor:D?"default":"pointer"},onClick:!ee&&b===0?()=>r(ce):void 0,children:D?"Current":""},b)})}):u.jsx("button",{onClick:()=>s&&s(ce),style:{width:"100%",padding:"10px 5px",background:"white",border:"2px dashed #999",borderRadius:"8px",color:"#666",cursor:"pointer",fontSize:"12px"},children:" Refill"})}),u.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"5px",textAlign:"center"},children:[E,R&&u.jsx("div",{style:{fontSize:"10px",color:"#999"},children:R})]})]})};return u.jsxs("div",{style:{maxWidth:"95vw",margin:"0 auto",padding:"20px"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"white",padding:"15px 25px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[u.jsx("div",{style:{width:"200px"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""}),u.jsx("div",{children:u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:l<60?"#f44336":"#333",animation:l<60?"pulse 1s infinite":"none"},children:[Math.floor(l/60),":",(l%60).toString().padStart(2,"0")]})})]})}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Points"}),u.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#2196F3"},children:a}),(h.switch>0||h.refill>0||h.unfinished>0)&&u.jsxs("div",{style:{marginTop:"8px",fontSize:"11px",color:"#f44336",display:"flex",gap:"8px",justifyContent:"center",flexWrap:"wrap"},children:[h.switch>0&&u.jsxs("span",{title:"Switch penalties",children:[" -",h.switch]}),h.refill>0&&u.jsxs("span",{title:"Refill penalties",children:[" -",h.refill]}),h.unfinished>0&&u.jsxs("span",{title:"Unfinished task penalties",children:[" -",h.unfinished]})]})]}),u.jsxs("div",{style:{textAlign:"right",minWidth:"300px"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"5px"},children:"Task Progress"}),u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"15px"},children:[u.jsxs("div",{style:{display:"flex",gap:"10px",fontSize:"16px",fontWeight:"500",color:"#555"},children:[u.jsxs("span",{title:"Materials Done",children:[" ",P.g2]}),u.jsx("span",{style:{color:"#ddd"},children:"|"}),u.jsxs("span",{title:"Research Done",children:[" ",P.g1]}),u.jsx("span",{style:{color:"#ddd"},children:"|"}),u.jsxs("span",{title:"Engagement Done",children:[" ",P.g3]})]}),u.jsxs("div",{style:{background:"#eee",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold",color:"#333"},children:["Remaining: ",z]})]})]})]}),u.jsxs("div",{className:"task-runner-layout",style:{display:"grid",gridTemplateColumns:"300px 1fr 340px",gap:"20px",height:"calc(100vh - 140px)",boxSizing:"border-box"},children:[u.jsxs("div",{style:{background:"white",padding:"15px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",height:"fit-content",maxHeight:"100%"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#666",textAlign:"center"},children:"Task Jars"}),m==="manual"?u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",flex:1},children:[$("g2-easy","Materials","","#4CAF50","#e8f5e9",T["g2-easy"],"Easy"),$("g2-medium","Materials","","#4CAF50","#e8f5e9",T["g2-medium"],"Medium"),$("g2-hard","Materials","","#4CAF50","#e8f5e9",T["g2-hard"],"Hard"),$("g1-easy","Research","","#9C27B0","#f3e5f5",T["g1-easy"],"Easy"),$("g1-medium","Research","","#9C27B0","#f3e5f5",T["g1-medium"],"Medium"),$("g1-hard","Research","","#9C27B0","#f3e5f5",T["g1-hard"],"Hard"),$("g3-easy","Engagement","","#f44336","#ffebee",T["g3-easy"],"Easy"),$("g3-medium","Engagement","","#f44336","#ffebee",T["g3-medium"],"Medium"),$("g3-hard","Engagement","","#f44336","#ffebee",T["g3-hard"],"Hard")]}):u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px",flex:1},children:[$("g2","Materials","","#4CAF50","#e8f5e9",T.g2),$("g1","Research","","#9C27B0","#f3e5f5",T.g1),$("g3","Engagement","","#f44336","#ffebee",T.g3)]})]}),u.jsx("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",overflow:"hidden",display:"flex",flexDirection:"column"},children:i}),u.jsx("div",{style:{height:"100%",overflow:"hidden"},children:p&&u.jsx("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:p})})]}),u.jsx("style",{children:`
        @keyframes pulse {
          0% { opacity: 1; }
          50% { opacity: 0.5; }
          100% { opacity: 1; }
        }
      `})]})}function CI({timeRemaining:t,onSelectTask:e,onFinishEarly:n}){return u.jsxs("div",{style:{maxWidth:"800px",margin:"40px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[u.jsx("h1",{style:{color:"#2196F3",marginBottom:"20px"},children:" All Tasks Completed!"}),u.jsxs("div",{style:{fontSize:"18px",color:"#555",marginBottom:"30px",lineHeight:"1.6"},children:[u.jsx("p",{children:"You have finished all 10 allocated tasks with time to spare."}),u.jsxs("p",{children:["You currently have ",u.jsxs("strong",{children:[Math.floor(t/60)," minutes and ",t%60," seconds"]})," remaining."]}),u.jsxs("p",{children:["You can choose to do more tasks for ",u.jsx("strong",{children:"1/2 credit"})," to increase your score, or finish the experiment now."]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"40px"},children:[u.jsxs("button",{onClick:()=>e("g2"),style:Cc("#4CAF50"),children:[u.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Materials Task",u.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),u.jsxs("button",{onClick:()=>e("g1"),style:Cc("#9C27B0"),children:[u.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Research Task",u.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),u.jsxs("button",{onClick:()=>e("g3"),style:Cc("#f44336"),children:[u.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Engagement Task",u.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]})]}),u.jsx("div",{style:{borderTop:"1px solid #eee",paddingTop:"30px"},children:u.jsx("button",{onClick:n,style:{background:"#f5f5f5",color:"#666",border:"1px solid #ddd",padding:"12px 30px",fontSize:"16px",borderRadius:"30px",cursor:"pointer",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:r=>r.target.style.background="#e0e0e0",onMouseLeave:r=>r.target.style.background="#f5f5f5",children:"No thanks, I'm done"})})]})}const Cc=t=>({background:"white",border:`2px solid ${t}`,color:t,padding:"20px",borderRadius:"12px",cursor:"pointer",fontSize:"16px",fontWeight:"bold",transition:"all 0.2s",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"});function AI(t,e){const n=t.length,r=e.length,s=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let i=0;i<=n;i++)s[i][0]=i;for(let i=0;i<=r;i++)s[0][i]=i;for(let i=1;i<=n;i++)for(let a=1;a<=r;a++)t[i-1]===e[a-1]?s[i][a]=s[i-1][a-1]:s[i][a]=Math.min(s[i-1][a]+1,s[i][a-1]+1,s[i-1][a-1]+1);return s[n][r]}function kI(){const e=new URLSearchParams(window.location.search).get("admin")==="berkeley2024",[n,r]=M.useState("landing"),[s,i]=M.useState(null),[a,l]=M.useState(null),[c,h]=M.useState("g2t1"),[p,m]=M.useState({}),[y,C]=M.useState(0),[k,P]=M.useState(null),[z,A]=M.useState(!1),[w,T]=M.useState(""),[V,$]=M.useState(!0),[j,E]=M.useState(0),[g,S]=M.useState({}),[I,v]=M.useState(0),[R,_]=M.useState(0),[ee,Z]=M.useState(!1),[ce,U]=M.useState(null),[b,D]=M.useState(!1),[L,O]=M.useState(30),[Y,q]=M.useState(!1),[ne,oe]=M.useState(5),[ye,ge]=M.useState(!1),[Te,ve]=M.useState(0),[ae,we]=M.useState(1),[xe]=M.useState(2),[Ae,pt]=M.useState([]),[Ze,Ct]=M.useState(null),[zn,Ht]=M.useState(!1),[tn,qt]=M.useState(0),[Bn,ss]=M.useState({}),[is,er]=M.useState({}),[zs,rt]=M.useState({}),[gt,Er]=M.useState({}),[Tr,os]=M.useState(null),[Qe,as]=M.useState({g2t1:!1,g1t1:!1,g3t1:!1}),[Ia,qi]=M.useState(720),[tr,Gi]=M.useState(720),[Bs,ls]=M.useState(0),[ke,Sn]=M.useState({materials:0,research:0,engagement:0,bonus:0}),[Un,us]=M.useState({}),[Ca,En]=M.useState({}),[Mu,Ir]=M.useState({}),[Aa,Tn]=M.useState({switch:0,refill:0,unfinished:0}),[be,mt]=M.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,unfinishedTaskPenalty:0,taskOrderStrategy:"sequential_task",freezePenalty:0,contextAdviceEnabled:!0,difficultyMode:"fixed",switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0,gameMode:"knapsack",scoring:{g1:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g2:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g3:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}}}});M.useEffect(()=>{(async()=>{try{const W=Mt(nt,"game_settings","global"),B=await Sf(W);if(B.exists()){const X=B.data();if(mt(ie=>({...ie,...X})),X.semesterDuration){const ie=X.semesterDuration*60;qi(ie),Gi(ie),Ra.current=ie,Hs.current=ie}}}catch(W){console.error("Error loading global config:",W)}})()},[]);const[hn,In]=M.useState([]),[fn,Qi]=M.useState(0),[Vu,Cr]=M.useState(null),[Tf,If]=M.useState(!1),[cs,Us]=M.useState([]),[$s,Ar]=M.useState(!1),[Gt,Ki]=M.useState(!0),[Yi,Xi]=M.useState(0),ds=M.useRef(Date.now()),kr=M.useRef(null);M.useRef(null),M.useRef(null);const Ws=M.useRef(null),ka=M.useRef(Date.now()),Hs=M.useRef(720),Ra=M.useRef(720),nr=()=>{const Q=(be.semesterDuration||12)*60*1e3,W=Math.floor(Q/2e3);return Math.floor(W/60)};M.useEffect(()=>{(async()=>{try{const W=new URLSearchParams(window.location.search),B=W.has("code")||W.has("c");if((W.get("code")||W.get("c"))==="MASTER"){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",section:"master_admin",hasAI:!1,isMasterInterface:!0,displayName:"Master Administrator"})),$(!1);return}if(e&&!sessionStorage.getItem("gameConfig")&&sessionStorage.setItem("gameConfig",JSON.stringify({role:"admin",section:"admin",hasAI:!0,checkpointSemester2:!0,displayName:"Admin User"})),!B){r("studentLogin"),$(!1);return}const{allowed:ie,reason:he,resumeSession:Se,newSession:Ke,code:Lt,codeData:Ft}=await tm.checkAccess();if(!ie){A(!0),T(he),$(!1);return}if(Se)P(Se),localStorage.setItem("sessionId",Se);else if(Ke){const Ot=await tm.createSession(Lt,Ft);P(Ot)}await Ue.syncOfflineEvents(),$(!1)}catch{$(!1)}})()},[]),M.useEffect(()=>{n==="complete"&&ae>=xe&&EI.notifyGameComplete({finalScore:Math.round($n())+(ke.bonus||0),totalTime:j,semestersCompleted:ae,sessionId:k})},[n,ae,xe,j,ke.bonus,k]),M.useEffect(()=>{localStorage.setItem("currentTask",c)},[c]),M.useEffect(()=>{localStorage.setItem("gameMode",JSON.stringify(s))},[s]),M.useEffect(()=>{localStorage.setItem("currentSemester",ae.toString())},[ae]),M.useEffect(()=>{localStorage.setItem("totalSemesters",xe.toString())},[xe]),M.useEffect(()=>{localStorage.setItem("completedTasksCount",Object.keys(p).length.toString())},[p]),M.useEffect(()=>{localStorage.setItem("completedLevels",y.toString())},[y]),M.useEffect(()=>{localStorage.setItem("totalSwitches",I.toString())},[I]),M.useEffect(()=>{localStorage.setItem("categoryPoints",JSON.stringify(ke))},[ke]),M.useEffect(()=>{const Q=setInterval(()=>{rr(B=>B+1);const W=$n();ls(W)},2e3);return()=>clearInterval(Q)},[]);const[qs,rr]=M.useState(0);if(M.useEffect(()=>{localStorage.setItem("studentLearningScore",Bs.toString())},[Bs]),M.useEffect(()=>{const Q=Qe.g2t1&&Qe.g1t1&&Qe.g3t1;localStorage.setItem("practiceCompleted",Q.toString())},[Qe]),V)return u.jsx("div",{className:"app",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:u.jsx("h2",{children:"Loading..."})});if(window.location.search.includes("master=true")&&JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="master_admin")return u.jsx(SI,{onClose:()=>{window.history.replaceState({},document.title,window.location.pathname),window.location.reload()}});if(window.location.search.includes("admin=true"))return u.jsx(_I,{});const $n=(Q=ke,W=Un)=>{let B=0;Object.entries(W).forEach(([Ke,Lt])=>{const Ot=1+parseInt(Ke)*.15;B+=Lt*Ot});const X=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,ie=B+X+(Q.bonus||0),he=Q.materials||0,Se=Q.research||0;return console.log(` STUDENT LEARNING: ${ie.toFixed(1)} pts | Materials: ${he} (with sequential multipliers) | Research: ${Se} | Interest: ${X.toFixed(1)} = ${ie.toFixed(1)}`),isNaN(ie)?0:ie},Lu=()=>{if(!(ae===2&&be.midtermEnabled))return;Ht(!0),$n()>=300?(qt(300),Sn(X=>({...X,bonus:(X.bonus||0)+300}))):qt(0),Z(!0),U("checkpoint")},hs=()=>{const Q=(be.semesterDuration||12)*60*1e3,W=Math.floor(Q/1e3);qi(W),Gi(W),ds.current=Date.now(),kr.current=setInterval(()=>{const X=Date.now()-ds.current,ie=Math.floor(X/1e3);E(ie);const he=Math.max(0,W-ie);if(Gi(he),ie%10===0&&k&&!k.startsWith("offline-")&&ur(Mt(nt,"sessions",k),{timeElapsed:ie,lastUpdated:jn()}).catch(Ke=>console.error("Failed to update session time:",Ke)),ae===2&&be.midtermEnabled){const Ke=(be.semesterDuration||12)*60*1e3,Lt=Math.floor(Ke/2e3);ie===Lt&&!zn&&Lu()}he<=0&&(clearInterval(kr.current),kr.current=null,Qs("semester_complete"))},1e3)},Ji=Q=>{const B=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin",X=Qe.g2t1&&Qe.g1t1&&Qe.g3t1;l(Q),Ue.logEvent("practice_choice",{choice:Q}),Q==="no"?!B&&!X?(Cn("You must complete all three practice tasks first!"),r("practice")):Zi():r("practice")},Zi=()=>{if(Ze){if(Object.keys(Bn).length===0){Xe.initializeSeed(Ze);const W={},B={},X={},ie={};for(let he=1;he<=100;he++)W[he]=Xe.generateSliderPattern(he),B[he]=Xe.generateCountingPattern(he),X[he]=Xe.generateTypingPattern(he),ie[he]=Xe.getTextPassage(he);ss(W),er(B),rt(X),Er(ie)}}else{const W=Math.floor(Math.random()*1e6);Ct(W),Xe.initializeSeed(W);const B={},X={},ie={},he={};for(let Se=1;Se<=100;Se++)B[Se]=Xe.generateSliderPattern(Se),X[Se]=Xe.generateCountingPattern(Se),ie[Se]=Xe.generateTypingPattern(Se),he[Se]=Xe.getTextPassage(Se);ss(B),er(X),rt(ie),Er(he),k&&!k.startsWith("offline-")&&ur(Mt(nt,"sessions",k),{randomSeed:W,[`semesterSeeds.semester${ae}`]:W})}localStorage.setItem("engagementInterest","0"),Sn({materials:0,research:0,engagement:0,bonus:0}),us({}),(be.gameMode||"knapsack")==="sequential"?(r("challenge"),h("g2t1"),m({}),C(0),v(0),_(0),Ht(!1),En({}),Ir({}),Tn({switch:0,refill:0,unfinished:0}),hs()):(r("allocation"),m({}),C(0),v(0),_(0),Ht(!1),En({}),Ir({}),Tn({switch:0,refill:0,unfinished:0}))},eo=(Q,W)=>{In(Q),Cr(W),Qi(0),r("challenge");const X=`${Q[0]}t1`;h(X),S({[X]:Date.now()}),Ue.setPageStartTime(X),hs(),Ue.logEvent("allocation_complete",{counts:W,queue:Q,timestamp:Date.now()})},to=Q=>{const W=hn[fn].substring(0,2);if(W===Q)return;const B=be.switchCost||0;B>0&&(Sn(Ve=>({...Ve,bonus:(Ve.bonus||0)-B})),Tn(Ve=>({...Ve,switch:Ve.switch+B})),Cn(`Switching tasks cost ${B} points!`));const X=[...hn],ie=X.slice(fn),he=X.slice(0,fn),Se=ie.filter(Ve=>Ve.startsWith(W)),Ke=ie.filter(Ve=>Ve.startsWith(Q)),Lt=ie.filter(Ve=>!Ve.startsWith(W)&&!Ve.startsWith(Q)),Ft=[...Ke,...Lt,...Se],Ot=[...he,...Ft];if(In(Ot),v(Ve=>Ve+1),Ke.length>0){const Ve=Ke[0];Wn(Ve)}},Gs=async(Q,W)=>{var ba,gs;ka.current=Date.now();let B=0;const X=Q.startsWith("g1")?"research":Q.startsWith("g2")?"materials":"engagement",ie=Q.startsWith("g1")?"g1":Q.startsWith("g2")?"g2":"g3",he=parseInt(Q.substring(3))||1,Se=he<=5?"easy":he<=10?"medium":"hard",Ke=((gs=(ba=be.scoring)==null?void 0:ba[ie])==null?void 0:gs[Se])||{fullCorrect:2,halfCorrect:1},Lt=Ke.fullCorrect||2,Ft=Ke.halfCorrect||1;let Ot=!1,Ve=!1;if(X==="materials"){const ue=parseFloat(W.userAnswer||W.userValue||0),Ne=parseFloat(W.correctAnswer||W.targetValue||0),Le=Math.abs(ue-Ne);Ot=Le===0,Ve=Le>0&&Le<=1}else if(X==="research"){const ue=parseInt(W.userAnswer||0),Ne=parseInt(W.correctAnswer||0),Le=Math.abs(ue-Ne);Ot=Le===0,Ve=Le>0&&Le<=1}else if(X==="engagement"){const ue=W.userAnswer||"",Ne=W.correctAnswer||"";ue===Ne?Ot=!0:Ve=AI(ue,Ne)===1}if(Ot?B=Lt:Ve?B=Ft:B=0,Sn(ue=>{const Ne={...ue,[X]:ue[X]+B};return console.log(` Updated ${X}: +${B} (total: ${Ne[X]})`),Ne}),X==="materials"&&B>0){const ue=ke.research;us(Ne=>{const Le=Ne[ue]||0;return{...Ne,[ue]:Le+B}})}const nn=.0015*(X==="engagement"?ke.engagement+B:ke.engagement),At={...ke,[X]:ke[X]+B};let Ks=Un;if(X==="materials"&&B>0){const ue=ke.research,Ne=Un[ue]||0;Ks={...Un,[ue]:Ne+B}}let ro=0;Object.entries(Ks).forEach(([ue,Ne])=>{const gn=1+parseInt(ue)*.15;ro+=Ne*gn});const so=parseFloat(localStorage.getItem("engagementInterest")||"0")+nn*ro;localStorage.setItem("engagementInterest",so.toString()),Ir(ue=>({...ue,[Q]:B})),En(ue=>({...ue,[Q]:(ue[Q]||0)+1}));const Fu={...ke,[X]:ke[X]+B},io=$n(Fu,Ks);ls(io);let at="";if(X==="materials"){const ue=Math.abs((W.userValue||0)-(W.targetValue||0));ue===0?at="Perfect materials!":ue<=1?at=`Off by ${ue.toFixed(2)}`:at=`Off by ${ue.toFixed(2)}`}else if(X==="research"){const ue=Math.abs((W.userAnswer||0)-(W.correctAnswer||0));ue===0?at="Perfect research!":ue<=1?at=`Off by ${ue}`:at=`Off by ${ue}`}else X==="engagement"&&(B===2?at="Perfect engagement!":B===1?at="One typo":at="Multiple errors");if(Cn(`${at} | +${B} ${X} pts`),m(ue=>({...ue,[Q]:!0})),C(ue=>ue+1),_(ue=>ue+1),await Ue.trackTaskComplete(Q,W.attempts,W.totalTime,W.accuracy||W.difference||0),await Ue.logEvent("task_complete",{taskId:Q,...W,pointsEarned:B,categoryPoints:At,studentLearningScore:io,engagementInterest:so,completionContext:{totalTasksCompleted:Object.keys(p).length+1,currentGameTime:j,switchesBeforeCompletion:I,bonusPromptsEarned:R+1,timeRemaining:tr}}),k&&!k.startsWith("offline-")&&await ur(Mt(nt,"sessions",k),{[`completedTasks.${Q}`]:!0,[`taskPoints.${Q}`]:B,categoryPoints:At,studentLearningScore:io,engagementInterest:so,bonusPrompts:R+1,lastActivity:jn()}),(be.gameMode||"knapsack")==="sequential"){const ue=Q.substring(0,2),Ne=parseInt(Q.substring(3))||1;if(Ne<100){const Le=`${ue}t${Ne+1}`;Wn(Le,!0)}else{const Le=["g2","g1","g3"],gn=Le.indexOf(ue);if(gn<Le.length-1){const ms=`${Le[gn+1]}t1`;Wn(ms,!0)}else Wn("g2t1",!0)}}else{const ue=fn+1;if(ue<hn.length){Qi(ue);const Ne=hn[ue];let Le=Object.keys(p).filter(ms=>ms.startsWith(Ne)).length;Ne===Q.substring(0,2)&&Q.startsWith(Ne)&&(Le+=1);const gn=Le+1,Ys=`${Ne}t${gn}`;Wn(Ys,!0)}else Qs("all_tasks_done")}},Wn=async(Q,W=!1)=>{if(!ee){if(p[Q]&&!W){Cn("Task already completed! Choose a different task.");return}if(W||await Ue.logEvent("manual_tab_switch",{from:c,to:Q,reason:"user_clicked"}),ka.current=Date.now(),Y&&(q(!1),oe(5),Ws.current&&(clearInterval(Ws.current),Ws.current=null)),c!==Q&&!W&&v(B=>B+1),await Ue.trackPageSwitch(c,Q,W),g[c]){const B=Date.now()-g[c];await Ue.logEvent("task_time",{taskId:c,timeSpent:B,completed:p[c]||!1,leftForTask:Q})}h(Q),S(B=>({...B,[Q]:Date.now()})),Ue.setPageStartTime(Q)}},Cn=Q=>{const W=document.createElement("div");W.className="notification-enter",W.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",W.textContent=Q,document.body.appendChild(W),setTimeout(()=>{W.className="notification-exit",setTimeout(()=>{document.body.contains(W)&&document.body.removeChild(W)},500)},3e3)},Qs=async(Q="semester_complete")=>{kr.current&&clearInterval(kr.current);const W=Math.floor((Date.now()-ds.current-Te)/1e3),B=$n(),X=ke.bonus||0,ie=Math.max(0,be.totalTasks-Object.keys(p).length),he=ie*(be.unfinishedTaskPenalty||0);he>0&&Tn(Ke=>({...Ke,unfinished:he}));const Se=Math.round(B)+X-he;he>0&&console.log(` Unfinished Penalty: -${he} pts (${ie} tasks x ${be.unfinishedTaskPenalty})`),await Ue.logEvent("game_complete",{totalTime:W,totalSwitches:I,completedTasks:Object.keys(p).length,completedLevels:y,completionReason:Q,gameMode:s,currentSemester:ae,categoryPoints:ke,studentLearningScore:B,totalBonus:X,finalScore:Se,finalContext:{practiceCompleted:a==="yes",totalPrompts:3+R,isAdminMode:e}}),k&&!k.startsWith("offline-")&&await ur(Mt(nt,"sessions",k),{status:"completed",completedAt:jn(),finalTime:W,timeElapsed:W,totalSwitches:I,completionReason:Q,currentSemester:ae,finalScore:Se,studentLearningScore:B}),r("complete")},no=async Q=>{const W={sender:"user",text:Q,timestamp:Date.now()};Us(X=>[...X,W]),Ar(!0);const B={currentTask:c,timeRemaining:tr,score:Math.round(Bs),completedTasks:Object.keys(p).length,totalTasks:hn.length};try{const X=(be.aiDelay||0)*1e3,ie=await vt.getAdvice(Q,B);setTimeout(()=>{const he={sender:"ai",text:ie,timestamp:Date.now()};Us(Se=>[...Se,he]),Ar(!1),Gt||Xi(Se=>Se+1),be.aiCost>0&&(Sn(Se=>({...Se,bonus:(Se.bonus||0)-be.aiCost})),Cn(`AI Help Cost: -${be.aiCost} pts`))},Math.max(1e3,X))}catch(X){console.error("AI Error:",X),Ar(!1),Us(ie=>[...ie,{sender:"ai",text:"I'm having trouble connecting right now. Please try again.",timestamp:Date.now()}])}},Hn=(Q,W)=>{if(W&&W.points&&W.points===2)as(B=>({...B,[Q]:!0})),Cn("Perfect! Practice task completed."),setTimeout(()=>{os(null)},1500);else{const B=(W==null?void 0:W.points)||0;Cn(`Practice requires 100% accuracy. You scored ${B===1?"50%":"0%"}. Try again!`),setTimeout(()=>{os(null)},2e3)}},Pa=()=>{const Q=c[1],W=parseInt(c.substring(3)),B=n==="practice";if(Q==="1"){const ie=is[W],he=gt[W];return u.jsx(Ud,{taskNum:W,onComplete:B?Hn:Gs,currentTaskId:c,isPractice:B,preGeneratedPattern:ie,preGeneratedText:he})}if(Q==="2"){const ie=Bn[W];return u.jsx($d,{taskNum:W,onComplete:B?Hn:Gs,currentTaskId:c,isPractice:B,preGeneratedPattern:ie})}const X=zs[W];return u.jsx(Wd,{taskNum:W,onComplete:B?Hn:Gs,currentTaskId:c,isPractice:B,preGeneratedPattern:X})};if(n==="studentLogin")return u.jsx(xI,{onLoginSuccess:Q=>{window.location.href=`${window.location.origin}?code=${Q}`}});if(z)return u.jsx("div",{className:"app",children:u.jsxs("div",{style:{maxWidth:"600px",margin:"50px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[u.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Access Denied"}),u.jsx("p",{style:{fontSize:"18px",marginBottom:"20px"},children:w}),u.jsx("div",{style:{padding:"15px",background:"#ffebee",borderRadius:"8px",border:"1px solid #f44336"},children:u.jsx("p",{style:{color:"#c62828",margin:0},children:"If you believe this is an error, please contact your instructor."})})]})});if(n==="semesterBreak"){const Q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),W=ae===2&&Q.checkpointSemester2;return u.jsx("div",{className:"app",children:u.jsxs("div",{style:{maxWidth:"700px",margin:"50px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[u.jsxs("h1",{style:{color:"#2196F3",marginBottom:"30px"},children:[" Semester ",ae-1," Complete!"]}),u.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[u.jsx("h3",{style:{color:"#1976d2",marginBottom:"10px"},children:"Take a Break!"}),u.jsxs("p",{style:{fontSize:"16px",color:"#666",marginBottom:"0"},children:["Great job completing Semester ",ae-1,"! Take a moment to rest your eyes, stretch, or grab some water before continuing."]})]}),W&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",padding:"25px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #ff9800"},children:[u.jsx("h3",{style:{color:"#f57c00",marginBottom:"15px"},children:" Midterm Checkpoint Coming!"}),u.jsxs("div",{style:{fontSize:"16px",color:"#666",textAlign:"left"},children:[u.jsx("p",{style:{marginBottom:"10px"},children:u.jsxs("strong",{children:["Semester 2 includes a midterm exam at the"," ",nr(),"-minute mark!"]})}),u.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"10px"},children:[u.jsx("li",{children:"Your students will be tested at the midpoint"}),u.jsxs("li",{children:["If student learning  300 points:"," ",u.jsx("strong",{children:"+300 bonus points!"})]}),u.jsx("li",{children:"Build up your teaching effectiveness early to maximize the bonus"})]}),u.jsxs("p",{style:{background:"white",padding:"10px",borderRadius:"4px",textAlign:"center",fontWeight:"bold",color:"#f57c00"},children:["Goal: Reach 300+ Student Learning by minute"," ",nr()]})]})]}),Ae.length>0&&u.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[u.jsx("h4",{style:{color:"#666",marginBottom:"10px"},children:"Your Performance So Far:"}),Ae.map((B,X)=>u.jsxs("div",{style:{marginBottom:"8px",fontSize:"16px"},children:["Semester ",X+1,":"," ",u.jsxs("strong",{children:[B.finalScore," points"]})]},X))]}),u.jsxs("div",{style:{marginTop:"30px"},children:[u.jsxs("button",{onClick:()=>{we(X=>X+1),(be.gameMode||"knapsack")==="knapsack"?r("allocation"):(r("challenge"),hs()),m({}),In([]),Qi(0),ls(0),Sn({materials:0,research:0,engagement:0,bonus:0}),hs(),S({g2t1:Date.now()}),Ue.setPageStartTime("g2t1"),Ue.logEvent("semester_start",{semester:ae,timestamp:Date.now(),hasCheckpoint:W})},style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:B=>{B.currentTarget.style.transform="translateY(-2px)",B.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:B=>{B.currentTarget.style.transform="translateY(0)",B.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["I'm Ready - Start Semester ",ae]}),u.jsx("p",{style:{marginTop:"15px",fontSize:"14px",color:"#999"},children:"Click when you're ready to continue. The timer will start immediately."})]})]})})}if(n==="landing"){s||i({accuracy:"lenient",limit:"time"});const Q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),W=Q.role==="admin";return u.jsx("div",{className:"app",children:u.jsx("div",{className:"landing-container",children:u.jsxs("div",{className:"landing-card",style:{padding:"40px",maxWidth:"900px"},children:[u.jsxs("h1",{style:{color:"#333",marginBottom:"30px",fontSize:"32px",textAlign:"left"},children:["Can you beat Park? - Semester ",ae,"/",xe]}),u.jsxs("div",{className:"game-info",style:{textAlign:"left"},children:[u.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[u.jsxs("h3",{style:{color:"#f44336",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""})," Engagement"]}),u.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Build interest that compounds! Each point adds 0.15% interest after every task completion."})]}),u.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[u.jsxs("h3",{style:{color:"#9C27B0",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""})," Research"]}),u.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Research amplifies your FUTURE materials! Each point adds +15% multiplier to materials earned after the research (order matters!)."})]}),u.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[u.jsxs("h3",{style:{color:"#4CAF50",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""})," Materials"]}),u.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Create teaching materials - each point directly contributes to your goal points!"})]}),u.jsxs("div",{style:{background:"#f0f8ff",borderRadius:"8px",padding:"25px",marginBottom:"30px",border:"2px solid #2196F3"},children:[u.jsxs("h3",{style:{color:"#2196F3",fontSize:"20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""})," Student Learning Formula"]}),u.jsxs("div",{style:{background:"white",padding:"18px",borderRadius:"6px",fontFamily:"monospace",fontSize:"18px",textAlign:"center",marginBottom:"20px",border:"1px solid #e0e0e0",lineHeight:"1.8"},children:["Goal ="," ",u.jsx("strong",{children:"Materials  (1 + Research0.15) + Engagement Interest"}),u.jsx("br",{}),u.jsxs("div",{style:{fontSize:"14px",marginTop:"10px",fontFamily:"sans-serif"},children:["Research multipliers apply only to materials earned"," ",u.jsx("em",{children:"after"})," the research"]})]}),u.jsxs("ul",{style:{color:"#333",lineHeight:"2",margin:"0",paddingLeft:"25px",fontSize:"15px",textAlign:"left"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Scoring:"})," Exact = 2 pts | Within 1 = 1 pt | Otherwise = 0 pts"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Timing:"})," Task completion order affects your final score"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Strategy:"})," Think carefully about when to complete each task type!"]}),ae===2&&u.jsxs("li",{children:["At minute ",nr(),": Exam checkpoint with bonus opportunity (300+ Student Learning = 300 bonus)"]})]})]}),Q.hasAI&&u.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"1px solid #ffc107"},children:[u.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"AI Assistant Available:"}),u.jsxs("ul",{style:{color:"#856404",lineHeight:"1.6",margin:"0",paddingLeft:"20px",fontSize:"14px"},children:[u.jsx("li",{children:"Click the help buttons below each task for AI assistance"}),u.jsx("li",{children:"Unlimited use but reliability varies"}),u.jsx("li",{children:'Type "strategy" or "order" in chat for strategic advice!'})]})]}),ae===2&&u.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"2px solid #ffc107"},children:[u.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:" Semester 2: Midterm Checkpoint!"}),u.jsxs("p",{style:{color:"#856404",fontSize:"14px",margin:0},children:["At the ",nr(),"-minute mark, if you have 300+ student learning points, you'll earn a 300-point bonus!"]})]})]}),!W&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)",borderRadius:"12px",padding:"20px",marginTop:"20px",marginBottom:"20px",border:"2px solid #d32f2f",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"12px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""}),u.jsx("h3",{style:{color:"#b71c1c",margin:0,fontSize:"18px",fontWeight:"600"},children:"ONE ATTEMPT ONLY - NO RESTART"})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),u.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[u.jsx("strong",{children:"No refresh/close"})," - Session ends"]})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),u.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[u.jsx("strong",{children:"No tab switching"})," - 30s warning"]})]})]}),u.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"6px",textAlign:"center",fontSize:"14px",color:"#b71c1c",fontWeight:"600"},children:" Ensure 40 minutes uninterrupted before starting"})]}),u.jsxs("button",{className:"start-button",onClick:()=>r("practiceChoice"),children:["Start Semester ",ae]}),e&&u.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#ffcccb",borderRadius:"6px",border:"2px solid #ff0000",fontWeight:"bold",color:"#d00"},children:["ADMIN MODE: ",Ia/60," minute timer, checkpoint at"," ",nr(),"minute"]}),Ae.length>0&&u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"6px",fontSize:"14px"},children:[u.jsx("strong",{children:"Previous Semesters:"}),Ae.map((B,X)=>u.jsxs("div",{style:{marginTop:"5px"},children:["Semester ",X+1,": ",B.finalScore," points"]},X))]})]})})})}if(n==="practiceChoice"){const W=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";return u.jsx("div",{className:"app",children:u.jsx("div",{className:"landing-container",children:u.jsxs("div",{className:"landing-card",children:[u.jsx("h2",{style:{color:"#333",marginBottom:"20px"},children:W?"Practice Mode (Optional for Admin)":"Practice Mode (Required)"}),u.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:W?"As an admin, you can skip practice or try it first.":"You must complete all three practice tasks before starting the main game."}),u.jsx("p",{style:{color:"#888",fontSize:"14px",marginBottom:"30px",fontStyle:"italic"},children:"Practice lets you try each teaching task without time pressure."}),!W&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #1976d2",boxShadow:"0 4px 6px rgba(25, 118, 210, 0.1)"},children:[u.jsxs("h4",{style:{color:"#0d47a1",margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""}),"Required Practice Tasks (100% accuracy needed):"]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Qe.g2t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Qe.g2t1?"#4CAF50":"#e0e0e0"}`},children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),u.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:u.jsx("strong",{children:"Materials"})}),Qe.g2t1?u.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):u.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Qe.g1t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Qe.g1t1?"#4CAF50":"#e0e0e0"}`},children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),u.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:u.jsx("strong",{children:"Research"})}),Qe.g1t1?u.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):u.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Qe.g3t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Qe.g3t1?"#4CAF50":"#e0e0e0"}`},children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),u.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:u.jsx("strong",{children:"Engagement"})}),Qe.g3t1?u.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):u.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]})]}),u.jsx("div",{style:{marginTop:"16px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"6px",fontSize:"13px",color:"#0d47a1",textAlign:"center",fontStyle:"italic"},children:" Each task must be completed perfectly to proceed"})]}),u.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[u.jsx("button",{onClick:()=>Ji("yes"),style:{padding:"15px 30px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:W?"Try Practice Mode":"Start Required Practice"}),W&&u.jsx("button",{onClick:()=>Ji("no"),style:{padding:"15px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:"Skip Practice (Admin)"})]})]})})})}if(n==="practice"){const W=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";if(!Tr)return u.jsxs("div",{className:"app",children:[u.jsx("h1",{children:"Teaching Simulation - Practice Mode"}),u.jsx(yI,{practiceCompleted:Qe,onPracticeComplete:Hn,onSelectPractice:os,onStartMainGame:()=>{const ie=Qe.g2t1&&Qe.g1t1&&Qe.g3t1;!W&&!ie?Cn("You must complete all three practice tasks first!"):Zi()},isAdmin:W})]});const B=Tr[1],X=1;return u.jsx("div",{className:"app",children:u.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[u.jsx("button",{onClick:()=>os(null),style:{marginBottom:"20px",padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:" Back to Practice Menu"}),u.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[u.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),B==="1"&&u.jsx(Ud,{taskNum:X,onComplete:Hn,currentTaskId:Tr,isPractice:!0}),B==="2"&&u.jsx($d,{taskNum:X,onComplete:Hn,currentTaskId:Tr,isPractice:!0}),B==="3"&&u.jsx(Wd,{taskNum:X,onComplete:Hn,currentTaskId:Tr,isPractice:!0})]})})}if(n==="complete"){const Q=Math.floor(j/60),W=j%60,B=Math.round($n()),X=ke.bonus||0,ie=B+X,he={semester:ae,totalTime:j,completedLevels:y,categoryPoints:ke,switches:I,gameMode:s,randomSeed:Ze,studentLearningScore:B,finalScore:ie},Se=async()=>{const Lt=[...Ae,he];pt(Lt),localStorage.setItem("engagementInterest","0"),Sn({materials:0,research:0,engagement:0,bonus:0}),us({}),k&&!k.startsWith("offline-")&&await ur(Mt(nt,"sessions",k),{[`semesterHistory.semester${ae}`]:he,currentSemester:ae+1,lastActivity:jn()}),we(ae+1),vt.resetForNewSemester(),r("semesterBreak"),m({}),C(0),v(0),_(0),E(0),ve(0),h("g2t1"),Ht(!1);const Ft=Math.floor(Math.random()*1e6);Ct(Ft),Xe.initializeSeed(Ft);const Ot={},Ve={},sr={},nn={};for(let At=1;At<=100;At++)Ot[At]=Xe.generateSliderPattern(At),Ve[At]=Xe.generateCountingPattern(At),sr[At]=Xe.generateTypingPattern(At),nn[At]=Xe.getTextPassage(At);ss(Ot),er(Ve),rt(sr),Er(nn)},Ke=ae>=xe;return u.jsxs("div",{className:"app",children:[u.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[u.jsx("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"8px",border:"2px solid #2196F3"},children:u.jsxs("h2",{style:{color:"#2196F3",margin:0},children:["Semester ",ae," of ",xe," Complete!"]})}),Ke&&u.jsx(wI,{sessionId:k,completedLevels:y,totalTime:j,gameMode:s}),u.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginTop:"20px"},children:[u.jsxs("h2",{style:{color:"#333",marginBottom:"20px"},children:[" Semester ",ae," Performance"]}),u.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2196F3",marginBottom:"30px"},children:["Final Score: ",ie," points"]}),u.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[u.jsxs("h3",{style:{margin:"0 0 15px 0",color:"#1976d2"},children:["Student Learning Score: ",B]}),u.jsxs("div",{style:{fontSize:"16px",color:"#666"},children:["= ",ke.materials||0," (Materials) "," ",(1+(ke.research||0)*.15).toFixed(2)," ","(Research)",parseFloat(localStorage.getItem("engagementInterest")||"0")>0&&` + ${parseFloat(localStorage.getItem("engagementInterest")||"0").toFixed(2)} (Interest)`]}),X>0&&u.jsxs("div",{style:{marginTop:"10px",fontSize:"16px",color:"#1976d2"},children:["+ ",X," Checkpoint Bonus"]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"30px"},children:[u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Total Time"}),u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[Q,"m ",W,"s"]})]}),u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Student Learning"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:B})]})]}),(ae===2||X>0)&&u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Checkpoint Bonus"}),u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:["+",X]})]}),u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Tasks Completed"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:y})]})]}),u.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:"Teaching Performance by Category"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"30px"},children:[u.jsxs("div",{style:{background:"#f0f8f0",padding:"15px",borderRadius:"6px",border:"2px solid #4CAF5020"},children:[u.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",marginBottom:"5px"},children:" Materials"}),u.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:ke.materials||0}),u.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Base points"})]}),u.jsxs("div",{style:{background:"#f8f0ff",padding:"15px",borderRadius:"6px",border:"2px solid #9C27B020"},children:[u.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold",marginBottom:"5px"},children:" Research"}),u.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:ke.research||0}),u.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(ke.research||0)*15,"% to future materials"]})]}),u.jsxs("div",{style:{background:"#fff0f0",padding:"15px",borderRadius:"6px",border:"2px solid #f4433620"},children:[u.jsx("div",{style:{color:"#f44336",fontWeight:"bold",marginBottom:"5px"},children:" Engagement"}),u.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:ke.engagement||0}),u.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",((ke.engagement||0)*.15).toFixed(1),"% interest/task"]})]})]})]}),ae===2&&ke.bonus>0&&u.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[u.jsx("strong",{style:{color:"#856404"},children:" Exam Season Bonus: "}),u.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#856404"},children:["+",ke.bonus," points"]})]}),Ae.length>0&&u.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[u.jsx("h4",{style:{color:"#666",marginBottom:"15px"},children:"Progress Over Semesters"}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px"},children:[...Ae,he].map((Lt,Ft)=>u.jsxs("div",{style:{padding:"10px",background:Ft===Ae.length?"#e3f2fd":"white",borderRadius:"6px",border:"1px solid #e0e0e0",textAlign:"center"},children:[u.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Semester ",Ft+1]}),u.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:Lt.finalScore})]},Ft))})]}),u.jsx("div",{style:{marginTop:"30px",textAlign:"center"},children:Ke?u.jsxs("div",{style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px",textAlign:"center"},children:[u.jsx("h3",{style:{color:"#856404",marginBottom:"10px"},children:" All semesters complete!"}),u.jsx("p",{style:{color:"#856404",marginBottom:"0"},children:"Return to the Qualtrics survey and enter your completion code to finish the study."})]}):u.jsxs("button",{onClick:Se,style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",ae+1," "]})})]})}const pn=be.gameMode||"knapsack";if(n==="allocation"&&pn==="knapsack")return u.jsx(TI,{onStart:eo,totalTasks:be.totalTasks,orderStrategy:be.taskOrderStrategy,durationMinutes:be.semesterDuration,difficultyMode:be.difficultyMode});if(n==="bonus_round"&&pn==="knapsack")return u.jsx(CI,{timeRemaining:tr,onSelectTask:Q=>{const W=[...hn,Q];In(W);const B=Object.keys(p).filter(ie=>ie.startsWith(Q)).length,X=`${Q}t${B+1}`;r("challenge"),Wn(X,!0)},onFinishEarly:()=>Qs("finished_early")});const An=Q=>{const W=be.unfinishedJarPenalty||0;W>0&&(Sn(B=>({...B,bonus:(B.bonus||0)-W})),Tn(B=>({...B,refill:B.refill+W})),Cn(`Refilling jar cost ${W} points!`)),be.jarRefillFreezeTime>0?(ge(!0),T(`Refilling ${Q==="g1"?"Research":Q==="g2"?"Materials":"Engagement"} Jar...`),setTimeout(()=>{ge(!1),T(""),fs(Q,1)},be.jarRefillFreezeTime*1e3)):fs(Q,1)},fs=(Q,W)=>{const B=[];for(let X=0;X<W;X++){const ie=Math.floor(Math.random()*20)+1;B.push(`${Q}t${ie}`)}In(X=>[...X,...B])};if(n==="challenge"&&pn==="sequential")return u.jsxs("div",{className:"app",children:[u.jsx(mI,{current:c,completed:p,onSwitch:Wn,limitMode:"time",categoryPoints:ke,timeRemaining:tr}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 340px",gap:"20px",maxWidth:"1400px",margin:"0 auto",padding:"20px"},children:[u.jsx("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:Pa()}),u.jsx("div",{style:{height:"fit-content"},children:u.jsx(em,{messages:cs,onSendMessage:no,isAiTyping:$s,isOpen:Gt,onToggle:()=>Ki(!Gt),unreadCount:Yi,aiDelay:be.aiDelay,currentTask:c,categoryPoints:ke})})]})]});if((n==="challenge"||n==="bonus_round")&&pn==="knapsack")return u.jsxs("div",{className:"app",children:[ye&&u.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"24px",flexDirection:"column",gap:"20px"},children:[u.jsx("div",{style:{fontSize:"48px"},children:""}),u.jsx("div",{children:w}),u.jsx("div",{style:{fontSize:"16px",opacity:.8},children:"Please wait..."})]}),u.jsx(II,{currentTaskIndex:fn,totalTasks:hn.length,taskQueue:hn,onSwitchTask:to,onRefill:An,allocationCounts:Vu,points:Math.round(Bs),timeRemaining:tr,onTimeUp:()=>Qs("time_up"),penalties:Aa,difficultyMode:be.difficultyMode,chatInterface:u.jsx(em,{messages:cs,onSendMessage:no,isAiTyping:$s,isOpen:Gt,onToggle:()=>Ki(!Gt),unreadCount:Yi,aiDelay:be.aiDelay,currentTask:hn[fn],categoryPoints:ke}),children:Pa()})]})}p0(document.getElementById("root")).render(u.jsx(M.StrictMode,{children:u.jsx(kI,{})}));
//# sourceMappingURL=index-AlU8pR1Y.js.map
