(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var qm={exports:{}},Bl={},Gm={exports:{}},pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $o=Symbol.for("react.element"),r_=Symbol.for("react.portal"),i_=Symbol.for("react.fragment"),s_=Symbol.for("react.strict_mode"),o_=Symbol.for("react.profiler"),a_=Symbol.for("react.provider"),l_=Symbol.for("react.context"),u_=Symbol.for("react.forward_ref"),c_=Symbol.for("react.suspense"),d_=Symbol.for("react.memo"),h_=Symbol.for("react.lazy"),Lf=Symbol.iterator;function f_(t){return t===null||typeof t!="object"?null:(t=Lf&&t[Lf]||t["@@iterator"],typeof t=="function"?t:null)}var Qm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Km=Object.assign,Ym={};function gs(t,e,n){this.props=t,this.context=e,this.refs=Ym,this.updater=n||Qm}gs.prototype.isReactComponent={};gs.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};gs.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Xm(){}Xm.prototype=gs.prototype;function bd(t,e,n){this.props=t,this.context=e,this.refs=Ym,this.updater=n||Qm}var Dd=bd.prototype=new Xm;Dd.constructor=bd;Km(Dd,gs.prototype);Dd.isPureReactComponent=!0;var Of=Array.isArray,Jm=Object.prototype.hasOwnProperty,Nd={current:null},Zm={key:!0,ref:!0,__self:!0,__source:!0};function eg(t,e,n){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)Jm.call(e,r)&&!Zm.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];i.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:$o,type:t,key:s,ref:a,props:i,_owner:Nd.current}}function p_(t,e){return{$$typeof:$o,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function jd(t){return typeof t=="object"&&t!==null&&t.$$typeof===$o}function m_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ff=/\/+/g;function Cu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?m_(""+t.key):e.toString(36)}function $a(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case $o:case r_:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+Cu(a,0):r,Of(i)?(n="",t!=null&&(n=t.replace(Ff,"$&/")+"/"),$a(i,e,n,"",function(h){return h})):i!=null&&(jd(i)&&(i=p_(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Ff,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",Of(t))for(var l=0;l<t.length;l++){s=t[l];var u=r+Cu(s,l);a+=$a(s,e,n,u,i)}else if(u=f_(t),typeof u=="function")for(t=u.call(t),l=0;!(s=t.next()).done;)s=s.value,u=r+Cu(s,l++),a+=$a(s,e,n,u,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Sa(t,e,n){if(t==null)return t;var r=[],i=0;return $a(t,r,"","",function(s){return e.call(n,s,i++)}),r}function g_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Mt={current:null},Wa={transition:null},y_={ReactCurrentDispatcher:Mt,ReactCurrentBatchConfig:Wa,ReactCurrentOwner:Nd};function tg(){throw Error("act(...) is not supported in production builds of React.")}pe.Children={map:Sa,forEach:function(t,e,n){Sa(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Sa(t,function(){e++}),e},toArray:function(t){return Sa(t,function(e){return e})||[]},only:function(t){if(!jd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};pe.Component=gs;pe.Fragment=i_;pe.Profiler=o_;pe.PureComponent=bd;pe.StrictMode=s_;pe.Suspense=c_;pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=y_;pe.act=tg;pe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Km({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Nd.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Jm.call(e,u)&&!Zm.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:$o,type:t.type,key:i,ref:s,props:r,_owner:a}};pe.createContext=function(t){return t={$$typeof:l_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:a_,_context:t},t.Consumer=t};pe.createElement=eg;pe.createFactory=function(t){var e=eg.bind(null,t);return e.type=t,e};pe.createRef=function(){return{current:null}};pe.forwardRef=function(t){return{$$typeof:u_,render:t}};pe.isValidElement=jd;pe.lazy=function(t){return{$$typeof:h_,_payload:{_status:-1,_result:t},_init:g_}};pe.memo=function(t,e){return{$$typeof:d_,type:t,compare:e===void 0?null:e}};pe.startTransition=function(t){var e=Wa.transition;Wa.transition={};try{t()}finally{Wa.transition=e}};pe.unstable_act=tg;pe.useCallback=function(t,e){return Mt.current.useCallback(t,e)};pe.useContext=function(t){return Mt.current.useContext(t)};pe.useDebugValue=function(){};pe.useDeferredValue=function(t){return Mt.current.useDeferredValue(t)};pe.useEffect=function(t,e){return Mt.current.useEffect(t,e)};pe.useId=function(){return Mt.current.useId()};pe.useImperativeHandle=function(t,e,n){return Mt.current.useImperativeHandle(t,e,n)};pe.useInsertionEffect=function(t,e){return Mt.current.useInsertionEffect(t,e)};pe.useLayoutEffect=function(t,e){return Mt.current.useLayoutEffect(t,e)};pe.useMemo=function(t,e){return Mt.current.useMemo(t,e)};pe.useReducer=function(t,e,n){return Mt.current.useReducer(t,e,n)};pe.useRef=function(t){return Mt.current.useRef(t)};pe.useState=function(t){return Mt.current.useState(t)};pe.useSyncExternalStore=function(t,e,n){return Mt.current.useSyncExternalStore(t,e,n)};pe.useTransition=function(){return Mt.current.useTransition()};pe.version="18.3.1";Gm.exports=pe;var D=Gm.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v_=D,__=Symbol.for("react.element"),x_=Symbol.for("react.fragment"),w_=Object.prototype.hasOwnProperty,S_=v_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,E_={key:!0,ref:!0,__self:!0,__source:!0};function ng(t,e,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)w_.call(e,r)&&!E_.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:__,type:t,key:s,ref:a,props:i,_owner:S_.current}}Bl.Fragment=x_;Bl.jsx=ng;Bl.jsxs=ng;qm.exports=Bl;var d=qm.exports,rg={exports:{}},on={},ig={exports:{}},sg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,O){var G=N.length;N.push(O);e:for(;0<G;){var Z=G-1>>>1,ee=N[Z];if(0<i(ee,O))N[Z]=O,N[G]=ee,G=Z;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var O=N[0],G=N.pop();if(G!==O){N[0]=G;e:for(var Z=0,ee=N.length,ae=ee>>>1;Z<ae;){var ke=2*(Z+1)-1,we=N[ke],fe=ke+1,he=N[fe];if(0>i(we,G))fe<ee&&0>i(he,we)?(N[Z]=he,N[fe]=G,Z=fe):(N[Z]=we,N[ke]=G,Z=ke);else if(fe<ee&&0>i(he,G))N[Z]=he,N[fe]=G,Z=fe;else break e}}return O}function i(N,O){var G=N.sortIndex-O.sortIndex;return G!==0?G:N.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],h=[],p=1,g=null,y=3,E=!1,A=!1,P=!1,F=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(N){for(var O=n(h);O!==null;){if(O.callback===null)r(h);else if(O.startTime<=N)r(h),O.sortIndex=O.expirationTime,e(u,O);else break;O=n(h)}}function V(N){if(P=!1,C(N),!A)if(n(u)!==null)A=!0,ie(L);else{var O=n(h);O!==null&&$(V,O.startTime-N)}}function L(N,O){A=!1,P&&(P=!1,I(m),m=-1),E=!0;var G=y;try{for(C(O),g=n(u);g!==null&&(!(g.expirationTime>O)||N&&!k());){var Z=g.callback;if(typeof Z=="function"){g.callback=null,y=g.priorityLevel;var ee=Z(g.expirationTime<=O);O=t.unstable_now(),typeof ee=="function"?g.callback=ee:g===n(u)&&r(u),C(O)}else r(u);g=n(u)}if(g!==null)var ae=!0;else{var ke=n(h);ke!==null&&$(V,ke.startTime-O),ae=!1}return ae}finally{g=null,y=G,E=!1}}var M=!1,v=null,m=-1,x=5,w=-1;function k(){return!(t.unstable_now()-w<x)}function R(){if(v!==null){var N=t.unstable_now();w=N;var O=!0;try{O=v(!0,N)}finally{O?T():(M=!1,v=null)}}else M=!1}var T;if(typeof S=="function")T=function(){S(R)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,ne=se.port2;se.port1.onmessage=R,T=function(){ne.postMessage(null)}}else T=function(){F(R,0)};function ie(N){v=N,M||(M=!0,T())}function $(N,O){m=F(function(){N(t.unstable_now())},O)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){A||E||(A=!0,ie(L))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(N){switch(y){case 1:case 2:case 3:var O=3;break;default:O=y}var G=y;y=O;try{return N()}finally{y=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,O){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var G=y;y=N;try{return O()}finally{y=G}},t.unstable_scheduleCallback=function(N,O,G){var Z=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?Z+G:Z):G=Z,N){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=G+ee,N={id:p++,callback:O,priorityLevel:N,startTime:G,expirationTime:ee,sortIndex:-1},G>Z?(N.sortIndex=G,e(h,N),n(u)===null&&N===n(h)&&(P?(I(m),m=-1):P=!0,$(V,G-Z))):(N.sortIndex=ee,e(u,N),A||E||(A=!0,ie(L))),N},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(N){var O=y;return function(){var G=y;y=O;try{return N.apply(this,arguments)}finally{y=G}}}})(sg);ig.exports=sg;var T_=ig.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I_=D,sn=T_;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var og=new Set,mo={};function gi(t,e){ns(t,e),ns(t+"Capture",e)}function ns(t,e){for(mo[t]=e,t=0;t<e.length;t++)og.add(e[t])}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dc=Object.prototype.hasOwnProperty,C_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zf={},Bf={};function A_(t){return dc.call(Bf,t)?!0:dc.call(zf,t)?!1:C_.test(t)?Bf[t]=!0:(zf[t]=!0,!1)}function k_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function R_(t,e,n,r){if(e===null||typeof e>"u"||k_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Lt(t,e,n,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xt[t]=new Lt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xt[e]=new Lt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xt[t]=new Lt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xt[t]=new Lt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xt[t]=new Lt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xt[t]=new Lt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xt[t]=new Lt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xt[t]=new Lt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xt[t]=new Lt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Vd=/[\-:]([a-z])/g;function Md(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Vd,Md);xt[e]=new Lt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Vd,Md);xt[e]=new Lt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Vd,Md);xt[e]=new Lt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xt[t]=new Lt(t,1,!1,t.toLowerCase(),null,!1,!1)});xt.xlinkHref=new Lt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xt[t]=new Lt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ld(t,e,n,r){var i=xt.hasOwnProperty(e)?xt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(R_(e,n,i,r)&&(n=null),r||i===null?A_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ur=I_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ea=Symbol.for("react.element"),Li=Symbol.for("react.portal"),Oi=Symbol.for("react.fragment"),Od=Symbol.for("react.strict_mode"),hc=Symbol.for("react.profiler"),ag=Symbol.for("react.provider"),lg=Symbol.for("react.context"),Fd=Symbol.for("react.forward_ref"),fc=Symbol.for("react.suspense"),pc=Symbol.for("react.suspense_list"),zd=Symbol.for("react.memo"),_r=Symbol.for("react.lazy"),ug=Symbol.for("react.offscreen"),Uf=Symbol.iterator;function Os(t){return t===null||typeof t!="object"?null:(t=Uf&&t[Uf]||t["@@iterator"],typeof t=="function"?t:null)}var Be=Object.assign,Au;function Gs(t){if(Au===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Au=e&&e[1]||""}return`
`+Au+t}var ku=!1;function Ru(t,e){if(!t||ku)return"";ku=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,l=s.length-1;1<=a&&0<=l&&i[a]!==s[l];)l--;for(;1<=a&&0<=l;a--,l--)if(i[a]!==s[l]){if(a!==1||l!==1)do if(a--,l--,0>l||i[a]!==s[l]){var u=`
`+i[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{ku=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Gs(t):""}function P_(t){switch(t.tag){case 5:return Gs(t.type);case 16:return Gs("Lazy");case 13:return Gs("Suspense");case 19:return Gs("SuspenseList");case 0:case 2:case 15:return t=Ru(t.type,!1),t;case 11:return t=Ru(t.type.render,!1),t;case 1:return t=Ru(t.type,!0),t;default:return""}}function mc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Oi:return"Fragment";case Li:return"Portal";case hc:return"Profiler";case Od:return"StrictMode";case fc:return"Suspense";case pc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case lg:return(t.displayName||"Context")+".Consumer";case ag:return(t._context.displayName||"Context")+".Provider";case Fd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case zd:return e=t.displayName||null,e!==null?e:mc(t.type)||"Memo";case _r:e=t._payload,t=t._init;try{return mc(t(e))}catch{}}return null}function b_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mc(e);case 8:return e===Od?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Or(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function cg(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function D_(t){var e=cg(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ta(t){t._valueTracker||(t._valueTracker=D_(t))}function dg(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=cg(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ol(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gc(t,e){var n=e.checked;return Be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function $f(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Or(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function hg(t,e){e=e.checked,e!=null&&Ld(t,"checked",e,!1)}function yc(t,e){hg(t,e);var n=Or(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?vc(t,e.type,n):e.hasOwnProperty("defaultValue")&&vc(t,e.type,Or(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Wf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function vc(t,e,n){(e!=="number"||ol(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Qs=Array.isArray;function Ki(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Or(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function _c(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return Be({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Hf(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if(Qs(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Or(n)}}function fg(t,e){var n=Or(e.value),r=Or(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function qf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function pg(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?pg(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ia,mg=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ia=Ia||document.createElement("div"),Ia.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ia.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function go(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var to={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},N_=["Webkit","ms","Moz","O"];Object.keys(to).forEach(function(t){N_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),to[e]=to[t]})});function gg(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||to.hasOwnProperty(t)&&to[t]?(""+e).trim():e+"px"}function yg(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=gg(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var j_=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wc(t,e){if(e){if(j_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function Sc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ec=null;function Bd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Tc=null,Yi=null,Xi=null;function Gf(t){if(t=qo(t)){if(typeof Tc!="function")throw Error(H(280));var e=t.stateNode;e&&(e=ql(e),Tc(t.stateNode,t.type,e))}}function vg(t){Yi?Xi?Xi.push(t):Xi=[t]:Yi=t}function _g(){if(Yi){var t=Yi,e=Xi;if(Xi=Yi=null,Gf(t),e)for(t=0;t<e.length;t++)Gf(e[t])}}function xg(t,e){return t(e)}function wg(){}var Pu=!1;function Sg(t,e,n){if(Pu)return t(e,n);Pu=!0;try{return xg(t,e,n)}finally{Pu=!1,(Yi!==null||Xi!==null)&&(wg(),_g())}}function yo(t,e){var n=t.stateNode;if(n===null)return null;var r=ql(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var Ic=!1;if(tr)try{var Fs={};Object.defineProperty(Fs,"passive",{get:function(){Ic=!0}}),window.addEventListener("test",Fs,Fs),window.removeEventListener("test",Fs,Fs)}catch{Ic=!1}function V_(t,e,n,r,i,s,a,l,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var no=!1,al=null,ll=!1,Cc=null,M_={onError:function(t){no=!0,al=t}};function L_(t,e,n,r,i,s,a,l,u){no=!1,al=null,V_.apply(M_,arguments)}function O_(t,e,n,r,i,s,a,l,u){if(L_.apply(this,arguments),no){if(no){var h=al;no=!1,al=null}else throw Error(H(198));ll||(ll=!0,Cc=h)}}function yi(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Eg(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Qf(t){if(yi(t)!==t)throw Error(H(188))}function F_(t){var e=t.alternate;if(!e){if(e=yi(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Qf(i),t;if(s===r)return Qf(i),e;s=s.sibling}throw Error(H(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function Tg(t){return t=F_(t),t!==null?Ig(t):null}function Ig(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Ig(t);if(e!==null)return e;t=t.sibling}return null}var Cg=sn.unstable_scheduleCallback,Kf=sn.unstable_cancelCallback,z_=sn.unstable_shouldYield,B_=sn.unstable_requestPaint,Ye=sn.unstable_now,U_=sn.unstable_getCurrentPriorityLevel,Ud=sn.unstable_ImmediatePriority,Ag=sn.unstable_UserBlockingPriority,ul=sn.unstable_NormalPriority,$_=sn.unstable_LowPriority,kg=sn.unstable_IdlePriority,Ul=null,Mn=null;function W_(t){if(Mn&&typeof Mn.onCommitFiberRoot=="function")try{Mn.onCommitFiberRoot(Ul,t,void 0,(t.current.flags&128)===128)}catch{}}var In=Math.clz32?Math.clz32:G_,H_=Math.log,q_=Math.LN2;function G_(t){return t>>>=0,t===0?32:31-(H_(t)/q_|0)|0}var Ca=64,Aa=4194304;function Ks(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function cl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~i;l!==0?r=Ks(l):(s&=a,s!==0&&(r=Ks(s)))}else a=n&~i,a!==0?r=Ks(a):s!==0&&(r=Ks(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-In(e),i=1<<n,r|=t[n],e&=~i;return r}function Q_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function K_(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-In(s),l=1<<a,u=i[a];u===-1?(!(l&n)||l&r)&&(i[a]=Q_(l,e)):u<=e&&(t.expiredLanes|=l),s&=~l}}function Ac(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Rg(){var t=Ca;return Ca<<=1,!(Ca&4194240)&&(Ca=64),t}function bu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Wo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-In(e),t[e]=n}function Y_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-In(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function $d(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-In(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ee=0;function Pg(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var bg,Wd,Dg,Ng,jg,kc=!1,ka=[],Cr=null,Ar=null,kr=null,vo=new Map,_o=new Map,wr=[],X_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yf(t,e){switch(t){case"focusin":case"focusout":Cr=null;break;case"dragenter":case"dragleave":Ar=null;break;case"mouseover":case"mouseout":kr=null;break;case"pointerover":case"pointerout":vo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_o.delete(e.pointerId)}}function zs(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=qo(e),e!==null&&Wd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function J_(t,e,n,r,i){switch(e){case"focusin":return Cr=zs(Cr,t,e,n,r,i),!0;case"dragenter":return Ar=zs(Ar,t,e,n,r,i),!0;case"mouseover":return kr=zs(kr,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return vo.set(s,zs(vo.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,_o.set(s,zs(_o.get(s)||null,t,e,n,r,i)),!0}return!1}function Vg(t){var e=ti(t.target);if(e!==null){var n=yi(e);if(n!==null){if(e=n.tag,e===13){if(e=Eg(n),e!==null){t.blockedOn=e,jg(t.priority,function(){Dg(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ha(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Rc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ec=r,n.target.dispatchEvent(r),Ec=null}else return e=qo(n),e!==null&&Wd(e),t.blockedOn=n,!1;e.shift()}return!0}function Xf(t,e,n){Ha(t)&&n.delete(e)}function Z_(){kc=!1,Cr!==null&&Ha(Cr)&&(Cr=null),Ar!==null&&Ha(Ar)&&(Ar=null),kr!==null&&Ha(kr)&&(kr=null),vo.forEach(Xf),_o.forEach(Xf)}function Bs(t,e){t.blockedOn===e&&(t.blockedOn=null,kc||(kc=!0,sn.unstable_scheduleCallback(sn.unstable_NormalPriority,Z_)))}function xo(t){function e(i){return Bs(i,t)}if(0<ka.length){Bs(ka[0],t);for(var n=1;n<ka.length;n++){var r=ka[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Cr!==null&&Bs(Cr,t),Ar!==null&&Bs(Ar,t),kr!==null&&Bs(kr,t),vo.forEach(e),_o.forEach(e),n=0;n<wr.length;n++)r=wr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<wr.length&&(n=wr[0],n.blockedOn===null);)Vg(n),n.blockedOn===null&&wr.shift()}var Ji=ur.ReactCurrentBatchConfig,dl=!0;function ex(t,e,n,r){var i=Ee,s=Ji.transition;Ji.transition=null;try{Ee=1,Hd(t,e,n,r)}finally{Ee=i,Ji.transition=s}}function tx(t,e,n,r){var i=Ee,s=Ji.transition;Ji.transition=null;try{Ee=4,Hd(t,e,n,r)}finally{Ee=i,Ji.transition=s}}function Hd(t,e,n,r){if(dl){var i=Rc(t,e,n,r);if(i===null)Bu(t,e,r,hl,n),Yf(t,r);else if(J_(i,t,e,n,r))r.stopPropagation();else if(Yf(t,r),e&4&&-1<X_.indexOf(t)){for(;i!==null;){var s=qo(i);if(s!==null&&bg(s),s=Rc(t,e,n,r),s===null&&Bu(t,e,r,hl,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Bu(t,e,r,null,n)}}var hl=null;function Rc(t,e,n,r){if(hl=null,t=Bd(r),t=ti(t),t!==null)if(e=yi(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Eg(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return hl=t,null}function Mg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(U_()){case Ud:return 1;case Ag:return 4;case ul:case $_:return 16;case kg:return 536870912;default:return 16}default:return 16}}var Er=null,qd=null,qa=null;function Lg(){if(qa)return qa;var t,e=qd,n=e.length,r,i="value"in Er?Er.value:Er.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[s-r];r++);return qa=i.slice(t,1<r?1-r:void 0)}function Ga(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ra(){return!0}function Jf(){return!1}function an(t){function e(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ra:Jf,this.isPropagationStopped=Jf,this}return Be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ra)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ra)},persist:function(){},isPersistent:Ra}),e}var ys={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gd=an(ys),Ho=Be({},ys,{view:0,detail:0}),nx=an(Ho),Du,Nu,Us,$l=Be({},Ho,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Us&&(Us&&t.type==="mousemove"?(Du=t.screenX-Us.screenX,Nu=t.screenY-Us.screenY):Nu=Du=0,Us=t),Du)},movementY:function(t){return"movementY"in t?t.movementY:Nu}}),Zf=an($l),rx=Be({},$l,{dataTransfer:0}),ix=an(rx),sx=Be({},Ho,{relatedTarget:0}),ju=an(sx),ox=Be({},ys,{animationName:0,elapsedTime:0,pseudoElement:0}),ax=an(ox),lx=Be({},ys,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ux=an(lx),cx=Be({},ys,{data:0}),ep=an(cx),dx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function px(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=fx[t])?!!e[t]:!1}function Qd(){return px}var mx=Be({},Ho,{key:function(t){if(t.key){var e=dx[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ga(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?hx[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qd,charCode:function(t){return t.type==="keypress"?Ga(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ga(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),gx=an(mx),yx=Be({},$l,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tp=an(yx),vx=Be({},Ho,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qd}),_x=an(vx),xx=Be({},ys,{propertyName:0,elapsedTime:0,pseudoElement:0}),wx=an(xx),Sx=Be({},$l,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ex=an(Sx),Tx=[9,13,27,32],Kd=tr&&"CompositionEvent"in window,ro=null;tr&&"documentMode"in document&&(ro=document.documentMode);var Ix=tr&&"TextEvent"in window&&!ro,Og=tr&&(!Kd||ro&&8<ro&&11>=ro),np=" ",rp=!1;function Fg(t,e){switch(t){case"keyup":return Tx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zg(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fi=!1;function Cx(t,e){switch(t){case"compositionend":return zg(e);case"keypress":return e.which!==32?null:(rp=!0,np);case"textInput":return t=e.data,t===np&&rp?null:t;default:return null}}function Ax(t,e){if(Fi)return t==="compositionend"||!Kd&&Fg(t,e)?(t=Lg(),qa=qd=Er=null,Fi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Og&&e.locale!=="ko"?null:e.data;default:return null}}var kx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ip(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!kx[t.type]:e==="textarea"}function Bg(t,e,n,r){vg(r),e=fl(e,"onChange"),0<e.length&&(n=new Gd("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var io=null,wo=null;function Rx(t){Jg(t,0)}function Wl(t){var e=Ui(t);if(dg(e))return t}function Px(t,e){if(t==="change")return e}var Ug=!1;if(tr){var Vu;if(tr){var Mu="oninput"in document;if(!Mu){var sp=document.createElement("div");sp.setAttribute("oninput","return;"),Mu=typeof sp.oninput=="function"}Vu=Mu}else Vu=!1;Ug=Vu&&(!document.documentMode||9<document.documentMode)}function op(){io&&(io.detachEvent("onpropertychange",$g),wo=io=null)}function $g(t){if(t.propertyName==="value"&&Wl(wo)){var e=[];Bg(e,wo,t,Bd(t)),Sg(Rx,e)}}function bx(t,e,n){t==="focusin"?(op(),io=e,wo=n,io.attachEvent("onpropertychange",$g)):t==="focusout"&&op()}function Dx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Wl(wo)}function Nx(t,e){if(t==="click")return Wl(e)}function jx(t,e){if(t==="input"||t==="change")return Wl(e)}function Vx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var kn=typeof Object.is=="function"?Object.is:Vx;function So(t,e){if(kn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!dc.call(e,i)||!kn(t[i],e[i]))return!1}return!0}function ap(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function lp(t,e){var n=ap(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ap(n)}}function Wg(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Wg(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Hg(){for(var t=window,e=ol();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ol(t.document)}return e}function Yd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Mx(t){var e=Hg(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Wg(n.ownerDocument.documentElement,n)){if(r!==null&&Yd(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=lp(n,s);var a=lp(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Lx=tr&&"documentMode"in document&&11>=document.documentMode,zi=null,Pc=null,so=null,bc=!1;function up(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;bc||zi==null||zi!==ol(r)||(r=zi,"selectionStart"in r&&Yd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),so&&So(so,r)||(so=r,r=fl(Pc,"onSelect"),0<r.length&&(e=new Gd("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=zi)))}function Pa(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Bi={animationend:Pa("Animation","AnimationEnd"),animationiteration:Pa("Animation","AnimationIteration"),animationstart:Pa("Animation","AnimationStart"),transitionend:Pa("Transition","TransitionEnd")},Lu={},qg={};tr&&(qg=document.createElement("div").style,"AnimationEvent"in window||(delete Bi.animationend.animation,delete Bi.animationiteration.animation,delete Bi.animationstart.animation),"TransitionEvent"in window||delete Bi.transitionend.transition);function Hl(t){if(Lu[t])return Lu[t];if(!Bi[t])return t;var e=Bi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in qg)return Lu[t]=e[n];return t}var Gg=Hl("animationend"),Qg=Hl("animationiteration"),Kg=Hl("animationstart"),Yg=Hl("transitionend"),Xg=new Map,cp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $r(t,e){Xg.set(t,e),gi(e,[t])}for(var Ou=0;Ou<cp.length;Ou++){var Fu=cp[Ou],Ox=Fu.toLowerCase(),Fx=Fu[0].toUpperCase()+Fu.slice(1);$r(Ox,"on"+Fx)}$r(Gg,"onAnimationEnd");$r(Qg,"onAnimationIteration");$r(Kg,"onAnimationStart");$r("dblclick","onDoubleClick");$r("focusin","onFocus");$r("focusout","onBlur");$r(Yg,"onTransitionEnd");ns("onMouseEnter",["mouseout","mouseover"]);ns("onMouseLeave",["mouseout","mouseover"]);ns("onPointerEnter",["pointerout","pointerover"]);ns("onPointerLeave",["pointerout","pointerover"]);gi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gi("onBeforeInput",["compositionend","keypress","textInput","paste"]);gi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ys="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ys));function dp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,O_(r,e,void 0,t),t.currentTarget=null}function Jg(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],u=l.instance,h=l.currentTarget;if(l=l.listener,u!==s&&i.isPropagationStopped())break e;dp(i,l,h),s=u}else for(a=0;a<r.length;a++){if(l=r[a],u=l.instance,h=l.currentTarget,l=l.listener,u!==s&&i.isPropagationStopped())break e;dp(i,l,h),s=u}}}if(ll)throw t=Cc,ll=!1,Cc=null,t}function Ne(t,e){var n=e[Mc];n===void 0&&(n=e[Mc]=new Set);var r=t+"__bubble";n.has(r)||(Zg(e,t,2,!1),n.add(r))}function zu(t,e,n){var r=0;e&&(r|=4),Zg(n,t,r,e)}var ba="_reactListening"+Math.random().toString(36).slice(2);function Eo(t){if(!t[ba]){t[ba]=!0,og.forEach(function(n){n!=="selectionchange"&&(zx.has(n)||zu(n,!1,t),zu(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ba]||(e[ba]=!0,zu("selectionchange",!1,e))}}function Zg(t,e,n,r){switch(Mg(e)){case 1:var i=ex;break;case 4:i=tx;break;default:i=Hd}n=i.bind(null,e,n,t),i=void 0,!Ic||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Bu(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;a=a.return}for(;l!==null;){if(a=ti(l),a===null)return;if(u=a.tag,u===5||u===6){r=s=a;continue e}l=l.parentNode}}r=r.return}Sg(function(){var h=s,p=Bd(n),g=[];e:{var y=Xg.get(t);if(y!==void 0){var E=Gd,A=t;switch(t){case"keypress":if(Ga(n)===0)break e;case"keydown":case"keyup":E=gx;break;case"focusin":A="focus",E=ju;break;case"focusout":A="blur",E=ju;break;case"beforeblur":case"afterblur":E=ju;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=Zf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=ix;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=_x;break;case Gg:case Qg:case Kg:E=ax;break;case Yg:E=wx;break;case"scroll":E=nx;break;case"wheel":E=Ex;break;case"copy":case"cut":case"paste":E=ux;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=tp}var P=(e&4)!==0,F=!P&&t==="scroll",I=P?y!==null?y+"Capture":null:y;P=[];for(var S=h,C;S!==null;){C=S;var V=C.stateNode;if(C.tag===5&&V!==null&&(C=V,I!==null&&(V=yo(S,I),V!=null&&P.push(To(S,V,C)))),F)break;S=S.return}0<P.length&&(y=new E(y,A,null,n,p),g.push({event:y,listeners:P}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",y&&n!==Ec&&(A=n.relatedTarget||n.fromElement)&&(ti(A)||A[nr]))break e;if((E||y)&&(y=p.window===p?p:(y=p.ownerDocument)?y.defaultView||y.parentWindow:window,E?(A=n.relatedTarget||n.toElement,E=h,A=A?ti(A):null,A!==null&&(F=yi(A),A!==F||A.tag!==5&&A.tag!==6)&&(A=null)):(E=null,A=h),E!==A)){if(P=Zf,V="onMouseLeave",I="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(P=tp,V="onPointerLeave",I="onPointerEnter",S="pointer"),F=E==null?y:Ui(E),C=A==null?y:Ui(A),y=new P(V,S+"leave",E,n,p),y.target=F,y.relatedTarget=C,V=null,ti(p)===h&&(P=new P(I,S+"enter",A,n,p),P.target=C,P.relatedTarget=F,V=P),F=V,E&&A)t:{for(P=E,I=A,S=0,C=P;C;C=Ni(C))S++;for(C=0,V=I;V;V=Ni(V))C++;for(;0<S-C;)P=Ni(P),S--;for(;0<C-S;)I=Ni(I),C--;for(;S--;){if(P===I||I!==null&&P===I.alternate)break t;P=Ni(P),I=Ni(I)}P=null}else P=null;E!==null&&hp(g,y,E,P,!1),A!==null&&F!==null&&hp(g,F,A,P,!0)}}e:{if(y=h?Ui(h):window,E=y.nodeName&&y.nodeName.toLowerCase(),E==="select"||E==="input"&&y.type==="file")var L=Px;else if(ip(y))if(Ug)L=jx;else{L=Dx;var M=bx}else(E=y.nodeName)&&E.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(L=Nx);if(L&&(L=L(t,h))){Bg(g,L,n,p);break e}M&&M(t,y,h),t==="focusout"&&(M=y._wrapperState)&&M.controlled&&y.type==="number"&&vc(y,"number",y.value)}switch(M=h?Ui(h):window,t){case"focusin":(ip(M)||M.contentEditable==="true")&&(zi=M,Pc=h,so=null);break;case"focusout":so=Pc=zi=null;break;case"mousedown":bc=!0;break;case"contextmenu":case"mouseup":case"dragend":bc=!1,up(g,n,p);break;case"selectionchange":if(Lx)break;case"keydown":case"keyup":up(g,n,p)}var v;if(Kd)e:{switch(t){case"compositionstart":var m="onCompositionStart";break e;case"compositionend":m="onCompositionEnd";break e;case"compositionupdate":m="onCompositionUpdate";break e}m=void 0}else Fi?Fg(t,n)&&(m="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(m="onCompositionStart");m&&(Og&&n.locale!=="ko"&&(Fi||m!=="onCompositionStart"?m==="onCompositionEnd"&&Fi&&(v=Lg()):(Er=p,qd="value"in Er?Er.value:Er.textContent,Fi=!0)),M=fl(h,m),0<M.length&&(m=new ep(m,t,null,n,p),g.push({event:m,listeners:M}),v?m.data=v:(v=zg(n),v!==null&&(m.data=v)))),(v=Ix?Cx(t,n):Ax(t,n))&&(h=fl(h,"onBeforeInput"),0<h.length&&(p=new ep("onBeforeInput","beforeinput",null,n,p),g.push({event:p,listeners:h}),p.data=v))}Jg(g,e)})}function To(t,e,n){return{instance:t,listener:e,currentTarget:n}}function fl(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=yo(t,n),s!=null&&r.unshift(To(t,s,i)),s=yo(t,e),s!=null&&r.push(To(t,s,i))),t=t.return}return r}function Ni(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function hp(t,e,n,r,i){for(var s=e._reactName,a=[];n!==null&&n!==r;){var l=n,u=l.alternate,h=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&h!==null&&(l=h,i?(u=yo(n,s),u!=null&&a.unshift(To(n,u,l))):i||(u=yo(n,s),u!=null&&a.push(To(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var Bx=/\r\n?/g,Ux=/\u0000|\uFFFD/g;function fp(t){return(typeof t=="string"?t:""+t).replace(Bx,`
`).replace(Ux,"")}function Da(t,e,n){if(e=fp(e),fp(t)!==e&&n)throw Error(H(425))}function pl(){}var Dc=null,Nc=null;function jc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Vc=typeof setTimeout=="function"?setTimeout:void 0,$x=typeof clearTimeout=="function"?clearTimeout:void 0,pp=typeof Promise=="function"?Promise:void 0,Wx=typeof queueMicrotask=="function"?queueMicrotask:typeof pp<"u"?function(t){return pp.resolve(null).then(t).catch(Hx)}:Vc;function Hx(t){setTimeout(function(){throw t})}function Uu(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),xo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);xo(e)}function Rr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function mp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var vs=Math.random().toString(36).slice(2),Vn="__reactFiber$"+vs,Io="__reactProps$"+vs,nr="__reactContainer$"+vs,Mc="__reactEvents$"+vs,qx="__reactListeners$"+vs,Gx="__reactHandles$"+vs;function ti(t){var e=t[Vn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[nr]||n[Vn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=mp(t);t!==null;){if(n=t[Vn])return n;t=mp(t)}return e}t=n,n=t.parentNode}return null}function qo(t){return t=t[Vn]||t[nr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ui(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function ql(t){return t[Io]||null}var Lc=[],$i=-1;function Wr(t){return{current:t}}function Ve(t){0>$i||(t.current=Lc[$i],Lc[$i]=null,$i--)}function be(t,e){$i++,Lc[$i]=t.current,t.current=e}var Fr={},bt=Wr(Fr),$t=Wr(!1),li=Fr;function rs(t,e){var n=t.type.contextTypes;if(!n)return Fr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Wt(t){return t=t.childContextTypes,t!=null}function ml(){Ve($t),Ve(bt)}function gp(t,e,n){if(bt.current!==Fr)throw Error(H(168));be(bt,e),be($t,n)}function ey(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(H(108,b_(t)||"Unknown",i));return Be({},n,r)}function gl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Fr,li=bt.current,be(bt,t),be($t,$t.current),!0}function yp(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=ey(t,e,li),r.__reactInternalMemoizedMergedChildContext=t,Ve($t),Ve(bt),be(bt,t)):Ve($t),be($t,n)}var Qn=null,Gl=!1,$u=!1;function ty(t){Qn===null?Qn=[t]:Qn.push(t)}function Qx(t){Gl=!0,ty(t)}function Hr(){if(!$u&&Qn!==null){$u=!0;var t=0,e=Ee;try{var n=Qn;for(Ee=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Qn=null,Gl=!1}catch(i){throw Qn!==null&&(Qn=Qn.slice(t+1)),Cg(Ud,Hr),i}finally{Ee=e,$u=!1}}return null}var Wi=[],Hi=0,yl=null,vl=0,dn=[],hn=0,ui=null,Yn=1,Xn="";function Jr(t,e){Wi[Hi++]=vl,Wi[Hi++]=yl,yl=t,vl=e}function ny(t,e,n){dn[hn++]=Yn,dn[hn++]=Xn,dn[hn++]=ui,ui=t;var r=Yn;t=Xn;var i=32-In(r)-1;r&=~(1<<i),n+=1;var s=32-In(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Yn=1<<32-In(e)+i|n<<i|r,Xn=s+t}else Yn=1<<s|n<<i|r,Xn=t}function Xd(t){t.return!==null&&(Jr(t,1),ny(t,1,0))}function Jd(t){for(;t===yl;)yl=Wi[--Hi],Wi[Hi]=null,vl=Wi[--Hi],Wi[Hi]=null;for(;t===ui;)ui=dn[--hn],dn[hn]=null,Xn=dn[--hn],dn[hn]=null,Yn=dn[--hn],dn[hn]=null}var rn=null,tn=null,Me=!1,En=null;function ry(t,e){var n=fn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function vp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,rn=t,tn=Rr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,rn=t,tn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ui!==null?{id:Yn,overflow:Xn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=fn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,rn=t,tn=null,!0):!1;default:return!1}}function Oc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Fc(t){if(Me){var e=tn;if(e){var n=e;if(!vp(t,e)){if(Oc(t))throw Error(H(418));e=Rr(n.nextSibling);var r=rn;e&&vp(t,e)?ry(r,n):(t.flags=t.flags&-4097|2,Me=!1,rn=t)}}else{if(Oc(t))throw Error(H(418));t.flags=t.flags&-4097|2,Me=!1,rn=t}}}function _p(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;rn=t}function Na(t){if(t!==rn)return!1;if(!Me)return _p(t),Me=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!jc(t.type,t.memoizedProps)),e&&(e=tn)){if(Oc(t))throw iy(),Error(H(418));for(;e;)ry(t,e),e=Rr(e.nextSibling)}if(_p(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){tn=Rr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}tn=null}}else tn=rn?Rr(t.stateNode.nextSibling):null;return!0}function iy(){for(var t=tn;t;)t=Rr(t.nextSibling)}function is(){tn=rn=null,Me=!1}function Zd(t){En===null?En=[t]:En.push(t)}var Kx=ur.ReactCurrentBatchConfig;function $s(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var l=i.refs;a===null?delete l[s]:l[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function ja(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function xp(t){var e=t._init;return e(t._payload)}function sy(t){function e(I,S){if(t){var C=I.deletions;C===null?(I.deletions=[S],I.flags|=16):C.push(S)}}function n(I,S){if(!t)return null;for(;S!==null;)e(I,S),S=S.sibling;return null}function r(I,S){for(I=new Map;S!==null;)S.key!==null?I.set(S.key,S):I.set(S.index,S),S=S.sibling;return I}function i(I,S){return I=Nr(I,S),I.index=0,I.sibling=null,I}function s(I,S,C){return I.index=C,t?(C=I.alternate,C!==null?(C=C.index,C<S?(I.flags|=2,S):C):(I.flags|=2,S)):(I.flags|=1048576,S)}function a(I){return t&&I.alternate===null&&(I.flags|=2),I}function l(I,S,C,V){return S===null||S.tag!==6?(S=Yu(C,I.mode,V),S.return=I,S):(S=i(S,C),S.return=I,S)}function u(I,S,C,V){var L=C.type;return L===Oi?p(I,S,C.props.children,V,C.key):S!==null&&(S.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===_r&&xp(L)===S.type)?(V=i(S,C.props),V.ref=$s(I,S,C),V.return=I,V):(V=el(C.type,C.key,C.props,null,I.mode,V),V.ref=$s(I,S,C),V.return=I,V)}function h(I,S,C,V){return S===null||S.tag!==4||S.stateNode.containerInfo!==C.containerInfo||S.stateNode.implementation!==C.implementation?(S=Xu(C,I.mode,V),S.return=I,S):(S=i(S,C.children||[]),S.return=I,S)}function p(I,S,C,V,L){return S===null||S.tag!==7?(S=oi(C,I.mode,V,L),S.return=I,S):(S=i(S,C),S.return=I,S)}function g(I,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Yu(""+S,I.mode,C),S.return=I,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ea:return C=el(S.type,S.key,S.props,null,I.mode,C),C.ref=$s(I,null,S),C.return=I,C;case Li:return S=Xu(S,I.mode,C),S.return=I,S;case _r:var V=S._init;return g(I,V(S._payload),C)}if(Qs(S)||Os(S))return S=oi(S,I.mode,C,null),S.return=I,S;ja(I,S)}return null}function y(I,S,C,V){var L=S!==null?S.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return L!==null?null:l(I,S,""+C,V);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Ea:return C.key===L?u(I,S,C,V):null;case Li:return C.key===L?h(I,S,C,V):null;case _r:return L=C._init,y(I,S,L(C._payload),V)}if(Qs(C)||Os(C))return L!==null?null:p(I,S,C,V,null);ja(I,C)}return null}function E(I,S,C,V,L){if(typeof V=="string"&&V!==""||typeof V=="number")return I=I.get(C)||null,l(S,I,""+V,L);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Ea:return I=I.get(V.key===null?C:V.key)||null,u(S,I,V,L);case Li:return I=I.get(V.key===null?C:V.key)||null,h(S,I,V,L);case _r:var M=V._init;return E(I,S,C,M(V._payload),L)}if(Qs(V)||Os(V))return I=I.get(C)||null,p(S,I,V,L,null);ja(S,V)}return null}function A(I,S,C,V){for(var L=null,M=null,v=S,m=S=0,x=null;v!==null&&m<C.length;m++){v.index>m?(x=v,v=null):x=v.sibling;var w=y(I,v,C[m],V);if(w===null){v===null&&(v=x);break}t&&v&&w.alternate===null&&e(I,v),S=s(w,S,m),M===null?L=w:M.sibling=w,M=w,v=x}if(m===C.length)return n(I,v),Me&&Jr(I,m),L;if(v===null){for(;m<C.length;m++)v=g(I,C[m],V),v!==null&&(S=s(v,S,m),M===null?L=v:M.sibling=v,M=v);return Me&&Jr(I,m),L}for(v=r(I,v);m<C.length;m++)x=E(v,I,m,C[m],V),x!==null&&(t&&x.alternate!==null&&v.delete(x.key===null?m:x.key),S=s(x,S,m),M===null?L=x:M.sibling=x,M=x);return t&&v.forEach(function(k){return e(I,k)}),Me&&Jr(I,m),L}function P(I,S,C,V){var L=Os(C);if(typeof L!="function")throw Error(H(150));if(C=L.call(C),C==null)throw Error(H(151));for(var M=L=null,v=S,m=S=0,x=null,w=C.next();v!==null&&!w.done;m++,w=C.next()){v.index>m?(x=v,v=null):x=v.sibling;var k=y(I,v,w.value,V);if(k===null){v===null&&(v=x);break}t&&v&&k.alternate===null&&e(I,v),S=s(k,S,m),M===null?L=k:M.sibling=k,M=k,v=x}if(w.done)return n(I,v),Me&&Jr(I,m),L;if(v===null){for(;!w.done;m++,w=C.next())w=g(I,w.value,V),w!==null&&(S=s(w,S,m),M===null?L=w:M.sibling=w,M=w);return Me&&Jr(I,m),L}for(v=r(I,v);!w.done;m++,w=C.next())w=E(v,I,m,w.value,V),w!==null&&(t&&w.alternate!==null&&v.delete(w.key===null?m:w.key),S=s(w,S,m),M===null?L=w:M.sibling=w,M=w);return t&&v.forEach(function(R){return e(I,R)}),Me&&Jr(I,m),L}function F(I,S,C,V){if(typeof C=="object"&&C!==null&&C.type===Oi&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case Ea:e:{for(var L=C.key,M=S;M!==null;){if(M.key===L){if(L=C.type,L===Oi){if(M.tag===7){n(I,M.sibling),S=i(M,C.props.children),S.return=I,I=S;break e}}else if(M.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===_r&&xp(L)===M.type){n(I,M.sibling),S=i(M,C.props),S.ref=$s(I,M,C),S.return=I,I=S;break e}n(I,M);break}else e(I,M);M=M.sibling}C.type===Oi?(S=oi(C.props.children,I.mode,V,C.key),S.return=I,I=S):(V=el(C.type,C.key,C.props,null,I.mode,V),V.ref=$s(I,S,C),V.return=I,I=V)}return a(I);case Li:e:{for(M=C.key;S!==null;){if(S.key===M)if(S.tag===4&&S.stateNode.containerInfo===C.containerInfo&&S.stateNode.implementation===C.implementation){n(I,S.sibling),S=i(S,C.children||[]),S.return=I,I=S;break e}else{n(I,S);break}else e(I,S);S=S.sibling}S=Xu(C,I.mode,V),S.return=I,I=S}return a(I);case _r:return M=C._init,F(I,S,M(C._payload),V)}if(Qs(C))return A(I,S,C,V);if(Os(C))return P(I,S,C,V);ja(I,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,S!==null&&S.tag===6?(n(I,S.sibling),S=i(S,C),S.return=I,I=S):(n(I,S),S=Yu(C,I.mode,V),S.return=I,I=S),a(I)):n(I,S)}return F}var ss=sy(!0),oy=sy(!1),_l=Wr(null),xl=null,qi=null,eh=null;function th(){eh=qi=xl=null}function nh(t){var e=_l.current;Ve(_l),t._currentValue=e}function zc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Zi(t,e){xl=t,eh=qi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ut=!0),t.firstContext=null)}function mn(t){var e=t._currentValue;if(eh!==t)if(t={context:t,memoizedValue:e,next:null},qi===null){if(xl===null)throw Error(H(308));qi=t,xl.dependencies={lanes:0,firstContext:t}}else qi=qi.next=t;return e}var ni=null;function rh(t){ni===null?ni=[t]:ni.push(t)}function ay(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,rh(e)):(n.next=i.next,i.next=n),e.interleaved=n,rr(t,r)}function rr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var xr=!1;function ih(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ly(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Jn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Pr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,rr(t,n)}return i=r.interleaved,i===null?(e.next=e,rh(r)):(e.next=i.next,i.next=e),r.interleaved=e,rr(t,n)}function Qa(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,$d(t,n)}}function wp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function wl(t,e,n,r){var i=t.updateQueue;xr=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,h=u.next;u.next=null,a===null?s=h:a.next=h,a=u;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==a&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=u))}if(s!==null){var g=i.baseState;a=0,p=h=u=null,l=s;do{var y=l.lane,E=l.eventTime;if((r&y)===y){p!==null&&(p=p.next={eventTime:E,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var A=t,P=l;switch(y=e,E=n,P.tag){case 1:if(A=P.payload,typeof A=="function"){g=A.call(E,g,y);break e}g=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=P.payload,y=typeof A=="function"?A.call(E,g,y):A,y==null)break e;g=Be({},g,y);break e;case 2:xr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=i.effects,y===null?i.effects=[l]:y.push(l))}else E={eventTime:E,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=E,u=g):p=p.next=E,a|=y;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;y=l,l=y.next,y.next=null,i.lastBaseUpdate=y,i.shared.pending=null}}while(!0);if(p===null&&(u=g),i.baseState=u,i.firstBaseUpdate=h,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);di|=a,t.lanes=a,t.memoizedState=g}}function Sp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(H(191,i));i.call(r)}}}var Go={},Ln=Wr(Go),Co=Wr(Go),Ao=Wr(Go);function ri(t){if(t===Go)throw Error(H(174));return t}function sh(t,e){switch(be(Ao,e),be(Co,t),be(Ln,Go),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:xc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=xc(e,t)}Ve(Ln),be(Ln,e)}function os(){Ve(Ln),Ve(Co),Ve(Ao)}function uy(t){ri(Ao.current);var e=ri(Ln.current),n=xc(e,t.type);e!==n&&(be(Co,t),be(Ln,n))}function oh(t){Co.current===t&&(Ve(Ln),Ve(Co))}var Fe=Wr(0);function Sl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Wu=[];function ah(){for(var t=0;t<Wu.length;t++)Wu[t]._workInProgressVersionPrimary=null;Wu.length=0}var Ka=ur.ReactCurrentDispatcher,Hu=ur.ReactCurrentBatchConfig,ci=0,ze=null,ot=null,dt=null,El=!1,oo=!1,ko=0,Yx=0;function It(){throw Error(H(321))}function lh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!kn(t[n],e[n]))return!1;return!0}function uh(t,e,n,r,i,s){if(ci=s,ze=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ka.current=t===null||t.memoizedState===null?e1:t1,t=n(r,i),oo){s=0;do{if(oo=!1,ko=0,25<=s)throw Error(H(301));s+=1,dt=ot=null,e.updateQueue=null,Ka.current=n1,t=n(r,i)}while(oo)}if(Ka.current=Tl,e=ot!==null&&ot.next!==null,ci=0,dt=ot=ze=null,El=!1,e)throw Error(H(300));return t}function ch(){var t=ko!==0;return ko=0,t}function jn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?ze.memoizedState=dt=t:dt=dt.next=t,dt}function gn(){if(ot===null){var t=ze.alternate;t=t!==null?t.memoizedState:null}else t=ot.next;var e=dt===null?ze.memoizedState:dt.next;if(e!==null)dt=e,ot=t;else{if(t===null)throw Error(H(310));ot=t,t={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},dt===null?ze.memoizedState=dt=t:dt=dt.next=t}return dt}function Ro(t,e){return typeof e=="function"?e(t):e}function qu(t){var e=gn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=ot,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=a=null,u=null,h=s;do{var p=h.lane;if((ci&p)===p)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var g={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(l=u=g,a=r):u=u.next=g,ze.lanes|=p,di|=p}h=h.next}while(h!==null&&h!==s);u===null?a=r:u.next=l,kn(r,e.memoizedState)||(Ut=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ze.lanes|=s,di|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Gu(t){var e=gn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);kn(s,e.memoizedState)||(Ut=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function cy(){}function dy(t,e){var n=ze,r=gn(),i=e(),s=!kn(r.memoizedState,i);if(s&&(r.memoizedState=i,Ut=!0),r=r.queue,dh(py.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||dt!==null&&dt.memoizedState.tag&1){if(n.flags|=2048,Po(9,fy.bind(null,n,r,i,e),void 0,null),ht===null)throw Error(H(349));ci&30||hy(n,e,i)}return i}function hy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function fy(t,e,n,r){e.value=n,e.getSnapshot=r,my(e)&&gy(t)}function py(t,e,n){return n(function(){my(e)&&gy(t)})}function my(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!kn(t,n)}catch{return!0}}function gy(t){var e=rr(t,1);e!==null&&Cn(e,t,1,-1)}function Ep(t){var e=jn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ro,lastRenderedState:t},e.queue=t,t=t.dispatch=Zx.bind(null,ze,t),[e.memoizedState,t]}function Po(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ze.updateQueue,e===null?(e={lastEffect:null,stores:null},ze.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function yy(){return gn().memoizedState}function Ya(t,e,n,r){var i=jn();ze.flags|=t,i.memoizedState=Po(1|e,n,void 0,r===void 0?null:r)}function Ql(t,e,n,r){var i=gn();r=r===void 0?null:r;var s=void 0;if(ot!==null){var a=ot.memoizedState;if(s=a.destroy,r!==null&&lh(r,a.deps)){i.memoizedState=Po(e,n,s,r);return}}ze.flags|=t,i.memoizedState=Po(1|e,n,s,r)}function Tp(t,e){return Ya(8390656,8,t,e)}function dh(t,e){return Ql(2048,8,t,e)}function vy(t,e){return Ql(4,2,t,e)}function _y(t,e){return Ql(4,4,t,e)}function xy(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function wy(t,e,n){return n=n!=null?n.concat([t]):null,Ql(4,4,xy.bind(null,e,t),n)}function hh(){}function Sy(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&lh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ey(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&lh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ty(t,e,n){return ci&21?(kn(n,e)||(n=Rg(),ze.lanes|=n,di|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ut=!0),t.memoizedState=n)}function Xx(t,e){var n=Ee;Ee=n!==0&&4>n?n:4,t(!0);var r=Hu.transition;Hu.transition={};try{t(!1),e()}finally{Ee=n,Hu.transition=r}}function Iy(){return gn().memoizedState}function Jx(t,e,n){var r=Dr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Cy(t))Ay(e,n);else if(n=ay(t,e,n,r),n!==null){var i=jt();Cn(n,t,r,i),ky(n,e,r)}}function Zx(t,e,n){var r=Dr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Cy(t))Ay(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,l=s(a,n);if(i.hasEagerState=!0,i.eagerState=l,kn(l,a)){var u=e.interleaved;u===null?(i.next=i,rh(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=ay(t,e,i,r),n!==null&&(i=jt(),Cn(n,t,r,i),ky(n,e,r))}}function Cy(t){var e=t.alternate;return t===ze||e!==null&&e===ze}function Ay(t,e){oo=El=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ky(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,$d(t,n)}}var Tl={readContext:mn,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useInsertionEffect:It,useLayoutEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useMutableSource:It,useSyncExternalStore:It,useId:It,unstable_isNewReconciler:!1},e1={readContext:mn,useCallback:function(t,e){return jn().memoizedState=[t,e===void 0?null:e],t},useContext:mn,useEffect:Tp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ya(4194308,4,xy.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ya(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ya(4,2,t,e)},useMemo:function(t,e){var n=jn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=jn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Jx.bind(null,ze,t),[r.memoizedState,t]},useRef:function(t){var e=jn();return t={current:t},e.memoizedState=t},useState:Ep,useDebugValue:hh,useDeferredValue:function(t){return jn().memoizedState=t},useTransition:function(){var t=Ep(!1),e=t[0];return t=Xx.bind(null,t[1]),jn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ze,i=jn();if(Me){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),ht===null)throw Error(H(349));ci&30||hy(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Tp(py.bind(null,r,s,t),[t]),r.flags|=2048,Po(9,fy.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=jn(),e=ht.identifierPrefix;if(Me){var n=Xn,r=Yn;n=(r&~(1<<32-In(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ko++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Yx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},t1={readContext:mn,useCallback:Sy,useContext:mn,useEffect:dh,useImperativeHandle:wy,useInsertionEffect:vy,useLayoutEffect:_y,useMemo:Ey,useReducer:qu,useRef:yy,useState:function(){return qu(Ro)},useDebugValue:hh,useDeferredValue:function(t){var e=gn();return Ty(e,ot.memoizedState,t)},useTransition:function(){var t=qu(Ro)[0],e=gn().memoizedState;return[t,e]},useMutableSource:cy,useSyncExternalStore:dy,useId:Iy,unstable_isNewReconciler:!1},n1={readContext:mn,useCallback:Sy,useContext:mn,useEffect:dh,useImperativeHandle:wy,useInsertionEffect:vy,useLayoutEffect:_y,useMemo:Ey,useReducer:Gu,useRef:yy,useState:function(){return Gu(Ro)},useDebugValue:hh,useDeferredValue:function(t){var e=gn();return ot===null?e.memoizedState=t:Ty(e,ot.memoizedState,t)},useTransition:function(){var t=Gu(Ro)[0],e=gn().memoizedState;return[t,e]},useMutableSource:cy,useSyncExternalStore:dy,useId:Iy,unstable_isNewReconciler:!1};function wn(t,e){if(t&&t.defaultProps){e=Be({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Bc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Be({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Kl={isMounted:function(t){return(t=t._reactInternals)?yi(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=jt(),i=Dr(t),s=Jn(r,i);s.payload=e,n!=null&&(s.callback=n),e=Pr(t,s,i),e!==null&&(Cn(e,t,i,r),Qa(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=jt(),i=Dr(t),s=Jn(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Pr(t,s,i),e!==null&&(Cn(e,t,i,r),Qa(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=jt(),r=Dr(t),i=Jn(n,r);i.tag=2,e!=null&&(i.callback=e),e=Pr(t,i,r),e!==null&&(Cn(e,t,r,n),Qa(e,t,r))}};function Ip(t,e,n,r,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!So(n,r)||!So(i,s):!0}function Ry(t,e,n){var r=!1,i=Fr,s=e.contextType;return typeof s=="object"&&s!==null?s=mn(s):(i=Wt(e)?li:bt.current,r=e.contextTypes,s=(r=r!=null)?rs(t,i):Fr),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Kl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Cp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Kl.enqueueReplaceState(e,e.state,null)}function Uc(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},ih(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=mn(s):(s=Wt(e)?li:bt.current,i.context=rs(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Bc(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Kl.enqueueReplaceState(i,i.state,null),wl(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function as(t,e){try{var n="",r=e;do n+=P_(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Qu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function $c(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var r1=typeof WeakMap=="function"?WeakMap:Map;function Py(t,e,n){n=Jn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Cl||(Cl=!0,Zc=r),$c(t,e)},n}function by(t,e,n){n=Jn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){$c(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){$c(t,e),typeof r!="function"&&(br===null?br=new Set([this]):br.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Ap(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new r1;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=y1.bind(null,t,e,n),e.then(t,t))}function kp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Rp(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Jn(-1,1),e.tag=2,Pr(n,e,1))),n.lanes|=1),t)}var i1=ur.ReactCurrentOwner,Ut=!1;function Nt(t,e,n,r){e.child=t===null?oy(e,null,n,r):ss(e,t.child,n,r)}function Pp(t,e,n,r,i){n=n.render;var s=e.ref;return Zi(e,i),r=uh(t,e,n,r,s,i),n=ch(),t!==null&&!Ut?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ir(t,e,i)):(Me&&n&&Xd(e),e.flags|=1,Nt(t,e,r,i),e.child)}function bp(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!xh(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Dy(t,e,s,r,i)):(t=el(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:So,n(a,r)&&t.ref===e.ref)return ir(t,e,i)}return e.flags|=1,t=Nr(s,r),t.ref=e.ref,t.return=e,e.child=t}function Dy(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(So(s,r)&&t.ref===e.ref)if(Ut=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Ut=!0);else return e.lanes=t.lanes,ir(t,e,i)}return Wc(t,e,n,r,i)}function Ny(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},be(Qi,en),en|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,be(Qi,en),en|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,be(Qi,en),en|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,be(Qi,en),en|=r;return Nt(t,e,i,n),e.child}function jy(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Wc(t,e,n,r,i){var s=Wt(n)?li:bt.current;return s=rs(e,s),Zi(e,i),n=uh(t,e,n,r,s,i),r=ch(),t!==null&&!Ut?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ir(t,e,i)):(Me&&r&&Xd(e),e.flags|=1,Nt(t,e,n,i),e.child)}function Dp(t,e,n,r,i){if(Wt(n)){var s=!0;gl(e)}else s=!1;if(Zi(e,i),e.stateNode===null)Xa(t,e),Ry(e,n,r),Uc(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=mn(h):(h=Wt(n)?li:bt.current,h=rs(e,h));var p=n.getDerivedStateFromProps,g=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";g||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||u!==h)&&Cp(e,a,r,h),xr=!1;var y=e.memoizedState;a.state=y,wl(e,r,a,i),u=e.memoizedState,l!==r||y!==u||$t.current||xr?(typeof p=="function"&&(Bc(e,n,p,r),u=e.memoizedState),(l=xr||Ip(e,n,l,r,y,u,h))?(g||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,ly(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:wn(e.type,l),a.props=h,g=e.pendingProps,y=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=mn(u):(u=Wt(n)?li:bt.current,u=rs(e,u));var E=n.getDerivedStateFromProps;(p=typeof E=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==g||y!==u)&&Cp(e,a,r,u),xr=!1,y=e.memoizedState,a.state=y,wl(e,r,a,i);var A=e.memoizedState;l!==g||y!==A||$t.current||xr?(typeof E=="function"&&(Bc(e,n,E,r),A=e.memoizedState),(h=xr||Ip(e,n,h,r,y,A,u)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,A,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,A,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),a.props=r,a.state=A,a.context=u,r=h):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return Hc(t,e,n,r,s,i)}function Hc(t,e,n,r,i,s){jy(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&yp(e,n,!1),ir(t,e,s);r=e.stateNode,i1.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=ss(e,t.child,null,s),e.child=ss(e,null,l,s)):Nt(t,e,l,s),e.memoizedState=r.state,i&&yp(e,n,!0),e.child}function Vy(t){var e=t.stateNode;e.pendingContext?gp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&gp(t,e.context,!1),sh(t,e.containerInfo)}function Np(t,e,n,r,i){return is(),Zd(i),e.flags|=256,Nt(t,e,n,r),e.child}var qc={dehydrated:null,treeContext:null,retryLane:0};function Gc(t){return{baseLanes:t,cachePool:null,transitions:null}}function My(t,e,n){var r=e.pendingProps,i=Fe.current,s=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),be(Fe,i&1),t===null)return Fc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Jl(a,r,0,null),t=oi(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Gc(n),e.memoizedState=qc,t):fh(e,a));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return s1(t,e,a,r,l,i,n);if(s){s=r.fallback,a=e.mode,i=t.child,l=i.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Nr(i,u),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Nr(l,s):(s=oi(s,a,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=t.child.memoizedState,a=a===null?Gc(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=qc,r}return s=t.child,t=s.sibling,r=Nr(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function fh(t,e){return e=Jl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Va(t,e,n,r){return r!==null&&Zd(r),ss(e,t.child,null,n),t=fh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function s1(t,e,n,r,i,s,a){if(n)return e.flags&256?(e.flags&=-257,r=Qu(Error(H(422))),Va(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Jl({mode:"visible",children:r.children},i,0,null),s=oi(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ss(e,t.child,null,a),e.child.memoizedState=Gc(a),e.memoizedState=qc,s);if(!(e.mode&1))return Va(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(H(419)),r=Qu(s,r,void 0),Va(t,e,a,r)}if(l=(a&t.childLanes)!==0,Ut||l){if(r=ht,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,rr(t,i),Cn(r,t,i,-1))}return _h(),r=Qu(Error(H(421))),Va(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=v1.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,tn=Rr(i.nextSibling),rn=e,Me=!0,En=null,t!==null&&(dn[hn++]=Yn,dn[hn++]=Xn,dn[hn++]=ui,Yn=t.id,Xn=t.overflow,ui=e),e=fh(e,r.children),e.flags|=4096,e)}function jp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),zc(t.return,e,n)}function Ku(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Ly(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Nt(t,e,r.children,n),r=Fe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&jp(t,n,e);else if(t.tag===19)jp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(be(Fe,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Sl(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Ku(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Sl(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Ku(e,!0,n,null,s);break;case"together":Ku(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Xa(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ir(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),di|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=Nr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Nr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function o1(t,e,n){switch(e.tag){case 3:Vy(e),is();break;case 5:uy(e);break;case 1:Wt(e.type)&&gl(e);break;case 4:sh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;be(_l,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(be(Fe,Fe.current&1),e.flags|=128,null):n&e.child.childLanes?My(t,e,n):(be(Fe,Fe.current&1),t=ir(t,e,n),t!==null?t.sibling:null);be(Fe,Fe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Ly(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),be(Fe,Fe.current),r)break;return null;case 22:case 23:return e.lanes=0,Ny(t,e,n)}return ir(t,e,n)}var Oy,Qc,Fy,zy;Oy=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Qc=function(){};Fy=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ri(Ln.current);var s=null;switch(n){case"input":i=gc(t,i),r=gc(t,r),s=[];break;case"select":i=Be({},i,{value:void 0}),r=Be({},r,{value:void 0}),s=[];break;case"textarea":i=_c(t,i),r=_c(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=pl)}wc(n,r);var a;n=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var l=i[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(mo.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var u=r[h];if(l=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&u!==l&&(u!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(s||(s=[]),s.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(s=s||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(mo.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&Ne("scroll",t),s||l===u||(s=[])):(s=s||[]).push(h,u))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};zy=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ws(t,e){if(!Me)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ct(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function a1(t,e,n){var r=e.pendingProps;switch(Jd(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ct(e),null;case 1:return Wt(e.type)&&ml(),Ct(e),null;case 3:return r=e.stateNode,os(),Ve($t),Ve(bt),ah(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Na(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,En!==null&&(nd(En),En=null))),Qc(t,e),Ct(e),null;case 5:oh(e);var i=ri(Ao.current);if(n=e.type,t!==null&&e.stateNode!=null)Fy(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return Ct(e),null}if(t=ri(Ln.current),Na(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Vn]=e,r[Io]=s,t=(e.mode&1)!==0,n){case"dialog":Ne("cancel",r),Ne("close",r);break;case"iframe":case"object":case"embed":Ne("load",r);break;case"video":case"audio":for(i=0;i<Ys.length;i++)Ne(Ys[i],r);break;case"source":Ne("error",r);break;case"img":case"image":case"link":Ne("error",r),Ne("load",r);break;case"details":Ne("toggle",r);break;case"input":$f(r,s),Ne("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ne("invalid",r);break;case"textarea":Hf(r,s),Ne("invalid",r)}wc(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&Da(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Da(r.textContent,l,t),i=["children",""+l]):mo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Ne("scroll",r)}switch(n){case"input":Ta(r),Wf(r,s,!0);break;case"textarea":Ta(r),qf(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=pl)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=pg(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Vn]=e,t[Io]=r,Oy(t,e,!1,!1),e.stateNode=t;e:{switch(a=Sc(n,r),n){case"dialog":Ne("cancel",t),Ne("close",t),i=r;break;case"iframe":case"object":case"embed":Ne("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ys.length;i++)Ne(Ys[i],t);i=r;break;case"source":Ne("error",t),i=r;break;case"img":case"image":case"link":Ne("error",t),Ne("load",t),i=r;break;case"details":Ne("toggle",t),i=r;break;case"input":$f(t,r),i=gc(t,r),Ne("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Be({},r,{value:void 0}),Ne("invalid",t);break;case"textarea":Hf(t,r),i=_c(t,r),Ne("invalid",t);break;default:i=r}wc(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?yg(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&mg(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&go(t,u):typeof u=="number"&&go(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(mo.hasOwnProperty(s)?u!=null&&s==="onScroll"&&Ne("scroll",t):u!=null&&Ld(t,s,u,a))}switch(n){case"input":Ta(t),Wf(t,r,!1);break;case"textarea":Ta(t),qf(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Or(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Ki(t,!!r.multiple,s,!1):r.defaultValue!=null&&Ki(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=pl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ct(e),null;case 6:if(t&&e.stateNode!=null)zy(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=ri(Ao.current),ri(Ln.current),Na(e)){if(r=e.stateNode,n=e.memoizedProps,r[Vn]=e,(s=r.nodeValue!==n)&&(t=rn,t!==null))switch(t.tag){case 3:Da(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Da(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Vn]=e,e.stateNode=r}return Ct(e),null;case 13:if(Ve(Fe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Me&&tn!==null&&e.mode&1&&!(e.flags&128))iy(),is(),e.flags|=98560,s=!1;else if(s=Na(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(H(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(H(317));s[Vn]=e}else is(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ct(e),s=!1}else En!==null&&(nd(En),En=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Fe.current&1?at===0&&(at=3):_h())),e.updateQueue!==null&&(e.flags|=4),Ct(e),null);case 4:return os(),Qc(t,e),t===null&&Eo(e.stateNode.containerInfo),Ct(e),null;case 10:return nh(e.type._context),Ct(e),null;case 17:return Wt(e.type)&&ml(),Ct(e),null;case 19:if(Ve(Fe),s=e.memoizedState,s===null)return Ct(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)Ws(s,!1);else{if(at!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Sl(t),a!==null){for(e.flags|=128,Ws(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return be(Fe,Fe.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ye()>ls&&(e.flags|=128,r=!0,Ws(s,!1),e.lanes=4194304)}else{if(!r)if(t=Sl(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ws(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Me)return Ct(e),null}else 2*Ye()-s.renderingStartTime>ls&&n!==1073741824&&(e.flags|=128,r=!0,Ws(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ye(),e.sibling=null,n=Fe.current,be(Fe,r?n&1|2:n&1),e):(Ct(e),null);case 22:case 23:return vh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?en&1073741824&&(Ct(e),e.subtreeFlags&6&&(e.flags|=8192)):Ct(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function l1(t,e){switch(Jd(e),e.tag){case 1:return Wt(e.type)&&ml(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return os(),Ve($t),Ve(bt),ah(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return oh(e),null;case 13:if(Ve(Fe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));is()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ve(Fe),null;case 4:return os(),null;case 10:return nh(e.type._context),null;case 22:case 23:return vh(),null;case 24:return null;default:return null}}var Ma=!1,kt=!1,u1=typeof WeakSet=="function"?WeakSet:Set,X=null;function Gi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qe(t,e,r)}else n.current=null}function Kc(t,e,n){try{n()}catch(r){qe(t,e,r)}}var Vp=!1;function c1(t,e){if(Dc=dl,t=Hg(),Yd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,l=-1,u=-1,h=0,p=0,g=t,y=null;t:for(;;){for(var E;g!==n||i!==0&&g.nodeType!==3||(l=a+i),g!==s||r!==0&&g.nodeType!==3||(u=a+r),g.nodeType===3&&(a+=g.nodeValue.length),(E=g.firstChild)!==null;)y=g,g=E;for(;;){if(g===t)break t;if(y===n&&++h===i&&(l=a),y===s&&++p===r&&(u=a),(E=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=E}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Nc={focusedElem:t,selectionRange:n},dl=!1,X=e;X!==null;)if(e=X,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,X=t;else for(;X!==null;){e=X;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var P=A.memoizedProps,F=A.memoizedState,I=e.stateNode,S=I.getSnapshotBeforeUpdate(e.elementType===e.type?P:wn(e.type,P),F);I.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(V){qe(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,X=t;break}X=e.return}return A=Vp,Vp=!1,A}function ao(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Kc(e,n,s)}i=i.next}while(i!==r)}}function Yl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Yc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function By(t){var e=t.alternate;e!==null&&(t.alternate=null,By(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Vn],delete e[Io],delete e[Mc],delete e[qx],delete e[Gx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Uy(t){return t.tag===5||t.tag===3||t.tag===4}function Mp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Uy(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Xc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=pl));else if(r!==4&&(t=t.child,t!==null))for(Xc(t,e,n),t=t.sibling;t!==null;)Xc(t,e,n),t=t.sibling}function Jc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Jc(t,e,n),t=t.sibling;t!==null;)Jc(t,e,n),t=t.sibling}var mt=null,Sn=!1;function vr(t,e,n){for(n=n.child;n!==null;)$y(t,e,n),n=n.sibling}function $y(t,e,n){if(Mn&&typeof Mn.onCommitFiberUnmount=="function")try{Mn.onCommitFiberUnmount(Ul,n)}catch{}switch(n.tag){case 5:kt||Gi(n,e);case 6:var r=mt,i=Sn;mt=null,vr(t,e,n),mt=r,Sn=i,mt!==null&&(Sn?(t=mt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):mt.removeChild(n.stateNode));break;case 18:mt!==null&&(Sn?(t=mt,n=n.stateNode,t.nodeType===8?Uu(t.parentNode,n):t.nodeType===1&&Uu(t,n),xo(t)):Uu(mt,n.stateNode));break;case 4:r=mt,i=Sn,mt=n.stateNode.containerInfo,Sn=!0,vr(t,e,n),mt=r,Sn=i;break;case 0:case 11:case 14:case 15:if(!kt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Kc(n,e,a),i=i.next}while(i!==r)}vr(t,e,n);break;case 1:if(!kt&&(Gi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){qe(n,e,l)}vr(t,e,n);break;case 21:vr(t,e,n);break;case 22:n.mode&1?(kt=(r=kt)||n.memoizedState!==null,vr(t,e,n),kt=r):vr(t,e,n);break;default:vr(t,e,n)}}function Lp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new u1),e.forEach(function(r){var i=_1.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function xn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:mt=l.stateNode,Sn=!1;break e;case 3:mt=l.stateNode.containerInfo,Sn=!0;break e;case 4:mt=l.stateNode.containerInfo,Sn=!0;break e}l=l.return}if(mt===null)throw Error(H(160));$y(s,a,i),mt=null,Sn=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(h){qe(i,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Wy(e,t),e=e.sibling}function Wy(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(xn(e,t),Nn(t),r&4){try{ao(3,t,t.return),Yl(3,t)}catch(P){qe(t,t.return,P)}try{ao(5,t,t.return)}catch(P){qe(t,t.return,P)}}break;case 1:xn(e,t),Nn(t),r&512&&n!==null&&Gi(n,n.return);break;case 5:if(xn(e,t),Nn(t),r&512&&n!==null&&Gi(n,n.return),t.flags&32){var i=t.stateNode;try{go(i,"")}catch(P){qe(t,t.return,P)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&hg(i,s),Sc(l,a);var h=Sc(l,s);for(a=0;a<u.length;a+=2){var p=u[a],g=u[a+1];p==="style"?yg(i,g):p==="dangerouslySetInnerHTML"?mg(i,g):p==="children"?go(i,g):Ld(i,p,g,h)}switch(l){case"input":yc(i,s);break;case"textarea":fg(i,s);break;case"select":var y=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var E=s.value;E!=null?Ki(i,!!s.multiple,E,!1):y!==!!s.multiple&&(s.defaultValue!=null?Ki(i,!!s.multiple,s.defaultValue,!0):Ki(i,!!s.multiple,s.multiple?[]:"",!1))}i[Io]=s}catch(P){qe(t,t.return,P)}}break;case 6:if(xn(e,t),Nn(t),r&4){if(t.stateNode===null)throw Error(H(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(P){qe(t,t.return,P)}}break;case 3:if(xn(e,t),Nn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{xo(e.containerInfo)}catch(P){qe(t,t.return,P)}break;case 4:xn(e,t),Nn(t);break;case 13:xn(e,t),Nn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(gh=Ye())),r&4&&Lp(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(kt=(h=kt)||p,xn(e,t),kt=h):xn(e,t),Nn(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(X=t,p=t.child;p!==null;){for(g=X=p;X!==null;){switch(y=X,E=y.child,y.tag){case 0:case 11:case 14:case 15:ao(4,y,y.return);break;case 1:Gi(y,y.return);var A=y.stateNode;if(typeof A.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(P){qe(r,n,P)}}break;case 5:Gi(y,y.return);break;case 22:if(y.memoizedState!==null){Fp(g);continue}}E!==null?(E.return=y,X=E):Fp(g)}p=p.sibling}e:for(p=null,g=t;;){if(g.tag===5){if(p===null){p=g;try{i=g.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=g.stateNode,u=g.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=gg("display",a))}catch(P){qe(t,t.return,P)}}}else if(g.tag===6){if(p===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(P){qe(t,t.return,P)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;p===g&&(p=null),g=g.return}p===g&&(p=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:xn(e,t),Nn(t),r&4&&Lp(t);break;case 21:break;default:xn(e,t),Nn(t)}}function Nn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Uy(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(go(i,""),r.flags&=-33);var s=Mp(t);Jc(t,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Mp(t);Xc(t,l,a);break;default:throw Error(H(161))}}catch(u){qe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function d1(t,e,n){X=t,Hy(t)}function Hy(t,e,n){for(var r=(t.mode&1)!==0;X!==null;){var i=X,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Ma;if(!a){var l=i.alternate,u=l!==null&&l.memoizedState!==null||kt;l=Ma;var h=kt;if(Ma=a,(kt=u)&&!h)for(X=i;X!==null;)a=X,u=a.child,a.tag===22&&a.memoizedState!==null?zp(i):u!==null?(u.return=a,X=u):zp(i);for(;s!==null;)X=s,Hy(s),s=s.sibling;X=i,Ma=l,kt=h}Op(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,X=s):Op(t)}}function Op(t){for(;X!==null;){var e=X;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:kt||Yl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!kt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:wn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Sp(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Sp(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var g=p.dehydrated;g!==null&&xo(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}kt||e.flags&512&&Yc(e)}catch(y){qe(e,e.return,y)}}if(e===t){X=null;break}if(n=e.sibling,n!==null){n.return=e.return,X=n;break}X=e.return}}function Fp(t){for(;X!==null;){var e=X;if(e===t){X=null;break}var n=e.sibling;if(n!==null){n.return=e.return,X=n;break}X=e.return}}function zp(t){for(;X!==null;){var e=X;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Yl(4,e)}catch(u){qe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){qe(e,i,u)}}var s=e.return;try{Yc(e)}catch(u){qe(e,s,u)}break;case 5:var a=e.return;try{Yc(e)}catch(u){qe(e,a,u)}}}catch(u){qe(e,e.return,u)}if(e===t){X=null;break}var l=e.sibling;if(l!==null){l.return=e.return,X=l;break}X=e.return}}var h1=Math.ceil,Il=ur.ReactCurrentDispatcher,ph=ur.ReactCurrentOwner,pn=ur.ReactCurrentBatchConfig,ve=0,ht=null,et=null,vt=0,en=0,Qi=Wr(0),at=0,bo=null,di=0,Xl=0,mh=0,lo=null,zt=null,gh=0,ls=1/0,Gn=null,Cl=!1,Zc=null,br=null,La=!1,Tr=null,Al=0,uo=0,ed=null,Ja=-1,Za=0;function jt(){return ve&6?Ye():Ja!==-1?Ja:Ja=Ye()}function Dr(t){return t.mode&1?ve&2&&vt!==0?vt&-vt:Kx.transition!==null?(Za===0&&(Za=Rg()),Za):(t=Ee,t!==0||(t=window.event,t=t===void 0?16:Mg(t.type)),t):1}function Cn(t,e,n,r){if(50<uo)throw uo=0,ed=null,Error(H(185));Wo(t,n,r),(!(ve&2)||t!==ht)&&(t===ht&&(!(ve&2)&&(Xl|=n),at===4&&Sr(t,vt)),Ht(t,r),n===1&&ve===0&&!(e.mode&1)&&(ls=Ye()+500,Gl&&Hr()))}function Ht(t,e){var n=t.callbackNode;K_(t,e);var r=cl(t,t===ht?vt:0);if(r===0)n!==null&&Kf(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Kf(n),e===1)t.tag===0?Qx(Bp.bind(null,t)):ty(Bp.bind(null,t)),Wx(function(){!(ve&6)&&Hr()}),n=null;else{switch(Pg(r)){case 1:n=Ud;break;case 4:n=Ag;break;case 16:n=ul;break;case 536870912:n=kg;break;default:n=ul}n=Zy(n,qy.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function qy(t,e){if(Ja=-1,Za=0,ve&6)throw Error(H(327));var n=t.callbackNode;if(es()&&t.callbackNode!==n)return null;var r=cl(t,t===ht?vt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=kl(t,r);else{e=r;var i=ve;ve|=2;var s=Qy();(ht!==t||vt!==e)&&(Gn=null,ls=Ye()+500,si(t,e));do try{m1();break}catch(l){Gy(t,l)}while(!0);th(),Il.current=s,ve=i,et!==null?e=0:(ht=null,vt=0,e=at)}if(e!==0){if(e===2&&(i=Ac(t),i!==0&&(r=i,e=td(t,i))),e===1)throw n=bo,si(t,0),Sr(t,r),Ht(t,Ye()),n;if(e===6)Sr(t,r);else{if(i=t.current.alternate,!(r&30)&&!f1(i)&&(e=kl(t,r),e===2&&(s=Ac(t),s!==0&&(r=s,e=td(t,s))),e===1))throw n=bo,si(t,0),Sr(t,r),Ht(t,Ye()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:Zr(t,zt,Gn);break;case 3:if(Sr(t,r),(r&130023424)===r&&(e=gh+500-Ye(),10<e)){if(cl(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){jt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Vc(Zr.bind(null,t,zt,Gn),e);break}Zr(t,zt,Gn);break;case 4:if(Sr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-In(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=Ye()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*h1(r/1960))-r,10<r){t.timeoutHandle=Vc(Zr.bind(null,t,zt,Gn),r);break}Zr(t,zt,Gn);break;case 5:Zr(t,zt,Gn);break;default:throw Error(H(329))}}}return Ht(t,Ye()),t.callbackNode===n?qy.bind(null,t):null}function td(t,e){var n=lo;return t.current.memoizedState.isDehydrated&&(si(t,e).flags|=256),t=kl(t,e),t!==2&&(e=zt,zt=n,e!==null&&nd(e)),t}function nd(t){zt===null?zt=t:zt.push.apply(zt,t)}function f1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!kn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Sr(t,e){for(e&=~mh,e&=~Xl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-In(e),r=1<<n;t[n]=-1,e&=~r}}function Bp(t){if(ve&6)throw Error(H(327));es();var e=cl(t,0);if(!(e&1))return Ht(t,Ye()),null;var n=kl(t,e);if(t.tag!==0&&n===2){var r=Ac(t);r!==0&&(e=r,n=td(t,r))}if(n===1)throw n=bo,si(t,0),Sr(t,e),Ht(t,Ye()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Zr(t,zt,Gn),Ht(t,Ye()),null}function yh(t,e){var n=ve;ve|=1;try{return t(e)}finally{ve=n,ve===0&&(ls=Ye()+500,Gl&&Hr())}}function hi(t){Tr!==null&&Tr.tag===0&&!(ve&6)&&es();var e=ve;ve|=1;var n=pn.transition,r=Ee;try{if(pn.transition=null,Ee=1,t)return t()}finally{Ee=r,pn.transition=n,ve=e,!(ve&6)&&Hr()}}function vh(){en=Qi.current,Ve(Qi)}function si(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$x(n)),et!==null)for(n=et.return;n!==null;){var r=n;switch(Jd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ml();break;case 3:os(),Ve($t),Ve(bt),ah();break;case 5:oh(r);break;case 4:os();break;case 13:Ve(Fe);break;case 19:Ve(Fe);break;case 10:nh(r.type._context);break;case 22:case 23:vh()}n=n.return}if(ht=t,et=t=Nr(t.current,null),vt=en=e,at=0,bo=null,mh=Xl=di=0,zt=lo=null,ni!==null){for(e=0;e<ni.length;e++)if(n=ni[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}ni=null}return t}function Gy(t,e){do{var n=et;try{if(th(),Ka.current=Tl,El){for(var r=ze.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}El=!1}if(ci=0,dt=ot=ze=null,oo=!1,ko=0,ph.current=null,n===null||n.return===null){at=1,bo=e,et=null;break}e:{var s=t,a=n.return,l=n,u=e;if(e=vt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,p=l,g=p.tag;if(!(p.mode&1)&&(g===0||g===11||g===15)){var y=p.alternate;y?(p.updateQueue=y.updateQueue,p.memoizedState=y.memoizedState,p.lanes=y.lanes):(p.updateQueue=null,p.memoizedState=null)}var E=kp(a);if(E!==null){E.flags&=-257,Rp(E,a,l,s,e),E.mode&1&&Ap(s,h,e),e=E,u=h;var A=e.updateQueue;if(A===null){var P=new Set;P.add(u),e.updateQueue=P}else A.add(u);break e}else{if(!(e&1)){Ap(s,h,e),_h();break e}u=Error(H(426))}}else if(Me&&l.mode&1){var F=kp(a);if(F!==null){!(F.flags&65536)&&(F.flags|=256),Rp(F,a,l,s,e),Zd(as(u,l));break e}}s=u=as(u,l),at!==4&&(at=2),lo===null?lo=[s]:lo.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var I=Py(s,u,e);wp(s,I);break e;case 1:l=u;var S=s.type,C=s.stateNode;if(!(s.flags&128)&&(typeof S.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(br===null||!br.has(C)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=by(s,l,e);wp(s,V);break e}}s=s.return}while(s!==null)}Yy(n)}catch(L){e=L,et===n&&n!==null&&(et=n=n.return);continue}break}while(!0)}function Qy(){var t=Il.current;return Il.current=Tl,t===null?Tl:t}function _h(){(at===0||at===3||at===2)&&(at=4),ht===null||!(di&268435455)&&!(Xl&268435455)||Sr(ht,vt)}function kl(t,e){var n=ve;ve|=2;var r=Qy();(ht!==t||vt!==e)&&(Gn=null,si(t,e));do try{p1();break}catch(i){Gy(t,i)}while(!0);if(th(),ve=n,Il.current=r,et!==null)throw Error(H(261));return ht=null,vt=0,at}function p1(){for(;et!==null;)Ky(et)}function m1(){for(;et!==null&&!z_();)Ky(et)}function Ky(t){var e=Jy(t.alternate,t,en);t.memoizedProps=t.pendingProps,e===null?Yy(t):et=e,ph.current=null}function Yy(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=l1(n,e),n!==null){n.flags&=32767,et=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{at=6,et=null;return}}else if(n=a1(n,e,en),n!==null){et=n;return}if(e=e.sibling,e!==null){et=e;return}et=e=t}while(e!==null);at===0&&(at=5)}function Zr(t,e,n){var r=Ee,i=pn.transition;try{pn.transition=null,Ee=1,g1(t,e,n,r)}finally{pn.transition=i,Ee=r}return null}function g1(t,e,n,r){do es();while(Tr!==null);if(ve&6)throw Error(H(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Y_(t,s),t===ht&&(et=ht=null,vt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||La||(La=!0,Zy(ul,function(){return es(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=pn.transition,pn.transition=null;var a=Ee;Ee=1;var l=ve;ve|=4,ph.current=null,c1(t,n),Wy(n,t),Mx(Nc),dl=!!Dc,Nc=Dc=null,t.current=n,d1(n),B_(),ve=l,Ee=a,pn.transition=s}else t.current=n;if(La&&(La=!1,Tr=t,Al=i),s=t.pendingLanes,s===0&&(br=null),W_(n.stateNode),Ht(t,Ye()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Cl)throw Cl=!1,t=Zc,Zc=null,t;return Al&1&&t.tag!==0&&es(),s=t.pendingLanes,s&1?t===ed?uo++:(uo=0,ed=t):uo=0,Hr(),null}function es(){if(Tr!==null){var t=Pg(Al),e=pn.transition,n=Ee;try{if(pn.transition=null,Ee=16>t?16:t,Tr===null)var r=!1;else{if(t=Tr,Tr=null,Al=0,ve&6)throw Error(H(331));var i=ve;for(ve|=4,X=t.current;X!==null;){var s=X,a=s.child;if(X.flags&16){var l=s.deletions;if(l!==null){for(var u=0;u<l.length;u++){var h=l[u];for(X=h;X!==null;){var p=X;switch(p.tag){case 0:case 11:case 15:ao(8,p,s)}var g=p.child;if(g!==null)g.return=p,X=g;else for(;X!==null;){p=X;var y=p.sibling,E=p.return;if(By(p),p===h){X=null;break}if(y!==null){y.return=E,X=y;break}X=E}}}var A=s.alternate;if(A!==null){var P=A.child;if(P!==null){A.child=null;do{var F=P.sibling;P.sibling=null,P=F}while(P!==null)}}X=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,X=a;else e:for(;X!==null;){if(s=X,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ao(9,s,s.return)}var I=s.sibling;if(I!==null){I.return=s.return,X=I;break e}X=s.return}}var S=t.current;for(X=S;X!==null;){a=X;var C=a.child;if(a.subtreeFlags&2064&&C!==null)C.return=a,X=C;else e:for(a=S;X!==null;){if(l=X,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Yl(9,l)}}catch(L){qe(l,l.return,L)}if(l===a){X=null;break e}var V=l.sibling;if(V!==null){V.return=l.return,X=V;break e}X=l.return}}if(ve=i,Hr(),Mn&&typeof Mn.onPostCommitFiberRoot=="function")try{Mn.onPostCommitFiberRoot(Ul,t)}catch{}r=!0}return r}finally{Ee=n,pn.transition=e}}return!1}function Up(t,e,n){e=as(n,e),e=Py(t,e,1),t=Pr(t,e,1),e=jt(),t!==null&&(Wo(t,1,e),Ht(t,e))}function qe(t,e,n){if(t.tag===3)Up(t,t,n);else for(;e!==null;){if(e.tag===3){Up(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(br===null||!br.has(r))){t=as(n,t),t=by(e,t,1),e=Pr(e,t,1),t=jt(),e!==null&&(Wo(e,1,t),Ht(e,t));break}}e=e.return}}function y1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=jt(),t.pingedLanes|=t.suspendedLanes&n,ht===t&&(vt&n)===n&&(at===4||at===3&&(vt&130023424)===vt&&500>Ye()-gh?si(t,0):mh|=n),Ht(t,e)}function Xy(t,e){e===0&&(t.mode&1?(e=Aa,Aa<<=1,!(Aa&130023424)&&(Aa=4194304)):e=1);var n=jt();t=rr(t,e),t!==null&&(Wo(t,e,n),Ht(t,n))}function v1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Xy(t,n)}function _1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),Xy(t,n)}var Jy;Jy=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||$t.current)Ut=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ut=!1,o1(t,e,n);Ut=!!(t.flags&131072)}else Ut=!1,Me&&e.flags&1048576&&ny(e,vl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Xa(t,e),t=e.pendingProps;var i=rs(e,bt.current);Zi(e,n),i=uh(null,e,r,t,i,n);var s=ch();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Wt(r)?(s=!0,gl(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ih(e),i.updater=Kl,e.stateNode=i,i._reactInternals=e,Uc(e,r,t,n),e=Hc(null,e,r,!0,s,n)):(e.tag=0,Me&&s&&Xd(e),Nt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Xa(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=w1(r),t=wn(r,t),i){case 0:e=Wc(null,e,r,t,n);break e;case 1:e=Dp(null,e,r,t,n);break e;case 11:e=Pp(null,e,r,t,n);break e;case 14:e=bp(null,e,r,wn(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wn(r,i),Wc(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wn(r,i),Dp(t,e,r,i,n);case 3:e:{if(Vy(e),t===null)throw Error(H(387));r=e.pendingProps,s=e.memoizedState,i=s.element,ly(t,e),wl(e,r,null,n);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=as(Error(H(423)),e),e=Np(t,e,r,n,i);break e}else if(r!==i){i=as(Error(H(424)),e),e=Np(t,e,r,n,i);break e}else for(tn=Rr(e.stateNode.containerInfo.firstChild),rn=e,Me=!0,En=null,n=oy(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(is(),r===i){e=ir(t,e,n);break e}Nt(t,e,r,n)}e=e.child}return e;case 5:return uy(e),t===null&&Fc(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,jc(r,i)?a=null:s!==null&&jc(r,s)&&(e.flags|=32),jy(t,e),Nt(t,e,a,n),e.child;case 6:return t===null&&Fc(e),null;case 13:return My(t,e,n);case 4:return sh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ss(e,null,r,n):Nt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wn(r,i),Pp(t,e,r,i,n);case 7:return Nt(t,e,e.pendingProps,n),e.child;case 8:return Nt(t,e,e.pendingProps.children,n),e.child;case 12:return Nt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,be(_l,r._currentValue),r._currentValue=a,s!==null)if(kn(s.value,a)){if(s.children===i.children&&!$t.current){e=ir(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){a=s.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=Jn(-1,n&-n),u.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?u.next=u:(u.next=p.next,p.next=u),h.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),zc(s.return,n,e),l.lanes|=n;break}u=u.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(H(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),zc(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Nt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Zi(e,n),i=mn(i),r=r(i),e.flags|=1,Nt(t,e,r,n),e.child;case 14:return r=e.type,i=wn(r,e.pendingProps),i=wn(r.type,i),bp(t,e,r,i,n);case 15:return Dy(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wn(r,i),Xa(t,e),e.tag=1,Wt(r)?(t=!0,gl(e)):t=!1,Zi(e,n),Ry(e,r,i),Uc(e,r,i,n),Hc(null,e,r,!0,t,n);case 19:return Ly(t,e,n);case 22:return Ny(t,e,n)}throw Error(H(156,e.tag))};function Zy(t,e){return Cg(t,e)}function x1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fn(t,e,n,r){return new x1(t,e,n,r)}function xh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function w1(t){if(typeof t=="function")return xh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Fd)return 11;if(t===zd)return 14}return 2}function Nr(t,e){var n=t.alternate;return n===null?(n=fn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function el(t,e,n,r,i,s){var a=2;if(r=t,typeof t=="function")xh(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Oi:return oi(n.children,i,s,e);case Od:a=8,i|=8;break;case hc:return t=fn(12,n,e,i|2),t.elementType=hc,t.lanes=s,t;case fc:return t=fn(13,n,e,i),t.elementType=fc,t.lanes=s,t;case pc:return t=fn(19,n,e,i),t.elementType=pc,t.lanes=s,t;case ug:return Jl(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ag:a=10;break e;case lg:a=9;break e;case Fd:a=11;break e;case zd:a=14;break e;case _r:a=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=fn(a,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function oi(t,e,n,r){return t=fn(7,t,r,e),t.lanes=n,t}function Jl(t,e,n,r){return t=fn(22,t,r,e),t.elementType=ug,t.lanes=n,t.stateNode={isHidden:!1},t}function Yu(t,e,n){return t=fn(6,t,null,e),t.lanes=n,t}function Xu(t,e,n){return e=fn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function S1(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bu(0),this.expirationTimes=bu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bu(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function wh(t,e,n,r,i,s,a,l,u){return t=new S1(t,e,n,l,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=fn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ih(s),t}function E1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Li,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function e0(t){if(!t)return Fr;t=t._reactInternals;e:{if(yi(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Wt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(Wt(n))return ey(t,n,e)}return e}function t0(t,e,n,r,i,s,a,l,u){return t=wh(n,r,!0,t,i,s,a,l,u),t.context=e0(null),n=t.current,r=jt(),i=Dr(n),s=Jn(r,i),s.callback=e??null,Pr(n,s,i),t.current.lanes=i,Wo(t,i,r),Ht(t,r),t}function Zl(t,e,n,r){var i=e.current,s=jt(),a=Dr(i);return n=e0(n),e.context===null?e.context=n:e.pendingContext=n,e=Jn(s,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Pr(i,e,a),t!==null&&(Cn(t,i,a,s),Qa(t,i,a)),a}function Rl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function $p(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Sh(t,e){$p(t,e),(t=t.alternate)&&$p(t,e)}function T1(){return null}var n0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Eh(t){this._internalRoot=t}eu.prototype.render=Eh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));Zl(t,e,null,null)};eu.prototype.unmount=Eh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;hi(function(){Zl(null,t,null,null)}),e[nr]=null}};function eu(t){this._internalRoot=t}eu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ng();t={blockedOn:null,target:t,priority:e};for(var n=0;n<wr.length&&e!==0&&e<wr[n].priority;n++);wr.splice(n,0,t),n===0&&Vg(t)}};function Th(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function tu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Wp(){}function I1(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=Rl(a);s.call(h)}}var a=t0(e,r,t,0,null,!1,!1,"",Wp);return t._reactRootContainer=a,t[nr]=a.current,Eo(t.nodeType===8?t.parentNode:t),hi(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var h=Rl(u);l.call(h)}}var u=wh(t,0,!1,null,null,!1,!1,"",Wp);return t._reactRootContainer=u,t[nr]=u.current,Eo(t.nodeType===8?t.parentNode:t),hi(function(){Zl(e,u,n,r)}),u}function nu(t,e,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var l=i;i=function(){var u=Rl(a);l.call(u)}}Zl(e,a,t,i)}else a=I1(n,e,t,i,r);return Rl(a)}bg=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ks(e.pendingLanes);n!==0&&($d(e,n|1),Ht(e,Ye()),!(ve&6)&&(ls=Ye()+500,Hr()))}break;case 13:hi(function(){var r=rr(t,1);if(r!==null){var i=jt();Cn(r,t,1,i)}}),Sh(t,1)}};Wd=function(t){if(t.tag===13){var e=rr(t,134217728);if(e!==null){var n=jt();Cn(e,t,134217728,n)}Sh(t,134217728)}};Dg=function(t){if(t.tag===13){var e=Dr(t),n=rr(t,e);if(n!==null){var r=jt();Cn(n,t,e,r)}Sh(t,e)}};Ng=function(){return Ee};jg=function(t,e){var n=Ee;try{return Ee=t,e()}finally{Ee=n}};Tc=function(t,e,n){switch(e){case"input":if(yc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=ql(r);if(!i)throw Error(H(90));dg(r),yc(r,i)}}}break;case"textarea":fg(t,n);break;case"select":e=n.value,e!=null&&Ki(t,!!n.multiple,e,!1)}};xg=yh;wg=hi;var C1={usingClientEntryPoint:!1,Events:[qo,Ui,ql,vg,_g,yh]},Hs={findFiberByHostInstance:ti,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},A1={bundleType:Hs.bundleType,version:Hs.version,rendererPackageName:Hs.rendererPackageName,rendererConfig:Hs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ur.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Tg(t),t===null?null:t.stateNode},findFiberByHostInstance:Hs.findFiberByHostInstance||T1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oa.isDisabled&&Oa.supportsFiber)try{Ul=Oa.inject(A1),Mn=Oa}catch{}}on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C1;on.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Th(e))throw Error(H(200));return E1(t,e,null,n)};on.createRoot=function(t,e){if(!Th(t))throw Error(H(299));var n=!1,r="",i=n0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=wh(t,1,!1,null,null,n,!1,r,i),t[nr]=e.current,Eo(t.nodeType===8?t.parentNode:t),new Eh(e)};on.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=Tg(e),t=t===null?null:t.stateNode,t};on.flushSync=function(t){return hi(t)};on.hydrate=function(t,e,n){if(!tu(e))throw Error(H(200));return nu(null,t,e,!0,n)};on.hydrateRoot=function(t,e,n){if(!Th(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=n0;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=t0(e,null,t,1,n??null,i,!1,s,a),t[nr]=e.current,Eo(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new eu(e)};on.render=function(t,e,n){if(!tu(e))throw Error(H(200));return nu(null,t,e,!1,n)};on.unmountComponentAtNode=function(t){if(!tu(t))throw Error(H(40));return t._reactRootContainer?(hi(function(){nu(null,null,t,!1,function(){t._reactRootContainer=null,t[nr]=null})}),!0):!1};on.unstable_batchedUpdates=yh;on.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!tu(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return nu(t,e,n,!1,r)};on.version="18.3.1-next-f1338f8080-20240426";function r0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r0)}catch(t){console.error(t)}}r0(),rg.exports=on;var k1=rg.exports,i0,Hp=k1;i0=Hp.createRoot,Hp.hydrateRoot;var qp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},R1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],a=t[n++],l=t[n++],u=((i&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},o0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,l=a?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,p=s>>2,g=(s&3)<<4|l>>4;let y=(l&15)<<2|h>>6,E=h&63;u||(E=64,a||(y=64)),r.push(n[p],n[g],n[y],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):R1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const h=i<t.length?n[t.charAt(i)]:64;++i;const g=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||h==null||g==null)throw new P1;const y=s<<2|l>>4;if(r.push(y),h!==64){const E=l<<4&240|h>>2;if(r.push(E),g!==64){const A=h<<6&192|g;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class P1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const b1=function(t){const e=s0(t);return o0.encodeByteArray(e,!0)},a0=function(t){return b1(t).replace(/\./g,"")},D1=function(t){try{return o0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1=()=>N1().__FIREBASE_DEFAULTS__,V1=()=>{if(typeof process>"u"||typeof qp>"u")return;const t=qp.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},M1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&D1(t[1]);return e&&JSON.parse(e)},Ih=()=>{try{return j1()||V1()||M1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},L1=t=>{var e,n;return(n=(e=Ih())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},O1=t=>{const e=L1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},l0=()=>{var t;return(t=Ih())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function B1(){var t;const e=(t=Ih())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function U1(){return!B1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $1(){try{return typeof indexedDB=="object"}catch{return!1}}function W1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1="FirebaseError";class _s extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=H1,Object.setPrototypeOf(this,_s.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,u0.prototype.create)}}class u0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?q1(s,r):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new _s(i,l,r)}}function q1(t,e){return t.replace(G1,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const G1=/\{\$([^}]+)}/g;function Pl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],a=e[i];if(Gp(s)&&Gp(a)){if(!Pl(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Gp(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rn(t){return t&&t._delegate?t._delegate:t}class us{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new F1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Y1(e))try{this.getOrInitializeService({instanceIdentifier:ei})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ei){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ei){return this.instances.has(e)}getOptions(e=ei){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&a.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:K1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ei){return this.component?this.component.multipleInstances?e:ei:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function K1(t){return t===ei?void 0:t}function Y1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Q1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ye||(ye={}));const J1={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},Z1=ye.INFO,ew={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},tw=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=ew[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class c0{constructor(e){this.name=e,this._logLevel=Z1,this._logHandler=tw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?J1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}}const nw=(t,e)=>e.some(n=>t instanceof n);let Qp,Kp;function rw(){return Qp||(Qp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function iw(){return Kp||(Kp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const d0=new WeakMap,rd=new WeakMap,h0=new WeakMap,Ju=new WeakMap,Ch=new WeakMap;function sw(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{n(jr(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&d0.set(n,t)}).catch(()=>{}),Ch.set(e,t),e}function ow(t){if(rd.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});rd.set(t,e)}let id={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return rd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||h0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return jr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function aw(t){id=t(id)}function lw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Zu(this),e,...n);return h0.set(r,e.sort?e.sort():[e]),jr(r)}:iw().includes(t)?function(...e){return t.apply(Zu(this),e),jr(d0.get(this))}:function(...e){return jr(t.apply(Zu(this),e))}}function uw(t){return typeof t=="function"?lw(t):(t instanceof IDBTransaction&&ow(t),nw(t,rw())?new Proxy(t,id):t)}function jr(t){if(t instanceof IDBRequest)return sw(t);if(Ju.has(t))return Ju.get(t);const e=uw(t);return e!==t&&(Ju.set(t,e),Ch.set(e,t)),e}const Zu=t=>Ch.get(t);function cw(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),l=jr(a);return r&&a.addEventListener("upgradeneeded",u=>{r(jr(a.result),u.oldVersion,u.newVersion,jr(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const dw=["get","getKey","getAll","getAllKeys","count"],hw=["put","add","delete","clear"],ec=new Map;function Yp(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ec.get(e))return ec.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=hw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||dw.includes(n)))return;const s=async function(a,...l){const u=this.transaction(a,i?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),i&&u.done]))[0]};return ec.set(e,s),s}aw(t=>({...t,get:(e,n,r)=>Yp(e,n)||t.get(e,n,r),has:(e,n)=>!!Yp(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(pw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function pw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sd="@firebase/app",Xp="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr=new c0("@firebase/app"),mw="@firebase/app-compat",gw="@firebase/analytics-compat",yw="@firebase/analytics",vw="@firebase/app-check-compat",_w="@firebase/app-check",xw="@firebase/auth",ww="@firebase/auth-compat",Sw="@firebase/database",Ew="@firebase/data-connect",Tw="@firebase/database-compat",Iw="@firebase/functions",Cw="@firebase/functions-compat",Aw="@firebase/installations",kw="@firebase/installations-compat",Rw="@firebase/messaging",Pw="@firebase/messaging-compat",bw="@firebase/performance",Dw="@firebase/performance-compat",Nw="@firebase/remote-config",jw="@firebase/remote-config-compat",Vw="@firebase/storage",Mw="@firebase/storage-compat",Lw="@firebase/firestore",Ow="@firebase/vertexai-preview",Fw="@firebase/firestore-compat",zw="firebase",Bw="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const od="[DEFAULT]",Uw={[sd]:"fire-core",[mw]:"fire-core-compat",[yw]:"fire-analytics",[gw]:"fire-analytics-compat",[_w]:"fire-app-check",[vw]:"fire-app-check-compat",[xw]:"fire-auth",[ww]:"fire-auth-compat",[Sw]:"fire-rtdb",[Ew]:"fire-data-connect",[Tw]:"fire-rtdb-compat",[Iw]:"fire-fn",[Cw]:"fire-fn-compat",[Aw]:"fire-iid",[kw]:"fire-iid-compat",[Rw]:"fire-fcm",[Pw]:"fire-fcm-compat",[bw]:"fire-perf",[Dw]:"fire-perf-compat",[Nw]:"fire-rc",[jw]:"fire-rc-compat",[Vw]:"fire-gcs",[Mw]:"fire-gcs-compat",[Lw]:"fire-fst",[Fw]:"fire-fst-compat",[Ow]:"fire-vertex","fire-js":"fire-js",[zw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bl=new Map,$w=new Map,ad=new Map;function Jp(t,e){try{t.container.addComponent(e)}catch(n){sr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Do(t){const e=t.name;if(ad.has(e))return sr.debug(`There were multiple attempts to register component ${e}.`),!1;ad.set(e,t);for(const n of bl.values())Jp(n,t);for(const n of $w.values())Jp(n,t);return!0}function f0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ww={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vr=new u0("app","Firebase",Ww);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new us("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw=Bw;function p0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:od,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Vr.create("bad-app-name",{appName:String(i)});if(n||(n=l0()),!n)throw Vr.create("no-options");const s=bl.get(i);if(s){if(Pl(n,s.options)&&Pl(r,s.config))return s;throw Vr.create("duplicate-app",{appName:i})}const a=new X1(i);for(const u of ad.values())a.addComponent(u);const l=new Hw(n,r,a);return bl.set(i,l),l}function Gw(t=od){const e=bl.get(t);if(!e&&t===od&&l0())return p0();if(!e)throw Vr.create("no-app",{appName:t});return e}function Mr(t,e,n){var r;let i=(r=Uw[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),sr.warn(l.join(" "));return}Do(new us(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw="firebase-heartbeat-database",Kw=1,No="firebase-heartbeat-store";let tc=null;function m0(){return tc||(tc=cw(Qw,Kw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(No)}catch(n){console.warn(n)}}}}).catch(t=>{throw Vr.create("idb-open",{originalErrorMessage:t.message})})),tc}async function Yw(t){try{const n=(await m0()).transaction(No),r=await n.objectStore(No).get(g0(t));return await n.done,r}catch(e){if(e instanceof _s)sr.warn(e.message);else{const n=Vr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});sr.warn(n.message)}}}async function Zp(t,e){try{const r=(await m0()).transaction(No,"readwrite");await r.objectStore(No).put(e,g0(t)),await r.done}catch(n){if(n instanceof _s)sr.warn(n.message);else{const r=Vr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});sr.warn(r.message)}}}function g0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw=1024,Jw=30*24*60*60*1e3;class Zw{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new tS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=em();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=Jw}),this._storage.overwrite(this._heartbeatsCache))}catch(r){sr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=em(),{heartbeatsToSend:r,unsentEntries:i}=eS(this._heartbeatsCache.heartbeats),s=a0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return sr.warn(n),""}}}function em(){return new Date().toISOString().substring(0,10)}function eS(t,e=Xw){const n=[];let r=t.slice();for(const i of t){const s=n.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),tm(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),tm(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class tS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $1()?W1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Yw(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Zp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Zp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function tm(t){return a0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(t){Do(new us("platform-logger",e=>new fw(e),"PRIVATE")),Do(new us("heartbeat",e=>new Zw(e),"PRIVATE")),Mr(sd,Xp,t),Mr(sd,Xp,"esm2017"),Mr("fire-js","")}nS("");var rS="firebase",iS="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mr(rS,iS,"app");var nm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ai,y0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(v,m){function x(){}x.prototype=m.prototype,v.D=m.prototype,v.prototype=new x,v.prototype.constructor=v,v.C=function(w,k,R){for(var T=Array(arguments.length-2),se=2;se<arguments.length;se++)T[se-2]=arguments[se];return m.prototype[k].apply(w,T)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(v,m,x){x||(x=0);var w=Array(16);if(typeof m=="string")for(var k=0;16>k;++k)w[k]=m.charCodeAt(x++)|m.charCodeAt(x++)<<8|m.charCodeAt(x++)<<16|m.charCodeAt(x++)<<24;else for(k=0;16>k;++k)w[k]=m[x++]|m[x++]<<8|m[x++]<<16|m[x++]<<24;m=v.g[0],x=v.g[1],k=v.g[2];var R=v.g[3],T=m+(R^x&(k^R))+w[0]+3614090360&4294967295;m=x+(T<<7&4294967295|T>>>25),T=R+(k^m&(x^k))+w[1]+3905402710&4294967295,R=m+(T<<12&4294967295|T>>>20),T=k+(x^R&(m^x))+w[2]+606105819&4294967295,k=R+(T<<17&4294967295|T>>>15),T=x+(m^k&(R^m))+w[3]+3250441966&4294967295,x=k+(T<<22&4294967295|T>>>10),T=m+(R^x&(k^R))+w[4]+4118548399&4294967295,m=x+(T<<7&4294967295|T>>>25),T=R+(k^m&(x^k))+w[5]+1200080426&4294967295,R=m+(T<<12&4294967295|T>>>20),T=k+(x^R&(m^x))+w[6]+2821735955&4294967295,k=R+(T<<17&4294967295|T>>>15),T=x+(m^k&(R^m))+w[7]+4249261313&4294967295,x=k+(T<<22&4294967295|T>>>10),T=m+(R^x&(k^R))+w[8]+1770035416&4294967295,m=x+(T<<7&4294967295|T>>>25),T=R+(k^m&(x^k))+w[9]+2336552879&4294967295,R=m+(T<<12&4294967295|T>>>20),T=k+(x^R&(m^x))+w[10]+4294925233&4294967295,k=R+(T<<17&4294967295|T>>>15),T=x+(m^k&(R^m))+w[11]+2304563134&4294967295,x=k+(T<<22&4294967295|T>>>10),T=m+(R^x&(k^R))+w[12]+1804603682&4294967295,m=x+(T<<7&4294967295|T>>>25),T=R+(k^m&(x^k))+w[13]+4254626195&4294967295,R=m+(T<<12&4294967295|T>>>20),T=k+(x^R&(m^x))+w[14]+2792965006&4294967295,k=R+(T<<17&4294967295|T>>>15),T=x+(m^k&(R^m))+w[15]+1236535329&4294967295,x=k+(T<<22&4294967295|T>>>10),T=m+(k^R&(x^k))+w[1]+4129170786&4294967295,m=x+(T<<5&4294967295|T>>>27),T=R+(x^k&(m^x))+w[6]+3225465664&4294967295,R=m+(T<<9&4294967295|T>>>23),T=k+(m^x&(R^m))+w[11]+643717713&4294967295,k=R+(T<<14&4294967295|T>>>18),T=x+(R^m&(k^R))+w[0]+3921069994&4294967295,x=k+(T<<20&4294967295|T>>>12),T=m+(k^R&(x^k))+w[5]+3593408605&4294967295,m=x+(T<<5&4294967295|T>>>27),T=R+(x^k&(m^x))+w[10]+38016083&4294967295,R=m+(T<<9&4294967295|T>>>23),T=k+(m^x&(R^m))+w[15]+3634488961&4294967295,k=R+(T<<14&4294967295|T>>>18),T=x+(R^m&(k^R))+w[4]+3889429448&4294967295,x=k+(T<<20&4294967295|T>>>12),T=m+(k^R&(x^k))+w[9]+568446438&4294967295,m=x+(T<<5&4294967295|T>>>27),T=R+(x^k&(m^x))+w[14]+3275163606&4294967295,R=m+(T<<9&4294967295|T>>>23),T=k+(m^x&(R^m))+w[3]+4107603335&4294967295,k=R+(T<<14&4294967295|T>>>18),T=x+(R^m&(k^R))+w[8]+1163531501&4294967295,x=k+(T<<20&4294967295|T>>>12),T=m+(k^R&(x^k))+w[13]+2850285829&4294967295,m=x+(T<<5&4294967295|T>>>27),T=R+(x^k&(m^x))+w[2]+4243563512&4294967295,R=m+(T<<9&4294967295|T>>>23),T=k+(m^x&(R^m))+w[7]+1735328473&4294967295,k=R+(T<<14&4294967295|T>>>18),T=x+(R^m&(k^R))+w[12]+2368359562&4294967295,x=k+(T<<20&4294967295|T>>>12),T=m+(x^k^R)+w[5]+4294588738&4294967295,m=x+(T<<4&4294967295|T>>>28),T=R+(m^x^k)+w[8]+2272392833&4294967295,R=m+(T<<11&4294967295|T>>>21),T=k+(R^m^x)+w[11]+1839030562&4294967295,k=R+(T<<16&4294967295|T>>>16),T=x+(k^R^m)+w[14]+4259657740&4294967295,x=k+(T<<23&4294967295|T>>>9),T=m+(x^k^R)+w[1]+2763975236&4294967295,m=x+(T<<4&4294967295|T>>>28),T=R+(m^x^k)+w[4]+1272893353&4294967295,R=m+(T<<11&4294967295|T>>>21),T=k+(R^m^x)+w[7]+4139469664&4294967295,k=R+(T<<16&4294967295|T>>>16),T=x+(k^R^m)+w[10]+3200236656&4294967295,x=k+(T<<23&4294967295|T>>>9),T=m+(x^k^R)+w[13]+681279174&4294967295,m=x+(T<<4&4294967295|T>>>28),T=R+(m^x^k)+w[0]+3936430074&4294967295,R=m+(T<<11&4294967295|T>>>21),T=k+(R^m^x)+w[3]+3572445317&4294967295,k=R+(T<<16&4294967295|T>>>16),T=x+(k^R^m)+w[6]+76029189&4294967295,x=k+(T<<23&4294967295|T>>>9),T=m+(x^k^R)+w[9]+3654602809&4294967295,m=x+(T<<4&4294967295|T>>>28),T=R+(m^x^k)+w[12]+3873151461&4294967295,R=m+(T<<11&4294967295|T>>>21),T=k+(R^m^x)+w[15]+530742520&4294967295,k=R+(T<<16&4294967295|T>>>16),T=x+(k^R^m)+w[2]+3299628645&4294967295,x=k+(T<<23&4294967295|T>>>9),T=m+(k^(x|~R))+w[0]+4096336452&4294967295,m=x+(T<<6&4294967295|T>>>26),T=R+(x^(m|~k))+w[7]+1126891415&4294967295,R=m+(T<<10&4294967295|T>>>22),T=k+(m^(R|~x))+w[14]+2878612391&4294967295,k=R+(T<<15&4294967295|T>>>17),T=x+(R^(k|~m))+w[5]+4237533241&4294967295,x=k+(T<<21&4294967295|T>>>11),T=m+(k^(x|~R))+w[12]+1700485571&4294967295,m=x+(T<<6&4294967295|T>>>26),T=R+(x^(m|~k))+w[3]+2399980690&4294967295,R=m+(T<<10&4294967295|T>>>22),T=k+(m^(R|~x))+w[10]+4293915773&4294967295,k=R+(T<<15&4294967295|T>>>17),T=x+(R^(k|~m))+w[1]+2240044497&4294967295,x=k+(T<<21&4294967295|T>>>11),T=m+(k^(x|~R))+w[8]+1873313359&4294967295,m=x+(T<<6&4294967295|T>>>26),T=R+(x^(m|~k))+w[15]+4264355552&4294967295,R=m+(T<<10&4294967295|T>>>22),T=k+(m^(R|~x))+w[6]+2734768916&4294967295,k=R+(T<<15&4294967295|T>>>17),T=x+(R^(k|~m))+w[13]+1309151649&4294967295,x=k+(T<<21&4294967295|T>>>11),T=m+(k^(x|~R))+w[4]+4149444226&4294967295,m=x+(T<<6&4294967295|T>>>26),T=R+(x^(m|~k))+w[11]+3174756917&4294967295,R=m+(T<<10&4294967295|T>>>22),T=k+(m^(R|~x))+w[2]+718787259&4294967295,k=R+(T<<15&4294967295|T>>>17),T=x+(R^(k|~m))+w[9]+3951481745&4294967295,v.g[0]=v.g[0]+m&4294967295,v.g[1]=v.g[1]+(k+(T<<21&4294967295|T>>>11))&4294967295,v.g[2]=v.g[2]+k&4294967295,v.g[3]=v.g[3]+R&4294967295}r.prototype.u=function(v,m){m===void 0&&(m=v.length);for(var x=m-this.blockSize,w=this.B,k=this.h,R=0;R<m;){if(k==0)for(;R<=x;)i(this,v,R),R+=this.blockSize;if(typeof v=="string"){for(;R<m;)if(w[k++]=v.charCodeAt(R++),k==this.blockSize){i(this,w),k=0;break}}else for(;R<m;)if(w[k++]=v[R++],k==this.blockSize){i(this,w),k=0;break}}this.h=k,this.o+=m},r.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var m=1;m<v.length-8;++m)v[m]=0;var x=8*this.o;for(m=v.length-8;m<v.length;++m)v[m]=x&255,x/=256;for(this.u(v),v=Array(16),m=x=0;4>m;++m)for(var w=0;32>w;w+=8)v[x++]=this.g[m]>>>w&255;return v};function s(v,m){var x=l;return Object.prototype.hasOwnProperty.call(x,v)?x[v]:x[v]=m(v)}function a(v,m){this.h=m;for(var x=[],w=!0,k=v.length-1;0<=k;k--){var R=v[k]|0;w&&R==m||(x[k]=R,w=!1)}this.g=x}var l={};function u(v){return-128<=v&&128>v?s(v,function(m){return new a([m|0],0>m?-1:0)}):new a([v|0],0>v?-1:0)}function h(v){if(isNaN(v)||!isFinite(v))return g;if(0>v)return F(h(-v));for(var m=[],x=1,w=0;v>=x;w++)m[w]=v/x|0,x*=4294967296;return new a(m,0)}function p(v,m){if(v.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(v.charAt(0)=="-")return F(p(v.substring(1),m));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var x=h(Math.pow(m,8)),w=g,k=0;k<v.length;k+=8){var R=Math.min(8,v.length-k),T=parseInt(v.substring(k,k+R),m);8>R?(R=h(Math.pow(m,R)),w=w.j(R).add(h(T))):(w=w.j(x),w=w.add(h(T)))}return w}var g=u(0),y=u(1),E=u(16777216);t=a.prototype,t.m=function(){if(P(this))return-F(this).m();for(var v=0,m=1,x=0;x<this.g.length;x++){var w=this.i(x);v+=(0<=w?w:4294967296+w)*m,m*=4294967296}return v},t.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(A(this))return"0";if(P(this))return"-"+F(this).toString(v);for(var m=h(Math.pow(v,6)),x=this,w="";;){var k=V(x,m).g;x=I(x,k.j(m));var R=((0<x.g.length?x.g[0]:x.h)>>>0).toString(v);if(x=k,A(x))return R+w;for(;6>R.length;)R="0"+R;w=R+w}},t.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function A(v){if(v.h!=0)return!1;for(var m=0;m<v.g.length;m++)if(v.g[m]!=0)return!1;return!0}function P(v){return v.h==-1}t.l=function(v){return v=I(this,v),P(v)?-1:A(v)?0:1};function F(v){for(var m=v.g.length,x=[],w=0;w<m;w++)x[w]=~v.g[w];return new a(x,~v.h).add(y)}t.abs=function(){return P(this)?F(this):this},t.add=function(v){for(var m=Math.max(this.g.length,v.g.length),x=[],w=0,k=0;k<=m;k++){var R=w+(this.i(k)&65535)+(v.i(k)&65535),T=(R>>>16)+(this.i(k)>>>16)+(v.i(k)>>>16);w=T>>>16,R&=65535,T&=65535,x[k]=T<<16|R}return new a(x,x[x.length-1]&-2147483648?-1:0)};function I(v,m){return v.add(F(m))}t.j=function(v){if(A(this)||A(v))return g;if(P(this))return P(v)?F(this).j(F(v)):F(F(this).j(v));if(P(v))return F(this.j(F(v)));if(0>this.l(E)&&0>v.l(E))return h(this.m()*v.m());for(var m=this.g.length+v.g.length,x=[],w=0;w<2*m;w++)x[w]=0;for(w=0;w<this.g.length;w++)for(var k=0;k<v.g.length;k++){var R=this.i(w)>>>16,T=this.i(w)&65535,se=v.i(k)>>>16,ne=v.i(k)&65535;x[2*w+2*k]+=T*ne,S(x,2*w+2*k),x[2*w+2*k+1]+=R*ne,S(x,2*w+2*k+1),x[2*w+2*k+1]+=T*se,S(x,2*w+2*k+1),x[2*w+2*k+2]+=R*se,S(x,2*w+2*k+2)}for(w=0;w<m;w++)x[w]=x[2*w+1]<<16|x[2*w];for(w=m;w<2*m;w++)x[w]=0;return new a(x,0)};function S(v,m){for(;(v[m]&65535)!=v[m];)v[m+1]+=v[m]>>>16,v[m]&=65535,m++}function C(v,m){this.g=v,this.h=m}function V(v,m){if(A(m))throw Error("division by zero");if(A(v))return new C(g,g);if(P(v))return m=V(F(v),m),new C(F(m.g),F(m.h));if(P(m))return m=V(v,F(m)),new C(F(m.g),m.h);if(30<v.g.length){if(P(v)||P(m))throw Error("slowDivide_ only works with positive integers.");for(var x=y,w=m;0>=w.l(v);)x=L(x),w=L(w);var k=M(x,1),R=M(w,1);for(w=M(w,2),x=M(x,2);!A(w);){var T=R.add(w);0>=T.l(v)&&(k=k.add(x),R=T),w=M(w,1),x=M(x,1)}return m=I(v,k.j(m)),new C(k,m)}for(k=g;0<=v.l(m);){for(x=Math.max(1,Math.floor(v.m()/m.m())),w=Math.ceil(Math.log(x)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),R=h(x),T=R.j(m);P(T)||0<T.l(v);)x-=w,R=h(x),T=R.j(m);A(R)&&(R=y),k=k.add(R),v=I(v,T)}return new C(k,v)}t.A=function(v){return V(this,v).h},t.and=function(v){for(var m=Math.max(this.g.length,v.g.length),x=[],w=0;w<m;w++)x[w]=this.i(w)&v.i(w);return new a(x,this.h&v.h)},t.or=function(v){for(var m=Math.max(this.g.length,v.g.length),x=[],w=0;w<m;w++)x[w]=this.i(w)|v.i(w);return new a(x,this.h|v.h)},t.xor=function(v){for(var m=Math.max(this.g.length,v.g.length),x=[],w=0;w<m;w++)x[w]=this.i(w)^v.i(w);return new a(x,this.h^v.h)};function L(v){for(var m=v.g.length+1,x=[],w=0;w<m;w++)x[w]=v.i(w)<<1|v.i(w-1)>>>31;return new a(x,v.h)}function M(v,m){var x=m>>5;m%=32;for(var w=v.g.length-x,k=[],R=0;R<w;R++)k[R]=0<m?v.i(R+x)>>>m|v.i(R+x+1)<<32-m:v.i(R+x);return new a(k,v.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,y0=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,ai=a}).apply(typeof nm<"u"?nm:typeof self<"u"?self:typeof window<"u"?window:{});var Fa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var v0,Xs,_0,tl,ld,x0,w0,S0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,f){return o==Array.prototype||o==Object.prototype||(o[c]=f.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fa=="object"&&Fa];for(var c=0;c<o.length;++c){var f=o[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function i(o,c){if(c)e:{var f=r;o=o.split(".");for(var _=0;_<o.length-1;_++){var b=o[_];if(!(b in f))break e;f=f[b]}o=o[o.length-1],_=f[o],c=c(_),c!=_&&c!=null&&e(f,o,{configurable:!0,writable:!0,value:c})}}function s(o,c){o instanceof String&&(o+="");var f=0,_=!1,b={next:function(){if(!_&&f<o.length){var j=f++;return{value:c(j,o[j]),done:!1}}return _=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}i("Array.prototype.values",function(o){return o||function(){return s(this,function(c,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function h(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function p(o,c,f){return o.call.apply(o.bind,arguments)}function g(o,c,f){if(!o)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,_),o.apply(c,b)}}return function(){return o.apply(c,arguments)}}function y(o,c,f){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,y.apply(null,arguments)}function E(o,c){var f=Array.prototype.slice.call(arguments,1);return function(){var _=f.slice();return _.push.apply(_,arguments),o.apply(this,_)}}function A(o,c){function f(){}f.prototype=c.prototype,o.aa=c.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(_,b,j){for(var Q=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)Q[Ae-2]=arguments[Ae];return c.prototype[b].apply(_,Q)}}function P(o){const c=o.length;if(0<c){const f=Array(c);for(let _=0;_<c;_++)f[_]=o[_];return f}return[]}function F(o,c){for(let f=1;f<arguments.length;f++){const _=arguments[f];if(u(_)){const b=o.length||0,j=_.length||0;o.length=b+j;for(let Q=0;Q<j;Q++)o[b+Q]=_[Q]}else o.push(_)}}class I{constructor(c,f){this.i=c,this.j=f,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function S(o){return/^[\s\xa0]*$/.test(o)}function C(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function V(o){return V[" "](o),o}V[" "]=function(){};var L=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function M(o,c,f){for(const _ in o)c.call(f,o[_],_,o)}function v(o,c){for(const f in o)c.call(void 0,o[f],f,o)}function m(o){const c={};for(const f in o)c[f]=o[f];return c}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(o,c){let f,_;for(let b=1;b<arguments.length;b++){_=arguments[b];for(f in _)o[f]=_[f];for(let j=0;j<x.length;j++)f=x[j],Object.prototype.hasOwnProperty.call(_,f)&&(o[f]=_[f])}}function k(o){var c=1;o=o.split(":");const f=[];for(;0<c&&o.length;)f.push(o.shift()),c--;return o.length&&f.push(o.join(":")),f}function R(o){l.setTimeout(()=>{throw o},0)}function T(){var o=O;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class se{constructor(){this.h=this.g=null}add(c,f){const _=ne.get();_.set(c,f),this.h?this.h.next=_:this.g=_,this.h=_}}var ne=new I(()=>new ie,o=>o.reset());class ie{constructor(){this.next=this.g=this.h=null}set(c,f){this.h=c,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let $,N=!1,O=new se,G=()=>{const o=l.Promise.resolve(void 0);$=()=>{o.then(Z)}};var Z=()=>{for(var o;o=T();){try{o.h.call(o.g)}catch(f){R(f)}var c=ne;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}N=!1};function ee(){this.s=this.s,this.C=this.C}ee.prototype.s=!1,ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ae(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}ae.prototype.h=function(){this.defaultPrevented=!0};var ke=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};l.addEventListener("test",f,c),l.removeEventListener("test",f,c)}catch{}return o}();function we(o,c){if(ae.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,_=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(L){e:{try{V(c.nodeName);var b=!0;break e}catch{}b=!1}b||(c=null)}}else f=="mouseover"?c=o.fromElement:f=="mouseout"&&(c=o.toElement);this.relatedTarget=c,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:fe[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&we.aa.h.call(this)}}A(we,ae);var fe={2:"touch",3:"pen",4:"mouse"};we.prototype.h=function(){we.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var he="closure_listenable_"+(1e6*Math.random()|0),Le=0;function Se(o,c,f,_,b){this.listener=o,this.proxy=null,this.src=c,this.type=f,this.capture=!!_,this.ha=b,this.key=++Le,this.da=this.fa=!1}function te(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Ce(o){this.src=o,this.g={},this.h=0}Ce.prototype.add=function(o,c,f,_,b){var j=o.toString();o=this.g[j],o||(o=this.g[j]=[],this.h++);var Q=Re(o,c,_,b);return-1<Q?(c=o[Q],f||(c.fa=!1)):(c=new Se(c,this.src,j,!!_,b),c.fa=f,o.push(c)),c};function Oe(o,c){var f=c.type;if(f in o.g){var _=o.g[f],b=Array.prototype.indexOf.call(_,c,void 0),j;(j=0<=b)&&Array.prototype.splice.call(_,b,1),j&&(te(c),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Re(o,c,f,_){for(var b=0;b<o.length;++b){var j=o[b];if(!j.da&&j.listener==c&&j.capture==!!f&&j.ha==_)return b}return-1}var St="closure_lm_"+(1e6*Math.random()|0),qt={};function Gt(o,c,f,_,b){if(Array.isArray(c)){for(var j=0;j<c.length;j++)Gt(o,c[j],f,_,b);return null}return f=na(f),o&&o[he]?o.K(c,f,h(_)?!!_.capture:!1,b):Qt(o,c,f,!1,_,b)}function Qt(o,c,f,_,b,j){if(!c)throw Error("Invalid event type");var Q=h(b)?!!b.capture:!!b,Ae=Pe(o);if(Ae||(o[St]=Ae=new Ce(o)),f=Ae.add(c,f,_,Q,j),f.proxy)return f;if(_=Kt(),f.proxy=_,_.src=o,_.listener=f,o.addEventListener)ke||(b=Q),b===void 0&&(b=!1),o.addEventListener(c.toString(),_,b);else if(o.attachEvent)o.attachEvent(bn(c.toString()),_);else if(o.addListener&&o.removeListener)o.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Kt(){function o(f){return c.call(o.src,o.listener,f)}const c=hr;return o}function cr(o,c,f,_,b){if(Array.isArray(c))for(var j=0;j<c.length;j++)cr(o,c[j],f,_,b);else _=h(_)?!!_.capture:!!_,f=na(f),o&&o[he]?(o=o.i,c=String(c).toString(),c in o.g&&(j=o.g[c],f=Re(j,f,_,b),-1<f&&(te(j[f]),Array.prototype.splice.call(j,f,1),j.length==0&&(delete o.g[c],o.h--)))):o&&(o=Pe(o))&&(c=o.g[c.toString()],o=-1,c&&(o=Re(c,f,_,b)),(f=-1<o?c[o]:null)&&dr(f))}function dr(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[he])Oe(c.i,o);else{var f=o.type,_=o.proxy;c.removeEventListener?c.removeEventListener(f,_,o.capture):c.detachEvent?c.detachEvent(bn(f),_):c.addListener&&c.removeListener&&c.removeListener(_),(f=Pe(c))?(Oe(f,o),f.h==0&&(f.src=null,c[St]=null)):te(o)}}}function bn(o){return o in qt?qt[o]:qt[o]="on"+o}function hr(o,c){if(o.da)o=!0;else{c=new we(c,this);var f=o.listener,_=o.ha||o.src;o.fa&&dr(o),o=f.call(_,c)}return o}function Pe(o){return o=o[St],o instanceof Ce?o:null}var Is="__closure_events_fn_"+(1e9*Math.random()>>>0);function na(o){return typeof o=="function"?o:(o[Is]||(o[Is]=function(c){return o.handleEvent(c)}),o[Is])}function nt(){ee.call(this),this.i=new Ce(this),this.M=this,this.F=null}A(nt,ee),nt.prototype[he]=!0,nt.prototype.removeEventListener=function(o,c,f,_){cr(this,o,c,f,_)};function rt(o,c){var f,_=o.F;if(_)for(f=[];_;_=_.F)f.push(_);if(o=o.M,_=c.type||c,typeof c=="string")c=new ae(c,o);else if(c instanceof ae)c.target=c.target||o;else{var b=c;c=new ae(_,o),w(c,b)}if(b=!0,f)for(var j=f.length-1;0<=j;j--){var Q=c.g=f[j];b=fr(Q,_,!0,c)&&b}if(Q=c.g=o,b=fr(Q,_,!0,c)&&b,b=fr(Q,_,!1,c)&&b,f)for(j=0;j<f.length;j++)Q=c.g=f[j],b=fr(Q,_,!1,c)&&b}nt.prototype.N=function(){if(nt.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var f=o.g[c],_=0;_<f.length;_++)te(f[_]);delete o.g[c],o.h--}}this.F=null},nt.prototype.K=function(o,c,f,_){return this.i.add(String(o),c,!1,f,_)},nt.prototype.L=function(o,c,f,_){return this.i.add(String(o),c,!0,f,_)};function fr(o,c,f,_){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var b=!0,j=0;j<c.length;++j){var Q=c[j];if(Q&&!Q.da&&Q.capture==f){var Ae=Q.listener,pt=Q.ha||Q.src;Q.fa&&Oe(o.i,Q),b=Ae.call(pt,_)!==!1&&b}}return b&&!_.defaultPrevented}function xi(o,c,f){if(typeof o=="function")f&&(o=y(o,f));else if(o&&typeof o.handleEvent=="function")o=y(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(o,c||0)}function Cs(o){o.g=xi(()=>{o.g=null,o.i&&(o.i=!1,Cs(o))},o.l);const c=o.h;o.h=null,o.m.apply(null,c)}class Ie extends ee{constructor(c,f){super(),this.m=c,this.l=f,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Cs(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ln(o){ee.call(this),this.h=o,this.g={}}A(ln,ee);var Gr=[];function wi(o){M(o.g,function(c,f){this.g.hasOwnProperty(f)&&dr(c)},o),o.g={}}ln.prototype.N=function(){ln.aa.N.call(this),wi(this)},ln.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ra=l.JSON.stringify,ia=l.JSON.parse,cf=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function Si(){}Si.prototype.h=null;function it(o){return o.h||(o.h=o.i())}function sa(){}var Yt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Bn(){ae.call(this,"d")}A(Bn,ae);function Un(){ae.call(this,"c")}A(Un,ae);var yn={},oa=null;function Ei(){return oa=oa||new nt}yn.La="serverreachability";function vu(o){ae.call(this,yn.La,o)}A(vu,ae);function Ti(o){const c=Ei();rt(c,new vu(c))}yn.STAT_EVENT="statevent";function Ii(o,c){ae.call(this,yn.STAT_EVENT,o),this.stat=c}A(Ii,ae);function Ge(o){const c=Ei();rt(c,new Ii(c,o))}yn.Ma="timingevent";function Ci(o,c){ae.call(this,yn.Ma,o),this.size=c}A(Ci,ae);function pr(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},c)}function Qr(){this.g=!0}Qr.prototype.xa=function(){this.g=!1};function _u(o,c,f,_,b,j){o.info(function(){if(o.g)if(j)for(var Q="",Ae=j.split("&"),pt=0;pt<Ae.length;pt++){var _e=Ae[pt].split("=");if(1<_e.length){var Et=_e[0];_e=_e[1];var Tt=Et.split("_");Q=2<=Tt.length&&Tt[1]=="type"?Q+(Et+"="+_e+"&"):Q+(Et+"=redacted&")}}else Q=null;else Q=j;return"XMLHTTP REQ ("+_+") [attempt "+b+"]: "+c+`
`+f+`
`+Q})}function Kr(o,c,f,_,b,j,Q){o.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+b+"]: "+c+`
`+f+`
`+j+" "+Q})}function un(o,c,f,_){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+aa(o,f)+(_?" "+_:"")})}function xu(o,c){o.info(function(){return"TIMEOUT: "+c})}Qr.prototype.info=function(){};function aa(o,c){if(!o.g)return c;if(!c)return null;try{var f=JSON.parse(c);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var _=f[o];if(!(2>_.length)){var b=_[1];if(Array.isArray(b)&&!(1>b.length)){var j=b[0];if(j!="noop"&&j!="stop"&&j!="close")for(var Q=1;Q<b.length;Q++)b[Q]=""}}}}return ra(f)}catch{return c}}var Yr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},As={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ks;function Ai(){}A(Ai,Si),Ai.prototype.g=function(){return new XMLHttpRequest},Ai.prototype.i=function(){return{}},ks=new Ai;function cn(o,c,f,_){this.j=o,this.i=c,this.l=f,this.R=_||1,this.U=new ln(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ki}function ki(){this.i=null,this.g="",this.h=!1}var Dn={},mr={};function vn(o,c,f){o.L=1,o.v=fa(Wn(c)),o.m=f,o.P=!0,la(o,null)}function la(o,c){o.F=Date.now(),q(o),o.A=Wn(o.v);var f=o.A,_=o.R;Array.isArray(_)||(_=[String(_)]),mf(f.i,"t",_),o.C=0,f=o.j.J,o.h=new ki,o.g=Nf(o.j,f?c:null,!o.m),0<o.O&&(o.M=new Ie(y(o.Y,o,o.g),o.O)),c=o.U,f=o.g,_=o.ca;var b="readystatechange";Array.isArray(b)||(b&&(Gr[0]=b.toString()),b=Gr);for(var j=0;j<b.length;j++){var Q=Gt(f,b[j],_||c.handleEvent,!1,c.h||c);if(!Q)break;c.g[Q.key]=Q}c=o.H?m(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),Ti(),_u(o.i,o.u,o.A,o.l,o.R,o.m)}cn.prototype.ca=function(o){o=o.target;const c=this.M;c&&Hn(o)==3?c.j():this.Y(o)},cn.prototype.Y=function(o){try{if(o==this.g)e:{const Tt=Hn(this.g);var c=this.g.Ba();const Di=this.g.Z();if(!(3>Tt)&&(Tt!=3||this.g&&(this.h.h||this.g.oa()||Sf(this.g)))){this.J||Tt!=4||c==7||(c==8||0>=Di?Ti(3):Ti(2)),W(this);var f=this.g.Z();this.X=f;t:if(ua(this)){var _=Sf(this.g);o="";var b=_.length,j=Hn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ue(this),K(this);var Q="";break t}this.h.i=new l.TextDecoder}for(c=0;c<b;c++)this.h.h=!0,o+=this.h.i.decode(_[c],{stream:!(j&&c==b-1)});_.length=0,this.h.g+=o,this.C=0,Q=this.h.g}else Q=this.g.oa();if(this.o=f==200,Kr(this.i,this.u,this.A,this.l,this.R,Tt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ae,pt=this.g;if((Ae=pt.g?pt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(Ae)){var _e=Ae;break t}}_e=null}if(f=_e)un(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$e(this,f);else{this.o=!1,this.s=3,Ge(12),ue(this),K(this);break e}}if(this.P){f=!0;let _n;for(;!this.J&&this.C<Q.length;)if(_n=ca(this,Q),_n==mr){Tt==4&&(this.s=4,Ge(14),f=!1),un(this.i,this.l,null,"[Incomplete Response]");break}else if(_n==Dn){this.s=4,Ge(15),un(this.i,this.l,Q,"[Invalid Chunk]"),f=!1;break}else un(this.i,this.l,_n,null),$e(this,_n);if(ua(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Tt!=4||Q.length!=0||this.h.h||(this.s=1,Ge(16),f=!1),this.o=this.o&&f,!f)un(this.i,this.l,Q,"[Invalid Chunked Response]"),ue(this),K(this);else if(0<Q.length&&!this.W){this.W=!0;var Et=this.j;Et.g==this&&Et.ba&&!Et.M&&(Et.j.info("Great, no buffering proxy detected. Bytes received: "+Q.length),Tu(Et),Et.M=!0,Ge(11))}}else un(this.i,this.l,Q,null),$e(this,Q);Tt==4&&ue(this),this.o&&!this.J&&(Tt==4?Rf(this.j,this):(this.o=!1,q(this)))}else t_(this.g),f==400&&0<Q.indexOf("Unknown SID")?(this.s=3,Ge(12)):(this.s=0,Ge(13)),ue(this),K(this)}}}catch{}finally{}};function ua(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function ca(o,c){var f=o.C,_=c.indexOf(`
`,f);return _==-1?mr:(f=Number(c.substring(f,_)),isNaN(f)?Dn:(_+=1,_+f>c.length?mr:(c=c.slice(_,_+f),o.C=_+f,c)))}cn.prototype.cancel=function(){this.J=!0,ue(this)};function q(o){o.S=Date.now()+o.I,B(o,o.I)}function B(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=pr(y(o.ba,o),c)}function W(o){o.B&&(l.clearTimeout(o.B),o.B=null)}cn.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(xu(this.i,this.A),this.L!=2&&(Ti(),Ge(17)),ue(this),this.s=2,K(this)):B(this,this.S-o)};function K(o){o.j.G==0||o.J||Rf(o.j,o)}function ue(o){W(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,wi(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function $e(o,c){try{var f=o.j;if(f.G!=0&&(f.g==o||Xt(f.h,o))){if(!o.K&&Xt(f.h,o)&&f.G==3){try{var _=f.Da.g.parse(c)}catch{_=null}if(Array.isArray(_)&&_.length==3){var b=_;if(b[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)_a(f),ya(f);else break e;Eu(f),Ge(18)}}else f.za=b[1],0<f.za-f.T&&37500>b[2]&&f.F&&f.v==0&&!f.C&&(f.C=pr(y(f.Za,f),6e3));if(1>=Dt(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Xr(f,11)}else if((o.K||f.g==o)&&_a(f),!S(c))for(b=f.Da.g.parse(c),c=0;c<b.length;c++){let _e=b[c];if(f.T=_e[0],_e=_e[1],f.G==2)if(_e[0]=="c"){f.K=_e[1],f.ia=_e[2];const Et=_e[3];Et!=null&&(f.la=Et,f.j.info("VER="+f.la));const Tt=_e[4];Tt!=null&&(f.Aa=Tt,f.j.info("SVER="+f.Aa));const Di=_e[5];Di!=null&&typeof Di=="number"&&0<Di&&(_=1.5*Di,f.L=_,f.j.info("backChannelRequestTimeoutMs_="+_)),_=f;const _n=o.g;if(_n){const wa=_n.g?_n.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wa){var j=_.h;j.g||wa.indexOf("spdy")==-1&&wa.indexOf("quic")==-1&&wa.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(st(j,j.h),j.h=null))}if(_.D){const Iu=_n.g?_n.g.getResponseHeader("X-HTTP-Session-Id"):null;Iu&&(_.ya=Iu,De(_.I,_.D,Iu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),_=f;var Q=o;if(_.qa=Df(_,_.J?_.ia:null,_.W),Q.K){Ri(_.h,Q);var Ae=Q,pt=_.L;pt&&(Ae.I=pt),Ae.B&&(W(Ae),q(Ae)),_.g=Q}else Af(_);0<f.i.length&&va(f)}else _e[0]!="stop"&&_e[0]!="close"||Xr(f,7);else f.G==3&&(_e[0]=="stop"||_e[0]=="close"?_e[0]=="stop"?Xr(f,7):Su(f):_e[0]!="noop"&&f.l&&f.l.ta(_e),f.v=0)}}Ti(4)}catch{}}var ut=class{constructor(o,c){this.g=o,this.map=c}};function Qe(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ft(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Dt(o){return o.h?1:o.g?o.g.size:0}function Xt(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function st(o,c){o.g?o.g.add(c):o.h=c}function Ri(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Qe.prototype.cancel=function(){if(this.i=Jt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Jt(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(const f of o.g.values())c=c.concat(f.D);return c}return P(o.i)}function Rs(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var c=[],f=o.length,_=0;_<f;_++)c.push(o[_]);return c}c=[],f=0;for(_ in o)c[f++]=o[_];return c}function le(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var c=[];o=o.length;for(var f=0;f<o;f++)c.push(f);return c}c=[],f=0;for(const _ in o)c[f++]=_;return c}}}function We(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var f=le(o),_=Rs(o),b=_.length,j=0;j<b;j++)c.call(void 0,_[j],f&&f[j],o)}var Ot=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ps(o,c){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var _=o[f].indexOf("="),b=null;if(0<=_){var j=o[f].substring(0,_);b=o[f].substring(_+1)}else j=o[f];c(j,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function $n(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof $n){this.h=o.h,da(this,o.j),this.o=o.o,this.g=o.g,ha(this,o.s),this.l=o.l;var c=o.i,f=new Ns;f.i=c.i,c.g&&(f.g=new Map(c.g),f.h=c.h),df(this,f),this.m=o.m}else o&&(c=String(o).match(Ot))?(this.h=!1,da(this,c[1]||"",!0),this.o=bs(c[2]||""),this.g=bs(c[3]||"",!0),ha(this,c[4]),this.l=bs(c[5]||"",!0),df(this,c[6]||"",!0),this.m=bs(c[7]||"")):(this.h=!1,this.i=new Ns(null,this.h))}$n.prototype.toString=function(){var o=[],c=this.j;c&&o.push(Ds(c,hf,!0),":");var f=this.g;return(f||c=="file")&&(o.push("//"),(c=this.o)&&o.push(Ds(c,hf,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(Ds(f,f.charAt(0)=="/"?Hv:Wv,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",Ds(f,Gv)),o.join("")};function Wn(o){return new $n(o)}function da(o,c,f){o.j=f?bs(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function ha(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function df(o,c,f){c instanceof Ns?(o.i=c,Qv(o.i,o.h)):(f||(c=Ds(c,qv)),o.i=new Ns(c,o.h))}function De(o,c,f){o.i.set(c,f)}function fa(o){return De(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function bs(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Ds(o,c,f){return typeof o=="string"?(o=encodeURI(o).replace(c,$v),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function $v(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var hf=/[#\/\?@]/g,Wv=/[#\?:]/g,Hv=/[#\?]/g,qv=/[#\?@]/g,Gv=/#/g;function Ns(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function gr(o){o.g||(o.g=new Map,o.h=0,o.i&&Ps(o.i,function(c,f){o.add(decodeURIComponent(c.replace(/\+/g," ")),f)}))}t=Ns.prototype,t.add=function(o,c){gr(this),this.i=null,o=Pi(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(c),this.h+=1,this};function ff(o,c){gr(o),c=Pi(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function pf(o,c){return gr(o),c=Pi(o,c),o.g.has(c)}t.forEach=function(o,c){gr(this),this.g.forEach(function(f,_){f.forEach(function(b){o.call(c,b,_,this)},this)},this)},t.na=function(){gr(this);const o=Array.from(this.g.values()),c=Array.from(this.g.keys()),f=[];for(let _=0;_<c.length;_++){const b=o[_];for(let j=0;j<b.length;j++)f.push(c[_])}return f},t.V=function(o){gr(this);let c=[];if(typeof o=="string")pf(this,o)&&(c=c.concat(this.g.get(Pi(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)c=c.concat(o[f])}return c},t.set=function(o,c){return gr(this),this.i=null,o=Pi(this,o),pf(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},t.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function mf(o,c,f){ff(o,c),0<f.length&&(o.i=null,o.g.set(Pi(o,c),P(f)),o.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],c=Array.from(this.g.keys());for(var f=0;f<c.length;f++){var _=c[f];const j=encodeURIComponent(String(_)),Q=this.V(_);for(_=0;_<Q.length;_++){var b=j;Q[_]!==""&&(b+="="+encodeURIComponent(String(Q[_]))),o.push(b)}}return this.i=o.join("&")};function Pi(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function Qv(o,c){c&&!o.j&&(gr(o),o.i=null,o.g.forEach(function(f,_){var b=_.toLowerCase();_!=b&&(ff(this,_),mf(this,b,f))},o)),o.j=c}function Kv(o,c){const f=new Qr;if(l.Image){const _=new Image;_.onload=E(yr,f,"TestLoadImage: loaded",!0,c,_),_.onerror=E(yr,f,"TestLoadImage: error",!1,c,_),_.onabort=E(yr,f,"TestLoadImage: abort",!1,c,_),_.ontimeout=E(yr,f,"TestLoadImage: timeout",!1,c,_),l.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=o}else c(!1)}function Yv(o,c){const f=new Qr,_=new AbortController,b=setTimeout(()=>{_.abort(),yr(f,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:_.signal}).then(j=>{clearTimeout(b),j.ok?yr(f,"TestPingServer: ok",!0,c):yr(f,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(b),yr(f,"TestPingServer: error",!1,c)})}function yr(o,c,f,_,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),_(f)}catch{}}function Xv(){this.g=new cf}function Jv(o,c,f){const _=f||"";try{We(o,function(b,j){let Q=b;h(b)&&(Q=ra(b)),c.push(_+j+"="+encodeURIComponent(Q))})}catch(b){throw c.push(_+"type="+encodeURIComponent("_badmap")),b}}function pa(o){this.l=o.Ub||null,this.j=o.eb||!1}A(pa,Si),pa.prototype.g=function(){return new ma(this.l,this.j)},pa.prototype.i=function(o){return function(){return o}}({});function ma(o,c){nt.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(ma,nt),t=ma.prototype,t.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,Vs(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,js(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Vs(this)),this.g&&(this.readyState=3,Vs(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;gf(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function gf(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?js(this):Vs(this),this.readyState==3&&gf(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,js(this))},t.Qa=function(o){this.g&&(this.response=o,js(this))},t.ga=function(){this.g&&js(this)};function js(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Vs(o)}t.setRequestHeader=function(o,c){this.u.append(o,c)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],c=this.h.entries();for(var f=c.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=c.next();return o.join(`\r
`)};function Vs(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(ma.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function yf(o){let c="";return M(o,function(f,_){c+=_,c+=":",c+=f,c+=`\r
`}),c}function wu(o,c,f){e:{for(_ in f){var _=!1;break e}_=!0}_||(f=yf(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):De(o,c,f))}function He(o){nt.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(He,nt);var Zv=/^https?$/i,e_=["POST","PUT"];t=He.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,c,f,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ks.g(),this.v=this.o?it(this.o):it(ks),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(j){vf(this,j);return}if(o=f||"",f=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var b in _)f.set(b,_[b]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const j of _.keys())f.set(j,_.get(j));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(f.keys()).find(j=>j.toLowerCase()=="content-type"),b=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(e_,c,void 0))||_||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,Q]of f)this.g.setRequestHeader(j,Q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{wf(this),this.u=!0,this.g.send(o),this.u=!1}catch(j){vf(this,j)}};function vf(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,_f(o),ga(o)}function _f(o){o.A||(o.A=!0,rt(o,"complete"),rt(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,rt(this,"complete"),rt(this,"abort"),ga(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ga(this,!0)),He.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?xf(this):this.bb())},t.bb=function(){xf(this)};function xf(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Hn(o)!=4||o.Z()!=2)){if(o.u&&Hn(o)==4)xi(o.Ea,0,o);else if(rt(o,"readystatechange"),Hn(o)==4){o.h=!1;try{const Q=o.Z();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var f;if(!(f=c)){var _;if(_=Q===0){var b=String(o.D).match(Ot)[1]||null;!b&&l.self&&l.self.location&&(b=l.self.location.protocol.slice(0,-1)),_=!Zv.test(b?b.toLowerCase():"")}f=_}if(f)rt(o,"complete"),rt(o,"success");else{o.m=6;try{var j=2<Hn(o)?o.g.statusText:""}catch{j=""}o.l=j+" ["+o.Z()+"]",_f(o)}}finally{ga(o)}}}}function ga(o,c){if(o.g){wf(o);const f=o.g,_=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||rt(o,"ready");try{f.onreadystatechange=_}catch{}}}function wf(o){o.I&&(l.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function Hn(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<Hn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),ia(c)}};function Sf(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function t_(o){const c={};o=(o.g&&2<=Hn(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<o.length;_++){if(S(o[_]))continue;var f=k(o[_]);const b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const j=c[b]||[];c[b]=j,j.push(f)}v(c,function(_){return _.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ms(o,c,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||c}function Ef(o){this.Aa=0,this.i=[],this.j=new Qr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ms("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ms("baseRetryDelayMs",5e3,o),this.cb=Ms("retryDelaySeedMs",1e4,o),this.Wa=Ms("forwardChannelMaxRetries",2,o),this.wa=Ms("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Qe(o&&o.concurrentRequestLimit),this.Da=new Xv,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ef.prototype,t.la=8,t.G=1,t.connect=function(o,c,f,_){Ge(0),this.W=o,this.H=c||{},f&&_!==void 0&&(this.H.OSID=f,this.H.OAID=_),this.F=this.X,this.I=Df(this,null,this.W),va(this)};function Su(o){if(Tf(o),o.G==3){var c=o.U++,f=Wn(o.I);if(De(f,"SID",o.K),De(f,"RID",c),De(f,"TYPE","terminate"),Ls(o,f),c=new cn(o,o.j,c),c.L=2,c.v=fa(Wn(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=c.v,f=!0),f||(c.g=Nf(c.j,null),c.g.ea(c.v)),c.F=Date.now(),q(c)}bf(o)}function ya(o){o.g&&(Tu(o),o.g.cancel(),o.g=null)}function Tf(o){ya(o),o.u&&(l.clearTimeout(o.u),o.u=null),_a(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function va(o){if(!ft(o.h)&&!o.s){o.s=!0;var c=o.Ga;$||G(),N||($(),N=!0),O.add(c,o),o.B=0}}function n_(o,c){return Dt(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=pr(y(o.Ga,o,c),Pf(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const b=new cn(this,this.j,o);let j=this.o;if(this.S&&(j?(j=m(j),w(j,this.S)):j=this.S),this.m!==null||this.O||(b.H=j,j=null),this.P)e:{for(var c=0,f=0;f<this.i.length;f++){t:{var _=this.i[f];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(c+=_,4096<c){c=f;break e}if(c===4096||f===this.i.length-1){c=f+1;break e}}c=1e3}else c=1e3;c=Cf(this,b,c),f=Wn(this.I),De(f,"RID",o),De(f,"CVER",22),this.D&&De(f,"X-HTTP-Session-Id",this.D),Ls(this,f),j&&(this.O?c="headers="+encodeURIComponent(String(yf(j)))+"&"+c:this.m&&wu(f,this.m,j)),st(this.h,b),this.Ua&&De(f,"TYPE","init"),this.P?(De(f,"$req",c),De(f,"SID","null"),b.T=!0,vn(b,f,null)):vn(b,f,c),this.G=2}}else this.G==3&&(o?If(this,o):this.i.length==0||ft(this.h)||If(this))};function If(o,c){var f;c?f=c.l:f=o.U++;const _=Wn(o.I);De(_,"SID",o.K),De(_,"RID",f),De(_,"AID",o.T),Ls(o,_),o.m&&o.o&&wu(_,o.m,o.o),f=new cn(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),c&&(o.i=c.D.concat(o.i)),c=Cf(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),st(o.h,f),vn(f,_,c)}function Ls(o,c){o.H&&M(o.H,function(f,_){De(c,_,f)}),o.l&&We({},function(f,_){De(c,_,f)})}function Cf(o,c,f){f=Math.min(o.i.length,f);var _=o.l?y(o.l.Na,o.l,o):null;e:{var b=o.i;let j=-1;for(;;){const Q=["count="+f];j==-1?0<f?(j=b[0].g,Q.push("ofs="+j)):j=0:Q.push("ofs="+j);let Ae=!0;for(let pt=0;pt<f;pt++){let _e=b[pt].g;const Et=b[pt].map;if(_e-=j,0>_e)j=Math.max(0,b[pt].g-100),Ae=!1;else try{Jv(Et,Q,"req"+_e+"_")}catch{_&&_(Et)}}if(Ae){_=Q.join("&");break e}}}return o=o.i.splice(0,f),c.D=o,_}function Af(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;$||G(),N||($(),N=!0),O.add(c,o),o.v=0}}function Eu(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=pr(y(o.Fa,o),Pf(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,kf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=pr(y(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ge(10),ya(this),kf(this))};function Tu(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function kf(o){o.g=new cn(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=Wn(o.qa);De(c,"RID","rpc"),De(c,"SID",o.K),De(c,"AID",o.T),De(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&De(c,"TO",o.ja),De(c,"TYPE","xmlhttp"),Ls(o,c),o.m&&o.o&&wu(c,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=fa(Wn(c)),f.m=null,f.P=!0,la(f,o)}t.Za=function(){this.C!=null&&(this.C=null,ya(this),Eu(this),Ge(19))};function _a(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function Rf(o,c){var f=null;if(o.g==c){_a(o),Tu(o),o.g=null;var _=2}else if(Xt(o.h,c))f=c.D,Ri(o.h,c),_=1;else return;if(o.G!=0){if(c.o)if(_==1){f=c.m?c.m.length:0,c=Date.now()-c.F;var b=o.B;_=Ei(),rt(_,new Ci(_,f)),va(o)}else Af(o);else if(b=c.s,b==3||b==0&&0<c.X||!(_==1&&n_(o,c)||_==2&&Eu(o)))switch(f&&0<f.length&&(c=o.h,c.i=c.i.concat(f)),b){case 1:Xr(o,5);break;case 4:Xr(o,10);break;case 3:Xr(o,6);break;default:Xr(o,2)}}}function Pf(o,c){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*c}function Xr(o,c){if(o.j.info("Error code "+c),c==2){var f=y(o.fb,o),_=o.Xa;const b=!_;_=new $n(_||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||da(_,"https"),fa(_),b?Kv(_.toString(),f):Yv(_.toString(),f)}else Ge(2);o.G=0,o.l&&o.l.sa(c),bf(o),Tf(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Ge(2)):(this.j.info("Failed to ping google.com"),Ge(1))};function bf(o){if(o.G=0,o.ka=[],o.l){const c=Jt(o.h);(c.length!=0||o.i.length!=0)&&(F(o.ka,c),F(o.ka,o.i),o.h.i.length=0,P(o.i),o.i.length=0),o.l.ra()}}function Df(o,c,f){var _=f instanceof $n?Wn(f):new $n(f);if(_.g!="")c&&(_.g=c+"."+_.g),ha(_,_.s);else{var b=l.location;_=b.protocol,c=c?c+"."+b.hostname:b.hostname,b=+b.port;var j=new $n(null);_&&da(j,_),c&&(j.g=c),b&&ha(j,b),f&&(j.l=f),_=j}return f=o.D,c=o.ya,f&&c&&De(_,f,c),De(_,"VER",o.la),Ls(o,_),_}function Nf(o,c,f){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new He(new pa({eb:f})):new He(o.pa),c.Ha(o.J),c}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function jf(){}t=jf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function xa(){}xa.prototype.g=function(o,c){return new Zt(o,c)};function Zt(o,c){nt.call(this),this.g=new Ef(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!S(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!S(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new bi(this)}A(Zt,nt),Zt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Zt.prototype.close=function(){Su(this.g)},Zt.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=ra(o),o=f);c.i.push(new ut(c.Ya++,o)),c.G==3&&va(c)},Zt.prototype.N=function(){this.g.l=null,delete this.j,Su(this.g),delete this.g,Zt.aa.N.call(this)};function Vf(o){Bn.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(const f in c){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}A(Vf,Bn);function Mf(){Un.call(this),this.status=1}A(Mf,Un);function bi(o){this.g=o}A(bi,jf),bi.prototype.ua=function(){rt(this.g,"a")},bi.prototype.ta=function(o){rt(this.g,new Vf(o))},bi.prototype.sa=function(o){rt(this.g,new Mf)},bi.prototype.ra=function(){rt(this.g,"b")},xa.prototype.createWebChannel=xa.prototype.g,Zt.prototype.send=Zt.prototype.o,Zt.prototype.open=Zt.prototype.m,Zt.prototype.close=Zt.prototype.close,S0=function(){return new xa},w0=function(){return Ei()},x0=yn,ld={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Yr.NO_ERROR=0,Yr.TIMEOUT=8,Yr.HTTP_ERROR=6,tl=Yr,As.COMPLETE="complete",_0=As,sa.EventType=Yt,Yt.OPEN="a",Yt.CLOSE="b",Yt.ERROR="c",Yt.MESSAGE="d",nt.prototype.listen=nt.prototype.K,Xs=sa,He.prototype.listenOnce=He.prototype.L,He.prototype.getLastError=He.prototype.Ka,He.prototype.getLastErrorCode=He.prototype.Ba,He.prototype.getStatus=He.prototype.Z,He.prototype.getResponseJson=He.prototype.Oa,He.prototype.getResponseText=He.prototype.oa,He.prototype.send=He.prototype.ea,He.prototype.setWithCredentials=He.prototype.Ha,v0=He}).apply(typeof Fa<"u"?Fa:typeof self<"u"?self:typeof window<"u"?window:{});const rm="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ft.UNAUTHENTICATED=new Ft(null),Ft.GOOGLE_CREDENTIALS=new Ft("google-credentials-uid"),Ft.FIRST_PARTY=new Ft("first-party-uid"),Ft.MOCK_USER=new Ft("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xs="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi=new c0("@firebase/firestore");function qs(){return fi.logLevel}function J(t,...e){if(fi.logLevel<=ye.DEBUG){const n=e.map(Ah);fi.debug(`Firestore (${xs}): ${t}`,...n)}}function or(t,...e){if(fi.logLevel<=ye.ERROR){const n=e.map(Ah);fi.error(`Firestore (${xs}): ${t}`,...n)}}function jo(t,...e){if(fi.logLevel<=ye.WARN){const n=e.map(Ah);fi.warn(`Firestore (${xs}): ${t}`,...n)}}function Ah(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oe(t="Unexpected state"){const e=`FIRESTORE (${xs}) INTERNAL ASSERTION FAILED: `+t;throw or(e),new Error(e)}function Te(t,e){t||oe()}function de(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Y extends _s{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ft.UNAUTHENTICATED))}shutdown(){}}class aS{constructor(e){this.t=e,this.currentUser=Ft.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Te(this.o===void 0);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let s=new Zn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Zn,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},l=u=>{J("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(J("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Zn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(J("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Te(typeof r.accessToken=="string"),new sS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Te(e===null||typeof e=="string"),new Ft(e)}}class lS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ft.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class uS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new lS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ft.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Te(this.o===void 0);const r=s=>{s.error!=null&&J("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,J("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{J("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):J("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Te(typeof n.token=="string"),this.R=n.token,new cS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=hS(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function xe(t,e){return t<e?-1:t>e?1:0}function cs(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Y(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Y(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new Y(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Y(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return lt.fromMillis(Date.now())}static fromDate(e){return lt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new lt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ce(e)}static min(){return new ce(new lt(0,0))}static max(){return new ce(new lt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(e,n,r){n===void 0?n=0:n>e.length&&oe(),r===void 0?r=e.length-n:r>e.length-n&&oe(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Vo.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Vo?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),a=n.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class je extends Vo{construct(e,n,r){return new je(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Y(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new je(n)}static emptyPath(){return new je([])}}const fS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yt extends Vo{construct(e,n,r){return new yt(e,n,r)}static isValidIdentifier(e){return fS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new yt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new Y(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new Y(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Y(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(r+=l,i++):(s(),i++)}if(s(),a)throw new Y(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yt(n)}static emptyPath(){return new yt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.path=e}static fromPath(e){return new re(je.fromString(e))}static fromName(e){return new re(je.fromString(e).popFirst(5))}static empty(){return new re(je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return je.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new re(new je(e.slice()))}}function pS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ce.fromTimestamp(r===1e9?new lt(n+1,0):new lt(n,r));return new zr(i,re.empty(),e)}function mS(t){return new zr(t.readTime,t.key,-1)}class zr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new zr(ce.min(),re.empty(),-1)}static max(){return new zr(ce.max(),re.empty(),-1)}}function gS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=re.comparator(t.documentKey,e.documentKey),n!==0?n:xe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qo(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==yS)throw t;J("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&oe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let i=0,s=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++s,a&&s===i&&n()},u=>r(u))}),a=!0,s===i&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(i=>i?U.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new U((r,i)=>{const s=e.length,a=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;n(e[h]).next(p=>{a[h]=p,++l,l===s&&r(a)},p=>i(p))}})}static doWhile(e,n){return new U((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function _S(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ko(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}kh.oe=-1;function ru(t){return t==null}function Dl(t){return t===0&&1/t==-1/0}function xS(t){return typeof t=="number"&&Number.isInteger(t)&&!Dl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function im(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function vi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function T0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,n){this.comparator=e,this.root=n||gt.EMPTY}insert(e,n){return new Ue(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,gt.BLACK,null,null))}remove(e){return new Ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new za(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new za(this.root,e,this.comparator,!1)}getReverseIterator(){return new za(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new za(this.root,e,this.comparator,!0)}}class za{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??gt.RED,this.left=i??gt.EMPTY,this.right=s??gt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new gt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return gt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return gt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw oe();const e=this.left.check();if(e!==this.right.check())throw oe();return e+(this.isRed()?0:1)}}gt.EMPTY=null,gt.RED=!0,gt.BLACK=!1;gt.EMPTY=new class{constructor(){this.size=0}get key(){throw oe()}get value(){throw oe()}get color(){throw oe()}get left(){throw oe()}get right(){throw oe()}copy(e,n,r,i,s){return this}insert(e,n,r){return new gt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.comparator=e,this.data=new Ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new sm(this.data.getIterator())}getIteratorFrom(e){return new sm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof _t)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new _t(this.comparator);return n.data=e,n}}class sm{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.fields=e,e.sort(yt.comparator)}static empty(){return new nn([])}unionWith(e){let n=new _t(yt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new nn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return cs(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new I0("Invalid base64 string: "+s):s}}(e);return new wt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new wt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}wt.EMPTY_BYTE_STRING=new wt("");const wS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Br(t){if(Te(!!t),typeof t=="string"){let e=0;const n=wS.exec(t);if(Te(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ke(t.seconds),nanos:Ke(t.nanos)}}function Ke(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function pi(t){return typeof t=="string"?wt.fromBase64String(t):wt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Ph(t){const e=t.mapValue.fields.__previous_value__;return Rh(e)?Ph(e):e}function Mo(t){const e=Br(t.mapValue.fields.__local_write_time__.timestampValue);return new lt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,n,r,i,s,a,l,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}}class Lo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Lo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Lo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ba={mapValue:{}};function mi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Rh(t)?4:TS(t)?9007199254740991:ES(t)?10:11:oe()}function zn(t,e){if(t===e)return!0;const n=mi(t);if(n!==mi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Mo(t).isEqual(Mo(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Br(i.timestampValue),l=Br(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return pi(i.bytesValue).isEqual(pi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Ke(i.geoPointValue.latitude)===Ke(s.geoPointValue.latitude)&&Ke(i.geoPointValue.longitude)===Ke(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ke(i.integerValue)===Ke(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Ke(i.doubleValue),l=Ke(s.doubleValue);return a===l?Dl(a)===Dl(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return cs(t.arrayValue.values||[],e.arrayValue.values||[],zn);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(im(a)!==im(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!zn(a[u],l[u])))return!1;return!0}(t,e);default:return oe()}}function Oo(t,e){return(t.values||[]).find(n=>zn(n,e))!==void 0}function ds(t,e){if(t===e)return 0;const n=mi(t),r=mi(e);if(n!==r)return xe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xe(t.booleanValue,e.booleanValue);case 2:return function(s,a){const l=Ke(s.integerValue||s.doubleValue),u=Ke(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return om(t.timestampValue,e.timestampValue);case 4:return om(Mo(t),Mo(e));case 5:return xe(t.stringValue,e.stringValue);case 6:return function(s,a){const l=pi(s),u=pi(a);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const l=s.split("/"),u=a.split("/");for(let h=0;h<l.length&&h<u.length;h++){const p=xe(l[h],u[h]);if(p!==0)return p}return xe(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const l=xe(Ke(s.latitude),Ke(a.latitude));return l!==0?l:xe(Ke(s.longitude),Ke(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return am(t.arrayValue,e.arrayValue);case 10:return function(s,a){var l,u,h,p;const g=s.fields||{},y=a.fields||{},E=(l=g.value)===null||l===void 0?void 0:l.arrayValue,A=(u=y.value)===null||u===void 0?void 0:u.arrayValue,P=xe(((h=E==null?void 0:E.values)===null||h===void 0?void 0:h.length)||0,((p=A==null?void 0:A.values)===null||p===void 0?void 0:p.length)||0);return P!==0?P:am(E,A)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===Ba.mapValue&&a===Ba.mapValue)return 0;if(s===Ba.mapValue)return 1;if(a===Ba.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=a.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let g=0;g<u.length&&g<p.length;++g){const y=xe(u[g],p[g]);if(y!==0)return y;const E=ds(l[u[g]],h[p[g]]);if(E!==0)return E}return xe(u.length,p.length)}(t.mapValue,e.mapValue);default:throw oe()}}function om(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xe(t,e);const n=Br(t),r=Br(e),i=xe(n.seconds,r.seconds);return i!==0?i:xe(n.nanos,r.nanos)}function am(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=ds(n[i],r[i]);if(s)return s}return xe(n.length,r.length)}function hs(t){return ud(t)}function ud(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Br(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return pi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return re.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=ud(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${ud(n.fields[a])}`;return i+"}"}(t.mapValue):oe()}function lm(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function cd(t){return!!t&&"integerValue"in t}function bh(t){return!!t&&"arrayValue"in t}function um(t){return!!t&&"nullValue"in t}function cm(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function nl(t){return!!t&&"mapValue"in t}function ES(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function co(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return vi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=co(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=co(t.arrayValue.values[n]);return e}return Object.assign({},t)}function TS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.value=e}static empty(){return new Bt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!nl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=co(n)}setAll(e){let n=yt.emptyPath(),r={},i=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=l.popLast()}a?r[l.lastSegment()]=co(a):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());nl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return zn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];nl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){vi(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Bt(co(this.value))}}function C0(t){const e=[];return vi(t.fields,(n,r)=>{const i=new yt([n]);if(nl(r)){const s=C0(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new nn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,n,r,i,s,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Rt(e,0,ce.min(),ce.min(),ce.min(),Bt.empty(),0)}static newFoundDocument(e,n,r,i){return new Rt(e,1,n,ce.min(),r,i,0)}static newNoDocument(e,n){return new Rt(e,2,n,ce.min(),ce.min(),Bt.empty(),0)}static newUnknownDocument(e,n){return new Rt(e,3,n,ce.min(),ce.min(),Bt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Rt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,n){this.position=e,this.inclusive=n}}function dm(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?r=re.comparator(re.fromName(a.referenceValue),n.key):r=ds(a,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function hm(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!zn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(e,n="asc"){this.field=e,this.dir=n}}function IS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{}class tt extends A0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new AS(e,n,r):n==="array-contains"?new PS(e,r):n==="in"?new bS(e,r):n==="not-in"?new DS(e,r):n==="array-contains-any"?new NS(e,r):new tt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new kS(e,r):new RS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ds(n,this.value)):n!==null&&mi(this.value)===mi(n)&&this.matchesComparison(ds(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return oe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pn extends A0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Pn(e,n)}matches(e){return k0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function k0(t){return t.op==="and"}function R0(t){return CS(t)&&k0(t)}function CS(t){for(const e of t.filters)if(e instanceof Pn)return!1;return!0}function dd(t){if(t instanceof tt)return t.field.canonicalString()+t.op.toString()+hs(t.value);if(R0(t))return t.filters.map(e=>dd(e)).join(",");{const e=t.filters.map(n=>dd(n)).join(",");return`${t.op}(${e})`}}function P0(t,e){return t instanceof tt?function(r,i){return i instanceof tt&&r.op===i.op&&r.field.isEqual(i.field)&&zn(r.value,i.value)}(t,e):t instanceof Pn?function(r,i){return i instanceof Pn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,l)=>s&&P0(a,i.filters[l]),!0):!1}(t,e):void oe()}function b0(t){return t instanceof tt?function(n){return`${n.field.canonicalString()} ${n.op} ${hs(n.value)}`}(t):t instanceof Pn?function(n){return n.op.toString()+" {"+n.getFilters().map(b0).join(" ,")+"}"}(t):"Filter"}class AS extends tt{constructor(e,n,r){super(e,n,r),this.key=re.fromName(r.referenceValue)}matches(e){const n=re.comparator(e.key,this.key);return this.matchesComparison(n)}}class kS extends tt{constructor(e,n){super(e,"in",n),this.keys=D0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class RS extends tt{constructor(e,n){super(e,"not-in",n),this.keys=D0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function D0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>re.fromName(r.referenceValue))}class PS extends tt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return bh(n)&&Oo(n.arrayValue,this.value)}}class bS extends tt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Oo(this.value.arrayValue,n)}}class DS extends tt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Oo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Oo(this.value.arrayValue,n)}}class NS extends tt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!bh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Oo(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e,n=null,r=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.ue=null}}function fm(t,e=null,n=[],r=[],i=null,s=null,a=null){return new jS(t,e,n,r,i,s,a)}function Dh(t){const e=de(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>dd(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ru(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>hs(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>hs(r)).join(",")),e.ue=n}return e.ue}function Nh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!IS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!P0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!hm(t.startAt,e.startAt)&&hm(t.endAt,e.endAt)}function hd(t){return re.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e,n=null,r=[],i=[],s=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function VS(t,e,n,r,i,s,a,l){return new Yo(t,e,n,r,i,s,a,l)}function jh(t){return new Yo(t)}function pm(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function N0(t){return t.collectionGroup!==null}function ho(t){const e=de(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new _t(yt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new jl(s,r))}),n.has(yt.keyField().canonicalString())||e.ce.push(new jl(yt.keyField(),r))}return e.ce}function On(t){const e=de(t);return e.le||(e.le=MS(e,ho(t))),e.le}function MS(t,e){if(t.limitType==="F")return fm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new jl(i.field,s)});const n=t.endAt?new Nl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Nl(t.startAt.position,t.startAt.inclusive):null;return fm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function fd(t,e){const n=t.filters.concat([e]);return new Yo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function pd(t,e,n){return new Yo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function iu(t,e){return Nh(On(t),On(e))&&t.limitType===e.limitType}function j0(t){return`${Dh(On(t))}|lt:${t.limitType}`}function ji(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>b0(i)).join(", ")}]`),ru(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>hs(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>hs(i)).join(",")),`Target(${r})`}(On(t))}; limitType=${t.limitType})`}function su(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):re.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of ho(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(a,l,u){const h=dm(a,l,u);return a.inclusive?h<=0:h<0}(r.startAt,ho(r),i)||r.endAt&&!function(a,l,u){const h=dm(a,l,u);return a.inclusive?h>=0:h>0}(r.endAt,ho(r),i))}(t,e)}function LS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function V0(t){return(e,n)=>{let r=!1;for(const i of ho(t)){const s=OS(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function OS(t,e,n){const r=t.field.isKeyField()?re.comparator(e.key,n.key):function(s,a,l){const u=a.data.field(s),h=l.data.field(s);return u!==null&&h!==null?ds(u,h):oe()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return oe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){vi(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return T0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS=new Ue(re.comparator);function ar(){return FS}const M0=new Ue(re.comparator);function Js(...t){let e=M0;for(const n of t)e=e.insert(n.key,n);return e}function L0(t){let e=M0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ii(){return fo()}function O0(){return fo()}function fo(){return new ws(t=>t.toString(),(t,e)=>t.isEqual(e))}const zS=new Ue(re.comparator),BS=new _t(re.comparator);function me(...t){let e=BS;for(const n of t)e=e.add(n);return e}const US=new _t(xe);function $S(){return US}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dl(e)?"-0":e}}function F0(t){return{integerValue:""+t}}function WS(t,e){return xS(e)?F0(e):Vh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(){this._=void 0}}function HS(t,e,n){return t instanceof Fo?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Rh(s)&&(s=Ph(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(n,e):t instanceof zo?B0(t,e):t instanceof Bo?U0(t,e):function(i,s){const a=z0(i,s),l=mm(a)+mm(i.Pe);return cd(a)&&cd(i.Pe)?F0(l):Vh(i.serializer,l)}(t,e)}function qS(t,e,n){return t instanceof zo?B0(t,e):t instanceof Bo?U0(t,e):n}function z0(t,e){return t instanceof Vl?function(r){return cd(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Fo extends ou{}class zo extends ou{constructor(e){super(),this.elements=e}}function B0(t,e){const n=$0(e);for(const r of t.elements)n.some(i=>zn(i,r))||n.push(r);return{arrayValue:{values:n}}}class Bo extends ou{constructor(e){super(),this.elements=e}}function U0(t,e){let n=$0(e);for(const r of t.elements)n=n.filter(i=>!zn(i,r));return{arrayValue:{values:n}}}class Vl extends ou{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function mm(t){return Ke(t.integerValue||t.doubleValue)}function $0(t){return bh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,n){this.field=e,this.transform=n}}function QS(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof zo&&i instanceof zo||r instanceof Bo&&i instanceof Bo?cs(r.elements,i.elements,zn):r instanceof Vl&&i instanceof Vl?zn(r.Pe,i.Pe):r instanceof Fo&&i instanceof Fo}(t.transform,e.transform)}class KS{constructor(e,n){this.version=e,this.transformResults=n}}class An{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new An}static exists(e){return new An(void 0,e)}static updateTime(e){return new An(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function rl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class au{}function W0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new q0(t.key,An.none()):new Xo(t.key,t.data,An.none());{const n=t.data,r=Bt.empty();let i=new _t(yt.comparator);for(let s of e.fields)if(!i.has(s)){let a=n.field(s);a===null&&s.length>1&&(s=s.popLast(),a=n.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new qr(t.key,r,new nn(i.toArray()),An.none())}}function YS(t,e,n){t instanceof Xo?function(i,s,a){const l=i.value.clone(),u=ym(i.fieldTransforms,s,a.transformResults);l.setAll(u),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof qr?function(i,s,a){if(!rl(i.precondition,s))return void s.convertToUnknownDocument(a.version);const l=ym(i.fieldTransforms,s,a.transformResults),u=s.data;u.setAll(H0(i)),u.setAll(l),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function po(t,e,n,r){return t instanceof Xo?function(s,a,l,u){if(!rl(s.precondition,a))return l;const h=s.value.clone(),p=vm(s.fieldTransforms,u,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof qr?function(s,a,l,u){if(!rl(s.precondition,a))return l;const h=vm(s.fieldTransforms,u,a),p=a.data;return p.setAll(H0(s)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(s,a,l){return rl(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function XS(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=z0(r.transform,i||null);s!=null&&(n===null&&(n=Bt.empty()),n.set(r.field,s))}return n||null}function gm(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&cs(r,i,(s,a)=>QS(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xo extends au{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class qr extends au{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function H0(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function ym(t,e,n){const r=new Map;Te(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],a=s.transform,l=e.data.field(s.field);r.set(s.field,qS(a,l,n[i]))}return r}function vm(t,e,n){const r=new Map;for(const i of t){const s=i.transform,a=n.data.field(i.field);r.set(i.field,HS(s,a,e))}return r}class q0 extends au{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class JS extends au{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&YS(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=po(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=po(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=O0();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=n.has(i.key)?null:l;const u=W0(a,l);u!==null&&r.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(ce.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),me())}isEqual(e){return this.batchId===e.batchId&&cs(this.mutations,e.mutations,(n,r)=>gm(n,r))&&cs(this.baseMutations,e.baseMutations,(n,r)=>gm(n,r))}}class Mh{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Te(e.mutations.length===r.length);let i=function(){return zS}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new Mh(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe,ge;function nE(t){switch(t){default:return oe();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function G0(t){if(t===void 0)return or("GRPC error has no .code"),z.UNKNOWN;switch(t){case Xe.OK:return z.OK;case Xe.CANCELLED:return z.CANCELLED;case Xe.UNKNOWN:return z.UNKNOWN;case Xe.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case Xe.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case Xe.INTERNAL:return z.INTERNAL;case Xe.UNAVAILABLE:return z.UNAVAILABLE;case Xe.UNAUTHENTICATED:return z.UNAUTHENTICATED;case Xe.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case Xe.NOT_FOUND:return z.NOT_FOUND;case Xe.ALREADY_EXISTS:return z.ALREADY_EXISTS;case Xe.PERMISSION_DENIED:return z.PERMISSION_DENIED;case Xe.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case Xe.ABORTED:return z.ABORTED;case Xe.OUT_OF_RANGE:return z.OUT_OF_RANGE;case Xe.UNIMPLEMENTED:return z.UNIMPLEMENTED;case Xe.DATA_LOSS:return z.DATA_LOSS;default:return oe()}}(ge=Xe||(Xe={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iE=new ai([4294967295,4294967295],0);function _m(t){const e=rE().encode(t),n=new y0;return n.update(e),new Uint8Array(n.digest())}function xm(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ai([n,r],0),new ai([i,s],0)]}class Lh{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Zs(`Invalid padding: ${n}`);if(r<0)throw new Zs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Zs(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Zs(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=ai.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(ai.fromNumber(r)));return i.compare(iE)===1&&(i=new ai([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=_m(e),[r,i]=xm(n);for(let s=0;s<this.hashCount;s++){const a=this.Ee(r,i,s);if(!this.de(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Lh(s,i,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=_m(e),[r,i]=xm(n);for(let s=0;s<this.hashCount;s++){const a=this.Ee(r,i,s);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Zs extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Jo.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new lu(ce.min(),i,new Ue(xe),ar(),me())}}class Jo{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Jo(r,n,me(),me(),me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class Q0{constructor(e,n){this.targetId=e,this.me=n}}class K0{constructor(e,n,r=wt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class wm{constructor(){this.fe=0,this.ge=Em(),this.pe=wt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=me(),n=me(),r=me();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:oe()}}),new Jo(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Em()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class sE{constructor(e){this.Le=e,this.Be=new Map,this.ke=ar(),this.qe=Sm(),this.Qe=new Ue(xe)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:oe()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(hd(s))if(r===0){const a=new re(s.path);this.Ue(n,a,Rt.newNoDocument(a,ce.min()))}else Te(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),u=l?this.Xe(l,e,a):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let a,l;try{a=pi(r).toUint8Array()}catch(u){if(u instanceof I0)return jo("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Lh(a,i,s)}catch(u){return jo(u instanceof Zs?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,a)=>{const l=this.Je(a);if(l){if(s.current&&hd(l.target)){const u=new re(l.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,Rt.newNoDocument(u,e))}s.be&&(n.set(a,s.ve()),s.Ce())}});let r=me();this.qe.forEach((s,a)=>{let l=!0;a.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new lu(e,n,this.Qe,this.ke,r);return this.ke=ar(),this.qe=Sm(),this.Qe=new Ue(xe),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new wm,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new _t(xe),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||J("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new wm),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Sm(){return new Ue(re.comparator)}function Em(){return new Ue(re.comparator)}const oE={asc:"ASCENDING",desc:"DESCENDING"},aE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lE={and:"AND",or:"OR"};class uE{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function md(t,e){return t.useProto3Json||ru(e)?e:{value:e}}function Ml(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Y0(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function cE(t,e){return Ml(t,e.toTimestamp())}function Fn(t){return Te(!!t),ce.fromTimestamp(function(n){const r=Br(n);return new lt(r.seconds,r.nanos)}(t))}function Oh(t,e){return gd(t,e).canonicalString()}function gd(t,e){const n=function(i){return new je(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function X0(t){const e=je.fromString(t);return Te(nv(e)),e}function yd(t,e){return Oh(t.databaseId,e.path)}function nc(t,e){const n=X0(e);if(n.get(1)!==t.databaseId.projectId)throw new Y(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Y(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new re(Z0(n))}function J0(t,e){return Oh(t.databaseId,e)}function dE(t){const e=X0(t);return e.length===4?je.emptyPath():Z0(e)}function vd(t){return new je(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Z0(t){return Te(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Tm(t,e,n){return{name:yd(t,e),fields:n.value.mapValue.fields}}function hE(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:oe()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,p){return h.useProto3Json?(Te(p===void 0||typeof p=="string"),wt.fromBase64String(p||"")):(Te(p===void 0||p instanceof Buffer||p instanceof Uint8Array),wt.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){const p=h.code===void 0?z.UNKNOWN:G0(h.code);return new Y(p,h.message||"")}(a);n=new K0(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=nc(t,r.document.name),s=Fn(r.document.updateTime),a=r.document.createTime?Fn(r.document.createTime):ce.min(),l=new Bt({mapValue:{fields:r.document.fields}}),u=Rt.newFoundDocument(i,s,a,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new il(h,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=nc(t,r.document),s=r.readTime?Fn(r.readTime):ce.min(),a=Rt.newNoDocument(i,s),l=r.removedTargetIds||[];n=new il([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=nc(t,r.document),s=r.removedTargetIds||[];n=new il([],s,i,null)}else{if(!("filter"in e))return oe();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new tE(i,s),l=r.targetId;n=new Q0(l,a)}}return n}function fE(t,e){let n;if(e instanceof Xo)n={update:Tm(t,e.key,e.value)};else if(e instanceof q0)n={delete:yd(t,e.key)};else if(e instanceof qr)n={update:Tm(t,e.key,e.data),updateMask:SE(e.fieldMask)};else{if(!(e instanceof JS))return oe();n={verify:yd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const l=a.transform;if(l instanceof Fo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof zo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Bo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Vl)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw oe()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:cE(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:oe()}(t,e.precondition)),n}function pE(t,e){return t&&t.length>0?(Te(e!==void 0),t.map(n=>function(i,s){let a=i.updateTime?Fn(i.updateTime):Fn(s);return a.isEqual(ce.min())&&(a=Fn(s)),new KS(a,i.transformResults||[])}(n,e))):[]}function mE(t,e){return{documents:[J0(t,e.path)]}}function gE(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=J0(t,i);const s=function(h){if(h.length!==0)return tv(Pn.create(h,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const a=function(h){if(h.length!==0)return h.map(p=>function(y){return{field:Vi(y.field),direction:_E(y.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=md(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:i}}function yE(t){let e=dE(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Te(r===1);const p=n.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];n.where&&(s=function(g){const y=ev(g);return y instanceof Pn&&R0(y)?y.getFilters():[y]}(n.where));let a=[];n.orderBy&&(a=function(g){return g.map(y=>function(A){return new jl(Mi(A.field),function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(y))}(n.orderBy));let l=null;n.limit&&(l=function(g){let y;return y=typeof g=="object"?g.value:g,ru(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(g){const y=!!g.before,E=g.values||[];return new Nl(E,y)}(n.startAt));let h=null;return n.endAt&&(h=function(g){const y=!g.before,E=g.values||[];return new Nl(E,y)}(n.endAt)),VS(e,i,a,s,l,"F",u,h)}function vE(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return oe()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function ev(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Mi(n.unaryFilter.field);return tt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Mi(n.unaryFilter.field);return tt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Mi(n.unaryFilter.field);return tt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Mi(n.unaryFilter.field);return tt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return oe()}}(t):t.fieldFilter!==void 0?function(n){return tt.create(Mi(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return oe()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Pn.create(n.compositeFilter.filters.map(r=>ev(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return oe()}}(n.compositeFilter.op))}(t):oe()}function _E(t){return oE[t]}function xE(t){return aE[t]}function wE(t){return lE[t]}function Vi(t){return{fieldPath:t.canonicalString()}}function Mi(t){return yt.fromServerFormat(t.fieldPath)}function tv(t){return t instanceof tt?function(n){if(n.op==="=="){if(cm(n.value))return{unaryFilter:{field:Vi(n.field),op:"IS_NAN"}};if(um(n.value))return{unaryFilter:{field:Vi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(cm(n.value))return{unaryFilter:{field:Vi(n.field),op:"IS_NOT_NAN"}};if(um(n.value))return{unaryFilter:{field:Vi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vi(n.field),op:xE(n.op),value:n.value}}}(t):t instanceof Pn?function(n){const r=n.getFilters().map(i=>tv(i));return r.length===1?r[0]:{compositeFilter:{op:wE(n.op),filters:r}}}(t):oe()}function SE(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function nv(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,n,r,i,s=ce.min(),a=ce.min(),l=wt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Ir(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e){this.ct=e}}function TE(t){const e=yE({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?pd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(){this.un=new CE}addToCollectionParentIndex(e,n){return this.un.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(zr.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(zr.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class CE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new _t(je.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new _t(je.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new fs(0)}static kn(){return new fs(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(){this.changes=new ws(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Rt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&po(r.mutation,i,nn.empty(),lt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,me()).next(()=>r))}getLocalViewOfDocuments(e,n,r=me()){const i=ii();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let a=Js();return s.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=ii();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,me()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,i){let s=ar();const a=fo(),l=function(){return fo()}();return n.forEach((u,h)=>{const p=r.get(h.key);i.has(h.key)&&(p===void 0||p.mutation instanceof qr)?s=s.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),po(p.mutation,h,p.mutation.getFieldMask(),lt.now())):a.set(h.key,nn.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((h,p)=>a.set(h,p)),n.forEach((h,p)=>{var g;return l.set(h,new kE(p,(g=a.get(h))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=fo();let i=new Ue((a,l)=>a-l),s=me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let p=r.get(u)||nn.empty();p=l.applyToLocalView(h,p),r.set(u,p);const g=(i.get(l.batchId)||me()).add(u);i=i.insert(l.batchId,g)})}).next(()=>{const a=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,p=u.value,g=O0();p.forEach(y=>{if(!s.has(y)){const E=W0(n.get(y),r.get(y));E!==null&&g.set(y,E),s=s.add(y)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return U.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(a){return re.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):N0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):U.resolve(ii());let l=-1,u=s;return a.next(h=>U.forEach(h,(p,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),s.get(p)?U.resolve():this.remoteDocumentCache.getEntry(e,p).next(y=>{u=u.insert(p,y)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,u,h,me())).next(p=>({batchId:l,changes:L0(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new re(n)).next(r=>{let i=Js();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let a=Js();return this.indexManager.getCollectionParents(e,s).next(l=>U.forEach(l,u=>{const h=function(g,y){return new Yo(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(p=>{p.forEach((g,y)=>{a=a.insert(g,y)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(a=>{s.forEach((u,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,Rt.newInvalidDocument(p)))});let l=Js();return a.forEach((u,h)=>{const p=s.get(u);p!==void 0&&po(p.mutation,h,nn.empty(),lt.now()),su(n,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return U.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Fn(i.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:TE(i.bundledQuery),readTime:Fn(i.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(){this.overlays=new Ue(re.comparator),this.Ir=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ii();return U.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const i=ii(),s=n.length+1,a=new re(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return U.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ue((h,p)=>h-p);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=s.get(h.largestBatchId);p===null&&(p=ii(),s=s.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=ii(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=i)););return U.resolve(l)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new eE(n,r));let s=this.Ir.get(n);s===void 0&&(s=me(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(){this.sessionToken=wt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(){this.Tr=new _t(ct.Er),this.dr=new _t(ct.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new ct(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new ct(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new re(new je([])),r=new ct(n,e),i=new ct(n,e+1),s=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new re(new je([])),r=new ct(n,e),i=new ct(n,e+1);let s=me();return this.dr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const n=new ct(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ct{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return re.comparator(e.key,n.key)||xe(e.wr,n.wr)}static Ar(e,n){return xe(e.wr,n.wr)||re.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new _t(ct.Er)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new ZS(s,n,r,i);this.mutationQueue.push(a);for(const l of i)this.br=this.br.add(new ct(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(a)}lookupMutationBatch(e,n){return U.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return U.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ct(n,0),i=new ct(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],a=>{const l=this.Dr(a.wr);s.push(l)}),U.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new _t(xe);return n.forEach(i=>{const s=new ct(i,0),a=new ct(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],l=>{r=r.add(l.wr)})}),U.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;re.isDocumentKey(s)||(s=s.child(""));const a=new ct(new re(s),0);let l=new _t(xe);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(l=l.add(u.wr)),!0)},a),U.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Te(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return U.forEach(n.mutations,i=>{const s=new ct(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new ct(n,0),i=this.br.firstAfterOrEqual(r);return U.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e){this.Mr=e,this.docs=function(){return new Ue(re.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():Rt.newInvalidDocument(n))}getEntries(e,n){let r=ar();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Rt.newInvalidDocument(i))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=ar();const a=n.path,l=new re(a.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||gS(mS(p),r)<=0||(i.has(p.key)||su(n,p))&&(s=s.insert(p.key,p.mutableCopy()))}return U.resolve(s)}getAllFromCollectionGroup(e,n,r,i){oe()}Or(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new VE(this)}getSize(e){return U.resolve(this.size)}}class VE extends AE{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(e){this.persistence=e,this.Nr=new ws(n=>Dh(n),Nh),this.lastRemoteSnapshotVersion=ce.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Fh,this.targetCount=0,this.kr=fs.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),U.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new fs(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Kn(n),U.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),U.waitFor(s).next(()=>i)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),U.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{constructor(e,n){this.qr={},this.overlays={},this.Qr=new kh(0),this.Kr=!1,this.Kr=!0,this.$r=new DE,this.referenceDelegate=e(this),this.Ur=new ME(this),this.indexManager=new IE,this.remoteDocumentCache=function(i){return new jE(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new EE(n),this.Gr=new PE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new bE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new NE(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){J("MemoryPersistence","Starting transaction:",e);const i=new OE(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return U.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class OE extends vS{constructor(e){super(),this.currentSequenceNumber=e}}class zh{constructor(e){this.persistence=e,this.Jr=new Fh,this.Yr=null}static Zr(e){return new zh(e)}get Xr(){if(this.Yr)return this.Yr;throw oe()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),U.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Xr,r=>{const i=re.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,ce.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return U.or([()=>U.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=me(),i=me();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Bh(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return U1()?8:_S(z1())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new FE;return this.Xi(e,n,a).next(l=>{if(s.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(qs()<=ye.DEBUG&&J("QueryEngine","SDK will not create cache indexes for query:",ji(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),U.resolve()):(qs()<=ye.DEBUG&&J("QueryEngine","Query:",ji(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(qs()<=ye.DEBUG&&J("QueryEngine","The SDK decides to create cache indexes for query:",ji(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,On(n))):U.resolve())}Yi(e,n){if(pm(n))return U.resolve(null);let r=On(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=pd(n,null,"F"),r=On(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=me(...s);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,l);return this.ns(n,h,a,u.readTime)?this.Yi(e,pd(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,i){return pm(n)||i.isEqual(ce.min())?U.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const a=this.ts(n,s);return this.ns(n,a,r,i)?U.resolve(null):(qs()<=ye.DEBUG&&J("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ji(n)),this.rs(e,a,n,pS(i,-1)).next(l=>l))})}ts(e,n){let r=new _t(V0(e));return n.forEach((i,s)=>{su(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return qs()<=ye.DEBUG&&J("QueryEngine","Using full collection scan to execute query:",ji(n)),this.Ji.getDocumentsMatchingQuery(e,n,zr.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new Ue(xe),this._s=new ws(s=>Dh(s),Nh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function UE(t,e,n,r){return new BE(t,e,n,r)}async function rv(t,e){const n=de(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],l=[];let u=me();for(const h of i){a.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of s){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:a,addedBatchIds:l}))})})}function $E(t,e){const n=de(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,h,p){const g=h.batch,y=g.keys();let E=U.resolve();return y.forEach(A=>{E=E.next(()=>p.getEntry(u,A)).next(P=>{const F=h.docVersions.get(A);Te(F!==null),P.version.compareTo(F)<0&&(g.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),p.addEntry(P)))})}),E.next(()=>l.mutationQueue.removeMutationBatch(u,g))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=me();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function iv(t){const e=de(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function WE(t,e){const n=de(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const l=[];e.targetChanges.forEach((p,g)=>{const y=i.get(g);if(!y)return;l.push(n.Ur.removeMatchingKeys(s,p.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(s,p.addedDocuments,g)));let E=y.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?E=E.withResumeToken(wt.EMPTY_BYTE_STRING,ce.min()).withLastLimboFreeSnapshotVersion(ce.min()):p.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(p.resumeToken,r)),i=i.insert(g,E),function(P,F,I){return P.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(y,E,p)&&l.push(n.Ur.updateTargetData(s,E))});let u=ar(),h=me();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(HE(s,a,e.documentUpdates).next(p=>{u=p.Ps,h=p.Is})),!r.isEqual(ce.min())){const p=n.Ur.getLastRemoteSnapshotVersion(s).next(g=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(p)}return U.waitFor(l).next(()=>a.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,h)).next(()=>u)}).then(s=>(n.os=i,s))}function HE(t,e,n){let r=me(),i=me();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let a=ar();return n.forEach((l,u)=>{const h=s.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(ce.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):J("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ps:a,Is:i}})}function qE(t,e){const n=de(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function GE(t,e){const n=de(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,U.resolve(i)):n.Ur.allocateTargetId(r).next(a=>(i=new Ir(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function _d(t,e,n){const r=de(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Ko(a))throw a;J("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Im(t,e,n){const r=de(t);let i=ce.min(),s=me();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,p){const g=de(u),y=g._s.get(p);return y!==void 0?U.resolve(g.os.get(y)):g.Ur.getTargetData(h,p)}(r,a,On(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(u=>{s=u})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?i:ce.min(),n?s:me())).next(l=>(QE(r,LS(e),l),{documents:l,Ts:s})))}function QE(t,e,n){let r=t.us.get(e)||ce.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class Cm{constructor(){this.activeTargetIds=$S()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class KE{constructor(){this.so=new Cm,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Cm,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){J("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){J("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ua=null;function rc(){return Ua===null?Ua=function(){return 268435456+Math.round(2147483648*Math.random())}():Ua++,"0x"+Ua.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const At="WebChannelConnection";class ZE extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,a){const l=rc(),u=this.xo(n,r.toUriEncodedString());J("RestConnection",`Sending RPC '${n}' ${l}:`,u,i);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,s,a),this.No(n,u,h,i).then(p=>(J("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw jo("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",u,"request:",i),p})}Lo(n,r,i,s,a,l){return this.Mo(n,r,i,s,a)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+xs}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>n[a]=s),i&&i.headers.forEach((s,a)=>n[a]=s)}xo(n,r){const i=XE[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=rc();return new Promise((a,l)=>{const u=new v0;u.setWithCredentials(!0),u.listenOnce(_0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case tl.NO_ERROR:const p=u.getResponseJson();J(At,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case tl.TIMEOUT:J(At,`RPC '${e}' ${s} timed out`),l(new Y(z.DEADLINE_EXCEEDED,"Request time out"));break;case tl.HTTP_ERROR:const g=u.getStatus();if(J(At,`RPC '${e}' ${s} failed with status:`,g,"response text:",u.getResponseText()),g>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const E=y==null?void 0:y.error;if(E&&E.status&&E.message){const A=function(F){const I=F.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(I)>=0?I:z.UNKNOWN}(E.status);l(new Y(A,E.message))}else l(new Y(z.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new Y(z.UNAVAILABLE,"Connection failed."));break;default:oe()}}finally{J(At,`RPC '${e}' ${s} completed.`)}});const h=JSON.stringify(i);J(At,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const i=rc(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=S0(),l=w0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const p=s.join("");J(At,`Creating RPC '${e}' stream ${i}: ${p}`,u);const g=a.createWebChannel(p,u);let y=!1,E=!1;const A=new JE({Io:F=>{E?J(At,`Not sending because RPC '${e}' stream ${i} is closed:`,F):(y||(J(At,`Opening RPC '${e}' stream ${i} transport.`),g.open(),y=!0),J(At,`RPC '${e}' stream ${i} sending:`,F),g.send(F))},To:()=>g.close()}),P=(F,I,S)=>{F.listen(I,C=>{try{S(C)}catch(V){setTimeout(()=>{throw V},0)}})};return P(g,Xs.EventType.OPEN,()=>{E||(J(At,`RPC '${e}' stream ${i} transport opened.`),A.yo())}),P(g,Xs.EventType.CLOSE,()=>{E||(E=!0,J(At,`RPC '${e}' stream ${i} transport closed`),A.So())}),P(g,Xs.EventType.ERROR,F=>{E||(E=!0,jo(At,`RPC '${e}' stream ${i} transport errored:`,F),A.So(new Y(z.UNAVAILABLE,"The operation could not be completed")))}),P(g,Xs.EventType.MESSAGE,F=>{var I;if(!E){const S=F.data[0];Te(!!S);const C=S,V=C.error||((I=C[0])===null||I===void 0?void 0:I.error);if(V){J(At,`RPC '${e}' stream ${i} received error:`,V);const L=V.status;let M=function(x){const w=Xe[x];if(w!==void 0)return G0(w)}(L),v=V.message;M===void 0&&(M=z.INTERNAL,v="Unknown error status: "+L+" with message "+V.message),E=!0,A.So(new Y(M,v)),g.close()}else J(At,`RPC '${e}' stream ${i} received:`,S),A.bo(S)}}),P(l,x0.STAT_EVENT,F=>{F.stat===ld.PROXY?J(At,`RPC '${e}' stream ${i} detected buffering proxy`):F.stat===ld.NOPROXY&&J(At,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{A.wo()},0),A}}function ic(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(t){return new uE(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&J("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,n,r,i,s,a,l,u){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new sv(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(or(n.toString()),or("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new Y(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return J("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(J("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class eT extends ov{constructor(e,n,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=hE(this.serializer,e),r=function(s){if(!("targetChange"in s))return ce.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?ce.min():a.readTime?Fn(a.readTime):ce.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=vd(this.serializer),n.addTarget=function(s,a){let l;const u=a.target;if(l=hd(u)?{documents:mE(s,u)}:{query:gE(s,u)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=Y0(s,a.resumeToken);const h=md(s,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(ce.min())>0){l.readTime=Ml(s,a.snapshotVersion.toTimestamp());const h=md(s,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=vE(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=vd(this.serializer),n.removeTarget=e,this.a_(n)}}class tT extends ov{constructor(e,n,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Te(!!e.streamToken),this.lastStreamToken=e.streamToken,Te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=pE(e.writeResults,e.commitTime),r=Fn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=vd(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>fE(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new Y(z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,gd(n,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Y(z.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,gd(n,r),i,a,l,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Y(z.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class rT{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(or(n),this.D_=!1):J("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{r.enqueueAndForget(async()=>{_i(this)&&(J("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=de(u);h.L_.add(4),await Zo(h),h.q_.set("Unknown"),h.L_.delete(4),await cu(h)}(this))})}),this.q_=new rT(r,i)}}async function cu(t){if(_i(t))for(const e of t.B_)await e(!0)}async function Zo(t){for(const e of t.B_)await e(!1)}function av(t,e){const n=de(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Hh(n)?Wh(n):Ss(n).r_()&&$h(n,e))}function Uh(t,e){const n=de(t),r=Ss(n);n.N_.delete(e),r.r_()&&lv(n,e),n.N_.size===0&&(r.r_()?r.o_():_i(n)&&n.q_.set("Unknown"))}function $h(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ce.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ss(t).A_(e)}function lv(t,e){t.Q_.xe(e),Ss(t).R_(e)}function Wh(t){t.Q_=new sE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ss(t).start(),t.q_.v_()}function Hh(t){return _i(t)&&!Ss(t).n_()&&t.N_.size>0}function _i(t){return de(t).L_.size===0}function uv(t){t.Q_=void 0}async function sT(t){t.q_.set("Online")}async function oT(t){t.N_.forEach((e,n)=>{$h(t,e)})}async function aT(t,e){uv(t),Hh(t)?(t.q_.M_(e),Wh(t)):t.q_.set("Unknown")}async function lT(t,e,n){if(t.q_.set("Online"),e instanceof K0&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,a),i.N_.delete(l),i.Q_.removeTarget(l))}(t,e)}catch(r){J("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ll(t,r)}else if(e instanceof il?t.Q_.Ke(e):e instanceof Q0?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ce.min()))try{const r=await iv(t.localStore);n.compareTo(r)>=0&&await function(s,a){const l=s.Q_.rt(a);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=s.N_.get(h);p&&s.N_.set(h,p.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,h)=>{const p=s.N_.get(u);if(!p)return;s.N_.set(u,p.withResumeToken(wt.EMPTY_BYTE_STRING,p.snapshotVersion)),lv(s,u);const g=new Ir(p.target,u,h,p.sequenceNumber);$h(s,g)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){J("RemoteStore","Failed to raise snapshot:",r),await Ll(t,r)}}async function Ll(t,e,n){if(!Ko(e))throw e;t.L_.add(1),await Zo(t),t.q_.set("Offline"),n||(n=()=>iv(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{J("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await cu(t)})}function cv(t,e){return e().catch(n=>Ll(t,n,e))}async function du(t){const e=de(t),n=Ur(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;uT(e);)try{const i=await qE(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,cT(e,i)}catch(i){await Ll(e,i)}dv(e)&&hv(e)}function uT(t){return _i(t)&&t.O_.length<10}function cT(t,e){t.O_.push(e);const n=Ur(t);n.r_()&&n.V_&&n.m_(e.mutations)}function dv(t){return _i(t)&&!Ur(t).n_()&&t.O_.length>0}function hv(t){Ur(t).start()}async function dT(t){Ur(t).p_()}async function hT(t){const e=Ur(t);for(const n of t.O_)e.m_(n.mutations)}async function fT(t,e,n){const r=t.O_.shift(),i=Mh.from(r,e,n);await cv(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await du(t)}async function pT(t,e){e&&Ur(t).V_&&await async function(r,i){if(function(a){return nE(a)&&a!==z.ABORTED}(i.code)){const s=r.O_.shift();Ur(r).s_(),await cv(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await du(r)}}(t,e),dv(t)&&hv(t)}async function km(t,e){const n=de(t);n.asyncQueue.verifyOperationInProgress(),J("RemoteStore","RemoteStore received new credentials");const r=_i(n);n.L_.add(3),await Zo(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await cu(n)}async function mT(t,e){const n=de(t);e?(n.L_.delete(2),await cu(n)):e||(n.L_.add(2),await Zo(n),n.q_.set("Unknown"))}function Ss(t){return t.K_||(t.K_=function(n,r,i){const s=de(n);return s.w_(),new eT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:sT.bind(null,t),Ro:oT.bind(null,t),mo:aT.bind(null,t),d_:lT.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Hh(t)?Wh(t):t.q_.set("Unknown")):(await t.K_.stop(),uv(t))})),t.K_}function Ur(t){return t.U_||(t.U_=function(n,r,i){const s=de(n);return s.w_(),new tT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:dT.bind(null,t),mo:pT.bind(null,t),f_:hT.bind(null,t),g_:fT.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await du(t)):(await t.U_.stop(),t.O_.length>0&&(J("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Zn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const a=Date.now()+r,l=new qh(e,n,a,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Y(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Gh(t,e){if(or("AsyncQueue",`${e}: ${t}`),Ko(t))return new Y(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e){this.comparator=e?(n,r)=>e(n,r)||re.comparator(n.key,r.key):(n,r)=>re.comparator(n.key,r.key),this.keyedMap=Js(),this.sortedSet=new Ue(this.comparator)}static emptySet(e){return new ts(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ts)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ts;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(){this.W_=new Ue(re.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):oe():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class ps{constructor(e,n,r,i,s,a,l,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,i,s){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new ps(e,n,ts.emptySet(n),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&iu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class yT{constructor(){this.queries=Pm(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=de(n),s=i.queries;i.queries=Pm(),s.forEach((a,l)=>{for(const u of l.j_)u.onError(r)})})(this,new Y(z.ABORTED,"Firestore shutting down"))}}function Pm(){return new ws(t=>j0(t),iu)}async function fv(t,e){const n=de(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new gT,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(a){const l=Gh(a,`Initialization of query '${ji(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&Qh(n)}async function pv(t,e){const n=de(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function vT(t,e){const n=de(t);let r=!1;for(const i of e){const s=i.query,a=n.queries.get(s);if(a){for(const l of a.j_)l.X_(i)&&(r=!0);a.z_=i}}r&&Qh(n)}function _T(t,e,n){const r=de(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function Qh(t){t.Y_.forEach(e=>{e.next()})}var xd,bm;(bm=xd||(xd={})).ea="default",bm.Cache="cache";class mv{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new ps(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=ps.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==xd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e){this.key=e}}class yv{constructor(e){this.key=e}}class xT{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=me(),this.mutatedKeys=me(),this.Aa=V0(e),this.Ra=new ts(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Rm,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,a=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,g)=>{const y=i.get(p),E=su(this.query,g)?g:null,A=!!y&&this.mutatedKeys.has(y.key),P=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let F=!1;y&&E?y.data.isEqual(E.data)?A!==P&&(r.track({type:3,doc:E}),F=!0):this.ga(y,E)||(r.track({type:2,doc:E}),F=!0,(u&&this.Aa(E,u)>0||h&&this.Aa(E,h)<0)&&(l=!0)):!y&&E?(r.track({type:0,doc:E}),F=!0):y&&!E&&(r.track({type:1,doc:y}),F=!0,(u||h)&&(l=!0)),F&&(E?(a=a.add(E),s=P?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:l,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((p,g)=>function(E,A){const P=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return oe()}};return P(E)-P(A)}(p.type,g.type)||this.Aa(p.doc,g.doc)),this.pa(r),i=i!=null&&i;const l=n&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,h=u!==this.Ea;return this.Ea=u,a.length!==0||h?{snapshot:new ps(this.query,e.Ra,s,a,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Rm,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=me(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new yv(r))}),this.da.forEach(r=>{e.has(r)||n.push(new gv(r))}),n}ba(e){this.Ta=e.Ts,this.da=me();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return ps.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class wT{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class ST{constructor(e){this.key=e,this.va=!1}}class ET{constructor(e,n,r,i,s,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new ws(l=>j0(l),iu),this.Ma=new Map,this.xa=new Set,this.Oa=new Ue(re.comparator),this.Na=new Map,this.La=new Fh,this.Ba={},this.ka=new Map,this.qa=fs.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function TT(t,e,n=!0){const r=Ev(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await vv(r,e,n,!0),i}async function IT(t,e){const n=Ev(t);await vv(n,e,!0,!1)}async function vv(t,e,n,r){const i=await GE(t.localStore,On(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,n);let l;return r&&(l=await CT(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&n&&av(t.remoteStore,i),l}async function CT(t,e,n,r,i){t.Ka=(g,y,E)=>async function(P,F,I,S){let C=F.view.ma(I);C.ns&&(C=await Im(P.localStore,F.query,!1).then(({documents:v})=>F.view.ma(v,C)));const V=S&&S.targetChanges.get(F.targetId),L=S&&S.targetMismatches.get(F.targetId)!=null,M=F.view.applyChanges(C,P.isPrimaryClient,V,L);return Nm(P,F.targetId,M.wa),M.snapshot}(t,g,y,E);const s=await Im(t.localStore,e,!0),a=new xT(e,s.Ts),l=a.ma(s.documents),u=Jo.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),h=a.applyChanges(l,t.isPrimaryClient,u);Nm(t,n,h.wa);const p=new wT(e,n,a);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function AT(t,e,n){const r=de(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(a=>!iu(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await _d(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Uh(r.remoteStore,i.targetId),wd(r,i.targetId)}).catch(Qo)):(wd(r,i.targetId),await _d(r.localStore,i.targetId,!0))}async function kT(t,e){const n=de(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Uh(n.remoteStore,r.targetId))}async function RT(t,e,n){const r=MT(t);try{const i=await function(a,l){const u=de(a),h=lt.now(),p=l.reduce((E,A)=>E.add(A.key),me());let g,y;return u.persistence.runTransaction("Locally write mutations","readwrite",E=>{let A=ar(),P=me();return u.cs.getEntries(E,p).next(F=>{A=F,A.forEach((I,S)=>{S.isValidDocument()||(P=P.add(I))})}).next(()=>u.localDocuments.getOverlayedDocuments(E,A)).next(F=>{g=F;const I=[];for(const S of l){const C=XS(S,g.get(S.key).overlayedDocument);C!=null&&I.push(new qr(S.key,C,C0(C.value.mapValue),An.exists(!0)))}return u.mutationQueue.addMutationBatch(E,h,I,l)}).next(F=>{y=F;const I=F.applyToLocalDocumentSet(g,P);return u.documentOverlayCache.saveOverlays(E,F.batchId,I)})}).then(()=>({batchId:y.batchId,changes:L0(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,u){let h=a.Ba[a.currentUser.toKey()];h||(h=new Ue(xe)),h=h.insert(l,u),a.Ba[a.currentUser.toKey()]=h}(r,i.batchId,n),await ea(r,i.changes),await du(r.remoteStore)}catch(i){const s=Gh(i,"Failed to persist write");n.reject(s)}}async function _v(t,e){const n=de(t);try{const r=await WE(n.localStore,e);e.targetChanges.forEach((i,s)=>{const a=n.Na.get(s);a&&(Te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?Te(a.va):i.removedDocuments.size>0&&(Te(a.va),a.va=!1))}),await ea(n,r,e)}catch(r){await Qo(r)}}function Dm(t,e,n){const r=de(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,a)=>{const l=a.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){const u=de(a);u.onlineState=l;let h=!1;u.queries.forEach((p,g)=>{for(const y of g.j_)y.Z_(l)&&(h=!0)}),h&&Qh(u)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function PT(t,e,n){const r=de(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let a=new Ue(re.comparator);a=a.insert(s,Rt.newNoDocument(s,ce.min()));const l=me().add(s),u=new lu(ce.min(),new Map,new Ue(xe),a,l);await _v(r,u),r.Oa=r.Oa.remove(s),r.Na.delete(e),Kh(r)}else await _d(r.localStore,e,!1).then(()=>wd(r,e,n)).catch(Qo)}async function bT(t,e){const n=de(t),r=e.batch.batchId;try{const i=await $E(n.localStore,e);wv(n,r,null),xv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ea(n,i)}catch(i){await Qo(i)}}async function DT(t,e,n){const r=de(t);try{const i=await function(a,l){const u=de(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,l).next(g=>(Te(g!==null),p=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(r.localStore,e);wv(r,e,n),xv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ea(r,i)}catch(i){await Qo(i)}}function xv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function wv(t,e,n){const r=de(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function wd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Sv(t,r)})}function Sv(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Uh(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Kh(t))}function Nm(t,e,n){for(const r of n)r instanceof gv?(t.La.addReference(r.key,e),NT(t,r)):r instanceof yv?(J("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Sv(t,r.key)):oe()}function NT(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(J("SyncEngine","New document in limbo: "+n),t.xa.add(r),Kh(t))}function Kh(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new re(je.fromString(e)),r=t.qa.next();t.Na.set(r,new ST(n)),t.Oa=t.Oa.insert(n,r),av(t.remoteStore,new Ir(On(jh(n.path)),r,"TargetPurposeLimboResolution",kh.oe))}}async function ea(t,e,n){const r=de(t),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{a.push(r.Ka(u,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const g=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){i.push(h);const g=Bh.Wi(u.targetId,h);s.push(g)}}))}),await Promise.all(a),r.Ca.d_(i),await async function(u,h){const p=de(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>U.forEach(h,y=>U.forEach(y.$i,E=>p.persistence.referenceDelegate.addReference(g,y.targetId,E)).next(()=>U.forEach(y.Ui,E=>p.persistence.referenceDelegate.removeReference(g,y.targetId,E)))))}catch(g){if(!Ko(g))throw g;J("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const y=g.targetId;if(!g.fromCache){const E=p.os.get(y),A=E.snapshotVersion,P=E.withLastLimboFreeSnapshotVersion(A);p.os=p.os.insert(y,P)}}}(r.localStore,s))}async function jT(t,e){const n=de(t);if(!n.currentUser.isEqual(e)){J("SyncEngine","User change. New user:",e.toKey());const r=await rv(n.localStore,e);n.currentUser=e,function(s,a){s.ka.forEach(l=>{l.forEach(u=>{u.reject(new Y(z.CANCELLED,a))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ea(n,r.hs)}}function VT(t,e){const n=de(t),r=n.Na.get(e);if(r&&r.va)return me().add(r.key);{let i=me();const s=n.Ma.get(e);if(!s)return i;for(const a of s){const l=n.Fa.get(a);i=i.unionWith(l.view.Va)}return i}}function Ev(t){const e=de(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=_v.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=VT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=PT.bind(null,e),e.Ca.d_=vT.bind(null,e.eventManager),e.Ca.$a=_T.bind(null,e.eventManager),e}function MT(t){const e=de(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=bT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DT.bind(null,e),e}class Ol{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=uu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return UE(this.persistence,new zE,e.initialUser,this.serializer)}Ga(e){return new LE(zh.Zr,this.serializer)}Wa(e){return new KE}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ol.provider={build:()=>new Ol};class Sd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Dm(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=jT.bind(null,this.syncEngine),await mT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new yT}()}createDatastore(e){const n=uu(e.databaseInfo.databaseId),r=function(s){return new ZE(s)}(e.databaseInfo);return function(s,a,l,u){return new nT(s,a,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,a,l){return new iT(r,i,s,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Dm(this.syncEngine,n,0),function(){return Am.D()?new Am:new YE}())}createSyncEngine(e,n){return function(i,s,a,l,u,h,p){const g=new ET(i,s,a,l,u,h);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=de(i);J("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Zo(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Sd.provider={build:()=>new Sd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):or("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Ft.UNAUTHENTICATED,this.clientId=E0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async a=>{J("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(J("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Gh(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function sc(t,e){t.asyncQueue.verifyOperationInProgress(),J("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await rv(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function jm(t,e){t.asyncQueue.verifyOperationInProgress();const n=await OT(t);J("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>km(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>km(e.remoteStore,i)),t._onlineComponents=e}async function OT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){J("FirestoreClient","Using user provided OfflineComponentProvider");try{await sc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===z.FAILED_PRECONDITION||i.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;jo("Error using user provided cache. Falling back to memory cache: "+n),await sc(t,new Ol)}}else J("FirestoreClient","Using default OfflineComponentProvider"),await sc(t,new Ol);return t._offlineComponents}async function Iv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(J("FirestoreClient","Using user provided OnlineComponentProvider"),await jm(t,t._uninitializedComponentsProvider._online)):(J("FirestoreClient","Using default OnlineComponentProvider"),await jm(t,new Sd))),t._onlineComponents}function FT(t){return Iv(t).then(e=>e.syncEngine)}async function Cv(t){const e=await Iv(t),n=e.eventManager;return n.onListen=TT.bind(null,e.syncEngine),n.onUnlisten=AT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=IT.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=kT.bind(null,e.syncEngine),n}function zT(t,e,n={}){const r=new Zn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,l,u,h){const p=new Tv({next:y=>{p.Za(),a.enqueueAndForget(()=>pv(s,g));const E=y.docs.has(l);!E&&y.fromCache?h.reject(new Y(z.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&y.fromCache&&u&&u.source==="server"?h.reject(new Y(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(y)},error:y=>h.reject(y)}),g=new mv(jh(l.path),p,{includeMetadataChanges:!0,_a:!0});return fv(s,g)}(await Cv(t),t.asyncQueue,e,n,r)),r.promise}function BT(t,e,n={}){const r=new Zn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,l,u,h){const p=new Tv({next:y=>{p.Za(),a.enqueueAndForget(()=>pv(s,g)),y.fromCache&&u.source==="server"?h.reject(new Y(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(y)},error:y=>h.reject(y)}),g=new mv(l,p,{includeMetadataChanges:!0,_a:!0});return fv(s,g)}(await Cv(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Av(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(t,e,n){if(!n)throw new Y(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function UT(t,e,n,r){if(e===!0&&r===!0)throw new Y(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Mm(t){if(!re.isDocumentKey(t))throw new Y(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Lm(t){if(re.isDocumentKey(t))throw new Y(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function hu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":oe()}function lr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Y(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=hu(t);throw new Y(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Y(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Y(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}UT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Av((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Y(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Y(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Y(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Yh{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Om({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Y(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Y(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Om(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new oS;switch(r.type){case"firstParty":return new uS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Y(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Vm.get(n);r&&(J("ComponentProvider","Removing Datastore"),Vm.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Es(this.firestore,e,this._query)}}class Vt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vt(this.firestore,e,this._key)}}class Lr extends Es{constructor(e,n,r){super(e,n,jh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vt(this.firestore,null,new re(e))}withConverter(e){return new Lr(this.firestore,e,this._path)}}function Uo(t,e,...n){if(t=Rn(t),kv("collection","path",e),t instanceof Yh){const r=je.fromString(e,...n);return Lm(r),new Lr(t,null,r)}{if(!(t instanceof Vt||t instanceof Lr))throw new Y(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return Lm(r),new Lr(t.firestore,null,r)}}function Pt(t,e,...n){if(t=Rn(t),arguments.length===1&&(e=E0.newId()),kv("doc","path",e),t instanceof Yh){const r=je.fromString(e,...n);return Mm(r),new Vt(t,null,new re(r))}{if(!(t instanceof Vt||t instanceof Lr))throw new Y(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return Mm(r),new Vt(t.firestore,t instanceof Lr?t.converter:null,new re(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new sv(this,"async_queue_retry"),this.Vu=()=>{const r=ic();r&&J("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=ic();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=ic();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Zn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ko(e))throw e;J("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw or("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=qh.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&oe()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Ts extends Yh{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Fm,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Fm(e),this._firestoreClient=void 0,await e}}}function $T(t,e,n){n||(n="(default)");const r=f0(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),s=r.getOptions(n);if(Pl(s,e))return i;throw new Y(z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Y(z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Y(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function Xh(t){if(t._terminated)throw new Y(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||WT(t),t._firestoreClient}function WT(t){var e,n,r;const i=t._freezeSettings(),s=function(l,u,h,p){return new SS(l,u,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Av(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new LT(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ms(wt.fromBase64String(e))}catch(n){throw new Y(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ms(wt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Y(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Y(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Y(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT=/^__.*__$/;class qT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new qr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Xo(e,this.data,n,this.fieldTransforms)}}class Rv{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new qr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Pv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw oe()}}class ef{constructor(e,n,r,i,s,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new ef(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Fl(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Pv(this.Cu)&&HT.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class GT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||uu(e)}Qu(e,n,r,i=!1){return new ef({Cu:e,methodName:n,qu:r,path:yt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mu(t){const e=t._freezeSettings(),n=uu(t._databaseId);return new GT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bv(t,e,n,r,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);nf("Data must be an object, but it was:",a,r);const l=Dv(r,a);let u,h;if(s.merge)u=new nn(a.fieldMask),h=a.fieldTransforms;else if(s.mergeFields){const p=[];for(const g of s.mergeFields){const y=Ed(e,g,n);if(!a.contains(y))throw new Y(z.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);jv(p,y)||p.push(y)}u=new nn(p),h=a.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=a.fieldTransforms;return new qT(new Bt(l),u,h)}class gu extends pu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gu}}class tf extends pu{_toFieldTransform(e){return new GS(e.path,new Fo)}isEqual(e){return e instanceof tf}}function QT(t,e,n,r){const i=t.Qu(1,e,n);nf("Data must be an object, but it was:",i,r);const s=[],a=Bt.empty();vi(r,(u,h)=>{const p=rf(e,u,n);h=Rn(h);const g=i.Nu(p);if(h instanceof gu)s.push(p);else{const y=ta(h,g);y!=null&&(s.push(p),a.set(p,y))}});const l=new nn(s);return new Rv(a,l,i.fieldTransforms)}function KT(t,e,n,r,i,s){const a=t.Qu(1,e,n),l=[Ed(e,r,n)],u=[i];if(s.length%2!=0)throw new Y(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<s.length;y+=2)l.push(Ed(e,s[y])),u.push(s[y+1]);const h=[],p=Bt.empty();for(let y=l.length-1;y>=0;--y)if(!jv(h,l[y])){const E=l[y];let A=u[y];A=Rn(A);const P=a.Nu(E);if(A instanceof gu)h.push(E);else{const F=ta(A,P);F!=null&&(h.push(E),p.set(E,F))}}const g=new nn(h);return new Rv(p,g,a.fieldTransforms)}function YT(t,e,n,r=!1){return ta(n,t.Qu(r?4:3,e))}function ta(t,e){if(Nv(t=Rn(t)))return nf("Unsupported field value:",e,t),Dv(t,e);if(t instanceof pu)return function(r,i){if(!Pv(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const l of r){let u=ta(l,i.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),a++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Rn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return WS(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=lt.fromDate(r);return{timestampValue:Ml(i.serializer,s)}}if(r instanceof lt){const s=new lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ml(i.serializer,s)}}if(r instanceof Jh)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ms)return{bytesValue:Y0(i.serializer,r._byteString)};if(r instanceof Vt){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Oh(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Zh)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return Vh(l.serializer,u)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${hu(r)}`)}(t,e)}function Dv(t,e){const n={};return T0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):vi(t,(r,i)=>{const s=ta(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function Nv(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof lt||t instanceof Jh||t instanceof ms||t instanceof Vt||t instanceof pu||t instanceof Zh)}function nf(t,e,n){if(!Nv(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=hu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Ed(t,e,n){if((e=Rn(e))instanceof fu)return e._internalPath;if(typeof e=="string")return rf(t,e);throw Fl("Field path arguments must be of type string or ",t,!1,void 0,n)}const XT=new RegExp("[~\\*/\\[\\]]");function rf(t,e,n){if(e.search(XT)>=0)throw Fl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new fu(...e.split("."))._internalPath}catch{throw Fl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Fl(t,e,n,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||a)&&(u+=" (found",s&&(u+=` in field ${r}`),a&&(u+=` in document ${i}`),u+=")"),new Y(z.INVALID_ARGUMENT,l+t+u)}function jv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Vt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(sf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class JT extends Vv{data(){return super.data()}}function sf(t,e){return typeof e=="string"?rf(t,e):e instanceof fu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Y(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class of{}class eI extends of{}function tI(t,e,...n){let r=[];e instanceof of&&r.push(e),r=r.concat(n),function(s){const a=s.filter(u=>u instanceof af).length,l=s.filter(u=>u instanceof yu).length;if(a>1||a>0&&l>0)throw new Y(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class yu extends eI{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new yu(e,n,r)}_apply(e){const n=this._parse(e);return Mv(e._query,n),new Es(e.firestore,e.converter,fd(e._query,n))}_parse(e){const n=mu(e.firestore);return function(s,a,l,u,h,p,g){let y;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new Y(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Um(g,p);const E=[];for(const A of g)E.push(Bm(u,s,A));y={arrayValue:{values:E}}}else y=Bm(u,s,g)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Um(g,p),y=YT(l,a,g,p==="in"||p==="not-in");return tt.create(h,p,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function zm(t,e,n){const r=e,i=sf("where",t);return yu._create(i,r,n)}class af extends of{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new af(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Pn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let a=i;const l=s.getFlattenedFilters();for(const u of l)Mv(a,u),a=fd(a,u)}(e._query,n),new Es(e.firestore,e.converter,fd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Bm(t,e,n){if(typeof(n=Rn(n))=="string"){if(n==="")throw new Y(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!N0(e)&&n.indexOf("/")!==-1)throw new Y(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(je.fromString(n));if(!re.isDocumentKey(r))throw new Y(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return lm(t,new re(r))}if(n instanceof Vt)return lm(t,n._key);throw new Y(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hu(n)}.`)}function Um(t,e){if(!Array.isArray(t)||t.length===0)throw new Y(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Mv(t,e){const n=function(i,s){for(const a of i)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Y(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Y(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class nI{convertValue(e,n="none"){switch(mi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ke(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(pi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw oe()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return vi(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>Ke(a.doubleValue));return new Zh(s)}convertGeoPoint(e){return new Jh(Ke(e.latitude),Ke(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Ph(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Mo(e));default:return null}}convertTimestamp(e){const n=Br(e);return new lt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=je.fromString(e);Te(nv(r));const i=new Lo(r.get(1),r.get(3)),s=new re(r.popFirst(5));return i.isEqual(n)||or(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ov extends Vv{constructor(e,n,r,i,s,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new sl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(sf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class sl extends Ov{data(e={}){return super.data(e)}}class rI{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new eo(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new sl(this._firestore,this._userDataWriter,r.key,r,new eo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Y(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{const u=new sl(i._firestore,i._userDataWriter,l.doc.key,l.doc,new eo(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const u=new sl(i._firestore,i._userDataWriter,l.doc.key,l.doc,new eo(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,p=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:iI(l.type),doc:u,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function iI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return oe()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lf(t){t=lr(t,Vt);const e=lr(t.firestore,Ts);return zT(Xh(e),t._key).then(n=>sI(e,t,n))}class Fv extends nI{constructor(e){super(),this.firestore=e}convertBytes(e){return new ms(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Vt(this.firestore,null,n)}}function Td(t){t=lr(t,Es);const e=lr(t.firestore,Ts),n=Xh(e),r=new Fv(e);return ZT(t._query),BT(n,t._query).then(i=>new rI(e,r,t,i))}function Id(t,e,n){t=lr(t,Vt);const r=lr(t.firestore,Ts),i=Lv(t.converter,e,n);return uf(r,[bv(mu(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,An.none())])}function Kn(t,e,n,...r){t=lr(t,Vt);const i=lr(t.firestore,Ts),s=mu(i);let a;return a=typeof(e=Rn(e))=="string"||e instanceof fu?KT(s,"updateDoc",t._key,e,n,r):QT(s,"updateDoc",t._key,e),uf(i,[a.toMutation(t._key,An.exists(!0))])}function zv(t,e){const n=lr(t.firestore,Ts),r=Pt(t),i=Lv(t.converter,e);return uf(n,[bv(mu(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,An.exists(!1))]).then(()=>r)}function uf(t,e){return function(r,i){const s=new Zn;return r.asyncQueue.enqueueAndForget(async()=>RT(await FT(r),i,s)),s.promise}(Xh(t),e)}function sI(t,e,n){const r=n.docs.get(e._key),i=new Fv(t);return new Ov(t,i,e._key,r,new eo(n.hasPendingWrites,n.fromCache),e.converter)}function Tn(){return new tf("serverTimestamp")}(function(e,n=!0){(function(i){xs=i})(qw),Do(new us("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),l=new Ts(new aS(r.getProvider("auth-internal")),new dS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Y(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lo(h.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:n},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),Mr(rm,"4.7.3",e),Mr(rm,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd="us-central1";class aI{constructor(e,n,r,i,s=Cd,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new oI(n,r,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(s);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Cd}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function lI(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const $m="@firebase/functions",Wm="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI="auth-internal",cI="app-check-internal",dI="messaging-internal";function hI(t,e){const n=(r,{instanceIdentifier:i})=>{const s=r.getProvider("app").getImmediate(),a=r.getProvider(uI),l=r.getProvider(dI),u=r.getProvider(cI);return new aI(s,a,l,u,i,t)};Do(new us(Bv,n,"PUBLIC").setMultipleInstances(!0)),Mr($m,Wm,e),Mr($m,Wm,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(t=Gw(),e=Cd){const r=f0(Rn(t),Bv).getImmediate({identifier:e}),i=O1("functions");return i&&pI(r,...i),r}function pI(t,e,n){lI(Rn(t),e,n)}hI(fetch.bind(self));const mI={apiKey:'"AIzaSyDRdl4zhwoZumVtphmJ19orZ8HoR0WQQZM",',authDomain:'"qualtrics-game-backend.firebaseapp.com",',projectId:'"qualtrics-game-backend",',storageBucket:'"qualtrics-game-backend.firebasestorage.app",',messagingSenderId:'"441267092549",',appId:"1:441267092549:web:6ce075f5f3ea7cf958772c"},Uv=p0(mI),Ze=$T(Uv,{experimentalForceLongPolling:!1,useFetchStreams:!1});fI(Uv);const Je={init(){localStorage.getItem("sessionId")||(localStorage.setItem("sessionId",this.generateSessionId()),localStorage.setItem("sessionStartTime",Date.now().toString())),localStorage.getItem("semesterStartTime")||localStorage.setItem("semesterStartTime",Date.now().toString())},generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},async logEvent(t,e){const n=localStorage.getItem("sessionId")||this.generateSessionId(),r=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),i=Date.now(),s=i-r,a=(s/1e3).toFixed(1),l=Math.floor(s/6e4),u=Math.floor(s%6e4/1e3),h=`${l}:${u.toString().padStart(2,"0")}`,p=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),g=this.getFullGameContext(),y={sessionId:n,studentId:p.studentId||null,type:t,timestamp:new Date().toISOString(),clientTimestamp:i,timeElapsedSeconds:parseFloat(a),readableTime:h,semesterTime:this.getSemesterTime(),...g,isAdminMode:p.role==="admin",hasCheckpoint:p.checkpointSemester2||!1,hasAI:p.hasAI||!1,section:p.section||null,...this.convertTimesToSeconds(e)};(t==="user_action"||t==="task_attempt")&&console.log(`DEBUG: Event ${t} - studentId: ${y.studentId}, role: ${p.role}`);try{await zv(Uo(Ze,"events"),y)}catch(E){console.error("Failed to log event:",E),this.storeOfflineEvent(y)}},convertTimesToSeconds(t){const e={...t},n=["timeTaken","timeSpent","totalTime","timeOnPreviousPage","averageTime","timeBetweenHelpAndSubmit"];for(const r of n)e[r]!==void 0&&e[r]!==null&&(e[`${r}Seconds`]=(e[r]/1e3).toFixed(1),delete e[r]);return e.timeProgression&&(e.timeProgressionSeconds=e.timeProgression.map(r=>(r/1e3).toFixed(1)),delete e.timeProgression),e.timePerAttempt&&(e.timePerAttemptSeconds=e.timePerAttempt.map(r=>(r/1e3).toFixed(1)),delete e.timePerAttempt),e},getSemesterTime(){const t=parseInt(localStorage.getItem("semesterStartTime")||Date.now()),e=Date.now()-t,n=(e/1e3).toFixed(1),r=Math.floor(e/6e4),i=Math.floor(e%6e4/1e3);return{elapsedSeconds:parseFloat(n),readable:`${r}:${i.toString().padStart(2,"0")}`,minutes:r,seconds:i}},getCurrentContext(){const t=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),e=((Date.now()-t)/1e3).toFixed(1);return{currentTask:localStorage.getItem("currentTask"),gameMode:localStorage.getItem("gameMode"),totalCompleted:this.getCompletedTaskCount(),currentStreak:this.getCurrentStreak(),sessionDurationSeconds:parseFloat(e)}},getFullGameContext(){const t=localStorage.getItem("currentTask")||"",e=localStorage.getItem("gameMode")||"",n=parseInt(localStorage.getItem("currentSemester")||"1"),r=parseInt(localStorage.getItem("totalSemesters")||"2"),i=localStorage.getItem("practiceCompleted")==="true",s=parseInt(localStorage.getItem("completedTasksCount")||"0"),a=parseInt(localStorage.getItem("completedLevels")||"0"),l=parseInt(localStorage.getItem("totalSwitches")||"0"),u=parseInt(localStorage.getItem("aiUsageCount")||"0"),h=JSON.parse(localStorage.getItem("categoryPoints")||"{}"),p=parseFloat(localStorage.getItem("studentLearningScore")||"0");return{currentTask:t,gameMode:e,currentSemester:n,totalSemesters:r,practiceCompleted:i,completedTasks:s,completedLevels:a,totalSwitches:l,aiUsageCount:u,studentLearning:p,totalBonus:h.bonus||0,finalScore:Math.round(p)+(h.bonus||0),semester:n}},calculateImprovementTrend(t){if(!t||t.length<3)return"needs_more_data";const n=t.slice(-5).map(i=>i.accuracy),r=this.calculateTrend(n);return r>5?"rapid_improvement":r>2?"steady_improvement":r>0?"slight_improvement":r>-2?"stable":r>-5?"slight_decline":"rapid_decline"},calculateImprovementRate(t){if(!t||t.length<2)return{overall:0,trend:0,isImproving:!1,dataPoints:t?t.length:0};const e=t[0].accuracy,r=t[t.length-1].accuracy-e;if(t.length<3)return{overall:r,trend:r,isImproving:r>0,dataPoints:t.length};const i=Math.floor(t.length/2),s=t.slice(0,i).reduce((u,h)=>u+h.accuracy,0)/i,l=t.slice(i).reduce((u,h)=>u+h.accuracy,0)/(t.length-i)-s;return{overall:r,trend:l,isImproving:l>0,dataPoints:t.length}},setPageStartTime(t){t&&localStorage.setItem(`pageStartTime_${t}`,Date.now().toString())},getTimeOnCurrentPage(t){if(!t)return 0;const e=localStorage.getItem(`pageStartTime_${t}`);return e?Date.now()-parseInt(e):0},ensureSession(){localStorage.getItem("sessionId")||this.init()},async trackAIHelpResponse(t,e,n,r,i,s){const a=parseInt(localStorage.getItem("aiUsageCount")||"0");return localStorage.setItem("aiUsageCount",(a+1).toString()),this.logEvent("ai_help_response",{taskId:t,helpType:e,suggestion:n,playerAction:r,playerValue:i,timeBetween:s})},async trackTaskAttempt(t,e){return this.logEvent("task_attempt",{taskId:t,...e})},async trackUserAction(t,e){return this.logEvent("user_action",{action:t,response:e.response||"",query:e.query||"",queryType:e.queryType||"",choice:e.choice||"",currentMode:e.currentMode||"",...e})},async syncOfflineEvents(){return console.log("Syncing offline events..."),Promise.resolve()},async trackTaskComplete(t,e){return this.logEvent("task_complete",{taskId:t,...e})},async trackPageSwitch(t,e,n){return this.logEvent("page_switch",{from:t,to:e,isAutoAdvance:n})},trackAITaskHelp(t,e,n,r,i){return this.logEvent("ai_task_help",{taskId:t,taskType:e,suggestion:n,wasCorrect:r,attemptNumber:i})}};Je.init();const er={seedRandom:null,currentSeed:null,initializeSeed(t){this.currentSeed=t;let e=t;this.seedRandom=function(){return e=(e*9301+49297)%233280,e/233280}},getRandom(){return this.seedRandom?this.seedRandom():Math.random()},generateCountingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n;e==="easy"?n=(t-1)%5+1:e==="medium"?n=(t-11)%5+6:n=(t-25)%5+11;const i={easy:{1:{target:"the",type:"word"},2:{target:"and",type:"word"},3:{target:"of",type:"word"},4:{target:"to",type:"word"},5:{target:"in",type:"word"}},medium:{6:{target:"e",type:"letter"},7:{target:"a",type:"letter"},8:{target:"i",type:"letter"},9:{target:"o",type:"letter"},10:{target:"s",type:"letter"}},hard:{11:{targets:["a","e"],type:"multi-letter"},12:{targets:["i","o"],type:"multi-letter"},13:{targets:["s","t"],type:"multi-letter"},14:{targets:["n","r"],type:"multi-letter"},15:{targets:["l","d"],type:"multi-letter"}}}[e][n];let s="";return i.type==="word"?s=`Count how many times the word "${i.target}" appears:`:i.type==="letter"?s=`Count how many times the letter "${i.target}" appears (case-insensitive):`:s=`Count how many times the letters "${i.targets[0]}" and "${i.targets[1]}" appear in total:`,{...i,instruction:s,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},generateSliderPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n,r,i;return e==="easy"?(n=Math.floor(this.getRandom()*11),r=1,i=!0):e==="medium"?(n=Math.round(this.getRandom()*10*10)/10,r=.1,i=!0):(n=Math.round(this.getRandom()*10*100)/100,r=.01,i=(t-25)%5!==0),{target:n,step:r,showValue:i,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1),precision:e==="easy"?0:e==="medium"?1:2}},generateTypingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard",n={easy:["hello world","quick test","type this","easy mode","simple text","good job","keep going","nice work","almost done","level up"],medium:["HeLLo WoRLd","QuIcK tEsT","TyPe ThIs","MeDiUm MoDe","MiXeD cAsE","KeEp GoInG","NiCe WoRk","AlMoSt DoNe","LeVeL uP","ChAlLeNgE","TeSt RuN","NeXt LeVeL","TrY aGaIn","GoOd LuCk","FiNaL tEsT"],hard:["Test@123","Go4It!Now","X9%Y8&Z7*","P6!Q5?R4+","Z1@Y2#X3$","M7&N8*O9!","J4%K5^L6&","D1!E2@F3#","A7$B8%C9^","V3*W4+X5=","Q2#R3$S4%","H5^I6&J7*","K8(L9)M0!","N1@O2#P3$","T4%U5^V6&","W7*X8(Y9)","C0!D1@E2#","F3$G4%H5^","I6&J7*K8(","L9)M0!N1@","O2#P3$Q4%","R5^S6&T7*","U8(V9)W0!","X1@Y2#Z3$","A4%B5^C6&"]};let r;if(e==="easy"){const i=(t-1)%n.easy.length;r=n.easy[i]}else if(e==="medium"){const i=(t-11)%n.medium.length;r=n.medium[i]}else{const i=(t-25)%n.hard.length;r=n.hard[i]}return{pattern:r,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},textPassages:["The University of California, Berkeley (UC Berkeley, Berkeley, Cal, or California) is a public land-grant research university in Berkeley, California, United States. Founded in 1868 and named after the Anglo-Irish philosopher George Berkeley, it is the state's first land-grant university and is the founding campus of the University of California system.","Berkeley has an enrollment of more than 45,000 students. The university is organized around fifteen schools of study on the same campus, including the College of Chemistry, the College of Engineering, College of Letters and Science, and the Haas School of Business.",'The Berkeley campus encompasses approximately 1,232 acres, though the "central campus" occupies only the low-lying western 178 acres. The campus contains numerous wooded areas, including the Eucalyptus Grove and Strawberry Creek, which runs through the center of campus.',"Oski the Bear (Oski) is the official mascot of the University of California, Berkeley, representing the California Golden Bears. Named after the Oski Yell, he made his debut at a freshman rally in the Greek Theatre on September 25, 1941.","Berkeley faculty, alumni, and researchers have won 111 Nobel laureates, 25 Turing Award winners, and 19 Academy Award winners. The university has produced many notable alumni in various fields including science, politics, business, and entertainment.","The university's athletic teams compete as the California Golden Bears and are members of the Atlantic Coast Conference for most sports. Berkeley teams have won 107 national championships, including 45 NCAA national championships.","Research at Berkeley is conducted within departments, organized research units, and interdisciplinary research centers. Berkeley operates Lawrence Berkeley National Laboratory, manages Los Alamos National Laboratory, and is a founding partner of the Space Sciences Laboratory.","The Berkeley campus offers over 350 degree programs through its 14 colleges and schools. Popular majors include Computer Science, Economics, Political Science, and Business Administration. The student-faculty ratio is 17:1.","Berkeley's libraries contain more than 13 million volumes and maintain special collections including the Mark Twain Papers, the Oral History Center, and the Bancroft Library, which houses the largest collection of materials on California history.","The campus is home to several museums including the Berkeley Art Museum and Pacific Film Archive, the Lawrence Hall of Science, and the UC Botanical Garden. These facilities serve both educational and public outreach purposes.","Notable Berkeley inventions and discoveries include the cyclotron, the atomic bomb, the flu vaccine, and vitamin E. Berkeley researchers discovered 16 chemical elements of the periodic table, more than any other university.","The Free Speech Movement, which took place during the 1964-65 academic year, was a pivotal moment in the history of civil liberties in the United States. It began when students protested a ban on political activities on campus.","Berkeley's Campanile, known as Sather Tower, is the third-tallest clock tower in the world at 307 feet. It was completed in 1914 and is visible for miles, serving as a symbol of the university.","The university operates on a semester system, with fall semester beginning in late August and spring semester beginning in mid-January. Berkeley offers over 5,000 courses each semester across all disciplines.",`Cal Bears have won at least one team national title in 13 different sports. The university's traditional rival is Stanford University, with the annual football game known as "The Big Game" dating back to 1892.`],getTextPassage(t){if(this.seedRandom){const e=Math.floor(this.getRandom()*this.textPassages.length),n=(t-1+e)%this.textPassages.length;return this.textPassages[n]}else{const e=(t-1)%this.textPassages.length;return this.textPassages[e]}}};function Ad({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[i,s]=D.useState(""),[a,l]=D.useState(""),[u,h]=D.useState(null),[p,g]=D.useState(""),[y,E]=D.useState(null),[A,P]=D.useState(""),[F,I]=D.useState(""),[S]=D.useState(Date.now()),[C,V]=D.useState(""),[L,M]=D.useState(!1),[v,m]=D.useState(new Set),x=D.useRef(0);D.useRef(null);const w=(ne,ie=null,$=null)=>{const N=document.createElement("canvas"),O=N.getContext("2d");N.width=900,N.height=400,O.fillStyle="#fafafa",O.fillRect(0,0,N.width,N.height),O.strokeStyle="#e0e0e0",O.lineWidth=2,O.strokeRect(0,0,N.width,N.height),O.font="24px monospace",O.fillStyle="#333";const G=36,Z=25,ee=N.width-Z*2;return((we,fe)=>{const he=we.split(" "),Le=[];let Se="";for(let te of he){const Ce=Se+(Se?" ":"")+te;O.measureText(Ce).width>fe&&Se?(Le.push(Se),Se=te):Se=Ce}return Se&&Le.push(Se),Le})(ne,ee).forEach((we,fe)=>{const he=Z+(fe+1)*G;let Le=Z;if(t<=5){const Se=we.split(" ");let te=0;Se.forEach(Ce=>{const Oe=$&&$.has(te),Re=ie&&ie.some(St=>Ce.toLowerCase()===St.toLowerCase());if(Oe){const St=O.measureText(Ce).width;O.fillStyle="yellow",O.fillRect(Le-2,he-18,St+4,24)}else if(Re){const St=O.measureText(Ce).width;O.fillStyle="rgba(255, 215, 0, 0.4)",O.fillRect(Le-2,he-18,St+4,24)}O.fillStyle="#333",O.fillText(Ce,Le,he),Le+=O.measureText(Ce+" ").width,te++})}else for(let Se=0;Se<we.length;Se++){const te=we[Se],Ce=O.measureText(te).width;ie&&ie.some(Re=>te.toLowerCase()===Re.toLowerCase())&&(O.fillStyle="rgba(255, 215, 0, 0.4)",O.fillRect(Le-1,he-18,Ce+2,24)),O.fillStyle="#333",O.fillText(te,Le,he),Le+=Ce}}),N.toDataURL()};D.useEffect(()=>{g(0),E(null),x.current=0},[t]),D.useEffect(()=>{const ne=async($,N)=>{const O=document.createElement("canvas"),G=O.getContext("2d");O.width=900,O.height=350,G.fillStyle="#fafafa",G.fillRect(0,0,O.width,O.height),G.strokeStyle="#e0e0e0",G.lineWidth=2,G.strokeRect(0,0,O.width,O.height),G.font="24px monospace";const Z=36,ee=20,ae=O.width-ee*2,we=((fe,he)=>{const Le=fe.split(" "),Se=[];let te="";for(let Ce of Le){const Oe=te+(te?" ":"")+Ce;G.measureText(Oe).width>he&&te?(Se.push(te),te=Ce):te=Oe}return te&&Se.push(te),Se})(A,ae);for(let fe=0;fe<$.length;fe++)$[fe],we.forEach((he,Le)=>{const Se=ee+(Le+1)*Z;let te=ee;for(let Ce=0;Ce<he.length;Ce++){const Oe=he[Ce],Re=G.measureText(Oe).width;$.some(qt=>Oe.toLowerCase()===qt.toLowerCase())&&(G.fillStyle="rgba(255, 255, 0, 0.6)",G.fillRect(te-1,Se-20,Re+2,26)),G.fillStyle="#333",G.fillText(Oe,te,Se),te+=Re}}),V(O.toDataURL()),await new Promise(he=>setTimeout(he,300));setTimeout(()=>{g(N.toString())},300)},ie=async $=>{const{action:N,highlightWords:O,suggestedCount:G,animate:Z,isMultiLetter:ee,targetLetters:ae}=$.detail||{};if(N==="highlightAndCount"){if(ee&&Array.isArray(ae)){Z&&await ne(ae,G);return}if(Array.isArray(O)&&Z){A.split(" ");let ke=[];for(let we=0;we<O.length;we++){ke.push(O[we]);const fe=document.createElement("canvas"),he=fe.getContext("2d");fe.width=900,fe.height=350,he.fillStyle="#fafafa",he.fillRect(0,0,fe.width,fe.height),he.strokeStyle="#e0e0e0",he.lineWidth=2,he.strokeRect(0,0,fe.width,fe.height),he.font="24px monospace";const Le=36,Se=20,te=fe.width-Se*2;((Re,St)=>{const qt=Re.split(" "),Gt=[];let Qt="";for(let Kt of qt){const cr=Qt+(Qt?" ":"")+Kt;he.measureText(cr).width>St&&Qt?(Gt.push(Qt),Qt=Kt):Qt=cr}return Qt&&Gt.push(Qt),Gt})(A,te).forEach((Re,St)=>{const qt=Se+(St+1)*Le;let Gt=Se;Re.split(" ").forEach(Kt=>{const cr=he.measureText(Kt).width;ke.some(bn=>{const hr=Kt.replace(/[.,;!?]/g,"").toLowerCase(),Pe=bn.replace(/[.,;!?]/g,"").toLowerCase();return hr===Pe})&&(he.fillStyle="rgba(255, 255, 0, 0.5)",he.fillRect(Gt-2,qt-18,cr+4,24)),he.fillStyle="#333",he.fillText(Kt,Gt,qt),Gt+=he.measureText(Kt+" ").width})}),V(fe.toDataURL()),await new Promise(Re=>setTimeout(Re,200))}setTimeout(()=>{g(G.toString())},300)}}};return window.addEventListener("aiCountingHelp",ie),()=>window.removeEventListener("aiCountingHelp",ie)},[A,t]),D.useEffect(()=>{var O;const ne=er.generateCountingPattern(t),ie=er.getTextPassage(t);P(ie),s(ne.target||((O=ne.targets)==null?void 0:O.join(", "))),l(ne.instruction);let $=0;if(ne.type==="word"){const G=new RegExp(`\\b${ne.target}\\b`,"gi"),Z=ie.match(G);$=Z?Z.length:0}else if(ne.type==="letter"){const G=new RegExp(ne.target,"gi"),Z=ie.match(G);$=Z?Z.length:0}else ne.type==="multi-letter"&&ne.targets.forEach(G=>{const Z=new RegExp(G,"gi"),ee=ie.match(Z);$+=ee?ee.length:0});h($);const N=w(ie,null);V(N)},[t]);const k=async()=>{const ne=Date.now()-S,ie=parseInt(p,10)||0,$=u??0,N=Math.abs(ie-$),O=`g1t${t}`,G=localStorage.getItem(`lastAIHelp_${O}`);if(G){const ae=JSON.parse(G),ke=Date.now()-ae.timestamp,we=ie===ae.suggestion?"accepted":"modified";await Je.trackAIHelpResponse(O,ae.type,ae.suggestion,we,ie,ke),localStorage.removeItem(`lastAIHelp_${O}`)}let Z=0;N===0?Z=2:N<=1?Z=1:Z=0,x.current+=1,await Je.trackTaskAttempt(O,x.current,!0,ne,ie,$);const ee=localStorage.getItem("sessionId");if(ee&&!ee.startsWith("offline-"))try{await Kn(Pt(Ze,"sessions",ee),{[`taskAccuracies.g1t${t}`]:Z===2?100:Z===1?70:0,[`taskTimes.g1t${t}`]:ne,[`taskPoints.g1t${t}`]:Z,lastActivity:Tn()})}catch(ae){console.error("Error storing accuracy:",ae)}E(Z===2?" Perfect! 2 points earned!":Z===1?` Off by ${N} - 1 point earned!`:` Off by ${N} - 0 points earned.`),setTimeout(()=>{e==null||e(`g1t${t}`,{attempts:x.current,totalTime:ne,accuracy:Z===2?100:Z===1?70:0,userAnswer:ie,correctAnswer:$,points:Z})},500)},T=er.generateCountingPattern(t).difficultyLabel,se=t<=5?"easy":t<=10?"medium":"hard";return d.jsxs("div",{className:"task counting",children:[d.jsxs("h3",{children:["Research Content - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${se}`,children:T}),d.jsxs("p",{className:"instruction",children:[d.jsx("strong",{children:a}),d.jsx("br",{}),d.jsx("span",{className:"hint",children:"(Case-insensitive)"})]}),d.jsxs("div",{className:"text-display text-to-count","data-counting-text":A,children:[d.jsx("div",{className:"count-target","data-pattern":i,style:{display:"none"},children:i}),C?d.jsx("img",{src:C,alt:"Text passage for counting",style:{width:"100%",maxWidth:"900px",height:"auto",maxHeight:"350px",objectFit:"contain",border:"none",userSelect:"none",pointerEvents:"none"},onContextMenu:ne=>ne.preventDefault(),draggable:!1}):d.jsx("div",{dangerouslySetInnerHTML:{__html:F}})]}),d.jsxs("div",{className:"input-section",children:[d.jsx("label",{children:"Your answer:"}),d.jsx("input",{type:"number",min:"0",max:"999",value:p,onChange:ne=>g(ne.target.value),onKeyPress:ne=>{ne.key==="Enter"&&k()},placeholder:"Enter count"})]}),d.jsx("button",{onClick:k,className:"submit-btn",style:{display:"block",margin:"20px auto 0"},children:"Submit"}),y&&d.jsx("div",{className:`feedback ${y.includes("2 points")?"correct":y.includes("0 points")?"incorrect":"partial"}`,children:y})]})}function kd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[i,s]=D.useState(5),[a,l]=D.useState(0),[u,h]=D.useState(null),[p]=D.useState(Date.now()),[g,y]=D.useState(1),[E,A]=D.useState(!0),[P,F]=D.useState(!1),[I,S]=D.useState(!1),[C,V]=D.useState(!1),[L,M]=D.useState(!1),v=D.useRef(null),m=D.useRef(0);D.useEffect(()=>{if(n)s(3),y(1),A(!0);else{const $=er.generateSliderPattern(t);s($.target),y($.step),A($.showValue)}l(0),h(null),m.current=0},[t,n]),D.useEffect(()=>{const $=N=>{const{action:O,value:G,animate:Z}=N.detail;if(O==="moveSlider")if(S(!0),Z){const ee=parseFloat(a),ae=parseFloat(G),ke=1e3,we=30;let fe=0;const he=setInterval(()=>{fe++;const Le=fe/we,Se=1-Math.pow(1-Le,3),te=ee+(ae-ee)*Se;l(parseFloat(te.toFixed(2))),fe>=we&&(clearInterval(he),S(!1),l(parseFloat(ae.toFixed(2))))},ke/we)}else l(parseFloat(G.toFixed(2))),S(!1)};return window.addEventListener("aiSliderHelp",$),()=>window.removeEventListener("aiSliderHelp",$)},[a]),D.useEffect(()=>{const $=N=>{N.key==="Enter"&&!I&&R()};return document.addEventListener("keypress",$),()=>document.removeEventListener("keypress",$)},[I,a,i]);const x=$=>{if(I)return;const N=v.current;if(!N)return;$.preventDefault();const O=N.getBoundingClientRect(),G=a/10,Z=O.left+O.width*G,ee=$.clientX||$.touches&&$.touches[0].clientX;Math.abs(ee-Z)<30&&(V(!0),M(!0))},w=$=>{if(!C||I)return;const N=v.current;if(!N)return;const O=N.getBoundingClientRect(),G=$.clientX||$.touches&&$.touches[0].clientX,ee=Math.max(0,Math.min(1,(G-O.left)/O.width))*10,ae=Math.round(ee/g)*g;l(parseFloat(ae.toFixed(2)))},k=()=>{V(!1)};D.useEffect(()=>{if(C){const $=O=>w(O),N=()=>k();return document.addEventListener("mousemove",$),document.addEventListener("mouseup",N),document.addEventListener("touchmove",$),document.addEventListener("touchend",N),()=>{document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",N),document.removeEventListener("touchmove",$),document.removeEventListener("touchend",N)}}},[C,g,I]);const R=async()=>{const $=Date.now()-p,N=parseFloat(a),O=Math.abs(N-i),G=`g2t${t}`,Z=localStorage.getItem(`lastAIHelp_${G}`);if(Z){const ke=JSON.parse(Z),we=Date.now()-ke.timestamp,fe=N===ke.suggestion?"accepted":"modified";await Je.trackAIHelpResponse(G,ke.type,ke.suggestion,fe,N,we),localStorage.removeItem(`lastAIHelp_${G}`)}let ee=0;O===0?ee=2:O<=1?ee=1:ee=0,m.current+=1,await Je.trackTaskAttempt(G,m.current,!0,$,N,i);const ae=localStorage.getItem("sessionId");if(ae&&!ae.startsWith("offline-"))try{await Kn(Pt(Ze,"sessions",ae),{[`taskDifferences.g2t${t}`]:O,[`taskTimes.g2t${t}`]:$,[`taskPoints.g2t${t}`]:ee,lastActivity:Tn()})}catch(ke){console.error("Error storing difference:",ke)}h(ee===2?" Perfect! 2 points earned!":ee===1?` Off by ${O.toFixed(2)} - 1 point earned!`:` Off by ${O.toFixed(2)} - 0 points earned.`),setTimeout(()=>{e(`g2t${t}`,{attempts:m.current,totalTime:$,accuracy:ee===2?100:ee===1?70:0,userAnswer:N,correctAnswer:i,points:ee})},500)},T=er.generateSliderPattern(t),se=T.difficultyLabel,ne=T.difficulty,ie=()=>{const $=[];for(let N=0;N<=10;N++)$.push(d.jsxs("div",{style:{position:"absolute",left:`${N*10}%`,transform:"translateX(-50%)",textAlign:"center"},children:[d.jsx("div",{style:{width:"2px",height:"12px",background:"#666",margin:"0 auto"}}),d.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:N})]},N));return $};return d.jsxs("div",{className:`task slider ${I?"ai-controlled":""}`,children:[d.jsxs("h3",{children:["Material Creation - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${ne}`,children:se}),d.jsxs("p",{className:"instruction",children:["Move the slider to:"," ",d.jsx("strong",{className:"target-value","data-target-value":i,children:i}),d.jsx("br",{}),d.jsx("span",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:!L&&"Hold and drag the slider handle to move it"})]}),d.jsxs("div",{className:"slider-container",children:[d.jsxs("div",{className:"range-labels",children:[d.jsx("span",{children:"0"}),d.jsx("span",{children:"10"})]}),d.jsxs("div",{style:{position:"relative",padding:"20px 0 30px 0"},children:[d.jsx("div",{style:{position:"absolute",width:"100%",height:"20px",top:"0"},children:ie()}),d.jsx("div",{style:{position:"relative",marginTop:"20px"},children:d.jsx("input",{ref:v,type:"range",min:"0",max:"10",step:g,value:a,onChange:$=>{!C&&!I&&(l(parseFloat($.target.value)),M(!0))},className:"slider-input",style:{width:"100%",cursor:C?"grabbing":"grab"},onMouseDown:x,onTouchStart:x})})]}),d.jsx("div",{className:"current-value",children:E?parseFloat(a).toFixed(n?0:T.precision):"??"})]}),d.jsx("button",{onClick:R,className:"submit-btn",disabled:I,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function Rd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[i,s]=D.useState(""),[a,l]=D.useState(""),[u,h]=D.useState(null),[p]=D.useState(Date.now()),[g,y]=D.useState(""),[E,A]=D.useState(!1),P=D.useRef(0),F=L=>{const M=document.createElement("canvas"),v=M.getContext("2d");return M.width=600,M.height=150,v.fillStyle="#f5f5f5",v.fillRect(0,0,M.width,M.height),v.font='bold 40px "Courier New", monospace',v.fillStyle="#333",v.textAlign="center",v.textBaseline="middle",v.fillText(L,M.width/2,M.height/2),M.toDataURL()};D.useEffect(()=>{const M=er.generateTypingPattern(t).pattern;s(M);const v=F(M);y(v)},[t]),D.useEffect(()=>{l(""),h(null),P.current=0},[t]),D.useEffect(()=>{const L=M=>{const{action:v,text:m,typeSpeed:x}=M.detail;if(v==="autoType"&&m){A(!0),l("");let w="",k=0;const R=setInterval(()=>{k<m.length?(w+=m[k],l(w),k++):(clearInterval(R),A(!1))},x||50);return()=>clearInterval(R)}};return window.addEventListener("aiTypingHelp",L),()=>window.removeEventListener("aiTypingHelp",L)},[]);const I=async()=>{const L=Date.now()-p,M=`g3t${t}`,v=localStorage.getItem(`lastAIHelp_${M}`);if(v){const R=JSON.parse(v),T=Date.now()-R.timestamp,se=a===R.suggestion?"accepted":"modified";await Je.trackAIHelpResponse(M,R.type,R.suggestion,se,a,T),localStorage.removeItem(`lastAIHelp_${M}`)}const x=((R,T)=>{const se=R.length,ne=T.length,ie=Array(se+1).fill(null).map(()=>Array(ne+1).fill(0));for(let $=0;$<=se;$++)ie[$][0]=$;for(let $=0;$<=ne;$++)ie[0][$]=$;for(let $=1;$<=se;$++)for(let N=1;N<=ne;N++)R[$-1]===T[N-1]?ie[$][N]=ie[$-1][N-1]:ie[$][N]=Math.min(ie[$-1][N]+1,ie[$][N-1]+1,ie[$-1][N-1]+1);return ie[se][ne]})(a,i);let w=0;x===0?w=2:x===1?w=1:w=0,P.current+=1,await Je.trackTaskAttempt(M,P.current,!0,L,a,i);const k=localStorage.getItem("sessionId");if(k&&!k.startsWith("offline-"))try{await Kn(Pt(Ze,"sessions",k),{[`taskAccuracies.g3t${t}`]:w===2?100:w===1?70:0,[`taskTimes.g3t${t}`]:L,[`taskPoints.g3t${t}`]:w,lastActivity:Tn()})}catch(R){console.error("Error storing accuracy:",R)}h(w===2?" Perfect! 2 points earned!":w===1?" 1 typo - 1 point earned!":` ${x} errors - 0 points earned.`),setTimeout(()=>{e(`g3t${t}`,{attempts:P.current,totalTime:L,accuracy:w===2?100:w===1?70:0,userAnswer:a,correctAnswer:i,points:w})},500)},S=er.generateTypingPattern(t),C=S.difficultyLabel,V=S.difficulty;return d.jsxs("div",{className:"task typing",style:{maxWidth:"100%"},children:[d.jsxs("h3",{children:["Student Engagement - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${V}`,children:C}),d.jsx("p",{className:"instruction",children:"Type this pattern exactly:"}),d.jsxs("div",{className:"pattern-display",children:[d.jsx("div",{className:"typing-pattern","data-typing-pattern":i,style:{display:"none"},children:i}),g?d.jsx("img",{src:g,alt:"Pattern to type",style:{width:"100%",maxWidth:"600px",height:"auto",userSelect:"none",pointerEvents:"none"},onContextMenu:L=>L.preventDefault(),draggable:!1}):d.jsx("span",{className:"pattern-text",children:i})]}),d.jsx("div",{className:"input-section",style:{width:"90%",maxWidth:"900px",margin:"20px auto 0"},children:d.jsx("input",{type:"text",inputMode:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:a,onChange:L=>!E&&l(L.target.value),onKeyPress:L=>{L.key==="Enter"&&!E&&(L.preventDefault(),I())},placeholder:"Type here...",className:"typing-input",disabled:E,style:{backgroundColor:E?"#e3f2fd":"white",transition:"background-color 0.3s",width:"100%",maxWidth:"100%",fontFamily:'"Courier New", monospace',fontSize:"28px",padding:"12px 14px",border:"2px solid #e0e0e0",borderRadius:"8px",boxSizing:"border-box"}})}),d.jsx("button",{onClick:I,className:"submit-btn",disabled:E,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function gI({practiceCompleted:t={},onPracticeComplete:e,onStartMainGame:n,onSelectPractice:r,isAdmin:i=!1}){const[s,a]=D.useState(null),l=(y,E)=>{if(E&&E.points===2){typeof e=="function"&&e(y,E);const A=document.createElement("div");A.className="notification-enter",A.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",A.textContent="Perfect! Practice task completed. Returning to menu...",document.body.appendChild(A),setTimeout(()=>{a(null),document.body.contains(A)&&document.body.removeChild(A)},1500)}else{const A=(E==null?void 0:E.points)||0,P=document.createElement("div");P.className="notification-enter",P.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #ff9800; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",P.textContent=`Practice requires 100% accuracy. You scored ${A===1?"50%":"0%"}. Try again!`,document.body.appendChild(P),setTimeout(()=>{document.body.contains(P)&&document.body.removeChild(P)},3e3)}},u=t.g2t1&&t.g1t1&&t.g3t1,h=()=>d.jsxs("div",{className:"practice-menu",children:[d.jsxs("h2",{children:["Practice Mode ",!i&&"(Required)"]}),!i&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",borderRadius:"12px",padding:"16px",marginBottom:"25px",border:"2px solid #f57c00",boxShadow:"0 4px 6px rgba(245, 124, 0, 0.1)",textAlign:"center"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:""}),d.jsx("strong",{style:{color:"#e65100",fontSize:"18px"},children:"100% PERFECT ACCURACY REQUIRED"})]}),d.jsxs("div",{style:{color:"#e65100",fontSize:"14px"},children:["You must score 2/2 points (exact answer) on all three practice tasks to proceed.",d.jsx("br",{}),d.jsx("strong",{children:"No partial credit in practice mode!"})]}),d.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"12px"},children:[d.jsxs("span",{style:{padding:"4px 12px",background:t.g2t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g2t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g2t1?"#4CAF50":"#ffb74d"}`},children:["Materials ",t.g2t1?"":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g1t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g1t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g1t1?"#4CAF50":"#ffb74d"}`},children:["Research ",t.g1t1?"":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g3t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g3t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g3t1?"#4CAF50":"#ffb74d"}`},children:["Engagement ",t.g3t1?"":"Required"]})]})]}),d.jsx("p",{className:"practice-hint",style:{textAlign:"center",fontSize:"16px",color:"#666",marginBottom:"30px"},children:"Try each task type before starting the main challenge. No time pressure!"}),d.jsxs("div",{className:"practice-cards",children:[d.jsxs("div",{className:"practice-card materials",children:[d.jsx("h3",{children:" Materials"}),d.jsx("p",{children:"Hold and drag slider to match target values"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Base points - directly added to score"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g2t1"),r&&r("g2t1")},className:t.g2t1?"completed":"",disabled:!1,children:t.g2t1?" Completed":"Try Materials"})})]}),d.jsxs("div",{className:"practice-card research",children:[d.jsx("h3",{children:" Research"}),d.jsx("p",{children:"Count words or letters in text passages"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 15% multiplier per point in main game"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g1t1"),r&&r("g1t1")},className:t.g1t1?"completed":"",disabled:!1,children:t.g1t1?" Completed":"Try Research"})})]}),d.jsxs("div",{className:"practice-card engagement",children:[d.jsx("h3",{children:" Engagement"}),d.jsx("p",{children:"Type patterns exactly as shown"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 0.15% compound interest per point"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g3t1"),r&&r("g3t1")},className:t.g3t1?"completed":"",disabled:!1,children:t.g3t1?" Completed":"Try Engagement"})})]})]}),d.jsxs("div",{style:{marginTop:"25px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h4",{style:{margin:"0 0 10px 0",color:"#333",fontSize:"16px"},children:"Practice Progress:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[d.jsxs("div",{style:{padding:"8px 15px",background:t.g2t1?"#4CAF50":"#e0e0e0",color:t.g2t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Materials ",t.g2t1&&""]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g1t1?"#9C27B0":"#e0e0e0",color:t.g1t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Research ",t.g1t1&&""]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g3t1?"#f44336":"#e0e0e0",color:t.g3t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Engagement ",t.g3t1&&""]})]}),d.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#666"},children:[d.jsx("strong",{children:"100% accuracy required"})," to complete each practice task"]})]}),d.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:d.jsx("button",{className:"start-main-game-btn",onClick:n,style:{opacity:!i&&!u?.5:1,cursor:!i&&!u?"not-allowed":"pointer"},disabled:!i&&!u,children:i?"Start Main Game (Admin)":u?"Start Main Game - You're Ready! ":"Complete Practice First"})})]});if(!s)return h();const p=s[1],g=1;return d.jsxs("div",{className:"practice-container",children:[d.jsx("button",{className:"back-to-menu",onClick:()=>a(null),children:" Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),d.jsxs("div",{className:"practice-task-wrapper",children:[p==="1"&&d.jsx(Ad,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:s}),p==="2"&&d.jsx(kd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:s}),p==="3"&&d.jsx(Rd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:s})]})]})}class yI{constructor(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={}}getUniversalAttemptNumber(){return this.totalAIUsage}shouldAIBeCorrect(e){let n;return e===1||e===2||e===4||e===5?n=!0:e===3?n=!1:n=Math.random()<.75,n}getTaskUsageCount(e){return this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]}incrementTaskUsage(e,n){this.totalAIUsage++,this.usageCount[n]++,this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]++}resetForNewSemester(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={},console.log(" AI Help usage reset for new semester")}helpWithSlider(e,n){this.incrementTaskUsage(n,"materials");const r=this.getUniversalAttemptNumber();let i;if(this.shouldAIBeCorrect(r))i=e;else if(r===3){const s=Math.random()<.5?-1:1;i=Math.max(0,Math.min(10,e+s))}else if(Math.random()<.5){const s=Math.random()<.5?-1:1;i=Math.max(0,Math.min(10,e+s))}else{const s=(Math.random()<.5?-1:1)*(2+Math.random()*2);i=Math.max(0,Math.min(10,e+s))}return{action:"moveSlider",value:i,animate:!0}}helpWithCounting(e,n,r){this.incrementTaskUsage(r,"research");const i=this.getUniversalAttemptNumber(),s=this.shouldAIBeCorrect(i);return n.length===1||n.includes(" and ")||n.includes(",")?this.helpWithLetterCounting(e,n,i,s):this.helpWithWordCounting(e,n,i,s)}helpWithLetterCounting(e,n,r,i){let s=[];n.includes(" and ")||n.includes(",")?s=n.match(/[a-z]/gi)||[]:s=[n];let a=0;s.forEach(h=>{const p=new RegExp(h,"gi"),g=e.match(p);a+=g?g.length:0});let l=a,u=[...s];if(!i){r===3||Math.random()<.5?l=a+1:l=a+Math.floor(Math.random()*3)+2,l=Math.max(0,l);const p="abcdefghijklmnopqrstuvwxyz".split("").filter(y=>!s.includes(y.toLowerCase())),g=Math.floor(Math.random()*2)+1;for(let y=0;y<g&&p.length>0;y++){const E=Math.floor(Math.random()*p.length);u.push(p[E]),p.splice(E,1)}}return{action:"highlightAndCount",highlightWords:[],suggestedCount:l,animate:!0,isMultiLetter:!0,targetLetters:u}}helpWithWordCounting(e,n,r,i){const s=e.split(/\s+/),a=[];let l=0,u=0;if(s.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&u++}),i)s.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&(a.push(h),l++)});else if(r===3){l=u+1,l=Math.max(0,l),s.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=s.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());if(h.length>0&&a.length<l){const p=h[Math.floor(Math.random()*h.length)];a.push(p)}}else{Math.random()<.5?l=u+1:l=u+Math.floor(Math.random()*3)+2,l=Math.max(0,l),s.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=s.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());for(;a.length<l&&h.length>0;){const p=Math.floor(Math.random()*h.length),g=h[p];a.includes(g)||a.push(g),h.splice(p,1)}}return{action:"highlightAndCount",highlightWords:a,suggestedCount:l,animate:!0}}helpWithTyping(e,n){this.incrementTaskUsage(n,"engagement");const r=this.getUniversalAttemptNumber();let i=e;const s={0:["o","O"],o:["0"],O:["0"],1:["l","I","i"],l:["1","I","i"],I:["1","l","i"],i:["1","l","I"],e:["3"],3:["e"],a:["@"],"@":["a"],s:["5","$"],S:["5","$"],5:["s","S"],$:["s","S"],g:["9"],9:["g"],b:["6"],6:["b"],z:["2"],2:["z"],B:["8"],8:["B"]},a=l=>{const u=l.split(""),h=u.map((p,g)=>s[p]?g:-1).filter(p=>p!==-1);if(h.length>0){const p=h[Math.floor(Math.random()*h.length)],g=u[p],y=s[g];y&&y.length>0&&(u[p]=y[Math.floor(Math.random()*y.length)])}else{const p=["transpose","duplicate","missing"],g=p[Math.floor(Math.random()*p.length)],y=Math.floor(Math.random()*u.length);switch(g){case"transpose":y<u.length-1&&([u[y],u[y+1]]=[u[y+1],u[y]]);break;case"duplicate":u.splice(y,0,u[y]);break;case"missing":u.splice(y,1);break}}return u.join("")};if(this.shouldAIBeCorrect(r))i=e;else if(r===3)i=a(e);else if(Math.random()<.5)i=a(e);else{let l=e;const u=Math.floor(Math.random()*3)+2;for(let h=0;h<u;h++)l=a(l);i=l}return{action:"autoType",text:i,typeSpeed:50,perfect:this.shouldAIBeCorrect(r)}}}const Pd=new yI;function vI({bonusPrompts:t=0,currentTask:e="",categoryPoints:n=null,timeRemaining:r=null,calculateStudentLearning:i=()=>0,aiCost:s=0,onAiCost:a}){const[l,u]=D.useState(!0),[h,p]=D.useState(0),[g,y]=D.useState(!1);D.useEffect(()=>{const L=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");u(L.hasAI!==!1)},[]),D.useEffect(()=>{if(e){const L=Pd.getTaskUsageCount(e)>=1;y(L)}},[e]),D.useEffect(()=>{const L=()=>{p(Pd.totalAIUsage)},M=setInterval(L,1e3);return L(),()=>clearInterval(M)},[]);const[E,A]=D.useState([{sender:"bot",text:l?"Hello! I'm your AI teaching assistant. You get ONE AI help attempt per task - use it wisely!":"Hello! This is the chat interface. AI assistance is not available for this session."}]),[P,F]=D.useState(""),[I,S]=D.useState(!1),[C,V]=D.useState({materials:0,research:0,engagement:0});D.useRef(null)}const zl={generateCode(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`${t}-${e}`.toUpperCase()},async createCode(t={}){return{success:!0,code:this.generateCode(),data:t}},async markCodeAsUsed(t,e){if(!t)return{success:!1,error:"No code provided"};try{const n={code:t,status:"used",usedAt:Tn(),sessionId:e,createdAt:Tn()};return await Id(Pt(Ze,"accessCodes",t),n),{success:!0}}catch(n){return console.error("Error marking code as used:",n),{success:!1,error:n.message}}},async checkCodeUsage(t){if(!t)return{used:!1};try{const e=await lf(Pt(Ze,"accessCodes",t));if(e.exists()){const n=e.data();return{used:n.status==="used",sessionId:n.sessionId,usedAt:n.usedAt}}return{used:!1}}catch(e){return console.error("Error checking code usage:",e),{used:!1,error:e.message}}},getCodeFromURL(){const t=new URLSearchParams(window.location.search);return t.get("code")||t.get("c")||null},async verifyQualtricsCode(t){return{valid:!1,reason:"Qualtrics codes not yet supported"}}};function _I({onLoginSuccess:t}){const[e,n]=D.useState(""),[r,i]=D.useState(!1),[s,a]=D.useState(""),[l,u]=D.useState(!1),h={MASTER:{section:"ADMIN-MASTER",role:"master_admin",name:"Master Administrator",hasAI:!1,isMasterInterface:!0},ADMIN:{role:"admin",semesterDuration:72e4,name:"Admin User",hasAI:!0,checkpointSemester2:!0}},p=E=>({section:"TESTING-AI-CP",hasAI:!0,checkpointSemester2:!0,displayName:`${E} (Internal Tester - AI + Checkpoint)`}),g=E=>{if(h[E])return{valid:!0,type:"master",data:h[E]};const A=E.trim().replace(/[^a-zA-Z0-9\s\-_]/g,"");return A.length<2?{valid:!1,error:"Please enter a name with at least 2 characters"}:A.length>50?{valid:!1,error:"Name too long. Please use 50 characters or less"}:{valid:!0,type:"tester",condition:p(A),cleanName:A}},y=async E=>{if(E.preventDefault(),!e.trim()){a("Please enter your name");return}i(!0),a("");try{const A=g(e.trim());if(!A.valid){a(A.error||"Invalid Student ID"),i(!1);return}let P={timestamp:new Date().toISOString()};if(A.type==="master"){if(P={...P,studentIdentifier:e,role:A.data.role,semesterDuration:A.data.semesterDuration,displayName:A.data.name,section:A.data.isTestCode?"ADMIN-TEST":"ADMIN",hasAI:A.data.hasAI,checkpointSemester2:A.data.checkpointSemester2,isMasterCode:!0,isTestCode:A.data.isTestCode||!1,isMasterInterface:A.data.isMasterInterface||!1},A.data.isMasterInterface){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",displayName:A.data.name,section:"master_admin",hasAI:!0,checkpointSemester2:!0})),window.location.href=`${window.location.origin}?master=true`;return}}else if(A.type==="tester"){const I=A.condition,S=A.cleanName;P={...P,studentIdentifier:S,role:"tester",semesterDuration:72e4,displayName:I.displayName,section:I.section,hasAI:I.hasAI,checkpointSemester2:I.checkpointSemester2,isMasterCode:!1,isTestUser:!0}}const F=await zl.createCode(P);F.success?(sessionStorage.setItem("gameConfig",JSON.stringify({semesterDuration:P.semesterDuration,role:P.role,studentId:P.studentIdentifier,displayName:P.displayName,section:P.section,hasAI:P.hasAI,checkpointSemester2:P.checkpointSemester2})),window.location.href=`${window.location.origin}?code=${F.code}`):a("Failed to generate access code. Please try again.")}catch(A){console.error("Login error:",A),a("System error. Please try again.")}finally{i(!1)}};return d.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",padding:"20px"},children:[d.jsxs("div",{style:{background:"white",padding:"48px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",maxWidth:"480px",width:"100%"},children:[d.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[d.jsxs("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a202c",marginBottom:"8px",lineHeight:"1.2"},children:["Scheduling Challenge:",d.jsx("br",{}),"Can you beat Park?"]}),d.jsx("p",{style:{fontSize:"16px",color:"#718096",marginTop:"12px"},children:"Enter your name to access the game"})]}),d.jsxs("form",{onSubmit:y,children:[d.jsxs("div",{style:{marginBottom:"24px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#2d3748",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.025em"},children:"Your Name:"}),d.jsx("input",{type:"text",value:e,onChange:E=>n(E.target.value),disabled:r,style:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e2e8f0",borderRadius:"8px",boxSizing:"border-box",fontFamily:"'SF Mono', Monaco, 'Courier New', monospace",transition:"all 0.2s ease",background:"#f7fafc",outline:"none"},onFocus:E=>{E.target.style.borderColor="#2196F3",E.target.style.background="white",E.target.style.boxShadow="0 0 0 3px rgba(33, 150, 243, 0.1)"},onBlur:E=>{E.target.style.borderColor="#e2e8f0",E.target.style.background="#f7fafc",E.target.style.boxShadow="none"}}),d.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"#a0aec0",lineHeight:"1.4"},children:"Enter your first and last name (2-50 characters)"})]}),s&&d.jsxs("div",{style:{background:"#fed7d7",color:"#c53030",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",fontSize:"14px",display:"flex",alignItems:"center",border:"1px solid #fc8181"},children:[d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",style:{marginRight:"8px",flexShrink:0},children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),s]}),d.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:"600",background:r?"#cbd5e0":"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:r?"none":"0 4px 6px rgba(33, 150, 243, 0.25)",transform:r?"none":"translateY(0)"},onMouseDown:E=>{r||(E.target.style.transform="translateY(2px)",E.target.style.boxShadow="0 2px 4px rgba(33, 150, 243, 0.25)")},onMouseUp:E=>{r||(E.target.style.transform="translateY(0)",E.target.style.boxShadow="0 4px 6px rgba(33, 150, 243, 0.25)")},onMouseOver:E=>{r||(E.target.style.background="#1976D2")},onMouseOut:E=>{r||(E.target.style.background="#2196F3")},children:r?d.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[d.jsxs("svg",{className:"animate-spin",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px",animation:"spin 1s linear infinite"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",strokeOpacity:"0.25"}),d.jsx("path",{d:"M4 12a8 8 0 018-8",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),"Verifying Name..."]}):"Access Game"})]}),d.jsxs("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[d.jsx("p",{style:{fontSize:"14px",color:"#718096",marginBottom:"12px"},children:"Having trouble? Contact your instructor:"}),d.jsxs("p",{style:{fontSize:"16px",color:"#2196F3",fontWeight:"500"},children:["Park Sinchaisri",d.jsx("br",{}),d.jsx("a",{href:"mailto:parksinchaisri@haas.berkeley.edu",style:{color:"#2196F3",textDecoration:"none",borderBottom:"1px solid #2196F3",fontSize:"15px"},children:"parksinchaisri@haas.berkeley.edu"})]}),l&&d.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#f7fafc",borderRadius:"8px",fontSize:"11px",color:"#4a5568",lineHeight:"1.8"},children:[d.jsx("strong",{children:"Test Codes:"}),d.jsxs("div",{style:{marginTop:"8px",fontFamily:"monospace"},children:[d.jsx("div",{children:"ADMIN (Standard Game Mode)"}),d.jsx("div",{children:"MASTER (Master interface)"})]})]})]})]}),d.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const Hm={async checkDailyLimit(t){var r;if(!t)return{allowed:!0};const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);try{const i=Uo(Ze,"sessions"),s=tI(i,zm("studentId","==",t),zm("startTime",">=",n)),a=await Td(s);if(!a.empty){const l=a.docs[0].data(),u=(r=l.startTime)!=null&&r.toDate?l.startTime.toDate():new Date(l.clientStartTime);return{allowed:!1,reason:"daily_limit",existingSession:l,nextAvailable:new Date(n.getTime()+24*60*60*1e3)}}return{allowed:!0}}catch(i){console.error("Error checking daily limit:",i);const s=`played_${t}_${n.toISOString().split("T")[0]}`;return localStorage.getItem(s)?{allowed:!1,reason:"daily_limit",nextAvailable:new Date(n.getTime()+24*60*60*1e3)}:{allowed:!0}}},async markDailyPlay(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=`played_${t}_${n.toISOString().split("T")[0]}`;localStorage.setItem(r,"true");const i=new Date(Date.now()-7*24*60*60*1e3);for(let s=0;s<localStorage.length;s++){const a=localStorage.key(s);if(a&&a.startsWith("played_")){const l=a.split("_")[2];l&&new Date(l)<i&&localStorage.removeItem(a)}}},async checkAccess(){try{const t=zl.getCodeFromURL();if(!t)return{allowed:!1,reason:"Please login with your student ID",requiresCode:!0};const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),n=e.role==="admin"||e.role==="master_admin";if(!n&&e.studentId){const r=await this.checkDailyLimit(e.studentId);if(!r.allowed&&!r.refreshGranted){const s=r.nextAvailable;return{allowed:!1,reason:`You have already completed today's session. Please come back in ${Math.ceil((s-Date.now())/(1e3*60*60))} hours (after midnight).`,dailyLimitReached:!0,nextAvailable:s}}if(sessionStorage.getItem("activeSessionId"))return{allowed:!1,reason:"Page refresh is not allowed during the game. Your session has been terminated.",refreshAttempt:!0}}return e.studentId?(n||await this.markDailyPlay(e.studentId),{allowed:!0,newSession:!0,code:t,codeData:{status:"new",metadata:e},isAdmin:n}):{allowed:!1,reason:"Please login with your Berkeley student ID",requiresCode:!0}}catch(t){console.error("Error in checkAccess:",t);const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");return e.role==="admin"?{allowed:!0,newSession:!0,code:zl.getCodeFromURL(),codeData:{status:"error_bypass",metadata:e},isAdmin:!0}:{allowed:!1,reason:"System error. Please try again.",requiresCode:!0}}},async createSession(t=null,e=null,n=!1){try{const r=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),i=r.role==="admin"||r.role==="master_admin",s={id:crypto.randomUUID(),accessCode:t,studentId:r.studentId||null,role:r.role||"student",semesterDuration:r.semesterDuration||72e4,displayName:r.displayName||"Student",startTime:Tn(),clientStartTime:new Date().toISOString(),status:"active",completedTasks:{},isPractice:n,isAdminSession:i,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`,section:r.section,hasAI:r.hasAI,checkpointSemester2:r.checkpointSemester2},l=(await zv(Uo(Ze,"sessions"),s)).id;return localStorage.setItem("sessionId",l),sessionStorage.setItem("activeSessionId",l),i||(window.addEventListener("beforeunload",u=>{u.preventDefault(),u.returnValue="Your progress will be lost if you leave this page.",this.handleSessionAbandonment()}),document.addEventListener("visibilitychange",()=>{!i&&document.hidden})),l}catch(r){console.error("Error creating session:",r);const i=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(i.role==="admin"){const s="offline-"+Date.now();localStorage.setItem("sessionId",s),sessionStorage.setItem("activeSessionId",s);const a={id:s,accessCode:t,startTime:Date.now(),status:"active",isOffline:!0,studentId:i.studentId||null,role:i.role||"admin"};return localStorage.setItem("offlineSession",JSON.stringify(a)),s}throw r}},async handleSessionAbandonment(){const t=localStorage.getItem("sessionId");if(t&&!t.startsWith("offline-"))try{await Kn(Pt(Ze,"sessions",t),{status:"abandoned",abandonedAt:Tn(),abandonReason:"page_unload"})}catch(e){console.error("Error marking session as abandoned:",e)}sessionStorage.removeItem("activeSessionId"),sessionStorage.removeItem("gameConfig")}};function xI(){const[t,e]=D.useState(""),[n,r]=D.useState(!1),[i,s]=D.useState(""),[a,l]=D.useState(!1),u=async()=>{r(!0),s(""),l(!1);try{const p=await zl.createCode({createdBy:"admin",timestamp:new Date().toISOString()});p.success?e(p.code):s("Failed to generate code: "+p.error)}catch(p){s("Error: "+p.message)}finally{r(!1)}},h=()=>{const p=`${window.location.origin}?code=${t}`;navigator.clipboard.writeText(p),l(!0),setTimeout(()=>l(!1),2e3)};return d.jsxs("div",{style:{padding:"40px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, -apple-system, sans-serif"},children:[d.jsx("h1",{style:{color:"#333",marginBottom:"10px"},children:"Admin Dashboard"}),d.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:"Generate access codes for participants"}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("button",{onClick:u,disabled:n,style:{padding:"12px 30px",fontSize:"16px",background:n?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:"bold"},children:n?"Generating...":"Generate New Access Code"}),t&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"white",borderRadius:"6px",border:"1px solid #e0e0e0"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Generated Code"}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Access Code:"}),d.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"18px",fontWeight:"bold"},children:t})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Full URL:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"stretch"},children:[d.jsx("input",{type:"text",value:`${window.location.origin}?code=${t}`,readOnly:!0,style:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",background:"#f9f9f9"}}),d.jsx("button",{onClick:h,style:{padding:"10px 20px",background:a?"#4CAF50":"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:a?" Copied!":"Copy URL"})]})]}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"4px",fontSize:"14px",color:"#1976d2"},children:[d.jsx("strong",{children:"Note:"})," This code is valid for 24 hours and can only be used once."]})]}),i&&d.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"#ffebee",color:"#c62828",borderRadius:"4px"},children:i})]}),d.jsxs("div",{style:{marginTop:"40px",padding:"20px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"How to use:"}),d.jsxs("ol",{style:{margin:"10px 0",paddingLeft:"20px"},children:[d.jsx("li",{children:"Generate a code using the button above"}),d.jsx("li",{children:"Copy the full URL"}),d.jsx("li",{children:"Share the URL with participants"}),d.jsx("li",{children:"Each participant can use their unique code once"})]})]})]})}function wI({sessionId:t,completedLevels:e,totalTime:n,gameMode:r}){const[i,s]=D.useState(""),[a,l]=D.useState(!1);D.useEffect(()=>{u()},[]);const u=()=>{const p=Date.now().toString(36).toUpperCase(),g=e.toString().padStart(2,"0"),y=r.limit==="time"?"T":"A",E=r.accuracy==="strict"?"S":"L",F=`GAME-${`${t}-${g}-${n}`.split("").reduce((I,S)=>I+S.charCodeAt(0),0).toString(36).toUpperCase().slice(-3)}-${g}-${y}${E}-${p}`;s(F)},h=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(i),l(!0),setTimeout(()=>l(!1),3e3);else{const p=document.createElement("textarea");p.value=i,p.style.position="fixed",p.style.top="0",p.style.left="0",p.style.width="2em",p.style.height="2em",p.style.padding="0",p.style.border="none",p.style.outline="none",p.style.boxShadow="none",p.style.background="transparent",p.style.opacity="0",document.body.appendChild(p),p.focus(),p.select();try{document.execCommand("copy")?(l(!0),setTimeout(()=>l(!1),3e3)):(console.error("Failed to copy using execCommand"),alert("Copy failed. Please manually select and copy the code."))}catch(g){console.error("Failed to copy:",g),alert("Copy failed. Please manually select and copy the code.")}document.body.removeChild(p)}}catch(p){console.error("Clipboard operation failed:",p),alert(`Copy failed. Here's your code to copy manually:

${i}`)}};return d.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"30px",marginTop:"30px",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},children:[d.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:" Your Completion Code"}),d.jsx("p",{style:{marginBottom:"20px",opacity:.9,fontSize:"16px"},children:"Copy this code and paste it into the Qualtrics survey to verify your completion:"}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"20px",marginBottom:"20px",backdropFilter:"blur(10px)"},children:[d.jsx("div",{style:{fontFamily:"monospace",fontSize:"28px",fontWeight:"bold",letterSpacing:"2px",marginBottom:"15px",wordBreak:"break-all",textShadow:"2px 2px 4px rgba(0,0,0,0.2)",userSelect:"text",cursor:"text"},onClick:p=>{const g=window.getSelection(),y=document.createRange();y.selectNodeContents(p.currentTarget),g.removeAllRanges(),g.addRange(y)},title:"Click to select all text",children:i}),d.jsx("button",{onClick:h,style:{padding:"12px 30px",fontSize:"16px",fontWeight:"bold",background:a?"#4CAF50":"white",color:a?"white":"#764ba2",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:a?" Copied!":" Copy Code"})]}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:"6px",padding:"15px",fontSize:"14px",lineHeight:"1.5"},children:[d.jsx("strong",{children:" Important:"})," This code is your proof of completion. Make sure to copy it before closing this window!",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"13px",opacity:.9},children:" Tip: If the Copy button doesn't work, click on the code text to select it, then use Ctrl+C (or Cmd+C on Mac) to copy."})]}),d.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[d.jsx("summary",{style:{cursor:"pointer",opacity:.8,fontSize:"12px",marginBottom:"10px"},children:"Code Details "}),d.jsxs("div",{style:{fontSize:"12px",opacity:.7,background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",fontFamily:"monospace"},children:[d.jsxs("div",{children:["Levels Completed: ",e,"/45"]}),d.jsxs("div",{children:["Game Mode: ",r.limit==="time"?"Time Challenge":"Task Attempts"]}),d.jsxs("div",{children:["Accuracy Mode: ",r.accuracy==="strict"?"Strict (100%)":"Lenient"]}),d.jsxs("div",{children:["Total Time: ",Math.floor(n/60),"m ",n%60,"s"]}),d.jsxs("div",{children:["Generated: ",new Date().toLocaleString()]})]})]})]})}function SI({onClose:t}){const[e,n]=D.useState("config"),[r,i]=D.useState([]),[s,a]=D.useState(!0),[l,u]=D.useState(!1),[h,p]=D.useState(""),[g,y]=D.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,wrongAnswerPenalty:2,switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0,taskOrderStrategy:"sequential_task",difficultyMode:"fixed"}),[E,A]=D.useState(!1);D.useEffect(()=>{P(),S()},[]);const P=async()=>{try{const v=Pt(Ze,"game_settings","global"),m=await lf(v);m.exists()&&y({...g,...m.data()})}catch(v){console.error("Error loading game config:",v)}},F=async()=>{A(!0);try{const v=Pt(Ze,"game_settings","global");await Id(v,g,{merge:!0}),alert("Configuration saved successfully!")}catch(v){console.error("Error saving config:",v),alert("Failed to save configuration")}finally{A(!1)}},I=(v,m)=>{y(x=>({...x,[v]:m}))},S=async()=>{a(!0);try{const v=Uo(Ze,"students"),x=(await Td(v)).docs.map(w=>({id:w.id,...w.data()}));i(x)}catch(v){console.error("Error fetching students:",v)}finally{a(!1)}},C=async()=>{if(window.confirm("Are you sure you want to reset ALL student data? This cannot be undone!")){u(!0);try{const v=Uo(Ze,"students"),m=await Td(v);for(const x of m.docs)await Id(Pt(Ze,"students",x.id),{hasPlayed:!1,totalAccesses:0,scores:[]},{merge:!0});alert("All student data has been reset!"),await S()}catch(v){console.error("Error resetting data:",v),alert("Failed to reset data")}finally{u(!1)}}},V=v=>({padding:"12px 24px",background:v?"#2196F3":"transparent",color:v?"white":"#666",border:"none",borderBottom:v?"3px solid #2196F3":"3px solid transparent",cursor:"pointer",fontSize:"14px",fontWeight:v?"600":"normal",transition:"all 0.2s"}),L=r.filter(v=>{var m;return!((m=v.section)!=null&&m.includes("ADMIN"))}).length,M=r.filter(v=>{var m;return!((m=v.section)!=null&&m.includes("ADMIN"))&&v.hasPlayed}).length;return d.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[d.jsx("h1",{style:{margin:0,color:"#333"},children:" Master Admin Dashboard"}),d.jsx("button",{onClick:t,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:"Exit Admin"})]}),d.jsxs("div",{style:{display:"flex",borderBottom:"1px solid #e0e0e0",marginBottom:"30px"},children:[d.jsx("button",{onClick:()=>n("config"),style:V(e==="config"),children:" Game Configuration"}),d.jsx("button",{onClick:()=>n("players"),style:V(e==="players"),children:" Player Data"}),d.jsx("button",{onClick:()=>n("advice"),style:V(e==="advice"),children:" Game Advice"})]}),e==="config"&&d.jsxs("div",{children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"20px",marginBottom:"20px"},children:[d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Time & Semesters"}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Semester Duration (Minutes)"}),d.jsx("input",{type:"number",value:g.semesterDuration,onChange:v=>I("semesterDuration",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Semesters"}),d.jsx("input",{type:"number",value:g.totalSemesters,onChange:v=>I("totalSemesters",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("input",{type:"checkbox",checked:g.midtermEnabled,onChange:v=>I("midtermEnabled",v.target.checked),id:"midtermCheck"}),d.jsx("label",{htmlFor:"midtermCheck",style:{fontSize:"13px",cursor:"pointer"},children:"Enable Midterm Checkpoint"})]})]}),d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Task Settings"}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Tasks per Semester"}),d.jsx("input",{type:"number",value:g.totalTasks,onChange:v=>I("totalTasks",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Difficulty Configuration"}),d.jsxs("select",{value:g.difficultyMode||"fixed",onChange:v=>I("difficultyMode",v.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[d.jsx("option",{value:"fixed",children:"Fixed (50% Easy, 30% Medium, 20% Hard)"}),d.jsx("option",{value:"manual",children:"Manual (User chooses difficulty)"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Task Order Strategy"}),d.jsxs("select",{value:g.taskOrderStrategy,onChange:v=>I("taskOrderStrategy",v.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[d.jsx("option",{value:"sequential_task",children:"Order by Task (Materials  Research  Engagement)"}),d.jsx("option",{value:"sequential_difficulty",children:"Order by Difficulty (Easy  Medium  Hard)"})]})]})]}),d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Penalties & Mechanics"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Switch Cost (Points)"}),d.jsx("input",{type:"number",value:g.switchCost||0,onChange:v=>I("switchCost",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Refill Freeze (Seconds)"}),d.jsx("input",{type:"number",value:g.jarRefillFreezeTime||0,onChange:v=>I("jarRefillFreezeTime",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Unfinished Jar Penalty (Pts)"}),d.jsx("input",{type:"number",value:g.unfinishedJarPenalty||0,onChange:v=>I("unfinishedJarPenalty",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"AI Delay (Seconds)"}),d.jsx("input",{type:"number",value:g.aiDelay||0,onChange:v=>I("aiDelay",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]})]})]}),d.jsx("div",{style:{textAlign:"right"},children:d.jsx("button",{onClick:F,disabled:E,style:{padding:"12px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:E?"not-allowed":"pointer",fontWeight:"600",fontSize:"14px",opacity:E?.6:1},children:E?"Saving...":" Save Settings"})})]}),e==="players"&&d.jsxs("div",{style:{background:"white",padding:"25px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[d.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Active Sessions"}),d.jsx("button",{onClick:C,disabled:l,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:l?"not-allowed":"pointer",fontWeight:"500",opacity:l?.6:1},children:l?"Processing...":" Reset All Data"})]}),d.jsx("div",{style:{marginBottom:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"6px"},children:d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",textAlign:"center"},children:[d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:L}),d.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Total Students"})]}),d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:M}),d.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Have Played"})]}),d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:L-M}),d.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Never Played"})]})]})}),s?d.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"Loading student data..."}):d.jsx("div",{style:{overflowX:"auto"},children:d.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[d.jsx("thead",{children:d.jsxs("tr",{style:{background:"#f5f5f5",textAlign:"left"},children:[d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Student ID"}),d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Section"}),d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Has Played"}),d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Total Accesses"}),d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Highest Score"})]})}),d.jsx("tbody",{children:r.filter(v=>{var m;return!((m=v.section)!=null&&m.includes("ADMIN"))}).map(v=>d.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[d.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:v.sid||v.id}),d.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:v.section||"N/A"}),d.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:d.jsx("span",{style:{padding:"4px 12px",borderRadius:"12px",background:v.hasPlayed?"#e8f5e9":"#f5f5f5",color:v.hasPlayed?"#4CAF50":"#999",fontSize:"12px",fontWeight:"500"},children:v.hasPlayed?"Yes":"No"})}),d.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600"},children:v.totalAccesses||0}),d.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600",color:"#2196F3"},children:v.scores&&v.scores.length>0?Math.max(...v.scores.map(m=>m.total||0)):0})]},v.id))})]})})]}),e==="advice"&&d.jsxs("div",{style:{background:"white",padding:"60px 40px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),d.jsx("h2",{style:{fontSize:"24px",color:"#666",marginBottom:"15px",fontWeight:"500"},children:"Game Advice Configuration"}),d.jsx("p",{style:{color:"#999",maxWidth:"600px",margin:"0 auto 30px",lineHeight:"1.6"},children:"Configure contextual advice prompts based on remaining time and tasks completed. This feature will allow you to define dynamic advice messages for different game states."}),d.jsxs("div",{style:{marginTop:"40px",padding:"30px",background:"#f9f9f9",borderRadius:"8px",maxWidth:"500px",margin:"40px auto 0",border:"2px dashed #ddd"},children:[d.jsx("p",{style:{color:"#666",fontSize:"15px",margin:0,fontWeight:"500"},children:"Coming Soon: Dynamic 2D Advice Matrix"}),d.jsx("p",{style:{color:"#999",fontSize:"13px",margin:"10px 0 0",lineHeight:"1.5"},children:"Define advice based on time remaining  tasks completed thresholds"})]})]})]})}const EI={notifyGameComplete(t={}){try{window.parent.postMessage({type:"gameComplete",status:"finished",timestamp:new Date().toISOString(),...t},"*");try{if(window.parent&&window.parent.document){const e=window.parent.document.querySelector("#NextButton");e&&(e.style.display="inline-block",e.style.visibility="visible",e.disabled=!1)}}catch{window.parent.postMessage({type:"showNextButton",action:"show"},"*")}console.log(" Game completion notification sent to Qualtrics")}catch(e){console.error("Failed to notify Qualtrics:",e)}},notifySemesterComplete(t,e,n={}){try{window.parent.postMessage({type:"semesterComplete",semester:t,totalSemesters:e,timestamp:new Date().toISOString(),...n},"*"),window.parent.postMessage({type:"keepNextButtonVisible",action:"maintain"},"*"),console.log(` Semester ${t} completion notification sent`)}catch(r){console.error("Failed to notify Qualtrics of semester completion:",r)}},ensureNextButtonVisible(){try{window.parent.postMessage({type:"ensureNextButton",action:"show",timestamp:new Date().toISOString()},"*")}catch(t){console.error("Failed to ensure Next button visibility:",t)}}};function TI({onStart:t,totalTasks:e=10,orderStrategy:n="sequential_task",durationMinutes:r=12,difficultyMode:i="fixed"}){const[s,a]=D.useState({g2:0,g1:0,g3:0}),[l,u]=D.useState({g2:{easy:0,medium:0,hard:0},g1:{easy:0,medium:0,hard:0},g3:{easy:0,medium:0,hard:0}}),[h,p]=D.useState([]),[g,y]=D.useState(0),[E,A]=D.useState(null),P=["It's generally smart to do roughly an even number of each task.","This is because the tasks that are worth more points take more time to do, so you don't want to only do the shorter tasks or only do the longer tasks.","Of course, you might prefer one task over another, so you could take that into account. Do you feel like you are particularly good at one of the tasks?"],F=()=>{g<P.length?(p(m=>[...m,{sender:"AI",text:P[g]}]),y(m=>m+1)):p(m=>[...m,{sender:"AI",text:"I've shared my best advice! It's up to you now."}])},I=(m,x)=>{const w=parseInt(x)||0;a(k=>({...k,[m]:Math.max(0,w)})),A(null)},S=(m,x,w)=>{const k=parseInt(w)||0;u(R=>({...R,[m]:{...R[m],[x]:Math.max(0,k)}})),A(null)},L=i==="manual"?(()=>{let m=0;return Object.values(l).forEach(x=>{m+=x.easy+x.medium+x.hard}),m})():Object.values(s).reduce((m,x)=>m+x,0),M=L===e,v=()=>{if(L!==e){A(`Total tasks must equal ${e}. Currently: ${L}`);return}let m=[];i==="fixed"?["g2","g1","g3"].forEach(se=>{const ne=s[se];if(ne>0){const ie=Math.max(0,Math.round(ne*.5)),$=Math.max(0,Math.round(ne*.3)),N=Math.max(0,ne-ie-$);for(let O=0;O<ie;O++)m.push({type:se,difficulty:"easy"});for(let O=0;O<$;O++)m.push({type:se,difficulty:"medium"});for(let O=0;O<N;O++)m.push({type:se,difficulty:"hard"})}}):["g2","g1","g3"].forEach(se=>{const{easy:ne,medium:ie,hard:$}=l[se];for(let N=0;N<ne;N++)m.push({type:se,difficulty:"easy"});for(let N=0;N<ie;N++)m.push({type:se,difficulty:"medium"});for(let N=0;N<$;N++)m.push({type:se,difficulty:"hard"})});const x={g2:{easy:1,medium:6,hard:11},g1:{easy:1,medium:6,hard:11},g3:{easy:1,medium:6,hard:11}},w=m.map(se=>{const{type:ne,difficulty:ie}=se,$=x[ne][ie]++;return{...se,id:`${ne}t${$}`}});let k=[];if(n==="sequential_difficulty"){const se={easy:1,medium:2,hard:3},ne={g2:1,g1:2,g3:3};k=w.sort((ie,$)=>se[ie.difficulty]!==se[$.difficulty]?se[ie.difficulty]-se[$.difficulty]:ne[ie.type]-ne[$.type])}else{const se={g2:1,g1:2,g3:3},ne={easy:1,medium:2,hard:3};k=w.sort((ie,$)=>se[ie.type]!==se[$.type]?se[ie.type]-se[$.type]:ne[ie.difficulty]-ne[$.difficulty])}const R=k.map(se=>se.id),T=i==="fixed"?s:{g2:l.g2.easy+l.g2.medium+l.g2.hard,g1:l.g1.easy+l.g1.medium+l.g1.hard,g3:l.g3.easy+l.g3.medium+l.g3.hard};t(R,T)};return d.jsxs("div",{style:{maxWidth:"900px",margin:"40px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[d.jsx("h1",{style:{textAlign:"center",marginBottom:"30px",color:"#333"},children:"Task Allocation Strategy"}),d.jsxs("div",{style:{marginBottom:"30px",lineHeight:"1.6",color:"#555"},children:[d.jsxs("p",{children:["You have ",d.jsxs("strong",{children:[r," minutes"]})," to complete ",d.jsxs("strong",{children:[e," tasks"]}),"."]}),d.jsx("p",{children:"You must decide now how many of each task type you want to perform."}),d.jsxs("p",{children:["Total tasks must add up to ",d.jsx("strong",{children:e}),"."]}),i==="fixed"&&d.jsx("p",{style:{fontSize:"14px",fontStyle:"italic",color:"#666"},children:"* Within each task type, tasks are distributed as 50% Easy, 30% Medium, 20% Hard."})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"40px",marginBottom:"40px"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[i==="fixed"?d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:oc,children:[d.jsxs("label",{style:lc,children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 1: Slider (Materials)"]}),d.jsx("input",{type:"number",min:"0",max:e,value:s.g2,onChange:m=>I("g2",m.target.value),style:uc})]}),d.jsxs("div",{style:oc,children:[d.jsxs("label",{style:lc,children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 2: Counting (Research)"]}),d.jsx("input",{type:"number",min:"0",max:e,value:s.g1,onChange:m=>I("g1",m.target.value),style:uc})]}),d.jsxs("div",{style:oc,children:[d.jsxs("label",{style:lc,children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 3: Typing (Engagement)"]}),d.jsx("input",{type:"number",min:"0",max:e,value:s.g3,onChange:m=>I("g3",m.target.value),style:uc})]})]}):d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[d.jsxs("div",{style:ac,children:[d.jsxs("div",{style:{fontWeight:"bold",marginBottom:"10px",display:"flex",alignItems:"center"},children:[d.jsx("span",{style:{fontSize:"20px",marginRight:"10px"},children:""})," Materials (Slider)"]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[d.jsx(qn,{label:"Easy",value:l.g2.easy,onChange:m=>S("g2","easy",m)}),d.jsx(qn,{label:"Medium",value:l.g2.medium,onChange:m=>S("g2","medium",m)}),d.jsx(qn,{label:"Hard",value:l.g2.hard,onChange:m=>S("g2","hard",m)})]})]}),d.jsxs("div",{style:ac,children:[d.jsxs("div",{style:{fontWeight:"bold",marginBottom:"10px",display:"flex",alignItems:"center"},children:[d.jsx("span",{style:{fontSize:"20px",marginRight:"10px"},children:""})," Research (Counting)"]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[d.jsx(qn,{label:"Easy",value:l.g1.easy,onChange:m=>S("g1","easy",m)}),d.jsx(qn,{label:"Medium",value:l.g1.medium,onChange:m=>S("g1","medium",m)}),d.jsx(qn,{label:"Hard",value:l.g1.hard,onChange:m=>S("g1","hard",m)})]})]}),d.jsxs("div",{style:ac,children:[d.jsxs("div",{style:{fontWeight:"bold",marginBottom:"10px",display:"flex",alignItems:"center"},children:[d.jsx("span",{style:{fontSize:"20px",marginRight:"10px"},children:""})," Engagement (Typing)"]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[d.jsx(qn,{label:"Easy",value:l.g3.easy,onChange:m=>S("g3","easy",m)}),d.jsx(qn,{label:"Medium",value:l.g3.medium,onChange:m=>S("g3","medium",m)}),d.jsx(qn,{label:"Hard",value:l.g3.hard,onChange:m=>S("g3","hard",m)})]})]})]}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:M?"#e8f5e9":"#ffebee",borderRadius:"8px",textAlign:"center",fontWeight:"bold",color:M?"#2e7d32":"#c62828"},children:["Total Allocated: ",L," / ",e]}),E&&d.jsx("div",{style:{color:"red",textAlign:"center",fontSize:"14px"},children:E})]}),d.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"12px",padding:"20px",display:"flex",flexDirection:"column"},children:[d.jsxs("div",{style:{flex:1,marginBottom:"15px",overflowY:"auto",maxHeight:"300px",display:"flex",flexDirection:"column",gap:"10px"},children:[h.length===0&&d.jsx("div",{style:{color:"#999",fontStyle:"italic",textAlign:"center",marginTop:"40px"},children:"Need advice? Ask the AI helper."}),h.map((m,x)=>d.jsxs("div",{style:{background:"#f0f7ff",padding:"10px 15px",borderRadius:"12px 12px 12px 0",alignSelf:"flex-start",maxWidth:"90%"},children:[d.jsx("strong",{children:" AI:"})," ",m.text]},x))]}),d.jsxs("button",{onClick:F,style:{background:"#2196F3",color:"white",border:"none",padding:"12px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[d.jsx("span",{children:""})," Ask AI for Recommendation"]})]})]}),d.jsx("div",{style:{textAlign:"center"},children:d.jsx("button",{onClick:v,disabled:!M,style:{background:M?"#4CAF50":"#ccc",color:"white",border:"none",padding:"15px 40px",fontSize:"18px",borderRadius:"30px",cursor:M?"pointer":"not-allowed",fontWeight:"bold",boxShadow:M?"0 4px 15px rgba(76, 175, 80, 0.3)":"none",transition:"all 0.2s"},children:"Start Experiment"})})]})}const qn=({label:t,value:e,onChange:n})=>d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[d.jsx("label",{style:{fontSize:"12px",marginBottom:"4px",color:"#666"},children:t}),d.jsx("input",{type:"number",min:"0",value:e,onChange:r=>n(r.target.value),style:{width:"50px",padding:"8px",textAlign:"center",border:"1px solid #ddd",borderRadius:"4px"}})]}),oc={display:"flex",alignItems:"center",justifyContent:"space-between",background:"#f9f9f9",padding:"15px",borderRadius:"8px"},ac={background:"#f9f9f9",padding:"15px",borderRadius:"8px",border:"1px solid #eee"},lc={fontWeight:"bold",color:"#333",display:"flex",alignItems:"center"},uc={width:"60px",padding:"10px",fontSize:"18px",textAlign:"center",borderRadius:"6px",border:"1px solid #ddd"};function II({currentTaskIndex:t,totalTasks:e,taskQueue:n,onSwitchTask:r,onRefill:i,children:s,points:a,timeRemaining:l,onTimeUp:u,chatInterface:h}){const p=n[t];(C=>C.startsWith("g1")?{name:"Research",icon:"",color:"#9C27B0",bg:"#f3e5f5"}:C.startsWith("g2")?{name:"Materials",icon:"",color:"#4CAF50",bg:"#e8f5e9"}:C.startsWith("g3")?{name:"Engagement",icon:"",color:"#f44336",bg:"#ffebee"}:{name:"Unknown",icon:"",color:"#333",bg:"#eee"})(p);const y=n.slice(0,t),E={g1:y.filter(C=>C.startsWith("g1")).length,g2:y.filter(C=>C.startsWith("g2")).length,g3:y.filter(C=>C.startsWith("g3")).length},A=e-t,P=n.slice(t),F={g2:P.filter(C=>C.startsWith("g2")),g1:P.filter(C=>C.startsWith("g1")),g3:P.filter(C=>C.startsWith("g3"))},I=C=>p.startsWith(C),S=(C,V,L,M,v,m)=>{const x=m.length,w=I(C),k=x>0;return d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",background:v,borderRadius:"12px",padding:"10px",border:`2px solid ${w?M:"transparent"}`,height:"100%",position:"relative"},children:[d.jsxs("div",{style:{fontSize:"14px",fontWeight:"bold",color:M,marginBottom:"10px",display:"flex",alignItems:"center",gap:"5px"},children:[d.jsx("span",{children:L}),d.jsx("span",{children:x})]}),d.jsx("div",{style:{flex:1,width:"100%",display:"flex",flexDirection:"column",gap:"5px",justifyContent:"flex-end",paddingBottom:"10px"},children:k?d.jsxs(d.Fragment,{children:[m.slice(1).map((R,T)=>d.jsx("div",{style:{height:"8px",width:"80%",background:M,opacity:.4,borderRadius:"4px",margin:"0 auto"}},T)),d.jsx("button",{onClick:()=>!w&&r(C),disabled:w,style:{width:"100%",padding:"15px 5px",background:w?M:"white",color:w?"white":M,border:`2px solid ${M}`,borderRadius:"8px",cursor:w?"default":"pointer",fontWeight:"bold",fontSize:"12px",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",transition:"transform 0.1s",zIndex:2},children:w?"Current":"Switch"})]}):d.jsx("button",{onClick:()=>i&&i(C),style:{width:"100%",padding:"10px 5px",background:"white",border:"2px dashed #999",borderRadius:"8px",color:"#666",cursor:"pointer",fontSize:"12px"},children:" Refill"})}),d.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"5px"},children:V})]})};return d.jsxs("div",{style:{maxWidth:"1600px",margin:"0 auto",padding:"20px"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"white",padding:"15px 25px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[d.jsx("div",{style:{width:"200px"},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""}),d.jsx("div",{children:d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:l<60?"#f44336":"#333",animation:l<60?"pulse 1s infinite":"none"},children:[Math.floor(l/60),":",(l%60).toString().padStart(2,"0")]})})]})}),d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Points"}),d.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#2196F3"},children:a})]}),d.jsxs("div",{style:{textAlign:"right",minWidth:"300px"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"5px"},children:"Task Progress"}),d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"15px"},children:[d.jsxs("div",{style:{display:"flex",gap:"10px",fontSize:"16px",fontWeight:"500",color:"#555"},children:[d.jsxs("span",{title:"Materials Done",children:[" ",E.g2]}),d.jsx("span",{style:{color:"#ddd"},children:"|"}),d.jsxs("span",{title:"Research Done",children:[" ",E.g1]}),d.jsx("span",{style:{color:"#ddd"},children:"|"}),d.jsxs("span",{title:"Engagement Done",children:[" ",E.g3]})]}),d.jsxs("div",{style:{background:"#eee",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold",color:"#333"},children:["Remaining: ",A]})]})]})]}),d.jsxs("div",{className:"task-runner-layout",style:{display:"grid",gridTemplateColumns:"320px 1fr 320px",gap:"20px",height:"calc(100vh - 140px)",boxSizing:"border-box"},children:[d.jsxs("div",{style:{background:"white",padding:"15px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",height:"fit-content",maxHeight:"100%"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#666",textAlign:"center"},children:"Task Jars"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px",flex:1},children:[S("g2","Materials","","#4CAF50","#e8f5e9",F.g2),S("g1","Research","","#9C27B0","#f3e5f5",F.g1),S("g3","Engagement","","#f44336","#ffebee",F.g3)]})]}),d.jsx("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",overflow:"hidden",display:"flex",flexDirection:"column"},children:s}),d.jsx("div",{style:{height:"100%",overflow:"hidden"},children:h&&d.jsx("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:h})})]}),d.jsx("style",{children:`
        @keyframes pulse {
          0% { opacity: 1; }
          50% { opacity: 0.5; }
          100% { opacity: 1; }
        }
      `})]})}function CI({timeRemaining:t,onSelectTask:e,onFinishEarly:n}){return d.jsxs("div",{style:{maxWidth:"800px",margin:"40px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsx("h1",{style:{color:"#2196F3",marginBottom:"20px"},children:" All Tasks Completed!"}),d.jsxs("div",{style:{fontSize:"18px",color:"#555",marginBottom:"30px",lineHeight:"1.6"},children:[d.jsx("p",{children:"You have finished all 10 allocated tasks with time to spare."}),d.jsxs("p",{children:["You currently have ",d.jsxs("strong",{children:[Math.floor(t/60)," minutes and ",t%60," seconds"]})," remaining."]}),d.jsxs("p",{children:["You can choose to do more tasks for ",d.jsx("strong",{children:"1/2 credit"})," to increase your score, or finish the experiment now."]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"40px"},children:[d.jsxs("button",{onClick:()=>e("g2"),style:cc("#4CAF50"),children:[d.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Materials Task",d.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),d.jsxs("button",{onClick:()=>e("g1"),style:cc("#9C27B0"),children:[d.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Research Task",d.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),d.jsxs("button",{onClick:()=>e("g3"),style:cc("#f44336"),children:[d.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Engagement Task",d.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]})]}),d.jsx("div",{style:{borderTop:"1px solid #eee",paddingTop:"30px"},children:d.jsx("button",{onClick:n,style:{background:"#f5f5f5",color:"#666",border:"1px solid #ddd",padding:"12px 30px",fontSize:"16px",borderRadius:"30px",cursor:"pointer",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:r=>r.target.style.background="#e0e0e0",onMouseLeave:r=>r.target.style.background="#f5f5f5",children:"No thanks, I'm done"})})]})}const cc=t=>({background:"white",border:`2px solid ${t}`,color:t,padding:"20px",borderRadius:"12px",cursor:"pointer",fontSize:"16px",fontWeight:"bold",transition:"all 0.2s",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"});function AI(t,e){const n=t.length,r=e.length,i=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let s=0;s<=n;s++)i[s][0]=s;for(let s=0;s<=r;s++)i[0][s]=s;for(let s=1;s<=n;s++)for(let a=1;a<=r;a++)t[s-1]===e[a-1]?i[s][a]=i[s-1][a-1]:i[s][a]=Math.min(i[s-1][a]+1,i[s][a-1]+1,i[s-1][a-1]+1);return i[n][r]}function kI(){const e=new URLSearchParams(window.location.search).get("admin")==="berkeley2024",[n,r]=D.useState("landing"),[i,s]=D.useState(null),[a,l]=D.useState(null),[u,h]=D.useState("g2t1"),[p,g]=D.useState({}),[y,E]=D.useState(0),[A,P]=D.useState(null),[F,I]=D.useState(!1),[S,C]=D.useState(""),[V,L]=D.useState(!0),[M,v]=D.useState(0),[m,x]=D.useState({}),[w,k]=D.useState(0),[R,T]=D.useState(0),[se,ne]=D.useState(!1),[ie,$]=D.useState(null),[N,O]=D.useState(!1),[G,Z]=D.useState(30),[ee,ae]=D.useState(!1),[ke,we]=D.useState(5),[fe,he]=D.useState(!1),[Le,Se]=D.useState(0),[te,Ce]=D.useState(1),[Oe]=D.useState(2),[Re,St]=D.useState([]),[qt,Gt]=D.useState(null),[Qt,Kt]=D.useState(!1),[cr,dr]=D.useState(0),[bn,hr]=D.useState(null),[Pe,Is]=D.useState({g2t1:!1,g1t1:!1,g3t1:!1}),[na,nt]=D.useState(720),[rt,fr]=D.useState(720),[xi,Cs]=D.useState(0),[Ie,ln]=D.useState({materials:0,research:0,engagement:0,bonus:0}),[Gr,wi]=D.useState({}),[ra,ia]=D.useState({}),[cf,Si]=D.useState({}),[it,sa]=D.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,unfinishedTaskPenalty:0,taskOrderStrategy:"sequential_task",freezePenalty:0,contextAdviceEnabled:!0,difficultyMode:"fixed",switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0});D.useEffect(()=>{(async()=>{try{const B=Pt(Ze,"game_settings","global"),W=await lf(B);if(W.exists()){const K=W.data();if(sa(ue=>({...ue,...K})),K.semesterDuration){const ue=K.semesterDuration*60;nt(ue),fr(ue),_u.current=ue,Qr.current=ue}}}catch(B){console.error("Error loading global config:",B)}})()},[]);const[Yt,Bn]=D.useState([]),[Un,yn]=D.useState(0),[oa,Ei]=D.useState(null),[vu,Ti]=D.useState(!1),Ii=D.useRef(Date.now()),Ge=D.useRef(null);D.useRef(null),D.useRef(null);const Ci=D.useRef(null),pr=D.useRef(Date.now()),Qr=D.useRef(720),_u=D.useRef(720),Kr=()=>{const q=(it.semesterDuration||12)*60*1e3,B=Math.floor(q/2e3);return Math.floor(B/60)};if(D.useEffect(()=>{(async()=>{try{const B=new URLSearchParams(window.location.search),W=B.has("code")||B.has("c");if((B.get("code")||B.get("c"))==="MASTER"){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",section:"master_admin",hasAI:!1,isMasterInterface:!0,displayName:"Master Administrator"})),L(!1);return}if(e&&!sessionStorage.getItem("gameConfig")&&sessionStorage.setItem("gameConfig",JSON.stringify({role:"admin",section:"admin",hasAI:!0,checkpointSemester2:!0,displayName:"Admin User"})),!W){r("studentLogin"),L(!1);return}const{allowed:ue,reason:$e,resumeSession:ut,newSession:Qe,code:ft,codeData:Dt}=await Hm.checkAccess();if(!ue){I(!0),C($e),L(!1);return}if(ut)P(ut),localStorage.setItem("sessionId",ut);else if(Qe){const Xt=await Hm.createSession(ft,Dt);P(Xt)}await Je.syncOfflineEvents(),L(!1)}catch{L(!1)}})()},[]),D.useEffect(()=>{n==="complete"&&te>=Oe&&EI.notifyGameComplete({finalScore:Math.round(un())+(Ie.bonus||0),totalTime:M,semestersCompleted:te,sessionId:A})},[n,te,Oe,M,Ie.bonus,A]),D.useEffect(()=>{localStorage.setItem("currentTask",u)},[u]),D.useEffect(()=>{localStorage.setItem("gameMode",JSON.stringify(i))},[i]),D.useEffect(()=>{localStorage.setItem("currentSemester",te.toString())},[te]),D.useEffect(()=>{localStorage.setItem("totalSemesters",Oe.toString())},[Oe]),D.useEffect(()=>{localStorage.setItem("completedTasksCount",Object.keys(p).length.toString())},[p]),D.useEffect(()=>{localStorage.setItem("completedLevels",y.toString())},[y]),D.useEffect(()=>{localStorage.setItem("totalSwitches",w.toString())},[w]),D.useEffect(()=>{localStorage.setItem("categoryPoints",JSON.stringify(Ie))},[Ie]),D.useEffect(()=>{localStorage.setItem("studentLearningScore",xi.toString())},[xi]),D.useEffect(()=>{const q=Pe.g2t1&&Pe.g1t1&&Pe.g3t1;localStorage.setItem("practiceCompleted",q.toString())},[Pe]),V)return d.jsx("div",{className:"app",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:d.jsx("h2",{children:"Loading..."})});if(window.location.search.includes("master=true")&&JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="master_admin")return d.jsx(SI,{onClose:()=>r("landing")});if(window.location.search.includes("admin=true"))return d.jsx(xI,{});const un=(q=Ie,B=Gr)=>{let W=0;Object.entries(B).forEach(([Qe,ft])=>{const Xt=1+parseInt(Qe)*.15;W+=ft*Xt});const K=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,ue=W+K,$e=q.materials||0,ut=q.research||0;return console.log(` STUDENT LEARNING: ${ue.toFixed(1)} pts | Materials: ${$e} (with sequential multipliers) | Research: ${ut} | Interest: ${K.toFixed(1)} = ${ue.toFixed(1)}`),isNaN(ue)?0:ue},xu=()=>{if(!(te===2&&it.midtermEnabled))return;Kt(!0),un()>=300?(dr(300),ln(K=>({...K,bonus:(K.bonus||0)+300}))):dr(0),ne(!0),$("checkpoint")},aa=()=>{const q=(it.semesterDuration||12)*60*1e3,B=Math.floor(q/1e3);nt(B),fr(B),Ii.current=Date.now(),Ge.current=setInterval(()=>{const K=Date.now()-Ii.current,ue=Math.floor(K/1e3);v(ue);const $e=Math.max(0,B-ue);if(fr($e),ue%10===0&&A&&!A.startsWith("offline-")&&Kn(Pt(Ze,"sessions",A),{timeElapsed:ue,lastUpdated:Tn()}).catch(Qe=>console.error("Failed to update session time:",Qe)),te===2&&it.midtermEnabled){const Qe=(it.semesterDuration||12)*60*1e3,ft=Math.floor(Qe/2e3);ue===ft&&!Qt&&xu()}$e<=0&&(clearInterval(Ge.current),Ge.current=null,mr("semester_complete"))},1e3)},Yr=q=>{const W=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin",K=Pe.g2t1&&Pe.g1t1&&Pe.g3t1;l(q),Je.logEvent("practice_choice",{choice:q}),q==="no"?!W&&!K?(Dn("You must complete all three practice tasks first!"),r("practice")):As():r("practice")},As=()=>{if(!qt){const q=Math.floor(Math.random()*1e6);Gt(q),er.initializeSeed(q),A&&!A.startsWith("offline-")&&Kn(Pt(Ze,"sessions",A),{randomSeed:q,[`semesterSeeds.semester${te}`]:q})}localStorage.setItem("engagementInterest","0"),ln({materials:0,research:0,engagement:0,bonus:0}),wi({}),r("allocation"),g({}),E(0),k(0),T(0),Kt(!1),ia({}),Si({})},ks=(q,B)=>{Bn(q),Ei(B),yn(0),r("challenge");const K=`${q[0]}t1`;h(K),x({[K]:Date.now()}),Je.setPageStartTime(K),aa(),Je.logEvent("allocation_complete",{counts:B,queue:q,timestamp:Date.now()})},Ai=q=>{const B=Yt[Un].substring(0,2);if(B===q)return;const W=it.switchCost||0;W>0&&(ln(st=>({...st,bonus:(st.bonus||0)-W})),Dn(`Switching tasks cost ${W} points!`));const K=[...Yt],ue=K.slice(Un),$e=K.slice(0,Un),ut=ue.filter(st=>st.startsWith(B)),Qe=ue.filter(st=>st.startsWith(q)),ft=ue.filter(st=>!st.startsWith(B)&&!st.startsWith(q)),Dt=[...Qe,...ft,...ut],Xt=[...$e,...Dt];if(Bn(Xt),k(st=>st+1),Qe.length>0){const st=Qe[0];ki(st)}},cn=async(q,B)=>{pr.current=Date.now();let W=0;const K=q.startsWith("g1")?"research":q.startsWith("g2")?"materials":"engagement";if(K==="materials")if(B.points!==void 0)W=B.points;else{const le=parseFloat(B.userAnswer||B.userValue||0),We=parseFloat(B.correctAnswer||B.targetValue||0),Ot=Math.abs(le-We);Ot===0?W=2:Ot<=1?W=1:W=0}else if(K==="research")if(B.points!==void 0)W=B.points;else{const le=parseInt(B.userAnswer||0),We=parseInt(B.correctAnswer||0),Ot=Math.abs(le-We);Ot===0?W=2:Ot<=1?W=1:W=0}else if(K==="engagement")if(B.points!==void 0)W=B.points;else{const le=B.userAnswer||"",We=B.correctAnswer||"";le===We?W=2:AI(le,We)===1?W=1:W=0}if(ln(le=>{const We={...le,[K]:le[K]+W};return console.log(` Updated ${K}: +${W} (total: ${We[K]})`),We}),K==="materials"&&W>0){const le=Ie.research;wi(We=>{const Ot=We[le]||0;return{...We,[le]:Ot+W}})}const $e=.0015*(K==="engagement"?Ie.engagement+W:Ie.engagement),ut={...Ie,[K]:Ie[K]+W};let Qe=Gr;if(K==="materials"&&W>0){const le=Ie.research,We=Gr[le]||0;Qe={...Gr,[le]:We+W}}let ft=0;Object.entries(Qe).forEach(([le,We])=>{const Ps=1+parseInt(le)*.15;ft+=We*Ps});const Xt=parseFloat(localStorage.getItem("engagementInterest")||"0")+$e*ft;localStorage.setItem("engagementInterest",Xt.toString()),Si(le=>({...le,[q]:W})),ia(le=>({...le,[q]:(le[q]||0)+1}));const st={...Ie,[K]:Ie[K]+W},Ri=un(st,Qe);Cs(Ri);let Jt="";if(K==="materials"){const le=Math.abs((B.userValue||0)-(B.targetValue||0));le===0?Jt="Perfect materials!":le<=1?Jt=`Off by ${le.toFixed(2)}`:Jt=`Off by ${le.toFixed(2)}`}else if(K==="research"){const le=Math.abs((B.userAnswer||0)-(B.correctAnswer||0));le===0?Jt="Perfect research!":le<=1?Jt=`Off by ${le}`:Jt=`Off by ${le}`}else K==="engagement"&&(W===2?Jt="Perfect engagement!":W===1?Jt="One typo":Jt="Multiple errors");Dn(`${Jt} | +${W} ${K} pts`),g(le=>({...le,[q]:!0})),E(le=>le+1),T(le=>le+1),await Je.trackTaskComplete(q,B.attempts,B.totalTime,B.accuracy||B.difference||0),await Je.logEvent("task_complete",{taskId:q,...B,pointsEarned:W,categoryPoints:ut,studentLearningScore:Ri,engagementInterest:Xt,completionContext:{totalTasksCompleted:Object.keys(p).length+1,currentGameTime:M,switchesBeforeCompletion:w,bonusPromptsEarned:R+1,timeRemaining:rt}}),A&&!A.startsWith("offline-")&&await Kn(Pt(Ze,"sessions",A),{[`completedTasks.${q}`]:!0,[`taskPoints.${q}`]:W,categoryPoints:ut,studentLearningScore:Ri,engagementInterest:Xt,bonusPrompts:R+1,lastActivity:Tn()});const Rs=Un+1;if(Rs<Yt.length){yn(Rs);const le=Yt[Rs];let We=Object.keys(p).filter($n=>$n.startsWith(le)).length;le===q.substring(0,2)&&q.startsWith(le)&&(We+=1);const Ot=We+1,Ps=`${le}t${Ot}`;ki(Ps,!0)}else mr("all_tasks_done")},ki=async(q,B=!1)=>{if(!se){if(p[q]&&!B){Dn("Task already completed! Choose a different task.");return}if(B||await Je.logEvent("manual_tab_switch",{from:u,to:q,reason:"user_clicked"}),pr.current=Date.now(),ee&&(ae(!1),we(5),Ci.current&&(clearInterval(Ci.current),Ci.current=null)),u!==q&&!B&&k(W=>W+1),await Je.trackPageSwitch(u,q,B),m[u]){const W=Date.now()-m[u];await Je.logEvent("task_time",{taskId:u,timeSpent:W,completed:p[u]||!1,leftForTask:q})}h(q),x(W=>({...W,[q]:Date.now()})),Je.setPageStartTime(q)}},Dn=q=>{const B=document.createElement("div");B.className="notification-enter",B.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",B.textContent=q,document.body.appendChild(B),setTimeout(()=>{B.className="notification-exit",setTimeout(()=>{document.body.contains(B)&&document.body.removeChild(B)},500)},3e3)},mr=async(q="semester_complete")=>{Ge.current&&clearInterval(Ge.current);const B=Math.floor((Date.now()-Ii.current-Le)/1e3),W=un(),K=Ie.bonus||0,ue=Math.max(0,it.totalTasks-Object.keys(p).length),$e=ue*(it.unfinishedTaskPenalty||0),ut=Math.round(W)+K-$e;$e>0&&console.log(` Unfinished Penalty: -${$e} pts (${ue} tasks x ${it.unfinishedTaskPenalty})`),await Je.logEvent("game_complete",{totalTime:B,totalSwitches:w,completedTasks:Object.keys(p).length,completedLevels:y,completionReason:q,gameMode:i,currentSemester:te,categoryPoints:Ie,studentLearningScore:W,totalBonus:K,finalScore:ut,finalContext:{practiceCompleted:a==="yes",totalPrompts:3+R,isAdminMode:e}}),A&&!A.startsWith("offline-")&&await Kn(Pt(Ze,"sessions",A),{status:"completed",completedAt:Tn(),finalTime:B,timeElapsed:B,totalSwitches:w,completionReason:q,currentSemester:te,finalScore:ut,studentLearningScore:W}),r("complete")},vn=(q,B)=>{if(B&&B.points&&B.points===2)Is(W=>({...W,[q]:!0})),Dn("Perfect! Practice task completed."),setTimeout(()=>{hr(null)},1500);else{const W=(B==null?void 0:B.points)||0;Dn(`Practice requires 100% accuracy. You scored ${W===1?"50%":"0%"}. Try again!`),setTimeout(()=>{hr(null)},2e3)}},la=()=>{const q=u[1],B=parseInt(u.substring(3)),W=n==="practice";return q==="1"?d.jsx(Ad,{taskNum:B,onComplete:W?vn:cn,currentTaskId:u,isPractice:W}):q==="2"?d.jsx(kd,{taskNum:B,onComplete:W?vn:cn,currentTaskId:u,isPractice:W}):d.jsx(Rd,{taskNum:B,onComplete:W?vn:cn,currentTaskId:u,isPractice:W})};if(n==="studentLogin")return d.jsx(_I,{onLoginSuccess:q=>{window.location.href=`${window.location.origin}?code=${q}`}});if(F)return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"600px",margin:"50px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[d.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Access Denied"}),d.jsx("p",{style:{fontSize:"18px",marginBottom:"20px"},children:S}),d.jsx("div",{style:{padding:"15px",background:"#ffebee",borderRadius:"8px",border:"1px solid #f44336"},children:d.jsx("p",{style:{color:"#c62828",margin:0},children:"If you believe this is an error, please contact your instructor."})})]})});if(n==="semesterBreak"){const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),B=te===2&&q.checkpointSemester2;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"700px",margin:"50px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsxs("h1",{style:{color:"#2196F3",marginBottom:"30px"},children:[" Semester ",te-1," Complete!"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsx("h3",{style:{color:"#1976d2",marginBottom:"10px"},children:"Take a Break!"}),d.jsxs("p",{style:{fontSize:"16px",color:"#666",marginBottom:"0"},children:["Great job completing Semester ",te-1,"! Take a moment to rest your eyes, stretch, or grab some water before continuing."]})]}),B&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",padding:"25px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #ff9800"},children:[d.jsx("h3",{style:{color:"#f57c00",marginBottom:"15px"},children:" Midterm Checkpoint Coming!"}),d.jsxs("div",{style:{fontSize:"16px",color:"#666",textAlign:"left"},children:[d.jsx("p",{style:{marginBottom:"10px"},children:d.jsxs("strong",{children:["Semester 2 includes a midterm exam at the"," ",Kr(),"-minute mark!"]})}),d.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"10px"},children:[d.jsx("li",{children:"Your students will be tested at the midpoint"}),d.jsxs("li",{children:["If student learning  300 points:"," ",d.jsx("strong",{children:"+300 bonus points!"})]}),d.jsx("li",{children:"Build up your teaching effectiveness early to maximize the bonus"})]}),d.jsxs("p",{style:{background:"white",padding:"10px",borderRadius:"4px",textAlign:"center",fontWeight:"bold",color:"#f57c00"},children:["Goal: Reach 300+ Student Learning by minute"," ",Kr()]})]})]}),Re.length>0&&d.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"10px"},children:"Your Performance So Far:"}),Re.map((W,K)=>d.jsxs("div",{style:{marginBottom:"8px",fontSize:"16px"},children:["Semester ",K+1,":"," ",d.jsxs("strong",{children:[W.finalScore," points"]})]},K))]}),d.jsxs("div",{style:{marginTop:"30px"},children:[d.jsxs("button",{onClick:()=>{Ce(W=>W+1),r("allocation"),g({}),Bn([]),yn(0),Cs(0),ln({materials:0,research:0,engagement:0,bonus:0}),aa(),x({g2t1:Date.now()}),Je.setPageStartTime("g2t1"),Je.logEvent("semester_start",{semester:te,timestamp:Date.now(),hasCheckpoint:B})},style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:W=>{W.currentTarget.style.transform="translateY(-2px)",W.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:W=>{W.currentTarget.style.transform="translateY(0)",W.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["I'm Ready - Start Semester ",te]}),d.jsx("p",{style:{marginTop:"15px",fontSize:"14px",color:"#999"},children:"Click when you're ready to continue. The timer will start immediately."})]})]})})}if(n==="landing"){i||s({accuracy:"lenient",limit:"time"});const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),B=q.role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",style:{padding:"40px",maxWidth:"900px"},children:[d.jsxs("h1",{style:{color:"#333",marginBottom:"30px",fontSize:"32px",textAlign:"left"},children:["Can you beat Park? - Semester ",te,"/",Oe]}),d.jsxs("div",{className:"game-info",style:{textAlign:"left"},children:[d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#f44336",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Engagement"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Build interest that compounds! Each point adds 0.15% interest after every task completion."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#9C27B0",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Research"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Research amplifies your FUTURE materials! Each point adds +15% multiplier to materials earned after the research (order matters!)."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#4CAF50",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Materials"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Create teaching materials - each point directly contributes to your goal points!"})]}),d.jsxs("div",{style:{background:"#f0f8ff",borderRadius:"8px",padding:"25px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{color:"#2196F3",fontSize:"20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Student Learning Formula"]}),d.jsxs("div",{style:{background:"white",padding:"18px",borderRadius:"6px",fontFamily:"monospace",fontSize:"18px",textAlign:"center",marginBottom:"20px",border:"1px solid #e0e0e0",lineHeight:"1.8"},children:["Goal ="," ",d.jsx("strong",{children:"Materials  (1 + Research0.15) + Engagement Interest"}),d.jsx("br",{}),d.jsxs("div",{style:{fontSize:"14px",marginTop:"10px",fontFamily:"sans-serif"},children:["Research multipliers apply only to materials earned"," ",d.jsx("em",{children:"after"})," the research"]})]}),d.jsxs("ul",{style:{color:"#333",lineHeight:"2",margin:"0",paddingLeft:"25px",fontSize:"15px",textAlign:"left"},children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Scoring:"})," Exact = 2 pts | Within 1 = 1 pt | Otherwise = 0 pts"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Timing:"})," Task completion order affects your final score"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Strategy:"})," Think carefully about when to complete each task type!"]}),te===2&&d.jsxs("li",{children:["At minute ",Kr(),": Exam checkpoint with bonus opportunity (300+ Student Learning = 300 bonus)"]})]})]}),q.hasAI&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"1px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"AI Assistant Available:"}),d.jsxs("ul",{style:{color:"#856404",lineHeight:"1.6",margin:"0",paddingLeft:"20px",fontSize:"14px"},children:[d.jsx("li",{children:"Click the help buttons below each task for AI assistance"}),d.jsx("li",{children:"Unlimited use but reliability varies"}),d.jsx("li",{children:'Type "strategy" or "order" in chat for strategic advice!'})]})]}),te===2&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"2px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:" Semester 2: Midterm Checkpoint!"}),d.jsxs("p",{style:{color:"#856404",fontSize:"14px",margin:0},children:["At the ",Kr(),"-minute mark, if you have 300+ student learning points, you'll earn a 300-point bonus!"]})]})]}),!B&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)",borderRadius:"12px",padding:"20px",marginTop:"20px",marginBottom:"20px",border:"2px solid #d32f2f",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"12px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""}),d.jsx("h3",{style:{color:"#b71c1c",margin:0,fontSize:"18px",fontWeight:"600"},children:"ONE ATTEMPT ONLY - NO RESTART"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No refresh/close"})," - Session ends"]})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No tab switching"})," - 30s warning"]})]})]}),d.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"6px",textAlign:"center",fontSize:"14px",color:"#b71c1c",fontWeight:"600"},children:" Ensure 40 minutes uninterrupted before starting"})]}),d.jsxs("button",{className:"start-button",onClick:()=>r("practiceChoice"),children:["Start Semester ",te]}),e&&d.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#ffcccb",borderRadius:"6px",border:"2px solid #ff0000",fontWeight:"bold",color:"#d00"},children:["ADMIN MODE: ",na/60," minute timer, checkpoint at"," ",Kr(),"minute"]}),Re.length>0&&d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"6px",fontSize:"14px"},children:[d.jsx("strong",{children:"Previous Semesters:"}),Re.map((W,K)=>d.jsxs("div",{style:{marginTop:"5px"},children:["Semester ",K+1,": ",W.finalScore," points"]},K))]})]})})})}if(n==="practiceChoice"){const B=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",children:[d.jsx("h2",{style:{color:"#333",marginBottom:"20px"},children:B?"Practice Mode (Optional for Admin)":"Practice Mode (Required)"}),d.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:B?"As an admin, you can skip practice or try it first.":"You must complete all three practice tasks before starting the main game."}),d.jsx("p",{style:{color:"#888",fontSize:"14px",marginBottom:"30px",fontStyle:"italic"},children:"Practice lets you try each teaching task without time pressure."}),!B&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #1976d2",boxShadow:"0 4px 6px rgba(25, 118, 210, 0.1)"},children:[d.jsxs("h4",{style:{color:"#0d47a1",margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:""}),"Required Practice Tasks (100% accuracy needed):"]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Pe.g2t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Pe.g2t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Materials"})}),Pe.g2t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Pe.g1t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Pe.g1t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Research"})}),Pe.g1t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Pe.g3t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Pe.g3t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Engagement"})}),Pe.g3t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]})]}),d.jsx("div",{style:{marginTop:"16px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"6px",fontSize:"13px",color:"#0d47a1",textAlign:"center",fontStyle:"italic"},children:" Each task must be completed perfectly to proceed"})]}),d.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[d.jsx("button",{onClick:()=>Yr("yes"),style:{padding:"15px 30px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:B?"Try Practice Mode":"Start Required Practice"}),B&&d.jsx("button",{onClick:()=>Yr("no"),style:{padding:"15px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:"Skip Practice (Admin)"})]})]})})})}if(n==="practice"){const B=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";if(!bn)return d.jsxs("div",{className:"app",children:[d.jsx("h1",{children:"Teaching Simulation - Practice Mode"}),d.jsx(gI,{practiceCompleted:Pe,onPracticeComplete:vn,onSelectPractice:hr,onStartMainGame:()=>{const ue=Pe.g2t1&&Pe.g1t1&&Pe.g3t1;!B&&!ue?Dn("You must complete all three practice tasks first!"):As()},isAdmin:B})]});const W=bn[1],K=1;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[d.jsx("button",{onClick:()=>hr(null),style:{marginBottom:"20px",padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:" Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),W==="1"&&d.jsx(Ad,{taskNum:K,onComplete:vn,currentTaskId:bn,isPractice:!0}),W==="2"&&d.jsx(kd,{taskNum:K,onComplete:vn,currentTaskId:bn,isPractice:!0}),W==="3"&&d.jsx(Rd,{taskNum:K,onComplete:vn,currentTaskId:bn,isPractice:!0})]})})}if(n==="complete"){const q=Math.floor(M/60),B=M%60,W=Math.round(un()),K=Ie.bonus||0,ue=W+K,$e={semester:te,totalTime:M,completedLevels:y,categoryPoints:Ie,switches:w,gameMode:i,randomSeed:qt,studentLearningScore:W,finalScore:ue},ut=async()=>{const ft=[...Re,$e];St(ft),localStorage.setItem("engagementInterest","0"),ln({materials:0,research:0,engagement:0,bonus:0}),wi({}),A&&!A.startsWith("offline-")&&await Kn(Pt(Ze,"sessions",A),{[`semesterHistory.semester${te}`]:$e,currentSemester:te+1,lastActivity:Tn()}),Ce(te+1),Pd.resetForNewSemester(),r("semesterBreak"),g({}),E(0),k(0),T(0),v(0),Se(0),h("g2t1"),Kt(!1);const Dt=Math.floor(Math.random()*1e6);Gt(Dt),er.initializeSeed(Dt)},Qe=te>=Oe;return d.jsxs("div",{className:"app",children:[d.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[d.jsx("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"8px",border:"2px solid #2196F3"},children:d.jsxs("h2",{style:{color:"#2196F3",margin:0},children:["Semester ",te," of ",Oe," Complete!"]})}),Qe&&d.jsx(wI,{sessionId:A,completedLevels:y,totalTime:M,gameMode:i}),d.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginTop:"20px"},children:[d.jsxs("h2",{style:{color:"#333",marginBottom:"20px"},children:[" Semester ",te," Performance"]}),d.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2196F3",marginBottom:"30px"},children:["Final Score: ",ue," points"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{margin:"0 0 15px 0",color:"#1976d2"},children:["Student Learning Score: ",W]}),d.jsxs("div",{style:{fontSize:"16px",color:"#666"},children:["= ",Ie.materials||0," (Materials) "," ",(1+(Ie.research||0)*.15).toFixed(2)," ","(Research)",parseFloat(localStorage.getItem("engagementInterest")||"0")>0&&` + ${parseFloat(localStorage.getItem("engagementInterest")||"0").toFixed(2)} (Interest)`]}),K>0&&d.jsxs("div",{style:{marginTop:"10px",fontSize:"16px",color:"#1976d2"},children:["+ ",K," Checkpoint Bonus"]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Total Time"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[q,"m ",B,"s"]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Student Learning"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:W})]})]}),(te===2||K>0)&&d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Checkpoint Bonus"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:["+",K]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Tasks Completed"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:y})]})]}),d.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:"Teaching Performance by Category"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f0f8f0",padding:"15px",borderRadius:"6px",border:"2px solid #4CAF5020"},children:[d.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",marginBottom:"5px"},children:" Materials"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ie.materials||0}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Base points"})]}),d.jsxs("div",{style:{background:"#f8f0ff",padding:"15px",borderRadius:"6px",border:"2px solid #9C27B020"},children:[d.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold",marginBottom:"5px"},children:" Research"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ie.research||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(Ie.research||0)*15,"% to future materials"]})]}),d.jsxs("div",{style:{background:"#fff0f0",padding:"15px",borderRadius:"6px",border:"2px solid #f4433620"},children:[d.jsx("div",{style:{color:"#f44336",fontWeight:"bold",marginBottom:"5px"},children:" Engagement"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ie.engagement||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",((Ie.engagement||0)*.15).toFixed(1),"% interest/task"]})]})]})]}),te===2&&Ie.bonus>0&&d.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[d.jsxs("strong",{style:{color:"#856404"},children:[" Exam Season Bonus:"," "]}),d.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#856404"},children:["+",Ie.bonus," points"]})]}),Re.length>0&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"15px"},children:"Progress Over Semesters"}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px"},children:[...Re,$e].map((ft,Dt)=>d.jsxs("div",{style:{padding:"10px",background:Dt===Re.length?"#e3f2fd":"white",borderRadius:"6px",border:"1px solid #e0e0e0",textAlign:"center"},children:[d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Semester ",Dt+1]}),d.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:ft.finalScore})]},Dt))})]}),d.jsx("div",{style:{marginTop:"30px",textAlign:"center"},children:Qe?d.jsxs("div",{style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h3",{style:{color:"#856404",marginBottom:"10px"},children:" All semesters complete!"}),d.jsx("p",{style:{color:"#856404",marginBottom:"0"},children:"Return to the Qualtrics survey and enter your completion code to finish the study."})]}):d.jsxs("button",{onClick:ut,style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",te+1," "]})})]})}if(n==="allocation")return d.jsx(TI,{onStart:ks,totalTasks:it.totalTasks,orderStrategy:it.taskOrderStrategy,durationMinutes:it.semesterDuration,difficultyMode:it.difficultyMode});if(n==="bonus_round")return d.jsx(CI,{timeRemaining:rt,onSelectTask:q=>{const B=[...Yt,q];Bn(B);const W=Object.keys(p).filter(ue=>ue.startsWith(q)).length,K=`${q}t${W+1}`;r("challenge"),ki(K,!0)},onFinishEarly:()=>mr("finished_early")});const ua=q=>{it.jarRefillFreezeTime>0?(he(!0),C(`Refilling ${q==="g1"?"Research":q==="g2"?"Materials":"Engagement"} Jar...`),setTimeout(()=>{he(!1),C(""),ca(q,3)},it.jarRefillFreezeTime*1e3)):ca(q,3)},ca=(q,B)=>{const W=[];for(let K=0;K<B;K++){const ue=Math.floor(Math.random()*20)+1;W.push(`${q}t${ue}`)}Bn(K=>[...K,...W])};if(n==="challenge"||n==="bonus_round")return d.jsxs("div",{className:"app",children:[fe&&d.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"24px",flexDirection:"column",gap:"20px"},children:[d.jsx("div",{style:{fontSize:"48px"},children:""}),d.jsx("div",{children:S}),d.jsx("div",{style:{fontSize:"16px",opacity:.8},children:"Please wait..."})]}),d.jsx(II,{currentTaskIndex:Un,totalTasks:Yt.length,taskQueue:Yt,onSwitchTask:Ai,onRefill:ua,allocationCounts:oa,points:Math.round(xi),timeRemaining:rt,onTimeUp:()=>mr("time_up"),chatInterface:d.jsx(vI,{messages:chatMessages,onSendMessage:handleSendMessage,isAiTyping,isOpen:isChatOpen,onToggle:()=>setIsChatOpen(!isChatOpen),unreadCount,aiDelay:it.aiDelay}),children:la()})]})}i0(document.getElementById("root")).render(d.jsx(D.StrictMode,{children:d.jsx(kI,{})}));
//# sourceMappingURL=index-Cj8Q_fkL.js.map
