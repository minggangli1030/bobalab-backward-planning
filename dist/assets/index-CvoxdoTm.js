(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var nm={exports:{}},su={},rm={exports:{}},ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ha=Symbol.for("react.element"),rx=Symbol.for("react.portal"),sx=Symbol.for("react.fragment"),ix=Symbol.for("react.strict_mode"),ox=Symbol.for("react.profiler"),ax=Symbol.for("react.provider"),lx=Symbol.for("react.context"),ux=Symbol.for("react.forward_ref"),cx=Symbol.for("react.suspense"),dx=Symbol.for("react.memo"),hx=Symbol.for("react.lazy"),qf=Symbol.iterator;function fx(t){return t===null||typeof t!="object"?null:(t=qf&&t[qf]||t["@@iterator"],typeof t=="function"?t:null)}var sm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},im=Object.assign,om={};function Vi(t,e,n){this.props=t,this.context=e,this.refs=om,this.updater=n||sm}Vi.prototype.isReactComponent={};Vi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Vi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function am(){}am.prototype=Vi.prototype;function Hd(t,e,n){this.props=t,this.context=e,this.refs=om,this.updater=n||sm}var qd=Hd.prototype=new am;qd.constructor=Hd;im(qd,Vi.prototype);qd.isPureReactComponent=!0;var Gf=Array.isArray,lm=Object.prototype.hasOwnProperty,Gd={current:null},um={key:!0,ref:!0,__self:!0,__source:!0};function cm(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)lm.call(e,r)&&!um.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),h=0;h<l;h++)c[h]=arguments[h+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ha,type:t,key:i,ref:a,props:s,_owner:Gd.current}}function px(t,e){return{$$typeof:ha,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Qd(t){return typeof t=="object"&&t!==null&&t.$$typeof===ha}function gx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Qf=/\/+/g;function $u(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gx(""+t.key):e.toString(36)}function il(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case ha:case rx:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+$u(a,0):r,Gf(s)?(n="",t!=null&&(n=t.replace(Qf,"$&/")+"/"),il(s,e,n,"",function(h){return h})):s!=null&&(Qd(s)&&(s=px(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Qf,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",Gf(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+$u(i,l);a+=il(i,e,n,c,s)}else if(c=fx(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+$u(i,l++),a+=il(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Fa(t,e,n){if(t==null)return t;var r=[],s=0;return il(t,r,"","",function(i){return e.call(n,i,s++)}),r}function mx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var $t={current:null},ol={transition:null},yx={ReactCurrentDispatcher:$t,ReactCurrentBatchConfig:ol,ReactCurrentOwner:Gd};function dm(){throw Error("act(...) is not supported in production builds of React.")}ye.Children={map:Fa,forEach:function(t,e,n){Fa(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Fa(t,function(){e++}),e},toArray:function(t){return Fa(t,function(e){return e})||[]},only:function(t){if(!Qd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ye.Component=Vi;ye.Fragment=sx;ye.Profiler=ox;ye.PureComponent=Hd;ye.StrictMode=ix;ye.Suspense=cx;ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yx;ye.act=dm;ye.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=im({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Gd.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)lm.call(e,c)&&!um.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var h=0;h<c;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:ha,type:t.type,key:s,ref:i,props:r,_owner:a}};ye.createContext=function(t){return t={$$typeof:lx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ax,_context:t},t.Consumer=t};ye.createElement=cm;ye.createFactory=function(t){var e=cm.bind(null,t);return e.type=t,e};ye.createRef=function(){return{current:null}};ye.forwardRef=function(t){return{$$typeof:ux,render:t}};ye.isValidElement=Qd;ye.lazy=function(t){return{$$typeof:hx,_payload:{_status:-1,_result:t},_init:mx}};ye.memo=function(t,e){return{$$typeof:dx,type:t,compare:e===void 0?null:e}};ye.startTransition=function(t){var e=ol.transition;ol.transition={};try{t()}finally{ol.transition=e}};ye.unstable_act=dm;ye.useCallback=function(t,e){return $t.current.useCallback(t,e)};ye.useContext=function(t){return $t.current.useContext(t)};ye.useDebugValue=function(){};ye.useDeferredValue=function(t){return $t.current.useDeferredValue(t)};ye.useEffect=function(t,e){return $t.current.useEffect(t,e)};ye.useId=function(){return $t.current.useId()};ye.useImperativeHandle=function(t,e,n){return $t.current.useImperativeHandle(t,e,n)};ye.useInsertionEffect=function(t,e){return $t.current.useInsertionEffect(t,e)};ye.useLayoutEffect=function(t,e){return $t.current.useLayoutEffect(t,e)};ye.useMemo=function(t,e){return $t.current.useMemo(t,e)};ye.useReducer=function(t,e,n){return $t.current.useReducer(t,e,n)};ye.useRef=function(t){return $t.current.useRef(t)};ye.useState=function(t){return $t.current.useState(t)};ye.useSyncExternalStore=function(t,e,n){return $t.current.useSyncExternalStore(t,e,n)};ye.useTransition=function(){return $t.current.useTransition()};ye.version="18.3.1";rm.exports=ye;var N=rm.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vx=N,xx=Symbol.for("react.element"),_x=Symbol.for("react.fragment"),wx=Object.prototype.hasOwnProperty,Sx=vx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ex={key:!0,ref:!0,__self:!0,__source:!0};function hm(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)wx.call(e,r)&&!Ex.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:xx,type:t,key:i,ref:a,props:s,_owner:Sx.current}}su.Fragment=_x;su.jsx=hm;su.jsxs=hm;nm.exports=su;var u=nm.exports,fm={exports:{}},cn={},pm={exports:{}},gm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(b,j){var V=b.length;b.push(j);e:for(;0<V;){var L=V-1>>>1,X=b[L];if(0<s(X,j))b[L]=j,b[V]=X,V=L;else break e}}function n(b){return b.length===0?null:b[0]}function r(b){if(b.length===0)return null;var j=b[0],V=b.pop();if(V!==j){b[0]=V;e:for(var L=0,X=b.length,q=X>>>1;L<q;){var ne=2*(L+1)-1,oe=b[ne],ve=ne+1,ge=b[ve];if(0>s(oe,V))ve<X&&0>s(ge,oe)?(b[L]=ge,b[ve]=V,L=ve):(b[L]=oe,b[ne]=V,L=ne);else if(ve<X&&0>s(ge,V))b[L]=ge,b[ve]=V,L=ve;else break e}}return j}function s(b,j){var V=b.sortIndex-j.sortIndex;return V!==0?V:b.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],h=[],p=1,m=null,y=3,I=!1,A=!1,P=!1,O=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(b){for(var j=n(h);j!==null;){if(j.callback===null)r(h);else if(j.startTime<=b)r(h),j.sortIndex=j.expirationTime,e(c,j);else break;j=n(h)}}function M(b){if(P=!1,T(b),!A)if(n(c)!==null)A=!0,ce($);else{var j=n(h);j!==null&&U(M,j.startTime-b)}}function $(b,j){A=!1,P&&(P=!1,k(g),g=-1),I=!0;var V=y;try{for(T(j),m=n(c);m!==null&&(!(m.expirationTime>j)||b&&!v());){var L=m.callback;if(typeof L=="function"){m.callback=null,y=m.priorityLevel;var X=L(m.expirationTime<=j);j=t.unstable_now(),typeof X=="function"?m.callback=X:m===n(c)&&r(c),T(j)}else r(c);m=n(c)}if(m!==null)var q=!0;else{var ne=n(h);ne!==null&&U(M,ne.startTime-j),q=!1}return q}finally{m=null,y=V,I=!1}}var B=!1,S=null,g=-1,w=5,C=-1;function v(){return!(t.unstable_now()-C<w)}function R(){if(S!==null){var b=t.unstable_now();C=b;var j=!0;try{j=S(!0,b)}finally{j?_():(B=!1,S=null)}}else B=!1}var _;if(typeof E=="function")_=function(){E(R)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,Z=ee.port2;ee.port1.onmessage=R,_=function(){Z.postMessage(null)}}else _=function(){O(R,0)};function ce(b){S=b,B||(B=!0,_())}function U(b,j){g=O(function(){b(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(b){b.callback=null},t.unstable_continueExecution=function(){A||I||(A=!0,ce($))},t.unstable_forceFrameRate=function(b){0>b||125<b?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<b?Math.floor(1e3/b):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(b){switch(y){case 1:case 2:case 3:var j=3;break;default:j=y}var V=y;y=j;try{return b()}finally{y=V}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(b,j){switch(b){case 1:case 2:case 3:case 4:case 5:break;default:b=3}var V=y;y=b;try{return j()}finally{y=V}},t.unstable_scheduleCallback=function(b,j,V){var L=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?L+V:L):V=L,b){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=V+X,b={id:p++,callback:j,priorityLevel:b,startTime:V,expirationTime:X,sortIndex:-1},V>L?(b.sortIndex=V,e(h,b),n(c)===null&&b===n(h)&&(P?(k(g),g=-1):P=!0,U(M,V-L))):(b.sortIndex=X,e(c,b),A||I||(A=!0,ce($))),b},t.unstable_shouldYield=v,t.unstable_wrapCallback=function(b){var j=y;return function(){var V=y;y=j;try{return b.apply(this,arguments)}finally{y=V}}}})(gm);pm.exports=gm;var Tx=pm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ix=N,un=Tx;function Y(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mm=new Set,Oo={};function Vs(t,e){Si(t,e),Si(t+"Capture",e)}function Si(t,e){for(Oo[t]=e,t=0;t<e.length;t++)mm.add(e[t])}var fr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ac=Object.prototype.hasOwnProperty,Cx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Kf={},Yf={};function Ax(t){return Ac.call(Yf,t)?!0:Ac.call(Kf,t)?!1:Cx.test(t)?Yf[t]=!0:(Kf[t]=!0,!1)}function kx(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Rx(t,e,n,r){if(e===null||typeof e>"u"||kx(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Wt(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Tt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tt[t]=new Wt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tt[e]=new Wt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tt[t]=new Wt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tt[t]=new Wt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tt[t]=new Wt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tt[t]=new Wt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tt[t]=new Wt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tt[t]=new Wt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tt[t]=new Wt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Kd=/[\-:]([a-z])/g;function Yd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Kd,Yd);Tt[e]=new Wt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Kd,Yd);Tt[e]=new Wt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Kd,Yd);Tt[e]=new Wt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tt[t]=new Wt(t,1,!1,t.toLowerCase(),null,!1,!1)});Tt.xlinkHref=new Wt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tt[t]=new Wt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Xd(t,e,n,r){var s=Tt.hasOwnProperty(e)?Tt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Rx(e,n,s,r)&&(n=null),r||s===null?Ax(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var wr=Ix.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oa=Symbol.for("react.element"),ni=Symbol.for("react.portal"),ri=Symbol.for("react.fragment"),Jd=Symbol.for("react.strict_mode"),kc=Symbol.for("react.profiler"),ym=Symbol.for("react.provider"),vm=Symbol.for("react.context"),Zd=Symbol.for("react.forward_ref"),Rc=Symbol.for("react.suspense"),Pc=Symbol.for("react.suspense_list"),eh=Symbol.for("react.memo"),Pr=Symbol.for("react.lazy"),xm=Symbol.for("react.offscreen"),Xf=Symbol.iterator;function lo(t){return t===null||typeof t!="object"?null:(t=Xf&&t[Xf]||t["@@iterator"],typeof t=="function"?t:null)}var qe=Object.assign,Wu;function vo(t){if(Wu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Wu=e&&e[1]||""}return`
`+Wu+t}var Hu=!1;function qu(t,e){if(!t||Hu)return"";Hu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=l);break}}}finally{Hu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?vo(t):""}function Px(t){switch(t.tag){case 5:return vo(t.type);case 16:return vo("Lazy");case 13:return vo("Suspense");case 19:return vo("SuspenseList");case 0:case 2:case 15:return t=qu(t.type,!1),t;case 11:return t=qu(t.type.render,!1),t;case 1:return t=qu(t.type,!0),t;default:return""}}function bc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ri:return"Fragment";case ni:return"Portal";case kc:return"Profiler";case Jd:return"StrictMode";case Rc:return"Suspense";case Pc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case vm:return(t.displayName||"Context")+".Consumer";case ym:return(t._context.displayName||"Context")+".Provider";case Zd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case eh:return e=t.displayName||null,e!==null?e:bc(t.type)||"Memo";case Pr:e=t._payload,t=t._init;try{return bc(t(e))}catch{}}return null}function bx(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return bc(e);case 8:return e===Jd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Kr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _m(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function jx(t){var e=_m(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function za(t){t._valueTracker||(t._valueTracker=jx(t))}function wm(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_m(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function El(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function jc(t,e){var n=e.checked;return qe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Jf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Kr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Sm(t,e){e=e.checked,e!=null&&Xd(t,"checked",e,!1)}function Dc(t,e){Sm(t,e);var n=Kr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Nc(t,e.type,n):e.hasOwnProperty("defaultValue")&&Nc(t,e.type,Kr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Zf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Nc(t,e,n){(e!=="number"||El(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var xo=Array.isArray;function pi(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Kr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Mc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Y(91));return qe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ep(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Y(92));if(xo(n)){if(1<n.length)throw Error(Y(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Kr(n)}}function Em(t,e){var n=Kr(e.value),r=Kr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function tp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Tm(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Tm(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ba,Im=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ba=Ba||document.createElement("div"),Ba.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ba.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Co={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dx=["Webkit","ms","Moz","O"];Object.keys(Co).forEach(function(t){Dx.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Co[e]=Co[t]})});function Cm(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Co.hasOwnProperty(t)&&Co[t]?(""+e).trim():e+"px"}function Am(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Cm(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Nx=qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lc(t,e){if(e){if(Nx[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Y(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Y(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Y(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Y(62))}}function Fc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Oc=null;function th(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var zc=null,gi=null,mi=null;function np(t){if(t=ga(t)){if(typeof zc!="function")throw Error(Y(280));var e=t.stateNode;e&&(e=uu(e),zc(t.stateNode,t.type,e))}}function km(t){gi?mi?mi.push(t):mi=[t]:gi=t}function Rm(){if(gi){var t=gi,e=mi;if(mi=gi=null,np(t),e)for(t=0;t<e.length;t++)np(e[t])}}function Pm(t,e){return t(e)}function bm(){}var Gu=!1;function jm(t,e,n){if(Gu)return t(e,n);Gu=!0;try{return Pm(t,e,n)}finally{Gu=!1,(gi!==null||mi!==null)&&(bm(),Rm())}}function Bo(t,e){var n=t.stateNode;if(n===null)return null;var r=uu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Y(231,e,typeof n));return n}var Bc=!1;if(fr)try{var uo={};Object.defineProperty(uo,"passive",{get:function(){Bc=!0}}),window.addEventListener("test",uo,uo),window.removeEventListener("test",uo,uo)}catch{Bc=!1}function Mx(t,e,n,r,s,i,a,l,c){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var Ao=!1,Tl=null,Il=!1,Uc=null,Vx={onError:function(t){Ao=!0,Tl=t}};function Lx(t,e,n,r,s,i,a,l,c){Ao=!1,Tl=null,Mx.apply(Vx,arguments)}function Fx(t,e,n,r,s,i,a,l,c){if(Lx.apply(this,arguments),Ao){if(Ao){var h=Tl;Ao=!1,Tl=null}else throw Error(Y(198));Il||(Il=!0,Uc=h)}}function Ls(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Dm(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function rp(t){if(Ls(t)!==t)throw Error(Y(188))}function Ox(t){var e=t.alternate;if(!e){if(e=Ls(t),e===null)throw Error(Y(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return rp(s),t;if(i===r)return rp(s),e;i=i.sibling}throw Error(Y(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(Y(189))}}if(n.alternate!==r)throw Error(Y(190))}if(n.tag!==3)throw Error(Y(188));return n.stateNode.current===n?t:e}function Nm(t){return t=Ox(t),t!==null?Mm(t):null}function Mm(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Mm(t);if(e!==null)return e;t=t.sibling}return null}var Vm=un.unstable_scheduleCallback,sp=un.unstable_cancelCallback,zx=un.unstable_shouldYield,Bx=un.unstable_requestPaint,tt=un.unstable_now,Ux=un.unstable_getCurrentPriorityLevel,nh=un.unstable_ImmediatePriority,Lm=un.unstable_UserBlockingPriority,Cl=un.unstable_NormalPriority,$x=un.unstable_LowPriority,Fm=un.unstable_IdlePriority,iu=null,Yn=null;function Wx(t){if(Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(iu,t,void 0,(t.current.flags&128)===128)}catch{}}var Ln=Math.clz32?Math.clz32:Gx,Hx=Math.log,qx=Math.LN2;function Gx(t){return t>>>=0,t===0?32:31-(Hx(t)/qx|0)|0}var Ua=64,$a=4194304;function _o(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Al(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=_o(l):(i&=a,i!==0&&(r=_o(i)))}else a=n&~s,a!==0?r=_o(a):i!==0&&(r=_o(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ln(e),s=1<<n,r|=t[n],e&=~s;return r}function Qx(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kx(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Ln(i),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=Qx(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function $c(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Om(){var t=Ua;return Ua<<=1,!(Ua&4194240)&&(Ua=64),t}function Qu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function fa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ln(e),t[e]=n}function Yx(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Ln(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function rh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ln(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var je=0;function zm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Bm,sh,Um,$m,Wm,Wc=!1,Wa=[],Lr=null,Fr=null,Or=null,Uo=new Map,$o=new Map,jr=[],Xx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ip(t,e){switch(t){case"focusin":case"focusout":Lr=null;break;case"dragenter":case"dragleave":Fr=null;break;case"mouseover":case"mouseout":Or=null;break;case"pointerover":case"pointerout":Uo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$o.delete(e.pointerId)}}function co(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=ga(e),e!==null&&sh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Jx(t,e,n,r,s){switch(e){case"focusin":return Lr=co(Lr,t,e,n,r,s),!0;case"dragenter":return Fr=co(Fr,t,e,n,r,s),!0;case"mouseover":return Or=co(Or,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Uo.set(i,co(Uo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,$o.set(i,co($o.get(i)||null,t,e,n,r,s)),!0}return!1}function Hm(t){var e=ws(t.target);if(e!==null){var n=Ls(e);if(n!==null){if(e=n.tag,e===13){if(e=Dm(n),e!==null){t.blockedOn=e,Wm(t.priority,function(){Um(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function al(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Hc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Oc=r,n.target.dispatchEvent(r),Oc=null}else return e=ga(n),e!==null&&sh(e),t.blockedOn=n,!1;e.shift()}return!0}function op(t,e,n){al(t)&&n.delete(e)}function Zx(){Wc=!1,Lr!==null&&al(Lr)&&(Lr=null),Fr!==null&&al(Fr)&&(Fr=null),Or!==null&&al(Or)&&(Or=null),Uo.forEach(op),$o.forEach(op)}function ho(t,e){t.blockedOn===e&&(t.blockedOn=null,Wc||(Wc=!0,un.unstable_scheduleCallback(un.unstable_NormalPriority,Zx)))}function Wo(t){function e(s){return ho(s,t)}if(0<Wa.length){ho(Wa[0],t);for(var n=1;n<Wa.length;n++){var r=Wa[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Lr!==null&&ho(Lr,t),Fr!==null&&ho(Fr,t),Or!==null&&ho(Or,t),Uo.forEach(e),$o.forEach(e),n=0;n<jr.length;n++)r=jr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<jr.length&&(n=jr[0],n.blockedOn===null);)Hm(n),n.blockedOn===null&&jr.shift()}var yi=wr.ReactCurrentBatchConfig,kl=!0;function e1(t,e,n,r){var s=je,i=yi.transition;yi.transition=null;try{je=1,ih(t,e,n,r)}finally{je=s,yi.transition=i}}function t1(t,e,n,r){var s=je,i=yi.transition;yi.transition=null;try{je=4,ih(t,e,n,r)}finally{je=s,yi.transition=i}}function ih(t,e,n,r){if(kl){var s=Hc(t,e,n,r);if(s===null)sc(t,e,r,Rl,n),ip(t,r);else if(Jx(s,t,e,n,r))r.stopPropagation();else if(ip(t,r),e&4&&-1<Xx.indexOf(t)){for(;s!==null;){var i=ga(s);if(i!==null&&Bm(i),i=Hc(t,e,n,r),i===null&&sc(t,e,r,Rl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else sc(t,e,r,null,n)}}var Rl=null;function Hc(t,e,n,r){if(Rl=null,t=th(r),t=ws(t),t!==null)if(e=Ls(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Dm(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Rl=t,null}function qm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ux()){case nh:return 1;case Lm:return 4;case Cl:case $x:return 16;case Fm:return 536870912;default:return 16}default:return 16}}var Nr=null,oh=null,ll=null;function Gm(){if(ll)return ll;var t,e=oh,n=e.length,r,s="value"in Nr?Nr.value:Nr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return ll=s.slice(t,1<r?1-r:void 0)}function ul(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ha(){return!0}function ap(){return!1}function dn(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ha:ap,this.isPropagationStopped=ap,this}return qe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ha)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ha)},persist:function(){},isPersistent:Ha}),e}var Li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ah=dn(Li),pa=qe({},Li,{view:0,detail:0}),n1=dn(pa),Ku,Yu,fo,ou=qe({},pa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==fo&&(fo&&t.type==="mousemove"?(Ku=t.screenX-fo.screenX,Yu=t.screenY-fo.screenY):Yu=Ku=0,fo=t),Ku)},movementY:function(t){return"movementY"in t?t.movementY:Yu}}),lp=dn(ou),r1=qe({},ou,{dataTransfer:0}),s1=dn(r1),i1=qe({},pa,{relatedTarget:0}),Xu=dn(i1),o1=qe({},Li,{animationName:0,elapsedTime:0,pseudoElement:0}),a1=dn(o1),l1=qe({},Li,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),u1=dn(l1),c1=qe({},Li,{data:0}),up=dn(c1),d1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},h1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},f1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function p1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=f1[t])?!!e[t]:!1}function lh(){return p1}var g1=qe({},pa,{key:function(t){if(t.key){var e=d1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ul(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?h1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lh,charCode:function(t){return t.type==="keypress"?ul(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ul(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),m1=dn(g1),y1=qe({},ou,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cp=dn(y1),v1=qe({},pa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lh}),x1=dn(v1),_1=qe({},Li,{propertyName:0,elapsedTime:0,pseudoElement:0}),w1=dn(_1),S1=qe({},ou,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),E1=dn(S1),T1=[9,13,27,32],uh=fr&&"CompositionEvent"in window,ko=null;fr&&"documentMode"in document&&(ko=document.documentMode);var I1=fr&&"TextEvent"in window&&!ko,Qm=fr&&(!uh||ko&&8<ko&&11>=ko),dp=" ",hp=!1;function Km(t,e){switch(t){case"keyup":return T1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ym(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var si=!1;function C1(t,e){switch(t){case"compositionend":return Ym(e);case"keypress":return e.which!==32?null:(hp=!0,dp);case"textInput":return t=e.data,t===dp&&hp?null:t;default:return null}}function A1(t,e){if(si)return t==="compositionend"||!uh&&Km(t,e)?(t=Gm(),ll=oh=Nr=null,si=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Qm&&e.locale!=="ko"?null:e.data;default:return null}}var k1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!k1[t.type]:e==="textarea"}function Xm(t,e,n,r){km(r),e=Pl(e,"onChange"),0<e.length&&(n=new ah("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ro=null,Ho=null;function R1(t){ly(t,0)}function au(t){var e=ai(t);if(wm(e))return t}function P1(t,e){if(t==="change")return e}var Jm=!1;if(fr){var Ju;if(fr){var Zu="oninput"in document;if(!Zu){var pp=document.createElement("div");pp.setAttribute("oninput","return;"),Zu=typeof pp.oninput=="function"}Ju=Zu}else Ju=!1;Jm=Ju&&(!document.documentMode||9<document.documentMode)}function gp(){Ro&&(Ro.detachEvent("onpropertychange",Zm),Ho=Ro=null)}function Zm(t){if(t.propertyName==="value"&&au(Ho)){var e=[];Xm(e,Ho,t,th(t)),jm(R1,e)}}function b1(t,e,n){t==="focusin"?(gp(),Ro=e,Ho=n,Ro.attachEvent("onpropertychange",Zm)):t==="focusout"&&gp()}function j1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return au(Ho)}function D1(t,e){if(t==="click")return au(e)}function N1(t,e){if(t==="input"||t==="change")return au(e)}function M1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zn=typeof Object.is=="function"?Object.is:M1;function qo(t,e){if(zn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ac.call(e,s)||!zn(t[s],e[s]))return!1}return!0}function mp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function yp(t,e){var n=mp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=mp(n)}}function ey(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ey(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ty(){for(var t=window,e=El();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=El(t.document)}return e}function ch(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function V1(t){var e=ty(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&ey(n.ownerDocument.documentElement,n)){if(r!==null&&ch(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=yp(n,i);var a=yp(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var L1=fr&&"documentMode"in document&&11>=document.documentMode,ii=null,qc=null,Po=null,Gc=!1;function vp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Gc||ii==null||ii!==El(r)||(r=ii,"selectionStart"in r&&ch(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Po&&qo(Po,r)||(Po=r,r=Pl(qc,"onSelect"),0<r.length&&(e=new ah("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ii)))}function qa(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var oi={animationend:qa("Animation","AnimationEnd"),animationiteration:qa("Animation","AnimationIteration"),animationstart:qa("Animation","AnimationStart"),transitionend:qa("Transition","TransitionEnd")},ec={},ny={};fr&&(ny=document.createElement("div").style,"AnimationEvent"in window||(delete oi.animationend.animation,delete oi.animationiteration.animation,delete oi.animationstart.animation),"TransitionEvent"in window||delete oi.transitionend.transition);function lu(t){if(ec[t])return ec[t];if(!oi[t])return t;var e=oi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in ny)return ec[t]=e[n];return t}var ry=lu("animationend"),sy=lu("animationiteration"),iy=lu("animationstart"),oy=lu("transitionend"),ay=new Map,xp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function es(t,e){ay.set(t,e),Vs(e,[t])}for(var tc=0;tc<xp.length;tc++){var nc=xp[tc],F1=nc.toLowerCase(),O1=nc[0].toUpperCase()+nc.slice(1);es(F1,"on"+O1)}es(ry,"onAnimationEnd");es(sy,"onAnimationIteration");es(iy,"onAnimationStart");es("dblclick","onDoubleClick");es("focusin","onFocus");es("focusout","onBlur");es(oy,"onTransitionEnd");Si("onMouseEnter",["mouseout","mouseover"]);Si("onMouseLeave",["mouseout","mouseover"]);Si("onPointerEnter",["pointerout","pointerover"]);Si("onPointerLeave",["pointerout","pointerover"]);Vs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),z1=new Set("cancel close invalid load scroll toggle".split(" ").concat(wo));function _p(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Fx(r,e,void 0,t),t.currentTarget=null}function ly(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,h=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;_p(s,l,h),i=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,h=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;_p(s,l,h),i=c}}}if(Il)throw t=Uc,Il=!1,Uc=null,t}function Oe(t,e){var n=e[Jc];n===void 0&&(n=e[Jc]=new Set);var r=t+"__bubble";n.has(r)||(uy(e,t,2,!1),n.add(r))}function rc(t,e,n){var r=0;e&&(r|=4),uy(n,t,r,e)}var Ga="_reactListening"+Math.random().toString(36).slice(2);function Go(t){if(!t[Ga]){t[Ga]=!0,mm.forEach(function(n){n!=="selectionchange"&&(z1.has(n)||rc(n,!1,t),rc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ga]||(e[Ga]=!0,rc("selectionchange",!1,e))}}function uy(t,e,n,r){switch(qm(e)){case 1:var s=e1;break;case 4:s=t1;break;default:s=ih}n=s.bind(null,e,n,t),s=void 0,!Bc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function sc(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=ws(l),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}l=l.parentNode}}r=r.return}jm(function(){var h=i,p=th(n),m=[];e:{var y=ay.get(t);if(y!==void 0){var I=ah,A=t;switch(t){case"keypress":if(ul(n)===0)break e;case"keydown":case"keyup":I=m1;break;case"focusin":A="focus",I=Xu;break;case"focusout":A="blur",I=Xu;break;case"beforeblur":case"afterblur":I=Xu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=lp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=s1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=x1;break;case ry:case sy:case iy:I=a1;break;case oy:I=w1;break;case"scroll":I=n1;break;case"wheel":I=E1;break;case"copy":case"cut":case"paste":I=u1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=cp}var P=(e&4)!==0,O=!P&&t==="scroll",k=P?y!==null?y+"Capture":null:y;P=[];for(var E=h,T;E!==null;){T=E;var M=T.stateNode;if(T.tag===5&&M!==null&&(T=M,k!==null&&(M=Bo(E,k),M!=null&&P.push(Qo(E,M,T)))),O)break;E=E.return}0<P.length&&(y=new I(y,A,null,n,p),m.push({event:y,listeners:P}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",y&&n!==Oc&&(A=n.relatedTarget||n.fromElement)&&(ws(A)||A[pr]))break e;if((I||y)&&(y=p.window===p?p:(y=p.ownerDocument)?y.defaultView||y.parentWindow:window,I?(A=n.relatedTarget||n.toElement,I=h,A=A?ws(A):null,A!==null&&(O=Ls(A),A!==O||A.tag!==5&&A.tag!==6)&&(A=null)):(I=null,A=h),I!==A)){if(P=lp,M="onMouseLeave",k="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(P=cp,M="onPointerLeave",k="onPointerEnter",E="pointer"),O=I==null?y:ai(I),T=A==null?y:ai(A),y=new P(M,E+"leave",I,n,p),y.target=O,y.relatedTarget=T,M=null,ws(p)===h&&(P=new P(k,E+"enter",A,n,p),P.target=T,P.relatedTarget=O,M=P),O=M,I&&A)t:{for(P=I,k=A,E=0,T=P;T;T=Js(T))E++;for(T=0,M=k;M;M=Js(M))T++;for(;0<E-T;)P=Js(P),E--;for(;0<T-E;)k=Js(k),T--;for(;E--;){if(P===k||k!==null&&P===k.alternate)break t;P=Js(P),k=Js(k)}P=null}else P=null;I!==null&&wp(m,y,I,P,!1),A!==null&&O!==null&&wp(m,O,A,P,!0)}}e:{if(y=h?ai(h):window,I=y.nodeName&&y.nodeName.toLowerCase(),I==="select"||I==="input"&&y.type==="file")var $=P1;else if(fp(y))if(Jm)$=N1;else{$=j1;var B=b1}else(I=y.nodeName)&&I.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&($=D1);if($&&($=$(t,h))){Xm(m,$,n,p);break e}B&&B(t,y,h),t==="focusout"&&(B=y._wrapperState)&&B.controlled&&y.type==="number"&&Nc(y,"number",y.value)}switch(B=h?ai(h):window,t){case"focusin":(fp(B)||B.contentEditable==="true")&&(ii=B,qc=h,Po=null);break;case"focusout":Po=qc=ii=null;break;case"mousedown":Gc=!0;break;case"contextmenu":case"mouseup":case"dragend":Gc=!1,vp(m,n,p);break;case"selectionchange":if(L1)break;case"keydown":case"keyup":vp(m,n,p)}var S;if(uh)e:{switch(t){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else si?Km(t,n)&&(g="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(g="onCompositionStart");g&&(Qm&&n.locale!=="ko"&&(si||g!=="onCompositionStart"?g==="onCompositionEnd"&&si&&(S=Gm()):(Nr=p,oh="value"in Nr?Nr.value:Nr.textContent,si=!0)),B=Pl(h,g),0<B.length&&(g=new up(g,t,null,n,p),m.push({event:g,listeners:B}),S?g.data=S:(S=Ym(n),S!==null&&(g.data=S)))),(S=I1?C1(t,n):A1(t,n))&&(h=Pl(h,"onBeforeInput"),0<h.length&&(p=new up("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:h}),p.data=S))}ly(m,e)})}function Qo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Pl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Bo(t,n),i!=null&&r.unshift(Qo(t,i,s)),i=Bo(t,e),i!=null&&r.push(Qo(t,i,s))),t=t.return}return r}function Js(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function wp(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,h=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&h!==null&&(l=h,s?(c=Bo(n,i),c!=null&&a.unshift(Qo(n,c,l))):s||(c=Bo(n,i),c!=null&&a.push(Qo(n,c,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var B1=/\r\n?/g,U1=/\u0000|\uFFFD/g;function Sp(t){return(typeof t=="string"?t:""+t).replace(B1,`
`).replace(U1,"")}function Qa(t,e,n){if(e=Sp(e),Sp(t)!==e&&n)throw Error(Y(425))}function bl(){}var Qc=null,Kc=null;function Yc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Xc=typeof setTimeout=="function"?setTimeout:void 0,$1=typeof clearTimeout=="function"?clearTimeout:void 0,Ep=typeof Promise=="function"?Promise:void 0,W1=typeof queueMicrotask=="function"?queueMicrotask:typeof Ep<"u"?function(t){return Ep.resolve(null).then(t).catch(H1)}:Xc;function H1(t){setTimeout(function(){throw t})}function ic(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Wo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Wo(e)}function zr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Tp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Fi=Math.random().toString(36).slice(2),Kn="__reactFiber$"+Fi,Ko="__reactProps$"+Fi,pr="__reactContainer$"+Fi,Jc="__reactEvents$"+Fi,q1="__reactListeners$"+Fi,G1="__reactHandles$"+Fi;function ws(t){var e=t[Kn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[pr]||n[Kn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Tp(t);t!==null;){if(n=t[Kn])return n;t=Tp(t)}return e}t=n,n=t.parentNode}return null}function ga(t){return t=t[Kn]||t[pr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ai(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Y(33))}function uu(t){return t[Ko]||null}var Zc=[],li=-1;function ts(t){return{current:t}}function Be(t){0>li||(t.current=Zc[li],Zc[li]=null,li--)}function Fe(t,e){li++,Zc[li]=t.current,t.current=e}var Yr={},Vt=ts(Yr),Jt=ts(!1),ks=Yr;function Ei(t,e){var n=t.type.contextTypes;if(!n)return Yr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Zt(t){return t=t.childContextTypes,t!=null}function jl(){Be(Jt),Be(Vt)}function Ip(t,e,n){if(Vt.current!==Yr)throw Error(Y(168));Fe(Vt,e),Fe(Jt,n)}function cy(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Y(108,bx(t)||"Unknown",s));return qe({},n,r)}function Dl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Yr,ks=Vt.current,Fe(Vt,t),Fe(Jt,Jt.current),!0}function Cp(t,e,n){var r=t.stateNode;if(!r)throw Error(Y(169));n?(t=cy(t,e,ks),r.__reactInternalMemoizedMergedChildContext=t,Be(Jt),Be(Vt),Fe(Vt,t)):Be(Jt),Fe(Jt,n)}var ar=null,cu=!1,oc=!1;function dy(t){ar===null?ar=[t]:ar.push(t)}function Q1(t){cu=!0,dy(t)}function ns(){if(!oc&&ar!==null){oc=!0;var t=0,e=je;try{var n=ar;for(je=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ar=null,cu=!1}catch(s){throw ar!==null&&(ar=ar.slice(t+1)),Vm(nh,ns),s}finally{je=e,oc=!1}}return null}var ui=[],ci=0,Nl=null,Ml=0,yn=[],vn=0,Rs=null,ur=1,cr="";function vs(t,e){ui[ci++]=Ml,ui[ci++]=Nl,Nl=t,Ml=e}function hy(t,e,n){yn[vn++]=ur,yn[vn++]=cr,yn[vn++]=Rs,Rs=t;var r=ur;t=cr;var s=32-Ln(r)-1;r&=~(1<<s),n+=1;var i=32-Ln(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,ur=1<<32-Ln(e)+s|n<<s|r,cr=i+t}else ur=1<<i|n<<s|r,cr=t}function dh(t){t.return!==null&&(vs(t,1),hy(t,1,0))}function hh(t){for(;t===Nl;)Nl=ui[--ci],ui[ci]=null,Ml=ui[--ci],ui[ci]=null;for(;t===Rs;)Rs=yn[--vn],yn[vn]=null,cr=yn[--vn],yn[vn]=null,ur=yn[--vn],yn[vn]=null}var ln=null,on=null,$e=!1,Mn=null;function fy(t,e){var n=xn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ap(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ln=t,on=zr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ln=t,on=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Rs!==null?{id:ur,overflow:cr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=xn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ln=t,on=null,!0):!1;default:return!1}}function ed(t){return(t.mode&1)!==0&&(t.flags&128)===0}function td(t){if($e){var e=on;if(e){var n=e;if(!Ap(t,e)){if(ed(t))throw Error(Y(418));e=zr(n.nextSibling);var r=ln;e&&Ap(t,e)?fy(r,n):(t.flags=t.flags&-4097|2,$e=!1,ln=t)}}else{if(ed(t))throw Error(Y(418));t.flags=t.flags&-4097|2,$e=!1,ln=t}}}function kp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ln=t}function Ka(t){if(t!==ln)return!1;if(!$e)return kp(t),$e=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Yc(t.type,t.memoizedProps)),e&&(e=on)){if(ed(t))throw py(),Error(Y(418));for(;e;)fy(t,e),e=zr(e.nextSibling)}if(kp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Y(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){on=zr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}on=null}}else on=ln?zr(t.stateNode.nextSibling):null;return!0}function py(){for(var t=on;t;)t=zr(t.nextSibling)}function Ti(){on=ln=null,$e=!1}function fh(t){Mn===null?Mn=[t]:Mn.push(t)}var K1=wr.ReactCurrentBatchConfig;function po(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Y(309));var r=n.stateNode}if(!r)throw Error(Y(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(Y(284));if(!n._owner)throw Error(Y(290,t))}return t}function Ya(t,e){throw t=Object.prototype.toString.call(e),Error(Y(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Rp(t){var e=t._init;return e(t._payload)}function gy(t){function e(k,E){if(t){var T=k.deletions;T===null?(k.deletions=[E],k.flags|=16):T.push(E)}}function n(k,E){if(!t)return null;for(;E!==null;)e(k,E),E=E.sibling;return null}function r(k,E){for(k=new Map;E!==null;)E.key!==null?k.set(E.key,E):k.set(E.index,E),E=E.sibling;return k}function s(k,E){return k=Wr(k,E),k.index=0,k.sibling=null,k}function i(k,E,T){return k.index=T,t?(T=k.alternate,T!==null?(T=T.index,T<E?(k.flags|=2,E):T):(k.flags|=2,E)):(k.flags|=1048576,E)}function a(k){return t&&k.alternate===null&&(k.flags|=2),k}function l(k,E,T,M){return E===null||E.tag!==6?(E=fc(T,k.mode,M),E.return=k,E):(E=s(E,T),E.return=k,E)}function c(k,E,T,M){var $=T.type;return $===ri?p(k,E,T.props.children,M,T.key):E!==null&&(E.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Pr&&Rp($)===E.type)?(M=s(E,T.props),M.ref=po(k,E,T),M.return=k,M):(M=ml(T.type,T.key,T.props,null,k.mode,M),M.ref=po(k,E,T),M.return=k,M)}function h(k,E,T,M){return E===null||E.tag!==4||E.stateNode.containerInfo!==T.containerInfo||E.stateNode.implementation!==T.implementation?(E=pc(T,k.mode,M),E.return=k,E):(E=s(E,T.children||[]),E.return=k,E)}function p(k,E,T,M,$){return E===null||E.tag!==7?(E=Cs(T,k.mode,M,$),E.return=k,E):(E=s(E,T),E.return=k,E)}function m(k,E,T){if(typeof E=="string"&&E!==""||typeof E=="number")return E=fc(""+E,k.mode,T),E.return=k,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Oa:return T=ml(E.type,E.key,E.props,null,k.mode,T),T.ref=po(k,null,E),T.return=k,T;case ni:return E=pc(E,k.mode,T),E.return=k,E;case Pr:var M=E._init;return m(k,M(E._payload),T)}if(xo(E)||lo(E))return E=Cs(E,k.mode,T,null),E.return=k,E;Ya(k,E)}return null}function y(k,E,T,M){var $=E!==null?E.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return $!==null?null:l(k,E,""+T,M);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Oa:return T.key===$?c(k,E,T,M):null;case ni:return T.key===$?h(k,E,T,M):null;case Pr:return $=T._init,y(k,E,$(T._payload),M)}if(xo(T)||lo(T))return $!==null?null:p(k,E,T,M,null);Ya(k,T)}return null}function I(k,E,T,M,$){if(typeof M=="string"&&M!==""||typeof M=="number")return k=k.get(T)||null,l(E,k,""+M,$);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Oa:return k=k.get(M.key===null?T:M.key)||null,c(E,k,M,$);case ni:return k=k.get(M.key===null?T:M.key)||null,h(E,k,M,$);case Pr:var B=M._init;return I(k,E,T,B(M._payload),$)}if(xo(M)||lo(M))return k=k.get(T)||null,p(E,k,M,$,null);Ya(E,M)}return null}function A(k,E,T,M){for(var $=null,B=null,S=E,g=E=0,w=null;S!==null&&g<T.length;g++){S.index>g?(w=S,S=null):w=S.sibling;var C=y(k,S,T[g],M);if(C===null){S===null&&(S=w);break}t&&S&&C.alternate===null&&e(k,S),E=i(C,E,g),B===null?$=C:B.sibling=C,B=C,S=w}if(g===T.length)return n(k,S),$e&&vs(k,g),$;if(S===null){for(;g<T.length;g++)S=m(k,T[g],M),S!==null&&(E=i(S,E,g),B===null?$=S:B.sibling=S,B=S);return $e&&vs(k,g),$}for(S=r(k,S);g<T.length;g++)w=I(S,k,g,T[g],M),w!==null&&(t&&w.alternate!==null&&S.delete(w.key===null?g:w.key),E=i(w,E,g),B===null?$=w:B.sibling=w,B=w);return t&&S.forEach(function(v){return e(k,v)}),$e&&vs(k,g),$}function P(k,E,T,M){var $=lo(T);if(typeof $!="function")throw Error(Y(150));if(T=$.call(T),T==null)throw Error(Y(151));for(var B=$=null,S=E,g=E=0,w=null,C=T.next();S!==null&&!C.done;g++,C=T.next()){S.index>g?(w=S,S=null):w=S.sibling;var v=y(k,S,C.value,M);if(v===null){S===null&&(S=w);break}t&&S&&v.alternate===null&&e(k,S),E=i(v,E,g),B===null?$=v:B.sibling=v,B=v,S=w}if(C.done)return n(k,S),$e&&vs(k,g),$;if(S===null){for(;!C.done;g++,C=T.next())C=m(k,C.value,M),C!==null&&(E=i(C,E,g),B===null?$=C:B.sibling=C,B=C);return $e&&vs(k,g),$}for(S=r(k,S);!C.done;g++,C=T.next())C=I(S,k,g,C.value,M),C!==null&&(t&&C.alternate!==null&&S.delete(C.key===null?g:C.key),E=i(C,E,g),B===null?$=C:B.sibling=C,B=C);return t&&S.forEach(function(R){return e(k,R)}),$e&&vs(k,g),$}function O(k,E,T,M){if(typeof T=="object"&&T!==null&&T.type===ri&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Oa:e:{for(var $=T.key,B=E;B!==null;){if(B.key===$){if($=T.type,$===ri){if(B.tag===7){n(k,B.sibling),E=s(B,T.props.children),E.return=k,k=E;break e}}else if(B.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Pr&&Rp($)===B.type){n(k,B.sibling),E=s(B,T.props),E.ref=po(k,B,T),E.return=k,k=E;break e}n(k,B);break}else e(k,B);B=B.sibling}T.type===ri?(E=Cs(T.props.children,k.mode,M,T.key),E.return=k,k=E):(M=ml(T.type,T.key,T.props,null,k.mode,M),M.ref=po(k,E,T),M.return=k,k=M)}return a(k);case ni:e:{for(B=T.key;E!==null;){if(E.key===B)if(E.tag===4&&E.stateNode.containerInfo===T.containerInfo&&E.stateNode.implementation===T.implementation){n(k,E.sibling),E=s(E,T.children||[]),E.return=k,k=E;break e}else{n(k,E);break}else e(k,E);E=E.sibling}E=pc(T,k.mode,M),E.return=k,k=E}return a(k);case Pr:return B=T._init,O(k,E,B(T._payload),M)}if(xo(T))return A(k,E,T,M);if(lo(T))return P(k,E,T,M);Ya(k,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,E!==null&&E.tag===6?(n(k,E.sibling),E=s(E,T),E.return=k,k=E):(n(k,E),E=fc(T,k.mode,M),E.return=k,k=E),a(k)):n(k,E)}return O}var Ii=gy(!0),my=gy(!1),Vl=ts(null),Ll=null,di=null,ph=null;function gh(){ph=di=Ll=null}function mh(t){var e=Vl.current;Be(Vl),t._currentValue=e}function nd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function vi(t,e){Ll=t,ph=di=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Xt=!0),t.firstContext=null)}function wn(t){var e=t._currentValue;if(ph!==t)if(t={context:t,memoizedValue:e,next:null},di===null){if(Ll===null)throw Error(Y(308));di=t,Ll.dependencies={lanes:0,firstContext:t}}else di=di.next=t;return e}var Ss=null;function yh(t){Ss===null?Ss=[t]:Ss.push(t)}function yy(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,yh(e)):(n.next=s.next,s.next=n),e.interleaved=n,gr(t,r)}function gr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var br=!1;function vh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vy(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function dr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Br(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ke&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,gr(t,n)}return s=r.interleaved,s===null?(e.next=e,yh(r)):(e.next=s.next,s.next=e),r.interleaved=e,gr(t,n)}function cl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rh(t,n)}}function Pp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Fl(t,e,n,r){var s=t.updateQueue;br=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,h=c.next;c.next=null,a===null?i=h:a.next=h,a=c;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==a&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;a=0,p=h=c=null,l=i;do{var y=l.lane,I=l.eventTime;if((r&y)===y){p!==null&&(p=p.next={eventTime:I,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var A=t,P=l;switch(y=e,I=n,P.tag){case 1:if(A=P.payload,typeof A=="function"){m=A.call(I,m,y);break e}m=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=P.payload,y=typeof A=="function"?A.call(I,m,y):A,y==null)break e;m=qe({},m,y);break e;case 2:br=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[l]:y.push(l))}else I={eventTime:I,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=I,c=m):p=p.next=I,a|=y;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;y=l,l=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(p===null&&(c=m),s.baseState=c,s.firstBaseUpdate=h,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);bs|=a,t.lanes=a,t.memoizedState=m}}function bp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Y(191,s));s.call(r)}}}var ma={},Xn=ts(ma),Yo=ts(ma),Xo=ts(ma);function Es(t){if(t===ma)throw Error(Y(174));return t}function xh(t,e){switch(Fe(Xo,e),Fe(Yo,t),Fe(Xn,ma),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Vc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Vc(e,t)}Be(Xn),Fe(Xn,e)}function Ci(){Be(Xn),Be(Yo),Be(Xo)}function xy(t){Es(Xo.current);var e=Es(Xn.current),n=Vc(e,t.type);e!==n&&(Fe(Yo,t),Fe(Xn,n))}function _h(t){Yo.current===t&&(Be(Xn),Be(Yo))}var We=ts(0);function Ol(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ac=[];function wh(){for(var t=0;t<ac.length;t++)ac[t]._workInProgressVersionPrimary=null;ac.length=0}var dl=wr.ReactCurrentDispatcher,lc=wr.ReactCurrentBatchConfig,Ps=0,He=null,lt=null,ht=null,zl=!1,bo=!1,Jo=0,Y1=0;function Pt(){throw Error(Y(321))}function Sh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!zn(t[n],e[n]))return!1;return!0}function Eh(t,e,n,r,s,i){if(Ps=i,He=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,dl.current=t===null||t.memoizedState===null?e_:t_,t=n(r,s),bo){i=0;do{if(bo=!1,Jo=0,25<=i)throw Error(Y(301));i+=1,ht=lt=null,e.updateQueue=null,dl.current=n_,t=n(r,s)}while(bo)}if(dl.current=Bl,e=lt!==null&&lt.next!==null,Ps=0,ht=lt=He=null,zl=!1,e)throw Error(Y(300));return t}function Th(){var t=Jo!==0;return Jo=0,t}function Qn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?He.memoizedState=ht=t:ht=ht.next=t,ht}function Sn(){if(lt===null){var t=He.alternate;t=t!==null?t.memoizedState:null}else t=lt.next;var e=ht===null?He.memoizedState:ht.next;if(e!==null)ht=e,lt=t;else{if(t===null)throw Error(Y(310));lt=t,t={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},ht===null?He.memoizedState=ht=t:ht=ht.next=t}return ht}function Zo(t,e){return typeof e=="function"?e(t):e}function uc(t){var e=Sn(),n=e.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=t;var r=lt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,c=null,h=i;do{var p=h.lane;if((Ps&p)===p)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var m={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(l=c=m,a=r):c=c.next=m,He.lanes|=p,bs|=p}h=h.next}while(h!==null&&h!==i);c===null?a=r:c.next=l,zn(r,e.memoizedState)||(Xt=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,He.lanes|=i,bs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function cc(t){var e=Sn(),n=e.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);zn(i,e.memoizedState)||(Xt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function _y(){}function wy(t,e){var n=He,r=Sn(),s=e(),i=!zn(r.memoizedState,s);if(i&&(r.memoizedState=s,Xt=!0),r=r.queue,Ih(Ty.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ht!==null&&ht.memoizedState.tag&1){if(n.flags|=2048,ea(9,Ey.bind(null,n,r,s,e),void 0,null),ft===null)throw Error(Y(349));Ps&30||Sy(n,e,s)}return s}function Sy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=He.updateQueue,e===null?(e={lastEffect:null,stores:null},He.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Ey(t,e,n,r){e.value=n,e.getSnapshot=r,Iy(e)&&Cy(t)}function Ty(t,e,n){return n(function(){Iy(e)&&Cy(t)})}function Iy(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!zn(t,n)}catch{return!0}}function Cy(t){var e=gr(t,1);e!==null&&Fn(e,t,1,-1)}function jp(t){var e=Qn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zo,lastRenderedState:t},e.queue=t,t=t.dispatch=Z1.bind(null,He,t),[e.memoizedState,t]}function ea(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=He.updateQueue,e===null?(e={lastEffect:null,stores:null},He.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Ay(){return Sn().memoizedState}function hl(t,e,n,r){var s=Qn();He.flags|=t,s.memoizedState=ea(1|e,n,void 0,r===void 0?null:r)}function du(t,e,n,r){var s=Sn();r=r===void 0?null:r;var i=void 0;if(lt!==null){var a=lt.memoizedState;if(i=a.destroy,r!==null&&Sh(r,a.deps)){s.memoizedState=ea(e,n,i,r);return}}He.flags|=t,s.memoizedState=ea(1|e,n,i,r)}function Dp(t,e){return hl(8390656,8,t,e)}function Ih(t,e){return du(2048,8,t,e)}function ky(t,e){return du(4,2,t,e)}function Ry(t,e){return du(4,4,t,e)}function Py(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function by(t,e,n){return n=n!=null?n.concat([t]):null,du(4,4,Py.bind(null,e,t),n)}function Ch(){}function jy(t,e){var n=Sn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Sh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Dy(t,e){var n=Sn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Sh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ny(t,e,n){return Ps&21?(zn(n,e)||(n=Om(),He.lanes|=n,bs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Xt=!0),t.memoizedState=n)}function X1(t,e){var n=je;je=n!==0&&4>n?n:4,t(!0);var r=lc.transition;lc.transition={};try{t(!1),e()}finally{je=n,lc.transition=r}}function My(){return Sn().memoizedState}function J1(t,e,n){var r=$r(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Vy(t))Ly(e,n);else if(n=yy(t,e,n,r),n!==null){var s=Bt();Fn(n,t,r,s),Fy(n,e,r)}}function Z1(t,e,n){var r=$r(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Vy(t))Ly(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,zn(l,a)){var c=e.interleaved;c===null?(s.next=s,yh(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=yy(t,e,s,r),n!==null&&(s=Bt(),Fn(n,t,r,s),Fy(n,e,r))}}function Vy(t){var e=t.alternate;return t===He||e!==null&&e===He}function Ly(t,e){bo=zl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Fy(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rh(t,n)}}var Bl={readContext:wn,useCallback:Pt,useContext:Pt,useEffect:Pt,useImperativeHandle:Pt,useInsertionEffect:Pt,useLayoutEffect:Pt,useMemo:Pt,useReducer:Pt,useRef:Pt,useState:Pt,useDebugValue:Pt,useDeferredValue:Pt,useTransition:Pt,useMutableSource:Pt,useSyncExternalStore:Pt,useId:Pt,unstable_isNewReconciler:!1},e_={readContext:wn,useCallback:function(t,e){return Qn().memoizedState=[t,e===void 0?null:e],t},useContext:wn,useEffect:Dp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,hl(4194308,4,Py.bind(null,e,t),n)},useLayoutEffect:function(t,e){return hl(4194308,4,t,e)},useInsertionEffect:function(t,e){return hl(4,2,t,e)},useMemo:function(t,e){var n=Qn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Qn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=J1.bind(null,He,t),[r.memoizedState,t]},useRef:function(t){var e=Qn();return t={current:t},e.memoizedState=t},useState:jp,useDebugValue:Ch,useDeferredValue:function(t){return Qn().memoizedState=t},useTransition:function(){var t=jp(!1),e=t[0];return t=X1.bind(null,t[1]),Qn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=He,s=Qn();if($e){if(n===void 0)throw Error(Y(407));n=n()}else{if(n=e(),ft===null)throw Error(Y(349));Ps&30||Sy(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Dp(Ty.bind(null,r,i,t),[t]),r.flags|=2048,ea(9,Ey.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Qn(),e=ft.identifierPrefix;if($e){var n=cr,r=ur;n=(r&~(1<<32-Ln(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Jo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Y1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},t_={readContext:wn,useCallback:jy,useContext:wn,useEffect:Ih,useImperativeHandle:by,useInsertionEffect:ky,useLayoutEffect:Ry,useMemo:Dy,useReducer:uc,useRef:Ay,useState:function(){return uc(Zo)},useDebugValue:Ch,useDeferredValue:function(t){var e=Sn();return Ny(e,lt.memoizedState,t)},useTransition:function(){var t=uc(Zo)[0],e=Sn().memoizedState;return[t,e]},useMutableSource:_y,useSyncExternalStore:wy,useId:My,unstable_isNewReconciler:!1},n_={readContext:wn,useCallback:jy,useContext:wn,useEffect:Ih,useImperativeHandle:by,useInsertionEffect:ky,useLayoutEffect:Ry,useMemo:Dy,useReducer:cc,useRef:Ay,useState:function(){return cc(Zo)},useDebugValue:Ch,useDeferredValue:function(t){var e=Sn();return lt===null?e.memoizedState=t:Ny(e,lt.memoizedState,t)},useTransition:function(){var t=cc(Zo)[0],e=Sn().memoizedState;return[t,e]},useMutableSource:_y,useSyncExternalStore:wy,useId:My,unstable_isNewReconciler:!1};function Dn(t,e){if(t&&t.defaultProps){e=qe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function rd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:qe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var hu={isMounted:function(t){return(t=t._reactInternals)?Ls(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Bt(),s=$r(t),i=dr(r,s);i.payload=e,n!=null&&(i.callback=n),e=Br(t,i,s),e!==null&&(Fn(e,t,s,r),cl(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Bt(),s=$r(t),i=dr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Br(t,i,s),e!==null&&(Fn(e,t,s,r),cl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Bt(),r=$r(t),s=dr(n,r);s.tag=2,e!=null&&(s.callback=e),e=Br(t,s,r),e!==null&&(Fn(e,t,r,n),cl(e,t,r))}};function Np(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!qo(n,r)||!qo(s,i):!0}function Oy(t,e,n){var r=!1,s=Yr,i=e.contextType;return typeof i=="object"&&i!==null?i=wn(i):(s=Zt(e)?ks:Vt.current,r=e.contextTypes,i=(r=r!=null)?Ei(t,s):Yr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=hu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Mp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&hu.enqueueReplaceState(e,e.state,null)}function sd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},vh(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=wn(i):(i=Zt(e)?ks:Vt.current,s.context=Ei(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(rd(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&hu.enqueueReplaceState(s,s.state,null),Fl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ai(t,e){try{var n="",r=e;do n+=Px(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function dc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function id(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var r_=typeof WeakMap=="function"?WeakMap:Map;function zy(t,e,n){n=dr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){$l||($l=!0,gd=r),id(t,e)},n}function By(t,e,n){n=dr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){id(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){id(t,e),typeof r!="function"&&(Ur===null?Ur=new Set([this]):Ur.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Vp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new r_;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=y_.bind(null,t,e,n),e.then(t,t))}function Lp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Fp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=dr(-1,1),e.tag=2,Br(n,e,1))),n.lanes|=1),t)}var s_=wr.ReactCurrentOwner,Xt=!1;function zt(t,e,n,r){e.child=t===null?my(e,null,n,r):Ii(e,t.child,n,r)}function Op(t,e,n,r,s){n=n.render;var i=e.ref;return vi(e,s),r=Eh(t,e,n,r,i,s),n=Th(),t!==null&&!Xt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,mr(t,e,s)):($e&&n&&dh(e),e.flags|=1,zt(t,e,r,s),e.child)}function zp(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Nh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Uy(t,e,i,r,s)):(t=ml(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:qo,n(a,r)&&t.ref===e.ref)return mr(t,e,s)}return e.flags|=1,t=Wr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Uy(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(qo(i,r)&&t.ref===e.ref)if(Xt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Xt=!0);else return e.lanes=t.lanes,mr(t,e,s)}return od(t,e,n,r,s)}function $y(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fe(fi,sn),sn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Fe(fi,sn),sn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Fe(fi,sn),sn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Fe(fi,sn),sn|=r;return zt(t,e,s,n),e.child}function Wy(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function od(t,e,n,r,s){var i=Zt(n)?ks:Vt.current;return i=Ei(e,i),vi(e,s),n=Eh(t,e,n,r,i,s),r=Th(),t!==null&&!Xt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,mr(t,e,s)):($e&&r&&dh(e),e.flags|=1,zt(t,e,n,s),e.child)}function Bp(t,e,n,r,s){if(Zt(n)){var i=!0;Dl(e)}else i=!1;if(vi(e,s),e.stateNode===null)fl(t,e),Oy(e,n,r),sd(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var c=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=wn(h):(h=Zt(n)?ks:Vt.current,h=Ei(e,h));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==h)&&Mp(e,a,r,h),br=!1;var y=e.memoizedState;a.state=y,Fl(e,r,a,s),c=e.memoizedState,l!==r||y!==c||Jt.current||br?(typeof p=="function"&&(rd(e,n,p,r),c=e.memoizedState),(l=br||Np(e,n,l,r,y,c,h))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),a.props=r,a.state=c,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,vy(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:Dn(e.type,l),a.props=h,m=e.pendingProps,y=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=wn(c):(c=Zt(n)?ks:Vt.current,c=Ei(e,c));var I=n.getDerivedStateFromProps;(p=typeof I=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==m||y!==c)&&Mp(e,a,r,c),br=!1,y=e.memoizedState,a.state=y,Fl(e,r,a,s);var A=e.memoizedState;l!==m||y!==A||Jt.current||br?(typeof I=="function"&&(rd(e,n,I,r),A=e.memoizedState),(h=br||Np(e,n,h,r,y,A,c)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,A,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,A,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),a.props=r,a.state=A,a.context=c,r=h):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return ad(t,e,n,r,i,s)}function ad(t,e,n,r,s,i){Wy(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&Cp(e,n,!1),mr(t,e,i);r=e.stateNode,s_.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Ii(e,t.child,null,i),e.child=Ii(e,null,l,i)):zt(t,e,l,i),e.memoizedState=r.state,s&&Cp(e,n,!0),e.child}function Hy(t){var e=t.stateNode;e.pendingContext?Ip(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ip(t,e.context,!1),xh(t,e.containerInfo)}function Up(t,e,n,r,s){return Ti(),fh(s),e.flags|=256,zt(t,e,n,r),e.child}var ld={dehydrated:null,treeContext:null,retryLane:0};function ud(t){return{baseLanes:t,cachePool:null,transitions:null}}function qy(t,e,n){var r=e.pendingProps,s=We.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Fe(We,s&1),t===null)return td(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=gu(a,r,0,null),t=Cs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=ud(n),e.memoizedState=ld,t):Ah(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return i_(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Wr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Wr(l,i):(i=Cs(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?ud(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=ld,r}return i=t.child,t=i.sibling,r=Wr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ah(t,e){return e=gu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Xa(t,e,n,r){return r!==null&&fh(r),Ii(e,t.child,null,n),t=Ah(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function i_(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=dc(Error(Y(422))),Xa(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=gu({mode:"visible",children:r.children},s,0,null),i=Cs(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ii(e,t.child,null,a),e.child.memoizedState=ud(a),e.memoizedState=ld,i);if(!(e.mode&1))return Xa(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(Y(419)),r=dc(i,r,void 0),Xa(t,e,a,r)}if(l=(a&t.childLanes)!==0,Xt||l){if(r=ft,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,gr(t,s),Fn(r,t,s,-1))}return Dh(),r=dc(Error(Y(421))),Xa(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=v_.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,on=zr(s.nextSibling),ln=e,$e=!0,Mn=null,t!==null&&(yn[vn++]=ur,yn[vn++]=cr,yn[vn++]=Rs,ur=t.id,cr=t.overflow,Rs=e),e=Ah(e,r.children),e.flags|=4096,e)}function $p(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),nd(t.return,e,n)}function hc(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Gy(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(zt(t,e,r.children,n),r=We.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&$p(t,n,e);else if(t.tag===19)$p(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Fe(We,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ol(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),hc(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ol(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}hc(e,!0,n,null,i);break;case"together":hc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function fl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function mr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),bs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Y(153));if(e.child!==null){for(t=e.child,n=Wr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Wr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function o_(t,e,n){switch(e.tag){case 3:Hy(e),Ti();break;case 5:xy(e);break;case 1:Zt(e.type)&&Dl(e);break;case 4:xh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Fe(Vl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Fe(We,We.current&1),e.flags|=128,null):n&e.child.childLanes?qy(t,e,n):(Fe(We,We.current&1),t=mr(t,e,n),t!==null?t.sibling:null);Fe(We,We.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Gy(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Fe(We,We.current),r)break;return null;case 22:case 23:return e.lanes=0,$y(t,e,n)}return mr(t,e,n)}var Qy,cd,Ky,Yy;Qy=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};cd=function(){};Ky=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Es(Xn.current);var i=null;switch(n){case"input":s=jc(t,s),r=jc(t,r),i=[];break;case"select":s=qe({},s,{value:void 0}),r=qe({},r,{value:void 0}),i=[];break;case"textarea":s=Mc(t,s),r=Mc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=bl)}Lc(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Oo.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var c=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&c!==l&&(c!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(h,n)),n=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Oo.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&Oe("scroll",t),i||l===c||(i=[])):(i=i||[]).push(h,c))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};Yy=function(t,e,n,r){n!==r&&(e.flags|=4)};function go(t,e){if(!$e)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function a_(t,e,n){var r=e.pendingProps;switch(hh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(e),null;case 1:return Zt(e.type)&&jl(),bt(e),null;case 3:return r=e.stateNode,Ci(),Be(Jt),Be(Vt),wh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ka(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Mn!==null&&(vd(Mn),Mn=null))),cd(t,e),bt(e),null;case 5:_h(e);var s=Es(Xo.current);if(n=e.type,t!==null&&e.stateNode!=null)Ky(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Y(166));return bt(e),null}if(t=Es(Xn.current),Ka(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Kn]=e,r[Ko]=i,t=(e.mode&1)!==0,n){case"dialog":Oe("cancel",r),Oe("close",r);break;case"iframe":case"object":case"embed":Oe("load",r);break;case"video":case"audio":for(s=0;s<wo.length;s++)Oe(wo[s],r);break;case"source":Oe("error",r);break;case"img":case"image":case"link":Oe("error",r),Oe("load",r);break;case"details":Oe("toggle",r);break;case"input":Jf(r,i),Oe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Oe("invalid",r);break;case"textarea":ep(r,i),Oe("invalid",r)}Lc(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Qa(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Qa(r.textContent,l,t),s=["children",""+l]):Oo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Oe("scroll",r)}switch(n){case"input":za(r),Zf(r,i,!0);break;case"textarea":za(r),tp(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=bl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Tm(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Kn]=e,t[Ko]=r,Qy(t,e,!1,!1),e.stateNode=t;e:{switch(a=Fc(n,r),n){case"dialog":Oe("cancel",t),Oe("close",t),s=r;break;case"iframe":case"object":case"embed":Oe("load",t),s=r;break;case"video":case"audio":for(s=0;s<wo.length;s++)Oe(wo[s],t);s=r;break;case"source":Oe("error",t),s=r;break;case"img":case"image":case"link":Oe("error",t),Oe("load",t),s=r;break;case"details":Oe("toggle",t),s=r;break;case"input":Jf(t,r),s=jc(t,r),Oe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=qe({},r,{value:void 0}),Oe("invalid",t);break;case"textarea":ep(t,r),s=Mc(t,r),Oe("invalid",t);break;default:s=r}Lc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Am(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Im(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&zo(t,c):typeof c=="number"&&zo(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Oo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Oe("scroll",t):c!=null&&Xd(t,i,c,a))}switch(n){case"input":za(t),Zf(t,r,!1);break;case"textarea":za(t),tp(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Kr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?pi(t,!!r.multiple,i,!1):r.defaultValue!=null&&pi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=bl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bt(e),null;case 6:if(t&&e.stateNode!=null)Yy(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Y(166));if(n=Es(Xo.current),Es(Xn.current),Ka(e)){if(r=e.stateNode,n=e.memoizedProps,r[Kn]=e,(i=r.nodeValue!==n)&&(t=ln,t!==null))switch(t.tag){case 3:Qa(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Qa(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Kn]=e,e.stateNode=r}return bt(e),null;case 13:if(Be(We),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if($e&&on!==null&&e.mode&1&&!(e.flags&128))py(),Ti(),e.flags|=98560,i=!1;else if(i=Ka(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Y(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Y(317));i[Kn]=e}else Ti(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bt(e),i=!1}else Mn!==null&&(vd(Mn),Mn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||We.current&1?ut===0&&(ut=3):Dh())),e.updateQueue!==null&&(e.flags|=4),bt(e),null);case 4:return Ci(),cd(t,e),t===null&&Go(e.stateNode.containerInfo),bt(e),null;case 10:return mh(e.type._context),bt(e),null;case 17:return Zt(e.type)&&jl(),bt(e),null;case 19:if(Be(We),i=e.memoizedState,i===null)return bt(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)go(i,!1);else{if(ut!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Ol(t),a!==null){for(e.flags|=128,go(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Fe(We,We.current&1|2),e.child}t=t.sibling}i.tail!==null&&tt()>ki&&(e.flags|=128,r=!0,go(i,!1),e.lanes=4194304)}else{if(!r)if(t=Ol(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),go(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!$e)return bt(e),null}else 2*tt()-i.renderingStartTime>ki&&n!==1073741824&&(e.flags|=128,r=!0,go(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=tt(),e.sibling=null,n=We.current,Fe(We,r?n&1|2:n&1),e):(bt(e),null);case 22:case 23:return jh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?sn&1073741824&&(bt(e),e.subtreeFlags&6&&(e.flags|=8192)):bt(e),null;case 24:return null;case 25:return null}throw Error(Y(156,e.tag))}function l_(t,e){switch(hh(e),e.tag){case 1:return Zt(e.type)&&jl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ci(),Be(Jt),Be(Vt),wh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _h(e),null;case 13:if(Be(We),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Y(340));Ti()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Be(We),null;case 4:return Ci(),null;case 10:return mh(e.type._context),null;case 22:case 23:return jh(),null;case 24:return null;default:return null}}var Ja=!1,Dt=!1,u_=typeof WeakSet=="function"?WeakSet:Set,re=null;function hi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Je(t,e,r)}else n.current=null}function dd(t,e,n){try{n()}catch(r){Je(t,e,r)}}var Wp=!1;function c_(t,e){if(Qc=kl,t=ty(),ch(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,h=0,p=0,m=t,y=null;t:for(;;){for(var I;m!==n||s!==0&&m.nodeType!==3||(l=a+s),m!==i||r!==0&&m.nodeType!==3||(c=a+r),m.nodeType===3&&(a+=m.nodeValue.length),(I=m.firstChild)!==null;)y=m,m=I;for(;;){if(m===t)break t;if(y===n&&++h===s&&(l=a),y===i&&++p===r&&(c=a),(I=m.nextSibling)!==null)break;m=y,y=m.parentNode}m=I}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Kc={focusedElem:t,selectionRange:n},kl=!1,re=e;re!==null;)if(e=re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,re=t;else for(;re!==null;){e=re;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var P=A.memoizedProps,O=A.memoizedState,k=e.stateNode,E=k.getSnapshotBeforeUpdate(e.elementType===e.type?P:Dn(e.type,P),O);k.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Y(163))}}catch(M){Je(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,re=t;break}re=e.return}return A=Wp,Wp=!1,A}function jo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&dd(e,n,i)}s=s.next}while(s!==r)}}function fu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function hd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Xy(t){var e=t.alternate;e!==null&&(t.alternate=null,Xy(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Kn],delete e[Ko],delete e[Jc],delete e[q1],delete e[G1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Jy(t){return t.tag===5||t.tag===3||t.tag===4}function Hp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Jy(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function fd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=bl));else if(r!==4&&(t=t.child,t!==null))for(fd(t,e,n),t=t.sibling;t!==null;)fd(t,e,n),t=t.sibling}function pd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(pd(t,e,n),t=t.sibling;t!==null;)pd(t,e,n),t=t.sibling}var xt=null,Nn=!1;function Rr(t,e,n){for(n=n.child;n!==null;)Zy(t,e,n),n=n.sibling}function Zy(t,e,n){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(iu,n)}catch{}switch(n.tag){case 5:Dt||hi(n,e);case 6:var r=xt,s=Nn;xt=null,Rr(t,e,n),xt=r,Nn=s,xt!==null&&(Nn?(t=xt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):xt.removeChild(n.stateNode));break;case 18:xt!==null&&(Nn?(t=xt,n=n.stateNode,t.nodeType===8?ic(t.parentNode,n):t.nodeType===1&&ic(t,n),Wo(t)):ic(xt,n.stateNode));break;case 4:r=xt,s=Nn,xt=n.stateNode.containerInfo,Nn=!0,Rr(t,e,n),xt=r,Nn=s;break;case 0:case 11:case 14:case 15:if(!Dt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&dd(n,e,a),s=s.next}while(s!==r)}Rr(t,e,n);break;case 1:if(!Dt&&(hi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Je(n,e,l)}Rr(t,e,n);break;case 21:Rr(t,e,n);break;case 22:n.mode&1?(Dt=(r=Dt)||n.memoizedState!==null,Rr(t,e,n),Dt=r):Rr(t,e,n);break;default:Rr(t,e,n)}}function qp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new u_),e.forEach(function(r){var s=x_.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function jn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:xt=l.stateNode,Nn=!1;break e;case 3:xt=l.stateNode.containerInfo,Nn=!0;break e;case 4:xt=l.stateNode.containerInfo,Nn=!0;break e}l=l.return}if(xt===null)throw Error(Y(160));Zy(i,a,s),xt=null,Nn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(h){Je(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)e0(e,t),e=e.sibling}function e0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(jn(e,t),Gn(t),r&4){try{jo(3,t,t.return),fu(3,t)}catch(P){Je(t,t.return,P)}try{jo(5,t,t.return)}catch(P){Je(t,t.return,P)}}break;case 1:jn(e,t),Gn(t),r&512&&n!==null&&hi(n,n.return);break;case 5:if(jn(e,t),Gn(t),r&512&&n!==null&&hi(n,n.return),t.flags&32){var s=t.stateNode;try{zo(s,"")}catch(P){Je(t,t.return,P)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Sm(s,i),Fc(l,a);var h=Fc(l,i);for(a=0;a<c.length;a+=2){var p=c[a],m=c[a+1];p==="style"?Am(s,m):p==="dangerouslySetInnerHTML"?Im(s,m):p==="children"?zo(s,m):Xd(s,p,m,h)}switch(l){case"input":Dc(s,i);break;case"textarea":Em(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var I=i.value;I!=null?pi(s,!!i.multiple,I,!1):y!==!!i.multiple&&(i.defaultValue!=null?pi(s,!!i.multiple,i.defaultValue,!0):pi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ko]=i}catch(P){Je(t,t.return,P)}}break;case 6:if(jn(e,t),Gn(t),r&4){if(t.stateNode===null)throw Error(Y(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){Je(t,t.return,P)}}break;case 3:if(jn(e,t),Gn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Wo(e.containerInfo)}catch(P){Je(t,t.return,P)}break;case 4:jn(e,t),Gn(t);break;case 13:jn(e,t),Gn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Ph=tt())),r&4&&qp(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(Dt=(h=Dt)||p,jn(e,t),Dt=h):jn(e,t),Gn(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(re=t,p=t.child;p!==null;){for(m=re=p;re!==null;){switch(y=re,I=y.child,y.tag){case 0:case 11:case 14:case 15:jo(4,y,y.return);break;case 1:hi(y,y.return);var A=y.stateNode;if(typeof A.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(P){Je(r,n,P)}}break;case 5:hi(y,y.return);break;case 22:if(y.memoizedState!==null){Qp(m);continue}}I!==null?(I.return=y,re=I):Qp(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{s=m.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Cm("display",a))}catch(P){Je(t,t.return,P)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=h?"":m.memoizedProps}catch(P){Je(t,t.return,P)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:jn(e,t),Gn(t),r&4&&qp(t);break;case 21:break;default:jn(e,t),Gn(t)}}function Gn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Jy(n)){var r=n;break e}n=n.return}throw Error(Y(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(zo(s,""),r.flags&=-33);var i=Hp(t);pd(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Hp(t);fd(t,l,a);break;default:throw Error(Y(161))}}catch(c){Je(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function d_(t,e,n){re=t,t0(t)}function t0(t,e,n){for(var r=(t.mode&1)!==0;re!==null;){var s=re,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Ja;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Dt;l=Ja;var h=Dt;if(Ja=a,(Dt=c)&&!h)for(re=s;re!==null;)a=re,c=a.child,a.tag===22&&a.memoizedState!==null?Kp(s):c!==null?(c.return=a,re=c):Kp(s);for(;i!==null;)re=i,t0(i),i=i.sibling;re=s,Ja=l,Dt=h}Gp(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,re=i):Gp(t)}}function Gp(t){for(;re!==null;){var e=re;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Dt||fu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Dt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Dn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&bp(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}bp(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&Wo(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Y(163))}Dt||e.flags&512&&hd(e)}catch(y){Je(e,e.return,y)}}if(e===t){re=null;break}if(n=e.sibling,n!==null){n.return=e.return,re=n;break}re=e.return}}function Qp(t){for(;re!==null;){var e=re;if(e===t){re=null;break}var n=e.sibling;if(n!==null){n.return=e.return,re=n;break}re=e.return}}function Kp(t){for(;re!==null;){var e=re;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{fu(4,e)}catch(c){Je(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Je(e,s,c)}}var i=e.return;try{hd(e)}catch(c){Je(e,i,c)}break;case 5:var a=e.return;try{hd(e)}catch(c){Je(e,a,c)}}}catch(c){Je(e,e.return,c)}if(e===t){re=null;break}var l=e.sibling;if(l!==null){l.return=e.return,re=l;break}re=e.return}}var h_=Math.ceil,Ul=wr.ReactCurrentDispatcher,kh=wr.ReactCurrentOwner,_n=wr.ReactCurrentBatchConfig,ke=0,ft=null,it=null,St=0,sn=0,fi=ts(0),ut=0,ta=null,bs=0,pu=0,Rh=0,Do=null,Kt=null,Ph=0,ki=1/0,or=null,$l=!1,gd=null,Ur=null,Za=!1,Mr=null,Wl=0,No=0,md=null,pl=-1,gl=0;function Bt(){return ke&6?tt():pl!==-1?pl:pl=tt()}function $r(t){return t.mode&1?ke&2&&St!==0?St&-St:K1.transition!==null?(gl===0&&(gl=Om()),gl):(t=je,t!==0||(t=window.event,t=t===void 0?16:qm(t.type)),t):1}function Fn(t,e,n,r){if(50<No)throw No=0,md=null,Error(Y(185));fa(t,n,r),(!(ke&2)||t!==ft)&&(t===ft&&(!(ke&2)&&(pu|=n),ut===4&&Dr(t,St)),en(t,r),n===1&&ke===0&&!(e.mode&1)&&(ki=tt()+500,cu&&ns()))}function en(t,e){var n=t.callbackNode;Kx(t,e);var r=Al(t,t===ft?St:0);if(r===0)n!==null&&sp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&sp(n),e===1)t.tag===0?Q1(Yp.bind(null,t)):dy(Yp.bind(null,t)),W1(function(){!(ke&6)&&ns()}),n=null;else{switch(zm(r)){case 1:n=nh;break;case 4:n=Lm;break;case 16:n=Cl;break;case 536870912:n=Fm;break;default:n=Cl}n=u0(n,n0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function n0(t,e){if(pl=-1,gl=0,ke&6)throw Error(Y(327));var n=t.callbackNode;if(xi()&&t.callbackNode!==n)return null;var r=Al(t,t===ft?St:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Hl(t,r);else{e=r;var s=ke;ke|=2;var i=s0();(ft!==t||St!==e)&&(or=null,ki=tt()+500,Is(t,e));do try{g_();break}catch(l){r0(t,l)}while(!0);gh(),Ul.current=i,ke=s,it!==null?e=0:(ft=null,St=0,e=ut)}if(e!==0){if(e===2&&(s=$c(t),s!==0&&(r=s,e=yd(t,s))),e===1)throw n=ta,Is(t,0),Dr(t,r),en(t,tt()),n;if(e===6)Dr(t,r);else{if(s=t.current.alternate,!(r&30)&&!f_(s)&&(e=Hl(t,r),e===2&&(i=$c(t),i!==0&&(r=i,e=yd(t,i))),e===1))throw n=ta,Is(t,0),Dr(t,r),en(t,tt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(Y(345));case 2:xs(t,Kt,or);break;case 3:if(Dr(t,r),(r&130023424)===r&&(e=Ph+500-tt(),10<e)){if(Al(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Bt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Xc(xs.bind(null,t,Kt,or),e);break}xs(t,Kt,or);break;case 4:if(Dr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Ln(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*h_(r/1960))-r,10<r){t.timeoutHandle=Xc(xs.bind(null,t,Kt,or),r);break}xs(t,Kt,or);break;case 5:xs(t,Kt,or);break;default:throw Error(Y(329))}}}return en(t,tt()),t.callbackNode===n?n0.bind(null,t):null}function yd(t,e){var n=Do;return t.current.memoizedState.isDehydrated&&(Is(t,e).flags|=256),t=Hl(t,e),t!==2&&(e=Kt,Kt=n,e!==null&&vd(e)),t}function vd(t){Kt===null?Kt=t:Kt.push.apply(Kt,t)}function f_(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!zn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Dr(t,e){for(e&=~Rh,e&=~pu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ln(e),r=1<<n;t[n]=-1,e&=~r}}function Yp(t){if(ke&6)throw Error(Y(327));xi();var e=Al(t,0);if(!(e&1))return en(t,tt()),null;var n=Hl(t,e);if(t.tag!==0&&n===2){var r=$c(t);r!==0&&(e=r,n=yd(t,r))}if(n===1)throw n=ta,Is(t,0),Dr(t,e),en(t,tt()),n;if(n===6)throw Error(Y(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xs(t,Kt,or),en(t,tt()),null}function bh(t,e){var n=ke;ke|=1;try{return t(e)}finally{ke=n,ke===0&&(ki=tt()+500,cu&&ns())}}function js(t){Mr!==null&&Mr.tag===0&&!(ke&6)&&xi();var e=ke;ke|=1;var n=_n.transition,r=je;try{if(_n.transition=null,je=1,t)return t()}finally{je=r,_n.transition=n,ke=e,!(ke&6)&&ns()}}function jh(){sn=fi.current,Be(fi)}function Is(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$1(n)),it!==null)for(n=it.return;n!==null;){var r=n;switch(hh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&jl();break;case 3:Ci(),Be(Jt),Be(Vt),wh();break;case 5:_h(r);break;case 4:Ci();break;case 13:Be(We);break;case 19:Be(We);break;case 10:mh(r.type._context);break;case 22:case 23:jh()}n=n.return}if(ft=t,it=t=Wr(t.current,null),St=sn=e,ut=0,ta=null,Rh=pu=bs=0,Kt=Do=null,Ss!==null){for(e=0;e<Ss.length;e++)if(n=Ss[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}Ss=null}return t}function r0(t,e){do{var n=it;try{if(gh(),dl.current=Bl,zl){for(var r=He.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}zl=!1}if(Ps=0,ht=lt=He=null,bo=!1,Jo=0,kh.current=null,n===null||n.return===null){ut=1,ta=e,it=null;break}e:{var i=t,a=n.return,l=n,c=e;if(e=St,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,p=l,m=p.tag;if(!(p.mode&1)&&(m===0||m===11||m===15)){var y=p.alternate;y?(p.updateQueue=y.updateQueue,p.memoizedState=y.memoizedState,p.lanes=y.lanes):(p.updateQueue=null,p.memoizedState=null)}var I=Lp(a);if(I!==null){I.flags&=-257,Fp(I,a,l,i,e),I.mode&1&&Vp(i,h,e),e=I,c=h;var A=e.updateQueue;if(A===null){var P=new Set;P.add(c),e.updateQueue=P}else A.add(c);break e}else{if(!(e&1)){Vp(i,h,e),Dh();break e}c=Error(Y(426))}}else if($e&&l.mode&1){var O=Lp(a);if(O!==null){!(O.flags&65536)&&(O.flags|=256),Fp(O,a,l,i,e),fh(Ai(c,l));break e}}i=c=Ai(c,l),ut!==4&&(ut=2),Do===null?Do=[i]:Do.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var k=zy(i,c,e);Pp(i,k);break e;case 1:l=c;var E=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Ur===null||!Ur.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var M=By(i,l,e);Pp(i,M);break e}}i=i.return}while(i!==null)}o0(n)}catch($){e=$,it===n&&n!==null&&(it=n=n.return);continue}break}while(!0)}function s0(){var t=Ul.current;return Ul.current=Bl,t===null?Bl:t}function Dh(){(ut===0||ut===3||ut===2)&&(ut=4),ft===null||!(bs&268435455)&&!(pu&268435455)||Dr(ft,St)}function Hl(t,e){var n=ke;ke|=2;var r=s0();(ft!==t||St!==e)&&(or=null,Is(t,e));do try{p_();break}catch(s){r0(t,s)}while(!0);if(gh(),ke=n,Ul.current=r,it!==null)throw Error(Y(261));return ft=null,St=0,ut}function p_(){for(;it!==null;)i0(it)}function g_(){for(;it!==null&&!zx();)i0(it)}function i0(t){var e=l0(t.alternate,t,sn);t.memoizedProps=t.pendingProps,e===null?o0(t):it=e,kh.current=null}function o0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=l_(n,e),n!==null){n.flags&=32767,it=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ut=6,it=null;return}}else if(n=a_(n,e,sn),n!==null){it=n;return}if(e=e.sibling,e!==null){it=e;return}it=e=t}while(e!==null);ut===0&&(ut=5)}function xs(t,e,n){var r=je,s=_n.transition;try{_n.transition=null,je=1,m_(t,e,n,r)}finally{_n.transition=s,je=r}return null}function m_(t,e,n,r){do xi();while(Mr!==null);if(ke&6)throw Error(Y(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Y(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Yx(t,i),t===ft&&(it=ft=null,St=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Za||(Za=!0,u0(Cl,function(){return xi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=_n.transition,_n.transition=null;var a=je;je=1;var l=ke;ke|=4,kh.current=null,c_(t,n),e0(n,t),V1(Kc),kl=!!Qc,Kc=Qc=null,t.current=n,d_(n),Bx(),ke=l,je=a,_n.transition=i}else t.current=n;if(Za&&(Za=!1,Mr=t,Wl=s),i=t.pendingLanes,i===0&&(Ur=null),Wx(n.stateNode),en(t,tt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if($l)throw $l=!1,t=gd,gd=null,t;return Wl&1&&t.tag!==0&&xi(),i=t.pendingLanes,i&1?t===md?No++:(No=0,md=t):No=0,ns(),null}function xi(){if(Mr!==null){var t=zm(Wl),e=_n.transition,n=je;try{if(_n.transition=null,je=16>t?16:t,Mr===null)var r=!1;else{if(t=Mr,Mr=null,Wl=0,ke&6)throw Error(Y(331));var s=ke;for(ke|=4,re=t.current;re!==null;){var i=re,a=i.child;if(re.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var h=l[c];for(re=h;re!==null;){var p=re;switch(p.tag){case 0:case 11:case 15:jo(8,p,i)}var m=p.child;if(m!==null)m.return=p,re=m;else for(;re!==null;){p=re;var y=p.sibling,I=p.return;if(Xy(p),p===h){re=null;break}if(y!==null){y.return=I,re=y;break}re=I}}}var A=i.alternate;if(A!==null){var P=A.child;if(P!==null){A.child=null;do{var O=P.sibling;P.sibling=null,P=O}while(P!==null)}}re=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,re=a;else e:for(;re!==null;){if(i=re,i.flags&2048)switch(i.tag){case 0:case 11:case 15:jo(9,i,i.return)}var k=i.sibling;if(k!==null){k.return=i.return,re=k;break e}re=i.return}}var E=t.current;for(re=E;re!==null;){a=re;var T=a.child;if(a.subtreeFlags&2064&&T!==null)T.return=a,re=T;else e:for(a=E;re!==null;){if(l=re,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:fu(9,l)}}catch($){Je(l,l.return,$)}if(l===a){re=null;break e}var M=l.sibling;if(M!==null){M.return=l.return,re=M;break e}re=l.return}}if(ke=s,ns(),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(iu,t)}catch{}r=!0}return r}finally{je=n,_n.transition=e}}return!1}function Xp(t,e,n){e=Ai(n,e),e=zy(t,e,1),t=Br(t,e,1),e=Bt(),t!==null&&(fa(t,1,e),en(t,e))}function Je(t,e,n){if(t.tag===3)Xp(t,t,n);else for(;e!==null;){if(e.tag===3){Xp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ur===null||!Ur.has(r))){t=Ai(n,t),t=By(e,t,1),e=Br(e,t,1),t=Bt(),e!==null&&(fa(e,1,t),en(e,t));break}}e=e.return}}function y_(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Bt(),t.pingedLanes|=t.suspendedLanes&n,ft===t&&(St&n)===n&&(ut===4||ut===3&&(St&130023424)===St&&500>tt()-Ph?Is(t,0):Rh|=n),en(t,e)}function a0(t,e){e===0&&(t.mode&1?(e=$a,$a<<=1,!($a&130023424)&&($a=4194304)):e=1);var n=Bt();t=gr(t,e),t!==null&&(fa(t,e,n),en(t,n))}function v_(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),a0(t,n)}function x_(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Y(314))}r!==null&&r.delete(e),a0(t,n)}var l0;l0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Jt.current)Xt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Xt=!1,o_(t,e,n);Xt=!!(t.flags&131072)}else Xt=!1,$e&&e.flags&1048576&&hy(e,Ml,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;fl(t,e),t=e.pendingProps;var s=Ei(e,Vt.current);vi(e,n),s=Eh(null,e,r,t,s,n);var i=Th();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zt(r)?(i=!0,Dl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,vh(e),s.updater=hu,e.stateNode=s,s._reactInternals=e,sd(e,r,t,n),e=ad(null,e,r,!0,i,n)):(e.tag=0,$e&&i&&dh(e),zt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(fl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=w_(r),t=Dn(r,t),s){case 0:e=od(null,e,r,t,n);break e;case 1:e=Bp(null,e,r,t,n);break e;case 11:e=Op(null,e,r,t,n);break e;case 14:e=zp(null,e,r,Dn(r.type,t),n);break e}throw Error(Y(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Dn(r,s),od(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Dn(r,s),Bp(t,e,r,s,n);case 3:e:{if(Hy(e),t===null)throw Error(Y(387));r=e.pendingProps,i=e.memoizedState,s=i.element,vy(t,e),Fl(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ai(Error(Y(423)),e),e=Up(t,e,r,n,s);break e}else if(r!==s){s=Ai(Error(Y(424)),e),e=Up(t,e,r,n,s);break e}else for(on=zr(e.stateNode.containerInfo.firstChild),ln=e,$e=!0,Mn=null,n=my(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ti(),r===s){e=mr(t,e,n);break e}zt(t,e,r,n)}e=e.child}return e;case 5:return xy(e),t===null&&td(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Yc(r,s)?a=null:i!==null&&Yc(r,i)&&(e.flags|=32),Wy(t,e),zt(t,e,a,n),e.child;case 6:return t===null&&td(e),null;case 13:return qy(t,e,n);case 4:return xh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ii(e,null,r,n):zt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Dn(r,s),Op(t,e,r,s,n);case 7:return zt(t,e,e.pendingProps,n),e.child;case 8:return zt(t,e,e.pendingProps.children,n),e.child;case 12:return zt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Fe(Vl,r._currentValue),r._currentValue=a,i!==null)if(zn(i.value,a)){if(i.children===s.children&&!Jt.current){e=mr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=dr(-1,n&-n),c.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?c.next=c:(c.next=p.next,p.next=c),h.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),nd(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Y(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),nd(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}zt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,vi(e,n),s=wn(s),r=r(s),e.flags|=1,zt(t,e,r,n),e.child;case 14:return r=e.type,s=Dn(r,e.pendingProps),s=Dn(r.type,s),zp(t,e,r,s,n);case 15:return Uy(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Dn(r,s),fl(t,e),e.tag=1,Zt(r)?(t=!0,Dl(e)):t=!1,vi(e,n),Oy(e,r,s),sd(e,r,s,n),ad(null,e,r,!0,t,n);case 19:return Gy(t,e,n);case 22:return $y(t,e,n)}throw Error(Y(156,e.tag))};function u0(t,e){return Vm(t,e)}function __(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(t,e,n,r){return new __(t,e,n,r)}function Nh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function w_(t){if(typeof t=="function")return Nh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zd)return 11;if(t===eh)return 14}return 2}function Wr(t,e){var n=t.alternate;return n===null?(n=xn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ml(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")Nh(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ri:return Cs(n.children,s,i,e);case Jd:a=8,s|=8;break;case kc:return t=xn(12,n,e,s|2),t.elementType=kc,t.lanes=i,t;case Rc:return t=xn(13,n,e,s),t.elementType=Rc,t.lanes=i,t;case Pc:return t=xn(19,n,e,s),t.elementType=Pc,t.lanes=i,t;case xm:return gu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ym:a=10;break e;case vm:a=9;break e;case Zd:a=11;break e;case eh:a=14;break e;case Pr:a=16,r=null;break e}throw Error(Y(130,t==null?t:typeof t,""))}return e=xn(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Cs(t,e,n,r){return t=xn(7,t,r,e),t.lanes=n,t}function gu(t,e,n,r){return t=xn(22,t,r,e),t.elementType=xm,t.lanes=n,t.stateNode={isHidden:!1},t}function fc(t,e,n){return t=xn(6,t,null,e),t.lanes=n,t}function pc(t,e,n){return e=xn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function S_(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qu(0),this.expirationTimes=Qu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Mh(t,e,n,r,s,i,a,l,c){return t=new S_(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=xn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vh(i),t}function E_(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ni,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function c0(t){if(!t)return Yr;t=t._reactInternals;e:{if(Ls(t)!==t||t.tag!==1)throw Error(Y(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Y(171))}if(t.tag===1){var n=t.type;if(Zt(n))return cy(t,n,e)}return e}function d0(t,e,n,r,s,i,a,l,c){return t=Mh(n,r,!0,t,s,i,a,l,c),t.context=c0(null),n=t.current,r=Bt(),s=$r(n),i=dr(r,s),i.callback=e??null,Br(n,i,s),t.current.lanes=s,fa(t,s,r),en(t,r),t}function mu(t,e,n,r){var s=e.current,i=Bt(),a=$r(s);return n=c0(n),e.context===null?e.context=n:e.pendingContext=n,e=dr(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Br(s,e,a),t!==null&&(Fn(t,s,a,i),cl(t,s,a)),a}function ql(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Jp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Vh(t,e){Jp(t,e),(t=t.alternate)&&Jp(t,e)}function T_(){return null}var h0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Lh(t){this._internalRoot=t}yu.prototype.render=Lh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Y(409));mu(t,e,null,null)};yu.prototype.unmount=Lh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;js(function(){mu(null,t,null,null)}),e[pr]=null}};function yu(t){this._internalRoot=t}yu.prototype.unstable_scheduleHydration=function(t){if(t){var e=$m();t={blockedOn:null,target:t,priority:e};for(var n=0;n<jr.length&&e!==0&&e<jr[n].priority;n++);jr.splice(n,0,t),n===0&&Hm(t)}};function Fh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function vu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Zp(){}function I_(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=ql(a);i.call(h)}}var a=d0(e,r,t,0,null,!1,!1,"",Zp);return t._reactRootContainer=a,t[pr]=a.current,Go(t.nodeType===8?t.parentNode:t),js(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=ql(c);l.call(h)}}var c=Mh(t,0,!1,null,null,!1,!1,"",Zp);return t._reactRootContainer=c,t[pr]=c.current,Go(t.nodeType===8?t.parentNode:t),js(function(){mu(e,c,n,r)}),c}function xu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=ql(a);l.call(c)}}mu(e,a,t,s)}else a=I_(n,e,t,s,r);return ql(a)}Bm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=_o(e.pendingLanes);n!==0&&(rh(e,n|1),en(e,tt()),!(ke&6)&&(ki=tt()+500,ns()))}break;case 13:js(function(){var r=gr(t,1);if(r!==null){var s=Bt();Fn(r,t,1,s)}}),Vh(t,1)}};sh=function(t){if(t.tag===13){var e=gr(t,134217728);if(e!==null){var n=Bt();Fn(e,t,134217728,n)}Vh(t,134217728)}};Um=function(t){if(t.tag===13){var e=$r(t),n=gr(t,e);if(n!==null){var r=Bt();Fn(n,t,e,r)}Vh(t,e)}};$m=function(){return je};Wm=function(t,e){var n=je;try{return je=t,e()}finally{je=n}};zc=function(t,e,n){switch(e){case"input":if(Dc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=uu(r);if(!s)throw Error(Y(90));wm(r),Dc(r,s)}}}break;case"textarea":Em(t,n);break;case"select":e=n.value,e!=null&&pi(t,!!n.multiple,e,!1)}};Pm=bh;bm=js;var C_={usingClientEntryPoint:!1,Events:[ga,ai,uu,km,Rm,bh]},mo={findFiberByHostInstance:ws,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},A_={bundleType:mo.bundleType,version:mo.version,rendererPackageName:mo.rendererPackageName,rendererConfig:mo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:wr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Nm(t),t===null?null:t.stateNode},findFiberByHostInstance:mo.findFiberByHostInstance||T_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var el=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!el.isDisabled&&el.supportsFiber)try{iu=el.inject(A_),Yn=el}catch{}}cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C_;cn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fh(e))throw Error(Y(200));return E_(t,e,null,n)};cn.createRoot=function(t,e){if(!Fh(t))throw Error(Y(299));var n=!1,r="",s=h0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Mh(t,1,!1,null,null,n,!1,r,s),t[pr]=e.current,Go(t.nodeType===8?t.parentNode:t),new Lh(e)};cn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Y(188)):(t=Object.keys(t).join(","),Error(Y(268,t)));return t=Nm(e),t=t===null?null:t.stateNode,t};cn.flushSync=function(t){return js(t)};cn.hydrate=function(t,e,n){if(!vu(e))throw Error(Y(200));return xu(null,t,e,!0,n)};cn.hydrateRoot=function(t,e,n){if(!Fh(t))throw Error(Y(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=h0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=d0(e,null,t,1,n??null,s,!1,i,a),t[pr]=e.current,Go(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new yu(e)};cn.render=function(t,e,n){if(!vu(e))throw Error(Y(200));return xu(null,t,e,!1,n)};cn.unmountComponentAtNode=function(t){if(!vu(t))throw Error(Y(40));return t._reactRootContainer?(js(function(){xu(null,null,t,!1,function(){t._reactRootContainer=null,t[pr]=null})}),!0):!1};cn.unstable_batchedUpdates=bh;cn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!vu(n))throw Error(Y(200));if(t==null||t._reactInternals===void 0)throw Error(Y(38));return xu(t,e,n,!1,r)};cn.version="18.3.1-next-f1338f8080-20240426";function f0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(f0)}catch(t){console.error(t)}}f0(),fm.exports=cn;var k_=fm.exports,p0,eg=k_;p0=eg.createRoot,eg.hydrateRoot;var tg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},R_=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},m0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,c=s+2<t.length,h=c?t[s+2]:0,p=i>>2,m=(i&3)<<4|l>>4;let y=(l&15)<<2|h>>6,I=h&63;c||(I=64,a||(y=64)),r.push(n[p],n[m],n[y],n[I])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(g0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):R_(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||h==null||m==null)throw new P_;const y=i<<2|l>>4;if(r.push(y),h!==64){const I=l<<4&240|h>>2;if(r.push(I),m!==64){const A=h<<6&192|m;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class P_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const b_=function(t){const e=g0(t);return m0.encodeByteArray(e,!0)},y0=function(t){return b_(t).replace(/\./g,"")},j_=function(t){try{return m0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N_=()=>D_().__FIREBASE_DEFAULTS__,M_=()=>{if(typeof process>"u"||typeof tg>"u")return;const t=tg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},V_=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&j_(t[1]);return e&&JSON.parse(e)},Oh=()=>{try{return N_()||M_()||V_()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},L_=t=>{var e,n;return(n=(e=Oh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},F_=t=>{const e=L_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},v0=()=>{var t;return(t=Oh())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function B_(){var t;const e=(t=Oh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function U_(){return!B_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $_(){try{return typeof indexedDB=="object"}catch{return!1}}function W_(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H_="FirebaseError";class Oi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=H_,Object.setPrototypeOf(this,Oi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,x0.prototype.create)}}class x0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?q_(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new Oi(s,l,r)}}function q_(t,e){return t.replace(G_,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const G_=/\{\$([^}]+)}/g;function Gl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(ng(i)&&ng(a)){if(!Gl(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function ng(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(t){return t&&t._delegate?t._delegate:t}class Ri{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _s="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new O_;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Y_(e))try{this.getOrInitializeService({instanceIdentifier:_s})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=_s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_s){return this.instances.has(e)}getOptions(e=_s){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:K_(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=_s){return this.component?this.component.multipleInstances?e:_s:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function K_(t){return t===_s?void 0:t}function Y_(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Q_(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ae;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ae||(Ae={}));const J_={debug:Ae.DEBUG,verbose:Ae.VERBOSE,info:Ae.INFO,warn:Ae.WARN,error:Ae.ERROR,silent:Ae.SILENT},Z_=Ae.INFO,ew={[Ae.DEBUG]:"log",[Ae.VERBOSE]:"log",[Ae.INFO]:"info",[Ae.WARN]:"warn",[Ae.ERROR]:"error"},tw=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=ew[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _0{constructor(e){this.name=e,this._logLevel=Z_,this._logHandler=tw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ae))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?J_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ae.DEBUG,...e),this._logHandler(this,Ae.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ae.VERBOSE,...e),this._logHandler(this,Ae.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ae.INFO,...e),this._logHandler(this,Ae.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ae.WARN,...e),this._logHandler(this,Ae.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ae.ERROR,...e),this._logHandler(this,Ae.ERROR,...e)}}const nw=(t,e)=>e.some(n=>t instanceof n);let rg,sg;function rw(){return rg||(rg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sw(){return sg||(sg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const w0=new WeakMap,xd=new WeakMap,S0=new WeakMap,gc=new WeakMap,zh=new WeakMap;function iw(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Hr(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&w0.set(n,t)}).catch(()=>{}),zh.set(e,t),e}function ow(t){if(xd.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});xd.set(t,e)}let _d={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return xd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||S0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Hr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function aw(t){_d=t(_d)}function lw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(mc(this),e,...n);return S0.set(r,e.sort?e.sort():[e]),Hr(r)}:sw().includes(t)?function(...e){return t.apply(mc(this),e),Hr(w0.get(this))}:function(...e){return Hr(t.apply(mc(this),e))}}function uw(t){return typeof t=="function"?lw(t):(t instanceof IDBTransaction&&ow(t),nw(t,rw())?new Proxy(t,_d):t)}function Hr(t){if(t instanceof IDBRequest)return iw(t);if(gc.has(t))return gc.get(t);const e=uw(t);return e!==t&&(gc.set(t,e),zh.set(e,t)),e}const mc=t=>zh.get(t);function cw(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=Hr(a);return r&&a.addEventListener("upgradeneeded",c=>{r(Hr(a.result),c.oldVersion,c.newVersion,Hr(a.transaction),c)}),n&&a.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const dw=["get","getKey","getAll","getAllKeys","count"],hw=["put","add","delete","clear"],yc=new Map;function ig(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(yc.get(e))return yc.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=hw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||dw.includes(n)))return;const i=async function(a,...l){const c=this.transaction(a,s?"readwrite":"readonly");let h=c.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),s&&c.done]))[0]};return yc.set(e,i),i}aw(t=>({...t,get:(e,n,r)=>ig(e,n)||t.get(e,n,r),has:(e,n)=>!!ig(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(pw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function pw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const wd="@firebase/app",og="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yr=new _0("@firebase/app"),gw="@firebase/app-compat",mw="@firebase/analytics-compat",yw="@firebase/analytics",vw="@firebase/app-check-compat",xw="@firebase/app-check",_w="@firebase/auth",ww="@firebase/auth-compat",Sw="@firebase/database",Ew="@firebase/data-connect",Tw="@firebase/database-compat",Iw="@firebase/functions",Cw="@firebase/functions-compat",Aw="@firebase/installations",kw="@firebase/installations-compat",Rw="@firebase/messaging",Pw="@firebase/messaging-compat",bw="@firebase/performance",jw="@firebase/performance-compat",Dw="@firebase/remote-config",Nw="@firebase/remote-config-compat",Mw="@firebase/storage",Vw="@firebase/storage-compat",Lw="@firebase/firestore",Fw="@firebase/vertexai-preview",Ow="@firebase/firestore-compat",zw="firebase",Bw="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sd="[DEFAULT]",Uw={[wd]:"fire-core",[gw]:"fire-core-compat",[yw]:"fire-analytics",[mw]:"fire-analytics-compat",[xw]:"fire-app-check",[vw]:"fire-app-check-compat",[_w]:"fire-auth",[ww]:"fire-auth-compat",[Sw]:"fire-rtdb",[Ew]:"fire-data-connect",[Tw]:"fire-rtdb-compat",[Iw]:"fire-fn",[Cw]:"fire-fn-compat",[Aw]:"fire-iid",[kw]:"fire-iid-compat",[Rw]:"fire-fcm",[Pw]:"fire-fcm-compat",[bw]:"fire-perf",[jw]:"fire-perf-compat",[Dw]:"fire-rc",[Nw]:"fire-rc-compat",[Mw]:"fire-gcs",[Vw]:"fire-gcs-compat",[Lw]:"fire-fst",[Ow]:"fire-fst-compat",[Fw]:"fire-vertex","fire-js":"fire-js",[zw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ql=new Map,$w=new Map,Ed=new Map;function ag(t,e){try{t.container.addComponent(e)}catch(n){yr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function na(t){const e=t.name;if(Ed.has(e))return yr.debug(`There were multiple attempts to register component ${e}.`),!1;Ed.set(e,t);for(const n of Ql.values())ag(n,t);for(const n of $w.values())ag(n,t);return!0}function E0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ww={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qr=new x0("app","Firebase",Ww);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ri("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw=Bw;function T0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Sd,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw qr.create("bad-app-name",{appName:String(s)});if(n||(n=v0()),!n)throw qr.create("no-options");const i=Ql.get(s);if(i){if(Gl(n,i.options)&&Gl(r,i.config))return i;throw qr.create("duplicate-app",{appName:s})}const a=new X_(s);for(const c of Ed.values())a.addComponent(c);const l=new Hw(n,r,a);return Ql.set(s,l),l}function Gw(t=Sd){const e=Ql.get(t);if(!e&&t===Sd&&v0())return T0();if(!e)throw qr.create("no-app",{appName:t});return e}function Gr(t,e,n){var r;let s=(r=Uw[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yr.warn(l.join(" "));return}na(new Ri(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw="firebase-heartbeat-database",Kw=1,ra="firebase-heartbeat-store";let vc=null;function I0(){return vc||(vc=cw(Qw,Kw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ra)}catch(n){console.warn(n)}}}}).catch(t=>{throw qr.create("idb-open",{originalErrorMessage:t.message})})),vc}async function Yw(t){try{const n=(await I0()).transaction(ra),r=await n.objectStore(ra).get(C0(t));return await n.done,r}catch(e){if(e instanceof Oi)yr.warn(e.message);else{const n=qr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});yr.warn(n.message)}}}async function lg(t,e){try{const r=(await I0()).transaction(ra,"readwrite");await r.objectStore(ra).put(e,C0(t)),await r.done}catch(n){if(n instanceof Oi)yr.warn(n.message);else{const r=qr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});yr.warn(r.message)}}}function C0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw=1024,Jw=30*24*60*60*1e3;class Zw{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new tS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ug();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=Jw}),this._storage.overwrite(this._heartbeatsCache))}catch(r){yr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=ug(),{heartbeatsToSend:r,unsentEntries:s}=eS(this._heartbeatsCache.heartbeats),i=y0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return yr.warn(n),""}}}function ug(){return new Date().toISOString().substring(0,10)}function eS(t,e=Xw){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),cg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),cg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class tS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $_()?W_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Yw(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return lg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return lg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function cg(t){return y0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(t){na(new Ri("platform-logger",e=>new fw(e),"PRIVATE")),na(new Ri("heartbeat",e=>new Zw(e),"PRIVATE")),Gr(wd,og,t),Gr(wd,og,"esm2017"),Gr("fire-js","")}nS("");var rS="firebase",sS="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gr(rS,sS,"app");var dg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var As,A0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,g){function w(){}w.prototype=g.prototype,S.D=g.prototype,S.prototype=new w,S.prototype.constructor=S,S.C=function(C,v,R){for(var _=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)_[ee-2]=arguments[ee];return g.prototype[v].apply(C,_)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,g,w){w||(w=0);var C=Array(16);if(typeof g=="string")for(var v=0;16>v;++v)C[v]=g.charCodeAt(w++)|g.charCodeAt(w++)<<8|g.charCodeAt(w++)<<16|g.charCodeAt(w++)<<24;else for(v=0;16>v;++v)C[v]=g[w++]|g[w++]<<8|g[w++]<<16|g[w++]<<24;g=S.g[0],w=S.g[1],v=S.g[2];var R=S.g[3],_=g+(R^w&(v^R))+C[0]+3614090360&4294967295;g=w+(_<<7&4294967295|_>>>25),_=R+(v^g&(w^v))+C[1]+3905402710&4294967295,R=g+(_<<12&4294967295|_>>>20),_=v+(w^R&(g^w))+C[2]+606105819&4294967295,v=R+(_<<17&4294967295|_>>>15),_=w+(g^v&(R^g))+C[3]+3250441966&4294967295,w=v+(_<<22&4294967295|_>>>10),_=g+(R^w&(v^R))+C[4]+4118548399&4294967295,g=w+(_<<7&4294967295|_>>>25),_=R+(v^g&(w^v))+C[5]+1200080426&4294967295,R=g+(_<<12&4294967295|_>>>20),_=v+(w^R&(g^w))+C[6]+2821735955&4294967295,v=R+(_<<17&4294967295|_>>>15),_=w+(g^v&(R^g))+C[7]+4249261313&4294967295,w=v+(_<<22&4294967295|_>>>10),_=g+(R^w&(v^R))+C[8]+1770035416&4294967295,g=w+(_<<7&4294967295|_>>>25),_=R+(v^g&(w^v))+C[9]+2336552879&4294967295,R=g+(_<<12&4294967295|_>>>20),_=v+(w^R&(g^w))+C[10]+4294925233&4294967295,v=R+(_<<17&4294967295|_>>>15),_=w+(g^v&(R^g))+C[11]+2304563134&4294967295,w=v+(_<<22&4294967295|_>>>10),_=g+(R^w&(v^R))+C[12]+1804603682&4294967295,g=w+(_<<7&4294967295|_>>>25),_=R+(v^g&(w^v))+C[13]+4254626195&4294967295,R=g+(_<<12&4294967295|_>>>20),_=v+(w^R&(g^w))+C[14]+2792965006&4294967295,v=R+(_<<17&4294967295|_>>>15),_=w+(g^v&(R^g))+C[15]+1236535329&4294967295,w=v+(_<<22&4294967295|_>>>10),_=g+(v^R&(w^v))+C[1]+4129170786&4294967295,g=w+(_<<5&4294967295|_>>>27),_=R+(w^v&(g^w))+C[6]+3225465664&4294967295,R=g+(_<<9&4294967295|_>>>23),_=v+(g^w&(R^g))+C[11]+643717713&4294967295,v=R+(_<<14&4294967295|_>>>18),_=w+(R^g&(v^R))+C[0]+3921069994&4294967295,w=v+(_<<20&4294967295|_>>>12),_=g+(v^R&(w^v))+C[5]+3593408605&4294967295,g=w+(_<<5&4294967295|_>>>27),_=R+(w^v&(g^w))+C[10]+38016083&4294967295,R=g+(_<<9&4294967295|_>>>23),_=v+(g^w&(R^g))+C[15]+3634488961&4294967295,v=R+(_<<14&4294967295|_>>>18),_=w+(R^g&(v^R))+C[4]+3889429448&4294967295,w=v+(_<<20&4294967295|_>>>12),_=g+(v^R&(w^v))+C[9]+568446438&4294967295,g=w+(_<<5&4294967295|_>>>27),_=R+(w^v&(g^w))+C[14]+3275163606&4294967295,R=g+(_<<9&4294967295|_>>>23),_=v+(g^w&(R^g))+C[3]+4107603335&4294967295,v=R+(_<<14&4294967295|_>>>18),_=w+(R^g&(v^R))+C[8]+1163531501&4294967295,w=v+(_<<20&4294967295|_>>>12),_=g+(v^R&(w^v))+C[13]+2850285829&4294967295,g=w+(_<<5&4294967295|_>>>27),_=R+(w^v&(g^w))+C[2]+4243563512&4294967295,R=g+(_<<9&4294967295|_>>>23),_=v+(g^w&(R^g))+C[7]+1735328473&4294967295,v=R+(_<<14&4294967295|_>>>18),_=w+(R^g&(v^R))+C[12]+2368359562&4294967295,w=v+(_<<20&4294967295|_>>>12),_=g+(w^v^R)+C[5]+4294588738&4294967295,g=w+(_<<4&4294967295|_>>>28),_=R+(g^w^v)+C[8]+2272392833&4294967295,R=g+(_<<11&4294967295|_>>>21),_=v+(R^g^w)+C[11]+1839030562&4294967295,v=R+(_<<16&4294967295|_>>>16),_=w+(v^R^g)+C[14]+4259657740&4294967295,w=v+(_<<23&4294967295|_>>>9),_=g+(w^v^R)+C[1]+2763975236&4294967295,g=w+(_<<4&4294967295|_>>>28),_=R+(g^w^v)+C[4]+1272893353&4294967295,R=g+(_<<11&4294967295|_>>>21),_=v+(R^g^w)+C[7]+4139469664&4294967295,v=R+(_<<16&4294967295|_>>>16),_=w+(v^R^g)+C[10]+3200236656&4294967295,w=v+(_<<23&4294967295|_>>>9),_=g+(w^v^R)+C[13]+681279174&4294967295,g=w+(_<<4&4294967295|_>>>28),_=R+(g^w^v)+C[0]+3936430074&4294967295,R=g+(_<<11&4294967295|_>>>21),_=v+(R^g^w)+C[3]+3572445317&4294967295,v=R+(_<<16&4294967295|_>>>16),_=w+(v^R^g)+C[6]+76029189&4294967295,w=v+(_<<23&4294967295|_>>>9),_=g+(w^v^R)+C[9]+3654602809&4294967295,g=w+(_<<4&4294967295|_>>>28),_=R+(g^w^v)+C[12]+3873151461&4294967295,R=g+(_<<11&4294967295|_>>>21),_=v+(R^g^w)+C[15]+530742520&4294967295,v=R+(_<<16&4294967295|_>>>16),_=w+(v^R^g)+C[2]+3299628645&4294967295,w=v+(_<<23&4294967295|_>>>9),_=g+(v^(w|~R))+C[0]+4096336452&4294967295,g=w+(_<<6&4294967295|_>>>26),_=R+(w^(g|~v))+C[7]+1126891415&4294967295,R=g+(_<<10&4294967295|_>>>22),_=v+(g^(R|~w))+C[14]+2878612391&4294967295,v=R+(_<<15&4294967295|_>>>17),_=w+(R^(v|~g))+C[5]+4237533241&4294967295,w=v+(_<<21&4294967295|_>>>11),_=g+(v^(w|~R))+C[12]+1700485571&4294967295,g=w+(_<<6&4294967295|_>>>26),_=R+(w^(g|~v))+C[3]+2399980690&4294967295,R=g+(_<<10&4294967295|_>>>22),_=v+(g^(R|~w))+C[10]+4293915773&4294967295,v=R+(_<<15&4294967295|_>>>17),_=w+(R^(v|~g))+C[1]+2240044497&4294967295,w=v+(_<<21&4294967295|_>>>11),_=g+(v^(w|~R))+C[8]+1873313359&4294967295,g=w+(_<<6&4294967295|_>>>26),_=R+(w^(g|~v))+C[15]+4264355552&4294967295,R=g+(_<<10&4294967295|_>>>22),_=v+(g^(R|~w))+C[6]+2734768916&4294967295,v=R+(_<<15&4294967295|_>>>17),_=w+(R^(v|~g))+C[13]+1309151649&4294967295,w=v+(_<<21&4294967295|_>>>11),_=g+(v^(w|~R))+C[4]+4149444226&4294967295,g=w+(_<<6&4294967295|_>>>26),_=R+(w^(g|~v))+C[11]+3174756917&4294967295,R=g+(_<<10&4294967295|_>>>22),_=v+(g^(R|~w))+C[2]+718787259&4294967295,v=R+(_<<15&4294967295|_>>>17),_=w+(R^(v|~g))+C[9]+3951481745&4294967295,S.g[0]=S.g[0]+g&4294967295,S.g[1]=S.g[1]+(v+(_<<21&4294967295|_>>>11))&4294967295,S.g[2]=S.g[2]+v&4294967295,S.g[3]=S.g[3]+R&4294967295}r.prototype.u=function(S,g){g===void 0&&(g=S.length);for(var w=g-this.blockSize,C=this.B,v=this.h,R=0;R<g;){if(v==0)for(;R<=w;)s(this,S,R),R+=this.blockSize;if(typeof S=="string"){for(;R<g;)if(C[v++]=S.charCodeAt(R++),v==this.blockSize){s(this,C),v=0;break}}else for(;R<g;)if(C[v++]=S[R++],v==this.blockSize){s(this,C),v=0;break}}this.h=v,this.o+=g},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var g=1;g<S.length-8;++g)S[g]=0;var w=8*this.o;for(g=S.length-8;g<S.length;++g)S[g]=w&255,w/=256;for(this.u(S),S=Array(16),g=w=0;4>g;++g)for(var C=0;32>C;C+=8)S[w++]=this.g[g]>>>C&255;return S};function i(S,g){var w=l;return Object.prototype.hasOwnProperty.call(w,S)?w[S]:w[S]=g(S)}function a(S,g){this.h=g;for(var w=[],C=!0,v=S.length-1;0<=v;v--){var R=S[v]|0;C&&R==g||(w[v]=R,C=!1)}this.g=w}var l={};function c(S){return-128<=S&&128>S?i(S,function(g){return new a([g|0],0>g?-1:0)}):new a([S|0],0>S?-1:0)}function h(S){if(isNaN(S)||!isFinite(S))return m;if(0>S)return O(h(-S));for(var g=[],w=1,C=0;S>=w;C++)g[C]=S/w|0,w*=4294967296;return new a(g,0)}function p(S,g){if(S.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(S.charAt(0)=="-")return O(p(S.substring(1),g));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=h(Math.pow(g,8)),C=m,v=0;v<S.length;v+=8){var R=Math.min(8,S.length-v),_=parseInt(S.substring(v,v+R),g);8>R?(R=h(Math.pow(g,R)),C=C.j(R).add(h(_))):(C=C.j(w),C=C.add(h(_)))}return C}var m=c(0),y=c(1),I=c(16777216);t=a.prototype,t.m=function(){if(P(this))return-O(this).m();for(var S=0,g=1,w=0;w<this.g.length;w++){var C=this.i(w);S+=(0<=C?C:4294967296+C)*g,g*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(A(this))return"0";if(P(this))return"-"+O(this).toString(S);for(var g=h(Math.pow(S,6)),w=this,C="";;){var v=M(w,g).g;w=k(w,v.j(g));var R=((0<w.g.length?w.g[0]:w.h)>>>0).toString(S);if(w=v,A(w))return R+C;for(;6>R.length;)R="0"+R;C=R+C}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function A(S){if(S.h!=0)return!1;for(var g=0;g<S.g.length;g++)if(S.g[g]!=0)return!1;return!0}function P(S){return S.h==-1}t.l=function(S){return S=k(this,S),P(S)?-1:A(S)?0:1};function O(S){for(var g=S.g.length,w=[],C=0;C<g;C++)w[C]=~S.g[C];return new a(w,~S.h).add(y)}t.abs=function(){return P(this)?O(this):this},t.add=function(S){for(var g=Math.max(this.g.length,S.g.length),w=[],C=0,v=0;v<=g;v++){var R=C+(this.i(v)&65535)+(S.i(v)&65535),_=(R>>>16)+(this.i(v)>>>16)+(S.i(v)>>>16);C=_>>>16,R&=65535,_&=65535,w[v]=_<<16|R}return new a(w,w[w.length-1]&-2147483648?-1:0)};function k(S,g){return S.add(O(g))}t.j=function(S){if(A(this)||A(S))return m;if(P(this))return P(S)?O(this).j(O(S)):O(O(this).j(S));if(P(S))return O(this.j(O(S)));if(0>this.l(I)&&0>S.l(I))return h(this.m()*S.m());for(var g=this.g.length+S.g.length,w=[],C=0;C<2*g;C++)w[C]=0;for(C=0;C<this.g.length;C++)for(var v=0;v<S.g.length;v++){var R=this.i(C)>>>16,_=this.i(C)&65535,ee=S.i(v)>>>16,Z=S.i(v)&65535;w[2*C+2*v]+=_*Z,E(w,2*C+2*v),w[2*C+2*v+1]+=R*Z,E(w,2*C+2*v+1),w[2*C+2*v+1]+=_*ee,E(w,2*C+2*v+1),w[2*C+2*v+2]+=R*ee,E(w,2*C+2*v+2)}for(C=0;C<g;C++)w[C]=w[2*C+1]<<16|w[2*C];for(C=g;C<2*g;C++)w[C]=0;return new a(w,0)};function E(S,g){for(;(S[g]&65535)!=S[g];)S[g+1]+=S[g]>>>16,S[g]&=65535,g++}function T(S,g){this.g=S,this.h=g}function M(S,g){if(A(g))throw Error("division by zero");if(A(S))return new T(m,m);if(P(S))return g=M(O(S),g),new T(O(g.g),O(g.h));if(P(g))return g=M(S,O(g)),new T(O(g.g),g.h);if(30<S.g.length){if(P(S)||P(g))throw Error("slowDivide_ only works with positive integers.");for(var w=y,C=g;0>=C.l(S);)w=$(w),C=$(C);var v=B(w,1),R=B(C,1);for(C=B(C,2),w=B(w,2);!A(C);){var _=R.add(C);0>=_.l(S)&&(v=v.add(w),R=_),C=B(C,1),w=B(w,1)}return g=k(S,v.j(g)),new T(v,g)}for(v=m;0<=S.l(g);){for(w=Math.max(1,Math.floor(S.m()/g.m())),C=Math.ceil(Math.log(w)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),R=h(w),_=R.j(g);P(_)||0<_.l(S);)w-=C,R=h(w),_=R.j(g);A(R)&&(R=y),v=v.add(R),S=k(S,_)}return new T(v,S)}t.A=function(S){return M(this,S).h},t.and=function(S){for(var g=Math.max(this.g.length,S.g.length),w=[],C=0;C<g;C++)w[C]=this.i(C)&S.i(C);return new a(w,this.h&S.h)},t.or=function(S){for(var g=Math.max(this.g.length,S.g.length),w=[],C=0;C<g;C++)w[C]=this.i(C)|S.i(C);return new a(w,this.h|S.h)},t.xor=function(S){for(var g=Math.max(this.g.length,S.g.length),w=[],C=0;C<g;C++)w[C]=this.i(C)^S.i(C);return new a(w,this.h^S.h)};function $(S){for(var g=S.g.length+1,w=[],C=0;C<g;C++)w[C]=S.i(C)<<1|S.i(C-1)>>>31;return new a(w,S.h)}function B(S,g){var w=g>>5;g%=32;for(var C=S.g.length-w,v=[],R=0;R<C;R++)v[R]=0<g?S.i(R+w)>>>g|S.i(R+w+1)<<32-g:S.i(R+w);return new a(v,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,A0=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,As=a}).apply(typeof dg<"u"?dg:typeof self<"u"?self:typeof window<"u"?window:{});var tl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var k0,So,R0,yl,Td,P0,b0,j0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,d,f){return o==Array.prototype||o==Object.prototype||(o[d]=f.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof tl=="object"&&tl];for(var d=0;d<o.length;++d){var f=o[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(o,d){if(d)e:{var f=r;o=o.split(".");for(var x=0;x<o.length-1;x++){var D=o[x];if(!(D in f))break e;f=f[D]}o=o[o.length-1],x=f[o],d=d(x),d!=x&&d!=null&&e(f,o,{configurable:!0,writable:!0,value:d})}}function i(o,d){o instanceof String&&(o+="");var f=0,x=!1,D={next:function(){if(!x&&f<o.length){var F=f++;return{value:d(F,o[F]),done:!1}}return x=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}s("Array.prototype.values",function(o){return o||function(){return i(this,function(d,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function c(o){var d=typeof o;return d=d!="object"?d:o?Array.isArray(o)?"array":d:"null",d=="array"||d=="object"&&typeof o.length=="number"}function h(o){var d=typeof o;return d=="object"&&o!=null||d=="function"}function p(o,d,f){return o.call.apply(o.bind,arguments)}function m(o,d,f){if(!o)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,x),o.apply(d,D)}}return function(){return o.apply(d,arguments)}}function y(o,d,f){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,y.apply(null,arguments)}function I(o,d){var f=Array.prototype.slice.call(arguments,1);return function(){var x=f.slice();return x.push.apply(x,arguments),o.apply(this,x)}}function A(o,d){function f(){}f.prototype=d.prototype,o.aa=d.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(x,D,F){for(var J=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)J[Me-2]=arguments[Me];return d.prototype[D].apply(x,J)}}function P(o){const d=o.length;if(0<d){const f=Array(d);for(let x=0;x<d;x++)f[x]=o[x];return f}return[]}function O(o,d){for(let f=1;f<arguments.length;f++){const x=arguments[f];if(c(x)){const D=o.length||0,F=x.length||0;o.length=D+F;for(let J=0;J<F;J++)o[D+J]=x[J]}else o.push(x)}}class k{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function E(o){return/^[\s\xa0]*$/.test(o)}function T(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function M(o){return M[" "](o),o}M[" "]=function(){};var $=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function B(o,d,f){for(const x in o)d.call(f,o[x],x,o)}function S(o,d){for(const f in o)d.call(void 0,o[f],f,o)}function g(o){const d={};for(const f in o)d[f]=o[f];return d}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(o,d){let f,x;for(let D=1;D<arguments.length;D++){x=arguments[D];for(f in x)o[f]=x[f];for(let F=0;F<w.length;F++)f=w[F],Object.prototype.hasOwnProperty.call(x,f)&&(o[f]=x[f])}}function v(o){var d=1;o=o.split(":");const f=[];for(;0<d&&o.length;)f.push(o.shift()),d--;return o.length&&f.push(o.join(":")),f}function R(o){l.setTimeout(()=>{throw o},0)}function _(){var o=j;let d=null;return o.g&&(d=o.g,o.g=o.g.next,o.g||(o.h=null),d.next=null),d}class ee{constructor(){this.h=this.g=null}add(d,f){const x=Z.get();x.set(d,f),this.h?this.h.next=x:this.g=x,this.h=x}}var Z=new k(()=>new ce,o=>o.reset());class ce{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let U,b=!1,j=new ee,V=()=>{const o=l.Promise.resolve(void 0);U=()=>{o.then(L)}};var L=()=>{for(var o;o=_();){try{o.h.call(o.g)}catch(f){R(f)}var d=Z;d.j(o),100>d.h&&(d.h++,o.next=d.g,d.g=o)}b=!1};function X(){this.s=this.s,this.C=this.C}X.prototype.s=!1,X.prototype.ma=function(){this.s||(this.s=!0,this.N())},X.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(o,d){this.type=o,this.g=this.target=d,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var ne=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,d=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};l.addEventListener("test",f,d),l.removeEventListener("test",f,d)}catch{}return o}();function oe(o,d){if(q.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,x=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=d,d=o.relatedTarget){if($){e:{try{M(d.nodeName);var D=!0;break e}catch{}D=!1}D||(d=null)}}else f=="mouseover"?d=o.fromElement:f=="mouseout"&&(d=o.toElement);this.relatedTarget=d,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:ve[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&oe.aa.h.call(this)}}A(oe,q);var ve={2:"touch",3:"pen",4:"mouse"};oe.prototype.h=function(){oe.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var ge="closure_listenable_"+(1e6*Math.random()|0),Ce=0;function xe(o,d,f,x,D){this.listener=o,this.proxy=null,this.src=d,this.type=f,this.capture=!!x,this.ha=D,this.key=++Ce,this.da=this.fa=!1}function ae(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Se(o){this.src=o,this.g={},this.h=0}Se.prototype.add=function(o,d,f,x,D){var F=o.toString();o=this.g[F],o||(o=this.g[F]=[],this.h++);var J=Re(o,d,x,D);return-1<J?(d=o[J],f||(d.fa=!1)):(d=new xe(d,this.src,F,!!x,D),d.fa=f,o.push(d)),d};function _e(o,d){var f=d.type;if(f in o.g){var x=o.g[f],D=Array.prototype.indexOf.call(x,d,void 0),F;(F=0<=D)&&Array.prototype.splice.call(x,D,1),F&&(ae(d),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Re(o,d,f,x){for(var D=0;D<o.length;++D){var F=o[D];if(!F.da&&F.listener==d&&F.capture==!!f&&F.ha==x)return D}return-1}var pt="closure_lm_"+(1e6*Math.random()|0),Ze={};function Ct(o,d,f,x,D){if(Array.isArray(d)){for(var F=0;F<d.length;F++)Ct(o,d[F],f,x,D);return null}return f=zs(f),o&&o[ge]?o.K(d,f,h(x)?!!x.capture:!1,D):$n(o,d,f,!1,x,D)}function $n(o,d,f,x,D,F){if(!d)throw Error("Invalid event type");var J=h(D)?!!D.capture:!!D,Me=is(o);if(Me||(o[pt]=Me=new Se(o)),f=Me.add(d,f,x,J,F),f.proxy)return f;if(x=Ht(),f.proxy=x,x.src=o,x.listener=f,o.addEventListener)ne||(D=J),D===void 0&&(D=!1),o.addEventListener(d.toString(),x,D);else if(o.attachEvent)o.attachEvent(Wn(d.toString()),x);else if(o.addListener&&o.removeListener)o.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Ht(){function o(f){return d.call(o.src,o.listener,f)}const d=ss;return o}function tn(o,d,f,x,D){if(Array.isArray(d))for(var F=0;F<d.length;F++)tn(o,d[F],f,x,D);else x=h(x)?!!x.capture:!!x,f=zs(f),o&&o[ge]?(o=o.i,d=String(d).toString(),d in o.g&&(F=o.g[d],f=Re(F,f,x,D),-1<f&&(ae(F[f]),Array.prototype.splice.call(F,f,1),F.length==0&&(delete o.g[d],o.h--)))):o&&(o=is(o))&&(d=o.g[d.toString()],o=-1,d&&(o=Re(d,f,x,D)),(f=-1<o?d[o]:null)&&qt(f))}function qt(o){if(typeof o!="number"&&o&&!o.da){var d=o.src;if(d&&d[ge])_e(d.i,o);else{var f=o.type,x=o.proxy;d.removeEventListener?d.removeEventListener(f,x,o.capture):d.detachEvent?d.detachEvent(Wn(f),x):d.addListener&&d.removeListener&&d.removeListener(x),(f=is(d))?(_e(f,o),f.h==0&&(f.src=null,d[pt]=null)):ae(o)}}}function Wn(o){return o in Ze?Ze[o]:Ze[o]="on"+o}function ss(o,d){if(o.da)o=!0;else{d=new oe(d,this);var f=o.listener,x=o.ha||o.src;o.fa&&qt(o),o=f.call(x,d)}return o}function is(o){return o=o[pt],o instanceof Se?o:null}var tr="__closure_events_fn_"+(1e9*Math.random()>>>0);function zs(o){return typeof o=="function"?o:(o[tr]||(o[tr]=function(d){return o.handleEvent(d)}),o[tr])}function rt(){X.call(this),this.i=new Se(this),this.M=this,this.F=null}A(rt,X),rt.prototype[ge]=!0,rt.prototype.removeEventListener=function(o,d,f,x){tn(this,o,d,f,x)};function gt(o,d){var f,x=o.F;if(x)for(f=[];x;x=x.F)f.push(x);if(o=o.M,x=d.type||d,typeof d=="string")d=new q(d,o);else if(d instanceof q)d.target=d.target||o;else{var D=d;d=new q(x,o),C(d,D)}if(D=!0,f)for(var F=f.length-1;0<=F;F--){var J=d.g=f[F];D=Sr(J,x,!0,d)&&D}if(J=d.g=o,D=Sr(J,x,!0,d)&&D,D=Sr(J,x,!1,d)&&D,f)for(F=0;F<f.length;F++)J=d.g=f[F],D=Sr(J,x,!1,d)&&D}rt.prototype.N=function(){if(rt.aa.N.call(this),this.i){var o=this.i,d;for(d in o.g){for(var f=o.g[d],x=0;x<f.length;x++)ae(f[x]);delete o.g[d],o.h--}}this.F=null},rt.prototype.K=function(o,d,f,x){return this.i.add(String(o),d,!1,f,x)},rt.prototype.L=function(o,d,f,x){return this.i.add(String(o),d,!0,f,x)};function Sr(o,d,f,x){if(d=o.i.g[String(d)],!d)return!0;d=d.concat();for(var D=!0,F=0;F<d.length;++F){var J=d[F];if(J&&!J.da&&J.capture==f){var Me=J.listener,yt=J.ha||J.src;J.fa&&_e(o.i,J),D=Me.call(yt,x)!==!1&&D}}return D&&!x.defaultPrevented}function Er(o,d,f){if(typeof o=="function")f&&(o=y(o,f));else if(o&&typeof o.handleEvent=="function")o=y(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:l.setTimeout(o,d||0)}function os(o){o.g=Er(()=>{o.g=null,o.i&&(o.i=!1,os(o))},o.l);const d=o.h;o.h=null,o.m.apply(null,d)}class Qe extends X{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:os(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function as(o){X.call(this),this.h=o,this.g={}}A(as,X);var Ia=[];function Hi(o){B(o.g,function(d,f){this.g.hasOwnProperty(f)&&qt(d)},o),o.g={}}as.prototype.N=function(){as.aa.N.call(this),Hi(this)},as.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var nr=l.JSON.stringify,qi=l.JSON.parse,Bs=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function ls(){}ls.prototype.h=null;function Te(o){return o.h||(o.h=o.i())}function En(){}var Tn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function us(){q.call(this,"d")}A(us,q);function Ca(){q.call(this,"c")}A(Ca,q);var In={},Mu=null;function Tr(){return Mu=Mu||new rt}In.La="serverreachability";function Aa(o){q.call(this,In.La,o)}A(Aa,q);function Cn(o){const d=Tr();gt(d,new Aa(d))}In.STAT_EVENT="statevent";function Ee(o,d){q.call(this,In.STAT_EVENT,o),this.stat=d}A(Ee,q);function mt(o){const d=Tr();gt(d,new Ee(d,o))}In.Ma="timingevent";function hn(o,d){q.call(this,In.Ma,o),this.size=d}A(hn,q);function An(o,d){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},d)}function fn(){this.g=!0}fn.prototype.xa=function(){this.g=!1};function Gi(o,d,f,x,D,F){o.info(function(){if(o.g)if(F)for(var J="",Me=F.split("&"),yt=0;yt<Me.length;yt++){var Pe=Me[yt].split("=");if(1<Pe.length){var kt=Pe[0];Pe=Pe[1];var Rt=kt.split("_");J=2<=Rt.length&&Rt[1]=="type"?J+(kt+"="+Pe+"&"):J+(kt+"=redacted&")}}else J=null;else J=F;return"XMLHTTP REQ ("+x+") [attempt "+D+"]: "+d+`
`+f+`
`+J})}function Vu(o,d,f,x,D,F,J){o.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+D+"]: "+d+`
`+f+`
`+F+" "+J})}function Ir(o,d,f,x){o.info(function(){return"XMLHTTP TEXT ("+d+"): "+If(o,f)+(x?" "+x:"")})}function Tf(o,d){o.info(function(){return"TIMEOUT: "+d})}fn.prototype.info=function(){};function If(o,d){if(!o.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var x=f[o];if(!(2>x.length)){var D=x[1];if(Array.isArray(D)&&!(1>D.length)){var F=D[0];if(F!="noop"&&F!="stop"&&F!="close")for(var J=1;J<D.length;J++)D[J]=""}}}}return nr(f)}catch{return d}}var cs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Us={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},$s;function Cr(){}A(Cr,ls),Cr.prototype.g=function(){return new XMLHttpRequest},Cr.prototype.i=function(){return{}},$s=new Cr;function Gt(o,d,f,x){this.j=o,this.i=d,this.l=f,this.R=x||1,this.U=new as(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qi}function Qi(){this.i=null,this.g="",this.h=!1}var Ki={},Yi={};function ds(o,d,f){o.L=1,o.v=Q(Rn(d)),o.m=f,o.P=!0,Ar(o,null)}function Ar(o,d){o.F=Date.now(),Hs(o),o.A=Rn(o.v);var f=o.A,x=o.R;Array.isArray(x)||(x=[String(x)]),ro(f.i,"t",x),o.C=0,f=o.j.J,o.h=new Qi,o.g=Uf(o.j,f?d:null,!o.m),0<o.O&&(o.M=new Qe(y(o.Y,o,o.g),o.O)),d=o.U,f=o.g,x=o.ca;var D="readystatechange";Array.isArray(D)||(D&&(Ia[0]=D.toString()),D=Ia);for(var F=0;F<D.length;F++){var J=Ct(f,D[F],x||d.handleEvent,!1,d.h||d);if(!J)break;d.g[J.key]=J}d=o.H?g(o.H):{},o.m?(o.u||(o.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,d)):(o.u="GET",o.g.ea(o.A,o.u,null,d)),Cn(),Gi(o.i,o.u,o.A,o.l,o.R,o.m)}Gt.prototype.ca=function(o){o=o.target;const d=this.M;d&&sr(o)==3?d.j():this.Y(o)},Gt.prototype.Y=function(o){try{if(o==this.g)e:{const Rt=sr(this.g);var d=this.g.Ba();const Xs=this.g.Z();if(!(3>Rt)&&(Rt!=3||this.g&&(this.h.h||this.g.oa()||bf(this.g)))){this.J||Rt!=4||d==7||(d==8||0>=Xs?Cn(3):Cn(2)),rr(this);var f=this.g.Z();this.X=f;t:if(Ws(this)){var x=bf(this.g);o="";var D=x.length,F=sr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){kr(this),pn(this);var J="";break t}this.h.i=new l.TextDecoder}for(d=0;d<D;d++)this.h.h=!0,o+=this.h.i.decode(x[d],{stream:!(F&&d==D-1)});x.length=0,this.h.g+=o,this.C=0,J=this.h.g}else J=this.g.oa();if(this.o=f==200,Vu(this.i,this.u,this.A,this.l,this.R,Rt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Me,yt=this.g;if((Me=yt.g?yt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(Me)){var Pe=Me;break t}}Pe=null}if(f=Pe)Ir(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xi(this,f);else{this.o=!1,this.s=3,mt(12),kr(this),pn(this);break e}}if(this.P){f=!0;let bn;for(;!this.J&&this.C<J.length;)if(bn=ka(this,J),bn==Yi){Rt==4&&(this.s=4,mt(14),f=!1),Ir(this.i,this.l,null,"[Incomplete Response]");break}else if(bn==Ki){this.s=4,mt(15),Ir(this.i,this.l,J,"[Invalid Chunk]"),f=!1;break}else Ir(this.i,this.l,bn,null),Xi(this,bn);if(Ws(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Rt!=4||J.length!=0||this.h.h||(this.s=1,mt(16),f=!1),this.o=this.o&&f,!f)Ir(this.i,this.l,J,"[Invalid Chunked Response]"),kr(this),pn(this);else if(0<J.length&&!this.W){this.W=!0;var kt=this.j;kt.g==this&&kt.ba&&!kt.M&&(kt.j.info("Great, no buffering proxy detected. Bytes received: "+J.length),Bu(kt),kt.M=!0,mt(11))}}else Ir(this.i,this.l,J,null),Xi(this,J);Rt==4&&kr(this),this.o&&!this.J&&(Rt==4?Ff(this.j,this):(this.o=!1,Hs(this)))}else tx(this.g),f==400&&0<J.indexOf("Unknown SID")?(this.s=3,mt(12)):(this.s=0,mt(13)),kr(this),pn(this)}}}catch{}finally{}};function Ws(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function ka(o,d){var f=o.C,x=d.indexOf(`
`,f);return x==-1?Yi:(f=Number(d.substring(f,x)),isNaN(f)?Ki:(x+=1,x+f>d.length?Yi:(d=d.slice(x,x+f),o.C=x+f,d)))}Gt.prototype.cancel=function(){this.J=!0,kr(this)};function Hs(o){o.S=Date.now()+o.I,Ra(o,o.I)}function Ra(o,d){if(o.B!=null)throw Error("WatchDog timer not null");o.B=An(y(o.ba,o),d)}function rr(o){o.B&&(l.clearTimeout(o.B),o.B=null)}Gt.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(Tf(this.i,this.A),this.L!=2&&(Cn(),mt(17)),kr(this),this.s=2,pn(this)):Ra(this,this.S-o)};function pn(o){o.j.G==0||o.J||Ff(o.j,o)}function kr(o){rr(o);var d=o.M;d&&typeof d.ma=="function"&&d.ma(),o.M=null,Hi(o.U),o.g&&(d=o.g,o.g=null,d.abort(),d.ma())}function Xi(o,d){try{var f=o.j;if(f.G!=0&&(f.g==o||eo(f.h,o))){if(!o.K&&eo(f.h,o)&&f.G==3){try{var x=f.Da.g.parse(d)}catch{x=null}if(Array.isArray(x)&&x.length==3){var D=x;if(D[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)Ma(f),Da(f);else break e;zu(f),mt(18)}}else f.za=D[1],0<f.za-f.T&&37500>D[2]&&f.F&&f.v==0&&!f.C&&(f.C=An(y(f.Za,f),6e3));if(1>=Zi(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else ys(f,11)}else if((o.K||f.g==o)&&Ma(f),!E(d))for(D=f.Da.g.parse(d),d=0;d<D.length;d++){let Pe=D[d];if(f.T=Pe[0],Pe=Pe[1],f.G==2)if(Pe[0]=="c"){f.K=Pe[1],f.ia=Pe[2];const kt=Pe[3];kt!=null&&(f.la=kt,f.j.info("VER="+f.la));const Rt=Pe[4];Rt!=null&&(f.Aa=Rt,f.j.info("SVER="+f.Aa));const Xs=Pe[5];Xs!=null&&typeof Xs=="number"&&0<Xs&&(x=1.5*Xs,f.L=x,f.j.info("backChannelRequestTimeoutMs_="+x)),x=f;const bn=o.g;if(bn){const La=bn.g?bn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(La){var F=x.h;F.g||La.indexOf("spdy")==-1&&La.indexOf("quic")==-1&&La.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(to(F,F.h),F.h=null))}if(x.D){const Uu=bn.g?bn.g.getResponseHeader("X-HTTP-Session-Id"):null;Uu&&(x.ya=Uu,z(x.I,x.D,Uu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),x=f;var J=o;if(x.qa=Bf(x,x.J?x.ia:null,x.W),J.K){qs(x.h,J);var Me=J,yt=x.L;yt&&(Me.I=yt),Me.B&&(rr(Me),Hs(Me)),x.g=J}else Vf(x);0<f.i.length&&Na(f)}else Pe[0]!="stop"&&Pe[0]!="close"||ys(f,7);else f.G==3&&(Pe[0]=="stop"||Pe[0]=="close"?Pe[0]=="stop"?ys(f,7):Ou(f):Pe[0]!="noop"&&f.l&&f.l.ta(Pe),f.v=0)}}Cn(4)}catch{}}var Lu=class{constructor(o,d){this.g=o,this.map=d}};function hs(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ji(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Zi(o){return o.h?1:o.g?o.g.size:0}function eo(o,d){return o.h?o.h==d:o.g?o.g.has(d):!1}function to(o,d){o.g?o.g.add(d):o.h=d}function qs(o,d){o.h&&o.h==d?o.h=null:o.g&&o.g.has(d)&&o.g.delete(d)}hs.prototype.cancel=function(){if(this.i=Hn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function Hn(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let d=o.i;for(const f of o.g.values())d=d.concat(f.D);return d}return P(o.i)}function kn(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(c(o)){for(var d=[],f=o.length,x=0;x<f;x++)d.push(o[x]);return d}d=[],f=0;for(x in o)d[f++]=o[x];return d}function Gs(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(c(o)||typeof o=="string"){var d=[];o=o.length;for(var f=0;f<o;f++)d.push(f);return d}d=[],f=0;for(const x in o)d[f++]=x;return d}}}function no(o,d){if(o.forEach&&typeof o.forEach=="function")o.forEach(d,void 0);else if(c(o)||typeof o=="string")Array.prototype.forEach.call(o,d,void 0);else for(var f=Gs(o),x=kn(o),D=x.length,F=0;F<D;F++)d.call(void 0,x[F],f&&f[F],o)}var qn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pa(o,d){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var x=o[f].indexOf("="),D=null;if(0<=x){var F=o[f].substring(0,x);D=o[f].substring(x+1)}else F=o[f];d(F,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function gn(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof gn){this.h=o.h,fs(this,o.j),this.o=o.o,this.g=o.g,K(this,o.s),this.l=o.l;var d=o.i,f=new Pn;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),W(this,f),this.m=o.m}else o&&(d=String(o).match(qn))?(this.h=!1,fs(this,d[1]||"",!0),this.o=ie(d[2]||""),this.g=ie(d[3]||"",!0),K(this,d[4]),this.l=ie(d[5]||"",!0),W(this,d[6]||"",!0),this.m=ie(d[7]||"")):(this.h=!1,this.i=new Pn(null,this.h))}gn.prototype.toString=function(){var o=[],d=this.j;d&&o.push(ue(d,Ke,!0),":");var f=this.g;return(f||d=="file")&&(o.push("//"),(d=this.o)&&o.push(ue(d,Ke,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(ue(f,f.charAt(0)=="/"?Ft:Lt,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",ue(f,Ve)),o.join("")};function Rn(o){return new gn(o)}function fs(o,d,f){o.j=f?ie(d,!0):d,o.j&&(o.j=o.j.replace(/:$/,""))}function K(o,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);o.s=d}else o.s=null}function W(o,d,f){d instanceof Pn?(o.i=d,so(o.i,o.h)):(f||(d=ue(d,Ot)),o.i=new Pn(d,o.h))}function z(o,d,f){o.i.set(d,f)}function Q(o){return z(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function ie(o,d){return o?d?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function ue(o,d,f){return typeof o=="string"?(o=encodeURI(o).replace(d,me),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function me(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Ke=/[#\/\?@]/g,Lt=/[#\?:]/g,Ft=/[#\?]/g,Ot=/[#\?@]/g,Ve=/#/g;function Pn(o,d){this.h=this.g=null,this.i=o||null,this.j=!!d}function nn(o){o.g||(o.g=new Map,o.h=0,o.i&&Pa(o.i,function(d,f){o.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}t=Pn.prototype,t.add=function(o,d){nn(this),this.i=null,o=ps(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(d),this.h+=1,this};function At(o,d){nn(o),d=ps(o,d),o.g.has(d)&&(o.i=null,o.h-=o.g.get(d).length,o.g.delete(d))}function Qs(o,d){return nn(o),d=ps(o,d),o.g.has(d)}t.forEach=function(o,d){nn(this),this.g.forEach(function(f,x){f.forEach(function(D){o.call(d,D,x,this)},this)},this)},t.na=function(){nn(this);const o=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let x=0;x<d.length;x++){const D=o[x];for(let F=0;F<D.length;F++)f.push(d[x])}return f},t.V=function(o){nn(this);let d=[];if(typeof o=="string")Qs(this,o)&&(d=d.concat(this.g.get(ps(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)d=d.concat(o[f])}return d},t.set=function(o,d){return nn(this),this.i=null,o=ps(this,o),Qs(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[d]),this.h+=1,this},t.get=function(o,d){return o?(o=this.V(o),0<o.length?String(o[0]):d):d};function ro(o,d,f){At(o,d),0<f.length&&(o.i=null,o.g.set(ps(o,d),P(f)),o.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var x=d[f];const F=encodeURIComponent(String(x)),J=this.V(x);for(x=0;x<J.length;x++){var D=F;J[x]!==""&&(D+="="+encodeURIComponent(String(J[x]))),o.push(D)}}return this.i=o.join("&")};function ps(o,d){return d=String(d),o.j&&(d=d.toLowerCase()),d}function so(o,d){d&&!o.j&&(nn(o),o.i=null,o.g.forEach(function(f,x){var D=x.toLowerCase();x!=D&&(At(this,x),ro(this,D,f))},o)),o.j=d}function Fu(o,d){const f=new fn;if(l.Image){const x=new Image;x.onload=I(at,f,"TestLoadImage: loaded",!0,d,x),x.onerror=I(at,f,"TestLoadImage: error",!1,d,x),x.onabort=I(at,f,"TestLoadImage: abort",!1,d,x),x.ontimeout=I(at,f,"TestLoadImage: timeout",!1,d,x),l.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=o}else d(!1)}function io(o,d){const f=new fn,x=new AbortController,D=setTimeout(()=>{x.abort(),at(f,"TestPingServer: timeout",!1,d)},1e4);fetch(o,{signal:x.signal}).then(F=>{clearTimeout(D),F.ok?at(f,"TestPingServer: ok",!0,d):at(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(D),at(f,"TestPingServer: error",!1,d)})}function at(o,d,f,x,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),x(f)}catch{}}function Cf(){this.g=new Bs}function ba(o,d,f){const x=f||"";try{no(o,function(D,F){let J=D;h(D)&&(J=nr(D)),d.push(x+F+"="+encodeURIComponent(J))})}catch(D){throw d.push(x+"type="+encodeURIComponent("_badmap")),D}}function gs(o){this.l=o.Ub||null,this.j=o.eb||!1}A(gs,ls),gs.prototype.g=function(){return new de(this.l,this.j)},gs.prototype.i=function(o){return function(){return o}}({});function de(o,d){rt.call(this),this.D=o,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(de,rt),t=de.prototype,t.open=function(o,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=d,this.readyState=1,mn(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(d.body=o),(this.D||l).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Le(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,mn(this)),this.g&&(this.readyState=3,mn(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ne(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ne(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var d=o.value?o.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!o.done}))&&(this.response=this.responseText+=d)}o.done?Le(this):mn(this),this.readyState==3&&Ne(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,Le(this))},t.Qa=function(o){this.g&&(this.response=o,Le(this))},t.ga=function(){this.g&&Le(this)};function Le(o){o.readyState=4,o.l=null,o.j=null,o.v=null,mn(o)}t.setRequestHeader=function(o,d){this.u.append(o,d)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=d.next();return o.join(`\r
`)};function mn(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(de.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Ks(o){let d="";return B(o,function(f,x){d+=x,d+=":",d+=f,d+=`\r
`}),d}function ms(o,d,f){e:{for(x in f){var x=!1;break e}x=!0}x||(f=Ks(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):z(o,d,f))}function Ye(o){rt.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(Ye,rt);var Zv=/^https?$/i,ex=["POST","PUT"];t=Ye.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,d,f,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);d=d?d.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():$s.g(),this.v=this.o?Te(this.o):Te($s),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(d,String(o),!0),this.B=!1}catch(F){Af(this,F);return}if(o=f||"",f=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var D in x)f.set(D,x[D]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const F of x.keys())f.set(F,x.get(F));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(f.keys()).find(F=>F.toLowerCase()=="content-type"),D=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(ex,d,void 0))||x||D||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,J]of f)this.g.setRequestHeader(F,J);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Pf(this),this.u=!0,this.g.send(o),this.u=!1}catch(F){Af(this,F)}};function Af(o,d){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=d,o.m=5,kf(o),ja(o)}function kf(o){o.A||(o.A=!0,gt(o,"complete"),gt(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,gt(this,"complete"),gt(this,"abort"),ja(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ja(this,!0)),Ye.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Rf(this):this.bb())},t.bb=function(){Rf(this)};function Rf(o){if(o.h&&typeof a<"u"&&(!o.v[1]||sr(o)!=4||o.Z()!=2)){if(o.u&&sr(o)==4)Er(o.Ea,0,o);else if(gt(o,"readystatechange"),sr(o)==4){o.h=!1;try{const J=o.Z();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var x;if(x=J===0){var D=String(o.D).match(qn)[1]||null;!D&&l.self&&l.self.location&&(D=l.self.location.protocol.slice(0,-1)),x=!Zv.test(D?D.toLowerCase():"")}f=x}if(f)gt(o,"complete"),gt(o,"success");else{o.m=6;try{var F=2<sr(o)?o.g.statusText:""}catch{F=""}o.l=F+" ["+o.Z()+"]",kf(o)}}finally{ja(o)}}}}function ja(o,d){if(o.g){Pf(o);const f=o.g,x=o.v[0]?()=>{}:null;o.g=null,o.v=null,d||gt(o,"ready");try{f.onreadystatechange=x}catch{}}}function Pf(o){o.I&&(l.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function sr(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<sr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var d=this.g.responseText;return o&&d.indexOf(o)==0&&(d=d.substring(o.length)),qi(d)}};function bf(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function tx(o){const d={};o=(o.g&&2<=sr(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<o.length;x++){if(E(o[x]))continue;var f=v(o[x]);const D=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const F=d[D]||[];d[D]=F,F.push(f)}S(d,function(x){return x.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function oo(o,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||d}function jf(o){this.Aa=0,this.i=[],this.j=new fn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=oo("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=oo("baseRetryDelayMs",5e3,o),this.cb=oo("retryDelaySeedMs",1e4,o),this.Wa=oo("forwardChannelMaxRetries",2,o),this.wa=oo("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new hs(o&&o.concurrentRequestLimit),this.Da=new Cf,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=jf.prototype,t.la=8,t.G=1,t.connect=function(o,d,f,x){mt(0),this.W=o,this.H=d||{},f&&x!==void 0&&(this.H.OSID=f,this.H.OAID=x),this.F=this.X,this.I=Bf(this,null,this.W),Na(this)};function Ou(o){if(Df(o),o.G==3){var d=o.U++,f=Rn(o.I);if(z(f,"SID",o.K),z(f,"RID",d),z(f,"TYPE","terminate"),ao(o,f),d=new Gt(o,o.j,d),d.L=2,d.v=Q(Rn(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=d.v,f=!0),f||(d.g=Uf(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Hs(d)}zf(o)}function Da(o){o.g&&(Bu(o),o.g.cancel(),o.g=null)}function Df(o){Da(o),o.u&&(l.clearTimeout(o.u),o.u=null),Ma(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function Na(o){if(!Ji(o.h)&&!o.s){o.s=!0;var d=o.Ga;U||V(),b||(U(),b=!0),j.add(d,o),o.B=0}}function nx(o,d){return Zi(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=d.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=An(y(o.Ga,o,d),Of(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const D=new Gt(this,this.j,o);let F=this.o;if(this.S&&(F?(F=g(F),C(F,this.S)):F=this.S),this.m!==null||this.O||(D.H=F,F=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var x=this.i[f];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(d+=x,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=Mf(this,D,d),f=Rn(this.I),z(f,"RID",o),z(f,"CVER",22),this.D&&z(f,"X-HTTP-Session-Id",this.D),ao(this,f),F&&(this.O?d="headers="+encodeURIComponent(String(Ks(F)))+"&"+d:this.m&&ms(f,this.m,F)),to(this.h,D),this.Ua&&z(f,"TYPE","init"),this.P?(z(f,"$req",d),z(f,"SID","null"),D.T=!0,ds(D,f,null)):ds(D,f,d),this.G=2}}else this.G==3&&(o?Nf(this,o):this.i.length==0||Ji(this.h)||Nf(this))};function Nf(o,d){var f;d?f=d.l:f=o.U++;const x=Rn(o.I);z(x,"SID",o.K),z(x,"RID",f),z(x,"AID",o.T),ao(o,x),o.m&&o.o&&ms(x,o.m,o.o),f=new Gt(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),d&&(o.i=d.D.concat(o.i)),d=Mf(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),to(o.h,f),ds(f,x,d)}function ao(o,d){o.H&&B(o.H,function(f,x){z(d,x,f)}),o.l&&no({},function(f,x){z(d,x,f)})}function Mf(o,d,f){f=Math.min(o.i.length,f);var x=o.l?y(o.l.Na,o.l,o):null;e:{var D=o.i;let F=-1;for(;;){const J=["count="+f];F==-1?0<f?(F=D[0].g,J.push("ofs="+F)):F=0:J.push("ofs="+F);let Me=!0;for(let yt=0;yt<f;yt++){let Pe=D[yt].g;const kt=D[yt].map;if(Pe-=F,0>Pe)F=Math.max(0,D[yt].g-100),Me=!1;else try{ba(kt,J,"req"+Pe+"_")}catch{x&&x(kt)}}if(Me){x=J.join("&");break e}}}return o=o.i.splice(0,f),d.D=o,x}function Vf(o){if(!o.g&&!o.u){o.Y=1;var d=o.Fa;U||V(),b||(U(),b=!0),j.add(d,o),o.v=0}}function zu(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=An(y(o.Fa,o),Of(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,Lf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=An(y(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,mt(10),Da(this),Lf(this))};function Bu(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function Lf(o){o.g=new Gt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var d=Rn(o.qa);z(d,"RID","rpc"),z(d,"SID",o.K),z(d,"AID",o.T),z(d,"CI",o.F?"0":"1"),!o.F&&o.ja&&z(d,"TO",o.ja),z(d,"TYPE","xmlhttp"),ao(o,d),o.m&&o.o&&ms(d,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=Q(Rn(d)),f.m=null,f.P=!0,Ar(f,o)}t.Za=function(){this.C!=null&&(this.C=null,Da(this),zu(this),mt(19))};function Ma(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function Ff(o,d){var f=null;if(o.g==d){Ma(o),Bu(o),o.g=null;var x=2}else if(eo(o.h,d))f=d.D,qs(o.h,d),x=1;else return;if(o.G!=0){if(d.o)if(x==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var D=o.B;x=Tr(),gt(x,new hn(x,f)),Na(o)}else Vf(o);else if(D=d.s,D==3||D==0&&0<d.X||!(x==1&&nx(o,d)||x==2&&zu(o)))switch(f&&0<f.length&&(d=o.h,d.i=d.i.concat(f)),D){case 1:ys(o,5);break;case 4:ys(o,10);break;case 3:ys(o,6);break;default:ys(o,2)}}}function Of(o,d){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*d}function ys(o,d){if(o.j.info("Error code "+d),d==2){var f=y(o.fb,o),x=o.Xa;const D=!x;x=new gn(x||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||fs(x,"https"),Q(x),D?Fu(x.toString(),f):io(x.toString(),f)}else mt(2);o.G=0,o.l&&o.l.sa(d),zf(o),Df(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),mt(2)):(this.j.info("Failed to ping google.com"),mt(1))};function zf(o){if(o.G=0,o.ka=[],o.l){const d=Hn(o.h);(d.length!=0||o.i.length!=0)&&(O(o.ka,d),O(o.ka,o.i),o.h.i.length=0,P(o.i),o.i.length=0),o.l.ra()}}function Bf(o,d,f){var x=f instanceof gn?Rn(f):new gn(f);if(x.g!="")d&&(x.g=d+"."+x.g),K(x,x.s);else{var D=l.location;x=D.protocol,d=d?d+"."+D.hostname:D.hostname,D=+D.port;var F=new gn(null);x&&fs(F,x),d&&(F.g=d),D&&K(F,D),f&&(F.l=f),x=F}return f=o.D,d=o.ya,f&&d&&z(x,f,d),z(x,"VER",o.la),ao(o,x),x}function Uf(o,d,f){if(d&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=o.Ca&&!o.pa?new Ye(new gs({eb:f})):new Ye(o.pa),d.Ha(o.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function $f(){}t=$f.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Va(){}Va.prototype.g=function(o,d){return new rn(o,d)};function rn(o,d){rt.call(this),this.g=new jf(d),this.l=o,this.h=d&&d.messageUrlParams||null,o=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(o?o["X-WebChannel-Content-Type"]=d.messageContentType:o={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(o?o["X-WebChannel-Client-Profile"]=d.va:o={"X-WebChannel-Client-Profile":d.va}),this.g.S=o,(o=d&&d.Sb)&&!E(o)&&(this.g.m=o),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!E(d)&&(this.g.D=d,o=this.h,o!==null&&d in o&&(o=this.h,d in o&&delete o[d])),this.j=new Ys(this)}A(rn,rt),rn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},rn.prototype.close=function(){Ou(this.g)},rn.prototype.o=function(o){var d=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=nr(o),o=f);d.i.push(new Lu(d.Ya++,o)),d.G==3&&Na(d)},rn.prototype.N=function(){this.g.l=null,delete this.j,Ou(this.g),delete this.g,rn.aa.N.call(this)};function Wf(o){us.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var d=o.__sm__;if(d){e:{for(const f in d){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,d=d!==null&&o in d?d[o]:void 0),this.data=d}else this.data=o}A(Wf,us);function Hf(){Ca.call(this),this.status=1}A(Hf,Ca);function Ys(o){this.g=o}A(Ys,$f),Ys.prototype.ua=function(){gt(this.g,"a")},Ys.prototype.ta=function(o){gt(this.g,new Wf(o))},Ys.prototype.sa=function(o){gt(this.g,new Hf)},Ys.prototype.ra=function(){gt(this.g,"b")},Va.prototype.createWebChannel=Va.prototype.g,rn.prototype.send=rn.prototype.o,rn.prototype.open=rn.prototype.m,rn.prototype.close=rn.prototype.close,j0=function(){return new Va},b0=function(){return Tr()},P0=In,Td={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},cs.NO_ERROR=0,cs.TIMEOUT=8,cs.HTTP_ERROR=6,yl=cs,Us.COMPLETE="complete",R0=Us,En.EventType=Tn,Tn.OPEN="a",Tn.CLOSE="b",Tn.ERROR="c",Tn.MESSAGE="d",rt.prototype.listen=rt.prototype.K,So=En,Ye.prototype.listenOnce=Ye.prototype.L,Ye.prototype.getLastError=Ye.prototype.Ka,Ye.prototype.getLastErrorCode=Ye.prototype.Ba,Ye.prototype.getStatus=Ye.prototype.Z,Ye.prototype.getResponseJson=Ye.prototype.Oa,Ye.prototype.getResponseText=Ye.prototype.oa,Ye.prototype.send=Ye.prototype.ea,Ye.prototype.setWithCredentials=Ye.prototype.Ha,k0=Ye}).apply(typeof tl<"u"?tl:typeof self<"u"?self:typeof window<"u"?window:{});const hg="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qt.UNAUTHENTICATED=new Qt(null),Qt.GOOGLE_CREDENTIALS=new Qt("google-credentials-uid"),Qt.FIRST_PARTY=new Qt("first-party-uid"),Qt.MOCK_USER=new Qt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zi="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds=new _0("@firebase/firestore");function yo(){return Ds.logLevel}function se(t,...e){if(Ds.logLevel<=Ae.DEBUG){const n=e.map(Bh);Ds.debug(`Firestore (${zi}): ${t}`,...n)}}function vr(t,...e){if(Ds.logLevel<=Ae.ERROR){const n=e.map(Bh);Ds.error(`Firestore (${zi}): ${t}`,...n)}}function sa(t,...e){if(Ds.logLevel<=Ae.WARN){const n=e.map(Bh);Ds.warn(`Firestore (${zi}): ${t}`,...n)}}function Bh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function he(t="Unexpected state"){const e=`FIRESTORE (${zi}) INTERNAL ASSERTION FAILED: `+t;throw vr(e),new Error(e)}function De(t,e){t||he()}function pe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends Oi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Qt.UNAUTHENTICATED))}shutdown(){}}class aS{constructor(e){this.t=e,this.currentUser=Qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){De(this.o===void 0);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new hr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new hr,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(se("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new hr)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(De(typeof r.accessToken=="string"),new iS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return De(e===null||typeof e=="string"),new Qt(e)}}class lS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Qt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class uS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new lS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Qt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){De(this.o===void 0);const r=i=>{i.error!=null&&se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,se("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(De(typeof n.token=="string"),this.R=n.token,new cS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=hS(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function be(t,e){return t<e?-1:t>e?1:0}function Pi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new te(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new te(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new te(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ct.fromMillis(Date.now())}static fromDate(e){return ct.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new ct(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?be(this.nanoseconds,e.nanoseconds):be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new fe(e)}static min(){return new fe(new ct(0,0))}static max(){return new fe(new ct(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,n,r){n===void 0?n=0:n>e.length&&he(),r===void 0?r=e.length-n:r>e.length-n&&he(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ia.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ia?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ze extends ia{construct(e,n,r){return new ze(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new te(H.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ze(n)}static emptyPath(){return new ze([])}}const fS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wt extends ia{construct(e,n,r){return new wt(e,n,r)}static isValidIdentifier(e){return fS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new wt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new te(H.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new te(H.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new te(H.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new te(H.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wt(n)}static emptyPath(){return new wt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.path=e}static fromPath(e){return new le(ze.fromString(e))}static fromName(e){return new le(ze.fromString(e).popFirst(5))}static empty(){return new le(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ze.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new le(new ze(e.slice()))}}function pS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=fe.fromTimestamp(r===1e9?new ct(n+1,0):new ct(n,r));return new Xr(s,le.empty(),e)}function gS(t){return new Xr(t.readTime,t.key,-1)}class Xr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Xr(fe.min(),le.empty(),-1)}static max(){return new Xr(fe.max(),le.empty(),-1)}}function mS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=le.comparator(t.documentKey,e.documentKey),n!==0?n:be(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ya(t){if(t.code!==H.FAILED_PRECONDITION||t.message!==yS)throw t;se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&he(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new G((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof G?n:G.resolve(n)}catch(n){return G.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):G.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):G.reject(n)}static resolve(e){return new G((n,r)=>{n(e)})}static reject(e){return new G((n,r)=>{r(e)})}static waitFor(e){return new G((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},c=>r(c))}),a=!0,i===s&&n()})}static or(e){let n=G.resolve(!1);for(const r of e)n=n.next(s=>s?G.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new G((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let c=0;c<i;c++){const h=c;n(e[h]).next(p=>{a[h]=p,++l,l===i&&r(a)},p=>s(p))}})}static doWhile(e,n){return new G((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function xS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function va(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Uh.oe=-1;function _u(t){return t==null}function Kl(t){return t===0&&1/t==-1/0}function _S(t){return typeof t=="number"&&Number.isInteger(t)&&!Kl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Fs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function N0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e,n){this.comparator=e,this.root=n||_t.EMPTY}insert(e,n){return new Ge(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_t.BLACK,null,null))}remove(e){return new Ge(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_t.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nl(this.root,e,this.comparator,!1)}getReverseIterator(){return new nl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nl(this.root,e,this.comparator,!0)}}class nl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _t{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??_t.RED,this.left=s??_t.EMPTY,this.right=i??_t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new _t(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return _t.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw he();const e=this.left.check();if(e!==this.right.check())throw he();return e+(this.isRed()?0:1)}}_t.EMPTY=null,_t.RED=!0,_t.BLACK=!1;_t.EMPTY=new class{constructor(){this.size=0}get key(){throw he()}get value(){throw he()}get color(){throw he()}get left(){throw he()}get right(){throw he()}copy(e,n,r,s,i){return this}insert(e,n,r){return new _t(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.comparator=e,this.data=new Ge(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new pg(this.data.getIterator())}getIteratorFrom(e){return new pg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Et)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Et(this.comparator);return n.data=e,n}}class pg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.fields=e,e.sort(wt.comparator)}static empty(){return new an([])}unionWith(e){let n=new Et(wt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new an(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Pi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new M0("Invalid base64 string: "+i):i}}(e);return new It(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new It(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}It.EMPTY_BYTE_STRING=new It("");const wS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Jr(t){if(De(!!t),typeof t=="string"){let e=0;const n=wS.exec(t);if(De(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:et(t.seconds),nanos:et(t.nanos)}}function et(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ns(t){return typeof t=="string"?It.fromBase64String(t):It.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Wh(t){const e=t.mapValue.fields.__previous_value__;return $h(e)?Wh(e):e}function oa(t){const e=Jr(t.mapValue.fields.__local_write_time__.timestampValue);return new ct(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,n,r,s,i,a,l,c,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=h}}class aa{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new aa("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof aa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rl={mapValue:{}};function Ms(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?$h(t)?4:TS(t)?9007199254740991:ES(t)?10:11:he()}function er(t,e){if(t===e)return!0;const n=Ms(t);if(n!==Ms(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return oa(t).isEqual(oa(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=Jr(s.timestampValue),l=Jr(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Ns(s.bytesValue).isEqual(Ns(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return et(s.geoPointValue.latitude)===et(i.geoPointValue.latitude)&&et(s.geoPointValue.longitude)===et(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return et(s.integerValue)===et(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=et(s.doubleValue),l=et(i.doubleValue);return a===l?Kl(a)===Kl(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return Pi(t.arrayValue.values||[],e.arrayValue.values||[],er);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(fg(a)!==fg(l))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(l[c]===void 0||!er(a[c],l[c])))return!1;return!0}(t,e);default:return he()}}function la(t,e){return(t.values||[]).find(n=>er(n,e))!==void 0}function bi(t,e){if(t===e)return 0;const n=Ms(t),r=Ms(e);if(n!==r)return be(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return be(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=et(i.integerValue||i.doubleValue),c=et(a.integerValue||a.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return gg(t.timestampValue,e.timestampValue);case 4:return gg(oa(t),oa(e));case 5:return be(t.stringValue,e.stringValue);case 6:return function(i,a){const l=Ns(i),c=Ns(a);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),c=a.split("/");for(let h=0;h<l.length&&h<c.length;h++){const p=be(l[h],c[h]);if(p!==0)return p}return be(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=be(et(i.latitude),et(a.latitude));return l!==0?l:be(et(i.longitude),et(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return mg(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,c,h,p;const m=i.fields||{},y=a.fields||{},I=(l=m.value)===null||l===void 0?void 0:l.arrayValue,A=(c=y.value)===null||c===void 0?void 0:c.arrayValue,P=be(((h=I==null?void 0:I.values)===null||h===void 0?void 0:h.length)||0,((p=A==null?void 0:A.values)===null||p===void 0?void 0:p.length)||0);return P!==0?P:mg(I,A)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===rl.mapValue&&a===rl.mapValue)return 0;if(i===rl.mapValue)return 1;if(a===rl.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),h=a.fields||{},p=Object.keys(h);c.sort(),p.sort();for(let m=0;m<c.length&&m<p.length;++m){const y=be(c[m],p[m]);if(y!==0)return y;const I=bi(l[c[m]],h[p[m]]);if(I!==0)return I}return be(c.length,p.length)}(t.mapValue,e.mapValue);default:throw he()}}function gg(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return be(t,e);const n=Jr(t),r=Jr(e),s=be(n.seconds,r.seconds);return s!==0?s:be(n.nanos,r.nanos)}function mg(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=bi(n[s],r[s]);if(i)return i}return be(n.length,r.length)}function ji(t){return Id(t)}function Id(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Jr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ns(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return le.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Id(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Id(n.fields[a])}`;return s+"}"}(t.mapValue):he()}function yg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Cd(t){return!!t&&"integerValue"in t}function Hh(t){return!!t&&"arrayValue"in t}function vg(t){return!!t&&"nullValue"in t}function xg(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function vl(t){return!!t&&"mapValue"in t}function ES(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Mo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Fs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Mo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Mo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function TS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.value=e}static empty(){return new Yt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!vl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Mo(n)}setAll(e){let n=wt.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=Mo(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());vl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return er(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];vl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Fs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Yt(Mo(this.value))}}function V0(t){const e=[];return Fs(t.fields,(n,r)=>{const s=new wt([n]);if(vl(r)){const i=V0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new an(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Nt(e,0,fe.min(),fe.min(),fe.min(),Yt.empty(),0)}static newFoundDocument(e,n,r,s){return new Nt(e,1,n,fe.min(),r,s,0)}static newNoDocument(e,n){return new Nt(e,2,n,fe.min(),fe.min(),Yt.empty(),0)}static newUnknownDocument(e,n){return new Nt(e,3,n,fe.min(),fe.min(),Yt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Yt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Yt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Nt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,n){this.position=e,this.inclusive=n}}function _g(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=le.comparator(le.fromName(a.referenceValue),n.key):r=bi(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function wg(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!er(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e,n="asc"){this.field=e,this.dir=n}}function IS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{}class ot extends L0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new AS(e,n,r):n==="array-contains"?new PS(e,r):n==="in"?new bS(e,r):n==="not-in"?new jS(e,r):n==="array-contains-any"?new DS(e,r):new ot(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new kS(e,r):new RS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(bi(n,this.value)):n!==null&&Ms(this.value)===Ms(n)&&this.matchesComparison(bi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return he()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Un extends L0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Un(e,n)}matches(e){return F0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function F0(t){return t.op==="and"}function O0(t){return CS(t)&&F0(t)}function CS(t){for(const e of t.filters)if(e instanceof Un)return!1;return!0}function Ad(t){if(t instanceof ot)return t.field.canonicalString()+t.op.toString()+ji(t.value);if(O0(t))return t.filters.map(e=>Ad(e)).join(",");{const e=t.filters.map(n=>Ad(n)).join(",");return`${t.op}(${e})`}}function z0(t,e){return t instanceof ot?function(r,s){return s instanceof ot&&r.op===s.op&&r.field.isEqual(s.field)&&er(r.value,s.value)}(t,e):t instanceof Un?function(r,s){return s instanceof Un&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&z0(a,s.filters[l]),!0):!1}(t,e):void he()}function B0(t){return t instanceof ot?function(n){return`${n.field.canonicalString()} ${n.op} ${ji(n.value)}`}(t):t instanceof Un?function(n){return n.op.toString()+" {"+n.getFilters().map(B0).join(" ,")+"}"}(t):"Filter"}class AS extends ot{constructor(e,n,r){super(e,n,r),this.key=le.fromName(r.referenceValue)}matches(e){const n=le.comparator(e.key,this.key);return this.matchesComparison(n)}}class kS extends ot{constructor(e,n){super(e,"in",n),this.keys=U0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class RS extends ot{constructor(e,n){super(e,"not-in",n),this.keys=U0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function U0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>le.fromName(r.referenceValue))}class PS extends ot{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Hh(n)&&la(n.arrayValue,this.value)}}class bS extends ot{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&la(this.value.arrayValue,n)}}class jS extends ot{constructor(e,n){super(e,"not-in",n)}matches(e){if(la(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!la(this.value.arrayValue,n)}}class DS extends ot{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Hh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>la(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function Sg(t,e=null,n=[],r=[],s=null,i=null,a=null){return new NS(t,e,n,r,s,i,a)}function qh(t){const e=pe(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Ad(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),_u(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ji(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ji(r)).join(",")),e.ue=n}return e.ue}function Gh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!IS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!z0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!wg(t.startAt,e.startAt)&&wg(t.endAt,e.endAt)}function kd(t){return le.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function MS(t,e,n,r,s,i,a,l){return new xa(t,e,n,r,s,i,a,l)}function Qh(t){return new xa(t)}function Eg(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function $0(t){return t.collectionGroup!==null}function Vo(t){const e=pe(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new Et(wt.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Xl(i,r))}),n.has(wt.keyField().canonicalString())||e.ce.push(new Xl(wt.keyField(),r))}return e.ce}function Jn(t){const e=pe(t);return e.le||(e.le=VS(e,Vo(t))),e.le}function VS(t,e){if(t.limitType==="F")return Sg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Xl(s.field,i)});const n=t.endAt?new Yl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Yl(t.startAt.position,t.startAt.inclusive):null;return Sg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Rd(t,e){const n=t.filters.concat([e]);return new xa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Pd(t,e,n){return new xa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function wu(t,e){return Gh(Jn(t),Jn(e))&&t.limitType===e.limitType}function W0(t){return`${qh(Jn(t))}|lt:${t.limitType}`}function Zs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>B0(s)).join(", ")}]`),_u(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ji(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ji(s)).join(",")),`Target(${r})`}(Jn(t))}; limitType=${t.limitType})`}function Su(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):le.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Vo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,c){const h=_g(a,l,c);return a.inclusive?h<=0:h<0}(r.startAt,Vo(r),s)||r.endAt&&!function(a,l,c){const h=_g(a,l,c);return a.inclusive?h>=0:h>0}(r.endAt,Vo(r),s))}(t,e)}function LS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function H0(t){return(e,n)=>{let r=!1;for(const s of Vo(t)){const i=FS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function FS(t,e,n){const r=t.field.isKeyField()?le.comparator(e.key,n.key):function(i,a,l){const c=a.data.field(i),h=l.data.field(i);return c!==null&&h!==null?bi(c,h):he()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return he()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Fs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return N0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=new Ge(le.comparator);function xr(){return OS}const q0=new Ge(le.comparator);function Eo(...t){let e=q0;for(const n of t)e=e.insert(n.key,n);return e}function G0(t){let e=q0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ts(){return Lo()}function Q0(){return Lo()}function Lo(){return new Bi(t=>t.toString(),(t,e)=>t.isEqual(e))}const zS=new Ge(le.comparator),BS=new Et(le.comparator);function we(...t){let e=BS;for(const n of t)e=e.add(n);return e}const US=new Et(be);function $S(){return US}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Kl(e)?"-0":e}}function K0(t){return{integerValue:""+t}}function WS(t,e){return _S(e)?K0(e):Kh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(){this._=void 0}}function HS(t,e,n){return t instanceof ua?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&$h(i)&&(i=Wh(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof ca?X0(t,e):t instanceof da?J0(t,e):function(s,i){const a=Y0(s,i),l=Tg(a)+Tg(s.Pe);return Cd(a)&&Cd(s.Pe)?K0(l):Kh(s.serializer,l)}(t,e)}function qS(t,e,n){return t instanceof ca?X0(t,e):t instanceof da?J0(t,e):n}function Y0(t,e){return t instanceof Jl?function(r){return Cd(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ua extends Eu{}class ca extends Eu{constructor(e){super(),this.elements=e}}function X0(t,e){const n=Z0(e);for(const r of t.elements)n.some(s=>er(s,r))||n.push(r);return{arrayValue:{values:n}}}class da extends Eu{constructor(e){super(),this.elements=e}}function J0(t,e){let n=Z0(e);for(const r of t.elements)n=n.filter(s=>!er(s,r));return{arrayValue:{values:n}}}class Jl extends Eu{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Tg(t){return et(t.integerValue||t.doubleValue)}function Z0(t){return Hh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,n){this.field=e,this.transform=n}}function QS(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof ca&&s instanceof ca||r instanceof da&&s instanceof da?Pi(r.elements,s.elements,er):r instanceof Jl&&s instanceof Jl?er(r.Pe,s.Pe):r instanceof ua&&s instanceof ua}(t.transform,e.transform)}class KS{constructor(e,n){this.version=e,this.transformResults=n}}class On{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new On}static exists(e){return new On(void 0,e)}static updateTime(e){return new On(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Tu{}function ev(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new nv(t.key,On.none()):new _a(t.key,t.data,On.none());{const n=t.data,r=Yt.empty();let s=new Et(wt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new rs(t.key,r,new an(s.toArray()),On.none())}}function YS(t,e,n){t instanceof _a?function(s,i,a){const l=s.value.clone(),c=Cg(s.fieldTransforms,i,a.transformResults);l.setAll(c),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof rs?function(s,i,a){if(!xl(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=Cg(s.fieldTransforms,i,a.transformResults),c=i.data;c.setAll(tv(s)),c.setAll(l),i.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function Fo(t,e,n,r){return t instanceof _a?function(i,a,l,c){if(!xl(i.precondition,a))return l;const h=i.value.clone(),p=Ag(i.fieldTransforms,c,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof rs?function(i,a,l,c){if(!xl(i.precondition,a))return l;const h=Ag(i.fieldTransforms,c,a),p=a.data;return p.setAll(tv(i)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,a,l){return xl(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function XS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Y0(r.transform,s||null);i!=null&&(n===null&&(n=Yt.empty()),n.set(r.field,i))}return n||null}function Ig(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Pi(r,s,(i,a)=>QS(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class _a extends Tu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class rs extends Tu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function tv(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Cg(t,e,n){const r=new Map;De(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,qS(a,l,n[s]))}return r}function Ag(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,HS(i,a,e))}return r}class nv extends Tu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class JS extends Tu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&YS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Fo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Fo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Q0();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const c=ev(a,l);c!==null&&r.set(s.key,c),a.isValidDocument()||a.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),we())}isEqual(e){return this.batchId===e.batchId&&Pi(this.mutations,e.mutations,(n,r)=>Ig(n,r))&&Pi(this.baseMutations,e.baseMutations,(n,r)=>Ig(n,r))}}class Yh{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){De(e.mutations.length===r.length);let s=function(){return zS}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Yh(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st,Ie;function nE(t){switch(t){default:return he();case H.CANCELLED:case H.UNKNOWN:case H.DEADLINE_EXCEEDED:case H.RESOURCE_EXHAUSTED:case H.INTERNAL:case H.UNAVAILABLE:case H.UNAUTHENTICATED:return!1;case H.INVALID_ARGUMENT:case H.NOT_FOUND:case H.ALREADY_EXISTS:case H.PERMISSION_DENIED:case H.FAILED_PRECONDITION:case H.ABORTED:case H.OUT_OF_RANGE:case H.UNIMPLEMENTED:case H.DATA_LOSS:return!0}}function rv(t){if(t===void 0)return vr("GRPC error has no .code"),H.UNKNOWN;switch(t){case st.OK:return H.OK;case st.CANCELLED:return H.CANCELLED;case st.UNKNOWN:return H.UNKNOWN;case st.DEADLINE_EXCEEDED:return H.DEADLINE_EXCEEDED;case st.RESOURCE_EXHAUSTED:return H.RESOURCE_EXHAUSTED;case st.INTERNAL:return H.INTERNAL;case st.UNAVAILABLE:return H.UNAVAILABLE;case st.UNAUTHENTICATED:return H.UNAUTHENTICATED;case st.INVALID_ARGUMENT:return H.INVALID_ARGUMENT;case st.NOT_FOUND:return H.NOT_FOUND;case st.ALREADY_EXISTS:return H.ALREADY_EXISTS;case st.PERMISSION_DENIED:return H.PERMISSION_DENIED;case st.FAILED_PRECONDITION:return H.FAILED_PRECONDITION;case st.ABORTED:return H.ABORTED;case st.OUT_OF_RANGE:return H.OUT_OF_RANGE;case st.UNIMPLEMENTED:return H.UNIMPLEMENTED;case st.DATA_LOSS:return H.DATA_LOSS;default:return he()}}(Ie=st||(st={}))[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE=new As([4294967295,4294967295],0);function kg(t){const e=rE().encode(t),n=new A0;return n.update(e),new Uint8Array(n.digest())}function Rg(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new As([n,r],0),new As([s,i],0)]}class Xh{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new To(`Invalid padding: ${n}`);if(r<0)throw new To(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new To(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new To(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=As.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(As.fromNumber(r)));return s.compare(sE)===1&&(s=new As([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=kg(e),[r,s]=Rg(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Xh(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=kg(e),[r,s]=Rg(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class To extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,wa.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Iu(fe.min(),s,new Ge(be),xr(),we())}}class wa{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new wa(r,n,we(),we(),we())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class sv{constructor(e,n){this.targetId=e,this.me=n}}class iv{constructor(e,n,r=It.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Pg{constructor(){this.fe=0,this.ge=jg(),this.pe=It.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=we(),n=we(),r=we();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:he()}}),new wa(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=jg()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,De(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class iE{constructor(e){this.Le=e,this.Be=new Map,this.ke=xr(),this.qe=bg(),this.Qe=new Ge(be)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:he()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(kd(i))if(r===0){const a=new le(i.path);this.Ue(n,a,Nt.newNoDocument(a,fe.min()))}else De(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),c=l?this.Xe(l,e,a):1;if(c!==0){this.je(n);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=Ns(r).toUint8Array()}catch(c){if(c instanceof M0)return sa("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Xh(a,s,i)}catch(c){return sa(c instanceof To?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&kd(l.target)){const c=new le(l.target.path);this.ke.get(c)!==null||this.it(a,c)||this.Ue(a,c,Nt.newNoDocument(c,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=we();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(c=>{const h=this.Je(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new Iu(e,n,this.Qe,this.ke,r);return this.ke=xr(),this.qe=bg(),this.Qe=new Ge(be),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Pg,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Et(be),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||se("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Pg),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function bg(){return new Ge(le.comparator)}function jg(){return new Ge(le.comparator)}const oE={asc:"ASCENDING",desc:"DESCENDING"},aE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lE={and:"AND",or:"OR"};class uE{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function bd(t,e){return t.useProto3Json||_u(e)?e:{value:e}}function Zl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ov(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function cE(t,e){return Zl(t,e.toTimestamp())}function Zn(t){return De(!!t),fe.fromTimestamp(function(n){const r=Jr(n);return new ct(r.seconds,r.nanos)}(t))}function Jh(t,e){return jd(t,e).canonicalString()}function jd(t,e){const n=function(s){return new ze(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function av(t){const e=ze.fromString(t);return De(hv(e)),e}function Dd(t,e){return Jh(t.databaseId,e.path)}function xc(t,e){const n=av(e);if(n.get(1)!==t.databaseId.projectId)throw new te(H.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new te(H.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new le(uv(n))}function lv(t,e){return Jh(t.databaseId,e)}function dE(t){const e=av(t);return e.length===4?ze.emptyPath():uv(e)}function Nd(t){return new ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function uv(t){return De(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Dg(t,e,n){return{name:Dd(t,e),fields:n.value.mapValue.fields}}function hE(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:he()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,p){return h.useProto3Json?(De(p===void 0||typeof p=="string"),It.fromBase64String(p||"")):(De(p===void 0||p instanceof Buffer||p instanceof Uint8Array),It.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){const p=h.code===void 0?H.UNKNOWN:rv(h.code);return new te(p,h.message||"")}(a);n=new iv(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=xc(t,r.document.name),i=Zn(r.document.updateTime),a=r.document.createTime?Zn(r.document.createTime):fe.min(),l=new Yt({mapValue:{fields:r.document.fields}}),c=Nt.newFoundDocument(s,i,a,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new _l(h,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=xc(t,r.document),i=r.readTime?Zn(r.readTime):fe.min(),a=Nt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new _l([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=xc(t,r.document),i=r.removedTargetIds||[];n=new _l([],i,s,null)}else{if(!("filter"in e))return he();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new tE(s,i),l=r.targetId;n=new sv(l,a)}}return n}function fE(t,e){let n;if(e instanceof _a)n={update:Dg(t,e.key,e.value)};else if(e instanceof nv)n={delete:Dd(t,e.key)};else if(e instanceof rs)n={update:Dg(t,e.key,e.data),updateMask:SE(e.fieldMask)};else{if(!(e instanceof JS))return he();n={verify:Dd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof ua)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ca)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof da)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Jl)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw he()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:cE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:he()}(t,e.precondition)),n}function pE(t,e){return t&&t.length>0?(De(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?Zn(s.updateTime):Zn(i);return a.isEqual(fe.min())&&(a=Zn(i)),new KS(a,s.transformResults||[])}(n,e))):[]}function gE(t,e){return{documents:[lv(t,e.path)]}}function mE(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=lv(t,s);const i=function(h){if(h.length!==0)return dv(Un.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(h){if(h.length!==0)return h.map(p=>function(y){return{field:ei(y.field),direction:xE(y.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=bd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function yE(t){let e=dE(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){De(r===1);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(m){const y=cv(m);return y instanceof Un&&O0(y)?y.getFilters():[y]}(n.where));let a=[];n.orderBy&&(a=function(m){return m.map(y=>function(A){return new Xl(ti(A.field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(y))}(n.orderBy));let l=null;n.limit&&(l=function(m){let y;return y=typeof m=="object"?m.value:m,_u(y)?null:y}(n.limit));let c=null;n.startAt&&(c=function(m){const y=!!m.before,I=m.values||[];return new Yl(I,y)}(n.startAt));let h=null;return n.endAt&&(h=function(m){const y=!m.before,I=m.values||[];return new Yl(I,y)}(n.endAt)),MS(e,s,a,i,l,"F",c,h)}function vE(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return he()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function cv(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ti(n.unaryFilter.field);return ot.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ti(n.unaryFilter.field);return ot.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ti(n.unaryFilter.field);return ot.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ti(n.unaryFilter.field);return ot.create(a,"!=",{nullValue:"NULL_VALUE"});default:return he()}}(t):t.fieldFilter!==void 0?function(n){return ot.create(ti(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return he()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Un.create(n.compositeFilter.filters.map(r=>cv(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return he()}}(n.compositeFilter.op))}(t):he()}function xE(t){return oE[t]}function _E(t){return aE[t]}function wE(t){return lE[t]}function ei(t){return{fieldPath:t.canonicalString()}}function ti(t){return wt.fromServerFormat(t.fieldPath)}function dv(t){return t instanceof ot?function(n){if(n.op==="=="){if(xg(n.value))return{unaryFilter:{field:ei(n.field),op:"IS_NAN"}};if(vg(n.value))return{unaryFilter:{field:ei(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(xg(n.value))return{unaryFilter:{field:ei(n.field),op:"IS_NOT_NAN"}};if(vg(n.value))return{unaryFilter:{field:ei(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ei(n.field),op:_E(n.op),value:n.value}}}(t):t instanceof Un?function(n){const r=n.getFilters().map(s=>dv(s));return r.length===1?r[0]:{compositeFilter:{op:wE(n.op),filters:r}}}(t):he()}function SE(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function hv(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,n,r,s,i=fe.min(),a=fe.min(),l=It.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Vr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Vr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Vr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Vr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e){this.ct=e}}function TE(t){const e=yE({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Pd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(){this.un=new CE}addToCollectionParentIndex(e,n){return this.un.add(n),G.resolve()}getCollectionParents(e,n){return G.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return G.resolve()}deleteFieldIndex(e,n){return G.resolve()}deleteAllFieldIndexes(e){return G.resolve()}createTargetIndexes(e,n){return G.resolve()}getDocumentsMatchingTarget(e,n){return G.resolve(null)}getIndexType(e,n){return G.resolve(0)}getFieldIndexes(e,n){return G.resolve([])}getNextCollectionGroupToUpdate(e){return G.resolve(null)}getMinOffset(e,n){return G.resolve(Xr.min())}getMinOffsetFromCollectionGroup(e,n){return G.resolve(Xr.min())}updateCollectionGroup(e,n,r){return G.resolve()}updateIndexEntries(e,n){return G.resolve()}}class CE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Et(ze.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Et(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Di(0)}static kn(){return new Di(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(){this.changes=new Bi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Nt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?G.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Fo(r.mutation,s,an.empty(),ct.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,we()).next(()=>r))}getLocalViewOfDocuments(e,n,r=we()){const s=Ts();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=Eo();return i.forEach((l,c)=>{a=a.insert(l,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Ts();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,we()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=xr();const a=Lo(),l=function(){return Lo()}();return n.forEach((c,h)=>{const p=r.get(h.key);s.has(h.key)&&(p===void 0||p.mutation instanceof rs)?i=i.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),Fo(p.mutation,h,p.mutation.getFieldMask(),ct.now())):a.set(h.key,an.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((h,p)=>a.set(h,p)),n.forEach((h,p)=>{var m;return l.set(h,new kE(p,(m=a.get(h))!==null&&m!==void 0?m:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Lo();let s=new Ge((a,l)=>a-l),i=we();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(c=>{const h=n.get(c);if(h===null)return;let p=r.get(c)||an.empty();p=l.applyToLocalView(h,p),r.set(c,p);const m=(s.get(l.batchId)||we()).add(c);s=s.insert(l.batchId,m)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),h=c.key,p=c.value,m=Q0();p.forEach(y=>{if(!i.has(y)){const I=ev(n.get(y),r.get(y));I!==null&&m.set(y,I),i=i.add(y)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return G.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return le.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):$0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):G.resolve(Ts());let l=-1,c=i;return a.next(h=>G.forEach(h,(p,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),i.get(p)?G.resolve():this.remoteDocumentCache.getEntry(e,p).next(y=>{c=c.insert(p,y)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,c,h,we())).next(p=>({batchId:l,changes:G0(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new le(n)).next(r=>{let s=Eo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=Eo();return this.indexManager.getCollectionParents(e,i).next(l=>G.forEach(l,c=>{const h=function(m,y){return new xa(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(p=>{p.forEach((m,y)=>{a=a.insert(m,y)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((c,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,Nt.newInvalidDocument(p)))});let l=Eo();return a.forEach((c,h)=>{const p=i.get(c);p!==void 0&&Fo(p.mutation,h,an.empty(),ct.now()),Su(n,h)&&(l=l.insert(c,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return G.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Zn(s.createTime)}}(n)),G.resolve()}getNamedQuery(e,n){return G.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:TE(s.bundledQuery),readTime:Zn(s.readTime)}}(n)),G.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(){this.overlays=new Ge(le.comparator),this.Ir=new Map}getOverlay(e,n){return G.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ts();return G.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),G.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),G.resolve()}getOverlaysForCollection(e,n,r){const s=Ts(),i=n.length+1,a=new le(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const c=l.getNext().value,h=c.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return G.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ge((h,p)=>h-p);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=i.get(h.largestBatchId);p===null&&(p=Ts(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=Ts(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=s)););return G.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new eE(n,r));let i=this.Ir.get(n);i===void 0&&(i=we(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(){this.sessionToken=It.EMPTY_BYTE_STRING}getSessionToken(e){return G.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,G.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(){this.Tr=new Et(dt.Er),this.dr=new Et(dt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new dt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new dt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new le(new ze([])),r=new dt(n,e),s=new dt(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new le(new ze([])),r=new dt(n,e),s=new dt(n,e+1);let i=we();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new dt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class dt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return le.comparator(e.key,n.key)||be(e.wr,n.wr)}static Ar(e,n){return be(e.wr,n.wr)||le.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Et(dt.Er)}checkEmpty(e){return G.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new ZS(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new dt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return G.resolve(a)}lookupMutationBatch(e,n){return G.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return G.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return G.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return G.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new dt(n,0),s=new dt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),G.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Et(be);return n.forEach(s=>{const i=new dt(s,0),a=new dt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),G.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;le.isDocumentKey(i)||(i=i.child(""));const a=new dt(new le(i),0);let l=new Et(be);return this.br.forEachWhile(c=>{const h=c.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(l=l.add(c.wr)),!0)},a),G.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){De(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return G.forEach(n.mutations,s=>{const i=new dt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new dt(n,0),s=this.br.firstAfterOrEqual(r);return G.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,G.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e){this.Mr=e,this.docs=function(){return new Ge(le.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return G.resolve(r?r.document.mutableCopy():Nt.newInvalidDocument(n))}getEntries(e,n){let r=xr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Nt.newInvalidDocument(s))}),G.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=xr();const a=n.path,l=new le(a.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:h,value:{document:p}}=c.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||mS(gS(p),r)<=0||(s.has(p.key)||Su(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return G.resolve(i)}getAllFromCollectionGroup(e,n,r,s){he()}Or(e,n){return G.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new ME(this)}getSize(e){return G.resolve(this.size)}}class ME extends AE{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),G.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e){this.persistence=e,this.Nr=new Bi(n=>qh(n),Gh),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Zh,this.targetCount=0,this.kr=Di.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),G.resolve()}getLastRemoteSnapshotVersion(e){return G.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return G.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),G.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),G.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Di(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,G.resolve()}updateTargetData(e,n){return this.Kn(n),G.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,G.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),G.waitFor(i).next(()=>s)}getTargetCount(e){return G.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return G.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),G.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),G.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),G.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return G.resolve(r)}containsKey(e,n){return G.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Uh(0),this.Kr=!1,this.Kr=!0,this.$r=new jE,this.referenceDelegate=e(this),this.Ur=new VE(this),this.indexManager=new IE,this.remoteDocumentCache=function(s){return new NE(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new EE(n),this.Gr=new PE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new bE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new DE(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){se("MemoryPersistence","Starting transaction:",e);const s=new FE(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return G.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class FE extends vS{constructor(e){super(),this.currentSequenceNumber=e}}class ef{constructor(e){this.persistence=e,this.Jr=new Zh,this.Yr=null}static Zr(e){return new ef(e)}get Xr(){if(this.Yr)return this.Yr;throw he()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),G.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),G.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),G.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return G.forEach(this.Xr,r=>{const s=le.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,fe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return G.or([()=>G.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=we(),s=we();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new tf(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return U_()?8:xS(z_())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new OE;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(yo()<=Ae.DEBUG&&se("QueryEngine","SDK will not create cache indexes for query:",Zs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),G.resolve()):(yo()<=Ae.DEBUG&&se("QueryEngine","Query:",Zs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(yo()<=Ae.DEBUG&&se("QueryEngine","The SDK decides to create cache indexes for query:",Zs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jn(n))):G.resolve())}Yi(e,n){if(Eg(n))return G.resolve(null);let r=Jn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Pd(n,null,"F"),r=Jn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=we(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const h=this.ts(n,l);return this.ns(n,h,a,c.readTime)?this.Yi(e,Pd(n,null,"F")):this.rs(e,h,n,c)}))})))}Zi(e,n,r,s){return Eg(n)||s.isEqual(fe.min())?G.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?G.resolve(null):(yo()<=Ae.DEBUG&&se("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Zs(n)),this.rs(e,a,n,pS(s,-1)).next(l=>l))})}ts(e,n){let r=new Et(H0(e));return n.forEach((s,i)=>{Su(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return yo()<=Ae.DEBUG&&se("QueryEngine","Using full collection scan to execute query:",Zs(n)),this.Ji.getDocumentsMatchingQuery(e,n,Xr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new Ge(be),this._s=new Bi(i=>qh(i),Gh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function UE(t,e,n,r){return new BE(t,e,n,r)}async function fv(t,e){const n=pe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let c=we();for(const h of s){a.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}for(const h of i){l.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}return n.localDocuments.getDocuments(r,c).next(h=>({hs:h,removedBatchIds:a,addedBatchIds:l}))})})}function $E(t,e){const n=pe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,h,p){const m=h.batch,y=m.keys();let I=G.resolve();return y.forEach(A=>{I=I.next(()=>p.getEntry(c,A)).next(P=>{const O=h.docVersions.get(A);De(O!==null),P.version.compareTo(O)<0&&(m.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),p.addEntry(P)))})}),I.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=we();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(c=c.add(l.batch.mutations[h].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function pv(t){const e=pe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function WE(t,e){const n=pe(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((p,m)=>{const y=s.get(m);if(!y)return;l.push(n.Ur.removeMatchingKeys(i,p.removedDocuments,m).next(()=>n.Ur.addMatchingKeys(i,p.addedDocuments,m)));let I=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?I=I.withResumeToken(It.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):p.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(p.resumeToken,r)),s=s.insert(m,I),function(P,O,k){return P.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(y,I,p)&&l.push(n.Ur.updateTargetData(i,I))});let c=xr(),h=we();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),l.push(HE(i,a,e.documentUpdates).next(p=>{c=p.Ps,h=p.Is})),!r.isEqual(fe.min())){const p=n.Ur.getLastRemoteSnapshotVersion(i).next(m=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(p)}return G.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,h)).next(()=>c)}).then(i=>(n.os=s,i))}function HE(t,e,n){let r=we(),s=we();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=xr();return n.forEach((l,c)=>{const h=i.get(l);c.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(fe.min())?(e.removeEntry(l,c.readTime),a=a.insert(l,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),a=a.insert(l,c)):se("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",c.version)}),{Ps:a,Is:s}})}function qE(t,e){const n=pe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function GE(t,e){const n=pe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,G.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new Vr(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Md(t,e,n){const r=pe(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!va(a))throw a;se("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Ng(t,e,n){const r=pe(t);let s=fe.min(),i=we();return r.persistence.runTransaction("Execute query","readwrite",a=>function(c,h,p){const m=pe(c),y=m._s.get(p);return y!==void 0?G.resolve(m.os.get(y)):m.Ur.getTargetData(h,p)}(r,a,Jn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(c=>{i=c})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:fe.min(),n?i:we())).next(l=>(QE(r,LS(e),l),{documents:l,Ts:i})))}function QE(t,e,n){let r=t.us.get(e)||fe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Mg{constructor(){this.activeTargetIds=$S()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class KE{constructor(){this.so=new Mg,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Mg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){se("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){se("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sl=null;function _c(){return sl===null?sl=function(){return 268435456+Math.round(2147483648*Math.random())}():sl++,"0x"+sl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jt="WebChannelConnection";class ZE extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=_c(),c=this.xo(n,r.toUriEncodedString());se("RestConnection",`Sending RPC '${n}' ${l}:`,c,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,a),this.No(n,c,h,s).then(p=>(se("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw sa("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",c,"request:",s),p})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+zi}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=XE[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=_c();return new Promise((a,l)=>{const c=new k0;c.setWithCredentials(!0),c.listenOnce(R0.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case yl.NO_ERROR:const p=c.getResponseJson();se(jt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(p)),a(p);break;case yl.TIMEOUT:se(jt,`RPC '${e}' ${i} timed out`),l(new te(H.DEADLINE_EXCEEDED,"Request time out"));break;case yl.HTTP_ERROR:const m=c.getStatus();if(se(jt,`RPC '${e}' ${i} failed with status:`,m,"response text:",c.getResponseText()),m>0){let y=c.getResponseJson();Array.isArray(y)&&(y=y[0]);const I=y==null?void 0:y.error;if(I&&I.status&&I.message){const A=function(O){const k=O.toLowerCase().replace(/_/g,"-");return Object.values(H).indexOf(k)>=0?k:H.UNKNOWN}(I.status);l(new te(A,I.message))}else l(new te(H.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new te(H.UNAVAILABLE,"Connection failed."));break;default:he()}}finally{se(jt,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);se(jt,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=_c(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=j0(),l=b0(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const p=i.join("");se(jt,`Creating RPC '${e}' stream ${s}: ${p}`,c);const m=a.createWebChannel(p,c);let y=!1,I=!1;const A=new JE({Io:O=>{I?se(jt,`Not sending because RPC '${e}' stream ${s} is closed:`,O):(y||(se(jt,`Opening RPC '${e}' stream ${s} transport.`),m.open(),y=!0),se(jt,`RPC '${e}' stream ${s} sending:`,O),m.send(O))},To:()=>m.close()}),P=(O,k,E)=>{O.listen(k,T=>{try{E(T)}catch(M){setTimeout(()=>{throw M},0)}})};return P(m,So.EventType.OPEN,()=>{I||(se(jt,`RPC '${e}' stream ${s} transport opened.`),A.yo())}),P(m,So.EventType.CLOSE,()=>{I||(I=!0,se(jt,`RPC '${e}' stream ${s} transport closed`),A.So())}),P(m,So.EventType.ERROR,O=>{I||(I=!0,sa(jt,`RPC '${e}' stream ${s} transport errored:`,O),A.So(new te(H.UNAVAILABLE,"The operation could not be completed")))}),P(m,So.EventType.MESSAGE,O=>{var k;if(!I){const E=O.data[0];De(!!E);const T=E,M=T.error||((k=T[0])===null||k===void 0?void 0:k.error);if(M){se(jt,`RPC '${e}' stream ${s} received error:`,M);const $=M.status;let B=function(w){const C=st[w];if(C!==void 0)return rv(C)}($),S=M.message;B===void 0&&(B=H.INTERNAL,S="Unknown error status: "+$+" with message "+M.message),I=!0,A.So(new te(B,S)),m.close()}else se(jt,`RPC '${e}' stream ${s} received:`,E),A.bo(E)}}),P(l,P0.STAT_EVENT,O=>{O.stat===Td.PROXY?se(jt,`RPC '${e}' stream ${s} detected buffering proxy`):O.stat===Td.NOPROXY&&se(jt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{A.wo()},0),A}}function wc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(t){return new uE(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&se("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e,n,r,s,i,a,l,c){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new gv(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===H.RESOURCE_EXHAUSTED?(vr(n.toString()),vr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===H.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new te(H.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return se("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(se("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class eT extends mv{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=hE(this.serializer,e),r=function(i){if(!("targetChange"in i))return fe.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?fe.min():a.readTime?Zn(a.readTime):fe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Nd(this.serializer),n.addTarget=function(i,a){let l;const c=a.target;if(l=kd(c)?{documents:gE(i,c)}:{query:mE(i,c)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=ov(i,a.resumeToken);const h=bd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(fe.min())>0){l.readTime=Zl(i,a.snapshotVersion.toTimestamp());const h=bd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=vE(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Nd(this.serializer),n.removeTarget=e,this.a_(n)}}class tT extends mv{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return De(!!e.streamToken),this.lastStreamToken=e.streamToken,De(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){De(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=pE(e.writeResults,e.commitTime),r=Zn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Nd(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>fE(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new te(H.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,jd(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new te(H.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,jd(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new te(H.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class rT{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(vr(n),this.D_=!1):se("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{Os(this)&&(se("RemoteStore","Restarting streams for network reachability change."),await async function(c){const h=pe(c);h.L_.add(4),await Sa(h),h.q_.set("Unknown"),h.L_.delete(4),await Au(h)}(this))})}),this.q_=new rT(r,s)}}async function Au(t){if(Os(t))for(const e of t.B_)await e(!0)}async function Sa(t){for(const e of t.B_)await e(!1)}function yv(t,e){const n=pe(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),of(n)?sf(n):Ui(n).r_()&&rf(n,e))}function nf(t,e){const n=pe(t),r=Ui(n);n.N_.delete(e),r.r_()&&vv(n,e),n.N_.size===0&&(r.r_()?r.o_():Os(n)&&n.q_.set("Unknown"))}function rf(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ui(t).A_(e)}function vv(t,e){t.Q_.xe(e),Ui(t).R_(e)}function sf(t){t.Q_=new iE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ui(t).start(),t.q_.v_()}function of(t){return Os(t)&&!Ui(t).n_()&&t.N_.size>0}function Os(t){return pe(t).L_.size===0}function xv(t){t.Q_=void 0}async function iT(t){t.q_.set("Online")}async function oT(t){t.N_.forEach((e,n)=>{rf(t,e)})}async function aT(t,e){xv(t),of(t)?(t.q_.M_(e),sf(t)):t.q_.set("Unknown")}async function lT(t,e,n){if(t.q_.set("Online"),e instanceof iv&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){se("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await eu(t,r)}else if(e instanceof _l?t.Q_.Ke(e):e instanceof sv?t.Q_.He(e):t.Q_.We(e),!n.isEqual(fe.min()))try{const r=await pv(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const p=i.N_.get(h);p&&i.N_.set(h,p.withResumeToken(c.resumeToken,a))}}),l.targetMismatches.forEach((c,h)=>{const p=i.N_.get(c);if(!p)return;i.N_.set(c,p.withResumeToken(It.EMPTY_BYTE_STRING,p.snapshotVersion)),vv(i,c);const m=new Vr(p.target,c,h,p.sequenceNumber);rf(i,m)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){se("RemoteStore","Failed to raise snapshot:",r),await eu(t,r)}}async function eu(t,e,n){if(!va(e))throw e;t.L_.add(1),await Sa(t),t.q_.set("Offline"),n||(n=()=>pv(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{se("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Au(t)})}function _v(t,e){return e().catch(n=>eu(t,n,e))}async function ku(t){const e=pe(t),n=Zr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;uT(e);)try{const s=await qE(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,cT(e,s)}catch(s){await eu(e,s)}wv(e)&&Sv(e)}function uT(t){return Os(t)&&t.O_.length<10}function cT(t,e){t.O_.push(e);const n=Zr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function wv(t){return Os(t)&&!Zr(t).n_()&&t.O_.length>0}function Sv(t){Zr(t).start()}async function dT(t){Zr(t).p_()}async function hT(t){const e=Zr(t);for(const n of t.O_)e.m_(n.mutations)}async function fT(t,e,n){const r=t.O_.shift(),s=Yh.from(r,e,n);await _v(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ku(t)}async function pT(t,e){e&&Zr(t).V_&&await async function(r,s){if(function(a){return nE(a)&&a!==H.ABORTED}(s.code)){const i=r.O_.shift();Zr(r).s_(),await _v(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ku(r)}}(t,e),wv(t)&&Sv(t)}async function Lg(t,e){const n=pe(t);n.asyncQueue.verifyOperationInProgress(),se("RemoteStore","RemoteStore received new credentials");const r=Os(n);n.L_.add(3),await Sa(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Au(n)}async function gT(t,e){const n=pe(t);e?(n.L_.delete(2),await Au(n)):e||(n.L_.add(2),await Sa(n),n.q_.set("Unknown"))}function Ui(t){return t.K_||(t.K_=function(n,r,s){const i=pe(n);return i.w_(),new eT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:iT.bind(null,t),Ro:oT.bind(null,t),mo:aT.bind(null,t),d_:lT.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),of(t)?sf(t):t.q_.set("Unknown")):(await t.K_.stop(),xv(t))})),t.K_}function Zr(t){return t.U_||(t.U_=function(n,r,s){const i=pe(n);return i.w_(),new tT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:dT.bind(null,t),mo:pT.bind(null,t),f_:hT.bind(null,t),g_:fT.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await ku(t)):(await t.U_.stop(),t.O_.length>0&&(se("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new hr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new af(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(H.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function lf(t,e){if(vr("AsyncQueue",`${e}: ${t}`),va(t))return new te(H.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this.comparator=e?(n,r)=>e(n,r)||le.comparator(n.key,r.key):(n,r)=>le.comparator(n.key,r.key),this.keyedMap=Eo(),this.sortedSet=new Ge(this.comparator)}static emptySet(e){return new _i(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof _i)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new _i;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(){this.W_=new Ge(le.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):he():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ni{constructor(e,n,r,s,i,a,l,c,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new Ni(e,n,_i.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class yT{constructor(){this.queries=Og(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=pe(n),i=s.queries;s.queries=Og(),i.forEach((a,l)=>{for(const c of l.j_)c.onError(r)})})(this,new te(H.ABORTED,"Firestore shutting down"))}}function Og(){return new Bi(t=>W0(t),wu)}async function Ev(t,e){const n=pe(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new mT,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=lf(a,`Initialization of query '${Zs(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&uf(n)}async function Tv(t,e){const n=pe(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function vT(t,e){const n=pe(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&uf(n)}function xT(t,e,n){const r=pe(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function uf(t){t.Y_.forEach(e=>{e.next()})}var Vd,zg;(zg=Vd||(Vd={})).ea="default",zg.Cache="cache";class Iv{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ni(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Ni.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Vd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e){this.key=e}}class Av{constructor(e){this.key=e}}class _T{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=we(),this.mutatedKeys=we(),this.Aa=H0(e),this.Ra=new _i(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Fg,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,m)=>{const y=s.get(p),I=Su(this.query,m)?m:null,A=!!y&&this.mutatedKeys.has(y.key),P=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let O=!1;y&&I?y.data.isEqual(I.data)?A!==P&&(r.track({type:3,doc:I}),O=!0):this.ga(y,I)||(r.track({type:2,doc:I}),O=!0,(c&&this.Aa(I,c)>0||h&&this.Aa(I,h)<0)&&(l=!0)):!y&&I?(r.track({type:0,doc:I}),O=!0):y&&!I&&(r.track({type:1,doc:y}),O=!0,(c||h)&&(l=!0)),O&&(I?(a=a.add(I),i=P?i.add(p):i.delete(p)):(a=a.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((p,m)=>function(I,A){const P=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return he()}};return P(I)-P(A)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],c=this.da.size===0&&this.current&&!s?1:0,h=c!==this.Ea;return this.Ea=c,a.length!==0||h?{snapshot:new Ni(this.query,e.Ra,i,a,e.mutatedKeys,c===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Fg,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=we(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Av(r))}),this.da.forEach(r=>{e.has(r)||n.push(new Cv(r))}),n}ba(e){this.Ta=e.Ts,this.da=we();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Ni.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class wT{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class ST{constructor(e){this.key=e,this.va=!1}}class ET{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Bi(l=>W0(l),wu),this.Ma=new Map,this.xa=new Set,this.Oa=new Ge(le.comparator),this.Na=new Map,this.La=new Zh,this.Ba={},this.ka=new Map,this.qa=Di.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function TT(t,e,n=!0){const r=Dv(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await kv(r,e,n,!0),s}async function IT(t,e){const n=Dv(t);await kv(n,e,!0,!1)}async function kv(t,e,n,r){const s=await GE(t.localStore,Jn(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await CT(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&yv(t.remoteStore,s),l}async function CT(t,e,n,r,s){t.Ka=(m,y,I)=>async function(P,O,k,E){let T=O.view.ma(k);T.ns&&(T=await Ng(P.localStore,O.query,!1).then(({documents:S})=>O.view.ma(S,T)));const M=E&&E.targetChanges.get(O.targetId),$=E&&E.targetMismatches.get(O.targetId)!=null,B=O.view.applyChanges(T,P.isPrimaryClient,M,$);return Ug(P,O.targetId,B.wa),B.snapshot}(t,m,y,I);const i=await Ng(t.localStore,e,!0),a=new _T(e,i.Ts),l=a.ma(i.documents),c=wa.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=a.applyChanges(l,t.isPrimaryClient,c);Ug(t,n,h.wa);const p=new wT(e,n,a);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function AT(t,e,n){const r=pe(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!wu(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Md(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&nf(r.remoteStore,s.targetId),Ld(r,s.targetId)}).catch(ya)):(Ld(r,s.targetId),await Md(r.localStore,s.targetId,!0))}async function kT(t,e){const n=pe(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),nf(n.remoteStore,r.targetId))}async function RT(t,e,n){const r=VT(t);try{const s=await function(a,l){const c=pe(a),h=ct.now(),p=l.reduce((I,A)=>I.add(A.key),we());let m,y;return c.persistence.runTransaction("Locally write mutations","readwrite",I=>{let A=xr(),P=we();return c.cs.getEntries(I,p).next(O=>{A=O,A.forEach((k,E)=>{E.isValidDocument()||(P=P.add(k))})}).next(()=>c.localDocuments.getOverlayedDocuments(I,A)).next(O=>{m=O;const k=[];for(const E of l){const T=XS(E,m.get(E.key).overlayedDocument);T!=null&&k.push(new rs(E.key,T,V0(T.value.mapValue),On.exists(!0)))}return c.mutationQueue.addMutationBatch(I,h,k,l)}).next(O=>{y=O;const k=O.applyToLocalDocumentSet(m,P);return c.documentOverlayCache.saveOverlays(I,O.batchId,k)})}).then(()=>({batchId:y.batchId,changes:G0(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,c){let h=a.Ba[a.currentUser.toKey()];h||(h=new Ge(be)),h=h.insert(l,c),a.Ba[a.currentUser.toKey()]=h}(r,s.batchId,n),await Ea(r,s.changes),await ku(r.remoteStore)}catch(s){const i=lf(s,"Failed to persist write");n.reject(i)}}async function Rv(t,e){const n=pe(t);try{const r=await WE(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(De(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?De(a.va):s.removedDocuments.size>0&&(De(a.va),a.va=!1))}),await Ea(n,r,e)}catch(r){await ya(r)}}function Bg(t,e,n){const r=pe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const c=pe(a);c.onlineState=l;let h=!1;c.queries.forEach((p,m)=>{for(const y of m.j_)y.Z_(l)&&(h=!0)}),h&&uf(c)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function PT(t,e,n){const r=pe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new Ge(le.comparator);a=a.insert(i,Nt.newNoDocument(i,fe.min()));const l=we().add(i),c=new Iu(fe.min(),new Map,new Ge(be),a,l);await Rv(r,c),r.Oa=r.Oa.remove(i),r.Na.delete(e),cf(r)}else await Md(r.localStore,e,!1).then(()=>Ld(r,e,n)).catch(ya)}async function bT(t,e){const n=pe(t),r=e.batch.batchId;try{const s=await $E(n.localStore,e);bv(n,r,null),Pv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ea(n,s)}catch(s){await ya(s)}}async function jT(t,e,n){const r=pe(t);try{const s=await function(a,l){const c=pe(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return c.mutationQueue.lookupMutationBatch(h,l).next(m=>(De(m!==null),p=m.keys(),c.mutationQueue.removeMutationBatch(h,m))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>c.localDocuments.getDocuments(h,p))})}(r.localStore,e);bv(r,e,n),Pv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ea(r,s)}catch(s){await ya(s)}}function Pv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function bv(t,e,n){const r=pe(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Ld(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||jv(t,r)})}function jv(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(nf(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),cf(t))}function Ug(t,e,n){for(const r of n)r instanceof Cv?(t.La.addReference(r.key,e),DT(t,r)):r instanceof Av?(se("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||jv(t,r.key)):he()}function DT(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(se("SyncEngine","New document in limbo: "+n),t.xa.add(r),cf(t))}function cf(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new le(ze.fromString(e)),r=t.qa.next();t.Na.set(r,new ST(n)),t.Oa=t.Oa.insert(n,r),yv(t.remoteStore,new Vr(Jn(Qh(n.path)),r,"TargetPurposeLimboResolution",Uh.oe))}}async function Ea(t,e,n){const r=pe(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,c)=>{a.push(r.Ka(c,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const m=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(h){s.push(h);const m=tf.Wi(c.targetId,h);i.push(m)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(c,h){const p=pe(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>G.forEach(h,y=>G.forEach(y.$i,I=>p.persistence.referenceDelegate.addReference(m,y.targetId,I)).next(()=>G.forEach(y.Ui,I=>p.persistence.referenceDelegate.removeReference(m,y.targetId,I)))))}catch(m){if(!va(m))throw m;se("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const y=m.targetId;if(!m.fromCache){const I=p.os.get(y),A=I.snapshotVersion,P=I.withLastLimboFreeSnapshotVersion(A);p.os=p.os.insert(y,P)}}}(r.localStore,i))}async function NT(t,e){const n=pe(t);if(!n.currentUser.isEqual(e)){se("SyncEngine","User change. New user:",e.toKey());const r=await fv(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new te(H.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ea(n,r.hs)}}function MT(t,e){const n=pe(t),r=n.Na.get(e);if(r&&r.va)return we().add(r.key);{let s=we();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}function Dv(t){const e=pe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=MT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=PT.bind(null,e),e.Ca.d_=vT.bind(null,e.eventManager),e.Ca.$a=xT.bind(null,e.eventManager),e}function VT(t){const e=pe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=bT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=jT.bind(null,e),e}class tu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Cu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return UE(this.persistence,new zE,e.initialUser,this.serializer)}Ga(e){return new LE(ef.Zr,this.serializer)}Wa(e){return new KE}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}tu.provider={build:()=>new tu};class Fd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Bg(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=NT.bind(null,this.syncEngine),await gT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new yT}()}createDatastore(e){const n=Cu(e.databaseInfo.databaseId),r=function(i){return new ZE(i)}(e.databaseInfo);return function(i,a,l,c){return new nT(i,a,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new sT(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Bg(this.syncEngine,n,0),function(){return Vg.D()?new Vg:new YE}())}createSyncEngine(e,n){return function(s,i,a,l,c,h,p){const m=new ET(s,i,a,l,c,h);return p&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=pe(s);se("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Sa(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Fd.provider={build:()=>new Fd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):vr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Qt.UNAUTHENTICATED,this.clientId=D0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{se("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(se("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new hr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=lf(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Sc(t,e){t.asyncQueue.verifyOperationInProgress(),se("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await fv(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function $g(t,e){t.asyncQueue.verifyOperationInProgress();const n=await FT(t);se("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Lg(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Lg(e.remoteStore,s)),t._onlineComponents=e}async function FT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){se("FirestoreClient","Using user provided OfflineComponentProvider");try{await Sc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===H.FAILED_PRECONDITION||s.code===H.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;sa("Error using user provided cache. Falling back to memory cache: "+n),await Sc(t,new tu)}}else se("FirestoreClient","Using default OfflineComponentProvider"),await Sc(t,new tu);return t._offlineComponents}async function Mv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(se("FirestoreClient","Using user provided OnlineComponentProvider"),await $g(t,t._uninitializedComponentsProvider._online)):(se("FirestoreClient","Using default OnlineComponentProvider"),await $g(t,new Fd))),t._onlineComponents}function OT(t){return Mv(t).then(e=>e.syncEngine)}async function Vv(t){const e=await Mv(t),n=e.eventManager;return n.onListen=TT.bind(null,e.syncEngine),n.onUnlisten=AT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=IT.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=kT.bind(null,e.syncEngine),n}function zT(t,e,n={}){const r=new hr;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,h){const p=new Nv({next:y=>{p.Za(),a.enqueueAndForget(()=>Tv(i,m));const I=y.docs.has(l);!I&&y.fromCache?h.reject(new te(H.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&y.fromCache&&c&&c.source==="server"?h.reject(new te(H.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(y)},error:y=>h.reject(y)}),m=new Iv(Qh(l.path),p,{includeMetadataChanges:!0,_a:!0});return Ev(i,m)}(await Vv(t),t.asyncQueue,e,n,r)),r.promise}function BT(t,e,n={}){const r=new hr;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,c,h){const p=new Nv({next:y=>{p.Za(),a.enqueueAndForget(()=>Tv(i,m)),y.fromCache&&c.source==="server"?h.reject(new te(H.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(y)},error:y=>h.reject(y)}),m=new Iv(l,p,{includeMetadataChanges:!0,_a:!0});return Ev(i,m)}(await Vv(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wg=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fv(t,e,n){if(!n)throw new te(H.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function UT(t,e,n,r){if(e===!0&&r===!0)throw new te(H.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Hg(t){if(!le.isDocumentKey(t))throw new te(H.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function qg(t){if(le.isDocumentKey(t))throw new te(H.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ru(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":he()}function _r(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new te(H.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ru(t);throw new te(H.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new te(H.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}UT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Lv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new te(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new te(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new te(H.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class df{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gg({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te(H.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te(H.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new oS;switch(r.type){case"firstParty":return new uS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new te(H.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Wg.get(n);r&&(se("ComponentProvider","Removing Datastore"),Wg.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new $i(this.firestore,e,this._query)}}class Ut{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ut(this.firestore,e,this._key)}}class Qr extends $i{constructor(e,n,r){super(e,n,Qh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ut(this.firestore,null,new le(e))}withConverter(e){return new Qr(this.firestore,e,this._path)}}function wi(t,e,...n){if(t=Bn(t),Fv("collection","path",e),t instanceof df){const r=ze.fromString(e,...n);return qg(r),new Qr(t,null,r)}{if(!(t instanceof Ut||t instanceof Qr))throw new te(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return qg(r),new Qr(t.firestore,null,r)}}function Mt(t,e,...n){if(t=Bn(t),arguments.length===1&&(e=D0.newId()),Fv("doc","path",e),t instanceof df){const r=ze.fromString(e,...n);return Hg(r),new Ut(t,null,new le(r))}{if(!(t instanceof Ut||t instanceof Qr))throw new te(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ze.fromString(e,...n));return Hg(r),new Ut(t.firestore,t instanceof Qr?t.converter:null,new le(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new gv(this,"async_queue_retry"),this.Vu=()=>{const r=wc();r&&se("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=wc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=wc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new hr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!va(e))throw e;se("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw vr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=af.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&he()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Wi extends df{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Qg,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Qg(e),this._firestoreClient=void 0,await e}}}function $T(t,e,n){n||(n="(default)");const r=E0(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Gl(i,e))return s;throw new te(H.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new te(H.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function hf(t){if(t._terminated)throw new te(H.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||WT(t),t._firestoreClient}function WT(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,h,p){return new SS(l,c,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Lv(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new LT(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mi(It.fromBase64String(e))}catch(n){throw new te(H.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Mi(It.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new te(H.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new te(H.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new te(H.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return be(this._lat,e._lat)||be(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT=/^__.*__$/;class qT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new rs(e,this.data,this.fieldMask,n,this.fieldTransforms):new _a(e,this.data,n,this.fieldTransforms)}}class Ov{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new rs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function zv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw he()}}class gf{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new gf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return nu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(zv(this.Cu)&&HT.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class GT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Cu(e)}Qu(e,n,r,s=!1){return new gf({Cu:e,methodName:n,qu:r,path:wt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ju(t){const e=t._freezeSettings(),n=Cu(t._databaseId);return new GT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Bv(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);yf("Data must be an object, but it was:",a,r);const l=Uv(r,a);let c,h;if(i.merge)c=new an(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const p=[];for(const m of i.mergeFields){const y=Od(e,m,n);if(!a.contains(y))throw new te(H.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Wv(p,y)||p.push(y)}c=new an(p),h=a.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,h=a.fieldTransforms;return new qT(new Yt(l),c,h)}class Du extends bu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Du}}class mf extends bu{_toFieldTransform(e){return new GS(e.path,new ua)}isEqual(e){return e instanceof mf}}function QT(t,e,n,r){const s=t.Qu(1,e,n);yf("Data must be an object, but it was:",s,r);const i=[],a=Yt.empty();Fs(r,(c,h)=>{const p=vf(e,c,n);h=Bn(h);const m=s.Nu(p);if(h instanceof Du)i.push(p);else{const y=Ta(h,m);y!=null&&(i.push(p),a.set(p,y))}});const l=new an(i);return new Ov(a,l,s.fieldTransforms)}function KT(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[Od(e,r,n)],c=[s];if(i.length%2!=0)throw new te(H.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)l.push(Od(e,i[y])),c.push(i[y+1]);const h=[],p=Yt.empty();for(let y=l.length-1;y>=0;--y)if(!Wv(h,l[y])){const I=l[y];let A=c[y];A=Bn(A);const P=a.Nu(I);if(A instanceof Du)h.push(I);else{const O=Ta(A,P);O!=null&&(h.push(I),p.set(I,O))}}const m=new an(h);return new Ov(p,m,a.fieldTransforms)}function YT(t,e,n,r=!1){return Ta(n,t.Qu(r?4:3,e))}function Ta(t,e){if($v(t=Bn(t)))return yf("Unsupported field value:",e,t),Uv(t,e);if(t instanceof bu)return function(r,s){if(!zv(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let c=Ta(l,s.Lu(a));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Bn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return WS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ct.fromDate(r);return{timestampValue:Zl(s.serializer,i)}}if(r instanceof ct){const i=new ct(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Zl(s.serializer,i)}}if(r instanceof ff)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Mi)return{bytesValue:ov(s.serializer,r._byteString)};if(r instanceof Ut){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Jh(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof pf)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Kh(l.serializer,c)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Ru(r)}`)}(t,e)}function Uv(t,e){const n={};return N0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fs(t,(r,s)=>{const i=Ta(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function $v(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ct||t instanceof ff||t instanceof Mi||t instanceof Ut||t instanceof bu||t instanceof pf)}function yf(t,e,n){if(!$v(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Ru(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Od(t,e,n){if((e=Bn(e))instanceof Pu)return e._internalPath;if(typeof e=="string")return vf(t,e);throw nu("Field path arguments must be of type string or ",t,!1,void 0,n)}const XT=new RegExp("[~\\*/\\[\\]]");function vf(t,e,n){if(e.search(XT)>=0)throw nu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Pu(...e.split("."))._internalPath}catch{throw nu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function nu(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||a)&&(c+=" (found",i&&(c+=` in field ${r}`),a&&(c+=` in document ${s}`),c+=")"),new te(H.INVALID_ARGUMENT,l+t+c)}function Wv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ut(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(xf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class JT extends Hv{data(){return super.data()}}function xf(t,e){return typeof e=="string"?vf(t,e):e instanceof Pu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new te(H.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _f{}class eI extends _f{}function tI(t,e,...n){let r=[];e instanceof _f&&r.push(e),r=r.concat(n),function(i){const a=i.filter(c=>c instanceof wf).length,l=i.filter(c=>c instanceof Nu).length;if(a>1||a>0&&l>0)throw new te(H.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Nu extends eI{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Nu(e,n,r)}_apply(e){const n=this._parse(e);return qv(e._query,n),new $i(e.firestore,e.converter,Rd(e._query,n))}_parse(e){const n=ju(e.firestore);return function(i,a,l,c,h,p,m){let y;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new te(H.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Xg(m,p);const I=[];for(const A of m)I.push(Yg(c,i,A));y={arrayValue:{values:I}}}else y=Yg(c,i,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Xg(m,p),y=YT(l,a,m,p==="in"||p==="not-in");return ot.create(h,p,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Kg(t,e,n){const r=e,s=xf("where",t);return Nu._create(s,r,n)}class wf extends _f{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new wf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Un.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const c of l)qv(a,c),a=Rd(a,c)}(e._query,n),new $i(e.firestore,e.converter,Rd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Yg(t,e,n){if(typeof(n=Bn(n))=="string"){if(n==="")throw new te(H.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$0(e)&&n.indexOf("/")!==-1)throw new te(H.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ze.fromString(n));if(!le.isDocumentKey(r))throw new te(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yg(t,new le(r))}if(n instanceof Ut)return yg(t,n._key);throw new te(H.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ru(n)}.`)}function Xg(t,e){if(!Array.isArray(t)||t.length===0)throw new te(H.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qv(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new te(H.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new te(H.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class nI{convertValue(e,n="none"){switch(Ms(e)){case 0:return null;case 1:return e.booleanValue;case 2:return et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ns(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw he()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Fs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>et(a.doubleValue));return new pf(i)}convertGeoPoint(e){return new ff(et(e.latitude),et(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Wh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(oa(e));default:return null}}convertTimestamp(e){const n=Jr(e);return new ct(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ze.fromString(e);De(hv(r));const s=new aa(r.get(1),r.get(3)),i=new le(r.popFirst(5));return s.isEqual(n)||vr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gv(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qv extends Hv{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new wl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(xf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class wl extends Qv{data(e={}){return super.data(e)}}class rI{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Io(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new wl(this._firestore,this._userDataWriter,r.key,r,new Io(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new te(H.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const c=new wl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Io(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new wl(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Io(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,p=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:sI(l.type),doc:c,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function sI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return he()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(t){t=_r(t,Ut);const e=_r(t.firestore,Wi);return zT(hf(e),t._key).then(n=>iI(e,t,n))}class Kv extends nI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mi(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ut(this.firestore,null,n)}}function Sl(t){t=_r(t,$i);const e=_r(t.firestore,Wi),n=hf(e),r=new Kv(e);return ZT(t._query),BT(n,t._query).then(s=>new rI(e,r,t,s))}function zd(t,e,n){t=_r(t,Ut);const r=_r(t.firestore,Wi),s=Gv(t.converter,e,n);return Ef(r,[Bv(ju(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,On.none())])}function lr(t,e,n,...r){t=_r(t,Ut);const s=_r(t.firestore,Wi),i=ju(s);let a;return a=typeof(e=Bn(e))=="string"||e instanceof Pu?KT(i,"updateDoc",t._key,e,n,r):QT(i,"updateDoc",t._key,e),Ef(s,[a.toMutation(t._key,On.exists(!0))])}function Yv(t,e){const n=_r(t.firestore,Wi),r=Mt(t),s=Gv(t.converter,e);return Ef(n,[Bv(ju(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,On.exists(!1))]).then(()=>r)}function Ef(t,e){return function(r,s){const i=new hr;return r.asyncQueue.enqueueAndForget(async()=>RT(await OT(r),s,i)),i.promise}(hf(t),e)}function iI(t,e,n){const r=n.docs.get(e._key),s=new Kv(t);return new Qv(t,s,e._key,r,new Io(n.hasPendingWrites,n.fromCache),e.converter)}function Vn(){return new mf("serverTimestamp")}(function(e,n=!0){(function(s){zi=s})(qw),na(new Ri("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new Wi(new aS(r.getProvider("auth-internal")),new dS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new te(H.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new aa(h.options.projectId,p)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Gr(hg,"4.7.3",e),Gr(hg,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bd="us-central1";class aI{constructor(e,n,r,s,i=Bd,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new oI(n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Bd}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function lI(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const Jg="@firebase/functions",Zg="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI="auth-internal",cI="app-check-internal",dI="messaging-internal";function hI(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),a=r.getProvider(uI),l=r.getProvider(dI),c=r.getProvider(cI);return new aI(i,a,l,c,s,t)};na(new Ri(Xv,n,"PUBLIC").setMultipleInstances(!0)),Gr(Jg,Zg,e),Gr(Jg,Zg,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(t=Gw(),e=Bd){const r=E0(Bn(t),Xv).getImmediate({identifier:e}),s=F_("functions");return s&&pI(r,...s),r}function pI(t,e,n){lI(Bn(t),e,n)}hI(fetch.bind(self));const gI={apiKey:'"AIzaSyDRdl4zhwoZumVtphmJ19orZ8HoR0WQQZM",',authDomain:'"qualtrics-game-backend.firebaseapp.com",',projectId:'"qualtrics-game-backend",',storageBucket:'"qualtrics-game-backend.firebasestorage.app",',messagingSenderId:'"441267092549",',appId:"1:441267092549:web:6ce075f5f3ea7cf958772c"},Jv=T0(gI),nt=$T(Jv,{experimentalForceLongPolling:!1,useFetchStreams:!1});fI(Jv);const Ue={init(){localStorage.getItem("sessionId")||(localStorage.setItem("sessionId",this.generateSessionId()),localStorage.setItem("sessionStartTime",Date.now().toString())),localStorage.getItem("semesterStartTime")||localStorage.setItem("semesterStartTime",Date.now().toString())},generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},async logEvent(t,e){const n=localStorage.getItem("sessionId")||this.generateSessionId(),r=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),s=Date.now(),i=s-r,a=(i/1e3).toFixed(1),l=Math.floor(i/6e4),c=Math.floor(i%6e4/1e3),h=`${l}:${c.toString().padStart(2,"0")}`,p=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),m=this.getFullGameContext(),y={sessionId:n,studentId:p.studentId||null,type:t,timestamp:new Date().toISOString(),clientTimestamp:s,timeElapsedSeconds:parseFloat(a),readableTime:h,semesterTime:this.getSemesterTime(),...m,isAdminMode:p.role==="admin",hasCheckpoint:p.checkpointSemester2||!1,hasAI:p.hasAI||!1,section:p.section||null,...this.convertTimesToSeconds(e)};(t==="user_action"||t==="task_attempt")&&console.log(`DEBUG: Event ${t} - studentId: ${y.studentId}, role: ${p.role}`);try{await Yv(wi(nt,"events"),y)}catch(I){console.error("Failed to log event:",I),this.storeOfflineEvent(y)}},convertTimesToSeconds(t){const e={...t},n=["timeTaken","timeSpent","totalTime","timeOnPreviousPage","averageTime","timeBetweenHelpAndSubmit"];for(const r of n)e[r]!==void 0&&e[r]!==null&&(e[`${r}Seconds`]=(e[r]/1e3).toFixed(1),delete e[r]);return e.timeProgression&&(e.timeProgressionSeconds=e.timeProgression.map(r=>(r/1e3).toFixed(1)),delete e.timeProgression),e.timePerAttempt&&(e.timePerAttemptSeconds=e.timePerAttempt.map(r=>(r/1e3).toFixed(1)),delete e.timePerAttempt),e},getSemesterTime(){const t=parseInt(localStorage.getItem("semesterStartTime")||Date.now()),e=Date.now()-t,n=(e/1e3).toFixed(1),r=Math.floor(e/6e4),s=Math.floor(e%6e4/1e3);return{elapsedSeconds:parseFloat(n),readable:`${r}:${s.toString().padStart(2,"0")}`,minutes:r,seconds:s}},getCurrentContext(){const t=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),e=((Date.now()-t)/1e3).toFixed(1);return{currentTask:localStorage.getItem("currentTask"),gameMode:localStorage.getItem("gameMode"),totalCompleted:this.getCompletedTaskCount(),currentStreak:this.getCurrentStreak(),sessionDurationSeconds:parseFloat(e)}},getFullGameContext(){const t=localStorage.getItem("currentTask")||"",e=localStorage.getItem("gameMode")||"",n=parseInt(localStorage.getItem("currentSemester")||"1"),r=parseInt(localStorage.getItem("totalSemesters")||"2"),s=localStorage.getItem("practiceCompleted")==="true",i=parseInt(localStorage.getItem("completedTasksCount")||"0"),a=parseInt(localStorage.getItem("completedLevels")||"0"),l=parseInt(localStorage.getItem("totalSwitches")||"0"),c=parseInt(localStorage.getItem("aiUsageCount")||"0"),h=JSON.parse(localStorage.getItem("categoryPoints")||"{}"),p=parseFloat(localStorage.getItem("studentLearningScore")||"0");return{currentTask:t,gameMode:e,currentSemester:n,totalSemesters:r,practiceCompleted:s,completedTasks:i,completedLevels:a,totalSwitches:l,aiUsageCount:c,studentLearning:p,totalBonus:h.bonus||0,finalScore:Math.round(p)+(h.bonus||0),semester:n}},calculateImprovementTrend(t){if(!t||t.length<3)return"needs_more_data";const n=t.slice(-5).map(s=>s.accuracy),r=this.calculateTrend(n);return r>5?"rapid_improvement":r>2?"steady_improvement":r>0?"slight_improvement":r>-2?"stable":r>-5?"slight_decline":"rapid_decline"},calculateImprovementRate(t){if(!t||t.length<2)return{overall:0,trend:0,isImproving:!1,dataPoints:t?t.length:0};const e=t[0].accuracy,r=t[t.length-1].accuracy-e;if(t.length<3)return{overall:r,trend:r,isImproving:r>0,dataPoints:t.length};const s=Math.floor(t.length/2),i=t.slice(0,s).reduce((c,h)=>c+h.accuracy,0)/s,l=t.slice(s).reduce((c,h)=>c+h.accuracy,0)/(t.length-s)-i;return{overall:r,trend:l,isImproving:l>0,dataPoints:t.length}},setPageStartTime(t){t&&localStorage.setItem(`pageStartTime_${t}`,Date.now().toString())},getTimeOnCurrentPage(t){if(!t)return 0;const e=localStorage.getItem(`pageStartTime_${t}`);return e?Date.now()-parseInt(e):0},ensureSession(){localStorage.getItem("sessionId")||this.init()},async trackAIHelpResponse(t,e,n,r,s,i){const a=parseInt(localStorage.getItem("aiUsageCount")||"0");return localStorage.setItem("aiUsageCount",(a+1).toString()),this.logEvent("ai_help_response",{taskId:t,helpType:e,suggestion:n,playerAction:r,playerValue:s,timeBetween:i})},async trackTaskAttempt(t,e){return this.logEvent("task_attempt",{taskId:t,...e})},async trackUserAction(t,e){return this.logEvent("user_action",{action:t,response:e.response||"",query:e.query||"",queryType:e.queryType||"",choice:e.choice||"",currentMode:e.currentMode||"",...e})},async syncOfflineEvents(){return console.log("Syncing offline events..."),Promise.resolve()},async trackTaskComplete(t,e){return this.logEvent("task_complete",{taskId:t,...e})},async trackPageSwitch(t,e,n){return this.logEvent("page_switch",{from:t,to:e,isAutoAdvance:n})},trackAITaskHelp(t,e,n,r,s){return this.logEvent("ai_task_help",{taskId:t,taskType:e,suggestion:n,wasCorrect:r,attemptNumber:s})}};Ue.init();const Xe={seedRandom:null,currentSeed:null,initializeSeed(t){this.currentSeed=t;let e=t;this.seedRandom=function(){return e=(e*9301+49297)%233280,e/233280}},getRandom(){return this.seedRandom?this.seedRandom():Math.random()},generateCountingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n;e==="easy"?n=(t-1)%5+1:e==="medium"?n=(t-11)%5+6:n=(t-25)%5+11;const s={easy:{1:{target:"the",type:"word"},2:{target:"and",type:"word"},3:{target:"of",type:"word"},4:{target:"to",type:"word"},5:{target:"in",type:"word"}},medium:{6:{target:"e",type:"letter"},7:{target:"a",type:"letter"},8:{target:"i",type:"letter"},9:{target:"o",type:"letter"},10:{target:"s",type:"letter"}},hard:{11:{targets:["a","e"],type:"multi-letter"},12:{targets:["i","o"],type:"multi-letter"},13:{targets:["s","t"],type:"multi-letter"},14:{targets:["n","r"],type:"multi-letter"},15:{targets:["l","d"],type:"multi-letter"}}}[e][n];let i="";return s.type==="word"?i=`Count how many times the word "${s.target}" appears:`:s.type==="letter"?i=`Count how many times the letter "${s.target}" appears (case-insensitive):`:i=`Count how many times the letters "${s.targets[0]}" and "${s.targets[1]}" appear in total:`,{...s,instruction:i,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},generateSliderPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n,r,s;return e==="easy"?(n=Math.floor(this.getRandom()*11),r=1,s=!0):e==="medium"?(n=Math.round(this.getRandom()*10*10)/10,r=.1,s=!0):(n=Math.round(this.getRandom()*10*100)/100,r=.01,s=(t-25)%5!==0),{target:n,step:r,showValue:s,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1),precision:e==="easy"?0:e==="medium"?1:2}},generateTypingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard",n={easy:["hello world","quick test","type this","easy mode","simple text","good job","keep going","nice work","almost done","level up"],medium:["HeLLo WoRLd","QuIcK tEsT","TyPe ThIs","MeDiUm MoDe","MiXeD cAsE","KeEp GoInG","NiCe WoRk","AlMoSt DoNe","LeVeL uP","ChAlLeNgE","TeSt RuN","NeXt LeVeL","TrY aGaIn","GoOd LuCk","FiNaL tEsT"],hard:["Test@123","Go4It!Now","X9%Y8&Z7*","P6!Q5?R4+","Z1@Y2#X3$","M7&N8*O9!","J4%K5^L6&","D1!E2@F3#","A7$B8%C9^","V3*W4+X5=","Q2#R3$S4%","H5^I6&J7*","K8(L9)M0!","N1@O2#P3$","T4%U5^V6&","W7*X8(Y9)","C0!D1@E2#","F3$G4%H5^","I6&J7*K8(","L9)M0!N1@","O2#P3$Q4%","R5^S6&T7*","U8(V9)W0!","X1@Y2#Z3$","A4%B5^C6&"]};let r;if(e==="easy"){const s=(t-1)%n.easy.length;r=n.easy[s]}else if(e==="medium"){const s=(t-11)%n.medium.length;r=n.medium[s]}else{const s=(t-25)%n.hard.length;r=n.hard[s]}return{pattern:r,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},textPassages:["The University of California, Berkeley (UC Berkeley, Berkeley, Cal, or California) is a public land-grant research university in Berkeley, California, United States. Founded in 1868 and named after the Anglo-Irish philosopher George Berkeley, it is the state's first land-grant university and is the founding campus of the University of California system.","Berkeley has an enrollment of more than 45,000 students. The university is organized around fifteen schools of study on the same campus, including the College of Chemistry, the College of Engineering, College of Letters and Science, and the Haas School of Business.",'The Berkeley campus encompasses approximately 1,232 acres, though the "central campus" occupies only the low-lying western 178 acres. The campus contains numerous wooded areas, including the Eucalyptus Grove and Strawberry Creek, which runs through the center of campus.',"Oski the Bear (Oski) is the official mascot of the University of California, Berkeley, representing the California Golden Bears. Named after the Oski Yell, he made his debut at a freshman rally in the Greek Theatre on September 25, 1941.","Berkeley faculty, alumni, and researchers have won 111 Nobel laureates, 25 Turing Award winners, and 19 Academy Award winners. The university has produced many notable alumni in various fields including science, politics, business, and entertainment.","The university's athletic teams compete as the California Golden Bears and are members of the Atlantic Coast Conference for most sports. Berkeley teams have won 107 national championships, including 45 NCAA national championships.","Research at Berkeley is conducted within departments, organized research units, and interdisciplinary research centers. Berkeley operates Lawrence Berkeley National Laboratory, manages Los Alamos National Laboratory, and is a founding partner of the Space Sciences Laboratory.","The Berkeley campus offers over 350 degree programs through its 14 colleges and schools. Popular majors include Computer Science, Economics, Political Science, and Business Administration. The student-faculty ratio is 17:1.","Berkeley's libraries contain more than 13 million volumes and maintain special collections including the Mark Twain Papers, the Oral History Center, and the Bancroft Library, which houses the largest collection of materials on California history.","The campus is home to several museums including the Berkeley Art Museum and Pacific Film Archive, the Lawrence Hall of Science, and the UC Botanical Garden. These facilities serve both educational and public outreach purposes.","Notable Berkeley inventions and discoveries include the cyclotron, the atomic bomb, the flu vaccine, and vitamin E. Berkeley researchers discovered 16 chemical elements of the periodic table, more than any other university.","The Free Speech Movement, which took place during the 1964-65 academic year, was a pivotal moment in the history of civil liberties in the United States. It began when students protested a ban on political activities on campus.","Berkeley's Campanile, known as Sather Tower, is the third-tallest clock tower in the world at 307 feet. It was completed in 1914 and is visible for miles, serving as a symbol of the university.","The university operates on a semester system, with fall semester beginning in late August and spring semester beginning in mid-January. Berkeley offers over 5,000 courses each semester across all disciplines.",`Cal Bears have won at least one team national title in 13 different sports. The university's traditional rival is Stanford University, with the annual football game known as "The Big Game" dating back to 1892.`],getTextPassage(t){if(this.seedRandom){const e=Math.floor(this.getRandom()*this.textPassages.length),n=(t-1+e)%this.textPassages.length;return this.textPassages[n]}else{const e=(t-1)%this.textPassages.length;return this.textPassages[e]}}};function Ud({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r,preGeneratedPattern:s=null,preGeneratedText:i=null}){const[a,l]=N.useState(""),[c,h]=N.useState(""),[p,m]=N.useState(null),[y,I]=N.useState(""),[A,P]=N.useState(null),[O,k]=N.useState(""),[E,T]=N.useState(""),[M]=N.useState(Date.now()),[$,B]=N.useState(""),[S,g]=N.useState(!1),[w,C]=N.useState(new Set),v=N.useRef(0);N.useRef(null);const R=(U,b=null,j=null)=>{const V=document.createElement("canvas"),L=V.getContext("2d");V.width=900,V.height=400,L.fillStyle="#fafafa",L.fillRect(0,0,V.width,V.height),L.strokeStyle="#e0e0e0",L.lineWidth=2,L.strokeRect(0,0,V.width,V.height),L.font="24px monospace",L.fillStyle="#333";const X=36,q=25,ne=V.width-q*2;return((ge,Ce)=>{const xe=ge.split(" "),ae=[];let Se="";for(let _e of xe){const Re=Se+(Se?" ":"")+_e;L.measureText(Re).width>Ce&&Se?(ae.push(Se),Se=_e):Se=Re}return Se&&ae.push(Se),ae})(U,ne).forEach((ge,Ce)=>{const xe=q+(Ce+1)*X;let ae=q;if(t<=5){const Se=ge.split(" ");let _e=0;Se.forEach(Re=>{const pt=j&&j.has(_e),Ze=b&&b.some(Ct=>Re.toLowerCase()===Ct.toLowerCase());if(pt){const Ct=L.measureText(Re).width;L.fillStyle="yellow",L.fillRect(ae-2,xe-18,Ct+4,24)}else if(Ze){const Ct=L.measureText(Re).width;L.fillStyle="rgba(255, 215, 0, 0.4)",L.fillRect(ae-2,xe-18,Ct+4,24)}L.fillStyle="#333",L.fillText(Re,ae,xe),ae+=L.measureText(Re+" ").width,_e++})}else for(let Se=0;Se<ge.length;Se++){const _e=ge[Se],Re=L.measureText(_e).width;b&&b.some(Ze=>_e.toLowerCase()===Ze.toLowerCase())&&(L.fillStyle="rgba(255, 215, 0, 0.4)",L.fillRect(ae-1,xe-18,Re+2,24)),L.fillStyle="#333",L.fillText(_e,ae,xe),ae+=Re}}),V.toDataURL()};N.useEffect(()=>{I(0),P(null),v.current=0},[t]),N.useEffect(()=>{const U=async(j,V)=>{const L=document.createElement("canvas"),X=L.getContext("2d");L.width=900,L.height=350,X.fillStyle="#fafafa",X.fillRect(0,0,L.width,L.height),X.strokeStyle="#e0e0e0",X.lineWidth=2,X.strokeRect(0,0,L.width,L.height),X.font="24px monospace";const q=36,ne=20,oe=L.width-ne*2,ge=((Ce,xe)=>{const ae=Ce.split(" "),Se=[];let _e="";for(let Re of ae){const pt=_e+(_e?" ":"")+Re;X.measureText(pt).width>xe&&_e?(Se.push(_e),_e=Re):_e=pt}return _e&&Se.push(_e),Se})(O,oe);for(let Ce=0;Ce<j.length;Ce++)j[Ce],ge.forEach((xe,ae)=>{const Se=ne+(ae+1)*q;let _e=ne;for(let Re=0;Re<xe.length;Re++){const pt=xe[Re],Ze=X.measureText(pt).width;j.some($n=>pt.toLowerCase()===$n.toLowerCase())&&(X.fillStyle="rgba(255, 255, 0, 0.6)",X.fillRect(_e-1,Se-20,Ze+2,26)),X.fillStyle="#333",X.fillText(pt,_e,Se),_e+=Ze}}),B(L.toDataURL()),await new Promise(xe=>setTimeout(xe,300));setTimeout(()=>{I(V.toString())},300)},b=async j=>{const{action:V,highlightWords:L,suggestedCount:X,animate:q,isMultiLetter:ne,targetLetters:oe}=j.detail||{};if(V==="highlightAndCount"){if(ne&&Array.isArray(oe)){q&&await U(oe,X);return}if(Array.isArray(L)&&q){O.split(" ");let ve=[];for(let ge=0;ge<L.length;ge++){ve.push(L[ge]);const Ce=document.createElement("canvas"),xe=Ce.getContext("2d");Ce.width=900,Ce.height=350,xe.fillStyle="#fafafa",xe.fillRect(0,0,Ce.width,Ce.height),xe.strokeStyle="#e0e0e0",xe.lineWidth=2,xe.strokeRect(0,0,Ce.width,Ce.height),xe.font="24px monospace";const ae=36,Se=20,_e=Ce.width-Se*2;((Ze,Ct)=>{const $n=Ze.split(" "),Ht=[];let tn="";for(let qt of $n){const Wn=tn+(tn?" ":"")+qt;xe.measureText(Wn).width>Ct&&tn?(Ht.push(tn),tn=qt):tn=Wn}return tn&&Ht.push(tn),Ht})(O,_e).forEach((Ze,Ct)=>{const $n=Se+(Ct+1)*ae;let Ht=Se;Ze.split(" ").forEach(qt=>{const Wn=xe.measureText(qt).width;ve.some(is=>{const tr=qt.replace(/[.,;!?]/g,"").toLowerCase(),zs=is.replace(/[.,;!?]/g,"").toLowerCase();return tr===zs})&&(xe.fillStyle="rgba(255, 255, 0, 0.5)",xe.fillRect(Ht-2,$n-18,Wn+4,24)),xe.fillStyle="#333",xe.fillText(qt,Ht,$n),Ht+=xe.measureText(qt+" ").width})}),B(Ce.toDataURL()),await new Promise(Ze=>setTimeout(Ze,200))}setTimeout(()=>{I(X.toString())},300)}}};return window.addEventListener("aiCountingHelp",b),()=>window.removeEventListener("aiCountingHelp",b)},[O,t]),N.useEffect(()=>{var L;const U=s||Xe.generateCountingPattern(t),b=i||Xe.getTextPassage(t);k(b),l(U.target||((L=U.targets)==null?void 0:L.join(", "))),h(U.instruction);let j=0;if(U.type==="word"){const X=new RegExp(`\\b${U.target}\\b`,"gi"),q=b.match(X);j=q?q.length:0}else if(U.type==="letter"){const X=new RegExp(U.target,"gi"),q=b.match(X);j=q?q.length:0}else U.type==="multi-letter"&&U.targets.forEach(X=>{const q=new RegExp(X,"gi"),ne=b.match(q);j+=ne?ne.length:0});m(j);const V=R(b,null);B(V)},[t,s,i]);const _=async()=>{const U=Date.now()-M,b=parseInt(y,10)||0,j=p??0,V=Math.abs(b-j),L=`g1t${t}`,X=localStorage.getItem(`lastAIHelp_${L}`);if(X){const oe=JSON.parse(X),ve=Date.now()-oe.timestamp,ge=b===oe.suggestion?"accepted":"modified";await Ue.trackAIHelpResponse(L,oe.type,oe.suggestion,ge,b,ve),localStorage.removeItem(`lastAIHelp_${L}`)}let q=0;V===0?q=2:V<=1?q=1:q=0,v.current+=1,await Ue.trackTaskAttempt(L,v.current,!0,U,b,j);const ne=localStorage.getItem("sessionId");if(ne&&!ne.startsWith("offline-"))try{await lr(Mt(nt,"sessions",ne),{[`taskAccuracies.g1t${t}`]:q===2?100:q===1?70:0,[`taskTimes.g1t${t}`]:U,[`taskPoints.g1t${t}`]:q,lastActivity:Vn()})}catch(oe){console.error("Error storing accuracy:",oe)}P(q===2?" Perfect! 2 points earned!":q===1?` Off by ${V} - 1 point earned!`:` Off by ${V} - 0 points earned.`),setTimeout(()=>{e==null||e(`g1t${t}`,{attempts:v.current,totalTime:U,accuracy:q===2?100:q===1?70:0,userAnswer:b,correctAnswer:j,points:q})},500)},Z=Xe.generateCountingPattern(t).difficultyLabel,ce=t<=5?"easy":t<=10?"medium":"hard";return u.jsxs("div",{className:"task counting",children:[u.jsxs("h3",{children:["Research Content - Level ",t]}),u.jsx("div",{className:`difficulty-badge ${ce}`,children:Z}),u.jsxs("p",{className:"instruction",children:[u.jsx("strong",{children:c}),u.jsx("br",{}),u.jsx("span",{className:"hint",children:"(Case-insensitive)"})]}),u.jsxs("div",{className:"text-display text-to-count","data-counting-text":O,children:[u.jsx("div",{className:"count-target","data-pattern":a,style:{display:"none"},children:a}),$?u.jsx("img",{src:$,alt:"Text passage for counting",style:{width:"100%",maxWidth:"900px",height:"auto",maxHeight:"350px",objectFit:"contain",border:"none",userSelect:"none",pointerEvents:"none"},onContextMenu:U=>U.preventDefault(),draggable:!1}):u.jsx("div",{dangerouslySetInnerHTML:{__html:E}})]}),u.jsxs("div",{className:"input-section",children:[u.jsx("label",{children:"Your answer:"}),u.jsx("input",{type:"number",min:"0",max:"999",value:y,onChange:U=>I(U.target.value),onKeyPress:U=>{U.key==="Enter"&&_()},placeholder:"Enter count"})]}),u.jsx("button",{onClick:_,className:"submit-btn",style:{display:"block",margin:"20px auto 0"},children:"Submit"}),A&&u.jsx("div",{className:`feedback ${A.includes("2 points")?"correct":A.includes("0 points")?"incorrect":"partial"}`,children:A})]})}function $d({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r,preGeneratedPattern:s=null}){const[i,a]=N.useState(5),[l,c]=N.useState(0),[h,p]=N.useState(null),[m]=N.useState(Date.now()),[y,I]=N.useState(1),[A,P]=N.useState(!0),[O,k]=N.useState(!1),[E,T]=N.useState(!1),[M,$]=N.useState(!1),[B,S]=N.useState(!1),g=N.useRef(null),w=N.useRef(0);N.useEffect(()=>{if(n)a(3),I(1),P(!0);else{const b=s||Xe.generateSliderPattern(t);a(b.target),I(b.step),P(b.showValue)}c(0),p(null),w.current=0},[t,n,s]),N.useEffect(()=>{const b=j=>{const{action:V,value:L,animate:X}=j.detail;if(V==="moveSlider")if(T(!0),X){const q=parseFloat(l),ne=parseFloat(L),oe=1e3,ve=30;let ge=0;const Ce=setInterval(()=>{ge++;const xe=ge/ve,ae=1-Math.pow(1-xe,3),Se=q+(ne-q)*ae;c(parseFloat(Se.toFixed(2))),ge>=ve&&(clearInterval(Ce),T(!1),c(parseFloat(ne.toFixed(2))))},oe/ve)}else c(parseFloat(L.toFixed(2))),T(!1)};return window.addEventListener("aiSliderHelp",b),()=>window.removeEventListener("aiSliderHelp",b)},[l]),N.useEffect(()=>{const b=j=>{j.key==="Enter"&&!E&&_()};return document.addEventListener("keypress",b),()=>document.removeEventListener("keypress",b)},[E,l,i]);const C=b=>{if(E)return;const j=g.current;if(!j)return;b.preventDefault();const V=j.getBoundingClientRect(),L=l/10,X=V.left+V.width*L,q=b.clientX||b.touches&&b.touches[0].clientX;Math.abs(q-X)<30&&($(!0),S(!0))},v=b=>{if(!M||E)return;const j=g.current;if(!j)return;const V=j.getBoundingClientRect(),L=b.clientX||b.touches&&b.touches[0].clientX,q=Math.max(0,Math.min(1,(L-V.left)/V.width))*10,ne=Math.round(q/y)*y;c(parseFloat(ne.toFixed(2)))},R=()=>{$(!1)};N.useEffect(()=>{if(M){const b=V=>v(V),j=()=>R();return document.addEventListener("mousemove",b),document.addEventListener("mouseup",j),document.addEventListener("touchmove",b),document.addEventListener("touchend",j),()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",j),document.removeEventListener("touchmove",b),document.removeEventListener("touchend",j)}}},[M,y,E]);const _=async()=>{const b=Date.now()-m,j=parseFloat(l),V=Math.abs(j-i),L=`g2t${t}`,X=localStorage.getItem(`lastAIHelp_${L}`);if(X){const oe=JSON.parse(X),ve=Date.now()-oe.timestamp,ge=j===oe.suggestion?"accepted":"modified";await Ue.trackAIHelpResponse(L,oe.type,oe.suggestion,ge,j,ve),localStorage.removeItem(`lastAIHelp_${L}`)}let q=0;V===0?q=2:V<=1?q=1:q=0,w.current+=1,await Ue.trackTaskAttempt(L,w.current,!0,b,j,i);const ne=localStorage.getItem("sessionId");if(ne&&!ne.startsWith("offline-"))try{await lr(Mt(nt,"sessions",ne),{[`taskDifferences.g2t${t}`]:V,[`taskTimes.g2t${t}`]:b,[`taskPoints.g2t${t}`]:q,lastActivity:Vn()})}catch(oe){console.error("Error storing difference:",oe)}p(q===2?" Perfect! 2 points earned!":q===1?` Off by ${V.toFixed(2)} - 1 point earned!`:` Off by ${V.toFixed(2)} - 0 points earned.`),setTimeout(()=>{e(`g2t${t}`,{attempts:w.current,totalTime:b,accuracy:q===2?100:q===1?70:0,userAnswer:j,correctAnswer:i,points:q})},500)},ee=Xe.generateSliderPattern(t),Z=ee.difficultyLabel,ce=ee.difficulty,U=()=>{const b=[];for(let j=0;j<=10;j++)b.push(u.jsxs("div",{style:{position:"absolute",left:`${j*10}%`,transform:"translateX(-50%)",textAlign:"center"},children:[u.jsx("div",{style:{width:"2px",height:"12px",background:"#666",margin:"0 auto"}}),u.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:j})]},j));return b};return u.jsxs("div",{className:`task slider ${E?"ai-controlled":""}`,children:[u.jsxs("h3",{children:["Material Creation - Level ",t]}),u.jsx("div",{className:`difficulty-badge ${ce}`,children:Z}),u.jsxs("p",{className:"instruction",children:["Move the slider to:"," ",u.jsx("strong",{className:"target-value","data-target-value":i,children:i}),u.jsx("br",{}),u.jsx("span",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:!B&&"Hold and drag the slider handle to move it"})]}),u.jsxs("div",{className:"slider-container",children:[u.jsxs("div",{className:"range-labels",children:[u.jsx("span",{children:"0"}),u.jsx("span",{children:"10"})]}),u.jsxs("div",{style:{position:"relative",padding:"20px 0 30px 0"},children:[u.jsx("div",{style:{position:"absolute",width:"100%",height:"20px",top:"0"},children:U()}),u.jsx("div",{style:{position:"relative",marginTop:"20px"},children:u.jsx("input",{ref:g,type:"range",min:"0",max:"10",step:y,value:l,onChange:b=>{!M&&!E&&(c(parseFloat(b.target.value)),S(!0))},className:"slider-input",style:{width:"100%",cursor:M?"grabbing":"grab"},onMouseDown:C,onTouchStart:C})})]}),u.jsx("div",{className:"current-value",children:A?parseFloat(l).toFixed(n?0:ee.precision):"??"})]}),u.jsx("button",{onClick:_,className:"submit-btn",disabled:E,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),h&&u.jsx("div",{className:`feedback ${h.includes("2 points")?"correct":h.includes("0 points")?"incorrect":"partial"}`,children:h})]})}function Wd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r,preGeneratedPattern:s=null}){const[i,a]=N.useState(""),[l,c]=N.useState(""),[h,p]=N.useState(null),[m]=N.useState(Date.now()),[y,I]=N.useState(""),[A,P]=N.useState(!1),O=N.useRef(0),k=B=>{const S=document.createElement("canvas"),g=S.getContext("2d");return S.width=600,S.height=150,g.fillStyle="#f5f5f5",g.fillRect(0,0,S.width,S.height),g.font='bold 40px "Courier New", monospace',g.fillStyle="#333",g.textAlign="center",g.textBaseline="middle",g.fillText(B,S.width/2,S.height/2),S.toDataURL()};N.useEffect(()=>{const S=(s||Xe.generateTypingPattern(t)).pattern;a(S);const g=k(S);I(g)},[t,s]),N.useEffect(()=>{c(""),p(null),O.current=0},[t]),N.useEffect(()=>{const B=S=>{const{action:g,text:w,typeSpeed:C}=S.detail;if(g==="autoType"&&w){P(!0),c("");let v="",R=0;const _=setInterval(()=>{R<w.length?(v+=w[R],c(v),R++):(clearInterval(_),P(!1))},C||50);return()=>clearInterval(_)}};return window.addEventListener("aiTypingHelp",B),()=>window.removeEventListener("aiTypingHelp",B)},[]);const E=async()=>{const B=Date.now()-m,S=`g3t${t}`,g=localStorage.getItem(`lastAIHelp_${S}`);if(g){const _=JSON.parse(g),ee=Date.now()-_.timestamp,Z=l===_.suggestion?"accepted":"modified";await Ue.trackAIHelpResponse(S,_.type,_.suggestion,Z,l,ee),localStorage.removeItem(`lastAIHelp_${S}`)}const C=((_,ee)=>{const Z=_.length,ce=ee.length,U=Array(Z+1).fill(null).map(()=>Array(ce+1).fill(0));for(let b=0;b<=Z;b++)U[b][0]=b;for(let b=0;b<=ce;b++)U[0][b]=b;for(let b=1;b<=Z;b++)for(let j=1;j<=ce;j++)_[b-1]===ee[j-1]?U[b][j]=U[b-1][j-1]:U[b][j]=Math.min(U[b-1][j]+1,U[b][j-1]+1,U[b-1][j-1]+1);return U[Z][ce]})(l,i);let v=0;C===0?v=2:C===1?v=1:v=0,O.current+=1,await Ue.trackTaskAttempt(S,O.current,!0,B,l,i);const R=localStorage.getItem("sessionId");if(R&&!R.startsWith("offline-"))try{await lr(Mt(nt,"sessions",R),{[`taskAccuracies.g3t${t}`]:v===2?100:v===1?70:0,[`taskTimes.g3t${t}`]:B,[`taskPoints.g3t${t}`]:v,lastActivity:Vn()})}catch(_){console.error("Error storing accuracy:",_)}p(v===2?" Perfect! 2 points earned!":v===1?" 1 typo - 1 point earned!":` ${C} errors - 0 points earned.`),setTimeout(()=>{e(`g3t${t}`,{attempts:O.current,totalTime:B,accuracy:v===2?100:v===1?70:0,userAnswer:l,correctAnswer:i,points:v})},500)},T=Xe.generateTypingPattern(t),M=T.difficultyLabel,$=T.difficulty;return u.jsxs("div",{className:"task typing",style:{maxWidth:"100%"},children:[u.jsxs("h3",{children:["Student Engagement - Level ",t]}),u.jsx("div",{className:`difficulty-badge ${$}`,children:M}),u.jsx("p",{className:"instruction",children:"Type this pattern exactly:"}),u.jsxs("div",{className:"pattern-display",children:[u.jsx("div",{className:"typing-pattern","data-typing-pattern":i,style:{display:"none"},children:i}),y?u.jsx("img",{src:y,alt:"Pattern to type",style:{width:"100%",maxWidth:"600px",height:"auto",userSelect:"none",pointerEvents:"none"},onContextMenu:B=>B.preventDefault(),draggable:!1}):u.jsx("span",{className:"pattern-text",children:i})]}),u.jsx("div",{className:"input-section",style:{width:"90%",maxWidth:"900px",margin:"20px auto 0"},children:u.jsx("input",{type:"text",inputMode:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:l,onChange:B=>!A&&c(B.target.value),onKeyPress:B=>{B.key==="Enter"&&!A&&(B.preventDefault(),E())},placeholder:"Type here...",className:"typing-input",disabled:A,style:{backgroundColor:A?"#e3f2fd":"white",transition:"background-color 0.3s",width:"100%",maxWidth:"100%",fontFamily:'"Courier New", monospace',fontSize:"28px",padding:"12px 14px",border:"2px solid #e0e0e0",borderRadius:"8px",boxSizing:"border-box"}})}),u.jsx("button",{onClick:E,className:"submit-btn",disabled:A,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),h&&u.jsx("div",{className:`feedback ${h.includes("2 points")?"correct":h.includes("0 points")?"incorrect":"partial"}`,children:h})]})}function mI({current:t,completed:e,onSwitch:n,limitMode:r,taskPoints:s={},categoryMultipliers:i={},starGoals:a={},categoryPoints:l={},timeRemaining:c=null}){const h=()=>{const T=l.materials||0,M=1+(l.research||0)*.15,$=parseFloat(localStorage.getItem("engagementInterest")||"0")||0;return T*M+$},p=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,m=1+(l.research||0)*.15,y=[];for(let T=1;T<=3;T++)for(let M=1;M<=100;M++){const $=["Research","Materials","Engage"][T-1];y.push({id:`g${T}t${M}`,label:`${$} ${M}`,game:T})}const I=T=>{const M=T.id[1],$=parseInt(T.id.substring(3));if($===1)return!0;const B=`g${M}t${$-1}`;return e[B]===!0},A={2:y.filter(T=>T.game===2),1:y.filter(T=>T.game===1),3:y.filter(T=>T.game===3)},P={1:"#9C27B0",2:"#4CAF50",3:"#f44336"},O={1:"",2:"",3:""},k={1:"Research",2:"Materials",3:"Engagement"},E={1:"research",2:"materials",3:"engagement"};return u.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"25px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"25px"},children:[2,1,3].map(T=>{const M=A[T],$=M.filter(v=>e[v.id]).length,B=E[T],S=$+1,g=T==="1"?(l.research||0)*.15:0,w=T==="3"?(l.engagement||0)*.0015:0,C=g>0||w>0;return u.jsxs("div",{style:{background:`linear-gradient(135deg, ${P[T]}10 0%, ${P[T]}05 100%)`,borderRadius:"12px",border:`2px solid ${P[T]}20`,padding:"20px",position:"relative",overflow:"hidden",boxShadow:C?`0 0 20px ${P[T]}20`:"none",transition:"all 0.3s ease"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"15px"},children:[u.jsx("span",{style:{fontSize:"28px"},children:O[T]}),u.jsxs("div",{style:{flex:1},children:[u.jsx("h3",{style:{margin:0,color:P[T],fontSize:"18px",fontWeight:"bold"},children:k[T]}),u.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:["Level ",Math.min(S,30)]})]}),l&&l[B]>0&&u.jsxs("div",{style:{background:P[T],color:"white",padding:"6px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[l[B]," pts"]})]}),T==="1"&&(l.research||0)>0&&u.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",(l.research*15).toFixed(0),"%"]}),T==="3"&&(l.engagement||0)>0&&u.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",((l.engagement||0)*.15).toFixed(1),"% interest/task"]}),u.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:M.filter(v=>parseInt(v.id.substring(3))<=S).map(v=>{const R=I(v),_=e[v.id],ee=t===v.id,Z=parseInt(v.id.substring(3)),ce=s[v.id]||0;return u.jsxs("button",{disabled:!R||_,onClick:()=>R&&!_&&n(v.id),style:{position:"relative",width:"40px",height:"40px",padding:"0",fontSize:"14px",fontWeight:ee?"bold":"500",border:`2px solid ${ee?P[T]:_?`${P[T]}40`:"#e0e0e0"}`,borderRadius:"8px",background:ee?P[T]:_?`${P[T]}10`:"white",color:ee?"white":_?P[T]:"#333",cursor:R&&!_?"pointer":"not-allowed",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",opacity:_?.7:1,boxShadow:ee?`0 2px 8px ${P[T]}40`:"none",transform:"translateY(0)",willChange:"transform, box-shadow"},onMouseEnter:U=>{R&&!ee&&!_&&requestAnimationFrame(()=>{U.currentTarget.style.transform="translateY(-2px)",U.currentTarget.style.boxShadow=`0 4px 12px ${P[T]}30`})},onMouseLeave:U=>{R&&!ee&&!_&&requestAnimationFrame(()=>{U.currentTarget.style.transform="translateY(0)",U.currentTarget.style.boxShadow="none"})},title:_?`Level ${Z} completed (${ce} pts)`:R?`Start Level ${Z}`:`Complete Level ${Z-1} first`,children:[Z,_&&u.jsx("span",{style:{position:"absolute",top:"-4px",right:"-4px",background:P[T],color:"white",width:"16px",height:"16px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"bold"},children:""}),_&&u.jsx("div",{style:{position:"absolute",bottom:"2px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"2px"},children:ce===0?u.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",border:`1px solid ${P[T]}`,background:"transparent"}}):[...Array(Math.min(ce,2))].map((U,b)=>u.jsx("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:P[T]}},b))})]},v.id)})})]},T)})}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",background:"#f8f9fa",borderRadius:"8px",flexWrap:"wrap",gap:"20px"},children:[c!==null&&u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""}),u.jsxs("div",{children:[u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:c<60?"#f44336":"#333"},children:[Math.floor(c/60),":",(c%60).toString().padStart(2,"0")]}),c<180&&c>0&&u.jsx("div",{style:{fontSize:"11px",color:"#ff9800"},children:"Hurry up!"})]})]}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Tasks Completed"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:Object.keys(e).length})]}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Student Learning"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:Math.round(h())}),u.jsxs("div",{style:{fontSize:"10px",color:"#999"},children:[l.materials||0," (materials)  ",m.toFixed(2)," (research) + ",p.toFixed(1)," (cumulative engagement interest)"]})]}),t&&u.jsxs("div",{style:{padding:"8px 16px",background:t.startsWith("g1")?"#9C27B0":t.startsWith("g2")?"#4CAF50":"#f44336",color:"white",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:["Current:"," ",t.replace("g1t","Research ").replace("g2t","Materials ").replace("g3t","Engage ")]})]})]})}function yI({practiceCompleted:t={},onPracticeComplete:e,onStartMainGame:n,onSelectPractice:r,isAdmin:s=!1}){const[i,a]=N.useState(null),l=(y,I)=>{if(I&&I.points===2){typeof e=="function"&&e(y,I);const A=document.createElement("div");A.className="notification-enter",A.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",A.textContent="Perfect! Practice task completed. Returning to menu...",document.body.appendChild(A),setTimeout(()=>{a(null),document.body.contains(A)&&document.body.removeChild(A)},1500)}else{const A=(I==null?void 0:I.points)||0,P=document.createElement("div");P.className="notification-enter",P.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #ff9800; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",P.textContent=`Practice requires 100% accuracy. You scored ${A===1?"50%":"0%"}. Try again!`,document.body.appendChild(P),setTimeout(()=>{document.body.contains(P)&&document.body.removeChild(P)},3e3)}},c=t.g2t1&&t.g1t1&&t.g3t1,h=()=>u.jsxs("div",{className:"practice-menu",children:[u.jsxs("h2",{children:["Practice Mode ",!s&&"(Required)"]}),!s&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",borderRadius:"12px",padding:"16px",marginBottom:"25px",border:"2px solid #f57c00",boxShadow:"0 4px 6px rgba(245, 124, 0, 0.1)",textAlign:"center"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""}),u.jsx("strong",{style:{color:"#e65100",fontSize:"18px"},children:"100% PERFECT ACCURACY REQUIRED"})]}),u.jsxs("div",{style:{color:"#e65100",fontSize:"14px"},children:["You must score 2/2 points (exact answer) on all three practice tasks to proceed.",u.jsx("br",{}),u.jsx("strong",{children:"No partial credit in practice mode!"})]}),u.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"12px"},children:[u.jsxs("span",{style:{padding:"4px 12px",background:t.g2t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g2t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g2t1?"#4CAF50":"#ffb74d"}`},children:["Materials ",t.g2t1?"":"Required"]}),u.jsxs("span",{style:{padding:"4px 12px",background:t.g1t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g1t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g1t1?"#4CAF50":"#ffb74d"}`},children:["Research ",t.g1t1?"":"Required"]}),u.jsxs("span",{style:{padding:"4px 12px",background:t.g3t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g3t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g3t1?"#4CAF50":"#ffb74d"}`},children:["Engagement ",t.g3t1?"":"Required"]})]})]}),u.jsx("p",{className:"practice-hint",style:{textAlign:"center",fontSize:"16px",color:"#666",marginBottom:"30px"},children:"Try each task type before starting the main challenge. No time pressure!"}),u.jsxs("div",{className:"practice-cards",children:[u.jsxs("div",{className:"practice-card materials",children:[u.jsx("h3",{children:" Materials"}),u.jsx("p",{children:"Hold and drag slider to match target values"}),u.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Base points - directly added to score"}),u.jsx("div",{className:"practice-buttons",children:u.jsx("button",{onClick:()=>{a("g2t1"),r&&r("g2t1")},className:t.g2t1?"completed":"",disabled:!1,children:t.g2t1?" Completed":"Try Materials"})})]}),u.jsxs("div",{className:"practice-card research",children:[u.jsx("h3",{children:" Research"}),u.jsx("p",{children:"Count words or letters in text passages"}),u.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 15% multiplier per point in main game"}),u.jsx("div",{className:"practice-buttons",children:u.jsx("button",{onClick:()=>{a("g1t1"),r&&r("g1t1")},className:t.g1t1?"completed":"",disabled:!1,children:t.g1t1?" Completed":"Try Research"})})]}),u.jsxs("div",{className:"practice-card engagement",children:[u.jsx("h3",{children:" Engagement"}),u.jsx("p",{children:"Type patterns exactly as shown"}),u.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 0.15% compound interest per point"}),u.jsx("div",{className:"practice-buttons",children:u.jsx("button",{onClick:()=>{a("g3t1"),r&&r("g3t1")},className:t.g3t1?"completed":"",disabled:!1,children:t.g3t1?" Completed":"Try Engagement"})})]})]}),u.jsxs("div",{style:{marginTop:"25px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",textAlign:"center"},children:[u.jsx("h4",{style:{margin:"0 0 10px 0",color:"#333",fontSize:"16px"},children:"Practice Progress:"}),u.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[u.jsxs("div",{style:{padding:"8px 15px",background:t.g2t1?"#4CAF50":"#e0e0e0",color:t.g2t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Materials ",t.g2t1&&""]}),u.jsxs("div",{style:{padding:"8px 15px",background:t.g1t1?"#9C27B0":"#e0e0e0",color:t.g1t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Research ",t.g1t1&&""]}),u.jsxs("div",{style:{padding:"8px 15px",background:t.g3t1?"#f44336":"#e0e0e0",color:t.g3t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Engagement ",t.g3t1&&""]})]}),u.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#666"},children:[u.jsx("strong",{children:"100% accuracy required"})," to complete each practice task"]})]}),u.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:u.jsx("button",{className:"start-main-game-btn",onClick:n,style:{opacity:!s&&!c?.5:1,cursor:!s&&!c?"not-allowed":"pointer"},disabled:!s&&!c,children:s?"Start Main Game (Admin)":c?"Start Main Game - You're Ready! ":"Complete Practice First"})})]});if(!i)return h();const p=i[1],m=1;return u.jsxs("div",{className:"practice-container",children:[u.jsx("button",{className:"back-to-menu",onClick:()=>a(null),children:" Back to Practice Menu"}),u.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[u.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),u.jsxs("div",{className:"practice-task-wrapper",children:[p==="1"&&u.jsx(Ud,{taskNum:m,onComplete:l,isPractice:!0,currentTaskId:i}),p==="2"&&u.jsx($d,{taskNum:m,onComplete:l,isPractice:!0,currentTaskId:i}),p==="3"&&u.jsx(Wd,{taskNum:m,onComplete:l,isPractice:!0,currentTaskId:i})]})]})}class vI{constructor(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={}}getUniversalAttemptNumber(){return this.totalAIUsage}shouldAIBeCorrect(e){let n;return e===1||e===2||e===4||e===5?n=!0:e===3?n=!1:n=Math.random()<.75,n}getTaskUsageCount(e){return this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]}incrementTaskUsage(e,n){this.totalAIUsage++,this.usageCount[n]++,this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]++}resetForNewSemester(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={},console.log(" AI Help usage reset for new semester")}helpWithSlider(e,n){this.incrementTaskUsage(n,"materials");const r=this.getUniversalAttemptNumber();let s;if(this.shouldAIBeCorrect(r))s=e;else if(r===3){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else if(Math.random()<.5){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else{const i=(Math.random()<.5?-1:1)*(2+Math.random()*2);s=Math.max(0,Math.min(10,e+i))}return{action:"moveSlider",value:s,animate:!0}}helpWithCounting(e,n,r){this.incrementTaskUsage(r,"research");const s=this.getUniversalAttemptNumber(),i=this.shouldAIBeCorrect(s);return n.length===1||n.includes(" and ")||n.includes(",")?this.helpWithLetterCounting(e,n,s,i):this.helpWithWordCounting(e,n,s,i)}helpWithLetterCounting(e,n,r,s){let i=[];n.includes(" and ")||n.includes(",")?i=n.match(/[a-z]/gi)||[]:i=[n];let a=0;i.forEach(h=>{const p=new RegExp(h,"gi"),m=e.match(p);a+=m?m.length:0});let l=a,c=[...i];if(!s){r===3||Math.random()<.5?l=a+1:l=a+Math.floor(Math.random()*3)+2,l=Math.max(0,l);const p="abcdefghijklmnopqrstuvwxyz".split("").filter(y=>!i.includes(y.toLowerCase())),m=Math.floor(Math.random()*2)+1;for(let y=0;y<m&&p.length>0;y++){const I=Math.floor(Math.random()*p.length);c.push(p[I]),p.splice(I,1)}}return{action:"highlightAndCount",highlightWords:[],suggestedCount:l,animate:!0,isMultiLetter:!0,targetLetters:c}}helpWithWordCounting(e,n,r,s){const i=e.split(/\s+/),a=[];let l=0,c=0;if(i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&c++}),s)i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&(a.push(h),l++)});else if(r===3){l=c+1,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());if(h.length>0&&a.length<l){const p=h[Math.floor(Math.random()*h.length)];a.push(p)}}else{Math.random()<.5?l=c+1:l=c+Math.floor(Math.random()*3)+2,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());for(;a.length<l&&h.length>0;){const p=Math.floor(Math.random()*h.length),m=h[p];a.includes(m)||a.push(m),h.splice(p,1)}}return{action:"highlightAndCount",highlightWords:a,suggestedCount:l,animate:!0}}helpWithTyping(e,n){this.incrementTaskUsage(n,"engagement");const r=this.getUniversalAttemptNumber();let s=e;const i={0:["o","O"],o:["0"],O:["0"],1:["l","I","i"],l:["1","I","i"],I:["1","l","i"],i:["1","l","I"],e:["3"],3:["e"],a:["@"],"@":["a"],s:["5","$"],S:["5","$"],5:["s","S"],$:["s","S"],g:["9"],9:["g"],b:["6"],6:["b"],z:["2"],2:["z"],B:["8"],8:["B"]},a=l=>{const c=l.split(""),h=c.map((p,m)=>i[p]?m:-1).filter(p=>p!==-1);if(h.length>0){const p=h[Math.floor(Math.random()*h.length)],m=c[p],y=i[m];y&&y.length>0&&(c[p]=y[Math.floor(Math.random()*y.length)])}else{const p=["transpose","duplicate","missing"],m=p[Math.floor(Math.random()*p.length)],y=Math.floor(Math.random()*c.length);switch(m){case"transpose":y<c.length-1&&([c[y],c[y+1]]=[c[y+1],c[y]]);break;case"duplicate":c.splice(y,0,c[y]);break;case"missing":c.splice(y,1);break}}return c.join("")};if(this.shouldAIBeCorrect(r))s=e;else if(r===3)s=a(e);else if(Math.random()<.5)s=a(e);else{let l=e;const c=Math.floor(Math.random()*3)+2;for(let h=0;h<c;h++)l=a(l);s=l}return{action:"autoType",text:s,typeSpeed:50,perfect:this.shouldAIBeCorrect(r)}}}const vt=new vI;function em({bonusPrompts:t=0,currentTask:e="",categoryPoints:n=null,timeRemaining:r=null,calculateStudentLearning:s=()=>0,aiCost:i=0,onAiCost:a}){const[l,c]=N.useState(!0),[h,p]=N.useState(0),[m,y]=N.useState(!1);N.useEffect(()=>{const j=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");c(j.hasAI!==!1)},[]),N.useEffect(()=>{if(e){const j=vt.getTaskUsageCount(e)>=1;y(j)}},[e]),N.useEffect(()=>{const j=()=>{p(vt.totalAIUsage)},V=setInterval(j,1e3);return j(),()=>clearInterval(V)},[]);const[I,A]=N.useState([{sender:"bot",text:l?"Hello! I'm your AI teaching assistant. You get ONE AI help attempt per task - use it wisely!":"Hello! This is the chat interface. AI assistance is not available for this session."}]),[P,O]=N.useState(""),[k,E]=N.useState(!1),[T,M]=N.useState(0),[$,B]=N.useState(!1),[S,g]=N.useState({materials:0,research:0,engagement:0}),w=N.useRef(null),C=()=>e?e.startsWith("g1")?"research":e.startsWith("g2")?"materials":e.startsWith("g3")?"engagement":null:null,v=(j=null)=>{const V=j||C();if(!V){A(q=>[...q,{sender:"bot",text:"Please start a task first, then I can help you!"}]);return}if(vt.getTaskUsageCount(e)>=1){A(q=>[...q,{sender:"bot",text:" You've already used AI help for this task. Only 1 AI attempt allowed per task!"}]);return}const X=Date.now();if(X-S[V]<3e3){A(q=>[...q,{sender:"bot",text:"Please wait a moment before requesting help again!"}]);return}switch(g(q=>({...q,[V]:X})),V){case"materials":R();break;case"research":_();break;case"engagement":Z();break;default:A(q=>[...q,{sender:"bot",text:"I'm not sure which task you're on. Please try again!"}])}},R=()=>{var q,ne;const j=((q=document.querySelector("[data-target-value]"))==null?void 0:q.getAttribute("data-target-value"))||((ne=document.querySelector(".target-value"))==null?void 0:ne.textContent)||5,V=vt.helpWithSlider(parseFloat(j),e),L=vt.getUniversalAttemptNumber(),X=vt.shouldAIBeCorrect(L);Ue.trackAITaskHelp(e,"slider",V.value,X,L),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"slider",suggestion:V.value,timestamp:Date.now(),wasCorrect:X})),window.dispatchEvent(new CustomEvent("aiSliderHelp",{detail:V})),p(vt.totalAIUsage),y(!0),A(oe=>[...oe,{sender:"bot",text:` Helping with materials...
Suggested value: ${V.value.toFixed(2)}`}])},_=()=>{var L;const j=document.querySelector(".text-to-count"),V=document.querySelector(".count-target");if(j&&V){const X=j.getAttribute("data-counting-text")||"";let q=((L=V.getAttribute("data-pattern"))==null?void 0:L.replace(/['"]/g,"").trim())||"";const ne=vt.helpWithCounting(X,q,e),oe=ne.suggestedCount;window.dispatchEvent(new CustomEvent("aiCountingHelp",{detail:ne}));const ve=vt.getUniversalAttemptNumber(),ge=vt.shouldAIBeCorrect(ve);Ue.trackAITaskHelp(e,"counting",oe,ge,ve),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"counting",suggestion:oe,timestamp:Date.now(),wasCorrect:ge,highlightedWords:ne.highlightWords||[],targetLetters:ne.targetLetters||[]})),p(vt.totalAIUsage),y(!0);const Ce=ne.isMultiLetter?"letters/characters":"words";A(xe=>[...xe,{sender:"bot",text:` Helping with research...
Found ${oe} ${Ce}`}])}},ee=()=>{const j=[" CRITICAL STRATEGY: Do tasks in this EXACT order  1 Engagement (builds interest from the start) 2 Research (multiplies future materials) 3 Materials (gets all multipliers). Materials done early = WASTED points!"," MAXIMUM SCORE ORDER: Engagement FIRST  Research SECOND  Materials LAST! Why? Engagement compounds every task, Research only multiplies FUTURE materials. Doing materials early gets ZERO multiplier!"," WARNING: Research multipliers ONLY apply to materials earned AFTER! If you do materials first, you get NO bonus. Always do ALL engagement & research before touching ANY materials!"," PRO TIP: Complete 100% of Engagement tasks first (builds interest early), then 100% of Research (sets up multipliers), THEN do Materials. This order can DOUBLE your score vs doing materials first!"," OPTIMAL PATH: Think of it like this - Engagement = compound interest (starts early), Research = multiplier (affects future only), Materials = base score (save for last). Wrong order = lost points forever!"],V=j[Math.floor(Math.random()*j.length)];A(L=>[...L,{sender:"bot",text:V}]),Ue.trackUserAction("planning_help_requested",{response:V,currentTask:e,timestamp:Date.now()})},Z=()=>{const j=document.querySelector("[data-typing-pattern]");if(j){const V=j.getAttribute("data-typing-pattern");if(V){const L=vt.helpWithTyping(V,e),X=vt.getUniversalAttemptNumber(),q=L.perfect;Ue.trackAITaskHelp(e,"typing",L.text,q,X),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"typing",suggestion:L.text,timestamp:Date.now(),wasCorrect:q,originalPattern:V})),window.dispatchEvent(new CustomEvent("aiTypingHelp",{detail:L})),p(vt.totalAIUsage),y(!0),A(ne=>[...ne,{sender:"bot",text:` Helping with engagement...
Typing: "${L.text.substring(0,30)}${L.text.length>30?"...":""}"`}])}}};N.useEffect(()=>{w.current&&w.current.scrollIntoView({behavior:"smooth"})},[I]);const ce=async()=>{if(!P.trim()||k)return;if(i>0&&points<i){A(L=>[...L,{id:Date.now(),text:`Not enough points! You need ${i} points to use AI help.`,sender:"system"}]);return}const j={id:Date.now(),text:P,sender:"user"};A(L=>[...L,j]),O(""),E(!0),M(0);const V=(globalConfig==null?void 0:globalConfig.aiDelay)||0;if(V>0){const X=V*1e3/100;let q=0;const ne=setInterval(()=>{q++;const oe=q/X*100;M(oe),q>=X&&(clearInterval(ne),U(j.text))},100)}else U(j.text)},U=async j=>{try{a&&a(i);const V=await vt.getHelp(currentTaskId,j,taskContext),L={id:Date.now()+1,text:V,sender:"ai"};A(X=>[...X,L])}catch(V){console.error("Error getting AI response:",V),A(L=>[...L,{id:Date.now()+1,text:"Sorry, I encountered an error. Please try again.",sender:"ai"}])}finally{E(!1),M(0)}},b=C();return u.jsxs("div",{className:"chat-container-sidebar",style:{height:"100%",display:"flex",flexDirection:"column"},children:[u.jsxs("div",{className:"chat-header",children:[u.jsx("h3",{children:l?"AI Teaching Assistant":"Chat Interface"}),u.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"2px"},children:l?"1 AI help per task (reliability varies)":"AI assistance disabled for this session"}),u.jsxs("div",{style:{marginTop:"10px",padding:"8px",background:"#e3f2fd",borderRadius:"6px",border:"1px solid #2196F3"},children:[u.jsxs("div",{style:{fontSize:"12px",color:"#1976d2",fontWeight:"bold"},children:["Student Learning: ",Math.round(s())," pts"]}),u.jsxs("div",{style:{fontSize:"10px",color:"#666",marginTop:"2px"},children:["Mat: ",(n==null?void 0:n.materials)||0,"  ",(1+((n==null?void 0:n.research)||0)*.15).toFixed(2),n!=null&&n.bonus?` ${n.bonus>=0?"+":"-"} ${Math.abs(n.bonus)} (Penalties)`:"","+ Interest"]})]})]}),u.jsx("div",{className:"messages-sidebar",children:u.jsxs("div",{className:"messages-list",children:[I.map(j=>u.jsx("div",{className:`message ${j.sender}`,children:u.jsx("div",{className:"message-content",children:j.text})},j.id)),k&&u.jsxs("div",{className:"message ai loading",children:[u.jsxs("div",{className:"typing-indicator",children:[u.jsx("span",{}),u.jsx("span",{}),u.jsx("span",{})]}),T>0&&u.jsx("div",{style:{width:"100%",height:"4px",background:"#eee",marginTop:"5px",borderRadius:"2px"},children:u.jsx("div",{style:{width:`${T}%`,height:"100%",background:"#2196F3",borderRadius:"2px",transition:"width 0.1s linear"}})})]}),u.jsx("div",{ref:w})]})}),u.jsxs("div",{className:"chat-input-sidebar",children:[u.jsx("input",{type:"text",placeholder:l?"Ask about strategy and tips here...":"Chat disabled - no AI available",value:P,onChange:j=>O(j.target.value),onKeyPress:j=>j.key==="Enter"&&ce(),disabled:!l}),u.jsx("button",{onClick:ce,disabled:!P.trim()||!l,children:"Send"})]}),l&&u.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f8f9fa"},children:[u.jsxs("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:["AI Usage: ",h," total attempts",m&&u.jsxs("span",{style:{color:"#ff9800",fontWeight:"bold"},children:[" ","| Current task: 1/1 used"]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"10px"},children:[u.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[u.jsxs("button",{onClick:()=>v(),disabled:!b||m,style:{padding:"12px",background:m?"#ff9800":b?"#2196F3":"#ccc",color:"white",border:"none",borderRadius:"8px",cursor:b&&!m?"pointer":"not-allowed",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[u.jsx("span",{style:{fontSize:"18px"},children:""}),m?"AI Used (1/1)":b?"Help Task":"Start task first"]}),u.jsxs("button",{onClick:ee,style:{padding:"12px",background:"#FF9800",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[u.jsx("span",{style:{fontSize:"18px"},children:""}),"Help Plan"]})]}),u.jsx("button",{onClick:()=>v("materials"),disabled:!e.startsWith("g2")||m,style:{padding:"10px",background:e.startsWith("g2")&&!m?"#4CAF50":m&&e.startsWith("g2")?"#ff9800":"#e0e0e0",color:e.startsWith("g2")||m?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g2")&&!m?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Materials"}),u.jsx("button",{onClick:()=>v("research"),disabled:!e.startsWith("g1")||m,style:{padding:"10px",background:e.startsWith("g1")&&!m?"#9C27B0":m&&e.startsWith("g1")?"#ff9800":"#e0e0e0",color:e.startsWith("g1")||m?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g1")&&!m?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Research"}),u.jsx("button",{onClick:()=>v("engagement"),disabled:!e.startsWith("g3")||m,style:{padding:"10px",background:e.startsWith("g3")&&!m?"#f44336":m&&e.startsWith("g3")?"#ff9800":"#e0e0e0",color:e.startsWith("g3")||m?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g3")&&!m?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Engage"})]}),u.jsx("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:b?u.jsx("span",{style:{color:"#4CAF50"},children:" AI ready to help"}):u.jsx("span",{style:{color:"#999"},children:" Navigate to a task to enable AI help"})})]}),!l&&u.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f5f5f5",textAlign:"center",color:"#666",fontSize:"14px"},children:[u.jsx("div",{style:{marginBottom:"5px"},children:" No AI Assistant"}),u.jsx("div",{style:{fontSize:"12px"},children:"Complete tasks using your own judgment"})]})]})}const ru={generateCode(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`${t}-${e}`.toUpperCase()},async createCode(t={}){return{success:!0,code:this.generateCode(),data:t}},async markCodeAsUsed(t,e){if(!t)return{success:!1,error:"No code provided"};try{const n={code:t,status:"used",usedAt:Vn(),sessionId:e,createdAt:Vn()};return await zd(Mt(nt,"accessCodes",t),n),{success:!0}}catch(n){return console.error("Error marking code as used:",n),{success:!1,error:n.message}}},async checkCodeUsage(t){if(!t)return{used:!1};try{const e=await Sf(Mt(nt,"accessCodes",t));if(e.exists()){const n=e.data();return{used:n.status==="used",sessionId:n.sessionId,usedAt:n.usedAt}}return{used:!1}}catch(e){return console.error("Error checking code usage:",e),{used:!1,error:e.message}}},getCodeFromURL(){const t=new URLSearchParams(window.location.search);return t.get("code")||t.get("c")||null},async verifyQualtricsCode(t){return{valid:!1,reason:"Qualtrics codes not yet supported"}}};function xI({onLoginSuccess:t}){const[e,n]=N.useState(""),[r,s]=N.useState(!1),[i,a]=N.useState(""),[l,c]=N.useState(!1),h={MASTER:{section:"ADMIN-MASTER",role:"master_admin",name:"Master Administrator",hasAI:!1,isMasterInterface:!0},ADMIN:{role:"admin",semesterDuration:72e4,name:"Admin User",hasAI:!0,checkpointSemester2:!0}},p=I=>({section:"TESTING-AI-CP",hasAI:!0,checkpointSemester2:!0,displayName:`${I} (Internal Tester - AI + Checkpoint)`}),m=I=>{if(h[I])return{valid:!0,type:"master",data:h[I]};const A=I.trim().replace(/[^a-zA-Z0-9\s\-_]/g,"");return A.length<2?{valid:!1,error:"Please enter a name with at least 2 characters"}:A.length>50?{valid:!1,error:"Name too long. Please use 50 characters or less"}:{valid:!0,type:"tester",condition:p(A),cleanName:A}},y=async I=>{if(I.preventDefault(),!e.trim()){a("Please enter your name");return}s(!0),a("");try{const A=m(e.trim());if(!A.valid){a(A.error||"Invalid Student ID"),s(!1);return}let P={timestamp:new Date().toISOString()};if(A.type==="master"){if(P={...P,studentIdentifier:e,role:A.data.role,semesterDuration:A.data.semesterDuration,displayName:A.data.name,section:A.data.isTestCode?"ADMIN-TEST":"ADMIN",hasAI:A.data.hasAI,checkpointSemester2:A.data.checkpointSemester2,isMasterCode:!0,isTestCode:A.data.isTestCode||!1,isMasterInterface:A.data.isMasterInterface||!1},A.data.isMasterInterface){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",displayName:A.data.name,section:"master_admin",hasAI:!0,checkpointSemester2:!0})),window.location.href=`${window.location.origin}?master=true`;return}}else if(A.type==="tester"){const k=A.condition,E=A.cleanName;P={...P,studentIdentifier:E,role:"tester",semesterDuration:72e4,displayName:k.displayName,section:k.section,hasAI:k.hasAI,checkpointSemester2:k.checkpointSemester2,isMasterCode:!1,isTestUser:!0}}const O=await ru.createCode(P);O.success?(sessionStorage.setItem("gameConfig",JSON.stringify({semesterDuration:P.semesterDuration,role:P.role,studentId:P.studentIdentifier,displayName:P.displayName,section:P.section,hasAI:P.hasAI,checkpointSemester2:P.checkpointSemester2})),window.location.href=`${window.location.origin}?code=${O.code}`):a("Failed to generate access code. Please try again.")}catch(A){console.error("Login error:",A),a("System error. Please try again.")}finally{s(!1)}};return u.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",padding:"20px"},children:[u.jsxs("div",{style:{background:"white",padding:"48px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",maxWidth:"480px",width:"100%"},children:[u.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[u.jsxs("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a202c",marginBottom:"8px",lineHeight:"1.2"},children:["Scheduling Challenge:",u.jsx("br",{}),"Can you beat Park?"]}),u.jsx("p",{style:{fontSize:"16px",color:"#718096",marginTop:"12px"},children:"Enter your name to access the game"})]}),u.jsxs("form",{onSubmit:y,children:[u.jsxs("div",{style:{marginBottom:"24px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#2d3748",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.025em"},children:"Your Name:"}),u.jsx("input",{type:"text",value:e,onChange:I=>n(I.target.value),disabled:r,style:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e2e8f0",borderRadius:"8px",boxSizing:"border-box",fontFamily:"'SF Mono', Monaco, 'Courier New', monospace",transition:"all 0.2s ease",background:"#f7fafc",outline:"none"},onFocus:I=>{I.target.style.borderColor="#2196F3",I.target.style.background="white",I.target.style.boxShadow="0 0 0 3px rgba(33, 150, 243, 0.1)"},onBlur:I=>{I.target.style.borderColor="#e2e8f0",I.target.style.background="#f7fafc",I.target.style.boxShadow="none"}}),u.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"#a0aec0",lineHeight:"1.4"},children:"Enter your first and last name (2-50 characters)"})]}),i&&u.jsxs("div",{style:{background:"#fed7d7",color:"#c53030",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",fontSize:"14px",display:"flex",alignItems:"center",border:"1px solid #fc8181"},children:[u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",style:{marginRight:"8px",flexShrink:0},children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i]}),u.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:"600",background:r?"#cbd5e0":"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:r?"none":"0 4px 6px rgba(33, 150, 243, 0.25)",transform:r?"none":"translateY(0)"},onMouseDown:I=>{r||(I.target.style.transform="translateY(2px)",I.target.style.boxShadow="0 2px 4px rgba(33, 150, 243, 0.25)")},onMouseUp:I=>{r||(I.target.style.transform="translateY(0)",I.target.style.boxShadow="0 4px 6px rgba(33, 150, 243, 0.25)")},onMouseOver:I=>{r||(I.target.style.background="#1976D2")},onMouseOut:I=>{r||(I.target.style.background="#2196F3")},children:r?u.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[u.jsxs("svg",{className:"animate-spin",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px",animation:"spin 1s linear infinite"},children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",strokeOpacity:"0.25"}),u.jsx("path",{d:"M4 12a8 8 0 018-8",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),"Verifying Name..."]}):"Access Game"})]}),u.jsxs("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[u.jsx("p",{style:{fontSize:"14px",color:"#718096",marginBottom:"12px"},children:"Having trouble? Contact your instructor:"}),u.jsxs("p",{style:{fontSize:"16px",color:"#2196F3",fontWeight:"500"},children:["Park Sinchaisri",u.jsx("br",{}),u.jsx("a",{href:"mailto:parksinchaisri@haas.berkeley.edu",style:{color:"#2196F3",textDecoration:"none",borderBottom:"1px solid #2196F3",fontSize:"15px"},children:"parksinchaisri@haas.berkeley.edu"})]}),l&&u.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#f7fafc",borderRadius:"8px",fontSize:"11px",color:"#4a5568",lineHeight:"1.8"},children:[u.jsx("strong",{children:"Test Codes:"}),u.jsxs("div",{style:{marginTop:"8px",fontFamily:"monospace"},children:[u.jsx("div",{children:"ADMIN (Standard Game Mode)"}),u.jsx("div",{children:"MASTER (Master interface)"})]})]})]})]}),u.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const tm={async checkDailyLimit(t){var r;if(!t)return{allowed:!0};const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);try{const s=wi(nt,"sessions"),i=tI(s,Kg("studentId","==",t),Kg("startTime",">=",n)),a=await Sl(i);if(!a.empty){const l=a.docs[0].data(),c=(r=l.startTime)!=null&&r.toDate?l.startTime.toDate():new Date(l.clientStartTime);return{allowed:!1,reason:"daily_limit",existingSession:l,nextAvailable:new Date(n.getTime()+24*60*60*1e3)}}return{allowed:!0}}catch(s){console.error("Error checking daily limit:",s);const i=`played_${t}_${n.toISOString().split("T")[0]}`;return localStorage.getItem(i)?{allowed:!1,reason:"daily_limit",nextAvailable:new Date(n.getTime()+24*60*60*1e3)}:{allowed:!0}}},async markDailyPlay(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=`played_${t}_${n.toISOString().split("T")[0]}`;localStorage.setItem(r,"true");const s=new Date(Date.now()-7*24*60*60*1e3);for(let i=0;i<localStorage.length;i++){const a=localStorage.key(i);if(a&&a.startsWith("played_")){const l=a.split("_")[2];l&&new Date(l)<s&&localStorage.removeItem(a)}}},async checkAccess(){try{const t=ru.getCodeFromURL();if(!t)return{allowed:!1,reason:"Please login with your student ID",requiresCode:!0};const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),n=e.role==="admin"||e.role==="master_admin";if(!n&&e.studentId){const r=await this.checkDailyLimit(e.studentId);if(!r.allowed&&!r.refreshGranted){const i=r.nextAvailable;return{allowed:!1,reason:`You have already completed today's session. Please come back in ${Math.ceil((i-Date.now())/(1e3*60*60))} hours (after midnight).`,dailyLimitReached:!0,nextAvailable:i}}if(sessionStorage.getItem("activeSessionId"))return{allowed:!1,reason:"Page refresh is not allowed during the game. Your session has been terminated.",refreshAttempt:!0}}return e.studentId?(n||await this.markDailyPlay(e.studentId),{allowed:!0,newSession:!0,code:t,codeData:{status:"new",metadata:e},isAdmin:n}):{allowed:!1,reason:"Please login with your Berkeley student ID",requiresCode:!0}}catch(t){console.error("Error in checkAccess:",t);const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");return e.role==="admin"?{allowed:!0,newSession:!0,code:ru.getCodeFromURL(),codeData:{status:"error_bypass",metadata:e},isAdmin:!0}:{allowed:!1,reason:"System error. Please try again.",requiresCode:!0}}},async createSession(t=null,e=null,n=!1){try{const r=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),s=r.role==="admin"||r.role==="master_admin",i={id:crypto.randomUUID(),accessCode:t,studentId:r.studentId||null,role:r.role||"student",semesterDuration:r.semesterDuration||72e4,displayName:r.displayName||"Student",startTime:Vn(),clientStartTime:new Date().toISOString(),status:"active",completedTasks:{},isPractice:n,isAdminSession:s,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`,section:r.section,hasAI:r.hasAI,checkpointSemester2:r.checkpointSemester2},l=(await Yv(wi(nt,"sessions"),i)).id;return localStorage.setItem("sessionId",l),sessionStorage.setItem("activeSessionId",l),s||(window.addEventListener("beforeunload",c=>{c.preventDefault(),c.returnValue="Your progress will be lost if you leave this page.",this.handleSessionAbandonment()}),document.addEventListener("visibilitychange",()=>{!s&&document.hidden})),l}catch(r){console.error("Error creating session:",r);const s=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(s.role==="admin"){const i="offline-"+Date.now();localStorage.setItem("sessionId",i),sessionStorage.setItem("activeSessionId",i);const a={id:i,accessCode:t,startTime:Date.now(),status:"active",isOffline:!0,studentId:s.studentId||null,role:s.role||"admin"};return localStorage.setItem("offlineSession",JSON.stringify(a)),i}throw r}},async handleSessionAbandonment(){const t=localStorage.getItem("sessionId");if(t&&!t.startsWith("offline-"))try{await lr(Mt(nt,"sessions",t),{status:"abandoned",abandonedAt:Vn(),abandonReason:"page_unload"})}catch(e){console.error("Error marking session as abandoned:",e)}sessionStorage.removeItem("activeSessionId"),sessionStorage.removeItem("gameConfig")}};function _I(){const[t,e]=N.useState(""),[n,r]=N.useState(!1),[s,i]=N.useState(""),[a,l]=N.useState(!1),c=async()=>{r(!0),i(""),l(!1);try{const p=await ru.createCode({createdBy:"admin",timestamp:new Date().toISOString()});p.success?e(p.code):i("Failed to generate code: "+p.error)}catch(p){i("Error: "+p.message)}finally{r(!1)}},h=()=>{const p=`${window.location.origin}?code=${t}`;navigator.clipboard.writeText(p),l(!0),setTimeout(()=>l(!1),2e3)};return u.jsxs("div",{style:{padding:"40px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, -apple-system, sans-serif"},children:[u.jsx("h1",{style:{color:"#333",marginBottom:"10px"},children:"Admin Dashboard"}),u.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:"Generate access codes for participants"}),u.jsxs("div",{style:{background:"#f8f9fa",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("button",{onClick:c,disabled:n,style:{padding:"12px 30px",fontSize:"16px",background:n?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:"bold"},children:n?"Generating...":"Generate New Access Code"}),t&&u.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"white",borderRadius:"6px",border:"1px solid #e0e0e0"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Generated Code"}),u.jsxs("div",{style:{marginBottom:"20px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Access Code:"}),u.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"18px",fontWeight:"bold"},children:t})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Full URL:"}),u.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"stretch"},children:[u.jsx("input",{type:"text",value:`${window.location.origin}?code=${t}`,readOnly:!0,style:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",background:"#f9f9f9"}}),u.jsx("button",{onClick:h,style:{padding:"10px 20px",background:a?"#4CAF50":"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:a?" Copied!":"Copy URL"})]})]}),u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"4px",fontSize:"14px",color:"#1976d2"},children:[u.jsx("strong",{children:"Note:"})," This code is valid for 24 hours and can only be used once."]})]}),s&&u.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"#ffebee",color:"#c62828",borderRadius:"4px"},children:s})]}),u.jsxs("div",{style:{marginTop:"40px",padding:"20px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666"},children:[u.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"How to use:"}),u.jsxs("ol",{style:{margin:"10px 0",paddingLeft:"20px"},children:[u.jsx("li",{children:"Generate a code using the button above"}),u.jsx("li",{children:"Copy the full URL"}),u.jsx("li",{children:"Share the URL with participants"}),u.jsx("li",{children:"Each participant can use their unique code once"})]})]})]})}function wI({sessionId:t,completedLevels:e,totalTime:n,gameMode:r}){const[s,i]=N.useState(""),[a,l]=N.useState(!1);N.useEffect(()=>{c()},[]);const c=()=>{const p=Date.now().toString(36).toUpperCase(),m=e.toString().padStart(2,"0"),y=r.limit==="time"?"T":"A",I=r.accuracy==="strict"?"S":"L",O=`GAME-${`${t}-${m}-${n}`.split("").reduce((k,E)=>k+E.charCodeAt(0),0).toString(36).toUpperCase().slice(-3)}-${m}-${y}${I}-${p}`;i(O)},h=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(s),l(!0),setTimeout(()=>l(!1),3e3);else{const p=document.createElement("textarea");p.value=s,p.style.position="fixed",p.style.top="0",p.style.left="0",p.style.width="2em",p.style.height="2em",p.style.padding="0",p.style.border="none",p.style.outline="none",p.style.boxShadow="none",p.style.background="transparent",p.style.opacity="0",document.body.appendChild(p),p.focus(),p.select();try{document.execCommand("copy")?(l(!0),setTimeout(()=>l(!1),3e3)):(console.error("Failed to copy using execCommand"),alert("Copy failed. Please manually select and copy the code."))}catch(m){console.error("Failed to copy:",m),alert("Copy failed. Please manually select and copy the code.")}document.body.removeChild(p)}}catch(p){console.error("Clipboard operation failed:",p),alert(`Copy failed. Here's your code to copy manually:

${s}`)}};return u.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"30px",marginTop:"30px",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},children:[u.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:" Your Completion Code"}),u.jsx("p",{style:{marginBottom:"20px",opacity:.9,fontSize:"16px"},children:"Copy this code and paste it into the Qualtrics survey to verify your completion:"}),u.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"20px",marginBottom:"20px",backdropFilter:"blur(10px)"},children:[u.jsx("div",{style:{fontFamily:"monospace",fontSize:"28px",fontWeight:"bold",letterSpacing:"2px",marginBottom:"15px",wordBreak:"break-all",textShadow:"2px 2px 4px rgba(0,0,0,0.2)",userSelect:"text",cursor:"text"},onClick:p=>{const m=window.getSelection(),y=document.createRange();y.selectNodeContents(p.currentTarget),m.removeAllRanges(),m.addRange(y)},title:"Click to select all text",children:s}),u.jsx("button",{onClick:h,style:{padding:"12px 30px",fontSize:"16px",fontWeight:"bold",background:a?"#4CAF50":"white",color:a?"white":"#764ba2",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:a?" Copied!":" Copy Code"})]}),u.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:"6px",padding:"15px",fontSize:"14px",lineHeight:"1.5"},children:[u.jsx("strong",{children:" Important:"})," This code is your proof of completion. Make sure to copy it before closing this window!",u.jsx("br",{}),u.jsx("span",{style:{fontSize:"13px",opacity:.9},children:" Tip: If the Copy button doesn't work, click on the code text to select it, then use Ctrl+C (or Cmd+C on Mac) to copy."})]}),u.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[u.jsx("summary",{style:{cursor:"pointer",opacity:.8,fontSize:"12px",marginBottom:"10px"},children:"Code Details "}),u.jsxs("div",{style:{fontSize:"12px",opacity:.7,background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",fontFamily:"monospace"},children:[u.jsxs("div",{children:["Levels Completed: ",e,"/45"]}),u.jsxs("div",{children:["Game Mode: ",r.limit==="time"?"Time Challenge":"Task Attempts"]}),u.jsxs("div",{children:["Accuracy Mode: ",r.accuracy==="strict"?"Strict (100%)":"Lenient"]}),u.jsxs("div",{children:["Total Time: ",Math.floor(n/60),"m ",n%60,"s"]}),u.jsxs("div",{children:["Generated: ",new Date().toLocaleString()]})]})]})]})}function SI({onClose:t}){const[e,n]=N.useState("config"),[r,s]=N.useState([]),[i,a]=N.useState(!0),[l,c]=N.useState(!1),[h,p]=N.useState(""),[m,y]=N.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,wrongAnswerPenalty:2,switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0,taskOrderStrategy:"sequential_task",difficultyMode:"fixed",scoring:{g1:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g2:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g3:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}}}}),[I,A]=N.useState(!1);N.useEffect(()=>{P(),M()},[]);const P=async()=>{try{const v=Mt(nt,"game_settings","global"),R=await Sf(v);R.exists()&&y({...m,...R.data()})}catch(v){console.error("Error loading game config:",v)}},O=async()=>{A(!0);try{const v=Mt(nt,"game_settings","global");await zd(v,m,{merge:!0}),alert("Configuration saved successfully!")}catch(v){console.error("Error saving config:",v),alert("Failed to save configuration")}finally{A(!1)}},k=(v,R)=>{y(_=>({..._,[v]:R}))},[E,T]=N.useState([]),M=async()=>{a(!0);try{const v=wi(nt,"students"),R=await Sl(v),_={};R.docs.forEach(j=>{_[j.id]={id:j.id,...j.data()}});const ee=wi(nt,"sessions"),Z=await Sl(ee),ce=Z.docs.map(j=>({id:j.id,...j.data()}));T(ce),console.log(`Debug: Found ${R.size} students and ${Z.size} sessions`);const U={};Z.docs.forEach(j=>{var q;const V=j.data(),L=V.studentId;if(!L)return;U[L]||(U[L]={totalAccesses:0,scores:[],hasPlayed:!1,lastPlayed:null,section:V.section||"Unknown",sid:L}),U[L].totalAccesses+=1,U[L].hasPlayed=!0;const X=(q=V.startTime)!=null&&q.toDate?V.startTime.toDate():new Date(V.clientStartTime||0);(!U[L].lastPlayed||X>U[L].lastPlayed)&&(U[L].lastPlayed=X),V.finalScore!==void 0&&U[L].scores.push({total:V.finalScore,learning:V.studentLearningScore,timestamp:V.completedAt})});const b=Object.values(_).map(j=>{const V=U[j.id]||{};return{...j,...V,scores:V.scores||j.scores||[],totalAccesses:V.totalAccesses||0,hasPlayed:V.hasPlayed||!1,lastPlayed:V.lastPlayed||null}});Object.keys(U).forEach(j=>{_[j]||b.push({id:j,sid:j,...U[j]})}),b.sort((j,V)=>{const L=j.lastPlayed?j.lastPlayed.getTime():0;return(V.lastPlayed?V.lastPlayed.getTime():0)-L}),s(b)}catch(v){console.error("Error fetching students:",v)}finally{a(!1)}},$=async()=>{if(window.confirm("Are you sure you want to reset ALL student data? This cannot be undone!")){c(!0);try{const v=wi(nt,"students"),R=await Sl(v);for(const _ of R.docs)await zd(Mt(nt,"students",_.id),{hasPlayed:!1,totalAccesses:0,scores:[]},{merge:!0});alert("All student data has been reset!"),await M()}catch(v){console.error("Error resetting data:",v),alert("Failed to reset data")}finally{c(!1)}}},B=()=>{const v=["Student ID","Section","Has Played","Last Played","Total Accesses","Highest Score"],R=r.filter(U=>{var b;return!((b=U.section)!=null&&b.includes("ADMIN"))}).map(U=>{const b=U.scores&&U.scores.length>0?Math.max(...U.scores.map(j=>j.total||0)):0;return[U.sid||U.id||"",U.section||"N/A",U.hasPlayed?"Yes":"No",U.lastPlayed?new Date(U.lastPlayed).toLocaleString():"-",U.totalAccesses||0,b]}),_=[v.join(","),...R.map(U=>U.map(b=>`"${String(b).replace(/"/g,'""')}"`).join(","))].join(`
`),ee=new Blob([_],{type:"text/csv;charset=utf-8;"}),Z=document.createElement("a"),ce=URL.createObjectURL(ee);Z.setAttribute("href",ce),Z.setAttribute("download",`student_data_${new Date().toISOString().split("T")[0]}.csv`),Z.style.visibility="hidden",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)},S=()=>{const v=["Session ID","Student ID","Section","Start Time","Status","Final Score","Student Learning Score","Completed Tasks","Random Seed"],R=E.map(U=>{var V;const b=(V=U.startTime)!=null&&V.toDate?U.startTime.toDate().toLocaleString():U.clientStartTime?new Date(U.clientStartTime).toLocaleString():"-",j=U.completedTasks?Object.keys(U.completedTasks).length:0;return[U.id||"",U.studentId||"",U.section||"N/A",b,U.status||"unknown",U.finalScore!==void 0?U.finalScore:"",U.studentLearningScore!==void 0?U.studentLearningScore:"",j,U.randomSeed||""]}),_=[v.join(","),...R.map(U=>U.map(b=>`"${String(b).replace(/"/g,'""')}"`).join(","))].join(`
`),ee=new Blob([_],{type:"text/csv;charset=utf-8;"}),Z=document.createElement("a"),ce=URL.createObjectURL(ee);Z.setAttribute("href",ce),Z.setAttribute("download",`sessions_data_${new Date().toISOString().split("T")[0]}.csv`),Z.style.visibility="hidden",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)},g=v=>({padding:"12px 24px",background:v?"#2196F3":"transparent",color:v?"white":"#666",border:"none",borderBottom:v?"3px solid #2196F3":"3px solid transparent",cursor:"pointer",fontSize:"14px",fontWeight:v?"600":"normal",transition:"all 0.2s"}),w=r.filter(v=>{var R;return!((R=v.section)!=null&&R.includes("ADMIN"))}).length,C=r.filter(v=>{var R;return!((R=v.section)!=null&&R.includes("ADMIN"))&&v.hasPlayed}).length;return u.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h1",{style:{margin:0,color:"#333"},children:" Master Admin Dashboard"}),u.jsx("button",{onClick:t,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:"Exit Admin"})]}),u.jsxs("div",{style:{display:"flex",borderBottom:"1px solid #e0e0e0",marginBottom:"30px"},children:[u.jsx("button",{onClick:()=>n("config"),style:g(e==="config"),children:" Game Configuration"}),u.jsx("button",{onClick:()=>n("scoring"),style:g(e==="scoring"),children:" Scoring Configuration"}),u.jsx("button",{onClick:()=>n("players"),style:g(e==="players"),children:" Player Data"}),u.jsx("button",{onClick:()=>n("advice"),style:g(e==="advice"),children:" Game Advice"})]}),e==="config"&&u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h2",{style:{margin:0,fontSize:"20px",color:"#333"},children:"Game Configuration"}),u.jsx("button",{onClick:O,disabled:I,style:{padding:"10px 24px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:I?"not-allowed":"pointer",fontWeight:"600",fontSize:"14px",opacity:I?.6:1},children:I?"Saving...":" Save Settings"})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"20px",marginBottom:"20px"},children:[u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Time & Semesters"}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Semester Duration (Minutes)"}),u.jsx("input",{type:"number",value:m.semesterDuration,onChange:v=>k("semesterDuration",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Semesters"}),u.jsx("input",{type:"number",value:m.totalSemesters,onChange:v=>k("totalSemesters",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("input",{type:"checkbox",checked:m.midtermEnabled,onChange:v=>k("midtermEnabled",v.target.checked),id:"midtermCheck"}),u.jsx("label",{htmlFor:"midtermCheck",style:{fontSize:"13px",cursor:"pointer"},children:"Enable Midterm Checkpoint"})]})]}),u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Task Settings"}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Tasks per Semester"}),u.jsx("input",{type:"number",value:m.totalTasks,onChange:v=>k("totalTasks",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),u.jsxs("div",{style:{marginBottom:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Difficulty Configuration"}),u.jsxs("select",{value:m.difficultyMode||"fixed",onChange:v=>k("difficultyMode",v.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[u.jsx("option",{value:"fixed",children:"Fixed (50% Easy, 30% Medium, 20% Hard)"}),u.jsx("option",{value:"manual",children:"Manual (User chooses difficulty)"})]})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Task Order Strategy"}),u.jsxs("select",{value:m.taskOrderStrategy,onChange:v=>k("taskOrderStrategy",v.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[u.jsx("option",{value:"sequential_task",children:"Order by Task (Materials  Research  Engagement)"}),u.jsx("option",{value:"sequential_difficulty",children:"Order by Difficulty (Easy  Medium  Hard)"})]})]}),u.jsxs("div",{style:{marginTop:"15px"},children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Game Mode"}),u.jsxs("select",{value:m.gameMode||"knapsack",onChange:v=>k("gameMode",v.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[u.jsx("option",{value:"knapsack",children:"Knapsack Mode (Allocate tasks upfront, limited tasks)"}),u.jsx("option",{value:"sequential",children:"Sequential Mode (Infinite levels, countdown timer)"})]}),u.jsx("p",{style:{fontSize:"11px",color:"#666",marginTop:"5px"},children:"Sequential mode: Timer counts down, infinite levels, can keep playing until time runs out."})]})]}),u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Penalties & Mechanics"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Switch Cost (Points)"}),u.jsx("input",{type:"number",value:m.switchCost||0,onChange:v=>k("switchCost",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Refill Freeze (Seconds)"}),u.jsx("input",{type:"number",value:m.jarRefillFreezeTime||0,onChange:v=>k("jarRefillFreezeTime",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Unfinished Jar Penalty (Pts)"}),u.jsx("input",{type:"number",value:m.unfinishedJarPenalty||0,onChange:v=>k("unfinishedJarPenalty",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"AI Delay (Seconds)"}),u.jsx("input",{type:"number",value:m.aiDelay||0,onChange:v=>k("aiDelay",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]})]})]})]}),e==="scoring"&&u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h2",{style:{margin:0,fontSize:"20px",color:"#333"},children:"Scoring Configuration"}),u.jsx("button",{onClick:O,disabled:I,style:{padding:"10px 24px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:I?"not-allowed":"pointer",fontWeight:"600",fontSize:"14px",opacity:I?.6:1},children:I?"Saving...":" Save Settings"})]}),u.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsx("p",{style:{fontSize:"13px",color:"#666",marginBottom:"20px"},children:'Configure points for each task type and difficulty level. "Full Correct" = perfect answer, "Half Correct" = partial credit.'}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px"},children:["g1","g2","g3"].map(v=>{const R={g1:"Research",g2:"Materials",g3:"Engagement"},_={g1:"",g2:"",g3:""},ee={g1:"#9C27B0",g2:"#4CAF50",g3:"#f44336"};return u.jsxs("div",{style:{background:"#f9f9f9",padding:"15px",borderRadius:"8px",border:`2px solid ${ee[v]}`},children:[u.jsxs("div",{style:{fontWeight:"bold",marginBottom:"12px",color:ee[v],display:"flex",alignItems:"center",gap:"6px",fontSize:"14px"},children:[u.jsx("span",{children:_[v]}),u.jsx("span",{children:R[v]})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:["easy","medium","hard"].map(Z=>{var U,b,j,V,L,X;const ce={easy:"E",medium:"M",hard:"H"};return u.jsxs("div",{style:{background:"white",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"},children:[u.jsx("div",{style:{fontSize:"10px",fontWeight:"600",marginBottom:"6px",color:"#666",textAlign:"center"},children:ce[Z]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",fontSize:"9px",marginBottom:"2px",color:"#666"},children:"Full"}),u.jsx("input",{type:"number",min:"0",value:((j=(b=(U=m.scoring)==null?void 0:U[v])==null?void 0:b[Z])==null?void 0:j.fullCorrect)??2,onChange:q=>{const ne=parseInt(q.target.value)||0;y(oe=>{var ve,ge,Ce;return{...oe,scoring:{...oe.scoring,[v]:{...(ve=oe.scoring)==null?void 0:ve[v],[Z]:{...(Ce=(ge=oe.scoring)==null?void 0:ge[v])==null?void 0:Ce[Z],fullCorrect:ne}}}}})},style:{width:"100%",padding:"4px",borderRadius:"3px",border:"1px solid #ddd",fontSize:"12px"}})]}),u.jsxs("div",{children:[u.jsx("label",{style:{display:"block",fontSize:"9px",marginBottom:"2px",color:"#666"},children:"Half"}),u.jsx("input",{type:"number",min:"0",value:((X=(L=(V=m.scoring)==null?void 0:V[v])==null?void 0:L[Z])==null?void 0:X.halfCorrect)??1,onChange:q=>{const ne=parseInt(q.target.value)||0;y(oe=>{var ve,ge,Ce;return{...oe,scoring:{...oe.scoring,[v]:{...(ve=oe.scoring)==null?void 0:ve[v],[Z]:{...(Ce=(ge=oe.scoring)==null?void 0:ge[v])==null?void 0:Ce[Z],halfCorrect:ne}}}}})},style:{width:"100%",padding:"4px",borderRadius:"3px",border:"1px solid #ddd",fontSize:"12px"}})]})]})]},Z)})})]},v)})})]})]}),e==="players"&&u.jsxs("div",{style:{background:"white",padding:"25px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[u.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Active Sessions"}),u.jsxs("div",{style:{display:"flex",gap:"10px"},children:[u.jsx("button",{onClick:B,style:{padding:"10px 20px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:" Download Student Data"}),u.jsx("button",{onClick:S,style:{padding:"10px 20px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:" Download Sessions Data"}),u.jsx("button",{onClick:$,disabled:l,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:l?"not-allowed":"pointer",fontWeight:"500",opacity:l?.6:1},children:l?"Processing...":" Reset All Data"})]})]}),u.jsx("div",{style:{marginBottom:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"6px"},children:u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",textAlign:"center"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:w}),u.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Total Students"})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:C}),u.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Have Played"})]}),u.jsxs("div",{children:[u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:w-C}),u.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Never Played"})]})]})}),i?u.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"Loading student data..."}):u.jsx("div",{style:{overflowX:"auto"},children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{background:"#f5f5f5",textAlign:"left"},children:[u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Student ID"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Section"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Has Played"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Last Played"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Total Accesses"}),u.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Highest Score"})]})}),u.jsx("tbody",{children:r.filter(v=>{var R;return!((R=v.section)!=null&&R.includes("ADMIN"))}).map(v=>u.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[u.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:v.sid||v.id}),u.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:v.section||"N/A"}),u.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:u.jsx("span",{style:{padding:"4px 12px",borderRadius:"12px",background:v.hasPlayed?"#e8f5e9":"#f5f5f5",color:v.hasPlayed?"#4CAF50":"#999",fontSize:"12px",fontWeight:"500"},children:v.hasPlayed?"Yes":"No"})}),u.jsx("td",{style:{padding:"12px",fontSize:"13px",color:"#666"},children:v.lastPlayed?new Date(v.lastPlayed).toLocaleString():"-"}),u.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600"},children:v.totalAccesses||0}),u.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600",color:"#2196F3"},children:v.scores&&v.scores.length>0?Math.max(...v.scores.map(R=>R.total||0)):0})]},v.id))})]})})]}),e==="advice"&&u.jsxs("div",{style:{background:"white",padding:"60px 40px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),u.jsx("h2",{style:{fontSize:"24px",color:"#666",marginBottom:"15px",fontWeight:"500"},children:"Game Advice Configuration"}),u.jsx("p",{style:{color:"#999",maxWidth:"600px",margin:"0 auto 30px",lineHeight:"1.6"},children:"Configure contextual advice prompts based on remaining time and tasks completed. This feature will allow you to define dynamic advice messages for different game states."}),u.jsxs("div",{style:{marginTop:"40px",padding:"30px",background:"#f9f9f9",borderRadius:"8px",maxWidth:"500px",margin:"40px auto 0",border:"2px dashed #ddd"},children:[u.jsx("p",{style:{color:"#666",fontSize:"15px",margin:0,fontWeight:"500"},children:"Coming Soon: Dynamic 2D Advice Matrix"}),u.jsx("p",{style:{color:"#999",fontSize:"13px",margin:"10px 0 0",lineHeight:"1.5"},children:"Define advice based on time remaining  tasks completed thresholds"})]})]})]})}const EI={notifyGameComplete(t={}){try{window.parent.postMessage({type:"gameComplete",status:"finished",timestamp:new Date().toISOString(),...t},"*");try{if(window.parent&&window.parent.document){const e=window.parent.document.querySelector("#NextButton");e&&(e.style.display="inline-block",e.style.visibility="visible",e.disabled=!1)}}catch{window.parent.postMessage({type:"showNextButton",action:"show"},"*")}console.log(" Game completion notification sent to Qualtrics")}catch(e){console.error("Failed to notify Qualtrics:",e)}},notifySemesterComplete(t,e,n={}){try{window.parent.postMessage({type:"semesterComplete",semester:t,totalSemesters:e,timestamp:new Date().toISOString(),...n},"*"),window.parent.postMessage({type:"keepNextButtonVisible",action:"maintain"},"*"),console.log(` Semester ${t} completion notification sent`)}catch(r){console.error("Failed to notify Qualtrics of semester completion:",r)}},ensureNextButtonVisible(){try{window.parent.postMessage({type:"ensureNextButton",action:"show",timestamp:new Date().toISOString()},"*")}catch(t){console.error("Failed to ensure Next button visibility:",t)}}};function TI({onStart:t,totalTasks:e=10,orderStrategy:n="sequential_task",durationMinutes:r=12,difficultyMode:s="fixed"}){const[i,a]=N.useState({g2:0,g1:0,g3:0}),[l,c]=N.useState({g2:{easy:0,medium:0,hard:0},g1:{easy:0,medium:0,hard:0},g3:{easy:0,medium:0,hard:0}}),[h,p]=N.useState([]),[m,y]=N.useState(0),[I,A]=N.useState(null),P=["It's generally smart to do roughly an even number of each task.","This is because the tasks that are worth more points take more time to do, so you don't want to only do the shorter tasks or only do the longer tasks.","Of course, you might prefer one task over another, so you could take that into account. Do you feel like you are particularly good at one of the tasks?"],O=()=>{m<P.length?(p(g=>[...g,{sender:"AI",text:P[m]}]),y(g=>g+1)):p(g=>[...g,{sender:"AI",text:"I've shared my best advice! It's up to you now."}])},k=(g,w)=>{const C=parseInt(w)||0;a(v=>({...v,[g]:Math.max(0,C)})),A(null)},E=(g,w,C)=>{const v=parseInt(C)||0;c(R=>({...R,[g]:{...R[g],[w]:Math.max(0,v)}})),A(null)},$=s==="manual"?(()=>{let g=0;return Object.values(l).forEach(w=>{g+=w.easy+w.medium+w.hard}),g})():Object.values(i).reduce((g,w)=>g+w,0),B=$===e,S=()=>{if($!==e){A(`Total tasks must equal ${e}. Currently: ${$}`);return}let g=[];s==="fixed"?["g2","g1","g3"].forEach(ee=>{const Z=i[ee];if(Z>0){const ce=Z*.5,U=Z*.3,b=Z*.2;let j=Math.floor(ce),V=Math.floor(U),L=Math.floor(b),X=Z-j-V-L;for(;X>0;){const ne=ce-j,oe=U-V,ve=b-L;ne>=oe&&ne>=ve?j++:oe>=ve?V++:L++,X--}const q=j+V+L;if(q!==Z){const ne=Z-q;ne>0?j+=ne:j=Math.max(0,j+ne)}for(let ne=0;ne<j;ne++)g.push({type:ee,difficulty:"easy"});for(let ne=0;ne<V;ne++)g.push({type:ee,difficulty:"medium"});for(let ne=0;ne<L;ne++)g.push({type:ee,difficulty:"hard"})}}):["g2","g1","g3"].forEach(ee=>{const{easy:Z,medium:ce,hard:U}=l[ee];for(let b=0;b<Z;b++)g.push({type:ee,difficulty:"easy"});for(let b=0;b<ce;b++)g.push({type:ee,difficulty:"medium"});for(let b=0;b<U;b++)g.push({type:ee,difficulty:"hard"})});const w={g2:{easy:1,medium:6,hard:11},g1:{easy:1,medium:6,hard:11},g3:{easy:1,medium:6,hard:11}},C=g.map(ee=>{const{type:Z,difficulty:ce}=ee,U=w[Z][ce]++;return{...ee,id:`${Z}t${U}`}});let v=[];if(n==="sequential_difficulty"){const ee={easy:1,medium:2,hard:3},Z={g2:1,g1:2,g3:3};v=C.sort((ce,U)=>ee[ce.difficulty]!==ee[U.difficulty]?ee[ce.difficulty]-ee[U.difficulty]:Z[ce.type]-Z[U.type])}else{const ee={g2:1,g1:2,g3:3},Z={easy:1,medium:2,hard:3};v=C.sort((ce,U)=>ee[ce.type]!==ee[U.type]?ee[ce.type]-ee[U.type]:Z[ce.difficulty]-Z[U.difficulty])}const R=v.map(ee=>ee.id),_=s==="fixed"?i:{g2:l.g2.easy+l.g2.medium+l.g2.hard,g1:l.g1.easy+l.g1.medium+l.g1.hard,g3:l.g3.easy+l.g3.medium+l.g3.hard};t(R,_)};return u.jsxs("div",{style:{maxWidth:"900px",margin:"40px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[u.jsx("h1",{style:{textAlign:"center",marginBottom:"30px",color:"#333"},children:"Task Allocation Strategy"}),u.jsxs("div",{style:{marginBottom:"30px",lineHeight:"1.6",color:"#555"},children:[u.jsxs("p",{children:["You have ",u.jsxs("strong",{children:[r," minutes"]})," to complete ",u.jsxs("strong",{children:[e," tasks"]}),"."]}),u.jsx("p",{children:"You must decide now how many of each task type you want to perform."}),u.jsxs("p",{children:["Total tasks must add up to ",u.jsx("strong",{children:e}),"."]}),s==="fixed"&&u.jsx("p",{style:{fontSize:"14px",fontStyle:"italic",color:"#666"},children:"* Within each task type, tasks are distributed as 50% Easy, 30% Medium, 20% Hard."})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"40px",marginBottom:"40px"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[s==="fixed"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:Ec,children:[u.jsxs("label",{style:Tc,children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 1: Slider (Materials)"]}),u.jsx("input",{type:"number",min:"0",max:e,value:i.g2,onChange:g=>k("g2",g.target.value),style:Ic})]}),u.jsxs("div",{style:Ec,children:[u.jsxs("label",{style:Tc,children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 2: Counting (Research)"]}),u.jsx("input",{type:"number",min:"0",max:e,value:i.g1,onChange:g=>k("g1",g.target.value),style:Ic})]}),u.jsxs("div",{style:Ec,children:[u.jsxs("label",{style:Tc,children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 3: Typing (Engagement)"]}),u.jsx("input",{type:"number",min:"0",max:e,value:i.g3,onChange:g=>k("g3",g.target.value),style:Ic})]})]}):u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px"},children:[u.jsx(ir,{icon:"",taskName:"Materials",difficulty:"Easy",value:l.g2.easy,onChange:g=>E("g2","easy",g),color:"#4CAF50"}),u.jsx(ir,{icon:"",taskName:"Materials",difficulty:"Medium",value:l.g2.medium,onChange:g=>E("g2","medium",g),color:"#4CAF50"}),u.jsx(ir,{icon:"",taskName:"Materials",difficulty:"Hard",value:l.g2.hard,onChange:g=>E("g2","hard",g),color:"#4CAF50"}),u.jsx(ir,{icon:"",taskName:"Research",difficulty:"Easy",value:l.g1.easy,onChange:g=>E("g1","easy",g),color:"#9C27B0"}),u.jsx(ir,{icon:"",taskName:"Research",difficulty:"Medium",value:l.g1.medium,onChange:g=>E("g1","medium",g),color:"#9C27B0"}),u.jsx(ir,{icon:"",taskName:"Research",difficulty:"Hard",value:l.g1.hard,onChange:g=>E("g1","hard",g),color:"#9C27B0"}),u.jsx(ir,{icon:"",taskName:"Engagement",difficulty:"Easy",value:l.g3.easy,onChange:g=>E("g3","easy",g),color:"#f44336"}),u.jsx(ir,{icon:"",taskName:"Engagement",difficulty:"Medium",value:l.g3.medium,onChange:g=>E("g3","medium",g),color:"#f44336"}),u.jsx(ir,{icon:"",taskName:"Engagement",difficulty:"Hard",value:l.g3.hard,onChange:g=>E("g3","hard",g),color:"#f44336"})]}),u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:B?"#e8f5e9":"#ffebee",borderRadius:"8px",textAlign:"center",fontWeight:"bold",color:B?"#2e7d32":"#c62828"},children:["Total Allocated: ",$," / ",e]}),I&&u.jsx("div",{style:{color:"red",textAlign:"center",fontSize:"14px"},children:I})]}),u.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"12px",padding:"20px",display:"flex",flexDirection:"column"},children:[u.jsxs("div",{style:{flex:1,marginBottom:"15px",overflowY:"auto",maxHeight:"300px",display:"flex",flexDirection:"column",gap:"10px"},children:[h.length===0&&u.jsx("div",{style:{color:"#999",fontStyle:"italic",textAlign:"center",marginTop:"40px"},children:"Need advice? Ask the AI helper."}),h.map((g,w)=>u.jsxs("div",{style:{background:"#f0f7ff",padding:"10px 15px",borderRadius:"12px 12px 12px 0",alignSelf:"flex-start",maxWidth:"90%"},children:[u.jsx("strong",{children:" AI:"})," ",g.text]},w))]}),u.jsxs("button",{onClick:O,style:{background:"#2196F3",color:"white",border:"none",padding:"12px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[u.jsx("span",{children:""})," Ask AI for Recommendation"]})]})]}),u.jsx("div",{style:{textAlign:"center"},children:u.jsx("button",{onClick:S,disabled:!B,style:{background:B?"#4CAF50":"#ccc",color:"white",border:"none",padding:"15px 40px",fontSize:"18px",borderRadius:"30px",cursor:B?"pointer":"not-allowed",fontWeight:"bold",boxShadow:B?"0 4px 15px rgba(76, 175, 80, 0.3)":"none",transition:"all 0.2s"},children:"Start Experiment"})})]})}const ir=({icon:t,taskName:e,difficulty:n,value:r,onChange:s,color:i})=>u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",background:"#f9f9f9",padding:"20px",borderRadius:"12px",border:`2px solid ${i}40`,transition:"all 0.2s"},children:[u.jsx("div",{style:{fontSize:"24px",marginBottom:"8px"},children:t}),u.jsx("div",{style:{fontSize:"14px",fontWeight:"bold",color:i,marginBottom:"4px",textAlign:"center"},children:e}),u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"12px",textAlign:"center"},children:n}),u.jsx("input",{type:"number",min:"0",max:100,value:r,onChange:a=>s(a.target.value),style:{width:"70px",padding:"12px",textAlign:"center",border:`2px solid ${i}`,borderRadius:"8px",fontSize:"18px",fontWeight:"bold",color:i,background:"white"}})]}),Ec={display:"flex",alignItems:"center",justifyContent:"space-between",background:"#f9f9f9",padding:"15px",borderRadius:"8px"},Tc={fontWeight:"bold",color:"#333",display:"flex",alignItems:"center"},Ic={width:"60px",padding:"10px",fontSize:"18px",textAlign:"center",borderRadius:"6px",border:"1px solid #ddd"};function II({currentTaskIndex:t,totalTasks:e,taskQueue:n,onSwitchTask:r,onRefill:s,children:i,points:a,timeRemaining:l,onTimeUp:c,penalties:h={switch:0,refill:0,unfinished:0},chatInterface:p,difficultyMode:m="fixed",categoryPoints:y={materials:0,research:0,engagement:0},globalConfig:I={}}){const A=n[t];(g=>g.startsWith("g1")?{name:"Research",icon:"",color:"#9C27B0",bg:"#f3e5f5"}:g.startsWith("g2")?{name:"Materials",icon:"",color:"#4CAF50",bg:"#e8f5e9"}:g.startsWith("g3")?{name:"Engagement",icon:"",color:"#f44336",bg:"#ffebee"}:{name:"Unknown",icon:"",color:"#333",bg:"#eee"})(A);const O=n.slice(0,t),k={g1:O.filter(g=>g.startsWith("g1")).length,g2:O.filter(g=>g.startsWith("g2")).length,g3:O.filter(g=>g.startsWith("g3")).length},E=e-t,T=n.slice(t),M=g=>{const w=parseInt(g.substring(3))||1;return w<=5?"easy":w<=10?"medium":"hard"};let $;m==="manual"?$={"g2-easy":T.filter(g=>g.startsWith("g2")&&M(g)==="easy"),"g2-medium":T.filter(g=>g.startsWith("g2")&&M(g)==="medium"),"g2-hard":T.filter(g=>g.startsWith("g2")&&M(g)==="hard"),"g1-easy":T.filter(g=>g.startsWith("g1")&&M(g)==="easy"),"g1-medium":T.filter(g=>g.startsWith("g1")&&M(g)==="medium"),"g1-hard":T.filter(g=>g.startsWith("g1")&&M(g)==="hard"),"g3-easy":T.filter(g=>g.startsWith("g3")&&M(g)==="easy"),"g3-medium":T.filter(g=>g.startsWith("g3")&&M(g)==="medium"),"g3-hard":T.filter(g=>g.startsWith("g3")&&M(g)==="hard")}:$={g2:T.filter(g=>g.startsWith("g2")),g1:T.filter(g=>g.startsWith("g1")),g3:T.filter(g=>g.startsWith("g3"))};const B=g=>{if(m==="manual"){const w=M(A);return A.startsWith(g.split("-")[0])&&w===g.split("-")[1]}else return A.startsWith(g)},S=(g,w,C,v,R,_,ee=null)=>{const Z=_.length,ce=B(g),U=Z>0,b=m==="manual"?g.split("-")[0]:g;return u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",background:R,borderRadius:"10px",padding:m==="manual"?"8px":"10px",border:`2px solid ${ce?v:"transparent"}`,height:m==="manual"?"auto":"100%",minHeight:m==="manual"?"120px":"auto",position:"relative"},children:[u.jsxs("div",{style:{fontSize:m==="manual"?"12px":"14px",fontWeight:"bold",color:v,marginBottom:m==="manual"?"6px":"10px",display:"flex",alignItems:"center",gap:"5px",justifyContent:"center"},children:[u.jsx("span",{children:C}),u.jsx("span",{children:Z})]}),u.jsx("div",{style:{flex:1,width:"100%",display:"flex",flexDirection:"column",gap:"5px",justifyContent:"flex-end",paddingBottom:"10px"},children:U?u.jsxs(u.Fragment,{children:[!ce&&_.length>0&&u.jsx("div",{style:{width:"90%",height:"25px",border:"2px dashed #999",borderRadius:"4px",margin:"0 auto 8px auto",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",color:"#666",background:"rgba(255, 255, 255, 0.5)",cursor:"pointer"},onClick:()=>r(b),title:"Click to switch to this task type",children:" Switch"}),_.map((j,V)=>{const L=V===0&&ce;return u.jsx("div",{style:{height:L?"35px":"8px",width:"80%",background:v,opacity:L?1:.4,borderRadius:"4px",margin:"0 auto",display:L?"flex":"block",alignItems:"center",justifyContent:"center",color:L?"white":"transparent",fontSize:"10px",fontWeight:"bold",cursor:L?"default":"pointer"},onClick:!ce&&V===0?()=>r(b):void 0,children:L?"Current":""},V)})]}):u.jsx("button",{onClick:()=>s&&s(b),style:{width:"100%",padding:"10px 5px",background:"white",border:"2px dashed #999",borderRadius:"8px",color:"#666",cursor:"pointer",fontSize:"12px"},children:" Refill"})}),u.jsxs("div",{style:{fontSize:m==="manual"?"11px":"12px",color:"#666",marginTop:m==="manual"?"4px":"5px",textAlign:"center"},children:[w,ee&&u.jsx("div",{style:{fontSize:"10px",color:"#999"},children:ee})]})]})};return u.jsxs("div",{style:{maxWidth:"95vw",margin:"0 auto",padding:"20px"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"white",padding:"15px 25px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[u.jsx("div",{style:{width:"200px"},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""}),u.jsx("div",{children:u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:l<60?"#f44336":"#333",animation:l<60?"pulse 1s infinite":"none"},children:[Math.floor(l/60),":",(l%60).toString().padStart(2,"0")]})})]})}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:"Total Points"}),u.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#2196F3"},children:a}),u.jsxs("div",{style:{marginTop:"10px",fontSize:"10px",color:"#666",textAlign:"left",background:"#f5f5f5",padding:"8px",borderRadius:"6px",maxWidth:"200px",margin:"10px auto 0"},children:[u.jsx("div",{style:{fontWeight:"600",marginBottom:"4px",color:"#333"},children:"Rules:"}),u.jsxs("div",{style:{fontSize:"9px",lineHeight:"1.4"},children:["Switch: -",(I==null?void 0:I.switchCost)||0," pts",u.jsx("br",{}),"Refill: -",(I==null?void 0:I.unfinishedJarPenalty)||0," pts",u.jsx("br",{}),"Unfinished: -",(I==null?void 0:I.unfinishedTaskPenalty)||0," pts"]}),u.jsx("div",{style:{fontWeight:"600",marginTop:"6px",marginBottom:"4px",color:"#333"},children:"Earnings:"}),u.jsxs("div",{style:{fontSize:"9px",lineHeight:"1.4"},children:["Materials: ",(y==null?void 0:y.materials)||0," pts",u.jsx("br",{}),"Research: ",(y==null?void 0:y.research)||0," pts",u.jsx("br",{}),"Engagement: ",(y==null?void 0:y.engagement)||0," pts",u.jsx("br",{}),(h.switch>0||h.refill>0||h.unfinished>0)&&u.jsxs("span",{style:{color:"#f44336"},children:["Penalties: -",h.switch+h.refill+h.unfinished," pts"]})]})]})]}),u.jsxs("div",{style:{textAlign:"right",minWidth:"300px"},children:[u.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"5px"},children:"Task Progress"}),u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"15px"},children:[u.jsxs("div",{style:{display:"flex",gap:"10px",fontSize:"16px",fontWeight:"500",color:"#555"},children:[u.jsxs("span",{title:"Materials Done",children:[" ",k.g2]}),u.jsx("span",{style:{color:"#ddd"},children:"|"}),u.jsxs("span",{title:"Research Done",children:[" ",k.g1]}),u.jsx("span",{style:{color:"#ddd"},children:"|"}),u.jsxs("span",{title:"Engagement Done",children:[" ",k.g3]})]}),u.jsxs("div",{style:{background:"#eee",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold",color:"#333"},children:["Remaining: ",E]})]})]})]}),u.jsxs("div",{className:"task-runner-layout",style:{display:"grid",gridTemplateColumns:"300px 1fr 340px",gap:"20px",height:"calc(100vh - 140px)",boxSizing:"border-box"},children:[u.jsxs("div",{style:{background:"white",padding:"15px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",height:"fit-content",maxHeight:"100%"},children:[u.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#666",textAlign:"center"},children:"Task Jars"}),m==="manual"?u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",flex:1},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#4CAF50",marginBottom:"4px"},children:"Materials"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:[S("g2-easy","Easy","","#4CAF50","#e8f5e9",$["g2-easy"],null),S("g2-medium","Medium","","#4CAF50","#e8f5e9",$["g2-medium"],null),S("g2-hard","Hard","","#4CAF50","#e8f5e9",$["g2-hard"],null)]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#9C27B0",marginBottom:"4px"},children:"Research"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:[S("g1-easy","Easy","","#9C27B0","#f3e5f5",$["g1-easy"],null),S("g1-medium","Medium","","#9C27B0","#f3e5f5",$["g1-medium"],null),S("g1-hard","Hard","","#9C27B0","#f3e5f5",$["g1-hard"],null)]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[u.jsx("div",{style:{fontSize:"12px",fontWeight:"600",color:"#f44336",marginBottom:"4px"},children:"Engagement"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:[S("g3-easy","Easy","","#f44336","#ffebee",$["g3-easy"],null),S("g3-medium","Medium","","#f44336","#ffebee",$["g3-medium"],null),S("g3-hard","Hard","","#f44336","#ffebee",$["g3-hard"],null)]})]})]}):u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px",flex:1},children:[S("g2","Materials","","#4CAF50","#e8f5e9",$.g2),S("g1","Research","","#9C27B0","#f3e5f5",$.g1),S("g3","Engagement","","#f44336","#ffebee",$.g3)]})]}),u.jsx("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",overflow:"hidden",display:"flex",flexDirection:"column"},children:i}),u.jsx("div",{style:{height:"100%",overflow:"hidden"},children:p&&u.jsx("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:p})})]}),u.jsx("style",{children:`
        @keyframes pulse {
          0% { opacity: 1; }
          50% { opacity: 0.5; }
          100% { opacity: 1; }
        }
      `})]})}function CI({timeRemaining:t,onSelectTask:e,onFinishEarly:n}){return u.jsxs("div",{style:{maxWidth:"800px",margin:"40px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[u.jsx("h1",{style:{color:"#2196F3",marginBottom:"20px"},children:" All Tasks Completed!"}),u.jsxs("div",{style:{fontSize:"18px",color:"#555",marginBottom:"30px",lineHeight:"1.6"},children:[u.jsx("p",{children:"You have finished all 10 allocated tasks with time to spare."}),u.jsxs("p",{children:["You currently have ",u.jsxs("strong",{children:[Math.floor(t/60)," minutes and ",t%60," seconds"]})," remaining."]}),u.jsxs("p",{children:["You can choose to do more tasks for ",u.jsx("strong",{children:"1/2 credit"})," to increase your score, or finish the experiment now."]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"40px"},children:[u.jsxs("button",{onClick:()=>e("g2"),style:Cc("#4CAF50"),children:[u.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Materials Task",u.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),u.jsxs("button",{onClick:()=>e("g1"),style:Cc("#9C27B0"),children:[u.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Research Task",u.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),u.jsxs("button",{onClick:()=>e("g3"),style:Cc("#f44336"),children:[u.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Engagement Task",u.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]})]}),u.jsx("div",{style:{borderTop:"1px solid #eee",paddingTop:"30px"},children:u.jsx("button",{onClick:n,style:{background:"#f5f5f5",color:"#666",border:"1px solid #ddd",padding:"12px 30px",fontSize:"16px",borderRadius:"30px",cursor:"pointer",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:r=>r.target.style.background="#e0e0e0",onMouseLeave:r=>r.target.style.background="#f5f5f5",children:"No thanks, I'm done"})})]})}const Cc=t=>({background:"white",border:`2px solid ${t}`,color:t,padding:"20px",borderRadius:"12px",cursor:"pointer",fontSize:"16px",fontWeight:"bold",transition:"all 0.2s",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"});function AI(t,e){const n=t.length,r=e.length,s=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let i=0;i<=n;i++)s[i][0]=i;for(let i=0;i<=r;i++)s[0][i]=i;for(let i=1;i<=n;i++)for(let a=1;a<=r;a++)t[i-1]===e[a-1]?s[i][a]=s[i-1][a-1]:s[i][a]=Math.min(s[i-1][a]+1,s[i][a-1]+1,s[i-1][a-1]+1);return s[n][r]}function kI(){const e=new URLSearchParams(window.location.search).get("admin")==="berkeley2024",[n,r]=N.useState("landing"),[s,i]=N.useState(null),[a,l]=N.useState(null),[c,h]=N.useState("g2t1"),[p,m]=N.useState({}),[y,I]=N.useState(0),[A,P]=N.useState(null),[O,k]=N.useState(!1),[E,T]=N.useState(""),[M,$]=N.useState(!0),[B,S]=N.useState(0),[g,w]=N.useState({}),[C,v]=N.useState(0),[R,_]=N.useState(0),[ee,Z]=N.useState(!1),[ce,U]=N.useState(null),[b,j]=N.useState(!1),[V,L]=N.useState(30),[X,q]=N.useState(!1),[ne,oe]=N.useState(5),[ve,ge]=N.useState(!1),[Ce,xe]=N.useState(0),[ae,Se]=N.useState(1),[_e]=N.useState(2),[Re,pt]=N.useState([]),[Ze,Ct]=N.useState(null),[$n,Ht]=N.useState(!1),[tn,qt]=N.useState(0),[Wn,ss]=N.useState({}),[is,tr]=N.useState({}),[zs,rt]=N.useState({}),[gt,Sr]=N.useState({}),[Er,os]=N.useState(null),[Qe,as]=N.useState({g2t1:!1,g1t1:!1,g3t1:!1}),[Ia,Hi]=N.useState(720),[nr,qi]=N.useState(720),[Bs,ls]=N.useState(0),[Te,En]=N.useState({materials:0,research:0,engagement:0,bonus:0}),[Tn,us]=N.useState({}),[Ca,In]=N.useState({}),[Mu,Tr]=N.useState({}),[Aa,Cn]=N.useState({switch:0,refill:0,unfinished:0}),[Ee,mt]=N.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,unfinishedTaskPenalty:0,taskOrderStrategy:"sequential_task",freezePenalty:0,contextAdviceEnabled:!0,difficultyMode:"fixed",switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0,gameMode:"knapsack",scoring:{g1:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g2:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}},g3:{easy:{fullCorrect:2,halfCorrect:1},medium:{fullCorrect:2,halfCorrect:1},hard:{fullCorrect:2,halfCorrect:1}}}});N.useEffect(()=>{(async()=>{try{const W=Mt(nt,"game_settings","global"),z=await Sf(W);if(z.exists()){const Q=z.data();if(mt(ie=>({...ie,...Q})),Q.semesterDuration){const ie=Q.semesterDuration*60;Hi(ie),qi(ie),Ra.current=ie,Hs.current=ie}}}catch(W){console.error("Error loading global config:",W)}})()},[]);const[hn,An]=N.useState([]),[fn,Gi]=N.useState(0),[Vu,Ir]=N.useState(null),[Tf,If]=N.useState(!1),[cs,Us]=N.useState([]),[$s,Cr]=N.useState(!1),[Gt,Qi]=N.useState(!0),[Ki,Yi]=N.useState(0),ds=N.useRef(Date.now()),Ar=N.useRef(null);N.useRef(null),N.useRef(null);const Ws=N.useRef(null),ka=N.useRef(Date.now()),Hs=N.useRef(720),Ra=N.useRef(720),rr=()=>{const K=(Ee.semesterDuration||12)*60*1e3,W=Math.floor(K/2e3);return Math.floor(W/60)};N.useEffect(()=>{(async()=>{try{const W=new URLSearchParams(window.location.search),z=W.has("code")||W.has("c");if((W.get("code")||W.get("c"))==="MASTER"){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",section:"master_admin",hasAI:!1,isMasterInterface:!0,displayName:"Master Administrator"})),$(!1);return}if(e&&!sessionStorage.getItem("gameConfig")&&sessionStorage.setItem("gameConfig",JSON.stringify({role:"admin",section:"admin",hasAI:!0,checkpointSemester2:!0,displayName:"Admin User"})),!z){r("studentLogin"),$(!1);return}const{allowed:ie,reason:ue,resumeSession:me,newSession:Ke,code:Lt,codeData:Ft}=await tm.checkAccess();if(!ie){k(!0),T(ue),$(!1);return}if(me)P(me),localStorage.setItem("sessionId",me);else if(Ke){const Ot=await tm.createSession(Lt,Ft);P(Ot)}await Ue.syncOfflineEvents(),$(!1)}catch{$(!1)}})()},[]),N.useEffect(()=>{n==="complete"&&ae>=_e&&EI.notifyGameComplete({finalScore:Math.round(pn())+(Te.bonus||0),totalTime:B,semestersCompleted:ae,sessionId:A})},[n,ae,_e,B,Te.bonus,A]),N.useEffect(()=>{localStorage.setItem("currentTask",c)},[c]),N.useEffect(()=>{localStorage.setItem("gameMode",JSON.stringify(s))},[s]),N.useEffect(()=>{localStorage.setItem("currentSemester",ae.toString())},[ae]),N.useEffect(()=>{localStorage.setItem("totalSemesters",_e.toString())},[_e]),N.useEffect(()=>{localStorage.setItem("completedTasksCount",Object.keys(p).length.toString())},[p]),N.useEffect(()=>{localStorage.setItem("completedLevels",y.toString())},[y]),N.useEffect(()=>{localStorage.setItem("totalSwitches",C.toString())},[C]),N.useEffect(()=>{localStorage.setItem("categoryPoints",JSON.stringify(Te))},[Te]);const pn=(K=Te,W=Tn)=>{let z=0;Object.entries(W).forEach(([Ke,Lt])=>{const Ot=1+parseInt(Ke)*.15;z+=Lt*Ot});const Q=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,ie=z+Q+(K.bonus||0),ue=K.materials||0,me=K.research||0;return console.log(` STUDENT LEARNING: ${ie.toFixed(1)} pts | Materials: ${ue} (with sequential multipliers) | Research: ${me} | Interest: ${Q.toFixed(1)} = ${ie.toFixed(1)}`),isNaN(ie)?0:ie};N.useEffect(()=>{const K=setInterval(()=>{Xi(z=>z+1);const W=pn();ls(W)},2e3);return()=>clearInterval(K)},[Te,Tn]);const[kr,Xi]=N.useState(0);if(N.useEffect(()=>{localStorage.setItem("studentLearningScore",Bs.toString())},[Bs]),N.useEffect(()=>{const K=Qe.g2t1&&Qe.g1t1&&Qe.g3t1;localStorage.setItem("practiceCompleted",K.toString())},[Qe]),M)return u.jsx("div",{className:"app",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:u.jsx("h2",{children:"Loading..."})});if(window.location.search.includes("master=true")&&JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="master_admin")return u.jsx(SI,{onClose:()=>{window.history.replaceState({},document.title,window.location.pathname),window.location.reload()}});if(window.location.search.includes("admin=true"))return u.jsx(_I,{});const Lu=()=>{if(!(ae===2&&Ee.midtermEnabled))return;Ht(!0),pn()>=300?(qt(300),En(Q=>({...Q,bonus:(Q.bonus||0)+300}))):qt(0),Z(!0),U("checkpoint")},hs=()=>{const K=(Ee.semesterDuration||12)*60*1e3,W=Math.floor(K/1e3);Hi(W),qi(W),ds.current=Date.now(),Ar.current=setInterval(()=>{const Q=Date.now()-ds.current,ie=Math.floor(Q/1e3);S(ie);const ue=Math.max(0,W-ie);if(qi(ue),ie%10===0&&A&&!A.startsWith("offline-")&&lr(Mt(nt,"sessions",A),{timeElapsed:ie,lastUpdated:Vn()}).catch(Ke=>console.error("Failed to update session time:",Ke)),ae===2&&Ee.midtermEnabled){const Ke=(Ee.semesterDuration||12)*60*1e3,Lt=Math.floor(Ke/2e3);ie===Lt&&!$n&&Lu()}ue<=0&&(clearInterval(Ar.current),Ar.current=null,Gs("semester_complete"))},1e3)},Ji=K=>{const z=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin",Q=Qe.g2t1&&Qe.g1t1&&Qe.g3t1;l(K),Ue.logEvent("practice_choice",{choice:K}),K==="no"?!z&&!Q?(kn("You must complete all three practice tasks first!"),r("practice")):Zi():r("practice")},Zi=()=>{if(Ze){if(Object.keys(Wn).length===0){Xe.initializeSeed(Ze);const W={},z={},Q={},ie={};for(let ue=1;ue<=100;ue++)W[ue]=Xe.generateSliderPattern(ue),z[ue]=Xe.generateCountingPattern(ue),Q[ue]=Xe.generateTypingPattern(ue),ie[ue]=Xe.getTextPassage(ue);ss(W),tr(z),rt(Q),Sr(ie)}}else{const W=Math.floor(Math.random()*1e6);Ct(W),Xe.initializeSeed(W);const z={},Q={},ie={},ue={};for(let me=1;me<=100;me++)z[me]=Xe.generateSliderPattern(me),Q[me]=Xe.generateCountingPattern(me),ie[me]=Xe.generateTypingPattern(me),ue[me]=Xe.getTextPassage(me);ss(z),tr(Q),rt(ie),Sr(ue),A&&!A.startsWith("offline-")&&lr(Mt(nt,"sessions",A),{randomSeed:W,[`semesterSeeds.semester${ae}`]:W})}localStorage.setItem("engagementInterest","0"),En({materials:0,research:0,engagement:0,bonus:0}),us({}),(Ee.gameMode||"knapsack")==="sequential"?(r("challenge"),h("g2t1"),m({}),I(0),v(0),_(0),Ht(!1),In({}),Tr({}),Cn({switch:0,refill:0,unfinished:0}),hs()):(r("allocation"),m({}),I(0),v(0),_(0),Ht(!1),In({}),Tr({}),Cn({switch:0,refill:0,unfinished:0}))},eo=(K,W)=>{An(K),Ir(W),Gi(0),r("challenge");const Q=`${K[0]}t1`;h(Q),w({[Q]:Date.now()}),Ue.setPageStartTime(Q),hs(),Ue.logEvent("allocation_complete",{counts:W,queue:K,timestamp:Date.now()})},to=K=>{const W=hn[fn].substring(0,2);if(W===K)return;const z=Ee.switchCost||0;z>0&&(En(Ve=>({...Ve,bonus:(Ve.bonus||0)-z})),Cn(Ve=>({...Ve,switch:Ve.switch+z})),kn(`Switching tasks cost ${z} points!`));const Q=[...hn],ie=Q.slice(fn),ue=Q.slice(0,fn),me=ie.filter(Ve=>Ve.startsWith(W)),Ke=ie.filter(Ve=>Ve.startsWith(K)),Lt=ie.filter(Ve=>!Ve.startsWith(W)&&!Ve.startsWith(K)),Ft=[...Ke,...Lt,...me],Ot=[...ue,...Ft];if(An(Ot),v(Ve=>Ve+1),Ke.length>0){const Ve=Ke[0];Hn(Ve).catch(Pn=>console.error("Error tracking switch:",Pn))}},qs=async(K,W)=>{var ba,gs;ka.current=Date.now();let z=0;const Q=K.startsWith("g1")?"research":K.startsWith("g2")?"materials":"engagement",ie=K.startsWith("g1")?"g1":K.startsWith("g2")?"g2":"g3",ue=parseInt(K.substring(3))||1,me=ue<=5?"easy":ue<=10?"medium":"hard",Ke=((gs=(ba=Ee.scoring)==null?void 0:ba[ie])==null?void 0:gs[me])||{fullCorrect:2,halfCorrect:1},Lt=Ke.fullCorrect||2,Ft=Ke.halfCorrect||1;let Ot=!1,Ve=!1;if(Q==="materials"){const de=parseFloat(W.userAnswer||W.userValue||0),Ne=parseFloat(W.correctAnswer||W.targetValue||0),Le=Math.abs(de-Ne);Ot=Le===0,Ve=Le>0&&Le<=1}else if(Q==="research"){const de=parseInt(W.userAnswer||0),Ne=parseInt(W.correctAnswer||0),Le=Math.abs(de-Ne);Ot=Le===0,Ve=Le>0&&Le<=1}else if(Q==="engagement"){const de=W.userAnswer||"",Ne=W.correctAnswer||"";de===Ne?Ot=!0:Ve=AI(de,Ne)===1}if(Ot?z=Lt:Ve?z=Ft:z=0,En(de=>{const Ne={...de,[Q]:de[Q]+z};return console.log(` Updated ${Q}: +${z} (total: ${Ne[Q]})`),Ne}),Q==="materials"&&z>0){const de=Te.research;us(Ne=>{const Le=Ne[de]||0;return{...Ne,[de]:Le+z}})}const nn=.0015*(Q==="engagement"?Te.engagement+z:Te.engagement),At={...Te,[Q]:Te[Q]+z};let Qs=Tn;if(Q==="materials"&&z>0){const de=Te.research,Ne=Tn[de]||0;Qs={...Tn,[de]:Ne+z}}let ro=0;Object.entries(Qs).forEach(([de,Ne])=>{const mn=1+parseInt(de)*.15;ro+=Ne*mn});const so=parseFloat(localStorage.getItem("engagementInterest")||"0")+nn*ro;localStorage.setItem("engagementInterest",so.toString()),Tr(de=>({...de,[K]:z})),In(de=>({...de,[K]:(de[K]||0)+1}));const Fu={...Te,[Q]:Te[Q]+z},io=pn(Fu,Qs);ls(io);let at="";if(Q==="materials"){const de=Math.abs((W.userValue||0)-(W.targetValue||0));de===0?at="Perfect materials!":de<=1?at=`Off by ${de.toFixed(2)}`:at=`Off by ${de.toFixed(2)}`}else if(Q==="research"){const de=Math.abs((W.userAnswer||0)-(W.correctAnswer||0));de===0?at="Perfect research!":de<=1?at=`Off by ${de}`:at=`Off by ${de}`}else Q==="engagement"&&(z===2?at="Perfect engagement!":z===1?at="One typo":at="Multiple errors");if(kn(`${at} | +${z} ${Q} pts`),m(de=>({...de,[K]:!0})),I(de=>de+1),_(de=>de+1),await Ue.trackTaskComplete(K,W.attempts,W.totalTime,W.accuracy||W.difference||0),await Ue.logEvent("task_complete",{taskId:K,...W,pointsEarned:z,categoryPoints:At,studentLearningScore:io,engagementInterest:so,completionContext:{totalTasksCompleted:Object.keys(p).length+1,currentGameTime:B,switchesBeforeCompletion:C,bonusPromptsEarned:R+1,timeRemaining:nr}}),A&&!A.startsWith("offline-")&&await lr(Mt(nt,"sessions",A),{[`completedTasks.${K}`]:!0,[`taskPoints.${K}`]:z,categoryPoints:At,studentLearningScore:io,engagementInterest:so,bonusPrompts:R+1,lastActivity:Vn()}),(Ee.gameMode||"knapsack")==="sequential"){const de=K.substring(0,2),Ne=parseInt(K.substring(3))||1;if(Ne<100){const Le=`${de}t${Ne+1}`;Hn(Le,!0)}else{const Le=["g2","g1","g3"],mn=Le.indexOf(de);if(mn<Le.length-1){const ms=`${Le[mn+1]}t1`;Hn(ms,!0)}else Hn("g2t1",!0)}}else{const de=fn+1;if(de<hn.length){Gi(de);const Ne=hn[de];let Le=Object.keys(p).filter(ms=>ms.startsWith(Ne)).length;Ne===K.substring(0,2)&&K.startsWith(Ne)&&(Le+=1);const mn=Le+1,Ks=`${Ne}t${mn}`;Hn(Ks,!0)}else Gs("all_tasks_done")}},Hn=async(K,W=!1)=>{if(ee)return;if(p[K]&&!W){kn("Task already completed! Choose a different task.");return}const z=c;if(h(K),w(Q=>({...Q,[K]:Date.now()})),Ue.setPageStartTime(K),ka.current=Date.now(),X&&(q(!1),oe(5),Ws.current&&(clearInterval(Ws.current),Ws.current=null)),z!==K&&!W&&v(Q=>Q+1),W||Ue.logEvent("manual_tab_switch",{from:z,to:K,reason:"user_clicked"}).catch(Q=>console.error("Error logging tab switch:",Q)),Ue.trackPageSwitch(z,K,W).catch(Q=>console.error("Error tracking page switch:",Q)),g[z]){const Q=Date.now()-g[z];Ue.logEvent("task_time",{taskId:z,timeSpent:Q,completed:p[z]||!1,leftForTask:K}).catch(ie=>console.error("Error logging task time:",ie))}},kn=K=>{const W=document.createElement("div");W.className="notification-enter",W.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",W.textContent=K,document.body.appendChild(W),setTimeout(()=>{W.className="notification-exit",setTimeout(()=>{document.body.contains(W)&&document.body.removeChild(W)},500)},3e3)},Gs=async(K="semester_complete")=>{Ar.current&&clearInterval(Ar.current);const W=Math.floor((Date.now()-ds.current-Ce)/1e3),z=pn(),Q=Te.bonus||0,ie=Math.max(0,Ee.totalTasks-Object.keys(p).length),ue=ie*(Ee.unfinishedTaskPenalty||0);ue>0&&Cn(Ke=>({...Ke,unfinished:ue}));const me=Math.round(z)+Q-ue;ue>0&&console.log(` Unfinished Penalty: -${ue} pts (${ie} tasks x ${Ee.unfinishedTaskPenalty})`),await Ue.logEvent("game_complete",{totalTime:W,totalSwitches:C,completedTasks:Object.keys(p).length,completedLevels:y,completionReason:K,gameMode:s,currentSemester:ae,categoryPoints:Te,studentLearningScore:z,totalBonus:Q,finalScore:me,finalContext:{practiceCompleted:a==="yes",totalPrompts:3+R,isAdminMode:e}}),A&&!A.startsWith("offline-")&&await lr(Mt(nt,"sessions",A),{status:"completed",completedAt:Vn(),finalTime:W,timeElapsed:W,totalSwitches:C,completionReason:K,currentSemester:ae,finalScore:me,studentLearningScore:z}),r("complete")},no=async K=>{const W={sender:"user",text:K,timestamp:Date.now()};Us(Q=>[...Q,W]),Cr(!0);const z={currentTask:c,timeRemaining:nr,score:Math.round(Bs),completedTasks:Object.keys(p).length,totalTasks:hn.length};try{const Q=(Ee.aiDelay||0)*1e3,ie=await vt.getAdvice(K,z);setTimeout(()=>{const ue={sender:"ai",text:ie,timestamp:Date.now()};Us(me=>[...me,ue]),Cr(!1),Gt||Yi(me=>me+1),Ee.aiCost>0&&(En(me=>({...me,bonus:(me.bonus||0)-Ee.aiCost})),kn(`AI Help Cost: -${Ee.aiCost} pts`))},Math.max(1e3,Q))}catch(Q){console.error("AI Error:",Q),Cr(!1),Us(ie=>[...ie,{sender:"ai",text:"I'm having trouble connecting right now. Please try again.",timestamp:Date.now()}])}},qn=(K,W)=>{if(W&&W.points&&W.points===2)as(z=>({...z,[K]:!0})),kn("Perfect! Practice task completed."),setTimeout(()=>{os(null)},1500);else{const z=(W==null?void 0:W.points)||0;kn(`Practice requires 100% accuracy. You scored ${z===1?"50%":"0%"}. Try again!`),setTimeout(()=>{os(null)},2e3)}},Pa=()=>{const K=c[1],W=parseInt(c.substring(3)),z=n==="practice";if(K==="1"){const ie=is[W],ue=gt[W];return u.jsx(Ud,{taskNum:W,onComplete:z?qn:qs,currentTaskId:c,isPractice:z,preGeneratedPattern:ie,preGeneratedText:ue})}if(K==="2"){const ie=Wn[W];return u.jsx($d,{taskNum:W,onComplete:z?qn:qs,currentTaskId:c,isPractice:z,preGeneratedPattern:ie})}const Q=zs[W];return u.jsx(Wd,{taskNum:W,onComplete:z?qn:qs,currentTaskId:c,isPractice:z,preGeneratedPattern:Q})};if(n==="studentLogin")return u.jsx(xI,{onLoginSuccess:K=>{window.location.href=`${window.location.origin}?code=${K}`}});if(O)return u.jsx("div",{className:"app",children:u.jsxs("div",{style:{maxWidth:"600px",margin:"50px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[u.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Access Denied"}),u.jsx("p",{style:{fontSize:"18px",marginBottom:"20px"},children:E}),u.jsx("div",{style:{padding:"15px",background:"#ffebee",borderRadius:"8px",border:"1px solid #f44336"},children:u.jsx("p",{style:{color:"#c62828",margin:0},children:"If you believe this is an error, please contact your instructor."})})]})});if(n==="semesterBreak"){const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),W=ae===2&&K.checkpointSemester2;return u.jsx("div",{className:"app",children:u.jsxs("div",{style:{maxWidth:"700px",margin:"50px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[u.jsxs("h1",{style:{color:"#2196F3",marginBottom:"30px"},children:[" Semester ",ae-1," Complete!"]}),u.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[u.jsx("h3",{style:{color:"#1976d2",marginBottom:"10px"},children:"Take a Break!"}),u.jsxs("p",{style:{fontSize:"16px",color:"#666",marginBottom:"0"},children:["Great job completing Semester ",ae-1,"! Take a moment to rest your eyes, stretch, or grab some water before continuing."]})]}),W&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",padding:"25px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #ff9800"},children:[u.jsx("h3",{style:{color:"#f57c00",marginBottom:"15px"},children:" Midterm Checkpoint Coming!"}),u.jsxs("div",{style:{fontSize:"16px",color:"#666",textAlign:"left"},children:[u.jsx("p",{style:{marginBottom:"10px"},children:u.jsxs("strong",{children:["Semester 2 includes a midterm exam at the"," ",rr(),"-minute mark!"]})}),u.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"10px"},children:[u.jsx("li",{children:"Your students will be tested at the midpoint"}),u.jsxs("li",{children:["If student learning  300 points:"," ",u.jsx("strong",{children:"+300 bonus points!"})]}),u.jsx("li",{children:"Build up your teaching effectiveness early to maximize the bonus"})]}),u.jsxs("p",{style:{background:"white",padding:"10px",borderRadius:"4px",textAlign:"center",fontWeight:"bold",color:"#f57c00"},children:["Goal: Reach 300+ Student Learning by minute"," ",rr()]})]})]}),Re.length>0&&u.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[u.jsx("h4",{style:{color:"#666",marginBottom:"10px"},children:"Your Performance So Far:"}),Re.map((z,Q)=>u.jsxs("div",{style:{marginBottom:"8px",fontSize:"16px"},children:["Semester ",Q+1,":"," ",u.jsxs("strong",{children:[z.finalScore," points"]})]},Q))]}),u.jsxs("div",{style:{marginTop:"30px"},children:[u.jsxs("button",{onClick:()=>{Se(Q=>Q+1),(Ee.gameMode||"knapsack")==="knapsack"?r("allocation"):(r("challenge"),hs()),m({}),An([]),Gi(0),ls(0),En({materials:0,research:0,engagement:0,bonus:0}),hs(),w({g2t1:Date.now()}),Ue.setPageStartTime("g2t1"),Ue.logEvent("semester_start",{semester:ae,timestamp:Date.now(),hasCheckpoint:W})},style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:z=>{z.currentTarget.style.transform="translateY(-2px)",z.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:z=>{z.currentTarget.style.transform="translateY(0)",z.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["I'm Ready - Start Semester ",ae]}),u.jsx("p",{style:{marginTop:"15px",fontSize:"14px",color:"#999"},children:"Click when you're ready to continue. The timer will start immediately."})]})]})})}if(n==="landing"){s||i({accuracy:"lenient",limit:"time"});const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),W=K.role==="admin",z=Ee.gameMode||"knapsack",Q=Ee.semesterDuration||12,ie=Ee.totalTasks||10;return u.jsx("div",{className:"app",children:u.jsx("div",{style:{maxWidth:"1000px",margin:"40px auto",padding:"0 20px"},children:u.jsxs("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",padding:"40px"},children:[u.jsxs("h1",{style:{color:"#333",marginBottom:"10px",fontSize:"32px",textAlign:"center",fontWeight:"600"},children:["Can you beat Park? - Semester ",ae,"/",_e]}),u.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%)",borderRadius:"12px",padding:"25px",marginBottom:"35px",border:"2px solid #2196F3",boxShadow:"0 2px 8px rgba(33, 150, 243, 0.2)"},children:[u.jsx("h2",{style:{color:"#1976d2",fontSize:"24px",marginBottom:"15px",textAlign:"center",fontWeight:"600"},children:" Game Overview"}),u.jsxs("p",{style:{fontSize:"18px",color:"#333",textAlign:"center",marginBottom:"12px",fontWeight:"500"},children:["You have"," ",u.jsxs("strong",{style:{color:"#1976d2"},children:[Q," minutes"]})," ","to do"," ",u.jsxs("strong",{style:{color:"#1976d2"},children:[ie," tasks"]}),", in what order?"]}),z==="sequential"?u.jsxs("p",{style:{fontSize:"16px",color:"#555",textAlign:"center",fontStyle:"italic",background:"white",padding:"12px",borderRadius:"8px",marginTop:"10px"},children:[" ",u.jsx("strong",{children:"Sequential Mode:"})," Do as much as you can - the timer counts down but levels are infinite!"]}):u.jsxs("p",{style:{fontSize:"16px",color:"#555",textAlign:"center",fontStyle:"italic",background:"white",padding:"12px",borderRadius:"8px",marginTop:"10px"},children:[" ",u.jsx("strong",{children:"Knapsack Mode:"})," You can choose how many of each task to do!"]})]}),u.jsxs("div",{className:"game-info",style:{textAlign:"left"},children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px",marginBottom:"20px"},children:[u.jsxs("div",{style:{background:"#ffebee",borderRadius:"10px",padding:"15px",border:"2px solid #f44336",boxShadow:"0 2px 6px rgba(244, 67, 54, 0.1)"},children:[u.jsxs("h3",{style:{color:"#f44336",fontSize:"16px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""})," Engagement"]}),u.jsx("p",{style:{fontSize:"13px",lineHeight:"1.5",color:"#555",margin:0},children:"Build interest that compounds! Each point adds 0.15% interest after every task completion."})]}),u.jsxs("div",{style:{background:"#f3e5f5",borderRadius:"10px",padding:"15px",border:"2px solid #9C27B0",boxShadow:"0 2px 6px rgba(156, 39, 176, 0.1)"},children:[u.jsxs("h3",{style:{color:"#9C27B0",fontSize:"16px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""})," Research"]}),u.jsx("p",{style:{fontSize:"13px",lineHeight:"1.5",color:"#555",margin:0},children:"Research amplifies your FUTURE materials! Each point adds +15% multiplier to materials earned after the research (order matters!)."})]}),u.jsxs("div",{style:{background:"#e8f5e9",borderRadius:"10px",padding:"15px",border:"2px solid #4CAF50",boxShadow:"0 2px 6px rgba(76, 175, 80, 0.1)"},children:[u.jsxs("h3",{style:{color:"#4CAF50",fontSize:"16px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""})," Materials"]}),u.jsx("p",{style:{fontSize:"13px",lineHeight:"1.5",color:"#555",margin:0},children:"Create teaching materials - each point directly contributes to your goal points!"})]})]}),u.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #f0f8ff 100%)",borderRadius:"12px",padding:"25px",marginBottom:"30px",border:"2px solid #2196F3",boxShadow:"0 2px 8px rgba(33, 150, 243, 0.15)"},children:[u.jsxs("h3",{style:{color:"#1976d2",fontSize:"18px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px",fontWeight:"600"},children:[u.jsx("span",{style:{fontSize:"22px"},children:""})," Student Learning Formula"]}),u.jsxs("div",{style:{background:"white",padding:"12px",borderRadius:"8px",fontFamily:"monospace",fontSize:"14px",textAlign:"center",marginBottom:"12px",border:"2px solid #2196F3",lineHeight:"1.6"},children:["Goal ="," ",u.jsx("strong",{style:{color:"#1976d2"},children:"Materials  (1 + Research0.15) + Engagement Interest"}),u.jsxs("div",{style:{fontSize:"11px",marginTop:"6px",fontFamily:"sans-serif",color:"#666"},children:["Research multipliers apply only to materials earned"," ",u.jsx("em",{children:"after"})," the research"]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px",fontSize:"12px"},children:[u.jsxs("div",{children:[u.jsx("strong",{children:"Scoring:"})," Exact = 2 pts | Within 1 = 1 pt | Otherwise = 0 pts"]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Timing:"})," Task completion order affects your final score"]})]}),ae===2&&u.jsxs("div",{style:{marginTop:"8px",fontSize:"12px",color:"#f57c00",fontWeight:"600"},children:["At minute ",rr(),": Exam checkpoint (300+ Student Learning = 300 bonus)"]})]}),K.hasAI&&u.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"1px solid #ffc107"},children:[u.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"AI Assistant Available:"}),u.jsxs("ul",{style:{color:"#856404",lineHeight:"1.6",margin:"0",paddingLeft:"20px",fontSize:"14px"},children:[u.jsx("li",{children:"Click the help buttons below each task for AI assistance"}),u.jsx("li",{children:"Unlimited use but reliability varies"}),u.jsx("li",{children:'Type "strategy" or "order" in chat for strategic advice!'})]})]}),ae===2&&u.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"2px solid #ffc107"},children:[u.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:" Semester 2: Midterm Checkpoint!"}),u.jsxs("p",{style:{color:"#856404",fontSize:"14px",margin:0},children:["At the ",rr(),"-minute mark, if you have 300+ student learning points, you'll earn a 300-point bonus!"]})]})]}),!W&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)",borderRadius:"12px",padding:"20px",marginTop:"20px",marginBottom:"20px",border:"2px solid #d32f2f",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"12px"},children:[u.jsx("span",{style:{fontSize:"24px"},children:""}),u.jsx("h3",{style:{color:"#b71c1c",margin:0,fontSize:"18px",fontWeight:"600"},children:"ONE ATTEMPT ONLY - NO RESTART"})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),u.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[u.jsx("strong",{children:"No refresh/close"})," - Session ends"]})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),u.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[u.jsx("strong",{children:"No tab switching"})," - 30s warning"]})]})]}),u.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"6px",textAlign:"center",fontSize:"14px",color:"#b71c1c",fontWeight:"600"},children:" Ensure 40 minutes uninterrupted before starting"})]}),u.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:u.jsxs("button",{onClick:()=>r("practiceChoice"),style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:ue=>{ue.currentTarget.style.transform="translateY(-2px)",ue.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:ue=>{ue.currentTarget.style.transform="translateY(0)",ue.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",ae]})}),e&&u.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#ffcccb",borderRadius:"6px",border:"2px solid #ff0000",fontWeight:"bold",color:"#d00"},children:["ADMIN MODE: ",Ia/60," minute timer, checkpoint at"," ",rr(),"minute"]}),Re.length>0&&u.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"6px",fontSize:"14px"},children:[u.jsx("strong",{children:"Previous Semesters:"}),Re.map((ue,me)=>u.jsxs("div",{style:{marginTop:"5px"},children:["Semester ",me+1,": ",ue.finalScore," points"]},me))]})]})})})}if(n==="practiceChoice"){const W=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";return u.jsx("div",{className:"app",children:u.jsx("div",{className:"landing-container",children:u.jsxs("div",{className:"landing-card",children:[u.jsx("h2",{style:{color:"#333",marginBottom:"20px"},children:W?"Practice Mode (Optional for Admin)":"Practice Mode (Required)"}),u.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:W?"As an admin, you can skip practice or try it first.":"You must complete all three practice tasks before starting the main game."}),u.jsx("p",{style:{color:"#888",fontSize:"14px",marginBottom:"30px",fontStyle:"italic"},children:"Practice lets you try each teaching task without time pressure."}),!W&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #1976d2",boxShadow:"0 4px 6px rgba(25, 118, 210, 0.1)"},children:[u.jsxs("h4",{style:{color:"#0d47a1",margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[u.jsx("span",{style:{fontSize:"20px"},children:""}),"Required Practice Tasks (100% accuracy needed):"]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Qe.g2t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Qe.g2t1?"#4CAF50":"#e0e0e0"}`},children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),u.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:u.jsx("strong",{children:"Materials"})}),Qe.g2t1?u.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):u.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Qe.g1t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Qe.g1t1?"#4CAF50":"#e0e0e0"}`},children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),u.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:u.jsx("strong",{children:"Research"})}),Qe.g1t1?u.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):u.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Qe.g3t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Qe.g3t1?"#4CAF50":"#e0e0e0"}`},children:[u.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),u.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:u.jsx("strong",{children:"Engagement"})}),Qe.g3t1?u.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):u.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]})]}),u.jsx("div",{style:{marginTop:"16px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"6px",fontSize:"13px",color:"#0d47a1",textAlign:"center",fontStyle:"italic"},children:" Each task must be completed perfectly to proceed"})]}),u.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[u.jsx("button",{onClick:()=>Ji("yes"),style:{padding:"15px 30px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:W?"Try Practice Mode":"Start Required Practice"}),W&&u.jsx("button",{onClick:()=>Ji("no"),style:{padding:"15px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:"Skip Practice (Admin)"})]})]})})})}if(n==="practice"){const W=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";if(!Er)return u.jsxs("div",{className:"app",children:[u.jsx("h1",{children:"Teaching Simulation - Practice Mode"}),u.jsx(yI,{practiceCompleted:Qe,onPracticeComplete:qn,onSelectPractice:os,onStartMainGame:()=>{const ie=Qe.g2t1&&Qe.g1t1&&Qe.g3t1;!W&&!ie?kn("You must complete all three practice tasks first!"):Zi()},isAdmin:W})]});const z=Er[1],Q=1;return u.jsx("div",{className:"app",children:u.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[u.jsx("button",{onClick:()=>os(null),style:{marginBottom:"20px",padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:" Back to Practice Menu"}),u.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[u.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),z==="1"&&u.jsx(Ud,{taskNum:Q,onComplete:qn,currentTaskId:Er,isPractice:!0}),z==="2"&&u.jsx($d,{taskNum:Q,onComplete:qn,currentTaskId:Er,isPractice:!0}),z==="3"&&u.jsx(Wd,{taskNum:Q,onComplete:qn,currentTaskId:Er,isPractice:!0})]})})}if(n==="complete"){const K=Math.floor(B/60),W=B%60,z=Math.round(pn()),Q=Te.bonus||0,ie=z+Q,ue={semester:ae,totalTime:B,completedLevels:y,categoryPoints:Te,switches:C,gameMode:s,randomSeed:Ze,studentLearningScore:z,finalScore:ie},me=async()=>{const Lt=[...Re,ue];pt(Lt),localStorage.setItem("engagementInterest","0"),En({materials:0,research:0,engagement:0,bonus:0}),us({}),A&&!A.startsWith("offline-")&&await lr(Mt(nt,"sessions",A),{[`semesterHistory.semester${ae}`]:ue,currentSemester:ae+1,lastActivity:Vn()}),Se(ae+1),vt.resetForNewSemester(),r("semesterBreak"),m({}),I(0),v(0),_(0),S(0),xe(0),h("g2t1"),Ht(!1);const Ft=Math.floor(Math.random()*1e6);Ct(Ft),Xe.initializeSeed(Ft);const Ot={},Ve={},Pn={},nn={};for(let At=1;At<=100;At++)Ot[At]=Xe.generateSliderPattern(At),Ve[At]=Xe.generateCountingPattern(At),Pn[At]=Xe.generateTypingPattern(At),nn[At]=Xe.getTextPassage(At);ss(Ot),tr(Ve),rt(Pn),Sr(nn)},Ke=ae>=_e;return u.jsxs("div",{className:"app",children:[u.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[u.jsx("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"8px",border:"2px solid #2196F3"},children:u.jsxs("h2",{style:{color:"#2196F3",margin:0},children:["Semester ",ae," of ",_e," Complete!"]})}),Ke&&u.jsx(wI,{sessionId:A,completedLevels:y,totalTime:B,gameMode:s}),u.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginTop:"20px"},children:[u.jsxs("h2",{style:{color:"#333",marginBottom:"20px"},children:[" Semester ",ae," Performance"]}),u.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2196F3",marginBottom:"30px"},children:["Final Score: ",ie," points"]}),u.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[u.jsxs("h3",{style:{margin:"0 0 15px 0",color:"#1976d2"},children:["Student Learning Score: ",z]}),u.jsxs("div",{style:{fontSize:"16px",color:"#666"},children:["= ",Te.materials||0," (Materials) "," ",(1+(Te.research||0)*.15).toFixed(2)," ","(Research)",parseFloat(localStorage.getItem("engagementInterest")||"0")>0&&` + ${parseFloat(localStorage.getItem("engagementInterest")||"0").toFixed(2)} (Interest)`]}),Q>0&&u.jsxs("div",{style:{marginTop:"10px",fontSize:"16px",color:"#1976d2"},children:["+ ",Q," Checkpoint Bonus"]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"30px"},children:[u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Total Time"}),u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[K,"m ",W,"s"]})]}),u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Student Learning"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:z})]})]}),(ae===2||Q>0)&&u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Checkpoint Bonus"}),u.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:["+",Q]})]}),u.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[u.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Tasks Completed"}),u.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:y})]})]}),u.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:"Teaching Performance by Category"}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"30px"},children:[u.jsxs("div",{style:{background:"#f0f8f0",padding:"15px",borderRadius:"6px",border:"2px solid #4CAF5020"},children:[u.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",marginBottom:"5px"},children:" Materials"}),u.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Te.materials||0}),u.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Base points"})]}),u.jsxs("div",{style:{background:"#f8f0ff",padding:"15px",borderRadius:"6px",border:"2px solid #9C27B020"},children:[u.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold",marginBottom:"5px"},children:" Research"}),u.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Te.research||0}),u.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(Te.research||0)*15,"% to future materials"]})]}),u.jsxs("div",{style:{background:"#fff0f0",padding:"15px",borderRadius:"6px",border:"2px solid #f4433620"},children:[u.jsx("div",{style:{color:"#f44336",fontWeight:"bold",marginBottom:"5px"},children:" Engagement"}),u.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Te.engagement||0}),u.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",((Te.engagement||0)*.15).toFixed(1),"% interest/task"]})]})]})]}),ae===2&&Te.bonus>0&&u.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[u.jsx("strong",{style:{color:"#856404"},children:" Exam Season Bonus: "}),u.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#856404"},children:["+",Te.bonus," points"]})]}),Re.length>0&&u.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[u.jsx("h4",{style:{color:"#666",marginBottom:"15px"},children:"Progress Over Semesters"}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px"},children:[...Re,ue].map((Lt,Ft)=>u.jsxs("div",{style:{padding:"10px",background:Ft===Re.length?"#e3f2fd":"white",borderRadius:"6px",border:"1px solid #e0e0e0",textAlign:"center"},children:[u.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Semester ",Ft+1]}),u.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:Lt.finalScore})]},Ft))})]}),u.jsx("div",{style:{marginTop:"30px",textAlign:"center"},children:Ke?u.jsxs("div",{style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px",textAlign:"center"},children:[u.jsx("h3",{style:{color:"#856404",marginBottom:"10px"},children:" All semesters complete!"}),u.jsx("p",{style:{color:"#856404",marginBottom:"0"},children:"Return to the Qualtrics survey and enter your completion code to finish the study."})]}):u.jsxs("button",{onClick:me,style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",ae+1," "]})})]})}const gn=Ee.gameMode||"knapsack";if(n==="allocation"&&gn==="knapsack")return u.jsx(TI,{onStart:eo,totalTasks:Ee.totalTasks,orderStrategy:Ee.taskOrderStrategy,durationMinutes:Ee.semesterDuration,difficultyMode:Ee.difficultyMode});if(n==="bonus_round"&&gn==="knapsack")return u.jsx(CI,{timeRemaining:nr,onSelectTask:K=>{const W=[...hn,K];An(W);const z=Object.keys(p).filter(ie=>ie.startsWith(K)).length,Q=`${K}t${z+1}`;r("challenge"),Hn(Q,!0)},onFinishEarly:()=>Gs("finished_early")});const Rn=K=>{const W=Ee.unfinishedJarPenalty||0;W>0&&(En(z=>({...z,bonus:(z.bonus||0)-W})),Cn(z=>({...z,refill:z.refill+W})),kn(`Refilling jar cost ${W} points!`)),Ee.jarRefillFreezeTime>0?(ge(!0),T(`Refilling ${K==="g1"?"Research":K==="g2"?"Materials":"Engagement"} Jar...`),setTimeout(()=>{ge(!1),T(""),fs(K,1)},Ee.jarRefillFreezeTime*1e3)):fs(K,1)},fs=(K,W)=>{const z=[];for(let Q=0;Q<W;Q++){const ie=Math.floor(Math.random()*20)+1;z.push(`${K}t${ie}`)}An(Q=>[...Q,...z])};if(n==="challenge"&&gn==="sequential")return u.jsxs("div",{className:"app",children:[u.jsx(mI,{current:c,completed:p,onSwitch:Hn,limitMode:"time",categoryPoints:Te,timeRemaining:nr}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 340px",gap:"20px",maxWidth:"1400px",margin:"0 auto",padding:"20px"},children:[u.jsx("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"},children:Pa()}),u.jsx("div",{style:{height:"fit-content"},children:u.jsx(em,{messages:cs,onSendMessage:no,isAiTyping:$s,isOpen:Gt,onToggle:()=>Qi(!Gt),unreadCount:Ki,aiDelay:Ee.aiDelay,currentTask:c,categoryPoints:Te})})]})]});if((n==="challenge"||n==="bonus_round")&&gn==="knapsack")return u.jsxs("div",{className:"app",children:[ve&&u.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"24px",flexDirection:"column",gap:"20px"},children:[u.jsx("div",{style:{fontSize:"48px"},children:""}),u.jsx("div",{children:E}),u.jsx("div",{style:{fontSize:"16px",opacity:.8},children:"Please wait..."})]}),u.jsx(II,{currentTaskIndex:fn,totalTasks:hn.length,taskQueue:hn,onSwitchTask:to,onRefill:Rn,allocationCounts:Vu,points:Math.round(Bs),timeRemaining:nr,onTimeUp:()=>Gs("time_up"),penalties:Aa,difficultyMode:Ee.difficultyMode,categoryPoints:Te,globalConfig:Ee,chatInterface:u.jsx(em,{messages:cs,onSendMessage:no,isAiTyping:$s,isOpen:Gt,onToggle:()=>Qi(!Gt),unreadCount:Ki,aiDelay:Ee.aiDelay,currentTask:hn[fn],categoryPoints:Te}),children:Pa()})]})}p0(document.getElementById("root")).render(u.jsx(N.StrictMode,{children:u.jsx(kI,{})}));
//# sourceMappingURL=index-CvoxdoTm.js.map
