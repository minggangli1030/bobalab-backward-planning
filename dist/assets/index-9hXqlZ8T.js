(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Om={exports:{}},bl={},Fm={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jo=Symbol.for("react.element"),Xv=Symbol.for("react.portal"),Jv=Symbol.for("react.fragment"),Zv=Symbol.for("react.strict_mode"),e_=Symbol.for("react.profiler"),t_=Symbol.for("react.provider"),n_=Symbol.for("react.context"),r_=Symbol.for("react.forward_ref"),s_=Symbol.for("react.suspense"),i_=Symbol.for("react.memo"),o_=Symbol.for("react.lazy"),Pf=Symbol.iterator;function a_(t){return t===null||typeof t!="object"?null:(t=Pf&&t[Pf]||t["@@iterator"],typeof t=="function"?t:null)}var zm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bm=Object.assign,Um={};function di(t,e,n){this.props=t,this.context=e,this.refs=Um,this.updater=n||zm}di.prototype.isReactComponent={};di.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};di.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function $m(){}$m.prototype=di.prototype;function vd(t,e,n){this.props=t,this.context=e,this.refs=Um,this.updater=n||zm}var _d=vd.prototype=new $m;_d.constructor=vd;Bm(_d,di.prototype);_d.isPureReactComponent=!0;var bf=Array.isArray,Wm=Object.prototype.hasOwnProperty,xd={current:null},Hm={key:!0,ref:!0,__self:!0,__source:!0};function qm(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)Wm.call(e,r)&&!Hm.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:jo,type:t,key:i,ref:a,props:s,_owner:xd.current}}function l_(t,e){return{$$typeof:jo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function wd(t){return typeof t=="object"&&t!==null&&t.$$typeof===jo}function u_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Df=/\/+/g;function _u(t,e){return typeof t=="object"&&t!==null&&t.key!=null?u_(""+t.key):e.toString(36)}function Na(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case jo:case Xv:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+_u(a,0):r,bf(s)?(n="",t!=null&&(n=t.replace(Df,"$&/")+"/"),Na(s,e,n,"",function(h){return h})):s!=null&&(wd(s)&&(s=l_(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Df,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",bf(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+_u(i,l);a+=Na(i,e,n,u,s)}else if(u=a_(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+_u(i,l++),a+=Na(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function ha(t,e,n){if(t==null)return t;var r=[],s=0;return Na(t,r,"","",function(i){return e.call(n,i,s++)}),r}function c_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var jt={current:null},Ma={transition:null},d_={ReactCurrentDispatcher:jt,ReactCurrentBatchConfig:Ma,ReactCurrentOwner:xd};function Gm(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:ha,forEach:function(t,e,n){ha(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ha(t,function(){e++}),e},toArray:function(t){return ha(t,function(e){return e})||[]},only:function(t){if(!wd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fe.Component=di;fe.Fragment=Jv;fe.Profiler=e_;fe.PureComponent=vd;fe.StrictMode=Zv;fe.Suspense=s_;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d_;fe.act=Gm;fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Bm({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=xd.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Wm.call(e,u)&&!Hm.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:jo,type:t.type,key:s,ref:i,props:r,_owner:a}};fe.createContext=function(t){return t={$$typeof:n_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:t_,_context:t},t.Consumer=t};fe.createElement=qm;fe.createFactory=function(t){var e=qm.bind(null,t);return e.type=t,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(t){return{$$typeof:r_,render:t}};fe.isValidElement=wd;fe.lazy=function(t){return{$$typeof:o_,_payload:{_status:-1,_result:t},_init:c_}};fe.memo=function(t,e){return{$$typeof:i_,type:t,compare:e===void 0?null:e}};fe.startTransition=function(t){var e=Ma.transition;Ma.transition={};try{t()}finally{Ma.transition=e}};fe.unstable_act=Gm;fe.useCallback=function(t,e){return jt.current.useCallback(t,e)};fe.useContext=function(t){return jt.current.useContext(t)};fe.useDebugValue=function(){};fe.useDeferredValue=function(t){return jt.current.useDeferredValue(t)};fe.useEffect=function(t,e){return jt.current.useEffect(t,e)};fe.useId=function(){return jt.current.useId()};fe.useImperativeHandle=function(t,e,n){return jt.current.useImperativeHandle(t,e,n)};fe.useInsertionEffect=function(t,e){return jt.current.useInsertionEffect(t,e)};fe.useLayoutEffect=function(t,e){return jt.current.useLayoutEffect(t,e)};fe.useMemo=function(t,e){return jt.current.useMemo(t,e)};fe.useReducer=function(t,e,n){return jt.current.useReducer(t,e,n)};fe.useRef=function(t){return jt.current.useRef(t)};fe.useState=function(t){return jt.current.useState(t)};fe.useSyncExternalStore=function(t,e,n){return jt.current.useSyncExternalStore(t,e,n)};fe.useTransition=function(){return jt.current.useTransition()};fe.version="18.3.1";Fm.exports=fe;var j=Fm.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h_=j,f_=Symbol.for("react.element"),p_=Symbol.for("react.fragment"),m_=Object.prototype.hasOwnProperty,g_=h_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y_={key:!0,ref:!0,__self:!0,__source:!0};function Qm(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)m_.call(e,r)&&!y_.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:f_,type:t,key:i,ref:a,props:s,_owner:g_.current}}bl.Fragment=p_;bl.jsx=Qm;bl.jsxs=Qm;Om.exports=bl;var d=Om.exports,Km={exports:{}},sn={},Ym={exports:{}},Xm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,z){var L=D.length;D.push(z);e:for(;0<L;){var W=L-1>>>1,J=D[W];if(0<s(J,z))D[W]=z,D[L]=J,L=W;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var z=D[0],L=D.pop();if(L!==z){D[0]=L;e:for(var W=0,J=D.length,ie=J>>>1;W<ie;){var Ae=2*(W+1)-1,we=D[Ae],he=Ae+1,de=D[he];if(0>s(we,L))he<J&&0>s(de,we)?(D[W]=de,D[he]=L,W=he):(D[W]=we,D[Ae]=L,W=Ae);else if(he<J&&0>s(de,L))D[W]=de,D[he]=L,W=he;else break e}}return z}function s(D,z){var L=D.sortIndex-z.sortIndex;return L!==0?L:D.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],h=[],p=1,g=null,m=3,I=!1,R=!1,P=!1,O=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(D){for(var z=n(h);z!==null;){if(z.callback===null)r(h);else if(z.startTime<=D)r(h),z.sortIndex=z.expirationTime,e(u,z);else break;z=n(h)}}function N(D){if(P=!1,C(D),!R)if(n(u)!==null)R=!0,Y(V);else{var z=n(h);z!==null&&B(N,z.startTime-D)}}function V(D,z){R=!1,P&&(P=!1,k(v),v=-1),I=!0;var L=m;try{for(C(z),g=n(u);g!==null&&(!(g.expirationTime>z)||D&&!_());){var W=g.callback;if(typeof W=="function"){g.callback=null,m=g.priorityLevel;var J=W(g.expirationTime<=z);z=t.unstable_now(),typeof J=="function"?g.callback=J:g===n(u)&&r(u),C(z)}else r(u);g=n(u)}if(g!==null)var ie=!0;else{var Ae=n(h);Ae!==null&&B(N,Ae.startTime-z),ie=!1}return ie}finally{g=null,m=L,I=!1}}var F=!1,w=null,v=-1,E=5,T=-1;function _(){return!(t.unstable_now()-T<E)}function S(){if(w!==null){var D=t.unstable_now();T=D;var z=!0;try{z=w(!0,D)}finally{z?x():(F=!1,w=null)}}else F=!1}var x;if(typeof A=="function")x=function(){A(S)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,ee=X.port2;X.port1.onmessage=S,x=function(){ee.postMessage(null)}}else x=function(){O(S,0)};function Y(D){w=D,F||(F=!0,x())}function B(D,z){v=O(function(){D(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){R||I||(R=!0,Y(V))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(D){switch(m){case 1:case 2:case 3:var z=3;break;default:z=m}var L=m;m=z;try{return D()}finally{m=L}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,z){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var L=m;m=D;try{return z()}finally{m=L}},t.unstable_scheduleCallback=function(D,z,L){var W=t.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?W+L:W):L=W,D){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=L+J,D={id:p++,callback:z,priorityLevel:D,startTime:L,expirationTime:J,sortIndex:-1},L>W?(D.sortIndex=L,e(h,D),n(u)===null&&D===n(h)&&(P?(k(v),v=-1):P=!0,B(N,L-W))):(D.sortIndex=J,e(u,D),R||I||(R=!0,Y(V))),D},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(D){var z=m;return function(){var L=m;m=z;try{return D.apply(this,arguments)}finally{m=L}}}})(Xm);Ym.exports=Xm;var v_=Ym.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var __=j,rn=v_;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jm=new Set,ao={};function ps(t,e){Xs(t,e),Xs(t+"Capture",e)}function Xs(t,e){for(ao[t]=e,t=0;t<e.length;t++)Jm.add(e[t])}var Jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ec=Object.prototype.hasOwnProperty,x_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Nf={},Mf={};function w_(t){return ec.call(Mf,t)?!0:ec.call(Nf,t)?!1:x_.test(t)?Mf[t]=!0:(Nf[t]=!0,!1)}function S_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function E_(t,e,n,r){if(e===null||typeof e>"u"||S_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Vt(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){yt[t]=new Vt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];yt[e]=new Vt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){yt[t]=new Vt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){yt[t]=new Vt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){yt[t]=new Vt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){yt[t]=new Vt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){yt[t]=new Vt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){yt[t]=new Vt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){yt[t]=new Vt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Sd=/[\-:]([a-z])/g;function Ed(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Sd,Ed);yt[e]=new Vt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Sd,Ed);yt[e]=new Vt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Sd,Ed);yt[e]=new Vt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){yt[t]=new Vt(t,1,!1,t.toLowerCase(),null,!1,!1)});yt.xlinkHref=new Vt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){yt[t]=new Vt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Td(t,e,n,r){var s=yt.hasOwnProperty(e)?yt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(E_(e,n,s,r)&&(n=null),r||s===null?w_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ir=__.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fa=Symbol.for("react.element"),Ds=Symbol.for("react.portal"),Ns=Symbol.for("react.fragment"),Id=Symbol.for("react.strict_mode"),tc=Symbol.for("react.profiler"),Zm=Symbol.for("react.provider"),eg=Symbol.for("react.context"),Ad=Symbol.for("react.forward_ref"),nc=Symbol.for("react.suspense"),rc=Symbol.for("react.suspense_list"),Cd=Symbol.for("react.memo"),fr=Symbol.for("react.lazy"),tg=Symbol.for("react.offscreen"),jf=Symbol.iterator;function Pi(t){return t===null||typeof t!="object"?null:(t=jf&&t[jf]||t["@@iterator"],typeof t=="function"?t:null)}var $e=Object.assign,xu;function Fi(t){if(xu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);xu=e&&e[1]||""}return`
`+xu+t}var wu=!1;function Su(t,e){if(!t||wu)return"";wu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{wu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fi(t):""}function T_(t){switch(t.tag){case 5:return Fi(t.type);case 16:return Fi("Lazy");case 13:return Fi("Suspense");case 19:return Fi("SuspenseList");case 0:case 2:case 15:return t=Su(t.type,!1),t;case 11:return t=Su(t.type.render,!1),t;case 1:return t=Su(t.type,!0),t;default:return""}}function sc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ns:return"Fragment";case Ds:return"Portal";case tc:return"Profiler";case Id:return"StrictMode";case nc:return"Suspense";case rc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case eg:return(t.displayName||"Context")+".Consumer";case Zm:return(t._context.displayName||"Context")+".Provider";case Ad:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Cd:return e=t.displayName||null,e!==null?e:sc(t.type)||"Memo";case fr:e=t._payload,t=t._init;try{return sc(t(e))}catch{}}return null}function I_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sc(e);case 8:return e===Id?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Dr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ng(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function A_(t){var e=ng(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function pa(t){t._valueTracker||(t._valueTracker=A_(t))}function rg(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=ng(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ya(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ic(t,e){var n=e.checked;return $e({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Vf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Dr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function sg(t,e){e=e.checked,e!=null&&Td(t,"checked",e,!1)}function oc(t,e){sg(t,e);var n=Dr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ac(t,e.type,n):e.hasOwnProperty("defaultValue")&&ac(t,e.type,Dr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Lf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ac(t,e,n){(e!=="number"||Ya(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var zi=Array.isArray;function Ws(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Dr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function lc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return $e({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Of(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if(zi(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Dr(n)}}function ig(t,e){var n=Dr(e.value),r=Dr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ff(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function og(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function uc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?og(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ma,ag=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ma=ma||document.createElement("div"),ma.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ma.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function lo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Qi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},C_=["Webkit","ms","Moz","O"];Object.keys(Qi).forEach(function(t){C_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Qi[e]=Qi[t]})});function lg(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Qi.hasOwnProperty(t)&&Qi[t]?(""+e).trim():e+"px"}function ug(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=lg(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var k_=$e({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cc(t,e){if(e){if(k_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function dc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hc=null;function kd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fc=null,Hs=null,qs=null;function zf(t){if(t=Oo(t)){if(typeof fc!="function")throw Error(H(280));var e=t.stateNode;e&&(e=Vl(e),fc(t.stateNode,t.type,e))}}function cg(t){Hs?qs?qs.push(t):qs=[t]:Hs=t}function dg(){if(Hs){var t=Hs,e=qs;if(qs=Hs=null,zf(t),e)for(t=0;t<e.length;t++)zf(e[t])}}function hg(t,e){return t(e)}function fg(){}var Eu=!1;function pg(t,e,n){if(Eu)return t(e,n);Eu=!0;try{return hg(t,e,n)}finally{Eu=!1,(Hs!==null||qs!==null)&&(fg(),dg())}}function uo(t,e){var n=t.stateNode;if(n===null)return null;var r=Vl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var pc=!1;if(Jn)try{var bi={};Object.defineProperty(bi,"passive",{get:function(){pc=!0}}),window.addEventListener("test",bi,bi),window.removeEventListener("test",bi,bi)}catch{pc=!1}function R_(t,e,n,r,s,i,a,l,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var Ki=!1,Xa=null,Ja=!1,mc=null,P_={onError:function(t){Ki=!0,Xa=t}};function b_(t,e,n,r,s,i,a,l,u){Ki=!1,Xa=null,R_.apply(P_,arguments)}function D_(t,e,n,r,s,i,a,l,u){if(b_.apply(this,arguments),Ki){if(Ki){var h=Xa;Ki=!1,Xa=null}else throw Error(H(198));Ja||(Ja=!0,mc=h)}}function ms(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function mg(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Bf(t){if(ms(t)!==t)throw Error(H(188))}function N_(t){var e=t.alternate;if(!e){if(e=ms(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Bf(s),t;if(i===r)return Bf(s),e;i=i.sibling}throw Error(H(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function gg(t){return t=N_(t),t!==null?yg(t):null}function yg(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=yg(t);if(e!==null)return e;t=t.sibling}return null}var vg=rn.unstable_scheduleCallback,Uf=rn.unstable_cancelCallback,M_=rn.unstable_shouldYield,j_=rn.unstable_requestPaint,Qe=rn.unstable_now,V_=rn.unstable_getCurrentPriorityLevel,Rd=rn.unstable_ImmediatePriority,_g=rn.unstable_UserBlockingPriority,Za=rn.unstable_NormalPriority,L_=rn.unstable_LowPriority,xg=rn.unstable_IdlePriority,Dl=null,Nn=null;function O_(t){if(Nn&&typeof Nn.onCommitFiberRoot=="function")try{Nn.onCommitFiberRoot(Dl,t,void 0,(t.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:B_,F_=Math.log,z_=Math.LN2;function B_(t){return t>>>=0,t===0?32:31-(F_(t)/z_|0)|0}var ga=64,ya=4194304;function Bi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function el(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Bi(l):(i&=a,i!==0&&(r=Bi(i)))}else a=n&~s,a!==0?r=Bi(a):i!==0&&(r=Bi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-wn(e),s=1<<n,r|=t[n],e&=~s;return r}function U_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $_(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-wn(i),l=1<<a,u=s[a];u===-1?(!(l&n)||l&r)&&(s[a]=U_(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function gc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function wg(){var t=ga;return ga<<=1,!(ga&4194240)&&(ga=64),t}function Tu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-wn(e),t[e]=n}function W_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-wn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Pd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-wn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ee=0;function Sg(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Eg,bd,Tg,Ig,Ag,yc=!1,va=[],xr=null,wr=null,Sr=null,co=new Map,ho=new Map,mr=[],H_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $f(t,e){switch(t){case"focusin":case"focusout":xr=null;break;case"dragenter":case"dragleave":wr=null;break;case"mouseover":case"mouseout":Sr=null;break;case"pointerover":case"pointerout":co.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ho.delete(e.pointerId)}}function Di(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Oo(e),e!==null&&bd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function q_(t,e,n,r,s){switch(e){case"focusin":return xr=Di(xr,t,e,n,r,s),!0;case"dragenter":return wr=Di(wr,t,e,n,r,s),!0;case"mouseover":return Sr=Di(Sr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return co.set(i,Di(co.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,ho.set(i,Di(ho.get(i)||null,t,e,n,r,s)),!0}return!1}function Cg(t){var e=Zr(t.target);if(e!==null){var n=ms(e);if(n!==null){if(e=n.tag,e===13){if(e=mg(n),e!==null){t.blockedOn=e,Ag(t.priority,function(){Tg(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ja(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=vc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);hc=r,n.target.dispatchEvent(r),hc=null}else return e=Oo(n),e!==null&&bd(e),t.blockedOn=n,!1;e.shift()}return!0}function Wf(t,e,n){ja(t)&&n.delete(e)}function G_(){yc=!1,xr!==null&&ja(xr)&&(xr=null),wr!==null&&ja(wr)&&(wr=null),Sr!==null&&ja(Sr)&&(Sr=null),co.forEach(Wf),ho.forEach(Wf)}function Ni(t,e){t.blockedOn===e&&(t.blockedOn=null,yc||(yc=!0,rn.unstable_scheduleCallback(rn.unstable_NormalPriority,G_)))}function fo(t){function e(s){return Ni(s,t)}if(0<va.length){Ni(va[0],t);for(var n=1;n<va.length;n++){var r=va[n];r.blockedOn===t&&(r.blockedOn=null)}}for(xr!==null&&Ni(xr,t),wr!==null&&Ni(wr,t),Sr!==null&&Ni(Sr,t),co.forEach(e),ho.forEach(e),n=0;n<mr.length;n++)r=mr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<mr.length&&(n=mr[0],n.blockedOn===null);)Cg(n),n.blockedOn===null&&mr.shift()}var Gs=ir.ReactCurrentBatchConfig,tl=!0;function Q_(t,e,n,r){var s=Ee,i=Gs.transition;Gs.transition=null;try{Ee=1,Dd(t,e,n,r)}finally{Ee=s,Gs.transition=i}}function K_(t,e,n,r){var s=Ee,i=Gs.transition;Gs.transition=null;try{Ee=4,Dd(t,e,n,r)}finally{Ee=s,Gs.transition=i}}function Dd(t,e,n,r){if(tl){var s=vc(t,e,n,r);if(s===null)Mu(t,e,r,nl,n),$f(t,r);else if(q_(s,t,e,n,r))r.stopPropagation();else if($f(t,r),e&4&&-1<H_.indexOf(t)){for(;s!==null;){var i=Oo(s);if(i!==null&&Eg(i),i=vc(t,e,n,r),i===null&&Mu(t,e,r,nl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Mu(t,e,r,null,n)}}var nl=null;function vc(t,e,n,r){if(nl=null,t=kd(r),t=Zr(t),t!==null)if(e=ms(t),e===null)t=null;else if(n=e.tag,n===13){if(t=mg(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return nl=t,null}function kg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(V_()){case Rd:return 1;case _g:return 4;case Za:case L_:return 16;case xg:return 536870912;default:return 16}default:return 16}}var yr=null,Nd=null,Va=null;function Rg(){if(Va)return Va;var t,e=Nd,n=e.length,r,s="value"in yr?yr.value:yr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Va=s.slice(t,1<r?1-r:void 0)}function La(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function _a(){return!0}function Hf(){return!1}function on(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?_a:Hf,this.isPropagationStopped=Hf,this}return $e(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_a)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_a)},persist:function(){},isPersistent:_a}),e}var hi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Md=on(hi),Lo=$e({},hi,{view:0,detail:0}),Y_=on(Lo),Iu,Au,Mi,Nl=$e({},Lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Mi&&(Mi&&t.type==="mousemove"?(Iu=t.screenX-Mi.screenX,Au=t.screenY-Mi.screenY):Au=Iu=0,Mi=t),Iu)},movementY:function(t){return"movementY"in t?t.movementY:Au}}),qf=on(Nl),X_=$e({},Nl,{dataTransfer:0}),J_=on(X_),Z_=$e({},Lo,{relatedTarget:0}),Cu=on(Z_),ex=$e({},hi,{animationName:0,elapsedTime:0,pseudoElement:0}),tx=on(ex),nx=$e({},hi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),rx=on(nx),sx=$e({},hi,{data:0}),Gf=on(sx),ix={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ox={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ax={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lx(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ax[t])?!!e[t]:!1}function jd(){return lx}var ux=$e({},Lo,{key:function(t){if(t.key){var e=ix[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=La(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ox[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jd,charCode:function(t){return t.type==="keypress"?La(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?La(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),cx=on(ux),dx=$e({},Nl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qf=on(dx),hx=$e({},Lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jd}),fx=on(hx),px=$e({},hi,{propertyName:0,elapsedTime:0,pseudoElement:0}),mx=on(px),gx=$e({},Nl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),yx=on(gx),vx=[9,13,27,32],Vd=Jn&&"CompositionEvent"in window,Yi=null;Jn&&"documentMode"in document&&(Yi=document.documentMode);var _x=Jn&&"TextEvent"in window&&!Yi,Pg=Jn&&(!Vd||Yi&&8<Yi&&11>=Yi),Kf=" ",Yf=!1;function bg(t,e){switch(t){case"keyup":return vx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dg(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ms=!1;function xx(t,e){switch(t){case"compositionend":return Dg(e);case"keypress":return e.which!==32?null:(Yf=!0,Kf);case"textInput":return t=e.data,t===Kf&&Yf?null:t;default:return null}}function wx(t,e){if(Ms)return t==="compositionend"||!Vd&&bg(t,e)?(t=Rg(),Va=Nd=yr=null,Ms=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Pg&&e.locale!=="ko"?null:e.data;default:return null}}var Sx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Sx[t.type]:e==="textarea"}function Ng(t,e,n,r){cg(r),e=rl(e,"onChange"),0<e.length&&(n=new Md("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Xi=null,po=null;function Ex(t){Wg(t,0)}function Ml(t){var e=Ls(t);if(rg(e))return t}function Tx(t,e){if(t==="change")return e}var Mg=!1;if(Jn){var ku;if(Jn){var Ru="oninput"in document;if(!Ru){var Jf=document.createElement("div");Jf.setAttribute("oninput","return;"),Ru=typeof Jf.oninput=="function"}ku=Ru}else ku=!1;Mg=ku&&(!document.documentMode||9<document.documentMode)}function Zf(){Xi&&(Xi.detachEvent("onpropertychange",jg),po=Xi=null)}function jg(t){if(t.propertyName==="value"&&Ml(po)){var e=[];Ng(e,po,t,kd(t)),pg(Ex,e)}}function Ix(t,e,n){t==="focusin"?(Zf(),Xi=e,po=n,Xi.attachEvent("onpropertychange",jg)):t==="focusout"&&Zf()}function Ax(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ml(po)}function Cx(t,e){if(t==="click")return Ml(e)}function kx(t,e){if(t==="input"||t==="change")return Ml(e)}function Rx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var En=typeof Object.is=="function"?Object.is:Rx;function mo(t,e){if(En(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!ec.call(e,s)||!En(t[s],e[s]))return!1}return!0}function ep(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function tp(t,e){var n=ep(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ep(n)}}function Vg(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Vg(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Lg(){for(var t=window,e=Ya();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ya(t.document)}return e}function Ld(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Px(t){var e=Lg(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Vg(n.ownerDocument.documentElement,n)){if(r!==null&&Ld(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=tp(n,i);var a=tp(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var bx=Jn&&"documentMode"in document&&11>=document.documentMode,js=null,_c=null,Ji=null,xc=!1;function np(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xc||js==null||js!==Ya(r)||(r=js,"selectionStart"in r&&Ld(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ji&&mo(Ji,r)||(Ji=r,r=rl(_c,"onSelect"),0<r.length&&(e=new Md("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=js)))}function xa(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Vs={animationend:xa("Animation","AnimationEnd"),animationiteration:xa("Animation","AnimationIteration"),animationstart:xa("Animation","AnimationStart"),transitionend:xa("Transition","TransitionEnd")},Pu={},Og={};Jn&&(Og=document.createElement("div").style,"AnimationEvent"in window||(delete Vs.animationend.animation,delete Vs.animationiteration.animation,delete Vs.animationstart.animation),"TransitionEvent"in window||delete Vs.transitionend.transition);function jl(t){if(Pu[t])return Pu[t];if(!Vs[t])return t;var e=Vs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Og)return Pu[t]=e[n];return t}var Fg=jl("animationend"),zg=jl("animationiteration"),Bg=jl("animationstart"),Ug=jl("transitionend"),$g=new Map,rp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lr(t,e){$g.set(t,e),ps(e,[t])}for(var bu=0;bu<rp.length;bu++){var Du=rp[bu],Dx=Du.toLowerCase(),Nx=Du[0].toUpperCase()+Du.slice(1);Lr(Dx,"on"+Nx)}Lr(Fg,"onAnimationEnd");Lr(zg,"onAnimationIteration");Lr(Bg,"onAnimationStart");Lr("dblclick","onDoubleClick");Lr("focusin","onFocus");Lr("focusout","onBlur");Lr(Ug,"onTransitionEnd");Xs("onMouseEnter",["mouseout","mouseover"]);Xs("onMouseLeave",["mouseout","mouseover"]);Xs("onPointerEnter",["pointerout","pointerover"]);Xs("onPointerLeave",["pointerout","pointerover"]);ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ps("onBeforeInput",["compositionend","keypress","textInput","paste"]);ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ui="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ui));function sp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,D_(r,e,void 0,t),t.currentTarget=null}function Wg(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],u=l.instance,h=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;sp(s,l,h),i=u}else for(a=0;a<r.length;a++){if(l=r[a],u=l.instance,h=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;sp(s,l,h),i=u}}}if(Ja)throw t=mc,Ja=!1,mc=null,t}function Me(t,e){var n=e[Ic];n===void 0&&(n=e[Ic]=new Set);var r=t+"__bubble";n.has(r)||(Hg(e,t,2,!1),n.add(r))}function Nu(t,e,n){var r=0;e&&(r|=4),Hg(n,t,r,e)}var wa="_reactListening"+Math.random().toString(36).slice(2);function go(t){if(!t[wa]){t[wa]=!0,Jm.forEach(function(n){n!=="selectionchange"&&(Mx.has(n)||Nu(n,!1,t),Nu(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[wa]||(e[wa]=!0,Nu("selectionchange",!1,e))}}function Hg(t,e,n,r){switch(kg(e)){case 1:var s=Q_;break;case 4:s=K_;break;default:s=Dd}n=s.bind(null,e,n,t),s=void 0,!pc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Mu(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Zr(l),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}l=l.parentNode}}r=r.return}pg(function(){var h=i,p=kd(n),g=[];e:{var m=$g.get(t);if(m!==void 0){var I=Md,R=t;switch(t){case"keypress":if(La(n)===0)break e;case"keydown":case"keyup":I=cx;break;case"focusin":R="focus",I=Cu;break;case"focusout":R="blur",I=Cu;break;case"beforeblur":case"afterblur":I=Cu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=qf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=J_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=fx;break;case Fg:case zg:case Bg:I=tx;break;case Ug:I=mx;break;case"scroll":I=Y_;break;case"wheel":I=yx;break;case"copy":case"cut":case"paste":I=rx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=Qf}var P=(e&4)!==0,O=!P&&t==="scroll",k=P?m!==null?m+"Capture":null:m;P=[];for(var A=h,C;A!==null;){C=A;var N=C.stateNode;if(C.tag===5&&N!==null&&(C=N,k!==null&&(N=uo(A,k),N!=null&&P.push(yo(A,N,C)))),O)break;A=A.return}0<P.length&&(m=new I(m,R,null,n,p),g.push({event:m,listeners:P}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",m&&n!==hc&&(R=n.relatedTarget||n.fromElement)&&(Zr(R)||R[Zn]))break e;if((I||m)&&(m=p.window===p?p:(m=p.ownerDocument)?m.defaultView||m.parentWindow:window,I?(R=n.relatedTarget||n.toElement,I=h,R=R?Zr(R):null,R!==null&&(O=ms(R),R!==O||R.tag!==5&&R.tag!==6)&&(R=null)):(I=null,R=h),I!==R)){if(P=qf,N="onMouseLeave",k="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(P=Qf,N="onPointerLeave",k="onPointerEnter",A="pointer"),O=I==null?m:Ls(I),C=R==null?m:Ls(R),m=new P(N,A+"leave",I,n,p),m.target=O,m.relatedTarget=C,N=null,Zr(p)===h&&(P=new P(k,A+"enter",R,n,p),P.target=C,P.relatedTarget=O,N=P),O=N,I&&R)t:{for(P=I,k=R,A=0,C=P;C;C=Cs(C))A++;for(C=0,N=k;N;N=Cs(N))C++;for(;0<A-C;)P=Cs(P),A--;for(;0<C-A;)k=Cs(k),C--;for(;A--;){if(P===k||k!==null&&P===k.alternate)break t;P=Cs(P),k=Cs(k)}P=null}else P=null;I!==null&&ip(g,m,I,P,!1),R!==null&&O!==null&&ip(g,O,R,P,!0)}}e:{if(m=h?Ls(h):window,I=m.nodeName&&m.nodeName.toLowerCase(),I==="select"||I==="input"&&m.type==="file")var V=Tx;else if(Xf(m))if(Mg)V=kx;else{V=Ax;var F=Ix}else(I=m.nodeName)&&I.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(V=Cx);if(V&&(V=V(t,h))){Ng(g,V,n,p);break e}F&&F(t,m,h),t==="focusout"&&(F=m._wrapperState)&&F.controlled&&m.type==="number"&&ac(m,"number",m.value)}switch(F=h?Ls(h):window,t){case"focusin":(Xf(F)||F.contentEditable==="true")&&(js=F,_c=h,Ji=null);break;case"focusout":Ji=_c=js=null;break;case"mousedown":xc=!0;break;case"contextmenu":case"mouseup":case"dragend":xc=!1,np(g,n,p);break;case"selectionchange":if(bx)break;case"keydown":case"keyup":np(g,n,p)}var w;if(Vd)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Ms?bg(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(Pg&&n.locale!=="ko"&&(Ms||v!=="onCompositionStart"?v==="onCompositionEnd"&&Ms&&(w=Rg()):(yr=p,Nd="value"in yr?yr.value:yr.textContent,Ms=!0)),F=rl(h,v),0<F.length&&(v=new Gf(v,t,null,n,p),g.push({event:v,listeners:F}),w?v.data=w:(w=Dg(n),w!==null&&(v.data=w)))),(w=_x?xx(t,n):wx(t,n))&&(h=rl(h,"onBeforeInput"),0<h.length&&(p=new Gf("onBeforeInput","beforeinput",null,n,p),g.push({event:p,listeners:h}),p.data=w))}Wg(g,e)})}function yo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function rl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=uo(t,n),i!=null&&r.unshift(yo(t,i,s)),i=uo(t,e),i!=null&&r.push(yo(t,i,s))),t=t.return}return r}function Cs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ip(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,u=l.alternate,h=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&h!==null&&(l=h,s?(u=uo(n,i),u!=null&&a.unshift(yo(n,u,l))):s||(u=uo(n,i),u!=null&&a.push(yo(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var jx=/\r\n?/g,Vx=/\u0000|\uFFFD/g;function op(t){return(typeof t=="string"?t:""+t).replace(jx,`
`).replace(Vx,"")}function Sa(t,e,n){if(e=op(e),op(t)!==e&&n)throw Error(H(425))}function sl(){}var wc=null,Sc=null;function Ec(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Tc=typeof setTimeout=="function"?setTimeout:void 0,Lx=typeof clearTimeout=="function"?clearTimeout:void 0,ap=typeof Promise=="function"?Promise:void 0,Ox=typeof queueMicrotask=="function"?queueMicrotask:typeof ap<"u"?function(t){return ap.resolve(null).then(t).catch(Fx)}:Tc;function Fx(t){setTimeout(function(){throw t})}function ju(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),fo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);fo(e)}function Er(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function lp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var fi=Math.random().toString(36).slice(2),Dn="__reactFiber$"+fi,vo="__reactProps$"+fi,Zn="__reactContainer$"+fi,Ic="__reactEvents$"+fi,zx="__reactListeners$"+fi,Bx="__reactHandles$"+fi;function Zr(t){var e=t[Dn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Zn]||n[Dn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=lp(t);t!==null;){if(n=t[Dn])return n;t=lp(t)}return e}t=n,n=t.parentNode}return null}function Oo(t){return t=t[Dn]||t[Zn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ls(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function Vl(t){return t[vo]||null}var Ac=[],Os=-1;function Or(t){return{current:t}}function Le(t){0>Os||(t.current=Ac[Os],Ac[Os]=null,Os--)}function Pe(t,e){Os++,Ac[Os]=t.current,t.current=e}var Nr={},Pt=Or(Nr),Bt=Or(!1),os=Nr;function Js(t,e){var n=t.type.contextTypes;if(!n)return Nr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ut(t){return t=t.childContextTypes,t!=null}function il(){Le(Bt),Le(Pt)}function up(t,e,n){if(Pt.current!==Nr)throw Error(H(168));Pe(Pt,e),Pe(Bt,n)}function qg(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(H(108,I_(t)||"Unknown",s));return $e({},n,r)}function ol(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Nr,os=Pt.current,Pe(Pt,t),Pe(Bt,Bt.current),!0}function cp(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=qg(t,e,os),r.__reactInternalMemoizedMergedChildContext=t,Le(Bt),Le(Pt),Pe(Pt,t)):Le(Bt),Pe(Bt,n)}var Wn=null,Ll=!1,Vu=!1;function Gg(t){Wn===null?Wn=[t]:Wn.push(t)}function Ux(t){Ll=!0,Gg(t)}function Fr(){if(!Vu&&Wn!==null){Vu=!0;var t=0,e=Ee;try{var n=Wn;for(Ee=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Wn=null,Ll=!1}catch(s){throw Wn!==null&&(Wn=Wn.slice(t+1)),vg(Rd,Fr),s}finally{Ee=e,Vu=!1}}return null}var Fs=[],zs=0,al=null,ll=0,an=[],ln=0,as=null,Gn=1,Qn="";function Yr(t,e){Fs[zs++]=ll,Fs[zs++]=al,al=t,ll=e}function Qg(t,e,n){an[ln++]=Gn,an[ln++]=Qn,an[ln++]=as,as=t;var r=Gn;t=Qn;var s=32-wn(r)-1;r&=~(1<<s),n+=1;var i=32-wn(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Gn=1<<32-wn(e)+s|n<<s|r,Qn=i+t}else Gn=1<<i|n<<s|r,Qn=t}function Od(t){t.return!==null&&(Yr(t,1),Qg(t,1,0))}function Fd(t){for(;t===al;)al=Fs[--zs],Fs[zs]=null,ll=Fs[--zs],Fs[zs]=null;for(;t===as;)as=an[--ln],an[ln]=null,Qn=an[--ln],an[ln]=null,Gn=an[--ln],an[ln]=null}var nn=null,en=null,Oe=!1,xn=null;function Kg(t,e){var n=cn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function dp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,nn=t,en=Er(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,nn=t,en=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=as!==null?{id:Gn,overflow:Qn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=cn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,nn=t,en=null,!0):!1;default:return!1}}function Cc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function kc(t){if(Oe){var e=en;if(e){var n=e;if(!dp(t,e)){if(Cc(t))throw Error(H(418));e=Er(n.nextSibling);var r=nn;e&&dp(t,e)?Kg(r,n):(t.flags=t.flags&-4097|2,Oe=!1,nn=t)}}else{if(Cc(t))throw Error(H(418));t.flags=t.flags&-4097|2,Oe=!1,nn=t}}}function hp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;nn=t}function Ea(t){if(t!==nn)return!1;if(!Oe)return hp(t),Oe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ec(t.type,t.memoizedProps)),e&&(e=en)){if(Cc(t))throw Yg(),Error(H(418));for(;e;)Kg(t,e),e=Er(e.nextSibling)}if(hp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){en=Er(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}en=null}}else en=nn?Er(t.stateNode.nextSibling):null;return!0}function Yg(){for(var t=en;t;)t=Er(t.nextSibling)}function Zs(){en=nn=null,Oe=!1}function zd(t){xn===null?xn=[t]:xn.push(t)}var $x=ir.ReactCurrentBatchConfig;function ji(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function Ta(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function fp(t){var e=t._init;return e(t._payload)}function Xg(t){function e(k,A){if(t){var C=k.deletions;C===null?(k.deletions=[A],k.flags|=16):C.push(A)}}function n(k,A){if(!t)return null;for(;A!==null;)e(k,A),A=A.sibling;return null}function r(k,A){for(k=new Map;A!==null;)A.key!==null?k.set(A.key,A):k.set(A.index,A),A=A.sibling;return k}function s(k,A){return k=Cr(k,A),k.index=0,k.sibling=null,k}function i(k,A,C){return k.index=C,t?(C=k.alternate,C!==null?(C=C.index,C<A?(k.flags|=2,A):C):(k.flags|=2,A)):(k.flags|=1048576,A)}function a(k){return t&&k.alternate===null&&(k.flags|=2),k}function l(k,A,C,N){return A===null||A.tag!==6?(A=$u(C,k.mode,N),A.return=k,A):(A=s(A,C),A.return=k,A)}function u(k,A,C,N){var V=C.type;return V===Ns?p(k,A,C.props.children,N,C.key):A!==null&&(A.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===fr&&fp(V)===A.type)?(N=s(A,C.props),N.ref=ji(k,A,C),N.return=k,N):(N=Wa(C.type,C.key,C.props,null,k.mode,N),N.ref=ji(k,A,C),N.return=k,N)}function h(k,A,C,N){return A===null||A.tag!==4||A.stateNode.containerInfo!==C.containerInfo||A.stateNode.implementation!==C.implementation?(A=Wu(C,k.mode,N),A.return=k,A):(A=s(A,C.children||[]),A.return=k,A)}function p(k,A,C,N,V){return A===null||A.tag!==7?(A=ss(C,k.mode,N,V),A.return=k,A):(A=s(A,C),A.return=k,A)}function g(k,A,C){if(typeof A=="string"&&A!==""||typeof A=="number")return A=$u(""+A,k.mode,C),A.return=k,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case fa:return C=Wa(A.type,A.key,A.props,null,k.mode,C),C.ref=ji(k,null,A),C.return=k,C;case Ds:return A=Wu(A,k.mode,C),A.return=k,A;case fr:var N=A._init;return g(k,N(A._payload),C)}if(zi(A)||Pi(A))return A=ss(A,k.mode,C,null),A.return=k,A;Ta(k,A)}return null}function m(k,A,C,N){var V=A!==null?A.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return V!==null?null:l(k,A,""+C,N);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case fa:return C.key===V?u(k,A,C,N):null;case Ds:return C.key===V?h(k,A,C,N):null;case fr:return V=C._init,m(k,A,V(C._payload),N)}if(zi(C)||Pi(C))return V!==null?null:p(k,A,C,N,null);Ta(k,C)}return null}function I(k,A,C,N,V){if(typeof N=="string"&&N!==""||typeof N=="number")return k=k.get(C)||null,l(A,k,""+N,V);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case fa:return k=k.get(N.key===null?C:N.key)||null,u(A,k,N,V);case Ds:return k=k.get(N.key===null?C:N.key)||null,h(A,k,N,V);case fr:var F=N._init;return I(k,A,C,F(N._payload),V)}if(zi(N)||Pi(N))return k=k.get(C)||null,p(A,k,N,V,null);Ta(A,N)}return null}function R(k,A,C,N){for(var V=null,F=null,w=A,v=A=0,E=null;w!==null&&v<C.length;v++){w.index>v?(E=w,w=null):E=w.sibling;var T=m(k,w,C[v],N);if(T===null){w===null&&(w=E);break}t&&w&&T.alternate===null&&e(k,w),A=i(T,A,v),F===null?V=T:F.sibling=T,F=T,w=E}if(v===C.length)return n(k,w),Oe&&Yr(k,v),V;if(w===null){for(;v<C.length;v++)w=g(k,C[v],N),w!==null&&(A=i(w,A,v),F===null?V=w:F.sibling=w,F=w);return Oe&&Yr(k,v),V}for(w=r(k,w);v<C.length;v++)E=I(w,k,v,C[v],N),E!==null&&(t&&E.alternate!==null&&w.delete(E.key===null?v:E.key),A=i(E,A,v),F===null?V=E:F.sibling=E,F=E);return t&&w.forEach(function(_){return e(k,_)}),Oe&&Yr(k,v),V}function P(k,A,C,N){var V=Pi(C);if(typeof V!="function")throw Error(H(150));if(C=V.call(C),C==null)throw Error(H(151));for(var F=V=null,w=A,v=A=0,E=null,T=C.next();w!==null&&!T.done;v++,T=C.next()){w.index>v?(E=w,w=null):E=w.sibling;var _=m(k,w,T.value,N);if(_===null){w===null&&(w=E);break}t&&w&&_.alternate===null&&e(k,w),A=i(_,A,v),F===null?V=_:F.sibling=_,F=_,w=E}if(T.done)return n(k,w),Oe&&Yr(k,v),V;if(w===null){for(;!T.done;v++,T=C.next())T=g(k,T.value,N),T!==null&&(A=i(T,A,v),F===null?V=T:F.sibling=T,F=T);return Oe&&Yr(k,v),V}for(w=r(k,w);!T.done;v++,T=C.next())T=I(w,k,v,T.value,N),T!==null&&(t&&T.alternate!==null&&w.delete(T.key===null?v:T.key),A=i(T,A,v),F===null?V=T:F.sibling=T,F=T);return t&&w.forEach(function(S){return e(k,S)}),Oe&&Yr(k,v),V}function O(k,A,C,N){if(typeof C=="object"&&C!==null&&C.type===Ns&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case fa:e:{for(var V=C.key,F=A;F!==null;){if(F.key===V){if(V=C.type,V===Ns){if(F.tag===7){n(k,F.sibling),A=s(F,C.props.children),A.return=k,k=A;break e}}else if(F.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===fr&&fp(V)===F.type){n(k,F.sibling),A=s(F,C.props),A.ref=ji(k,F,C),A.return=k,k=A;break e}n(k,F);break}else e(k,F);F=F.sibling}C.type===Ns?(A=ss(C.props.children,k.mode,N,C.key),A.return=k,k=A):(N=Wa(C.type,C.key,C.props,null,k.mode,N),N.ref=ji(k,A,C),N.return=k,k=N)}return a(k);case Ds:e:{for(F=C.key;A!==null;){if(A.key===F)if(A.tag===4&&A.stateNode.containerInfo===C.containerInfo&&A.stateNode.implementation===C.implementation){n(k,A.sibling),A=s(A,C.children||[]),A.return=k,k=A;break e}else{n(k,A);break}else e(k,A);A=A.sibling}A=Wu(C,k.mode,N),A.return=k,k=A}return a(k);case fr:return F=C._init,O(k,A,F(C._payload),N)}if(zi(C))return R(k,A,C,N);if(Pi(C))return P(k,A,C,N);Ta(k,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,A!==null&&A.tag===6?(n(k,A.sibling),A=s(A,C),A.return=k,k=A):(n(k,A),A=$u(C,k.mode,N),A.return=k,k=A),a(k)):n(k,A)}return O}var ei=Xg(!0),Jg=Xg(!1),ul=Or(null),cl=null,Bs=null,Bd=null;function Ud(){Bd=Bs=cl=null}function $d(t){var e=ul.current;Le(ul),t._currentValue=e}function Rc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Qs(t,e){cl=t,Bd=Bs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(zt=!0),t.firstContext=null)}function pn(t){var e=t._currentValue;if(Bd!==t)if(t={context:t,memoizedValue:e,next:null},Bs===null){if(cl===null)throw Error(H(308));Bs=t,cl.dependencies={lanes:0,firstContext:t}}else Bs=Bs.next=t;return e}var es=null;function Wd(t){es===null?es=[t]:es.push(t)}function Zg(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Wd(e)):(n.next=s.next,s.next=n),e.interleaved=n,er(t,r)}function er(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var pr=!1;function Hd(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ey(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Kn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Tr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,er(t,n)}return s=r.interleaved,s===null?(e.next=e,Wd(r)):(e.next=s.next,s.next=e),r.interleaved=e,er(t,n)}function Oa(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Pd(t,n)}}function pp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function dl(t,e,n,r){var s=t.updateQueue;pr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,h=u.next;u.next=null,a===null?i=h:a.next=h,a=u;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==a&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;a=0,p=h=u=null,l=i;do{var m=l.lane,I=l.eventTime;if((r&m)===m){p!==null&&(p=p.next={eventTime:I,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=t,P=l;switch(m=e,I=n,P.tag){case 1:if(R=P.payload,typeof R=="function"){g=R.call(I,g,m);break e}g=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=P.payload,m=typeof R=="function"?R.call(I,g,m):R,m==null)break e;g=$e({},g,m);break e;case 2:pr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else I={eventTime:I,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=I,u=g):p=p.next=I,a|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(p===null&&(u=g),s.baseState=u,s.firstBaseUpdate=h,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);us|=a,t.lanes=a,t.memoizedState=g}}function mp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var Fo={},Mn=Or(Fo),_o=Or(Fo),xo=Or(Fo);function ts(t){if(t===Fo)throw Error(H(174));return t}function qd(t,e){switch(Pe(xo,e),Pe(_o,t),Pe(Mn,Fo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:uc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=uc(e,t)}Le(Mn),Pe(Mn,e)}function ti(){Le(Mn),Le(_o),Le(xo)}function ty(t){ts(xo.current);var e=ts(Mn.current),n=uc(e,t.type);e!==n&&(Pe(_o,t),Pe(Mn,n))}function Gd(t){_o.current===t&&(Le(Mn),Le(_o))}var Be=Or(0);function hl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Lu=[];function Qd(){for(var t=0;t<Lu.length;t++)Lu[t]._workInProgressVersionPrimary=null;Lu.length=0}var Fa=ir.ReactCurrentDispatcher,Ou=ir.ReactCurrentBatchConfig,ls=0,Ue=null,tt=null,lt=null,fl=!1,Zi=!1,wo=0,Wx=0;function Tt(){throw Error(H(321))}function Kd(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!En(t[n],e[n]))return!1;return!0}function Yd(t,e,n,r,s,i){if(ls=i,Ue=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fa.current=t===null||t.memoizedState===null?Qx:Kx,t=n(r,s),Zi){i=0;do{if(Zi=!1,wo=0,25<=i)throw Error(H(301));i+=1,lt=tt=null,e.updateQueue=null,Fa.current=Yx,t=n(r,s)}while(Zi)}if(Fa.current=pl,e=tt!==null&&tt.next!==null,ls=0,lt=tt=Ue=null,fl=!1,e)throw Error(H(300));return t}function Xd(){var t=wo!==0;return wo=0,t}function bn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lt===null?Ue.memoizedState=lt=t:lt=lt.next=t,lt}function mn(){if(tt===null){var t=Ue.alternate;t=t!==null?t.memoizedState:null}else t=tt.next;var e=lt===null?Ue.memoizedState:lt.next;if(e!==null)lt=e,tt=t;else{if(t===null)throw Error(H(310));tt=t,t={memoizedState:tt.memoizedState,baseState:tt.baseState,baseQueue:tt.baseQueue,queue:tt.queue,next:null},lt===null?Ue.memoizedState=lt=t:lt=lt.next=t}return lt}function So(t,e){return typeof e=="function"?e(t):e}function Fu(t){var e=mn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=tt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,u=null,h=i;do{var p=h.lane;if((ls&p)===p)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var g={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(l=u=g,a=r):u=u.next=g,Ue.lanes|=p,us|=p}h=h.next}while(h!==null&&h!==i);u===null?a=r:u.next=l,En(r,e.memoizedState)||(zt=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ue.lanes|=i,us|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function zu(t){var e=mn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);En(i,e.memoizedState)||(zt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function ny(){}function ry(t,e){var n=Ue,r=mn(),s=e(),i=!En(r.memoizedState,s);if(i&&(r.memoizedState=s,zt=!0),r=r.queue,Jd(oy.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||lt!==null&&lt.memoizedState.tag&1){if(n.flags|=2048,Eo(9,iy.bind(null,n,r,s,e),void 0,null),ut===null)throw Error(H(349));ls&30||sy(n,e,s)}return s}function sy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function iy(t,e,n,r){e.value=n,e.getSnapshot=r,ay(e)&&ly(t)}function oy(t,e,n){return n(function(){ay(e)&&ly(t)})}function ay(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!En(t,n)}catch{return!0}}function ly(t){var e=er(t,1);e!==null&&Sn(e,t,1,-1)}function gp(t){var e=bn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:t},e.queue=t,t=t.dispatch=Gx.bind(null,Ue,t),[e.memoizedState,t]}function Eo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function uy(){return mn().memoizedState}function za(t,e,n,r){var s=bn();Ue.flags|=t,s.memoizedState=Eo(1|e,n,void 0,r===void 0?null:r)}function Ol(t,e,n,r){var s=mn();r=r===void 0?null:r;var i=void 0;if(tt!==null){var a=tt.memoizedState;if(i=a.destroy,r!==null&&Kd(r,a.deps)){s.memoizedState=Eo(e,n,i,r);return}}Ue.flags|=t,s.memoizedState=Eo(1|e,n,i,r)}function yp(t,e){return za(8390656,8,t,e)}function Jd(t,e){return Ol(2048,8,t,e)}function cy(t,e){return Ol(4,2,t,e)}function dy(t,e){return Ol(4,4,t,e)}function hy(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function fy(t,e,n){return n=n!=null?n.concat([t]):null,Ol(4,4,hy.bind(null,e,t),n)}function Zd(){}function py(t,e){var n=mn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Kd(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function my(t,e){var n=mn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Kd(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function gy(t,e,n){return ls&21?(En(n,e)||(n=wg(),Ue.lanes|=n,us|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,zt=!0),t.memoizedState=n)}function Hx(t,e){var n=Ee;Ee=n!==0&&4>n?n:4,t(!0);var r=Ou.transition;Ou.transition={};try{t(!1),e()}finally{Ee=n,Ou.transition=r}}function yy(){return mn().memoizedState}function qx(t,e,n){var r=Ar(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},vy(t))_y(e,n);else if(n=Zg(t,e,n,r),n!==null){var s=Nt();Sn(n,t,r,s),xy(n,e,r)}}function Gx(t,e,n){var r=Ar(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(vy(t))_y(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,En(l,a)){var u=e.interleaved;u===null?(s.next=s,Wd(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Zg(t,e,s,r),n!==null&&(s=Nt(),Sn(n,t,r,s),xy(n,e,r))}}function vy(t){var e=t.alternate;return t===Ue||e!==null&&e===Ue}function _y(t,e){Zi=fl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function xy(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Pd(t,n)}}var pl={readContext:pn,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},Qx={readContext:pn,useCallback:function(t,e){return bn().memoizedState=[t,e===void 0?null:e],t},useContext:pn,useEffect:yp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,za(4194308,4,hy.bind(null,e,t),n)},useLayoutEffect:function(t,e){return za(4194308,4,t,e)},useInsertionEffect:function(t,e){return za(4,2,t,e)},useMemo:function(t,e){var n=bn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=bn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=qx.bind(null,Ue,t),[r.memoizedState,t]},useRef:function(t){var e=bn();return t={current:t},e.memoizedState=t},useState:gp,useDebugValue:Zd,useDeferredValue:function(t){return bn().memoizedState=t},useTransition:function(){var t=gp(!1),e=t[0];return t=Hx.bind(null,t[1]),bn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ue,s=bn();if(Oe){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),ut===null)throw Error(H(349));ls&30||sy(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,yp(oy.bind(null,r,i,t),[t]),r.flags|=2048,Eo(9,iy.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=bn(),e=ut.identifierPrefix;if(Oe){var n=Qn,r=Gn;n=(r&~(1<<32-wn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=wo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Wx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Kx={readContext:pn,useCallback:py,useContext:pn,useEffect:Jd,useImperativeHandle:fy,useInsertionEffect:cy,useLayoutEffect:dy,useMemo:my,useReducer:Fu,useRef:uy,useState:function(){return Fu(So)},useDebugValue:Zd,useDeferredValue:function(t){var e=mn();return gy(e,tt.memoizedState,t)},useTransition:function(){var t=Fu(So)[0],e=mn().memoizedState;return[t,e]},useMutableSource:ny,useSyncExternalStore:ry,useId:yy,unstable_isNewReconciler:!1},Yx={readContext:pn,useCallback:py,useContext:pn,useEffect:Jd,useImperativeHandle:fy,useInsertionEffect:cy,useLayoutEffect:dy,useMemo:my,useReducer:zu,useRef:uy,useState:function(){return zu(So)},useDebugValue:Zd,useDeferredValue:function(t){var e=mn();return tt===null?e.memoizedState=t:gy(e,tt.memoizedState,t)},useTransition:function(){var t=zu(So)[0],e=mn().memoizedState;return[t,e]},useMutableSource:ny,useSyncExternalStore:ry,useId:yy,unstable_isNewReconciler:!1};function vn(t,e){if(t&&t.defaultProps){e=$e({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Pc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:$e({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Fl={isMounted:function(t){return(t=t._reactInternals)?ms(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Nt(),s=Ar(t),i=Kn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Tr(t,i,s),e!==null&&(Sn(e,t,s,r),Oa(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Nt(),s=Ar(t),i=Kn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Tr(t,i,s),e!==null&&(Sn(e,t,s,r),Oa(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Nt(),r=Ar(t),s=Kn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Tr(t,s,r),e!==null&&(Sn(e,t,r,n),Oa(e,t,r))}};function vp(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!mo(n,r)||!mo(s,i):!0}function wy(t,e,n){var r=!1,s=Nr,i=e.contextType;return typeof i=="object"&&i!==null?i=pn(i):(s=Ut(e)?os:Pt.current,r=e.contextTypes,i=(r=r!=null)?Js(t,s):Nr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Fl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function _p(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Fl.enqueueReplaceState(e,e.state,null)}function bc(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Hd(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=pn(i):(i=Ut(e)?os:Pt.current,s.context=Js(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Pc(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Fl.enqueueReplaceState(s,s.state,null),dl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ni(t,e){try{var n="",r=e;do n+=T_(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Bu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Dc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Xx=typeof WeakMap=="function"?WeakMap:Map;function Sy(t,e,n){n=Kn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){gl||(gl=!0,Uc=r),Dc(t,e)},n}function Ey(t,e,n){n=Kn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Dc(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Dc(t,e),typeof r!="function"&&(Ir===null?Ir=new Set([this]):Ir.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function xp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Xx;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=d1.bind(null,t,e,n),e.then(t,t))}function wp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Sp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Kn(-1,1),e.tag=2,Tr(n,e,1))),n.lanes|=1),t)}var Jx=ir.ReactCurrentOwner,zt=!1;function Dt(t,e,n,r){e.child=t===null?Jg(e,null,n,r):ei(e,t.child,n,r)}function Ep(t,e,n,r,s){n=n.render;var i=e.ref;return Qs(e,s),r=Yd(t,e,n,r,i,s),n=Xd(),t!==null&&!zt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,tr(t,e,s)):(Oe&&n&&Od(e),e.flags|=1,Dt(t,e,r,s),e.child)}function Tp(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!ah(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Ty(t,e,i,r,s)):(t=Wa(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:mo,n(a,r)&&t.ref===e.ref)return tr(t,e,s)}return e.flags|=1,t=Cr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Ty(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(mo(i,r)&&t.ref===e.ref)if(zt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(zt=!0);else return e.lanes=t.lanes,tr(t,e,s)}return Nc(t,e,n,r,s)}function Iy(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe($s,Zt),Zt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Pe($s,Zt),Zt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Pe($s,Zt),Zt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Pe($s,Zt),Zt|=r;return Dt(t,e,s,n),e.child}function Ay(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Nc(t,e,n,r,s){var i=Ut(n)?os:Pt.current;return i=Js(e,i),Qs(e,s),n=Yd(t,e,n,r,i,s),r=Xd(),t!==null&&!zt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,tr(t,e,s)):(Oe&&r&&Od(e),e.flags|=1,Dt(t,e,n,s),e.child)}function Ip(t,e,n,r,s){if(Ut(n)){var i=!0;ol(e)}else i=!1;if(Qs(e,s),e.stateNode===null)Ba(t,e),wy(e,n,r),bc(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=pn(h):(h=Ut(n)?os:Pt.current,h=Js(e,h));var p=n.getDerivedStateFromProps,g=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";g||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||u!==h)&&_p(e,a,r,h),pr=!1;var m=e.memoizedState;a.state=m,dl(e,r,a,s),u=e.memoizedState,l!==r||m!==u||Bt.current||pr?(typeof p=="function"&&(Pc(e,n,p,r),u=e.memoizedState),(l=pr||vp(e,n,l,r,m,u,h))?(g||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,ey(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:vn(e.type,l),a.props=h,g=e.pendingProps,m=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=pn(u):(u=Ut(n)?os:Pt.current,u=Js(e,u));var I=n.getDerivedStateFromProps;(p=typeof I=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==g||m!==u)&&_p(e,a,r,u),pr=!1,m=e.memoizedState,a.state=m,dl(e,r,a,s);var R=e.memoizedState;l!==g||m!==R||Bt.current||pr?(typeof I=="function"&&(Pc(e,n,I,r),R=e.memoizedState),(h=pr||vp(e,n,h,r,m,R,u)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,R,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,R,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),a.props=r,a.state=R,a.context=u,r=h):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Mc(t,e,n,r,i,s)}function Mc(t,e,n,r,s,i){Ay(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&cp(e,n,!1),tr(t,e,i);r=e.stateNode,Jx.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=ei(e,t.child,null,i),e.child=ei(e,null,l,i)):Dt(t,e,l,i),e.memoizedState=r.state,s&&cp(e,n,!0),e.child}function Cy(t){var e=t.stateNode;e.pendingContext?up(t,e.pendingContext,e.pendingContext!==e.context):e.context&&up(t,e.context,!1),qd(t,e.containerInfo)}function Ap(t,e,n,r,s){return Zs(),zd(s),e.flags|=256,Dt(t,e,n,r),e.child}var jc={dehydrated:null,treeContext:null,retryLane:0};function Vc(t){return{baseLanes:t,cachePool:null,transitions:null}}function ky(t,e,n){var r=e.pendingProps,s=Be.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Pe(Be,s&1),t===null)return kc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Ul(a,r,0,null),t=ss(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Vc(n),e.memoizedState=jc,t):eh(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Zx(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Cr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Cr(l,i):(i=ss(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?Vc(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=jc,r}return i=t.child,t=i.sibling,r=Cr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function eh(t,e){return e=Ul({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ia(t,e,n,r){return r!==null&&zd(r),ei(e,t.child,null,n),t=eh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Zx(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=Bu(Error(H(422))),Ia(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Ul({mode:"visible",children:r.children},s,0,null),i=ss(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ei(e,t.child,null,a),e.child.memoizedState=Vc(a),e.memoizedState=jc,i);if(!(e.mode&1))return Ia(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(H(419)),r=Bu(i,r,void 0),Ia(t,e,a,r)}if(l=(a&t.childLanes)!==0,zt||l){if(r=ut,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,er(t,s),Sn(r,t,s,-1))}return oh(),r=Bu(Error(H(421))),Ia(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=h1.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,en=Er(s.nextSibling),nn=e,Oe=!0,xn=null,t!==null&&(an[ln++]=Gn,an[ln++]=Qn,an[ln++]=as,Gn=t.id,Qn=t.overflow,as=e),e=eh(e,r.children),e.flags|=4096,e)}function Cp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Rc(t.return,e,n)}function Uu(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Ry(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Dt(t,e,r.children,n),r=Be.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Cp(t,n,e);else if(t.tag===19)Cp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Pe(Be,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&hl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Uu(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&hl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Uu(e,!0,n,null,i);break;case"together":Uu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ba(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function tr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),us|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=Cr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Cr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function e1(t,e,n){switch(e.tag){case 3:Cy(e),Zs();break;case 5:ty(e);break;case 1:Ut(e.type)&&ol(e);break;case 4:qd(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Pe(ul,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Pe(Be,Be.current&1),e.flags|=128,null):n&e.child.childLanes?ky(t,e,n):(Pe(Be,Be.current&1),t=tr(t,e,n),t!==null?t.sibling:null);Pe(Be,Be.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Ry(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Pe(Be,Be.current),r)break;return null;case 22:case 23:return e.lanes=0,Iy(t,e,n)}return tr(t,e,n)}var Py,Lc,by,Dy;Py=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Lc=function(){};by=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ts(Mn.current);var i=null;switch(n){case"input":s=ic(t,s),r=ic(t,r),i=[];break;case"select":s=$e({},s,{value:void 0}),r=$e({},r,{value:void 0}),i=[];break;case"textarea":s=lc(t,s),r=lc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=sl)}cc(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ao.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var u=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&u!==l&&(u!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(ao.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&Me("scroll",t),i||l===u||(i=[])):(i=i||[]).push(h,u))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};Dy=function(t,e,n,r){n!==r&&(e.flags|=4)};function Vi(t,e){if(!Oe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function It(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function t1(t,e,n){var r=e.pendingProps;switch(Fd(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(e),null;case 1:return Ut(e.type)&&il(),It(e),null;case 3:return r=e.stateNode,ti(),Le(Bt),Le(Pt),Qd(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ea(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,xn!==null&&(Hc(xn),xn=null))),Lc(t,e),It(e),null;case 5:Gd(e);var s=ts(xo.current);if(n=e.type,t!==null&&e.stateNode!=null)by(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return It(e),null}if(t=ts(Mn.current),Ea(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Dn]=e,r[vo]=i,t=(e.mode&1)!==0,n){case"dialog":Me("cancel",r),Me("close",r);break;case"iframe":case"object":case"embed":Me("load",r);break;case"video":case"audio":for(s=0;s<Ui.length;s++)Me(Ui[s],r);break;case"source":Me("error",r);break;case"img":case"image":case"link":Me("error",r),Me("load",r);break;case"details":Me("toggle",r);break;case"input":Vf(r,i),Me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Me("invalid",r);break;case"textarea":Of(r,i),Me("invalid",r)}cc(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Sa(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Sa(r.textContent,l,t),s=["children",""+l]):ao.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Me("scroll",r)}switch(n){case"input":pa(r),Lf(r,i,!0);break;case"textarea":pa(r),Ff(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=sl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=og(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Dn]=e,t[vo]=r,Py(t,e,!1,!1),e.stateNode=t;e:{switch(a=dc(n,r),n){case"dialog":Me("cancel",t),Me("close",t),s=r;break;case"iframe":case"object":case"embed":Me("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ui.length;s++)Me(Ui[s],t);s=r;break;case"source":Me("error",t),s=r;break;case"img":case"image":case"link":Me("error",t),Me("load",t),s=r;break;case"details":Me("toggle",t),s=r;break;case"input":Vf(t,r),s=ic(t,r),Me("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=$e({},r,{value:void 0}),Me("invalid",t);break;case"textarea":Of(t,r),s=lc(t,r),Me("invalid",t);break;default:s=r}cc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?ug(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&ag(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&lo(t,u):typeof u=="number"&&lo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ao.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Me("scroll",t):u!=null&&Td(t,i,u,a))}switch(n){case"input":pa(t),Lf(t,r,!1);break;case"textarea":pa(t),Ff(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Dr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Ws(t,!!r.multiple,i,!1):r.defaultValue!=null&&Ws(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=sl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return It(e),null;case 6:if(t&&e.stateNode!=null)Dy(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=ts(xo.current),ts(Mn.current),Ea(e)){if(r=e.stateNode,n=e.memoizedProps,r[Dn]=e,(i=r.nodeValue!==n)&&(t=nn,t!==null))switch(t.tag){case 3:Sa(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Sa(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Dn]=e,e.stateNode=r}return It(e),null;case 13:if(Le(Be),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Oe&&en!==null&&e.mode&1&&!(e.flags&128))Yg(),Zs(),e.flags|=98560,i=!1;else if(i=Ea(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(H(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[Dn]=e}else Zs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;It(e),i=!1}else xn!==null&&(Hc(xn),xn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Be.current&1?nt===0&&(nt=3):oh())),e.updateQueue!==null&&(e.flags|=4),It(e),null);case 4:return ti(),Lc(t,e),t===null&&go(e.stateNode.containerInfo),It(e),null;case 10:return $d(e.type._context),It(e),null;case 17:return Ut(e.type)&&il(),It(e),null;case 19:if(Le(Be),i=e.memoizedState,i===null)return It(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Vi(i,!1);else{if(nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=hl(t),a!==null){for(e.flags|=128,Vi(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Pe(Be,Be.current&1|2),e.child}t=t.sibling}i.tail!==null&&Qe()>ri&&(e.flags|=128,r=!0,Vi(i,!1),e.lanes=4194304)}else{if(!r)if(t=hl(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Vi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Oe)return It(e),null}else 2*Qe()-i.renderingStartTime>ri&&n!==1073741824&&(e.flags|=128,r=!0,Vi(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Qe(),e.sibling=null,n=Be.current,Pe(Be,r?n&1|2:n&1),e):(It(e),null);case 22:case 23:return ih(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Zt&1073741824&&(It(e),e.subtreeFlags&6&&(e.flags|=8192)):It(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function n1(t,e){switch(Fd(e),e.tag){case 1:return Ut(e.type)&&il(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ti(),Le(Bt),Le(Pt),Qd(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Gd(e),null;case 13:if(Le(Be),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));Zs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Le(Be),null;case 4:return ti(),null;case 10:return $d(e.type._context),null;case 22:case 23:return ih(),null;case 24:return null;default:return null}}var Aa=!1,kt=!1,r1=typeof WeakSet=="function"?WeakSet:Set,te=null;function Us(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qe(t,e,r)}else n.current=null}function Oc(t,e,n){try{n()}catch(r){qe(t,e,r)}}var kp=!1;function s1(t,e){if(wc=tl,t=Lg(),Ld(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,u=-1,h=0,p=0,g=t,m=null;t:for(;;){for(var I;g!==n||s!==0&&g.nodeType!==3||(l=a+s),g!==i||r!==0&&g.nodeType!==3||(u=a+r),g.nodeType===3&&(a+=g.nodeValue.length),(I=g.firstChild)!==null;)m=g,g=I;for(;;){if(g===t)break t;if(m===n&&++h===s&&(l=a),m===i&&++p===r&&(u=a),(I=g.nextSibling)!==null)break;g=m,m=g.parentNode}g=I}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Sc={focusedElem:t,selectionRange:n},tl=!1,te=e;te!==null;)if(e=te,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,te=t;else for(;te!==null;){e=te;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var P=R.memoizedProps,O=R.memoizedState,k=e.stateNode,A=k.getSnapshotBeforeUpdate(e.elementType===e.type?P:vn(e.type,P),O);k.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(N){qe(e,e.return,N)}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}return R=kp,kp=!1,R}function eo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Oc(e,n,i)}s=s.next}while(s!==r)}}function zl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Fc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Ny(t){var e=t.alternate;e!==null&&(t.alternate=null,Ny(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Dn],delete e[vo],delete e[Ic],delete e[zx],delete e[Bx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function My(t){return t.tag===5||t.tag===3||t.tag===4}function Rp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||My(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function zc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=sl));else if(r!==4&&(t=t.child,t!==null))for(zc(t,e,n),t=t.sibling;t!==null;)zc(t,e,n),t=t.sibling}function Bc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Bc(t,e,n),t=t.sibling;t!==null;)Bc(t,e,n),t=t.sibling}var ht=null,_n=!1;function hr(t,e,n){for(n=n.child;n!==null;)jy(t,e,n),n=n.sibling}function jy(t,e,n){if(Nn&&typeof Nn.onCommitFiberUnmount=="function")try{Nn.onCommitFiberUnmount(Dl,n)}catch{}switch(n.tag){case 5:kt||Us(n,e);case 6:var r=ht,s=_n;ht=null,hr(t,e,n),ht=r,_n=s,ht!==null&&(_n?(t=ht,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ht.removeChild(n.stateNode));break;case 18:ht!==null&&(_n?(t=ht,n=n.stateNode,t.nodeType===8?ju(t.parentNode,n):t.nodeType===1&&ju(t,n),fo(t)):ju(ht,n.stateNode));break;case 4:r=ht,s=_n,ht=n.stateNode.containerInfo,_n=!0,hr(t,e,n),ht=r,_n=s;break;case 0:case 11:case 14:case 15:if(!kt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Oc(n,e,a),s=s.next}while(s!==r)}hr(t,e,n);break;case 1:if(!kt&&(Us(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){qe(n,e,l)}hr(t,e,n);break;case 21:hr(t,e,n);break;case 22:n.mode&1?(kt=(r=kt)||n.memoizedState!==null,hr(t,e,n),kt=r):hr(t,e,n);break;default:hr(t,e,n)}}function Pp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new r1),e.forEach(function(r){var s=f1.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function yn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:ht=l.stateNode,_n=!1;break e;case 3:ht=l.stateNode.containerInfo,_n=!0;break e;case 4:ht=l.stateNode.containerInfo,_n=!0;break e}l=l.return}if(ht===null)throw Error(H(160));jy(i,a,s),ht=null,_n=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(h){qe(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Vy(e,t),e=e.sibling}function Vy(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(yn(e,t),Pn(t),r&4){try{eo(3,t,t.return),zl(3,t)}catch(P){qe(t,t.return,P)}try{eo(5,t,t.return)}catch(P){qe(t,t.return,P)}}break;case 1:yn(e,t),Pn(t),r&512&&n!==null&&Us(n,n.return);break;case 5:if(yn(e,t),Pn(t),r&512&&n!==null&&Us(n,n.return),t.flags&32){var s=t.stateNode;try{lo(s,"")}catch(P){qe(t,t.return,P)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&sg(s,i),dc(l,a);var h=dc(l,i);for(a=0;a<u.length;a+=2){var p=u[a],g=u[a+1];p==="style"?ug(s,g):p==="dangerouslySetInnerHTML"?ag(s,g):p==="children"?lo(s,g):Td(s,p,g,h)}switch(l){case"input":oc(s,i);break;case"textarea":ig(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var I=i.value;I!=null?Ws(s,!!i.multiple,I,!1):m!==!!i.multiple&&(i.defaultValue!=null?Ws(s,!!i.multiple,i.defaultValue,!0):Ws(s,!!i.multiple,i.multiple?[]:"",!1))}s[vo]=i}catch(P){qe(t,t.return,P)}}break;case 6:if(yn(e,t),Pn(t),r&4){if(t.stateNode===null)throw Error(H(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(P){qe(t,t.return,P)}}break;case 3:if(yn(e,t),Pn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{fo(e.containerInfo)}catch(P){qe(t,t.return,P)}break;case 4:yn(e,t),Pn(t);break;case 13:yn(e,t),Pn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(rh=Qe())),r&4&&Pp(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(kt=(h=kt)||p,yn(e,t),kt=h):yn(e,t),Pn(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(te=t,p=t.child;p!==null;){for(g=te=p;te!==null;){switch(m=te,I=m.child,m.tag){case 0:case 11:case 14:case 15:eo(4,m,m.return);break;case 1:Us(m,m.return);var R=m.stateNode;if(typeof R.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(P){qe(r,n,P)}}break;case 5:Us(m,m.return);break;case 22:if(m.memoizedState!==null){Dp(g);continue}}I!==null?(I.return=m,te=I):Dp(g)}p=p.sibling}e:for(p=null,g=t;;){if(g.tag===5){if(p===null){p=g;try{s=g.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=g.stateNode,u=g.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=lg("display",a))}catch(P){qe(t,t.return,P)}}}else if(g.tag===6){if(p===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(P){qe(t,t.return,P)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;p===g&&(p=null),g=g.return}p===g&&(p=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:yn(e,t),Pn(t),r&4&&Pp(t);break;case 21:break;default:yn(e,t),Pn(t)}}function Pn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(My(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(lo(s,""),r.flags&=-33);var i=Rp(t);Bc(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Rp(t);zc(t,l,a);break;default:throw Error(H(161))}}catch(u){qe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function i1(t,e,n){te=t,Ly(t)}function Ly(t,e,n){for(var r=(t.mode&1)!==0;te!==null;){var s=te,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Aa;if(!a){var l=s.alternate,u=l!==null&&l.memoizedState!==null||kt;l=Aa;var h=kt;if(Aa=a,(kt=u)&&!h)for(te=s;te!==null;)a=te,u=a.child,a.tag===22&&a.memoizedState!==null?Np(s):u!==null?(u.return=a,te=u):Np(s);for(;i!==null;)te=i,Ly(i),i=i.sibling;te=s,Aa=l,kt=h}bp(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,te=i):bp(t)}}function bp(t){for(;te!==null;){var e=te;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:kt||zl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!kt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:vn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&mp(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}mp(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var g=p.dehydrated;g!==null&&fo(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}kt||e.flags&512&&Fc(e)}catch(m){qe(e,e.return,m)}}if(e===t){te=null;break}if(n=e.sibling,n!==null){n.return=e.return,te=n;break}te=e.return}}function Dp(t){for(;te!==null;){var e=te;if(e===t){te=null;break}var n=e.sibling;if(n!==null){n.return=e.return,te=n;break}te=e.return}}function Np(t){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{zl(4,e)}catch(u){qe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){qe(e,s,u)}}var i=e.return;try{Fc(e)}catch(u){qe(e,i,u)}break;case 5:var a=e.return;try{Fc(e)}catch(u){qe(e,a,u)}}}catch(u){qe(e,e.return,u)}if(e===t){te=null;break}var l=e.sibling;if(l!==null){l.return=e.return,te=l;break}te=e.return}}var o1=Math.ceil,ml=ir.ReactCurrentDispatcher,th=ir.ReactCurrentOwner,hn=ir.ReactCurrentBatchConfig,ve=0,ut=null,Xe=null,mt=0,Zt=0,$s=Or(0),nt=0,To=null,us=0,Bl=0,nh=0,to=null,Ot=null,rh=0,ri=1/0,$n=null,gl=!1,Uc=null,Ir=null,Ca=!1,vr=null,yl=0,no=0,$c=null,Ua=-1,$a=0;function Nt(){return ve&6?Qe():Ua!==-1?Ua:Ua=Qe()}function Ar(t){return t.mode&1?ve&2&&mt!==0?mt&-mt:$x.transition!==null?($a===0&&($a=wg()),$a):(t=Ee,t!==0||(t=window.event,t=t===void 0?16:kg(t.type)),t):1}function Sn(t,e,n,r){if(50<no)throw no=0,$c=null,Error(H(185));Vo(t,n,r),(!(ve&2)||t!==ut)&&(t===ut&&(!(ve&2)&&(Bl|=n),nt===4&&gr(t,mt)),$t(t,r),n===1&&ve===0&&!(e.mode&1)&&(ri=Qe()+500,Ll&&Fr()))}function $t(t,e){var n=t.callbackNode;$_(t,e);var r=el(t,t===ut?mt:0);if(r===0)n!==null&&Uf(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Uf(n),e===1)t.tag===0?Ux(Mp.bind(null,t)):Gg(Mp.bind(null,t)),Ox(function(){!(ve&6)&&Fr()}),n=null;else{switch(Sg(r)){case 1:n=Rd;break;case 4:n=_g;break;case 16:n=Za;break;case 536870912:n=xg;break;default:n=Za}n=Hy(n,Oy.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Oy(t,e){if(Ua=-1,$a=0,ve&6)throw Error(H(327));var n=t.callbackNode;if(Ks()&&t.callbackNode!==n)return null;var r=el(t,t===ut?mt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=vl(t,r);else{e=r;var s=ve;ve|=2;var i=zy();(ut!==t||mt!==e)&&($n=null,ri=Qe()+500,rs(t,e));do try{u1();break}catch(l){Fy(t,l)}while(!0);Ud(),ml.current=i,ve=s,Xe!==null?e=0:(ut=null,mt=0,e=nt)}if(e!==0){if(e===2&&(s=gc(t),s!==0&&(r=s,e=Wc(t,s))),e===1)throw n=To,rs(t,0),gr(t,r),$t(t,Qe()),n;if(e===6)gr(t,r);else{if(s=t.current.alternate,!(r&30)&&!a1(s)&&(e=vl(t,r),e===2&&(i=gc(t),i!==0&&(r=i,e=Wc(t,i))),e===1))throw n=To,rs(t,0),gr(t,r),$t(t,Qe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:Xr(t,Ot,$n);break;case 3:if(gr(t,r),(r&130023424)===r&&(e=rh+500-Qe(),10<e)){if(el(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Nt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Tc(Xr.bind(null,t,Ot,$n),e);break}Xr(t,Ot,$n);break;case 4:if(gr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-wn(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=Qe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*o1(r/1960))-r,10<r){t.timeoutHandle=Tc(Xr.bind(null,t,Ot,$n),r);break}Xr(t,Ot,$n);break;case 5:Xr(t,Ot,$n);break;default:throw Error(H(329))}}}return $t(t,Qe()),t.callbackNode===n?Oy.bind(null,t):null}function Wc(t,e){var n=to;return t.current.memoizedState.isDehydrated&&(rs(t,e).flags|=256),t=vl(t,e),t!==2&&(e=Ot,Ot=n,e!==null&&Hc(e)),t}function Hc(t){Ot===null?Ot=t:Ot.push.apply(Ot,t)}function a1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!En(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function gr(t,e){for(e&=~nh,e&=~Bl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-wn(e),r=1<<n;t[n]=-1,e&=~r}}function Mp(t){if(ve&6)throw Error(H(327));Ks();var e=el(t,0);if(!(e&1))return $t(t,Qe()),null;var n=vl(t,e);if(t.tag!==0&&n===2){var r=gc(t);r!==0&&(e=r,n=Wc(t,r))}if(n===1)throw n=To,rs(t,0),gr(t,e),$t(t,Qe()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Xr(t,Ot,$n),$t(t,Qe()),null}function sh(t,e){var n=ve;ve|=1;try{return t(e)}finally{ve=n,ve===0&&(ri=Qe()+500,Ll&&Fr())}}function cs(t){vr!==null&&vr.tag===0&&!(ve&6)&&Ks();var e=ve;ve|=1;var n=hn.transition,r=Ee;try{if(hn.transition=null,Ee=1,t)return t()}finally{Ee=r,hn.transition=n,ve=e,!(ve&6)&&Fr()}}function ih(){Zt=$s.current,Le($s)}function rs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Lx(n)),Xe!==null)for(n=Xe.return;n!==null;){var r=n;switch(Fd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&il();break;case 3:ti(),Le(Bt),Le(Pt),Qd();break;case 5:Gd(r);break;case 4:ti();break;case 13:Le(Be);break;case 19:Le(Be);break;case 10:$d(r.type._context);break;case 22:case 23:ih()}n=n.return}if(ut=t,Xe=t=Cr(t.current,null),mt=Zt=e,nt=0,To=null,nh=Bl=us=0,Ot=to=null,es!==null){for(e=0;e<es.length;e++)if(n=es[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}es=null}return t}function Fy(t,e){do{var n=Xe;try{if(Ud(),Fa.current=pl,fl){for(var r=Ue.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}fl=!1}if(ls=0,lt=tt=Ue=null,Zi=!1,wo=0,th.current=null,n===null||n.return===null){nt=1,To=e,Xe=null;break}e:{var i=t,a=n.return,l=n,u=e;if(e=mt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,p=l,g=p.tag;if(!(p.mode&1)&&(g===0||g===11||g===15)){var m=p.alternate;m?(p.updateQueue=m.updateQueue,p.memoizedState=m.memoizedState,p.lanes=m.lanes):(p.updateQueue=null,p.memoizedState=null)}var I=wp(a);if(I!==null){I.flags&=-257,Sp(I,a,l,i,e),I.mode&1&&xp(i,h,e),e=I,u=h;var R=e.updateQueue;if(R===null){var P=new Set;P.add(u),e.updateQueue=P}else R.add(u);break e}else{if(!(e&1)){xp(i,h,e),oh();break e}u=Error(H(426))}}else if(Oe&&l.mode&1){var O=wp(a);if(O!==null){!(O.flags&65536)&&(O.flags|=256),Sp(O,a,l,i,e),zd(ni(u,l));break e}}i=u=ni(u,l),nt!==4&&(nt=2),to===null?to=[i]:to.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var k=Sy(i,u,e);pp(i,k);break e;case 1:l=u;var A=i.type,C=i.stateNode;if(!(i.flags&128)&&(typeof A.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Ir===null||!Ir.has(C)))){i.flags|=65536,e&=-e,i.lanes|=e;var N=Ey(i,l,e);pp(i,N);break e}}i=i.return}while(i!==null)}Uy(n)}catch(V){e=V,Xe===n&&n!==null&&(Xe=n=n.return);continue}break}while(!0)}function zy(){var t=ml.current;return ml.current=pl,t===null?pl:t}function oh(){(nt===0||nt===3||nt===2)&&(nt=4),ut===null||!(us&268435455)&&!(Bl&268435455)||gr(ut,mt)}function vl(t,e){var n=ve;ve|=2;var r=zy();(ut!==t||mt!==e)&&($n=null,rs(t,e));do try{l1();break}catch(s){Fy(t,s)}while(!0);if(Ud(),ve=n,ml.current=r,Xe!==null)throw Error(H(261));return ut=null,mt=0,nt}function l1(){for(;Xe!==null;)By(Xe)}function u1(){for(;Xe!==null&&!M_();)By(Xe)}function By(t){var e=Wy(t.alternate,t,Zt);t.memoizedProps=t.pendingProps,e===null?Uy(t):Xe=e,th.current=null}function Uy(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=n1(n,e),n!==null){n.flags&=32767,Xe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{nt=6,Xe=null;return}}else if(n=t1(n,e,Zt),n!==null){Xe=n;return}if(e=e.sibling,e!==null){Xe=e;return}Xe=e=t}while(e!==null);nt===0&&(nt=5)}function Xr(t,e,n){var r=Ee,s=hn.transition;try{hn.transition=null,Ee=1,c1(t,e,n,r)}finally{hn.transition=s,Ee=r}return null}function c1(t,e,n,r){do Ks();while(vr!==null);if(ve&6)throw Error(H(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(W_(t,i),t===ut&&(Xe=ut=null,mt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ca||(Ca=!0,Hy(Za,function(){return Ks(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=hn.transition,hn.transition=null;var a=Ee;Ee=1;var l=ve;ve|=4,th.current=null,s1(t,n),Vy(n,t),Px(Sc),tl=!!wc,Sc=wc=null,t.current=n,i1(n),j_(),ve=l,Ee=a,hn.transition=i}else t.current=n;if(Ca&&(Ca=!1,vr=t,yl=s),i=t.pendingLanes,i===0&&(Ir=null),O_(n.stateNode),$t(t,Qe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(gl)throw gl=!1,t=Uc,Uc=null,t;return yl&1&&t.tag!==0&&Ks(),i=t.pendingLanes,i&1?t===$c?no++:(no=0,$c=t):no=0,Fr(),null}function Ks(){if(vr!==null){var t=Sg(yl),e=hn.transition,n=Ee;try{if(hn.transition=null,Ee=16>t?16:t,vr===null)var r=!1;else{if(t=vr,vr=null,yl=0,ve&6)throw Error(H(331));var s=ve;for(ve|=4,te=t.current;te!==null;){var i=te,a=i.child;if(te.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var h=l[u];for(te=h;te!==null;){var p=te;switch(p.tag){case 0:case 11:case 15:eo(8,p,i)}var g=p.child;if(g!==null)g.return=p,te=g;else for(;te!==null;){p=te;var m=p.sibling,I=p.return;if(Ny(p),p===h){te=null;break}if(m!==null){m.return=I,te=m;break}te=I}}}var R=i.alternate;if(R!==null){var P=R.child;if(P!==null){R.child=null;do{var O=P.sibling;P.sibling=null,P=O}while(P!==null)}}te=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,te=a;else e:for(;te!==null;){if(i=te,i.flags&2048)switch(i.tag){case 0:case 11:case 15:eo(9,i,i.return)}var k=i.sibling;if(k!==null){k.return=i.return,te=k;break e}te=i.return}}var A=t.current;for(te=A;te!==null;){a=te;var C=a.child;if(a.subtreeFlags&2064&&C!==null)C.return=a,te=C;else e:for(a=A;te!==null;){if(l=te,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:zl(9,l)}}catch(V){qe(l,l.return,V)}if(l===a){te=null;break e}var N=l.sibling;if(N!==null){N.return=l.return,te=N;break e}te=l.return}}if(ve=s,Fr(),Nn&&typeof Nn.onPostCommitFiberRoot=="function")try{Nn.onPostCommitFiberRoot(Dl,t)}catch{}r=!0}return r}finally{Ee=n,hn.transition=e}}return!1}function jp(t,e,n){e=ni(n,e),e=Sy(t,e,1),t=Tr(t,e,1),e=Nt(),t!==null&&(Vo(t,1,e),$t(t,e))}function qe(t,e,n){if(t.tag===3)jp(t,t,n);else for(;e!==null;){if(e.tag===3){jp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ir===null||!Ir.has(r))){t=ni(n,t),t=Ey(e,t,1),e=Tr(e,t,1),t=Nt(),e!==null&&(Vo(e,1,t),$t(e,t));break}}e=e.return}}function d1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Nt(),t.pingedLanes|=t.suspendedLanes&n,ut===t&&(mt&n)===n&&(nt===4||nt===3&&(mt&130023424)===mt&&500>Qe()-rh?rs(t,0):nh|=n),$t(t,e)}function $y(t,e){e===0&&(t.mode&1?(e=ya,ya<<=1,!(ya&130023424)&&(ya=4194304)):e=1);var n=Nt();t=er(t,e),t!==null&&(Vo(t,e,n),$t(t,n))}function h1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),$y(t,n)}function f1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),$y(t,n)}var Wy;Wy=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Bt.current)zt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return zt=!1,e1(t,e,n);zt=!!(t.flags&131072)}else zt=!1,Oe&&e.flags&1048576&&Qg(e,ll,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ba(t,e),t=e.pendingProps;var s=Js(e,Pt.current);Qs(e,n),s=Yd(null,e,r,t,s,n);var i=Xd();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ut(r)?(i=!0,ol(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Hd(e),s.updater=Fl,e.stateNode=s,s._reactInternals=e,bc(e,r,t,n),e=Mc(null,e,r,!0,i,n)):(e.tag=0,Oe&&i&&Od(e),Dt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ba(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=m1(r),t=vn(r,t),s){case 0:e=Nc(null,e,r,t,n);break e;case 1:e=Ip(null,e,r,t,n);break e;case 11:e=Ep(null,e,r,t,n);break e;case 14:e=Tp(null,e,r,vn(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),Nc(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),Ip(t,e,r,s,n);case 3:e:{if(Cy(e),t===null)throw Error(H(387));r=e.pendingProps,i=e.memoizedState,s=i.element,ey(t,e),dl(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ni(Error(H(423)),e),e=Ap(t,e,r,n,s);break e}else if(r!==s){s=ni(Error(H(424)),e),e=Ap(t,e,r,n,s);break e}else for(en=Er(e.stateNode.containerInfo.firstChild),nn=e,Oe=!0,xn=null,n=Jg(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Zs(),r===s){e=tr(t,e,n);break e}Dt(t,e,r,n)}e=e.child}return e;case 5:return ty(e),t===null&&kc(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Ec(r,s)?a=null:i!==null&&Ec(r,i)&&(e.flags|=32),Ay(t,e),Dt(t,e,a,n),e.child;case 6:return t===null&&kc(e),null;case 13:return ky(t,e,n);case 4:return qd(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ei(e,null,r,n):Dt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),Ep(t,e,r,s,n);case 7:return Dt(t,e,e.pendingProps,n),e.child;case 8:return Dt(t,e,e.pendingProps.children,n),e.child;case 12:return Dt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Pe(ul,r._currentValue),r._currentValue=a,i!==null)if(En(i.value,a)){if(i.children===s.children&&!Bt.current){e=tr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Kn(-1,n&-n),u.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?u.next=u:(u.next=p.next,p.next=u),h.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Rc(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(H(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Rc(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Dt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Qs(e,n),s=pn(s),r=r(s),e.flags|=1,Dt(t,e,r,n),e.child;case 14:return r=e.type,s=vn(r,e.pendingProps),s=vn(r.type,s),Tp(t,e,r,s,n);case 15:return Ty(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:vn(r,s),Ba(t,e),e.tag=1,Ut(r)?(t=!0,ol(e)):t=!1,Qs(e,n),wy(e,r,s),bc(e,r,s,n),Mc(null,e,r,!0,t,n);case 19:return Ry(t,e,n);case 22:return Iy(t,e,n)}throw Error(H(156,e.tag))};function Hy(t,e){return vg(t,e)}function p1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cn(t,e,n,r){return new p1(t,e,n,r)}function ah(t){return t=t.prototype,!(!t||!t.isReactComponent)}function m1(t){if(typeof t=="function")return ah(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ad)return 11;if(t===Cd)return 14}return 2}function Cr(t,e){var n=t.alternate;return n===null?(n=cn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Wa(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")ah(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Ns:return ss(n.children,s,i,e);case Id:a=8,s|=8;break;case tc:return t=cn(12,n,e,s|2),t.elementType=tc,t.lanes=i,t;case nc:return t=cn(13,n,e,s),t.elementType=nc,t.lanes=i,t;case rc:return t=cn(19,n,e,s),t.elementType=rc,t.lanes=i,t;case tg:return Ul(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Zm:a=10;break e;case eg:a=9;break e;case Ad:a=11;break e;case Cd:a=14;break e;case fr:a=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=cn(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ss(t,e,n,r){return t=cn(7,t,r,e),t.lanes=n,t}function Ul(t,e,n,r){return t=cn(22,t,r,e),t.elementType=tg,t.lanes=n,t.stateNode={isHidden:!1},t}function $u(t,e,n){return t=cn(6,t,null,e),t.lanes=n,t}function Wu(t,e,n){return e=cn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function g1(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tu(0),this.expirationTimes=Tu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function lh(t,e,n,r,s,i,a,l,u){return t=new g1(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=cn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hd(i),t}function y1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ds,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function qy(t){if(!t)return Nr;t=t._reactInternals;e:{if(ms(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ut(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(Ut(n))return qg(t,n,e)}return e}function Gy(t,e,n,r,s,i,a,l,u){return t=lh(n,r,!0,t,s,i,a,l,u),t.context=qy(null),n=t.current,r=Nt(),s=Ar(n),i=Kn(r,s),i.callback=e??null,Tr(n,i,s),t.current.lanes=s,Vo(t,s,r),$t(t,r),t}function $l(t,e,n,r){var s=e.current,i=Nt(),a=Ar(s);return n=qy(n),e.context===null?e.context=n:e.pendingContext=n,e=Kn(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Tr(s,e,a),t!==null&&(Sn(t,s,a,i),Oa(t,s,a)),a}function _l(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Vp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function uh(t,e){Vp(t,e),(t=t.alternate)&&Vp(t,e)}function v1(){return null}var Qy=typeof reportError=="function"?reportError:function(t){console.error(t)};function ch(t){this._internalRoot=t}Wl.prototype.render=ch.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));$l(t,e,null,null)};Wl.prototype.unmount=ch.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;cs(function(){$l(null,t,null,null)}),e[Zn]=null}};function Wl(t){this._internalRoot=t}Wl.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ig();t={blockedOn:null,target:t,priority:e};for(var n=0;n<mr.length&&e!==0&&e<mr[n].priority;n++);mr.splice(n,0,t),n===0&&Cg(t)}};function dh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Lp(){}function _1(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=_l(a);i.call(h)}}var a=Gy(e,r,t,0,null,!1,!1,"",Lp);return t._reactRootContainer=a,t[Zn]=a.current,go(t.nodeType===8?t.parentNode:t),cs(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=_l(u);l.call(h)}}var u=lh(t,0,!1,null,null,!1,!1,"",Lp);return t._reactRootContainer=u,t[Zn]=u.current,go(t.nodeType===8?t.parentNode:t),cs(function(){$l(e,u,n,r)}),u}function ql(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var u=_l(a);l.call(u)}}$l(e,a,t,s)}else a=_1(n,e,t,s,r);return _l(a)}Eg=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Bi(e.pendingLanes);n!==0&&(Pd(e,n|1),$t(e,Qe()),!(ve&6)&&(ri=Qe()+500,Fr()))}break;case 13:cs(function(){var r=er(t,1);if(r!==null){var s=Nt();Sn(r,t,1,s)}}),uh(t,1)}};bd=function(t){if(t.tag===13){var e=er(t,134217728);if(e!==null){var n=Nt();Sn(e,t,134217728,n)}uh(t,134217728)}};Tg=function(t){if(t.tag===13){var e=Ar(t),n=er(t,e);if(n!==null){var r=Nt();Sn(n,t,e,r)}uh(t,e)}};Ig=function(){return Ee};Ag=function(t,e){var n=Ee;try{return Ee=t,e()}finally{Ee=n}};fc=function(t,e,n){switch(e){case"input":if(oc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Vl(r);if(!s)throw Error(H(90));rg(r),oc(r,s)}}}break;case"textarea":ig(t,n);break;case"select":e=n.value,e!=null&&Ws(t,!!n.multiple,e,!1)}};hg=sh;fg=cs;var x1={usingClientEntryPoint:!1,Events:[Oo,Ls,Vl,cg,dg,sh]},Li={findFiberByHostInstance:Zr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},w1={bundleType:Li.bundleType,version:Li.version,rendererPackageName:Li.rendererPackageName,rendererConfig:Li.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ir.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=gg(t),t===null?null:t.stateNode},findFiberByHostInstance:Li.findFiberByHostInstance||v1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ka=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ka.isDisabled&&ka.supportsFiber)try{Dl=ka.inject(w1),Nn=ka}catch{}}sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x1;sn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dh(e))throw Error(H(200));return y1(t,e,null,n)};sn.createRoot=function(t,e){if(!dh(t))throw Error(H(299));var n=!1,r="",s=Qy;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=lh(t,1,!1,null,null,n,!1,r,s),t[Zn]=e.current,go(t.nodeType===8?t.parentNode:t),new ch(e)};sn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=gg(e),t=t===null?null:t.stateNode,t};sn.flushSync=function(t){return cs(t)};sn.hydrate=function(t,e,n){if(!Hl(e))throw Error(H(200));return ql(null,t,e,!0,n)};sn.hydrateRoot=function(t,e,n){if(!dh(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=Qy;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=Gy(e,null,t,1,n??null,s,!1,i,a),t[Zn]=e.current,go(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Wl(e)};sn.render=function(t,e,n){if(!Hl(e))throw Error(H(200));return ql(null,t,e,!1,n)};sn.unmountComponentAtNode=function(t){if(!Hl(t))throw Error(H(40));return t._reactRootContainer?(cs(function(){ql(null,null,t,!1,function(){t._reactRootContainer=null,t[Zn]=null})}),!0):!1};sn.unstable_batchedUpdates=sh;sn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Hl(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return ql(t,e,n,!1,r)};sn.version="18.3.1-next-f1338f8080-20240426";function Ky(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ky)}catch(t){console.error(t)}}Ky(),Km.exports=sn;var S1=Km.exports,Yy,Op=S1;Yy=Op.createRoot,Op.hydrateRoot;var Fp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},E1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},Jy={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,p=i>>2,g=(i&3)<<4|l>>4;let m=(l&15)<<2|h>>6,I=h&63;u||(I=64,a||(m=64)),r.push(n[p],n[g],n[m],n[I])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Xy(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):E1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||h==null||g==null)throw new T1;const m=i<<2|l>>4;if(r.push(m),h!==64){const I=l<<4&240|h>>2;if(r.push(I),g!==64){const R=h<<6&192|g;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class T1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const I1=function(t){const e=Xy(t);return Jy.encodeByteArray(e,!0)},Zy=function(t){return I1(t).replace(/\./g,"")},A1=function(t){try{return Jy.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1=()=>C1().__FIREBASE_DEFAULTS__,R1=()=>{if(typeof process>"u"||typeof Fp>"u")return;const t=Fp.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},P1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&A1(t[1]);return e&&JSON.parse(e)},hh=()=>{try{return k1()||R1()||P1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},b1=t=>{var e,n;return(n=(e=hh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},D1=t=>{const e=b1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},e0=()=>{var t;return(t=hh())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M1(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function j1(){var t;const e=(t=hh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function V1(){return!j1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function L1(){try{return typeof indexedDB=="object"}catch{return!1}}function O1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1="FirebaseError";class pi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=F1,Object.setPrototypeOf(this,pi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,t0.prototype.create)}}class t0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?z1(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new pi(s,l,r)}}function z1(t,e){return t.replace(B1,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const B1=/\{\$([^}]+)}/g;function xl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(zp(i)&&zp(a)){if(!xl(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function zp(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tn(t){return t&&t._delegate?t._delegate:t}class si{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new N1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(W1(e))try{this.getOrInitializeService({instanceIdentifier:Jr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Jr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Jr){return this.instances.has(e)}getOptions(e=Jr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Jr){return this.component?this.component.multipleInstances?e:Jr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $1(t){return t===Jr?void 0:t}function W1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new U1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ye||(ye={}));const q1={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},G1=ye.INFO,Q1={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},K1=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Q1[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class n0{constructor(e){this.name=e,this._logLevel=G1,this._logHandler=K1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?q1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}}const Y1=(t,e)=>e.some(n=>t instanceof n);let Bp,Up;function X1(){return Bp||(Bp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function J1(){return Up||(Up=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const r0=new WeakMap,qc=new WeakMap,s0=new WeakMap,Hu=new WeakMap,fh=new WeakMap;function Z1(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(kr(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&r0.set(n,t)}).catch(()=>{}),fh.set(e,t),e}function ew(t){if(qc.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});qc.set(t,e)}let Gc={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return qc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||s0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return kr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tw(t){Gc=t(Gc)}function nw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(qu(this),e,...n);return s0.set(r,e.sort?e.sort():[e]),kr(r)}:J1().includes(t)?function(...e){return t.apply(qu(this),e),kr(r0.get(this))}:function(...e){return kr(t.apply(qu(this),e))}}function rw(t){return typeof t=="function"?nw(t):(t instanceof IDBTransaction&&ew(t),Y1(t,X1())?new Proxy(t,Gc):t)}function kr(t){if(t instanceof IDBRequest)return Z1(t);if(Hu.has(t))return Hu.get(t);const e=rw(t);return e!==t&&(Hu.set(t,e),fh.set(e,t)),e}const qu=t=>fh.get(t);function sw(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=kr(a);return r&&a.addEventListener("upgradeneeded",u=>{r(kr(a.result),u.oldVersion,u.newVersion,kr(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const iw=["get","getKey","getAll","getAllKeys","count"],ow=["put","add","delete","clear"],Gu=new Map;function $p(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Gu.get(e))return Gu.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=ow.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||iw.includes(n)))return;const i=async function(a,...l){const u=this.transaction(a,s?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),s&&u.done]))[0]};return Gu.set(e,i),i}tw(t=>({...t,get:(e,n,r)=>$p(e,n)||t.get(e,n,r),has:(e,n)=>!!$p(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(lw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function lw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Qc="@firebase/app",Wp="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr=new n0("@firebase/app"),uw="@firebase/app-compat",cw="@firebase/analytics-compat",dw="@firebase/analytics",hw="@firebase/app-check-compat",fw="@firebase/app-check",pw="@firebase/auth",mw="@firebase/auth-compat",gw="@firebase/database",yw="@firebase/data-connect",vw="@firebase/database-compat",_w="@firebase/functions",xw="@firebase/functions-compat",ww="@firebase/installations",Sw="@firebase/installations-compat",Ew="@firebase/messaging",Tw="@firebase/messaging-compat",Iw="@firebase/performance",Aw="@firebase/performance-compat",Cw="@firebase/remote-config",kw="@firebase/remote-config-compat",Rw="@firebase/storage",Pw="@firebase/storage-compat",bw="@firebase/firestore",Dw="@firebase/vertexai-preview",Nw="@firebase/firestore-compat",Mw="firebase",jw="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc="[DEFAULT]",Vw={[Qc]:"fire-core",[uw]:"fire-core-compat",[dw]:"fire-analytics",[cw]:"fire-analytics-compat",[fw]:"fire-app-check",[hw]:"fire-app-check-compat",[pw]:"fire-auth",[mw]:"fire-auth-compat",[gw]:"fire-rtdb",[yw]:"fire-data-connect",[vw]:"fire-rtdb-compat",[_w]:"fire-fn",[xw]:"fire-fn-compat",[ww]:"fire-iid",[Sw]:"fire-iid-compat",[Ew]:"fire-fcm",[Tw]:"fire-fcm-compat",[Iw]:"fire-perf",[Aw]:"fire-perf-compat",[Cw]:"fire-rc",[kw]:"fire-rc-compat",[Rw]:"fire-gcs",[Pw]:"fire-gcs-compat",[bw]:"fire-fst",[Nw]:"fire-fst-compat",[Dw]:"fire-vertex","fire-js":"fire-js",[Mw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl=new Map,Lw=new Map,Yc=new Map;function Hp(t,e){try{t.container.addComponent(e)}catch(n){nr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Io(t){const e=t.name;if(Yc.has(e))return nr.debug(`There were multiple attempts to register component ${e}.`),!1;Yc.set(e,t);for(const n of wl.values())Hp(n,t);for(const n of Lw.values())Hp(n,t);return!0}function i0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Rr=new t0("app","Firebase",Ow);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new si("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Rr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw=jw;function o0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Kc,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Rr.create("bad-app-name",{appName:String(s)});if(n||(n=e0()),!n)throw Rr.create("no-options");const i=wl.get(s);if(i){if(xl(n,i.options)&&xl(r,i.config))return i;throw Rr.create("duplicate-app",{appName:s})}const a=new H1(s);for(const u of Yc.values())a.addComponent(u);const l=new Fw(n,r,a);return wl.set(s,l),l}function Bw(t=Kc){const e=wl.get(t);if(!e&&t===Kc&&e0())return o0();if(!e)throw Rr.create("no-app",{appName:t});return e}function Pr(t,e,n){var r;let s=(r=Vw[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),nr.warn(l.join(" "));return}Io(new si(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw="firebase-heartbeat-database",$w=1,Ao="firebase-heartbeat-store";let Qu=null;function a0(){return Qu||(Qu=sw(Uw,$w,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ao)}catch(n){console.warn(n)}}}}).catch(t=>{throw Rr.create("idb-open",{originalErrorMessage:t.message})})),Qu}async function Ww(t){try{const n=(await a0()).transaction(Ao),r=await n.objectStore(Ao).get(l0(t));return await n.done,r}catch(e){if(e instanceof pi)nr.warn(e.message);else{const n=Rr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});nr.warn(n.message)}}}async function qp(t,e){try{const r=(await a0()).transaction(Ao,"readwrite");await r.objectStore(Ao).put(e,l0(t)),await r.done}catch(n){if(n instanceof pi)nr.warn(n.message);else{const r=Rr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});nr.warn(r.message)}}}function l0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw=1024,qw=30*24*60*60*1e3;class Gw{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Kw(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Gp();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=qw}),this._storage.overwrite(this._heartbeatsCache))}catch(r){nr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Gp(),{heartbeatsToSend:r,unsentEntries:s}=Qw(this._heartbeatsCache.heartbeats),i=Zy(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return nr.warn(n),""}}}function Gp(){return new Date().toISOString().substring(0,10)}function Qw(t,e=Hw){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Qp(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Qp(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Kw{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return L1()?O1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Ww(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return qp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return qp(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Qp(t){return Zy(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(t){Io(new si("platform-logger",e=>new aw(e),"PRIVATE")),Io(new si("heartbeat",e=>new Gw(e),"PRIVATE")),Pr(Qc,Wp,t),Pr(Qc,Wp,"esm2017"),Pr("fire-js","")}Yw("");var Xw="firebase",Jw="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pr(Xw,Jw,"app");var Kp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var is,u0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,v){function E(){}E.prototype=v.prototype,w.D=v.prototype,w.prototype=new E,w.prototype.constructor=w,w.C=function(T,_,S){for(var x=Array(arguments.length-2),X=2;X<arguments.length;X++)x[X-2]=arguments[X];return v.prototype[_].apply(T,x)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,v,E){E||(E=0);var T=Array(16);if(typeof v=="string")for(var _=0;16>_;++_)T[_]=v.charCodeAt(E++)|v.charCodeAt(E++)<<8|v.charCodeAt(E++)<<16|v.charCodeAt(E++)<<24;else for(_=0;16>_;++_)T[_]=v[E++]|v[E++]<<8|v[E++]<<16|v[E++]<<24;v=w.g[0],E=w.g[1],_=w.g[2];var S=w.g[3],x=v+(S^E&(_^S))+T[0]+3614090360&4294967295;v=E+(x<<7&4294967295|x>>>25),x=S+(_^v&(E^_))+T[1]+3905402710&4294967295,S=v+(x<<12&4294967295|x>>>20),x=_+(E^S&(v^E))+T[2]+606105819&4294967295,_=S+(x<<17&4294967295|x>>>15),x=E+(v^_&(S^v))+T[3]+3250441966&4294967295,E=_+(x<<22&4294967295|x>>>10),x=v+(S^E&(_^S))+T[4]+4118548399&4294967295,v=E+(x<<7&4294967295|x>>>25),x=S+(_^v&(E^_))+T[5]+1200080426&4294967295,S=v+(x<<12&4294967295|x>>>20),x=_+(E^S&(v^E))+T[6]+2821735955&4294967295,_=S+(x<<17&4294967295|x>>>15),x=E+(v^_&(S^v))+T[7]+4249261313&4294967295,E=_+(x<<22&4294967295|x>>>10),x=v+(S^E&(_^S))+T[8]+1770035416&4294967295,v=E+(x<<7&4294967295|x>>>25),x=S+(_^v&(E^_))+T[9]+2336552879&4294967295,S=v+(x<<12&4294967295|x>>>20),x=_+(E^S&(v^E))+T[10]+4294925233&4294967295,_=S+(x<<17&4294967295|x>>>15),x=E+(v^_&(S^v))+T[11]+2304563134&4294967295,E=_+(x<<22&4294967295|x>>>10),x=v+(S^E&(_^S))+T[12]+1804603682&4294967295,v=E+(x<<7&4294967295|x>>>25),x=S+(_^v&(E^_))+T[13]+4254626195&4294967295,S=v+(x<<12&4294967295|x>>>20),x=_+(E^S&(v^E))+T[14]+2792965006&4294967295,_=S+(x<<17&4294967295|x>>>15),x=E+(v^_&(S^v))+T[15]+1236535329&4294967295,E=_+(x<<22&4294967295|x>>>10),x=v+(_^S&(E^_))+T[1]+4129170786&4294967295,v=E+(x<<5&4294967295|x>>>27),x=S+(E^_&(v^E))+T[6]+3225465664&4294967295,S=v+(x<<9&4294967295|x>>>23),x=_+(v^E&(S^v))+T[11]+643717713&4294967295,_=S+(x<<14&4294967295|x>>>18),x=E+(S^v&(_^S))+T[0]+3921069994&4294967295,E=_+(x<<20&4294967295|x>>>12),x=v+(_^S&(E^_))+T[5]+3593408605&4294967295,v=E+(x<<5&4294967295|x>>>27),x=S+(E^_&(v^E))+T[10]+38016083&4294967295,S=v+(x<<9&4294967295|x>>>23),x=_+(v^E&(S^v))+T[15]+3634488961&4294967295,_=S+(x<<14&4294967295|x>>>18),x=E+(S^v&(_^S))+T[4]+3889429448&4294967295,E=_+(x<<20&4294967295|x>>>12),x=v+(_^S&(E^_))+T[9]+568446438&4294967295,v=E+(x<<5&4294967295|x>>>27),x=S+(E^_&(v^E))+T[14]+3275163606&4294967295,S=v+(x<<9&4294967295|x>>>23),x=_+(v^E&(S^v))+T[3]+4107603335&4294967295,_=S+(x<<14&4294967295|x>>>18),x=E+(S^v&(_^S))+T[8]+1163531501&4294967295,E=_+(x<<20&4294967295|x>>>12),x=v+(_^S&(E^_))+T[13]+2850285829&4294967295,v=E+(x<<5&4294967295|x>>>27),x=S+(E^_&(v^E))+T[2]+4243563512&4294967295,S=v+(x<<9&4294967295|x>>>23),x=_+(v^E&(S^v))+T[7]+1735328473&4294967295,_=S+(x<<14&4294967295|x>>>18),x=E+(S^v&(_^S))+T[12]+2368359562&4294967295,E=_+(x<<20&4294967295|x>>>12),x=v+(E^_^S)+T[5]+4294588738&4294967295,v=E+(x<<4&4294967295|x>>>28),x=S+(v^E^_)+T[8]+2272392833&4294967295,S=v+(x<<11&4294967295|x>>>21),x=_+(S^v^E)+T[11]+1839030562&4294967295,_=S+(x<<16&4294967295|x>>>16),x=E+(_^S^v)+T[14]+4259657740&4294967295,E=_+(x<<23&4294967295|x>>>9),x=v+(E^_^S)+T[1]+2763975236&4294967295,v=E+(x<<4&4294967295|x>>>28),x=S+(v^E^_)+T[4]+1272893353&4294967295,S=v+(x<<11&4294967295|x>>>21),x=_+(S^v^E)+T[7]+4139469664&4294967295,_=S+(x<<16&4294967295|x>>>16),x=E+(_^S^v)+T[10]+3200236656&4294967295,E=_+(x<<23&4294967295|x>>>9),x=v+(E^_^S)+T[13]+681279174&4294967295,v=E+(x<<4&4294967295|x>>>28),x=S+(v^E^_)+T[0]+3936430074&4294967295,S=v+(x<<11&4294967295|x>>>21),x=_+(S^v^E)+T[3]+3572445317&4294967295,_=S+(x<<16&4294967295|x>>>16),x=E+(_^S^v)+T[6]+76029189&4294967295,E=_+(x<<23&4294967295|x>>>9),x=v+(E^_^S)+T[9]+3654602809&4294967295,v=E+(x<<4&4294967295|x>>>28),x=S+(v^E^_)+T[12]+3873151461&4294967295,S=v+(x<<11&4294967295|x>>>21),x=_+(S^v^E)+T[15]+530742520&4294967295,_=S+(x<<16&4294967295|x>>>16),x=E+(_^S^v)+T[2]+3299628645&4294967295,E=_+(x<<23&4294967295|x>>>9),x=v+(_^(E|~S))+T[0]+4096336452&4294967295,v=E+(x<<6&4294967295|x>>>26),x=S+(E^(v|~_))+T[7]+1126891415&4294967295,S=v+(x<<10&4294967295|x>>>22),x=_+(v^(S|~E))+T[14]+2878612391&4294967295,_=S+(x<<15&4294967295|x>>>17),x=E+(S^(_|~v))+T[5]+4237533241&4294967295,E=_+(x<<21&4294967295|x>>>11),x=v+(_^(E|~S))+T[12]+1700485571&4294967295,v=E+(x<<6&4294967295|x>>>26),x=S+(E^(v|~_))+T[3]+2399980690&4294967295,S=v+(x<<10&4294967295|x>>>22),x=_+(v^(S|~E))+T[10]+4293915773&4294967295,_=S+(x<<15&4294967295|x>>>17),x=E+(S^(_|~v))+T[1]+2240044497&4294967295,E=_+(x<<21&4294967295|x>>>11),x=v+(_^(E|~S))+T[8]+1873313359&4294967295,v=E+(x<<6&4294967295|x>>>26),x=S+(E^(v|~_))+T[15]+4264355552&4294967295,S=v+(x<<10&4294967295|x>>>22),x=_+(v^(S|~E))+T[6]+2734768916&4294967295,_=S+(x<<15&4294967295|x>>>17),x=E+(S^(_|~v))+T[13]+1309151649&4294967295,E=_+(x<<21&4294967295|x>>>11),x=v+(_^(E|~S))+T[4]+4149444226&4294967295,v=E+(x<<6&4294967295|x>>>26),x=S+(E^(v|~_))+T[11]+3174756917&4294967295,S=v+(x<<10&4294967295|x>>>22),x=_+(v^(S|~E))+T[2]+718787259&4294967295,_=S+(x<<15&4294967295|x>>>17),x=E+(S^(_|~v))+T[9]+3951481745&4294967295,w.g[0]=w.g[0]+v&4294967295,w.g[1]=w.g[1]+(_+(x<<21&4294967295|x>>>11))&4294967295,w.g[2]=w.g[2]+_&4294967295,w.g[3]=w.g[3]+S&4294967295}r.prototype.u=function(w,v){v===void 0&&(v=w.length);for(var E=v-this.blockSize,T=this.B,_=this.h,S=0;S<v;){if(_==0)for(;S<=E;)s(this,w,S),S+=this.blockSize;if(typeof w=="string"){for(;S<v;)if(T[_++]=w.charCodeAt(S++),_==this.blockSize){s(this,T),_=0;break}}else for(;S<v;)if(T[_++]=w[S++],_==this.blockSize){s(this,T),_=0;break}}this.h=_,this.o+=v},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var v=1;v<w.length-8;++v)w[v]=0;var E=8*this.o;for(v=w.length-8;v<w.length;++v)w[v]=E&255,E/=256;for(this.u(w),w=Array(16),v=E=0;4>v;++v)for(var T=0;32>T;T+=8)w[E++]=this.g[v]>>>T&255;return w};function i(w,v){var E=l;return Object.prototype.hasOwnProperty.call(E,w)?E[w]:E[w]=v(w)}function a(w,v){this.h=v;for(var E=[],T=!0,_=w.length-1;0<=_;_--){var S=w[_]|0;T&&S==v||(E[_]=S,T=!1)}this.g=E}var l={};function u(w){return-128<=w&&128>w?i(w,function(v){return new a([v|0],0>v?-1:0)}):new a([w|0],0>w?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return g;if(0>w)return O(h(-w));for(var v=[],E=1,T=0;w>=E;T++)v[T]=w/E|0,E*=4294967296;return new a(v,0)}function p(w,v){if(w.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(w.charAt(0)=="-")return O(p(w.substring(1),v));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=h(Math.pow(v,8)),T=g,_=0;_<w.length;_+=8){var S=Math.min(8,w.length-_),x=parseInt(w.substring(_,_+S),v);8>S?(S=h(Math.pow(v,S)),T=T.j(S).add(h(x))):(T=T.j(E),T=T.add(h(x)))}return T}var g=u(0),m=u(1),I=u(16777216);t=a.prototype,t.m=function(){if(P(this))return-O(this).m();for(var w=0,v=1,E=0;E<this.g.length;E++){var T=this.i(E);w+=(0<=T?T:4294967296+T)*v,v*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(R(this))return"0";if(P(this))return"-"+O(this).toString(w);for(var v=h(Math.pow(w,6)),E=this,T="";;){var _=N(E,v).g;E=k(E,_.j(v));var S=((0<E.g.length?E.g[0]:E.h)>>>0).toString(w);if(E=_,R(E))return S+T;for(;6>S.length;)S="0"+S;T=S+T}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function R(w){if(w.h!=0)return!1;for(var v=0;v<w.g.length;v++)if(w.g[v]!=0)return!1;return!0}function P(w){return w.h==-1}t.l=function(w){return w=k(this,w),P(w)?-1:R(w)?0:1};function O(w){for(var v=w.g.length,E=[],T=0;T<v;T++)E[T]=~w.g[T];return new a(E,~w.h).add(m)}t.abs=function(){return P(this)?O(this):this},t.add=function(w){for(var v=Math.max(this.g.length,w.g.length),E=[],T=0,_=0;_<=v;_++){var S=T+(this.i(_)&65535)+(w.i(_)&65535),x=(S>>>16)+(this.i(_)>>>16)+(w.i(_)>>>16);T=x>>>16,S&=65535,x&=65535,E[_]=x<<16|S}return new a(E,E[E.length-1]&-2147483648?-1:0)};function k(w,v){return w.add(O(v))}t.j=function(w){if(R(this)||R(w))return g;if(P(this))return P(w)?O(this).j(O(w)):O(O(this).j(w));if(P(w))return O(this.j(O(w)));if(0>this.l(I)&&0>w.l(I))return h(this.m()*w.m());for(var v=this.g.length+w.g.length,E=[],T=0;T<2*v;T++)E[T]=0;for(T=0;T<this.g.length;T++)for(var _=0;_<w.g.length;_++){var S=this.i(T)>>>16,x=this.i(T)&65535,X=w.i(_)>>>16,ee=w.i(_)&65535;E[2*T+2*_]+=x*ee,A(E,2*T+2*_),E[2*T+2*_+1]+=S*ee,A(E,2*T+2*_+1),E[2*T+2*_+1]+=x*X,A(E,2*T+2*_+1),E[2*T+2*_+2]+=S*X,A(E,2*T+2*_+2)}for(T=0;T<v;T++)E[T]=E[2*T+1]<<16|E[2*T];for(T=v;T<2*v;T++)E[T]=0;return new a(E,0)};function A(w,v){for(;(w[v]&65535)!=w[v];)w[v+1]+=w[v]>>>16,w[v]&=65535,v++}function C(w,v){this.g=w,this.h=v}function N(w,v){if(R(v))throw Error("division by zero");if(R(w))return new C(g,g);if(P(w))return v=N(O(w),v),new C(O(v.g),O(v.h));if(P(v))return v=N(w,O(v)),new C(O(v.g),v.h);if(30<w.g.length){if(P(w)||P(v))throw Error("slowDivide_ only works with positive integers.");for(var E=m,T=v;0>=T.l(w);)E=V(E),T=V(T);var _=F(E,1),S=F(T,1);for(T=F(T,2),E=F(E,2);!R(T);){var x=S.add(T);0>=x.l(w)&&(_=_.add(E),S=x),T=F(T,1),E=F(E,1)}return v=k(w,_.j(v)),new C(_,v)}for(_=g;0<=w.l(v);){for(E=Math.max(1,Math.floor(w.m()/v.m())),T=Math.ceil(Math.log(E)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),S=h(E),x=S.j(v);P(x)||0<x.l(w);)E-=T,S=h(E),x=S.j(v);R(S)&&(S=m),_=_.add(S),w=k(w,x)}return new C(_,w)}t.A=function(w){return N(this,w).h},t.and=function(w){for(var v=Math.max(this.g.length,w.g.length),E=[],T=0;T<v;T++)E[T]=this.i(T)&w.i(T);return new a(E,this.h&w.h)},t.or=function(w){for(var v=Math.max(this.g.length,w.g.length),E=[],T=0;T<v;T++)E[T]=this.i(T)|w.i(T);return new a(E,this.h|w.h)},t.xor=function(w){for(var v=Math.max(this.g.length,w.g.length),E=[],T=0;T<v;T++)E[T]=this.i(T)^w.i(T);return new a(E,this.h^w.h)};function V(w){for(var v=w.g.length+1,E=[],T=0;T<v;T++)E[T]=w.i(T)<<1|w.i(T-1)>>>31;return new a(E,w.h)}function F(w,v){var E=v>>5;v%=32;for(var T=w.g.length-E,_=[],S=0;S<T;S++)_[S]=0<v?w.i(S+E)>>>v|w.i(S+E+1)<<32-v:w.i(S+E);return new a(_,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,u0=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,is=a}).apply(typeof Kp<"u"?Kp:typeof self<"u"?self:typeof window<"u"?window:{});var Ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var c0,$i,d0,Ha,Xc,h0,f0,p0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,f){return o==Array.prototype||o==Object.prototype||(o[c]=f.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ra=="object"&&Ra];for(var c=0;c<o.length;++c){var f=o[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(o,c){if(c)e:{var f=r;o=o.split(".");for(var y=0;y<o.length-1;y++){var b=o[y];if(!(b in f))break e;f=f[b]}o=o[o.length-1],y=f[o],c=c(y),c!=y&&c!=null&&e(f,o,{configurable:!0,writable:!0,value:c})}}function i(o,c){o instanceof String&&(o+="");var f=0,y=!1,b={next:function(){if(!y&&f<o.length){var M=f++;return{value:c(M,o[M]),done:!1}}return y=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}s("Array.prototype.values",function(o){return o||function(){return i(this,function(c,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function h(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function p(o,c,f){return o.call.apply(o.bind,arguments)}function g(o,c,f){if(!o)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,y),o.apply(c,b)}}return function(){return o.apply(c,arguments)}}function m(o,c,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,m.apply(null,arguments)}function I(o,c){var f=Array.prototype.slice.call(arguments,1);return function(){var y=f.slice();return y.push.apply(y,arguments),o.apply(this,y)}}function R(o,c){function f(){}f.prototype=c.prototype,o.aa=c.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(y,b,M){for(var Q=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)Q[Ie-2]=arguments[Ie];return c.prototype[b].apply(y,Q)}}function P(o){const c=o.length;if(0<c){const f=Array(c);for(let y=0;y<c;y++)f[y]=o[y];return f}return[]}function O(o,c){for(let f=1;f<arguments.length;f++){const y=arguments[f];if(u(y)){const b=o.length||0,M=y.length||0;o.length=b+M;for(let Q=0;Q<M;Q++)o[b+Q]=y[Q]}else o.push(y)}}class k{constructor(c,f){this.i=c,this.j=f,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function A(o){return/^[\s\xa0]*$/.test(o)}function C(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function N(o){return N[" "](o),o}N[" "]=function(){};var V=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function F(o,c,f){for(const y in o)c.call(f,o[y],y,o)}function w(o,c){for(const f in o)c.call(void 0,o[f],f,o)}function v(o){const c={};for(const f in o)c[f]=o[f];return c}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(o,c){let f,y;for(let b=1;b<arguments.length;b++){y=arguments[b];for(f in y)o[f]=y[f];for(let M=0;M<E.length;M++)f=E[M],Object.prototype.hasOwnProperty.call(y,f)&&(o[f]=y[f])}}function _(o){var c=1;o=o.split(":");const f=[];for(;0<c&&o.length;)f.push(o.shift()),c--;return o.length&&f.push(o.join(":")),f}function S(o){l.setTimeout(()=>{throw o},0)}function x(){var o=z;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class X{constructor(){this.h=this.g=null}add(c,f){const y=ee.get();y.set(c,f),this.h?this.h.next=y:this.g=y,this.h=y}}var ee=new k(()=>new Y,o=>o.reset());class Y{constructor(){this.next=this.g=this.h=null}set(c,f){this.h=c,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let B,D=!1,z=new X,L=()=>{const o=l.Promise.resolve(void 0);B=()=>{o.then(W)}};var W=()=>{for(var o;o=x();){try{o.h.call(o.g)}catch(f){S(f)}var c=ee;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}D=!1};function J(){this.s=this.s,this.C=this.C}J.prototype.s=!1,J.prototype.ma=function(){this.s||(this.s=!0,this.N())},J.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ie(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}ie.prototype.h=function(){this.defaultPrevented=!0};var Ae=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};l.addEventListener("test",f,c),l.removeEventListener("test",f,c)}catch{}return o}();function we(o,c){if(ie.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,y=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(V){e:{try{N(c.nodeName);var b=!0;break e}catch{}b=!1}b||(c=null)}}else f=="mouseover"?c=o.fromElement:f=="mouseout"&&(c=o.toElement);this.relatedTarget=c,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:he[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&we.aa.h.call(this)}}R(we,ie);var he={2:"touch",3:"pen",4:"mouse"};we.prototype.h=function(){we.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),Fe=0;function Se(o,c,f,y,b){this.listener=o,this.proxy=null,this.src=c,this.type=f,this.capture=!!y,this.ha=b,this.key=++Fe,this.da=this.fa=!1}function ne(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Ce(o){this.src=o,this.g={},this.h=0}Ce.prototype.add=function(o,c,f,y,b){var M=o.toString();o=this.g[M],o||(o=this.g[M]=[],this.h++);var Q=ke(o,c,y,b);return-1<Q?(c=o[Q],f||(c.fa=!1)):(c=new Se(c,this.src,M,!!y,b),c.fa=f,o.push(c)),c};function be(o,c){var f=c.type;if(f in o.g){var y=o.g[f],b=Array.prototype.indexOf.call(y,c,void 0),M;(M=0<=b)&&Array.prototype.splice.call(y,b,1),M&&(ne(c),o.g[f].length==0&&(delete o.g[f],o.h--))}}function ke(o,c,f,y){for(var b=0;b<o.length;++b){var M=o[b];if(!M.da&&M.listener==c&&M.capture==!!f&&M.ha==y)return b}return-1}var _t="closure_lm_"+(1e6*Math.random()|0),Wt={};function Ht(o,c,f,y,b){if(Array.isArray(c)){for(var M=0;M<c.length;M++)Ht(o,c[M],f,y,b);return null}return f=Qo(f),o&&o[de]?o.K(c,f,h(y)?!!y.capture:!1,b):qt(o,c,f,!1,y,b)}function qt(o,c,f,y,b,M){if(!c)throw Error("Invalid event type");var Q=h(b)?!!b.capture:!!b,Ie=Re(o);if(Ie||(o[_t]=Ie=new Ce(o)),f=Ie.add(c,f,y,Q,M),f.proxy)return f;if(y=Gt(),f.proxy=y,y.src=o,y.listener=f,o.addEventListener)Ae||(b=Q),b===void 0&&(b=!1),o.addEventListener(c.toString(),y,b);else if(o.attachEvent)o.attachEvent(An(c.toString()),y);else if(o.addListener&&o.removeListener)o.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Gt(){function o(f){return c.call(o.src,o.listener,f)}const c=ar;return o}function Qt(o,c,f,y,b){if(Array.isArray(c))for(var M=0;M<c.length;M++)Qt(o,c[M],f,y,b);else y=h(y)?!!y.capture:!!y,f=Qo(f),o&&o[de]?(o=o.i,c=String(c).toString(),c in o.g&&(M=o.g[c],f=ke(M,f,y,b),-1<f&&(ne(M[f]),Array.prototype.splice.call(M,f,1),M.length==0&&(delete o.g[c],o.h--)))):o&&(o=Re(o))&&(c=o.g[c.toString()],o=-1,c&&(o=ke(c,f,y,b)),(f=-1<o?c[o]:null)&&or(f))}function or(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[de])be(c.i,o);else{var f=o.type,y=o.proxy;c.removeEventListener?c.removeEventListener(f,y,o.capture):c.detachEvent?c.detachEvent(An(f),y):c.addListener&&c.removeListener&&c.removeListener(y),(f=Re(c))?(be(f,o),f.h==0&&(f.src=null,c[_t]=null)):ne(o)}}}function An(o){return o in Wt?Wt[o]:Wt[o]="on"+o}function ar(o,c){if(o.da)o=!0;else{c=new we(c,this);var f=o.listener,y=o.ha||o.src;o.fa&&or(o),o=f.call(y,c)}return o}function Re(o){return o=o[_t],o instanceof Ce?o:null}var _i="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qo(o){return typeof o=="function"?o:(o[_i]||(o[_i]=function(c){return o.handleEvent(c)}),o[_i])}function st(){J.call(this),this.i=new Ce(this),this.M=this,this.F=null}R(st,J),st.prototype[de]=!0,st.prototype.removeEventListener=function(o,c,f,y){Qt(this,o,c,f,y)};function Ze(o,c){var f,y=o.F;if(y)for(f=[];y;y=y.F)f.push(y);if(o=o.M,y=c.type||c,typeof c=="string")c=new ie(c,o);else if(c instanceof ie)c.target=c.target||o;else{var b=c;c=new ie(y,o),T(c,b)}if(b=!0,f)for(var M=f.length-1;0<=M;M--){var Q=c.g=f[M];b=Br(Q,y,!0,c)&&b}if(Q=c.g=o,b=Br(Q,y,!0,c)&&b,b=Br(Q,y,!1,c)&&b,f)for(M=0;M<f.length;M++)Q=c.g=f[M],b=Br(Q,y,!1,c)&&b}st.prototype.N=function(){if(st.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var f=o.g[c],y=0;y<f.length;y++)ne(f[y]);delete o.g[c],o.h--}}this.F=null},st.prototype.K=function(o,c,f,y){return this.i.add(String(o),c,!1,f,y)},st.prototype.L=function(o,c,f,y){return this.i.add(String(o),c,!0,f,y)};function Br(o,c,f,y){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var b=!0,M=0;M<c.length;++M){var Q=c[M];if(Q&&!Q.da&&Q.capture==f){var Ie=Q.listener,dt=Q.ha||Q.src;Q.fa&&be(o.i,Q),b=Ie.call(dt,y)!==!1&&b}}return b&&!y.defaultPrevented}function xi(o,c,f){if(typeof o=="function")f&&(o=m(o,f));else if(o&&typeof o.handleEvent=="function")o=m(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(o,c||0)}function Ko(o){o.g=xi(()=>{o.g=null,o.i&&(o.i=!1,Ko(o))},o.l);const c=o.h;o.h=null,o.m.apply(null,c)}class me extends J{constructor(c,f){super(),this.m=c,this.l=f,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Ko(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Cn(o){J.call(this),this.h=o,this.g={}}R(Cn,J);var Ur=[];function _s(o){F(o.g,function(c,f){this.g.hasOwnProperty(f)&&or(c)},o),o.g={}}Cn.prototype.N=function(){Cn.aa.N.call(this),_s(this)},Cn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Yo=l.JSON.stringify,Xo=l.JSON.parse,uu=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function xs(){}xs.prototype.h=null;function ws(o){return o.h||(o.h=o.i())}function lr(){}var Fn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ss(){ie.call(this,"d")}R(Ss,ie);function kn(){ie.call(this,"c")}R(kn,ie);var xt={},Jo=null;function $r(){return Jo=Jo||new st}xt.La="serverreachability";function wi(o){ie.call(this,xt.La,o)}R(wi,ie);function ur(o){const c=$r();Ze(c,new wi(c))}xt.STAT_EVENT="statevent";function Es(o,c){ie.call(this,xt.STAT_EVENT,o),this.stat=c}R(Es,ie);function it(o){const c=$r();Ze(c,new Es(c,o))}xt.Ma="timingevent";function zn(o,c){ie.call(this,xt.Ma,o),this.size=c}R(zn,ie);function Wr(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},c)}function Kt(){this.g=!0}Kt.prototype.xa=function(){this.g=!1};function cu(o,c,f,y,b,M){o.info(function(){if(o.g)if(M)for(var Q="",Ie=M.split("&"),dt=0;dt<Ie.length;dt++){var _e=Ie[dt].split("=");if(1<_e.length){var St=_e[0];_e=_e[1];var Et=St.split("_");Q=2<=Et.length&&Et[1]=="type"?Q+(St+"="+_e+"&"):Q+(St+"=redacted&")}}else Q=null;else Q=M;return"XMLHTTP REQ ("+y+") [attempt "+b+"]: "+c+`
`+f+`
`+Q})}function K(o,c,f,y,b,M,Q){o.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+b+"]: "+c+`
`+f+`
`+M+" "+Q})}function q(o,c,f,y){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+oe(o,f)+(y?" "+y:"")})}function G(o,c){o.info(function(){return"TIMEOUT: "+c})}Kt.prototype.info=function(){};function oe(o,c){if(!o.g)return c;if(!c)return null;try{var f=JSON.parse(c);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var y=f[o];if(!(2>y.length)){var b=y[1];if(Array.isArray(b)&&!(1>b.length)){var M=b[0];if(M!="noop"&&M!="stop"&&M!="close")for(var Q=1;Q<b.length;Q++)b[Q]=""}}}}return Yo(f)}catch{return c}}var De={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ot={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ct;function wt(){}R(wt,xs),wt.prototype.g=function(){return new XMLHttpRequest},wt.prototype.i=function(){return{}},ct=new wt;function ze(o,c,f,y){this.j=o,this.i=c,this.l=f,this.R=y||1,this.U=new Cn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new bt}function bt(){this.i=null,this.g="",this.h=!1}var Rn={},Si={};function Hr(o,c,f){o.L=1,o.v=ra(Bn(c)),o.m=f,o.P=!0,Yt(o,null)}function Yt(o,c){o.F=Date.now(),ae(o),o.A=Bn(o.v);var f=o.A,y=o.R;Array.isArray(y)||(y=[String(y)]),lf(f.i,"t",y),o.C=0,f=o.j.J,o.h=new bt,o.g=Af(o.j,f?c:null,!o.m),0<o.O&&(o.M=new me(m(o.Y,o,o.g),o.O)),c=o.U,f=o.g,y=o.ca;var b="readystatechange";Array.isArray(b)||(b&&(Ur[0]=b.toString()),b=Ur);for(var M=0;M<b.length;M++){var Q=Ht(f,b[M],y||c.handleEvent,!1,c.h||c);if(!Q)break;c.g[Q.key]=Q}c=o.H?v(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),ur(),cu(o.i,o.u,o.A,o.l,o.R,o.m)}ze.prototype.ca=function(o){o=o.target;const c=this.M;c&&Un(o)==3?c.j():this.Y(o)},ze.prototype.Y=function(o){try{if(o==this.g)e:{const Et=Un(this.g);var c=this.g.Ba();const As=this.g.Z();if(!(3>Et)&&(Et!=3||this.g&&(this.h.h||this.g.oa()||mf(this.g)))){this.J||Et!=4||c==7||(c==8||0>=As?ur(3):ur(2)),Xt(this);var f=this.g.Z();this.X=f;t:if(Zo(this)){var y=mf(this.g);o="";var b=y.length,M=Un(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gr(this),qr(this);var Q="";break t}this.h.i=new l.TextDecoder}for(c=0;c<b;c++)this.h.h=!0,o+=this.h.i.decode(y[c],{stream:!(M&&c==b-1)});y.length=0,this.h.g+=o,this.C=0,Q=this.h.g}else Q=this.g.oa();if(this.o=f==200,K(this.i,this.u,this.A,this.l,this.R,Et,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ie,dt=this.g;if((Ie=dt.g?dt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(Ie)){var _e=Ie;break t}}_e=null}if(f=_e)q(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,du(this,f);else{this.o=!1,this.s=3,it(12),Gr(this),qr(this);break e}}if(this.P){f=!0;let gn;for(;!this.J&&this.C<Q.length;)if(gn=ea(this,Q),gn==Si){Et==4&&(this.s=4,it(14),f=!1),q(this.i,this.l,null,"[Incomplete Response]");break}else if(gn==Rn){this.s=4,it(15),q(this.i,this.l,Q,"[Invalid Chunk]"),f=!1;break}else q(this.i,this.l,gn,null),du(this,gn);if(Zo(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Et!=4||Q.length!=0||this.h.h||(this.s=1,it(16),f=!1),this.o=this.o&&f,!f)q(this.i,this.l,Q,"[Invalid Chunked Response]"),Gr(this),qr(this);else if(0<Q.length&&!this.W){this.W=!0;var St=this.j;St.g==this&&St.ba&&!St.M&&(St.j.info("Great, no buffering proxy detected. Bytes received: "+Q.length),yu(St),St.M=!0,it(11))}}else q(this.i,this.l,Q,null),du(this,Q);Et==4&&Gr(this),this.o&&!this.J&&(Et==4?Sf(this.j,this):(this.o=!1,ae(this)))}else Kv(this.g),f==400&&0<Q.indexOf("Unknown SID")?(this.s=3,it(12)):(this.s=0,it(13)),Gr(this),qr(this)}}}catch{}finally{}};function Zo(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function ea(o,c){var f=o.C,y=c.indexOf(`
`,f);return y==-1?Si:(f=Number(c.substring(f,y)),isNaN(f)?Rn:(y+=1,y+f>c.length?Si:(c=c.slice(y,y+f),o.C=y+f,c)))}ze.prototype.cancel=function(){this.J=!0,Gr(this)};function ae(o){o.S=Date.now()+o.I,et(o,o.I)}function et(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Wr(m(o.ba,o),c)}function Xt(o){o.B&&(l.clearTimeout(o.B),o.B=null)}ze.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(G(this.i,this.A),this.L!=2&&(ur(),it(17)),Gr(this),this.s=2,qr(this)):et(this,this.S-o)};function qr(o){o.j.G==0||o.J||Sf(o.j,o)}function Gr(o){Xt(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,_s(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function du(o,c){try{var f=o.j;if(f.G!=0&&(f.g==o||hu(f.h,o))){if(!o.K&&hu(f.h,o)&&f.G==3){try{var y=f.Da.g.parse(c)}catch{y=null}if(Array.isArray(y)&&y.length==3){var b=y;if(b[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)ua(f),aa(f);else break e;gu(f),it(18)}}else f.za=b[1],0<f.za-f.T&&37500>b[2]&&f.F&&f.v==0&&!f.C&&(f.C=Wr(m(f.Za,f),6e3));if(1>=Jh(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Kr(f,11)}else if((o.K||f.g==o)&&ua(f),!A(c))for(b=f.Da.g.parse(c),c=0;c<b.length;c++){let _e=b[c];if(f.T=_e[0],_e=_e[1],f.G==2)if(_e[0]=="c"){f.K=_e[1],f.ia=_e[2];const St=_e[3];St!=null&&(f.la=St,f.j.info("VER="+f.la));const Et=_e[4];Et!=null&&(f.Aa=Et,f.j.info("SVER="+f.Aa));const As=_e[5];As!=null&&typeof As=="number"&&0<As&&(y=1.5*As,f.L=y,f.j.info("backChannelRequestTimeoutMs_="+y)),y=f;const gn=o.g;if(gn){const da=gn.g?gn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(da){var M=y.h;M.g||da.indexOf("spdy")==-1&&da.indexOf("quic")==-1&&da.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(fu(M,M.h),M.h=null))}if(y.D){const vu=gn.g?gn.g.getResponseHeader("X-HTTP-Session-Id"):null;vu&&(y.ya=vu,Ne(y.I,y.D,vu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),y=f;var Q=o;if(y.qa=If(y,y.J?y.ia:null,y.W),Q.K){Zh(y.h,Q);var Ie=Q,dt=y.L;dt&&(Ie.I=dt),Ie.B&&(Xt(Ie),ae(Ie)),y.g=Q}else xf(y);0<f.i.length&&la(f)}else _e[0]!="stop"&&_e[0]!="close"||Kr(f,7);else f.G==3&&(_e[0]=="stop"||_e[0]=="close"?_e[0]=="stop"?Kr(f,7):mu(f):_e[0]!="noop"&&f.l&&f.l.ta(_e),f.v=0)}}ur(4)}catch{}}var Nv=class{constructor(o,c){this.g=o,this.map=c}};function Yh(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xh(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Jh(o){return o.h?1:o.g?o.g.size:0}function hu(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function fu(o,c){o.g?o.g.add(c):o.h=c}function Zh(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Yh.prototype.cancel=function(){if(this.i=ef(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function ef(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(const f of o.g.values())c=c.concat(f.D);return c}return P(o.i)}function Mv(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var c=[],f=o.length,y=0;y<f;y++)c.push(o[y]);return c}c=[],f=0;for(y in o)c[f++]=o[y];return c}function jv(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var c=[];o=o.length;for(var f=0;f<o;f++)c.push(f);return c}c=[],f=0;for(const y in o)c[f++]=y;return c}}}function tf(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var f=jv(o),y=Mv(o),b=y.length,M=0;M<b;M++)c.call(void 0,y[M],f&&f[M],o)}var nf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vv(o,c){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var y=o[f].indexOf("="),b=null;if(0<=y){var M=o[f].substring(0,y);b=o[f].substring(y+1)}else M=o[f];c(M,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function Qr(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Qr){this.h=o.h,ta(this,o.j),this.o=o.o,this.g=o.g,na(this,o.s),this.l=o.l;var c=o.i,f=new Ii;f.i=c.i,c.g&&(f.g=new Map(c.g),f.h=c.h),rf(this,f),this.m=o.m}else o&&(c=String(o).match(nf))?(this.h=!1,ta(this,c[1]||"",!0),this.o=Ei(c[2]||""),this.g=Ei(c[3]||"",!0),na(this,c[4]),this.l=Ei(c[5]||"",!0),rf(this,c[6]||"",!0),this.m=Ei(c[7]||"")):(this.h=!1,this.i=new Ii(null,this.h))}Qr.prototype.toString=function(){var o=[],c=this.j;c&&o.push(Ti(c,sf,!0),":");var f=this.g;return(f||c=="file")&&(o.push("//"),(c=this.o)&&o.push(Ti(c,sf,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(Ti(f,f.charAt(0)=="/"?Fv:Ov,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",Ti(f,Bv)),o.join("")};function Bn(o){return new Qr(o)}function ta(o,c,f){o.j=f?Ei(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function na(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function rf(o,c,f){c instanceof Ii?(o.i=c,Uv(o.i,o.h)):(f||(c=Ti(c,zv)),o.i=new Ii(c,o.h))}function Ne(o,c,f){o.i.set(c,f)}function ra(o){return Ne(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Ei(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Ti(o,c,f){return typeof o=="string"?(o=encodeURI(o).replace(c,Lv),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Lv(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var sf=/[#\/\?@]/g,Ov=/[#\?:]/g,Fv=/[#\?]/g,zv=/[#\?@]/g,Bv=/#/g;function Ii(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function cr(o){o.g||(o.g=new Map,o.h=0,o.i&&Vv(o.i,function(c,f){o.add(decodeURIComponent(c.replace(/\+/g," ")),f)}))}t=Ii.prototype,t.add=function(o,c){cr(this),this.i=null,o=Ts(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(c),this.h+=1,this};function of(o,c){cr(o),c=Ts(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function af(o,c){return cr(o),c=Ts(o,c),o.g.has(c)}t.forEach=function(o,c){cr(this),this.g.forEach(function(f,y){f.forEach(function(b){o.call(c,b,y,this)},this)},this)},t.na=function(){cr(this);const o=Array.from(this.g.values()),c=Array.from(this.g.keys()),f=[];for(let y=0;y<c.length;y++){const b=o[y];for(let M=0;M<b.length;M++)f.push(c[y])}return f},t.V=function(o){cr(this);let c=[];if(typeof o=="string")af(this,o)&&(c=c.concat(this.g.get(Ts(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)c=c.concat(o[f])}return c},t.set=function(o,c){return cr(this),this.i=null,o=Ts(this,o),af(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},t.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function lf(o,c,f){of(o,c),0<f.length&&(o.i=null,o.g.set(Ts(o,c),P(f)),o.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],c=Array.from(this.g.keys());for(var f=0;f<c.length;f++){var y=c[f];const M=encodeURIComponent(String(y)),Q=this.V(y);for(y=0;y<Q.length;y++){var b=M;Q[y]!==""&&(b+="="+encodeURIComponent(String(Q[y]))),o.push(b)}}return this.i=o.join("&")};function Ts(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function Uv(o,c){c&&!o.j&&(cr(o),o.i=null,o.g.forEach(function(f,y){var b=y.toLowerCase();y!=b&&(of(this,y),lf(this,b,f))},o)),o.j=c}function $v(o,c){const f=new Kt;if(l.Image){const y=new Image;y.onload=I(dr,f,"TestLoadImage: loaded",!0,c,y),y.onerror=I(dr,f,"TestLoadImage: error",!1,c,y),y.onabort=I(dr,f,"TestLoadImage: abort",!1,c,y),y.ontimeout=I(dr,f,"TestLoadImage: timeout",!1,c,y),l.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=o}else c(!1)}function Wv(o,c){const f=new Kt,y=new AbortController,b=setTimeout(()=>{y.abort(),dr(f,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:y.signal}).then(M=>{clearTimeout(b),M.ok?dr(f,"TestPingServer: ok",!0,c):dr(f,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(b),dr(f,"TestPingServer: error",!1,c)})}function dr(o,c,f,y,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),y(f)}catch{}}function Hv(){this.g=new uu}function qv(o,c,f){const y=f||"";try{tf(o,function(b,M){let Q=b;h(b)&&(Q=Yo(b)),c.push(y+M+"="+encodeURIComponent(Q))})}catch(b){throw c.push(y+"type="+encodeURIComponent("_badmap")),b}}function sa(o){this.l=o.Ub||null,this.j=o.eb||!1}R(sa,xs),sa.prototype.g=function(){return new ia(this.l,this.j)},sa.prototype.i=function(o){return function(){return o}}({});function ia(o,c){st.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(ia,st),t=ia.prototype,t.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,Ci(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ai(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Ci(this)),this.g&&(this.readyState=3,Ci(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;uf(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function uf(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Ai(this):Ci(this),this.readyState==3&&uf(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,Ai(this))},t.Qa=function(o){this.g&&(this.response=o,Ai(this))},t.ga=function(){this.g&&Ai(this)};function Ai(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Ci(o)}t.setRequestHeader=function(o,c){this.u.append(o,c)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],c=this.h.entries();for(var f=c.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=c.next();return o.join(`\r
`)};function Ci(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(ia.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function cf(o){let c="";return F(o,function(f,y){c+=y,c+=":",c+=f,c+=`\r
`}),c}function pu(o,c,f){e:{for(y in f){var y=!1;break e}y=!0}y||(f=cf(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):Ne(o,c,f))}function He(o){st.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(He,st);var Gv=/^https?$/i,Qv=["POST","PUT"];t=He.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,c,f,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ct.g(),this.v=this.o?ws(this.o):ws(ct),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(M){df(this,M);return}if(o=f||"",f=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var b in y)f.set(b,y[b]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const M of y.keys())f.set(M,y.get(M));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(f.keys()).find(M=>M.toLowerCase()=="content-type"),b=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Qv,c,void 0))||y||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,Q]of f)this.g.setRequestHeader(M,Q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{pf(this),this.u=!0,this.g.send(o),this.u=!1}catch(M){df(this,M)}};function df(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,hf(o),oa(o)}function hf(o){o.A||(o.A=!0,Ze(o,"complete"),Ze(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Ze(this,"complete"),Ze(this,"abort"),oa(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),oa(this,!0)),He.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ff(this):this.bb())},t.bb=function(){ff(this)};function ff(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Un(o)!=4||o.Z()!=2)){if(o.u&&Un(o)==4)xi(o.Ea,0,o);else if(Ze(o,"readystatechange"),Un(o)==4){o.h=!1;try{const Q=o.Z();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var f;if(!(f=c)){var y;if(y=Q===0){var b=String(o.D).match(nf)[1]||null;!b&&l.self&&l.self.location&&(b=l.self.location.protocol.slice(0,-1)),y=!Gv.test(b?b.toLowerCase():"")}f=y}if(f)Ze(o,"complete"),Ze(o,"success");else{o.m=6;try{var M=2<Un(o)?o.g.statusText:""}catch{M=""}o.l=M+" ["+o.Z()+"]",hf(o)}}finally{oa(o)}}}}function oa(o,c){if(o.g){pf(o);const f=o.g,y=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||Ze(o,"ready");try{f.onreadystatechange=y}catch{}}}function pf(o){o.I&&(l.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function Un(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<Un(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),Xo(c)}};function mf(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Kv(o){const c={};o=(o.g&&2<=Un(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<o.length;y++){if(A(o[y]))continue;var f=_(o[y]);const b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const M=c[b]||[];c[b]=M,M.push(f)}w(c,function(y){return y.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ki(o,c,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||c}function gf(o){this.Aa=0,this.i=[],this.j=new Kt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ki("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ki("baseRetryDelayMs",5e3,o),this.cb=ki("retryDelaySeedMs",1e4,o),this.Wa=ki("forwardChannelMaxRetries",2,o),this.wa=ki("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Yh(o&&o.concurrentRequestLimit),this.Da=new Hv,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=gf.prototype,t.la=8,t.G=1,t.connect=function(o,c,f,y){it(0),this.W=o,this.H=c||{},f&&y!==void 0&&(this.H.OSID=f,this.H.OAID=y),this.F=this.X,this.I=If(this,null,this.W),la(this)};function mu(o){if(yf(o),o.G==3){var c=o.U++,f=Bn(o.I);if(Ne(f,"SID",o.K),Ne(f,"RID",c),Ne(f,"TYPE","terminate"),Ri(o,f),c=new ze(o,o.j,c),c.L=2,c.v=ra(Bn(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=c.v,f=!0),f||(c.g=Af(c.j,null),c.g.ea(c.v)),c.F=Date.now(),ae(c)}Tf(o)}function aa(o){o.g&&(yu(o),o.g.cancel(),o.g=null)}function yf(o){aa(o),o.u&&(l.clearTimeout(o.u),o.u=null),ua(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function la(o){if(!Xh(o.h)&&!o.s){o.s=!0;var c=o.Ga;B||L(),D||(B(),D=!0),z.add(c,o),o.B=0}}function Yv(o,c){return Jh(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Wr(m(o.Ga,o,c),Ef(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const b=new ze(this,this.j,o);let M=this.o;if(this.S&&(M?(M=v(M),T(M,this.S)):M=this.S),this.m!==null||this.O||(b.H=M,M=null),this.P)e:{for(var c=0,f=0;f<this.i.length;f++){t:{var y=this.i[f];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(c+=y,4096<c){c=f;break e}if(c===4096||f===this.i.length-1){c=f+1;break e}}c=1e3}else c=1e3;c=_f(this,b,c),f=Bn(this.I),Ne(f,"RID",o),Ne(f,"CVER",22),this.D&&Ne(f,"X-HTTP-Session-Id",this.D),Ri(this,f),M&&(this.O?c="headers="+encodeURIComponent(String(cf(M)))+"&"+c:this.m&&pu(f,this.m,M)),fu(this.h,b),this.Ua&&Ne(f,"TYPE","init"),this.P?(Ne(f,"$req",c),Ne(f,"SID","null"),b.T=!0,Hr(b,f,null)):Hr(b,f,c),this.G=2}}else this.G==3&&(o?vf(this,o):this.i.length==0||Xh(this.h)||vf(this))};function vf(o,c){var f;c?f=c.l:f=o.U++;const y=Bn(o.I);Ne(y,"SID",o.K),Ne(y,"RID",f),Ne(y,"AID",o.T),Ri(o,y),o.m&&o.o&&pu(y,o.m,o.o),f=new ze(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),c&&(o.i=c.D.concat(o.i)),c=_f(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),fu(o.h,f),Hr(f,y,c)}function Ri(o,c){o.H&&F(o.H,function(f,y){Ne(c,y,f)}),o.l&&tf({},function(f,y){Ne(c,y,f)})}function _f(o,c,f){f=Math.min(o.i.length,f);var y=o.l?m(o.l.Na,o.l,o):null;e:{var b=o.i;let M=-1;for(;;){const Q=["count="+f];M==-1?0<f?(M=b[0].g,Q.push("ofs="+M)):M=0:Q.push("ofs="+M);let Ie=!0;for(let dt=0;dt<f;dt++){let _e=b[dt].g;const St=b[dt].map;if(_e-=M,0>_e)M=Math.max(0,b[dt].g-100),Ie=!1;else try{qv(St,Q,"req"+_e+"_")}catch{y&&y(St)}}if(Ie){y=Q.join("&");break e}}}return o=o.i.splice(0,f),c.D=o,y}function xf(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;B||L(),D||(B(),D=!0),z.add(c,o),o.v=0}}function gu(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Wr(m(o.Fa,o),Ef(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,wf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Wr(m(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,it(10),aa(this),wf(this))};function yu(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function wf(o){o.g=new ze(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=Bn(o.qa);Ne(c,"RID","rpc"),Ne(c,"SID",o.K),Ne(c,"AID",o.T),Ne(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&Ne(c,"TO",o.ja),Ne(c,"TYPE","xmlhttp"),Ri(o,c),o.m&&o.o&&pu(c,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=ra(Bn(c)),f.m=null,f.P=!0,Yt(f,o)}t.Za=function(){this.C!=null&&(this.C=null,aa(this),gu(this),it(19))};function ua(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function Sf(o,c){var f=null;if(o.g==c){ua(o),yu(o),o.g=null;var y=2}else if(hu(o.h,c))f=c.D,Zh(o.h,c),y=1;else return;if(o.G!=0){if(c.o)if(y==1){f=c.m?c.m.length:0,c=Date.now()-c.F;var b=o.B;y=$r(),Ze(y,new zn(y,f)),la(o)}else xf(o);else if(b=c.s,b==3||b==0&&0<c.X||!(y==1&&Yv(o,c)||y==2&&gu(o)))switch(f&&0<f.length&&(c=o.h,c.i=c.i.concat(f)),b){case 1:Kr(o,5);break;case 4:Kr(o,10);break;case 3:Kr(o,6);break;default:Kr(o,2)}}}function Ef(o,c){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*c}function Kr(o,c){if(o.j.info("Error code "+c),c==2){var f=m(o.fb,o),y=o.Xa;const b=!y;y=new Qr(y||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ta(y,"https"),ra(y),b?$v(y.toString(),f):Wv(y.toString(),f)}else it(2);o.G=0,o.l&&o.l.sa(c),Tf(o),yf(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),it(2)):(this.j.info("Failed to ping google.com"),it(1))};function Tf(o){if(o.G=0,o.ka=[],o.l){const c=ef(o.h);(c.length!=0||o.i.length!=0)&&(O(o.ka,c),O(o.ka,o.i),o.h.i.length=0,P(o.i),o.i.length=0),o.l.ra()}}function If(o,c,f){var y=f instanceof Qr?Bn(f):new Qr(f);if(y.g!="")c&&(y.g=c+"."+y.g),na(y,y.s);else{var b=l.location;y=b.protocol,c=c?c+"."+b.hostname:b.hostname,b=+b.port;var M=new Qr(null);y&&ta(M,y),c&&(M.g=c),b&&na(M,b),f&&(M.l=f),y=M}return f=o.D,c=o.ya,f&&c&&Ne(y,f,c),Ne(y,"VER",o.la),Ri(o,y),y}function Af(o,c,f){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new He(new sa({eb:f})):new He(o.pa),c.Ha(o.J),c}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Cf(){}t=Cf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ca(){}ca.prototype.g=function(o,c){return new Jt(o,c)};function Jt(o,c){st.call(this),this.g=new gf(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!A(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!A(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new Is(this)}R(Jt,st),Jt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Jt.prototype.close=function(){mu(this.g)},Jt.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=Yo(o),o=f);c.i.push(new Nv(c.Ya++,o)),c.G==3&&la(c)},Jt.prototype.N=function(){this.g.l=null,delete this.j,mu(this.g),delete this.g,Jt.aa.N.call(this)};function kf(o){Ss.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(const f in c){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}R(kf,Ss);function Rf(){kn.call(this),this.status=1}R(Rf,kn);function Is(o){this.g=o}R(Is,Cf),Is.prototype.ua=function(){Ze(this.g,"a")},Is.prototype.ta=function(o){Ze(this.g,new kf(o))},Is.prototype.sa=function(o){Ze(this.g,new Rf)},Is.prototype.ra=function(){Ze(this.g,"b")},ca.prototype.createWebChannel=ca.prototype.g,Jt.prototype.send=Jt.prototype.o,Jt.prototype.open=Jt.prototype.m,Jt.prototype.close=Jt.prototype.close,p0=function(){return new ca},f0=function(){return $r()},h0=xt,Xc={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},De.NO_ERROR=0,De.TIMEOUT=8,De.HTTP_ERROR=6,Ha=De,ot.COMPLETE="complete",d0=ot,lr.EventType=Fn,Fn.OPEN="a",Fn.CLOSE="b",Fn.ERROR="c",Fn.MESSAGE="d",st.prototype.listen=st.prototype.K,$i=lr,He.prototype.listenOnce=He.prototype.L,He.prototype.getLastError=He.prototype.Ka,He.prototype.getLastErrorCode=He.prototype.Ba,He.prototype.getStatus=He.prototype.Z,He.prototype.getResponseJson=He.prototype.Oa,He.prototype.getResponseText=He.prototype.oa,He.prototype.send=He.prototype.ea,He.prototype.setWithCredentials=He.prototype.Ha,c0=He}).apply(typeof Ra<"u"?Ra:typeof self<"u"?self:typeof window<"u"?window:{});const Yp="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Lt.UNAUTHENTICATED=new Lt(null),Lt.GOOGLE_CREDENTIALS=new Lt("google-credentials-uid"),Lt.FIRST_PARTY=new Lt("first-party-uid"),Lt.MOCK_USER=new Lt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mi="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ds=new n0("@firebase/firestore");function Oi(){return ds.logLevel}function re(t,...e){if(ds.logLevel<=ye.DEBUG){const n=e.map(ph);ds.debug(`Firestore (${mi}): ${t}`,...n)}}function rr(t,...e){if(ds.logLevel<=ye.ERROR){const n=e.map(ph);ds.error(`Firestore (${mi}): ${t}`,...n)}}function Co(t,...e){if(ds.logLevel<=ye.WARN){const n=e.map(ph);ds.warn(`Firestore (${mi}): ${t}`,...n)}}function ph(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function le(t="Unexpected state"){const e=`FIRESTORE (${mi}) INTERNAL ASSERTION FAILED: `+t;throw rr(e),new Error(e)}function Te(t,e){t||le()}function ce(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Z extends pi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class eS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Lt.UNAUTHENTICATED))}shutdown(){}}class tS{constructor(e){this.t=e,this.currentUser=Lt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Te(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Yn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Yn,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(re("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Yn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Te(typeof r.accessToken=="string"),new Zw(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Te(e===null||typeof e=="string"),new Lt(e)}}class nS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Lt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class rS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new nS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Lt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class sS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Te(this.o===void 0);const r=i=>{i.error!=null&&re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,re("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Te(typeof n.token=="string"),this.R=n.token,new sS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=oS(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function xe(t,e){return t<e?-1:t>e?1:0}function ii(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Z(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Z(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new Z(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Z(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return rt.fromMillis(Date.now())}static fromDate(e){return rt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new rt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ue(e)}static min(){return new ue(new rt(0,0))}static max(){return new ue(new rt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e,n,r){n===void 0?n=0:n>e.length&&le(),r===void 0?r=e.length-n:r>e.length-n&&le(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ko.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ko?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ve extends ko{construct(e,n,r){return new Ve(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Z(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ve(n)}static emptyPath(){return new Ve([])}}const aS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pt extends ko{construct(e,n,r){return new pt(e,n,r)}static isValidIdentifier(e){return aS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new pt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Z(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new Z(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Z(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new Z(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pt(n)}static emptyPath(){return new pt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.path=e}static fromPath(e){return new se(Ve.fromString(e))}static fromName(e){return new se(Ve.fromString(e).popFirst(5))}static empty(){return new se(Ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ve.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ve.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new se(new Ve(e.slice()))}}function lS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ue.fromTimestamp(r===1e9?new rt(n+1,0):new rt(n,r));return new Mr(s,se.empty(),e)}function uS(t){return new Mr(t.readTime,t.key,-1)}class Mr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Mr(ue.min(),se.empty(),-1)}static max(){return new Mr(ue.max(),se.empty(),-1)}}function cS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=se.comparator(t.documentKey,e.documentKey),n!==0?n:xe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zo(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==dS)throw t;re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new $((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof $?n:$.resolve(n)}catch(n){return $.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):$.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):$.reject(n)}static resolve(e){return new $((n,r)=>{n(e)})}static reject(e){return new $((n,r)=>{r(e)})}static waitFor(e){return new $((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(e){let n=$.resolve(!1);for(const r of e)n=n.next(s=>s?$.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new $((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let u=0;u<i;u++){const h=u;n(e[h]).next(p=>{a[h]=p,++l,l===i&&r(a)},p=>s(p))}})}static doWhile(e,n){return new $((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function fS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Bo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}mh.oe=-1;function Gl(t){return t==null}function Sl(t){return t===0&&1/t==-1/0}function pS(t){return typeof t=="number"&&Number.isInteger(t)&&!Sl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function gs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function g0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e,n){this.comparator=e,this.root=n||ft.EMPTY}insert(e,n){return new We(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ft.BLACK,null,null))}remove(e){return new We(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ft.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pa(this.root,e,this.comparator,!0)}}class Pa{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ft{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ft.RED,this.left=s??ft.EMPTY,this.right=i??ft.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ft(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ft.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ft.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw le();const e=this.left.check();if(e!==this.right.check())throw le();return e+(this.isRed()?0:1)}}ft.EMPTY=null,ft.RED=!0,ft.BLACK=!1;ft.EMPTY=new class{constructor(){this.size=0}get key(){throw le()}get value(){throw le()}get color(){throw le()}get left(){throw le()}get right(){throw le()}copy(e,n,r,s,i){return this}insert(e,n,r){return new ft(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e){this.comparator=e,this.data=new We(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Jp(this.data.getIterator())}getIteratorFrom(e){return new Jp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof gt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new gt(this.comparator);return n.data=e,n}}class Jp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e){this.fields=e,e.sort(pt.comparator)}static empty(){return new tn([])}unionWith(e){let n=new gt(pt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new tn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ii(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new y0("Invalid base64 string: "+i):i}}(e);return new vt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new vt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vt.EMPTY_BYTE_STRING=new vt("");const mS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jr(t){if(Te(!!t),typeof t=="string"){let e=0;const n=mS.exec(t);if(Te(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ge(t.seconds),nanos:Ge(t.nanos)}}function Ge(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function hs(t){return typeof t=="string"?vt.fromBase64String(t):vt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function yh(t){const e=t.mapValue.fields.__previous_value__;return gh(e)?yh(e):e}function Ro(t){const e=jr(t.mapValue.fields.__local_write_time__.timestampValue);return new rt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(e,n,r,s,i,a,l,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}}class Po{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Po("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Po&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba={mapValue:{}};function fs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?gh(t)?4:vS(t)?9007199254740991:yS(t)?10:11:le()}function Ln(t,e){if(t===e)return!0;const n=fs(t);if(n!==fs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ro(t).isEqual(Ro(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=jr(s.timestampValue),l=jr(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return hs(s.bytesValue).isEqual(hs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ge(s.geoPointValue.latitude)===Ge(i.geoPointValue.latitude)&&Ge(s.geoPointValue.longitude)===Ge(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ge(s.integerValue)===Ge(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Ge(s.doubleValue),l=Ge(i.doubleValue);return a===l?Sl(a)===Sl(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return ii(t.arrayValue.values||[],e.arrayValue.values||[],Ln);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Xp(a)!==Xp(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!Ln(a[u],l[u])))return!1;return!0}(t,e);default:return le()}}function bo(t,e){return(t.values||[]).find(n=>Ln(n,e))!==void 0}function oi(t,e){if(t===e)return 0;const n=fs(t),r=fs(e);if(n!==r)return xe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xe(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=Ge(i.integerValue||i.doubleValue),u=Ge(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return Zp(t.timestampValue,e.timestampValue);case 4:return Zp(Ro(t),Ro(e));case 5:return xe(t.stringValue,e.stringValue);case 6:return function(i,a){const l=hs(i),u=hs(a);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),u=a.split("/");for(let h=0;h<l.length&&h<u.length;h++){const p=xe(l[h],u[h]);if(p!==0)return p}return xe(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=xe(Ge(i.latitude),Ge(a.latitude));return l!==0?l:xe(Ge(i.longitude),Ge(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return em(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,u,h,p;const g=i.fields||{},m=a.fields||{},I=(l=g.value)===null||l===void 0?void 0:l.arrayValue,R=(u=m.value)===null||u===void 0?void 0:u.arrayValue,P=xe(((h=I==null?void 0:I.values)===null||h===void 0?void 0:h.length)||0,((p=R==null?void 0:R.values)===null||p===void 0?void 0:p.length)||0);return P!==0?P:em(I,R)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===ba.mapValue&&a===ba.mapValue)return 0;if(i===ba.mapValue)return 1;if(a===ba.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),h=a.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let g=0;g<u.length&&g<p.length;++g){const m=xe(u[g],p[g]);if(m!==0)return m;const I=oi(l[u[g]],h[p[g]]);if(I!==0)return I}return xe(u.length,p.length)}(t.mapValue,e.mapValue);default:throw le()}}function Zp(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xe(t,e);const n=jr(t),r=jr(e),s=xe(n.seconds,r.seconds);return s!==0?s:xe(n.nanos,r.nanos)}function em(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=oi(n[s],r[s]);if(i)return i}return xe(n.length,r.length)}function ai(t){return Jc(t)}function Jc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=jr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return hs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return se.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Jc(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${Jc(n.fields[a])}`;return s+"}"}(t.mapValue):le()}function tm(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Zc(t){return!!t&&"integerValue"in t}function vh(t){return!!t&&"arrayValue"in t}function nm(t){return!!t&&"nullValue"in t}function rm(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function qa(t){return!!t&&"mapValue"in t}function yS(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function ro(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return gs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ro(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ro(t.arrayValue.values[n]);return e}return Object.assign({},t)}function vS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.value=e}static empty(){return new Ft({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!qa(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ro(n)}setAll(e){let n=pt.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=ro(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());qa(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ln(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];qa(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){gs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Ft(ro(this.value))}}function v0(t){const e=[];return gs(t.fields,(n,r)=>{const s=new pt([n]);if(qa(r)){const i=v0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new tn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Rt(e,0,ue.min(),ue.min(),ue.min(),Ft.empty(),0)}static newFoundDocument(e,n,r,s){return new Rt(e,1,n,ue.min(),r,s,0)}static newNoDocument(e,n){return new Rt(e,2,n,ue.min(),ue.min(),Ft.empty(),0)}static newUnknownDocument(e,n){return new Rt(e,3,n,ue.min(),ue.min(),Ft.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ft.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ft.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Rt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(e,n){this.position=e,this.inclusive=n}}function sm(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=se.comparator(se.fromName(a.referenceValue),n.key):r=oi(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function im(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ln(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e,n="asc"){this.field=e,this.dir=n}}function _S(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{}class Je extends _0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new wS(e,n,r):n==="array-contains"?new TS(e,r):n==="in"?new IS(e,r):n==="not-in"?new AS(e,r):n==="array-contains-any"?new CS(e,r):new Je(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new SS(e,r):new ES(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(oi(n,this.value)):n!==null&&fs(this.value)===fs(n)&&this.matchesComparison(oi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class In extends _0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new In(e,n)}matches(e){return x0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function x0(t){return t.op==="and"}function w0(t){return xS(t)&&x0(t)}function xS(t){for(const e of t.filters)if(e instanceof In)return!1;return!0}function ed(t){if(t instanceof Je)return t.field.canonicalString()+t.op.toString()+ai(t.value);if(w0(t))return t.filters.map(e=>ed(e)).join(",");{const e=t.filters.map(n=>ed(n)).join(",");return`${t.op}(${e})`}}function S0(t,e){return t instanceof Je?function(r,s){return s instanceof Je&&r.op===s.op&&r.field.isEqual(s.field)&&Ln(r.value,s.value)}(t,e):t instanceof In?function(r,s){return s instanceof In&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&S0(a,s.filters[l]),!0):!1}(t,e):void le()}function E0(t){return t instanceof Je?function(n){return`${n.field.canonicalString()} ${n.op} ${ai(n.value)}`}(t):t instanceof In?function(n){return n.op.toString()+" {"+n.getFilters().map(E0).join(" ,")+"}"}(t):"Filter"}class wS extends Je{constructor(e,n,r){super(e,n,r),this.key=se.fromName(r.referenceValue)}matches(e){const n=se.comparator(e.key,this.key);return this.matchesComparison(n)}}class SS extends Je{constructor(e,n){super(e,"in",n),this.keys=T0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class ES extends Je{constructor(e,n){super(e,"not-in",n),this.keys=T0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function T0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>se.fromName(r.referenceValue))}class TS extends Je{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return vh(n)&&bo(n.arrayValue,this.value)}}class IS extends Je{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&bo(this.value.arrayValue,n)}}class AS extends Je{constructor(e,n){super(e,"not-in",n)}matches(e){if(bo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!bo(this.value.arrayValue,n)}}class CS extends Je{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!vh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>bo(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function om(t,e=null,n=[],r=[],s=null,i=null,a=null){return new kS(t,e,n,r,s,i,a)}function _h(t){const e=ce(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ed(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Gl(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ai(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ai(r)).join(",")),e.ue=n}return e.ue}function xh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!_S(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!S0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!im(t.startAt,e.startAt)&&im(t.endAt,e.endAt)}function td(t){return se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function RS(t,e,n,r,s,i,a,l){return new Uo(t,e,n,r,s,i,a,l)}function wh(t){return new Uo(t)}function am(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function I0(t){return t.collectionGroup!==null}function so(t){const e=ce(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new gt(pt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Tl(i,r))}),n.has(pt.keyField().canonicalString())||e.ce.push(new Tl(pt.keyField(),r))}return e.ce}function jn(t){const e=ce(t);return e.le||(e.le=PS(e,so(t))),e.le}function PS(t,e){if(t.limitType==="F")return om(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Tl(s.field,i)});const n=t.endAt?new El(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new El(t.startAt.position,t.startAt.inclusive):null;return om(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function nd(t,e){const n=t.filters.concat([e]);return new Uo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function rd(t,e,n){return new Uo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ql(t,e){return xh(jn(t),jn(e))&&t.limitType===e.limitType}function A0(t){return`${_h(jn(t))}|lt:${t.limitType}`}function ks(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>E0(s)).join(", ")}]`),Gl(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ai(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ai(s)).join(",")),`Target(${r})`}(jn(t))}; limitType=${t.limitType})`}function Kl(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):se.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of so(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,u){const h=sm(a,l,u);return a.inclusive?h<=0:h<0}(r.startAt,so(r),s)||r.endAt&&!function(a,l,u){const h=sm(a,l,u);return a.inclusive?h>=0:h>0}(r.endAt,so(r),s))}(t,e)}function bS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function C0(t){return(e,n)=>{let r=!1;for(const s of so(t)){const i=DS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function DS(t,e,n){const r=t.field.isKeyField()?se.comparator(e.key,n.key):function(i,a,l){const u=a.data.field(i),h=l.data.field(i);return u!==null&&h!==null?oi(u,h):le()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){gs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return g0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS=new We(se.comparator);function sr(){return NS}const k0=new We(se.comparator);function Wi(...t){let e=k0;for(const n of t)e=e.insert(n.key,n);return e}function R0(t){let e=k0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ns(){return io()}function P0(){return io()}function io(){return new gi(t=>t.toString(),(t,e)=>t.isEqual(e))}const MS=new We(se.comparator),jS=new gt(se.comparator);function pe(...t){let e=jS;for(const n of t)e=e.add(n);return e}const VS=new gt(xe);function LS(){return VS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Sl(e)?"-0":e}}function b0(t){return{integerValue:""+t}}function OS(t,e){return pS(e)?b0(e):Sh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(){this._=void 0}}function FS(t,e,n){return t instanceof Do?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&gh(i)&&(i=yh(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof No?N0(t,e):t instanceof Mo?M0(t,e):function(s,i){const a=D0(s,i),l=lm(a)+lm(s.Pe);return Zc(a)&&Zc(s.Pe)?b0(l):Sh(s.serializer,l)}(t,e)}function zS(t,e,n){return t instanceof No?N0(t,e):t instanceof Mo?M0(t,e):n}function D0(t,e){return t instanceof Il?function(r){return Zc(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Do extends Yl{}class No extends Yl{constructor(e){super(),this.elements=e}}function N0(t,e){const n=j0(e);for(const r of t.elements)n.some(s=>Ln(s,r))||n.push(r);return{arrayValue:{values:n}}}class Mo extends Yl{constructor(e){super(),this.elements=e}}function M0(t,e){let n=j0(e);for(const r of t.elements)n=n.filter(s=>!Ln(s,r));return{arrayValue:{values:n}}}class Il extends Yl{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function lm(t){return Ge(t.integerValue||t.doubleValue)}function j0(t){return vh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(e,n){this.field=e,this.transform=n}}function US(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof No&&s instanceof No||r instanceof Mo&&s instanceof Mo?ii(r.elements,s.elements,Ln):r instanceof Il&&s instanceof Il?Ln(r.Pe,s.Pe):r instanceof Do&&s instanceof Do}(t.transform,e.transform)}class $S{constructor(e,n){this.version=e,this.transformResults=n}}class fn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new fn}static exists(e){return new fn(void 0,e)}static updateTime(e){return new fn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ga(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Xl{}function V0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Eh(t.key,fn.none()):new $o(t.key,t.data,fn.none());{const n=t.data,r=Ft.empty();let s=new gt(pt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new zr(t.key,r,new tn(s.toArray()),fn.none())}}function WS(t,e,n){t instanceof $o?function(s,i,a){const l=s.value.clone(),u=cm(s.fieldTransforms,i,a.transformResults);l.setAll(u),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof zr?function(s,i,a){if(!Ga(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=cm(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(L0(s)),u.setAll(l),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function oo(t,e,n,r){return t instanceof $o?function(i,a,l,u){if(!Ga(i.precondition,a))return l;const h=i.value.clone(),p=dm(i.fieldTransforms,u,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof zr?function(i,a,l,u){if(!Ga(i.precondition,a))return l;const h=dm(i.fieldTransforms,u,a),p=a.data;return p.setAll(L0(i)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,a,l){return Ga(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function HS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=D0(r.transform,s||null);i!=null&&(n===null&&(n=Ft.empty()),n.set(r.field,i))}return n||null}function um(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ii(r,s,(i,a)=>US(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class $o extends Xl{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class zr extends Xl{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function L0(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function cm(t,e,n){const r=new Map;Te(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,zS(a,l,n[s]))}return r}function dm(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,FS(i,a,e))}return r}class Eh extends Xl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qS extends Xl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&WS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=oo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=oo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=P0();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const u=V0(a,l);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(ue.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),pe())}isEqual(e){return this.batchId===e.batchId&&ii(this.mutations,e.mutations,(n,r)=>um(n,r))&&ii(this.baseMutations,e.baseMutations,(n,r)=>um(n,r))}}class Th{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Te(e.mutations.length===r.length);let s=function(){return MS}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new Th(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ke,ge;function YS(t){switch(t){default:return le();case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0}}function O0(t){if(t===void 0)return rr("GRPC error has no .code"),U.UNKNOWN;switch(t){case Ke.OK:return U.OK;case Ke.CANCELLED:return U.CANCELLED;case Ke.UNKNOWN:return U.UNKNOWN;case Ke.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case Ke.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case Ke.INTERNAL:return U.INTERNAL;case Ke.UNAVAILABLE:return U.UNAVAILABLE;case Ke.UNAUTHENTICATED:return U.UNAUTHENTICATED;case Ke.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case Ke.NOT_FOUND:return U.NOT_FOUND;case Ke.ALREADY_EXISTS:return U.ALREADY_EXISTS;case Ke.PERMISSION_DENIED:return U.PERMISSION_DENIED;case Ke.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case Ke.ABORTED:return U.ABORTED;case Ke.OUT_OF_RANGE:return U.OUT_OF_RANGE;case Ke.UNIMPLEMENTED:return U.UNIMPLEMENTED;case Ke.DATA_LOSS:return U.DATA_LOSS;default:return le()}}(ge=Ke||(Ke={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JS=new is([4294967295,4294967295],0);function hm(t){const e=XS().encode(t),n=new u0;return n.update(e),new Uint8Array(n.digest())}function fm(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new is([n,r],0),new is([s,i],0)]}class Ih{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Hi(`Invalid padding: ${n}`);if(r<0)throw new Hi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Hi(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Hi(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=is.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(is.fromNumber(r)));return s.compare(JS)===1&&(s=new is([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=hm(e),[r,s]=fm(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Ih(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=hm(e),[r,s]=fm(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Hi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Wo.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Jl(ue.min(),s,new We(xe),sr(),pe())}}class Wo{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Wo(r,n,pe(),pe(),pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class F0{constructor(e,n){this.targetId=e,this.me=n}}class z0{constructor(e,n,r=vt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class pm{constructor(){this.fe=0,this.ge=gm(),this.pe=vt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=pe(),n=pe(),r=pe();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:le()}}),new Wo(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=gm()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class ZS{constructor(e){this.Le=e,this.Be=new Map,this.ke=sr(),this.qe=mm(),this.Qe=new We(xe)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:le()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(td(i))if(r===0){const a=new se(i.path);this.Ue(n,a,Rt.newNoDocument(a,ue.min()))}else Te(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),u=l?this.Xe(l,e,a):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=hs(r).toUint8Array()}catch(u){if(u instanceof y0)return Co("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Ih(a,s,i)}catch(u){return Co(u instanceof Hi?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&td(l.target)){const u=new se(l.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,Rt.newNoDocument(u,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=pe();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new Jl(e,n,this.Qe,this.ke,r);return this.ke=sr(),this.qe=mm(),this.Qe=new We(xe),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new pm,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new gt(xe),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||re("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new pm),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function mm(){return new We(se.comparator)}function gm(){return new We(se.comparator)}const eE={asc:"ASCENDING",desc:"DESCENDING"},tE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},nE={and:"AND",or:"OR"};class rE{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function sd(t,e){return t.useProto3Json||Gl(e)?e:{value:e}}function Al(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function B0(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function sE(t,e){return Al(t,e.toTimestamp())}function Vn(t){return Te(!!t),ue.fromTimestamp(function(n){const r=jr(n);return new rt(r.seconds,r.nanos)}(t))}function Ah(t,e){return id(t,e).canonicalString()}function id(t,e){const n=function(s){return new Ve(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function U0(t){const e=Ve.fromString(t);return Te(G0(e)),e}function od(t,e){return Ah(t.databaseId,e.path)}function Ku(t,e){const n=U0(e);if(n.get(1)!==t.databaseId.projectId)throw new Z(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Z(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new se(W0(n))}function $0(t,e){return Ah(t.databaseId,e)}function iE(t){const e=U0(t);return e.length===4?Ve.emptyPath():W0(e)}function ad(t){return new Ve(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function W0(t){return Te(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function ym(t,e,n){return{name:od(t,e),fields:n.value.mapValue.fields}}function oE(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:le()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,p){return h.useProto3Json?(Te(p===void 0||typeof p=="string"),vt.fromBase64String(p||"")):(Te(p===void 0||p instanceof Buffer||p instanceof Uint8Array),vt.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){const p=h.code===void 0?U.UNKNOWN:O0(h.code);return new Z(p,h.message||"")}(a);n=new z0(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ku(t,r.document.name),i=Vn(r.document.updateTime),a=r.document.createTime?Vn(r.document.createTime):ue.min(),l=new Ft({mapValue:{fields:r.document.fields}}),u=Rt.newFoundDocument(s,i,a,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new Qa(h,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ku(t,r.document),i=r.readTime?Vn(r.readTime):ue.min(),a=Rt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new Qa([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ku(t,r.document),i=r.removedTargetIds||[];n=new Qa([],i,s,null)}else{if(!("filter"in e))return le();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new KS(s,i),l=r.targetId;n=new F0(l,a)}}return n}function aE(t,e){let n;if(e instanceof $o)n={update:ym(t,e.key,e.value)};else if(e instanceof Eh)n={delete:od(t,e.key)};else if(e instanceof zr)n={update:ym(t,e.key,e.data),updateMask:gE(e.fieldMask)};else{if(!(e instanceof qS))return le();n={verify:od(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof Do)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof No)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Mo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Il)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw le()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:sE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:le()}(t,e.precondition)),n}function lE(t,e){return t&&t.length>0?(Te(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?Vn(s.updateTime):Vn(i);return a.isEqual(ue.min())&&(a=Vn(i)),new $S(a,s.transformResults||[])}(n,e))):[]}function uE(t,e){return{documents:[$0(t,e.path)]}}function cE(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=$0(t,s);const i=function(h){if(h.length!==0)return q0(In.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(h){if(h.length!==0)return h.map(p=>function(m){return{field:Rs(m.field),direction:fE(m.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=sd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function dE(t){let e=iE(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Te(r===1);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(g){const m=H0(g);return m instanceof In&&w0(m)?m.getFilters():[m]}(n.where));let a=[];n.orderBy&&(a=function(g){return g.map(m=>function(R){return new Tl(Ps(R.field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(g){let m;return m=typeof g=="object"?g.value:g,Gl(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(g){const m=!!g.before,I=g.values||[];return new El(I,m)}(n.startAt));let h=null;return n.endAt&&(h=function(g){const m=!g.before,I=g.values||[];return new El(I,m)}(n.endAt)),RS(e,s,a,i,l,"F",u,h)}function hE(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return le()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function H0(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ps(n.unaryFilter.field);return Je.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ps(n.unaryFilter.field);return Je.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ps(n.unaryFilter.field);return Je.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Ps(n.unaryFilter.field);return Je.create(a,"!=",{nullValue:"NULL_VALUE"});default:return le()}}(t):t.fieldFilter!==void 0?function(n){return Je.create(Ps(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return le()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return In.create(n.compositeFilter.filters.map(r=>H0(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return le()}}(n.compositeFilter.op))}(t):le()}function fE(t){return eE[t]}function pE(t){return tE[t]}function mE(t){return nE[t]}function Rs(t){return{fieldPath:t.canonicalString()}}function Ps(t){return pt.fromServerFormat(t.fieldPath)}function q0(t){return t instanceof Je?function(n){if(n.op==="=="){if(rm(n.value))return{unaryFilter:{field:Rs(n.field),op:"IS_NAN"}};if(nm(n.value))return{unaryFilter:{field:Rs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(rm(n.value))return{unaryFilter:{field:Rs(n.field),op:"IS_NOT_NAN"}};if(nm(n.value))return{unaryFilter:{field:Rs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Rs(n.field),op:pE(n.op),value:n.value}}}(t):t instanceof In?function(n){const r=n.getFilters().map(s=>q0(s));return r.length===1?r[0]:{compositeFilter:{op:mE(n.op),filters:r}}}(t):le()}function gE(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function G0(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,n,r,s,i=ue.min(),a=ue.min(),l=vt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new _r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yE{constructor(e){this.ct=e}}function vE(t){const e=dE({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?rd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{constructor(){this.un=new xE}addToCollectionParentIndex(e,n){return this.un.add(n),$.resolve()}getCollectionParents(e,n){return $.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return $.resolve()}deleteFieldIndex(e,n){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,n){return $.resolve()}getDocumentsMatchingTarget(e,n){return $.resolve(null)}getIndexType(e,n){return $.resolve(0)}getFieldIndexes(e,n){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,n){return $.resolve(Mr.min())}getMinOffsetFromCollectionGroup(e,n){return $.resolve(Mr.min())}updateCollectionGroup(e,n,r){return $.resolve()}updateIndexEntries(e,n){return $.resolve()}}class xE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new gt(Ve.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new gt(Ve.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new li(0)}static kn(){return new li(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(){this.changes=new gi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Rt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?$.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&oo(r.mutation,s,tn.empty(),rt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=pe()){const s=ns();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=Wi();return i.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=ns();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,pe()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=sr();const a=io(),l=function(){return io()}();return n.forEach((u,h)=>{const p=r.get(h.key);s.has(h.key)&&(p===void 0||p.mutation instanceof zr)?i=i.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),oo(p.mutation,h,p.mutation.getFieldMask(),rt.now())):a.set(h.key,tn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,p)=>a.set(h,p)),n.forEach((h,p)=>{var g;return l.set(h,new SE(p,(g=a.get(h))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=io();let s=new We((a,l)=>a-l),i=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let p=r.get(u)||tn.empty();p=l.applyToLocalView(h,p),r.set(u,p);const g=(s.get(l.batchId)||pe()).add(u);s=s.insert(l.batchId,g)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,p=u.value,g=P0();p.forEach(m=>{if(!i.has(m)){const I=V0(n.get(m),r.get(m));I!==null&&g.set(m,I),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return $.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return se.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):I0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):$.resolve(ns());let l=-1,u=i;return a.next(h=>$.forEach(h,(p,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),i.get(p)?$.resolve():this.remoteDocumentCache.getEntry(e,p).next(m=>{u=u.insert(p,m)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,pe())).next(p=>({batchId:l,changes:R0(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new se(n)).next(r=>{let s=Wi();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=Wi();return this.indexManager.getCollectionParents(e,i).next(l=>$.forEach(l,u=>{const h=function(g,m){return new Uo(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(p=>{p.forEach((g,m)=>{a=a.insert(g,m)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((u,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,Rt.newInvalidDocument(p)))});let l=Wi();return a.forEach((u,h)=>{const p=i.get(u);p!==void 0&&oo(p.mutation,h,tn.empty(),rt.now()),Kl(n,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return $.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Vn(s.createTime)}}(n)),$.resolve()}getNamedQuery(e,n){return $.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:vE(s.bundledQuery),readTime:Vn(s.readTime)}}(n)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(){this.overlays=new We(se.comparator),this.Ir=new Map}getOverlay(e,n){return $.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ns();return $.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),$.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),$.resolve()}getOverlaysForCollection(e,n,r){const s=ns(),i=n.length+1,a=new se(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return $.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new We((h,p)=>h-p);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=i.get(h.largestBatchId);p===null&&(p=ns(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=ns(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=s)););return $.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new QS(n,r));let i=this.Ir.get(n);i===void 0&&(i=pe(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(){this.sessionToken=vt.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(){this.Tr=new gt(at.Er),this.dr=new gt(at.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new at(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new at(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new se(new Ve([])),r=new at(n,e),s=new at(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new se(new Ve([])),r=new at(n,e),s=new at(n,e+1);let i=pe();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new at(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class at{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return se.comparator(e.key,n.key)||xe(e.wr,n.wr)}static Ar(e,n){return xe(e.wr,n.wr)||se.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CE{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new gt(at.Er)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new GS(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new at(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return $.resolve(a)}lookupMutationBatch(e,n){return $.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new at(n,0),s=new at(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new gt(xe);return n.forEach(s=>{const i=new at(s,0),a=new at(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),$.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;se.isDocumentKey(i)||(i=i.child(""));const a=new at(new se(i),0);let l=new gt(xe);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(l=l.add(u.wr)),!0)},a),$.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Te(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return $.forEach(n.mutations,s=>{const i=new at(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new at(n,0),s=this.br.firstAfterOrEqual(r);return $.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e){this.Mr=e,this.docs=function(){return new We(se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return $.resolve(r?r.document.mutableCopy():Rt.newInvalidDocument(n))}getEntries(e,n){let r=sr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Rt.newInvalidDocument(s))}),$.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=sr();const a=n.path,l=new se(a.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||cS(uS(p),r)<=0||(s.has(p.key)||Kl(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,n,r,s){le()}Or(e,n){return $.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new RE(this)}getSize(e){return $.resolve(this.size)}}class RE extends wE{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),$.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){this.persistence=e,this.Nr=new gi(n=>_h(n),xh),this.lastRemoteSnapshotVersion=ue.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ch,this.targetCount=0,this.kr=li.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),$.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new li(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,$.resolve()}updateTargetData(e,n){return this.Kn(n),$.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),$.waitFor(i).next(()=>s)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return $.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),$.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),$.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return $.resolve(r)}containsKey(e,n){return $.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(e,n){this.qr={},this.overlays={},this.Qr=new mh(0),this.Kr=!1,this.Kr=!0,this.$r=new AE,this.referenceDelegate=e(this),this.Ur=new PE(this),this.indexManager=new _E,this.remoteDocumentCache=function(s){return new kE(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new yE(n),this.Gr=new TE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new IE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new CE(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){re("MemoryPersistence","Starting transaction:",e);const s=new DE(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return $.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class DE extends hS{constructor(e){super(),this.currentSequenceNumber=e}}class kh{constructor(e){this.persistence=e,this.Jr=new Ch,this.Yr=null}static Zr(e){return new kh(e)}get Xr(){if(this.Yr)return this.Yr;throw le()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),$.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),$.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.Xr,r=>{const s=se.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,ue.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return $.or([()=>$.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=pe(),s=pe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Rh(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return V1()?8:fS(M1())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new NE;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Oi()<=ye.DEBUG&&re("QueryEngine","SDK will not create cache indexes for query:",ks(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),$.resolve()):(Oi()<=ye.DEBUG&&re("QueryEngine","Query:",ks(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Oi()<=ye.DEBUG&&re("QueryEngine","The SDK decides to create cache indexes for query:",ks(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,jn(n))):$.resolve())}Yi(e,n){if(am(n))return $.resolve(null);let r=jn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=rd(n,null,"F"),r=jn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=pe(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,l);return this.ns(n,h,a,u.readTime)?this.Yi(e,rd(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,s){return am(n)||s.isEqual(ue.min())?$.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?$.resolve(null):(Oi()<=ye.DEBUG&&re("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ks(n)),this.rs(e,a,n,lS(s,-1)).next(l=>l))})}ts(e,n){let r=new gt(C0(e));return n.forEach((s,i)=>{Kl(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Oi()<=ye.DEBUG&&re("QueryEngine","Using full collection scan to execute query:",ks(n)),this.Ji.getDocumentsMatchingQuery(e,n,Mr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new We(xe),this._s=new gi(i=>_h(i),xh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new EE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function VE(t,e,n,r){return new jE(t,e,n,r)}async function Q0(t,e){const n=ce(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let u=pe();for(const h of s){a.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of i){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:a,addedBatchIds:l}))})})}function LE(t,e){const n=ce(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,h,p){const g=h.batch,m=g.keys();let I=$.resolve();return m.forEach(R=>{I=I.next(()=>p.getEntry(u,R)).next(P=>{const O=h.docVersions.get(R);Te(O!==null),P.version.compareTo(O)<0&&(g.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),p.addEntry(P)))})}),I.next(()=>l.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=pe();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function K0(t){const e=ce(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function OE(t,e){const n=ce(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((p,g)=>{const m=s.get(g);if(!m)return;l.push(n.Ur.removeMatchingKeys(i,p.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(i,p.addedDocuments,g)));let I=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?I=I.withResumeToken(vt.EMPTY_BYTE_STRING,ue.min()).withLastLimboFreeSnapshotVersion(ue.min()):p.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(p.resumeToken,r)),s=s.insert(g,I),function(P,O,k){return P.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(m,I,p)&&l.push(n.Ur.updateTargetData(i,I))});let u=sr(),h=pe();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),l.push(FE(i,a,e.documentUpdates).next(p=>{u=p.Ps,h=p.Is})),!r.isEqual(ue.min())){const p=n.Ur.getLastRemoteSnapshotVersion(i).next(g=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(p)}return $.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(n.os=s,i))}function FE(t,e,n){let r=pe(),s=pe();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=sr();return n.forEach((l,u)=>{const h=i.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(ue.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):re("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ps:a,Is:s}})}function zE(t,e){const n=ce(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function BE(t,e){const n=ce(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,$.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new _r(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function ld(t,e,n){const r=ce(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Bo(a))throw a;re("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function vm(t,e,n){const r=ce(t);let s=ue.min(),i=pe();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,p){const g=ce(u),m=g._s.get(p);return m!==void 0?$.resolve(g.os.get(m)):g.Ur.getTargetData(h,p)}(r,a,jn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:ue.min(),n?i:pe())).next(l=>(UE(r,bS(e),l),{documents:l,Ts:i})))}function UE(t,e,n){let r=t.us.get(e)||ue.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class _m{constructor(){this.activeTargetIds=LS()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class $E{constructor(){this.so=new _m,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new _m,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WE{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){re("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){re("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Da=null;function Yu(){return Da===null?Da=function(){return 268435456+Math.round(2147483648*Math.random())}():Da++,"0x"+Da.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const At="WebChannelConnection";class GE extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=Yu(),u=this.xo(n,r.toUriEncodedString());re("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,a),this.No(n,u,h,s).then(p=>(re("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw Co("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",u,"request:",s),p})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+mi}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=HE[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=Yu();return new Promise((a,l)=>{const u=new c0;u.setWithCredentials(!0),u.listenOnce(d0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Ha.NO_ERROR:const p=u.getResponseJson();re(At,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(p)),a(p);break;case Ha.TIMEOUT:re(At,`RPC '${e}' ${i} timed out`),l(new Z(U.DEADLINE_EXCEEDED,"Request time out"));break;case Ha.HTTP_ERROR:const g=u.getStatus();if(re(At,`RPC '${e}' ${i} failed with status:`,g,"response text:",u.getResponseText()),g>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const I=m==null?void 0:m.error;if(I&&I.status&&I.message){const R=function(O){const k=O.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(k)>=0?k:U.UNKNOWN}(I.status);l(new Z(R,I.message))}else l(new Z(U.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new Z(U.UNAVAILABLE,"Connection failed."));break;default:le()}}finally{re(At,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);re(At,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=Yu(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=p0(),l=f0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const p=i.join("");re(At,`Creating RPC '${e}' stream ${s}: ${p}`,u);const g=a.createWebChannel(p,u);let m=!1,I=!1;const R=new qE({Io:O=>{I?re(At,`Not sending because RPC '${e}' stream ${s} is closed:`,O):(m||(re(At,`Opening RPC '${e}' stream ${s} transport.`),g.open(),m=!0),re(At,`RPC '${e}' stream ${s} sending:`,O),g.send(O))},To:()=>g.close()}),P=(O,k,A)=>{O.listen(k,C=>{try{A(C)}catch(N){setTimeout(()=>{throw N},0)}})};return P(g,$i.EventType.OPEN,()=>{I||(re(At,`RPC '${e}' stream ${s} transport opened.`),R.yo())}),P(g,$i.EventType.CLOSE,()=>{I||(I=!0,re(At,`RPC '${e}' stream ${s} transport closed`),R.So())}),P(g,$i.EventType.ERROR,O=>{I||(I=!0,Co(At,`RPC '${e}' stream ${s} transport errored:`,O),R.So(new Z(U.UNAVAILABLE,"The operation could not be completed")))}),P(g,$i.EventType.MESSAGE,O=>{var k;if(!I){const A=O.data[0];Te(!!A);const C=A,N=C.error||((k=C[0])===null||k===void 0?void 0:k.error);if(N){re(At,`RPC '${e}' stream ${s} received error:`,N);const V=N.status;let F=function(E){const T=Ke[E];if(T!==void 0)return O0(T)}(V),w=N.message;F===void 0&&(F=U.INTERNAL,w="Unknown error status: "+V+" with message "+N.message),I=!0,R.So(new Z(F,w)),g.close()}else re(At,`RPC '${e}' stream ${s} received:`,A),R.bo(A)}}),P(l,h0.STAT_EVENT,O=>{O.stat===Xc.PROXY?re(At,`RPC '${e}' stream ${s} detected buffering proxy`):O.stat===Xc.NOPROXY&&re(At,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{R.wo()},0),R}}function Xu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zl(t){return new rE(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&re("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e,n,r,s,i,a,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Y0(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===U.RESOURCE_EXHAUSTED?(rr(n.toString()),rr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new Z(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return re("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(re("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class QE extends X0{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=oE(this.serializer,e),r=function(i){if(!("targetChange"in i))return ue.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?ue.min():a.readTime?Vn(a.readTime):ue.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=ad(this.serializer),n.addTarget=function(i,a){let l;const u=a.target;if(l=td(u)?{documents:uE(i,u)}:{query:cE(i,u)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=B0(i,a.resumeToken);const h=sd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(ue.min())>0){l.readTime=Al(i,a.snapshotVersion.toTimestamp());const h=sd(i,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=hE(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=ad(this.serializer),n.removeTarget=e,this.a_(n)}}class KE extends X0{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Te(!!e.streamToken),this.lastStreamToken=e.streamToken,Te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=lE(e.writeResults,e.commitTime),r=Vn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=ad(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>aE(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Z(U.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,id(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Z(U.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,id(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Z(U.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class XE{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(rr(n),this.D_=!1):re("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{ys(this)&&(re("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=ce(u);h.L_.add(4),await Ho(h),h.q_.set("Unknown"),h.L_.delete(4),await eu(h)}(this))})}),this.q_=new XE(r,s)}}async function eu(t){if(ys(t))for(const e of t.B_)await e(!0)}async function Ho(t){for(const e of t.B_)await e(!1)}function J0(t,e){const n=ce(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Nh(n)?Dh(n):yi(n).r_()&&bh(n,e))}function Ph(t,e){const n=ce(t),r=yi(n);n.N_.delete(e),r.r_()&&Z0(n,e),n.N_.size===0&&(r.r_()?r.o_():ys(n)&&n.q_.set("Unknown"))}function bh(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}yi(t).A_(e)}function Z0(t,e){t.Q_.xe(e),yi(t).R_(e)}function Dh(t){t.Q_=new ZS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),yi(t).start(),t.q_.v_()}function Nh(t){return ys(t)&&!yi(t).n_()&&t.N_.size>0}function ys(t){return ce(t).L_.size===0}function ev(t){t.Q_=void 0}async function ZE(t){t.q_.set("Online")}async function eT(t){t.N_.forEach((e,n)=>{bh(t,e)})}async function tT(t,e){ev(t),Nh(t)?(t.q_.M_(e),Dh(t)):t.q_.set("Unknown")}async function nT(t,e,n){if(t.q_.set("Online"),e instanceof z0&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){re("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Cl(t,r)}else if(e instanceof Qa?t.Q_.Ke(e):e instanceof F0?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ue.min()))try{const r=await K0(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=i.N_.get(h);p&&i.N_.set(h,p.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,h)=>{const p=i.N_.get(u);if(!p)return;i.N_.set(u,p.withResumeToken(vt.EMPTY_BYTE_STRING,p.snapshotVersion)),Z0(i,u);const g=new _r(p.target,u,h,p.sequenceNumber);bh(i,g)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){re("RemoteStore","Failed to raise snapshot:",r),await Cl(t,r)}}async function Cl(t,e,n){if(!Bo(e))throw e;t.L_.add(1),await Ho(t),t.q_.set("Offline"),n||(n=()=>K0(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{re("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await eu(t)})}function tv(t,e){return e().catch(n=>Cl(t,n,e))}async function tu(t){const e=ce(t),n=Vr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;rT(e);)try{const s=await zE(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,sT(e,s)}catch(s){await Cl(e,s)}nv(e)&&rv(e)}function rT(t){return ys(t)&&t.O_.length<10}function sT(t,e){t.O_.push(e);const n=Vr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function nv(t){return ys(t)&&!Vr(t).n_()&&t.O_.length>0}function rv(t){Vr(t).start()}async function iT(t){Vr(t).p_()}async function oT(t){const e=Vr(t);for(const n of t.O_)e.m_(n.mutations)}async function aT(t,e,n){const r=t.O_.shift(),s=Th.from(r,e,n);await tv(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await tu(t)}async function lT(t,e){e&&Vr(t).V_&&await async function(r,s){if(function(a){return YS(a)&&a!==U.ABORTED}(s.code)){const i=r.O_.shift();Vr(r).s_(),await tv(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await tu(r)}}(t,e),nv(t)&&rv(t)}async function wm(t,e){const n=ce(t);n.asyncQueue.verifyOperationInProgress(),re("RemoteStore","RemoteStore received new credentials");const r=ys(n);n.L_.add(3),await Ho(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await eu(n)}async function uT(t,e){const n=ce(t);e?(n.L_.delete(2),await eu(n)):e||(n.L_.add(2),await Ho(n),n.q_.set("Unknown"))}function yi(t){return t.K_||(t.K_=function(n,r,s){const i=ce(n);return i.w_(),new QE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:ZE.bind(null,t),Ro:eT.bind(null,t),mo:tT.bind(null,t),d_:nT.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Nh(t)?Dh(t):t.q_.set("Unknown")):(await t.K_.stop(),ev(t))})),t.K_}function Vr(t){return t.U_||(t.U_=function(n,r,s){const i=ce(n);return i.w_(),new KE(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:iT.bind(null,t),mo:lT.bind(null,t),f_:oT.bind(null,t),g_:aT.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await tu(t)):(await t.U_.stop(),t.O_.length>0&&(re("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Yn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new Mh(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Z(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jh(t,e){if(rr("AsyncQueue",`${e}: ${t}`),Bo(t))return new Z(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e){this.comparator=e?(n,r)=>e(n,r)||se.comparator(n.key,r.key):(n,r)=>se.comparator(n.key,r.key),this.keyedMap=Wi(),this.sortedSet=new We(this.comparator)}static emptySet(e){return new Ys(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ys)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ys;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(){this.W_=new We(se.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):le():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class ui{constructor(e,n,r,s,i,a,l,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new ui(e,n,Ys.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ql(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class dT{constructor(){this.queries=Em(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ce(n),i=s.queries;s.queries=Em(),i.forEach((a,l)=>{for(const u of l.j_)u.onError(r)})})(this,new Z(U.ABORTED,"Firestore shutting down"))}}function Em(){return new gi(t=>A0(t),Ql)}async function sv(t,e){const n=ce(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new cT,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=jh(a,`Initialization of query '${ks(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Vh(n)}async function iv(t,e){const n=ce(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function hT(t,e){const n=ce(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&Vh(n)}function fT(t,e,n){const r=ce(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Vh(t){t.Y_.forEach(e=>{e.next()})}var ud,Tm;(Tm=ud||(ud={})).ea="default",Tm.Cache="cache";class ov{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ui(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=ui.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ud.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e){this.key=e}}class lv{constructor(e){this.key=e}}class pT{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=pe(),this.mutatedKeys=pe(),this.Aa=C0(e),this.Ra=new Ys(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Sm,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,g)=>{const m=s.get(p),I=Kl(this.query,g)?g:null,R=!!m&&this.mutatedKeys.has(m.key),P=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let O=!1;m&&I?m.data.isEqual(I.data)?R!==P&&(r.track({type:3,doc:I}),O=!0):this.ga(m,I)||(r.track({type:2,doc:I}),O=!0,(u&&this.Aa(I,u)>0||h&&this.Aa(I,h)<0)&&(l=!0)):!m&&I?(r.track({type:0,doc:I}),O=!0):m&&!I&&(r.track({type:1,doc:m}),O=!0,(u||h)&&(l=!0)),O&&(I?(a=a.add(I),i=P?i.add(p):i.delete(p)):(a=a.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((p,g)=>function(I,R){const P=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return le()}};return P(I)-P(R)}(p.type,g.type)||this.Aa(p.doc,g.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,h=u!==this.Ea;return this.Ea=u,a.length!==0||h?{snapshot:new ui(this.query,e.Ra,i,a,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Sm,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=pe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new lv(r))}),this.da.forEach(r=>{e.has(r)||n.push(new av(r))}),n}ba(e){this.Ta=e.Ts,this.da=pe();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return ui.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class mT{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class gT{constructor(e){this.key=e,this.va=!1}}class yT{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new gi(l=>A0(l),Ql),this.Ma=new Map,this.xa=new Set,this.Oa=new We(se.comparator),this.Na=new Map,this.La=new Ch,this.Ba={},this.ka=new Map,this.qa=li.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function vT(t,e,n=!0){const r=pv(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await uv(r,e,n,!0),s}async function _T(t,e){const n=pv(t);await uv(n,e,!0,!1)}async function uv(t,e,n,r){const s=await BE(t.localStore,jn(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await xT(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&J0(t.remoteStore,s),l}async function xT(t,e,n,r,s){t.Ka=(g,m,I)=>async function(P,O,k,A){let C=O.view.ma(k);C.ns&&(C=await vm(P.localStore,O.query,!1).then(({documents:w})=>O.view.ma(w,C)));const N=A&&A.targetChanges.get(O.targetId),V=A&&A.targetMismatches.get(O.targetId)!=null,F=O.view.applyChanges(C,P.isPrimaryClient,N,V);return Am(P,O.targetId,F.wa),F.snapshot}(t,g,m,I);const i=await vm(t.localStore,e,!0),a=new pT(e,i.Ts),l=a.ma(i.documents),u=Wo.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=a.applyChanges(l,t.isPrimaryClient,u);Am(t,n,h.wa);const p=new mT(e,n,a);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function wT(t,e,n){const r=ce(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!Ql(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ld(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Ph(r.remoteStore,s.targetId),cd(r,s.targetId)}).catch(zo)):(cd(r,s.targetId),await ld(r.localStore,s.targetId,!0))}async function ST(t,e){const n=ce(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ph(n.remoteStore,r.targetId))}async function ET(t,e,n){const r=PT(t);try{const s=await function(a,l){const u=ce(a),h=rt.now(),p=l.reduce((I,R)=>I.add(R.key),pe());let g,m;return u.persistence.runTransaction("Locally write mutations","readwrite",I=>{let R=sr(),P=pe();return u.cs.getEntries(I,p).next(O=>{R=O,R.forEach((k,A)=>{A.isValidDocument()||(P=P.add(k))})}).next(()=>u.localDocuments.getOverlayedDocuments(I,R)).next(O=>{g=O;const k=[];for(const A of l){const C=HS(A,g.get(A.key).overlayedDocument);C!=null&&k.push(new zr(A.key,C,v0(C.value.mapValue),fn.exists(!0)))}return u.mutationQueue.addMutationBatch(I,h,k,l)}).next(O=>{m=O;const k=O.applyToLocalDocumentSet(g,P);return u.documentOverlayCache.saveOverlays(I,O.batchId,k)})}).then(()=>({batchId:m.batchId,changes:R0(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,u){let h=a.Ba[a.currentUser.toKey()];h||(h=new We(xe)),h=h.insert(l,u),a.Ba[a.currentUser.toKey()]=h}(r,s.batchId,n),await qo(r,s.changes),await tu(r.remoteStore)}catch(s){const i=jh(s,"Failed to persist write");n.reject(i)}}async function cv(t,e){const n=ce(t);try{const r=await OE(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(Te(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?Te(a.va):s.removedDocuments.size>0&&(Te(a.va),a.va=!1))}),await qo(n,r,e)}catch(r){await zo(r)}}function Im(t,e,n){const r=ce(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const u=ce(a);u.onlineState=l;let h=!1;u.queries.forEach((p,g)=>{for(const m of g.j_)m.Z_(l)&&(h=!0)}),h&&Vh(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function TT(t,e,n){const r=ce(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new We(se.comparator);a=a.insert(i,Rt.newNoDocument(i,ue.min()));const l=pe().add(i),u=new Jl(ue.min(),new Map,new We(xe),a,l);await cv(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Lh(r)}else await ld(r.localStore,e,!1).then(()=>cd(r,e,n)).catch(zo)}async function IT(t,e){const n=ce(t),r=e.batch.batchId;try{const s=await LE(n.localStore,e);hv(n,r,null),dv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await qo(n,s)}catch(s){await zo(s)}}async function AT(t,e,n){const r=ce(t);try{const s=await function(a,l){const u=ce(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,l).next(g=>(Te(g!==null),p=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(r.localStore,e);hv(r,e,n),dv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await qo(r,s)}catch(s){await zo(s)}}function dv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function hv(t,e,n){const r=ce(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function cd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||fv(t,r)})}function fv(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Ph(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Lh(t))}function Am(t,e,n){for(const r of n)r instanceof av?(t.La.addReference(r.key,e),CT(t,r)):r instanceof lv?(re("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||fv(t,r.key)):le()}function CT(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(re("SyncEngine","New document in limbo: "+n),t.xa.add(r),Lh(t))}function Lh(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new se(Ve.fromString(e)),r=t.qa.next();t.Na.set(r,new gT(n)),t.Oa=t.Oa.insert(n,r),J0(t.remoteStore,new _r(jn(wh(n.path)),r,"TargetPurposeLimboResolution",mh.oe))}}async function qo(t,e,n){const r=ce(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{a.push(r.Ka(u,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const g=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){s.push(h);const g=Rh.Wi(u.targetId,h);i.push(g)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(u,h){const p=ce(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>$.forEach(h,m=>$.forEach(m.$i,I=>p.persistence.referenceDelegate.addReference(g,m.targetId,I)).next(()=>$.forEach(m.Ui,I=>p.persistence.referenceDelegate.removeReference(g,m.targetId,I)))))}catch(g){if(!Bo(g))throw g;re("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const m=g.targetId;if(!g.fromCache){const I=p.os.get(m),R=I.snapshotVersion,P=I.withLastLimboFreeSnapshotVersion(R);p.os=p.os.insert(m,P)}}}(r.localStore,i))}async function kT(t,e){const n=ce(t);if(!n.currentUser.isEqual(e)){re("SyncEngine","User change. New user:",e.toKey());const r=await Q0(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new Z(U.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await qo(n,r.hs)}}function RT(t,e){const n=ce(t),r=n.Na.get(e);if(r&&r.va)return pe().add(r.key);{let s=pe();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}function pv(t){const e=ce(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=cv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=RT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=TT.bind(null,e),e.Ca.d_=hT.bind(null,e.eventManager),e.Ca.$a=fT.bind(null,e.eventManager),e}function PT(t){const e=ce(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=AT.bind(null,e),e}class kl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Zl(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return VE(this.persistence,new ME,e.initialUser,this.serializer)}Ga(e){return new bE(kh.Zr,this.serializer)}Wa(e){return new $E}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}kl.provider={build:()=>new kl};class dd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Im(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=kT.bind(null,this.syncEngine),await uT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new dT}()}createDatastore(e){const n=Zl(e.databaseInfo.databaseId),r=function(i){return new GE(i)}(e.databaseInfo);return function(i,a,l,u){return new YE(i,a,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new JE(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Im(this.syncEngine,n,0),function(){return xm.D()?new xm:new WE}())}createSyncEngine(e,n){return function(s,i,a,l,u,h,p){const g=new yT(s,i,a,l,u,h);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ce(s);re("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Ho(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}dd.provider={build:()=>new dd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):rr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Lt.UNAUTHENTICATED,this.clientId=m0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{re("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(re("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Yn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=jh(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ju(t,e){t.asyncQueue.verifyOperationInProgress(),re("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Q0(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Cm(t,e){t.asyncQueue.verifyOperationInProgress();const n=await DT(t);re("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>wm(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>wm(e.remoteStore,s)),t._onlineComponents=e}async function DT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){re("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ju(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===U.FAILED_PRECONDITION||s.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Co("Error using user provided cache. Falling back to memory cache: "+n),await Ju(t,new kl)}}else re("FirestoreClient","Using default OfflineComponentProvider"),await Ju(t,new kl);return t._offlineComponents}async function gv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(re("FirestoreClient","Using user provided OnlineComponentProvider"),await Cm(t,t._uninitializedComponentsProvider._online)):(re("FirestoreClient","Using default OnlineComponentProvider"),await Cm(t,new dd))),t._onlineComponents}function NT(t){return gv(t).then(e=>e.syncEngine)}async function yv(t){const e=await gv(t),n=e.eventManager;return n.onListen=vT.bind(null,e.syncEngine),n.onUnlisten=wT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=_T.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=ST.bind(null,e.syncEngine),n}function MT(t,e,n={}){const r=new Yn;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,h){const p=new mv({next:m=>{p.Za(),a.enqueueAndForget(()=>iv(i,g));const I=m.docs.has(l);!I&&m.fromCache?h.reject(new Z(U.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&m.fromCache&&u&&u.source==="server"?h.reject(new Z(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(m)},error:m=>h.reject(m)}),g=new ov(wh(l.path),p,{includeMetadataChanges:!0,_a:!0});return sv(i,g)}(await yv(t),t.asyncQueue,e,n,r)),r.promise}function jT(t,e,n={}){const r=new Yn;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,h){const p=new mv({next:m=>{p.Za(),a.enqueueAndForget(()=>iv(i,g)),m.fromCache&&u.source==="server"?h.reject(new Z(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(m)},error:m=>h.reject(m)}),g=new ov(l,p,{includeMetadataChanges:!0,_a:!0});return sv(i,g)}(await yv(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vv(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const km=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(t,e,n){if(!n)throw new Z(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function VT(t,e,n,r){if(e===!0&&r===!0)throw new Z(U.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Rm(t){if(!se.isDocumentKey(t))throw new Z(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Pm(t){if(se.isDocumentKey(t))throw new Z(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function nu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":le()}function On(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Z(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=nu(t);throw new Z(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Z(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Z(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=vv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Z(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Z(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Z(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Oh{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bm({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Z(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Z(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new eS;switch(r.type){case"firstParty":return new rS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Z(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=km.get(n);r&&(re("ComponentProvider","Removing Datastore"),km.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new vi(this.firestore,e,this._query)}}class Mt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new br(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Mt(this.firestore,e,this._key)}}class br extends vi{constructor(e,n,r){super(e,n,wh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Mt(this.firestore,null,new se(e))}withConverter(e){return new br(this.firestore,e,this._path)}}function Hn(t,e,...n){if(t=Tn(t),_v("collection","path",e),t instanceof Oh){const r=Ve.fromString(e,...n);return Pm(r),new br(t,null,r)}{if(!(t instanceof Mt||t instanceof br))throw new Z(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ve.fromString(e,...n));return Pm(r),new br(t.firestore,null,r)}}function un(t,e,...n){if(t=Tn(t),arguments.length===1&&(e=m0.newId()),_v("doc","path",e),t instanceof Oh){const r=Ve.fromString(e,...n);return Rm(r),new Mt(t,null,new se(r))}{if(!(t instanceof Mt||t instanceof br))throw new Z(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ve.fromString(e,...n));return Rm(r),new Mt(t.firestore,t instanceof br?t.converter:null,new se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Y0(this,"async_queue_retry"),this.Vu=()=>{const r=Xu();r&&re("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Xu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Xu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Yn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Bo(e))throw e;re("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw rr("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Mh.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&le()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class vs extends Oh{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Dm,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Dm(e),this._firestoreClient=void 0,await e}}}function LT(t,e,n){n||(n="(default)");const r=i0(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(xl(i,e))return s;throw new Z(U.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Z(U.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Z(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function Fh(t){if(t._terminated)throw new Z(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||OT(t),t._firestoreClient}function OT(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,h,p){return new gS(l,u,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,vv(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new bT(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ci(vt.fromBase64String(e))}catch(n){throw new Z(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ci(vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Z(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Z(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Z(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT=/^__.*__$/;class zT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new zr(e,this.data,this.fieldMask,n,this.fieldTransforms):new $o(e,this.data,n,this.fieldTransforms)}}class xv{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new zr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function wv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw le()}}class Uh{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Uh(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Rl(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(wv(this.Cu)&&FT.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class BT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Zl(e)}Qu(e,n,r,s=!1){return new Uh({Cu:e,methodName:n,qu:r,path:pt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function iu(t){const e=t._freezeSettings(),n=Zl(t._databaseId);return new BT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Sv(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);Wh("Data must be an object, but it was:",a,r);const l=Ev(r,a);let u,h;if(i.merge)u=new tn(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const p=[];for(const g of i.mergeFields){const m=hd(e,g,n);if(!a.contains(m))throw new Z(U.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Iv(p,m)||p.push(m)}u=new tn(p),h=a.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=a.fieldTransforms;return new zT(new Ft(l),u,h)}class ou extends su{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ou}}class $h extends su{_toFieldTransform(e){return new BS(e.path,new Do)}isEqual(e){return e instanceof $h}}function UT(t,e,n,r){const s=t.Qu(1,e,n);Wh("Data must be an object, but it was:",s,r);const i=[],a=Ft.empty();gs(r,(u,h)=>{const p=Hh(e,u,n);h=Tn(h);const g=s.Nu(p);if(h instanceof ou)i.push(p);else{const m=Go(h,g);m!=null&&(i.push(p),a.set(p,m))}});const l=new tn(i);return new xv(a,l,s.fieldTransforms)}function $T(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[hd(e,r,n)],u=[s];if(i.length%2!=0)throw new Z(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(hd(e,i[m])),u.push(i[m+1]);const h=[],p=Ft.empty();for(let m=l.length-1;m>=0;--m)if(!Iv(h,l[m])){const I=l[m];let R=u[m];R=Tn(R);const P=a.Nu(I);if(R instanceof ou)h.push(I);else{const O=Go(R,P);O!=null&&(h.push(I),p.set(I,O))}}const g=new tn(h);return new xv(p,g,a.fieldTransforms)}function WT(t,e,n,r=!1){return Go(n,t.Qu(r?4:3,e))}function Go(t,e){if(Tv(t=Tn(t)))return Wh("Unsupported field value:",e,t),Ev(t,e);if(t instanceof su)return function(r,s){if(!wv(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let u=Go(l,s.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Tn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return OS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=rt.fromDate(r);return{timestampValue:Al(s.serializer,i)}}if(r instanceof rt){const i=new rt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Al(s.serializer,i)}}if(r instanceof zh)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ci)return{bytesValue:B0(s.serializer,r._byteString)};if(r instanceof Mt){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Ah(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Bh)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return Sh(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${nu(r)}`)}(t,e)}function Ev(t,e){const n={};return g0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):gs(t,(r,s)=>{const i=Go(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Tv(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof rt||t instanceof zh||t instanceof ci||t instanceof Mt||t instanceof su||t instanceof Bh)}function Wh(t,e,n){if(!Tv(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=nu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function hd(t,e,n){if((e=Tn(e))instanceof ru)return e._internalPath;if(typeof e=="string")return Hh(t,e);throw Rl("Field path arguments must be of type string or ",t,!1,void 0,n)}const HT=new RegExp("[~\\*/\\[\\]]");function Hh(t,e,n){if(e.search(HT)>=0)throw Rl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ru(...e.split("."))._internalPath}catch{throw Rl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Rl(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new Z(U.INVALID_ARGUMENT,l+t+u)}function Iv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Mt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new qT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(qh("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class qT extends Av{data(){return super.data()}}function qh(t,e){return typeof e=="string"?Hh(t,e):e instanceof ru?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Z(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gh{}class QT extends Gh{}function qi(t,e,...n){let r=[];e instanceof Gh&&r.push(e),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof Qh).length,l=i.filter(u=>u instanceof au).length;if(a>1||a>0&&l>0)throw new Z(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class au extends QT{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new au(e,n,r)}_apply(e){const n=this._parse(e);return Cv(e._query,n),new vi(e.firestore,e.converter,nd(e._query,n))}_parse(e){const n=iu(e.firestore);return function(i,a,l,u,h,p,g){let m;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new Z(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Mm(g,p);const I=[];for(const R of g)I.push(Nm(u,i,R));m={arrayValue:{values:I}}}else m=Nm(u,i,g)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Mm(g,p),m=WT(l,a,g,p==="in"||p==="not-in");return Je.create(h,p,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function fd(t,e,n){const r=e,s=qh("where",t);return au._create(s,r,n)}class Qh extends Gh{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Qh(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:In.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const u of l)Cv(a,u),a=nd(a,u)}(e._query,n),new vi(e.firestore,e.converter,nd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Nm(t,e,n){if(typeof(n=Tn(n))=="string"){if(n==="")throw new Z(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!I0(e)&&n.indexOf("/")!==-1)throw new Z(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ve.fromString(n));if(!se.isDocumentKey(r))throw new Z(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return tm(t,new se(r))}if(n instanceof Mt)return tm(t,n._key);throw new Z(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${nu(n)}.`)}function Mm(t,e){if(!Array.isArray(t)||t.length===0)throw new Z(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Cv(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Z(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Z(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class KT{convertValue(e,n="none"){switch(fs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(hs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw le()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return gs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>Ge(a.doubleValue));return new Bh(i)}convertGeoPoint(e){return new zh(Ge(e.latitude),Ge(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=yh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ro(e));default:return null}}convertTimestamp(e){const n=jr(e);return new rt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ve.fromString(e);Te(G0(r));const s=new Po(r.get(1),r.get(3)),i=new se(r.popFirst(5));return s.isEqual(n)||rr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Rv extends Av{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ka(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(qh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Ka extends Rv{data(e={}){return super.data(e)}}class YT{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Gi(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ka(this._firestore,this._userDataWriter,r.key,r,new Gi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Z(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const u=new Ka(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Gi(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Ka(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Gi(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,p=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:XT(l.type),doc:u,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function XT(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return le()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JT(t){t=On(t,Mt);const e=On(t.firestore,vs);return MT(Fh(e),t._key).then(n=>eI(e,t,n))}class Pv extends KT{constructor(e){super(),this.firestore=e}convertBytes(e){return new ci(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Mt(this.firestore,null,n)}}function bs(t){t=On(t,vi);const e=On(t.firestore,vs),n=Fh(e),r=new Pv(e);return GT(t._query),jT(n,t._query).then(s=>new YT(e,r,t,s))}function ZT(t,e,n){t=On(t,Mt);const r=On(t.firestore,vs),s=kv(t.converter,e);return lu(r,[Sv(iu(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,fn.none())])}function qn(t,e,n,...r){t=On(t,Mt);const s=On(t.firestore,vs),i=iu(s);let a;return a=typeof(e=Tn(e))=="string"||e instanceof ru?$T(i,"updateDoc",t._key,e,n,r):UT(i,"updateDoc",t._key,e),lu(s,[a.toMutation(t._key,fn.exists(!0))])}function Zu(t){return lu(On(t.firestore,vs),[new Eh(t._key,fn.none())])}function Kh(t,e){const n=On(t.firestore,vs),r=un(t),s=kv(t.converter,e);return lu(n,[Sv(iu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,fn.exists(!1))]).then(()=>r)}function lu(t,e){return function(r,s){const i=new Yn;return r.asyncQueue.enqueueAndForget(async()=>ET(await NT(r),s,i)),i.promise}(Fh(t),e)}function eI(t,e,n){const r=n.docs.get(e._key),s=new Pv(t);return new Rv(t,s,e._key,r,new Gi(n.hasPendingWrites,n.fromCache),e.converter)}function dn(){return new $h("serverTimestamp")}(function(e,n=!0){(function(s){mi=s})(zw),Io(new si("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new vs(new tS(r.getProvider("auth-internal")),new iS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Z(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Po(h.options.projectId,p)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Pr(Yp,"4.7.3",e),Pr(Yp,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pd="us-central1";class nI{constructor(e,n,r,s,i=pd,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new tI(n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=pd}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function rI(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const jm="@firebase/functions",Vm="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI="auth-internal",iI="app-check-internal",oI="messaging-internal";function aI(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),a=r.getProvider(sI),l=r.getProvider(oI),u=r.getProvider(iI);return new nI(i,a,l,u,s,t)};Io(new si(bv,n,"PUBLIC").setMultipleInstances(!0)),Pr(jm,Vm,e),Pr(jm,Vm,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(t=Bw(),e=pd){const r=i0(Tn(t),bv).getImmediate({identifier:e}),s=D1("functions");return s&&uI(r,...s),r}function uI(t,e,n){rI(Tn(t),e,n)}aI(fetch.bind(self));const cI={apiKey:'"AIzaSyDRdl4zhwoZumVtphmJ19orZ8HoR0WQQZM",',authDomain:'"qualtrics-game-backend.firebaseapp.com",',projectId:'"qualtrics-game-backend",',storageBucket:'"qualtrics-game-backend.firebasestorage.app",',messagingSenderId:'"441267092549",',appId:"1:441267092549:web:6ce075f5f3ea7cf958772c"},Dv=o0(cI),Ye=LT(Dv,{experimentalForceLongPolling:!1,useFetchStreams:!1});lI(Dv);const je={init(){localStorage.getItem("sessionId")||(localStorage.setItem("sessionId",this.generateSessionId()),localStorage.setItem("sessionStartTime",Date.now().toString())),localStorage.getItem("semesterStartTime")||localStorage.setItem("semesterStartTime",Date.now().toString())},generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},async logEvent(t,e){const n=localStorage.getItem("sessionId")||this.generateSessionId(),r=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),s=Date.now(),i=s-r,a=(i/1e3).toFixed(1),l=Math.floor(i/6e4),u=Math.floor(i%6e4/1e3),h=`${l}:${u.toString().padStart(2,"0")}`,p=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),g=this.getFullGameContext(),m={sessionId:n,studentId:p.studentId||null,type:t,timestamp:new Date().toISOString(),clientTimestamp:s,timeElapsedSeconds:parseFloat(a),readableTime:h,semesterTime:this.getSemesterTime(),...g,isAdminMode:p.role==="admin",hasCheckpoint:p.checkpointSemester2||!1,hasAI:p.hasAI||!1,section:p.section||null,...this.convertTimesToSeconds(e)};(t==="user_action"||t==="task_attempt")&&console.log(`DEBUG: Event ${t} - studentId: ${m.studentId}, role: ${p.role}`);try{await Kh(Hn(Ye,"events"),m)}catch(I){console.error("Failed to log event:",I),this.storeOfflineEvent(m)}},convertTimesToSeconds(t){const e={...t},n=["timeTaken","timeSpent","totalTime","timeOnPreviousPage","averageTime","timeBetweenHelpAndSubmit"];for(const r of n)e[r]!==void 0&&e[r]!==null&&(e[`${r}Seconds`]=(e[r]/1e3).toFixed(1),delete e[r]);return e.timeProgression&&(e.timeProgressionSeconds=e.timeProgression.map(r=>(r/1e3).toFixed(1)),delete e.timeProgression),e.timePerAttempt&&(e.timePerAttemptSeconds=e.timePerAttempt.map(r=>(r/1e3).toFixed(1)),delete e.timePerAttempt),e},getSemesterTime(){const t=parseInt(localStorage.getItem("semesterStartTime")||Date.now()),e=Date.now()-t,n=(e/1e3).toFixed(1),r=Math.floor(e/6e4),s=Math.floor(e%6e4/1e3);return{elapsedSeconds:parseFloat(n),readable:`${r}:${s.toString().padStart(2,"0")}`,minutes:r,seconds:s}},getCurrentContext(){const t=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),e=((Date.now()-t)/1e3).toFixed(1);return{currentTask:localStorage.getItem("currentTask"),gameMode:localStorage.getItem("gameMode"),totalCompleted:this.getCompletedTaskCount(),currentStreak:this.getCurrentStreak(),sessionDurationSeconds:parseFloat(e)}},getFullGameContext(){const t=localStorage.getItem("currentTask")||"",e=localStorage.getItem("gameMode")||"",n=parseInt(localStorage.getItem("currentSemester")||"1"),r=parseInt(localStorage.getItem("totalSemesters")||"2"),s=localStorage.getItem("practiceCompleted")==="true",i=parseInt(localStorage.getItem("completedTasksCount")||"0"),a=parseInt(localStorage.getItem("completedLevels")||"0"),l=parseInt(localStorage.getItem("totalSwitches")||"0"),u=parseInt(localStorage.getItem("aiUsageCount")||"0"),h=JSON.parse(localStorage.getItem("categoryPoints")||"{}"),p=parseFloat(localStorage.getItem("studentLearningScore")||"0");return{currentTask:t,gameMode:e,currentSemester:n,totalSemesters:r,practiceCompleted:s,completedTasks:i,completedLevels:a,totalSwitches:l,aiUsageCount:u,studentLearning:p,totalBonus:h.bonus||0,finalScore:Math.round(p)+(h.bonus||0),semester:n}},calculateImprovementTrend(t){if(!t||t.length<3)return"needs_more_data";const n=t.slice(-5).map(s=>s.accuracy),r=this.calculateTrend(n);return r>5?"rapid_improvement":r>2?"steady_improvement":r>0?"slight_improvement":r>-2?"stable":r>-5?"slight_decline":"rapid_decline"},calculateImprovementRate(t){if(!t||t.length<2)return{overall:0,trend:0,isImproving:!1,dataPoints:t?t.length:0};const e=t[0].accuracy,r=t[t.length-1].accuracy-e;if(t.length<3)return{overall:r,trend:r,isImproving:r>0,dataPoints:t.length};const s=Math.floor(t.length/2),i=t.slice(0,s).reduce((u,h)=>u+h.accuracy,0)/s,l=t.slice(s).reduce((u,h)=>u+h.accuracy,0)/(t.length-s)-i;return{overall:r,trend:l,isImproving:l>0,dataPoints:t.length}},setPageStartTime(t){t&&localStorage.setItem(`pageStartTime_${t}`,Date.now().toString())},getTimeOnCurrentPage(t){if(!t)return 0;const e=localStorage.getItem(`pageStartTime_${t}`);return e?Date.now()-parseInt(e):0},ensureSession(){localStorage.getItem("sessionId")||this.init()},async trackAIHelpResponse(t,e,n,r,s,i){const a=parseInt(localStorage.getItem("aiUsageCount")||"0");return localStorage.setItem("aiUsageCount",(a+1).toString()),this.logEvent("ai_help_response",{taskId:t,helpType:e,suggestion:n,playerAction:r,playerValue:s,timeBetween:i})},async trackTaskAttempt(t,e){return this.logEvent("task_attempt",{taskId:t,...e})},async trackUserAction(t,e){return this.logEvent("user_action",{action:t,response:e.response||"",query:e.query||"",queryType:e.queryType||"",choice:e.choice||"",currentMode:e.currentMode||"",...e})},async syncOfflineEvents(){return console.log("Syncing offline events..."),Promise.resolve()},async trackTaskComplete(t,e){return this.logEvent("task_complete",{taskId:t,...e})},async trackPageSwitch(t,e,n){return this.logEvent("page_switch",{from:t,to:e,isAutoAdvance:n})},trackAITaskHelp(t,e,n,r,s){return this.logEvent("ai_task_help",{taskId:t,taskType:e,suggestion:n,wasCorrect:r,attemptNumber:s})}};je.init();const Xn={seedRandom:null,currentSeed:null,initializeSeed(t){this.currentSeed=t;let e=t;this.seedRandom=function(){return e=(e*9301+49297)%233280,e/233280}},getRandom(){return this.seedRandom?this.seedRandom():Math.random()},generateCountingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n;e==="easy"?n=(t-1)%5+1:e==="medium"?n=(t-11)%5+6:n=(t-25)%5+11;const s={easy:{1:{target:"the",type:"word"},2:{target:"and",type:"word"},3:{target:"of",type:"word"},4:{target:"to",type:"word"},5:{target:"in",type:"word"}},medium:{6:{target:"e",type:"letter"},7:{target:"a",type:"letter"},8:{target:"i",type:"letter"},9:{target:"o",type:"letter"},10:{target:"s",type:"letter"}},hard:{11:{targets:["a","e"],type:"multi-letter"},12:{targets:["i","o"],type:"multi-letter"},13:{targets:["s","t"],type:"multi-letter"},14:{targets:["n","r"],type:"multi-letter"},15:{targets:["l","d"],type:"multi-letter"}}}[e][n];let i="";return s.type==="word"?i=`Count how many times the word "${s.target}" appears:`:s.type==="letter"?i=`Count how many times the letter "${s.target}" appears (case-insensitive):`:i=`Count how many times the letters "${s.targets[0]}" and "${s.targets[1]}" appear in total:`,{...s,instruction:i,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},generateSliderPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n,r,s;return e==="easy"?(n=Math.floor(this.getRandom()*11),r=1,s=!0):e==="medium"?(n=Math.round(this.getRandom()*10*10)/10,r=.1,s=!0):(n=Math.round(this.getRandom()*10*100)/100,r=.01,s=(t-25)%5!==0),{target:n,step:r,showValue:s,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1),precision:e==="easy"?0:e==="medium"?1:2}},generateTypingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard",n={easy:["hello world","quick test","type this","easy mode","simple text","good job","keep going","nice work","almost done","level up"],medium:["HeLLo WoRLd","QuIcK tEsT","TyPe ThIs","MeDiUm MoDe","MiXeD cAsE","KeEp GoInG","NiCe WoRk","AlMoSt DoNe","LeVeL uP","ChAlLeNgE","TeSt RuN","NeXt LeVeL","TrY aGaIn","GoOd LuCk","FiNaL tEsT"],hard:["Test@123","Go4It!Now","X9%Y8&Z7*","P6!Q5?R4+","Z1@Y2#X3$","M7&N8*O9!","J4%K5^L6&","D1!E2@F3#","A7$B8%C9^","V3*W4+X5=","Q2#R3$S4%","H5^I6&J7*","K8(L9)M0!","N1@O2#P3$","T4%U5^V6&","W7*X8(Y9)","C0!D1@E2#","F3$G4%H5^","I6&J7*K8(","L9)M0!N1@","O2#P3$Q4%","R5^S6&T7*","U8(V9)W0!","X1@Y2#Z3$","A4%B5^C6&"]};let r;if(e==="easy"){const s=(t-1)%n.easy.length;r=n.easy[s]}else if(e==="medium"){const s=(t-11)%n.medium.length;r=n.medium[s]}else{const s=(t-25)%n.hard.length;r=n.hard[s]}return{pattern:r,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},textPassages:["The University of California, Berkeley (UC Berkeley, Berkeley, Cal, or California) is a public land-grant research university in Berkeley, California, United States. Founded in 1868 and named after the Anglo-Irish philosopher George Berkeley, it is the state's first land-grant university and is the founding campus of the University of California system.","Berkeley has an enrollment of more than 45,000 students. The university is organized around fifteen schools of study on the same campus, including the College of Chemistry, the College of Engineering, College of Letters and Science, and the Haas School of Business.",'The Berkeley campus encompasses approximately 1,232 acres, though the "central campus" occupies only the low-lying western 178 acres. The campus contains numerous wooded areas, including the Eucalyptus Grove and Strawberry Creek, which runs through the center of campus.',"Oski the Bear (Oski) is the official mascot of the University of California, Berkeley, representing the California Golden Bears. Named after the Oski Yell, he made his debut at a freshman rally in the Greek Theatre on September 25, 1941.","Berkeley faculty, alumni, and researchers have won 111 Nobel laureates, 25 Turing Award winners, and 19 Academy Award winners. The university has produced many notable alumni in various fields including science, politics, business, and entertainment.","The university's athletic teams compete as the California Golden Bears and are members of the Atlantic Coast Conference for most sports. Berkeley teams have won 107 national championships, including 45 NCAA national championships.","Research at Berkeley is conducted within departments, organized research units, and interdisciplinary research centers. Berkeley operates Lawrence Berkeley National Laboratory, manages Los Alamos National Laboratory, and is a founding partner of the Space Sciences Laboratory.","The Berkeley campus offers over 350 degree programs through its 14 colleges and schools. Popular majors include Computer Science, Economics, Political Science, and Business Administration. The student-faculty ratio is 17:1.","Berkeley's libraries contain more than 13 million volumes and maintain special collections including the Mark Twain Papers, the Oral History Center, and the Bancroft Library, which houses the largest collection of materials on California history.","The campus is home to several museums including the Berkeley Art Museum and Pacific Film Archive, the Lawrence Hall of Science, and the UC Botanical Garden. These facilities serve both educational and public outreach purposes.","Notable Berkeley inventions and discoveries include the cyclotron, the atomic bomb, the flu vaccine, and vitamin E. Berkeley researchers discovered 16 chemical elements of the periodic table, more than any other university.","The Free Speech Movement, which took place during the 1964-65 academic year, was a pivotal moment in the history of civil liberties in the United States. It began when students protested a ban on political activities on campus.","Berkeley's Campanile, known as Sather Tower, is the third-tallest clock tower in the world at 307 feet. It was completed in 1914 and is visible for miles, serving as a symbol of the university.","The university operates on a semester system, with fall semester beginning in late August and spring semester beginning in mid-January. Berkeley offers over 5,000 courses each semester across all disciplines.",`Cal Bears have won at least one team national title in 13 different sports. The university's traditional rival is Stanford University, with the annual football game known as "The Big Game" dating back to 1892.`],getTextPassage(t){if(this.seedRandom){const e=Math.floor(this.getRandom()*this.textPassages.length),n=(t-1+e)%this.textPassages.length;return this.textPassages[n]}else{const e=(t-1)%this.textPassages.length;return this.textPassages[e]}}};function md({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=j.useState(""),[a,l]=j.useState(""),[u,h]=j.useState(null),[p,g]=j.useState(""),[m,I]=j.useState(null),[R,P]=j.useState(""),[O,k]=j.useState(""),[A]=j.useState(Date.now()),[C,N]=j.useState(""),[V,F]=j.useState(!1),[w,v]=j.useState(new Set),E=j.useRef(0);j.useRef(null);const T=(ee,Y=null,B=null)=>{const D=document.createElement("canvas"),z=D.getContext("2d");D.width=900,D.height=400,z.fillStyle="#fafafa",z.fillRect(0,0,D.width,D.height),z.strokeStyle="#e0e0e0",z.lineWidth=2,z.strokeRect(0,0,D.width,D.height),z.font="24px monospace",z.fillStyle="#333";const L=36,W=25,J=D.width-W*2;return((we,he)=>{const de=we.split(" "),Fe=[];let Se="";for(let ne of de){const Ce=Se+(Se?" ":"")+ne;z.measureText(Ce).width>he&&Se?(Fe.push(Se),Se=ne):Se=Ce}return Se&&Fe.push(Se),Fe})(ee,J).forEach((we,he)=>{const de=W+(he+1)*L;let Fe=W;if(t<=5){const Se=we.split(" ");let ne=0;Se.forEach(Ce=>{const be=B&&B.has(ne),ke=Y&&Y.some(_t=>Ce.toLowerCase()===_t.toLowerCase());if(be){const _t=z.measureText(Ce).width;z.fillStyle="yellow",z.fillRect(Fe-2,de-18,_t+4,24)}else if(ke){const _t=z.measureText(Ce).width;z.fillStyle="rgba(255, 215, 0, 0.4)",z.fillRect(Fe-2,de-18,_t+4,24)}z.fillStyle="#333",z.fillText(Ce,Fe,de),Fe+=z.measureText(Ce+" ").width,ne++})}else for(let Se=0;Se<we.length;Se++){const ne=we[Se],Ce=z.measureText(ne).width;Y&&Y.some(ke=>ne.toLowerCase()===ke.toLowerCase())&&(z.fillStyle="rgba(255, 215, 0, 0.4)",z.fillRect(Fe-1,de-18,Ce+2,24)),z.fillStyle="#333",z.fillText(ne,Fe,de),Fe+=Ce}}),D.toDataURL()};j.useEffect(()=>{g(0),I(null),E.current=0},[t]),j.useEffect(()=>{const ee=async(B,D)=>{const z=document.createElement("canvas"),L=z.getContext("2d");z.width=900,z.height=350,L.fillStyle="#fafafa",L.fillRect(0,0,z.width,z.height),L.strokeStyle="#e0e0e0",L.lineWidth=2,L.strokeRect(0,0,z.width,z.height),L.font="24px monospace";const W=36,J=20,ie=z.width-J*2,we=((he,de)=>{const Fe=he.split(" "),Se=[];let ne="";for(let Ce of Fe){const be=ne+(ne?" ":"")+Ce;L.measureText(be).width>de&&ne?(Se.push(ne),ne=Ce):ne=be}return ne&&Se.push(ne),Se})(R,ie);for(let he=0;he<B.length;he++)B[he],we.forEach((de,Fe)=>{const Se=J+(Fe+1)*W;let ne=J;for(let Ce=0;Ce<de.length;Ce++){const be=de[Ce],ke=L.measureText(be).width;B.some(Wt=>be.toLowerCase()===Wt.toLowerCase())&&(L.fillStyle="rgba(255, 255, 0, 0.6)",L.fillRect(ne-1,Se-20,ke+2,26)),L.fillStyle="#333",L.fillText(be,ne,Se),ne+=ke}}),N(z.toDataURL()),await new Promise(de=>setTimeout(de,300));setTimeout(()=>{g(D.toString())},300)},Y=async B=>{const{action:D,highlightWords:z,suggestedCount:L,animate:W,isMultiLetter:J,targetLetters:ie}=B.detail||{};if(D==="highlightAndCount"){if(J&&Array.isArray(ie)){W&&await ee(ie,L);return}if(Array.isArray(z)&&W){R.split(" ");let Ae=[];for(let we=0;we<z.length;we++){Ae.push(z[we]);const he=document.createElement("canvas"),de=he.getContext("2d");he.width=900,he.height=350,de.fillStyle="#fafafa",de.fillRect(0,0,he.width,he.height),de.strokeStyle="#e0e0e0",de.lineWidth=2,de.strokeRect(0,0,he.width,he.height),de.font="24px monospace";const Fe=36,Se=20,ne=he.width-Se*2;((ke,_t)=>{const Wt=ke.split(" "),Ht=[];let qt="";for(let Gt of Wt){const Qt=qt+(qt?" ":"")+Gt;de.measureText(Qt).width>_t&&qt?(Ht.push(qt),qt=Gt):qt=Qt}return qt&&Ht.push(qt),Ht})(R,ne).forEach((ke,_t)=>{const Wt=Se+(_t+1)*Fe;let Ht=Se;ke.split(" ").forEach(Gt=>{const Qt=de.measureText(Gt).width;Ae.some(An=>{const ar=Gt.replace(/[.,;!?]/g,"").toLowerCase(),Re=An.replace(/[.,;!?]/g,"").toLowerCase();return ar===Re})&&(de.fillStyle="rgba(255, 255, 0, 0.5)",de.fillRect(Ht-2,Wt-18,Qt+4,24)),de.fillStyle="#333",de.fillText(Gt,Ht,Wt),Ht+=de.measureText(Gt+" ").width})}),N(he.toDataURL()),await new Promise(ke=>setTimeout(ke,200))}setTimeout(()=>{g(L.toString())},300)}}};return window.addEventListener("aiCountingHelp",Y),()=>window.removeEventListener("aiCountingHelp",Y)},[R,t]),j.useEffect(()=>{var z;const ee=Xn.generateCountingPattern(t),Y=Xn.getTextPassage(t);P(Y),i(ee.target||((z=ee.targets)==null?void 0:z.join(", "))),l(ee.instruction);let B=0;if(ee.type==="word"){const L=new RegExp(`\\b${ee.target}\\b`,"gi"),W=Y.match(L);B=W?W.length:0}else if(ee.type==="letter"){const L=new RegExp(ee.target,"gi"),W=Y.match(L);B=W?W.length:0}else ee.type==="multi-letter"&&ee.targets.forEach(L=>{const W=new RegExp(L,"gi"),J=Y.match(W);B+=J?J.length:0});h(B);const D=T(Y,null);N(D)},[t]);const _=async()=>{const ee=Date.now()-A,Y=parseInt(p,10)||0,B=u??0,D=Math.abs(Y-B),z=`g1t${t}`,L=localStorage.getItem(`lastAIHelp_${z}`);if(L){const ie=JSON.parse(L),Ae=Date.now()-ie.timestamp,we=Y===ie.suggestion?"accepted":"modified";await je.trackAIHelpResponse(z,ie.type,ie.suggestion,we,Y,Ae),localStorage.removeItem(`lastAIHelp_${z}`)}let W=0;D===0?W=2:D<=1?W=1:W=0,E.current+=1,await je.trackTaskAttempt(z,E.current,!0,ee,Y,B);const J=localStorage.getItem("sessionId");if(J&&!J.startsWith("offline-"))try{await qn(un(Ye,"sessions",J),{[`taskAccuracies.g1t${t}`]:W===2?100:W===1?70:0,[`taskTimes.g1t${t}`]:ee,[`taskPoints.g1t${t}`]:W,lastActivity:dn()})}catch(ie){console.error("Error storing accuracy:",ie)}I(W===2?"✓ Perfect! 2 points earned!":W===1?`✓ Off by ${D} - 1 point earned!`:`✓ Off by ${D} - 0 points earned.`),setTimeout(()=>{e==null||e(`g1t${t}`,{attempts:E.current,totalTime:ee,accuracy:W===2?100:W===1?70:0,userAnswer:Y,correctAnswer:B,points:W})},500)},x=Xn.generateCountingPattern(t).difficultyLabel,X=t<=5?"easy":t<=10?"medium":"hard";return d.jsxs("div",{className:"task counting",children:[d.jsxs("h3",{children:["Research Content - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${X}`,children:x}),d.jsxs("p",{className:"instruction",children:[d.jsx("strong",{children:a}),d.jsx("br",{}),d.jsx("span",{className:"hint",children:"(Case-insensitive)"})]}),d.jsxs("div",{className:"text-display text-to-count","data-counting-text":R,children:[d.jsx("div",{className:"count-target","data-pattern":s,style:{display:"none"},children:s}),C?d.jsx("img",{src:C,alt:"Text passage for counting",style:{width:"100%",maxWidth:"900px",height:"auto",maxHeight:"350px",objectFit:"contain",border:"none",userSelect:"none",pointerEvents:"none"},onContextMenu:ee=>ee.preventDefault(),draggable:!1}):d.jsx("div",{dangerouslySetInnerHTML:{__html:O}})]}),d.jsxs("div",{className:"input-section",children:[d.jsx("label",{children:"Your answer:"}),d.jsx("input",{type:"number",min:"0",max:"999",value:p,onChange:ee=>g(ee.target.value),onKeyPress:ee=>{ee.key==="Enter"&&_()},placeholder:"Enter count"})]}),d.jsx("button",{onClick:_,className:"submit-btn",style:{display:"block",margin:"20px auto 0"},children:"Submit"}),m&&d.jsx("div",{className:`feedback ${m.includes("2 points")?"correct":m.includes("0 points")?"incorrect":"partial"}`,children:m})]})}function gd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=j.useState(5),[a,l]=j.useState(0),[u,h]=j.useState(null),[p]=j.useState(Date.now()),[g,m]=j.useState(1),[I,R]=j.useState(!0),[P,O]=j.useState(!1),[k,A]=j.useState(!1),[C,N]=j.useState(!1),[V,F]=j.useState(!1),w=j.useRef(null),v=j.useRef(0);j.useEffect(()=>{if(n)i(3),m(1),R(!0);else{const B=Xn.generateSliderPattern(t);i(B.target),m(B.step),R(B.showValue)}l(0),h(null),v.current=0},[t,n]),j.useEffect(()=>{const B=D=>{const{action:z,value:L,animate:W}=D.detail;if(z==="moveSlider")if(A(!0),W){const J=parseFloat(a),ie=parseFloat(L),Ae=1e3,we=30;let he=0;const de=setInterval(()=>{he++;const Fe=he/we,Se=1-Math.pow(1-Fe,3),ne=J+(ie-J)*Se;l(parseFloat(ne.toFixed(2))),he>=we&&(clearInterval(de),A(!1),l(parseFloat(ie.toFixed(2))))},Ae/we)}else l(parseFloat(L.toFixed(2))),A(!1)};return window.addEventListener("aiSliderHelp",B),()=>window.removeEventListener("aiSliderHelp",B)},[a]),j.useEffect(()=>{const B=D=>{D.key==="Enter"&&!k&&S()};return document.addEventListener("keypress",B),()=>document.removeEventListener("keypress",B)},[k,a,s]);const E=B=>{if(k)return;const D=w.current;if(!D)return;B.preventDefault();const z=D.getBoundingClientRect(),L=a/10,W=z.left+z.width*L,J=B.clientX||B.touches&&B.touches[0].clientX;Math.abs(J-W)<30&&(N(!0),F(!0))},T=B=>{if(!C||k)return;const D=w.current;if(!D)return;const z=D.getBoundingClientRect(),L=B.clientX||B.touches&&B.touches[0].clientX,J=Math.max(0,Math.min(1,(L-z.left)/z.width))*10,ie=Math.round(J/g)*g;l(parseFloat(ie.toFixed(2)))},_=()=>{N(!1)};j.useEffect(()=>{if(C){const B=z=>T(z),D=()=>_();return document.addEventListener("mousemove",B),document.addEventListener("mouseup",D),document.addEventListener("touchmove",B),document.addEventListener("touchend",D),()=>{document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",D),document.removeEventListener("touchmove",B),document.removeEventListener("touchend",D)}}},[C,g,k]);const S=async()=>{const B=Date.now()-p,D=parseFloat(a),z=Math.abs(D-s),L=`g2t${t}`,W=localStorage.getItem(`lastAIHelp_${L}`);if(W){const Ae=JSON.parse(W),we=Date.now()-Ae.timestamp,he=D===Ae.suggestion?"accepted":"modified";await je.trackAIHelpResponse(L,Ae.type,Ae.suggestion,he,D,we),localStorage.removeItem(`lastAIHelp_${L}`)}let J=0;z===0?J=2:z<=1?J=1:J=0,v.current+=1,await je.trackTaskAttempt(L,v.current,!0,B,D,s);const ie=localStorage.getItem("sessionId");if(ie&&!ie.startsWith("offline-"))try{await qn(un(Ye,"sessions",ie),{[`taskDifferences.g2t${t}`]:z,[`taskTimes.g2t${t}`]:B,[`taskPoints.g2t${t}`]:J,lastActivity:dn()})}catch(Ae){console.error("Error storing difference:",Ae)}h(J===2?"✓ Perfect! 2 points earned!":J===1?`✓ Off by ${z.toFixed(2)} - 1 point earned!`:`✓ Off by ${z.toFixed(2)} - 0 points earned.`),setTimeout(()=>{e(`g2t${t}`,{attempts:v.current,totalTime:B,accuracy:J===2?100:J===1?70:0,userAnswer:D,correctAnswer:s,points:J})},500)},x=Xn.generateSliderPattern(t),X=x.difficultyLabel,ee=x.difficulty,Y=()=>{const B=[];for(let D=0;D<=10;D++)B.push(d.jsxs("div",{style:{position:"absolute",left:`${D*10}%`,transform:"translateX(-50%)",textAlign:"center"},children:[d.jsx("div",{style:{width:"2px",height:"12px",background:"#666",margin:"0 auto"}}),d.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:D})]},D));return B};return d.jsxs("div",{className:`task slider ${k?"ai-controlled":""}`,children:[d.jsxs("h3",{children:["Material Creation - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${ee}`,children:X}),d.jsxs("p",{className:"instruction",children:["Move the slider to:"," ",d.jsx("strong",{className:"target-value","data-target-value":s,children:s}),d.jsx("br",{}),d.jsx("span",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:!V&&"Hold and drag the slider handle to move it"})]}),d.jsxs("div",{className:"slider-container",children:[d.jsxs("div",{className:"range-labels",children:[d.jsx("span",{children:"0"}),d.jsx("span",{children:"10"})]}),d.jsxs("div",{style:{position:"relative",padding:"20px 0 30px 0"},children:[d.jsx("div",{style:{position:"absolute",width:"100%",height:"20px",top:"0"},children:Y()}),d.jsx("div",{style:{position:"relative",marginTop:"20px"},children:d.jsx("input",{ref:w,type:"range",min:"0",max:"10",step:g,value:a,onChange:B=>{!C&&!k&&(l(parseFloat(B.target.value)),F(!0))},className:"slider-input",style:{width:"100%",cursor:C?"grabbing":"grab"},onMouseDown:E,onTouchStart:E})})]}),d.jsx("div",{className:"current-value",children:I?parseFloat(a).toFixed(n?0:x.precision):"??"})]}),d.jsx("button",{onClick:S,className:"submit-btn",disabled:k,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function yd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=j.useState(""),[a,l]=j.useState(""),[u,h]=j.useState(null),[p]=j.useState(Date.now()),[g,m]=j.useState(""),[I,R]=j.useState(!1),P=j.useRef(0),O=V=>{const F=document.createElement("canvas"),w=F.getContext("2d");return F.width=600,F.height=150,w.fillStyle="#f5f5f5",w.fillRect(0,0,F.width,F.height),w.font='bold 40px "Courier New", monospace',w.fillStyle="#333",w.textAlign="center",w.textBaseline="middle",w.fillText(V,F.width/2,F.height/2),F.toDataURL()};j.useEffect(()=>{const F=Xn.generateTypingPattern(t).pattern;i(F);const w=O(F);m(w)},[t]),j.useEffect(()=>{l(""),h(null),P.current=0},[t]),j.useEffect(()=>{const V=F=>{const{action:w,text:v,typeSpeed:E}=F.detail;if(w==="autoType"&&v){R(!0),l("");let T="",_=0;const S=setInterval(()=>{_<v.length?(T+=v[_],l(T),_++):(clearInterval(S),R(!1))},E||50);return()=>clearInterval(S)}};return window.addEventListener("aiTypingHelp",V),()=>window.removeEventListener("aiTypingHelp",V)},[]);const k=async()=>{const V=Date.now()-p,F=`g3t${t}`,w=localStorage.getItem(`lastAIHelp_${F}`);if(w){const S=JSON.parse(w),x=Date.now()-S.timestamp,X=a===S.suggestion?"accepted":"modified";await je.trackAIHelpResponse(F,S.type,S.suggestion,X,a,x),localStorage.removeItem(`lastAIHelp_${F}`)}const E=((S,x)=>{const X=S.length,ee=x.length,Y=Array(X+1).fill(null).map(()=>Array(ee+1).fill(0));for(let B=0;B<=X;B++)Y[B][0]=B;for(let B=0;B<=ee;B++)Y[0][B]=B;for(let B=1;B<=X;B++)for(let D=1;D<=ee;D++)S[B-1]===x[D-1]?Y[B][D]=Y[B-1][D-1]:Y[B][D]=Math.min(Y[B-1][D]+1,Y[B][D-1]+1,Y[B-1][D-1]+1);return Y[X][ee]})(a,s);let T=0;E===0?T=2:E===1?T=1:T=0,P.current+=1,await je.trackTaskAttempt(F,P.current,!0,V,a,s);const _=localStorage.getItem("sessionId");if(_&&!_.startsWith("offline-"))try{await qn(un(Ye,"sessions",_),{[`taskAccuracies.g3t${t}`]:T===2?100:T===1?70:0,[`taskTimes.g3t${t}`]:V,[`taskPoints.g3t${t}`]:T,lastActivity:dn()})}catch(S){console.error("Error storing accuracy:",S)}h(T===2?"✓ Perfect! 2 points earned!":T===1?"✓ 1 typo - 1 point earned!":`✓ ${E} errors - 0 points earned.`),setTimeout(()=>{e(`g3t${t}`,{attempts:P.current,totalTime:V,accuracy:T===2?100:T===1?70:0,userAnswer:a,correctAnswer:s,points:T})},500)},A=Xn.generateTypingPattern(t),C=A.difficultyLabel,N=A.difficulty;return d.jsxs("div",{className:"task typing",style:{maxWidth:"100%"},children:[d.jsxs("h3",{children:["Student Engagement - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${N}`,children:C}),d.jsx("p",{className:"instruction",children:"Type this pattern exactly:"}),d.jsxs("div",{className:"pattern-display",children:[d.jsx("div",{className:"typing-pattern","data-typing-pattern":s,style:{display:"none"},children:s}),g?d.jsx("img",{src:g,alt:"Pattern to type",style:{width:"100%",maxWidth:"600px",height:"auto",userSelect:"none",pointerEvents:"none"},onContextMenu:V=>V.preventDefault(),draggable:!1}):d.jsx("span",{className:"pattern-text",children:s})]}),d.jsx("div",{className:"input-section",style:{width:"90%",maxWidth:"900px",margin:"20px auto 0"},children:d.jsx("input",{type:"text",inputMode:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:a,onChange:V=>!I&&l(V.target.value),onKeyPress:V=>{V.key==="Enter"&&!I&&(V.preventDefault(),k())},placeholder:"Type here...",className:"typing-input",disabled:I,style:{backgroundColor:I?"#e3f2fd":"white",transition:"background-color 0.3s",width:"100%",maxWidth:"100%",fontFamily:'"Courier New", monospace',fontSize:"28px",padding:"12px 14px",border:"2px solid #e0e0e0",borderRadius:"8px",boxSizing:"border-box"}})}),d.jsx("button",{onClick:k,className:"submit-btn",disabled:I,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function dI({current:t,completed:e,onSwitch:n,limitMode:r,taskPoints:s={},categoryMultipliers:i={},starGoals:a={},categoryPoints:l={},timeRemaining:u=null}){const h=()=>{const C=l.materials||0,N=1+(l.research||0)*.15,V=parseFloat(localStorage.getItem("engagementInterest")||"0")||0;return C*N+V},p=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,g=1+(l.research||0)*.15,m=[];for(let C=1;C<=3;C++)for(let N=1;N<=100;N++){const V=["Research","Materials","Engage"][C-1];m.push({id:`g${C}t${N}`,label:`${V} ${N}`,game:C})}const I=C=>{const N=C.id[1],V=parseInt(C.id.substring(3));if(V===1)return!0;const F=`g${N}t${V-1}`;return e[F]===!0},R={2:m.filter(C=>C.game===2),1:m.filter(C=>C.game===1),3:m.filter(C=>C.game===3)},P={1:"#9C27B0",2:"#4CAF50",3:"#f44336"},O={1:"📚",2:"🎯",3:"✉️"},k={1:"Research",2:"Materials",3:"Engagement"},A={1:"research",2:"materials",3:"engagement"};return d.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"25px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"25px"},children:[2,1,3].map(C=>{const N=R[C],V=N.filter(_=>e[_.id]).length,F=A[C],w=V+1,v=C==="1"?(l.research||0)*.15:0,E=C==="3"?(l.engagement||0)*.0015:0,T=v>0||E>0;return d.jsxs("div",{style:{background:`linear-gradient(135deg, ${P[C]}10 0%, ${P[C]}05 100%)`,borderRadius:"12px",border:`2px solid ${P[C]}20`,padding:"20px",position:"relative",overflow:"hidden",boxShadow:T?`0 0 20px ${P[C]}20`:"none",transition:"all 0.3s ease"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"15px"},children:[d.jsx("span",{style:{fontSize:"28px"},children:O[C]}),d.jsxs("div",{style:{flex:1},children:[d.jsx("h3",{style:{margin:0,color:P[C],fontSize:"18px",fontWeight:"bold"},children:k[C]}),d.jsxs("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:["Level ",Math.min(w,30)]})]}),l&&l[F]>0&&d.jsxs("div",{style:{background:P[C],color:"white",padding:"6px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:[l[F]," pts"]})]}),C==="1"&&(l.research||0)>0&&d.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",(l.research*15).toFixed(0),"%"]}),C==="3"&&(l.engagement||0)>0&&d.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",background:"#fff3cd",color:"#856404",padding:"4px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",border:"1px solid #ffc107"},children:["+",((l.engagement||0)*.15).toFixed(1),"% interest/task"]}),d.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:N.filter(_=>parseInt(_.id.substring(3))<=w).map(_=>{const S=I(_),x=e[_.id],X=t===_.id,ee=parseInt(_.id.substring(3)),Y=s[_.id]||0;return d.jsxs("button",{disabled:!S||x,onClick:()=>S&&!x&&n(_.id),style:{position:"relative",width:"40px",height:"40px",padding:"0",fontSize:"14px",fontWeight:X?"bold":"500",border:`2px solid ${X?P[C]:x?`${P[C]}40`:"#e0e0e0"}`,borderRadius:"8px",background:X?P[C]:x?`${P[C]}10`:"white",color:X?"white":x?P[C]:"#333",cursor:S&&!x?"pointer":"not-allowed",transition:"all 0.2s cubic-bezier(0.4, 0, 0.2, 1)",opacity:x?.7:1,boxShadow:X?`0 2px 8px ${P[C]}40`:"none",transform:"translateY(0)",willChange:"transform, box-shadow"},onMouseEnter:B=>{S&&!X&&!x&&requestAnimationFrame(()=>{B.currentTarget.style.transform="translateY(-2px)",B.currentTarget.style.boxShadow=`0 4px 12px ${P[C]}30`})},onMouseLeave:B=>{S&&!X&&!x&&requestAnimationFrame(()=>{B.currentTarget.style.transform="translateY(0)",B.currentTarget.style.boxShadow="none"})},title:x?`Level ${ee} completed (${Y} pts)`:S?`Start Level ${ee}`:`Complete Level ${ee-1} first`,children:[ee,x&&d.jsx("span",{style:{position:"absolute",top:"-4px",right:"-4px",background:P[C],color:"white",width:"16px",height:"16px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"bold"},children:"✓"}),x&&d.jsx("div",{style:{position:"absolute",bottom:"2px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"2px"},children:Y===0?d.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",border:`1px solid ${P[C]}`,background:"transparent"}}):[...Array(Math.min(Y,2))].map((B,D)=>d.jsx("div",{style:{width:"4px",height:"4px",borderRadius:"50%",background:P[C]}},D))})]},_.id)})})]},C)})}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",background:"#f8f9fa",borderRadius:"8px",flexWrap:"wrap",gap:"20px"},children:[u!==null&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:"⏱️"}),d.jsxs("div",{children:[d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:u<60?"#f44336":"#333"},children:[Math.floor(u/60),":",(u%60).toString().padStart(2,"0")]}),u<180&&u>0&&d.jsx("div",{style:{fontSize:"11px",color:"#ff9800"},children:"Hurry up!"})]})]}),d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Tasks Completed"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:Object.keys(e).length})]}),d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"2px"},children:"Student Learning"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:Math.round(h())}),d.jsxs("div",{style:{fontSize:"10px",color:"#999"},children:[l.materials||0," (materials) × ",g.toFixed(2)," (research) + ",p.toFixed(1)," (cumulative engagement interest)"]})]}),t&&d.jsxs("div",{style:{padding:"8px 16px",background:t.startsWith("g1")?"#9C27B0":t.startsWith("g2")?"#4CAF50":"#f44336",color:"white",borderRadius:"20px",fontSize:"14px",fontWeight:"bold"},children:["Current:"," ",t.replace("g1t","Research ").replace("g2t","Materials ").replace("g3t","Engage ")]})]})]})}function hI({practiceCompleted:t={},onPracticeComplete:e,onStartMainGame:n,onSelectPractice:r,isAdmin:s=!1}){const[i,a]=j.useState(null),l=(m,I)=>{if(I&&I.points===2){typeof e=="function"&&e(m,I);const R=document.createElement("div");R.className="notification-enter",R.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",R.textContent="Perfect! Practice task completed. Returning to menu...",document.body.appendChild(R),setTimeout(()=>{a(null),document.body.contains(R)&&document.body.removeChild(R)},1500)}else{const R=(I==null?void 0:I.points)||0,P=document.createElement("div");P.className="notification-enter",P.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #ff9800; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",P.textContent=`Practice requires 100% accuracy. You scored ${R===1?"50%":"0%"}. Try again!`,document.body.appendChild(P),setTimeout(()=>{document.body.contains(P)&&document.body.removeChild(P)},3e3)}},u=t.g2t1&&t.g1t1&&t.g3t1,h=()=>d.jsxs("div",{className:"practice-menu",children:[d.jsxs("h2",{children:["Practice Mode ",!s&&"(Required)"]}),!s&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",borderRadius:"12px",padding:"16px",marginBottom:"25px",border:"2px solid #f57c00",boxShadow:"0 4px 6px rgba(245, 124, 0, 0.1)",textAlign:"center"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:"⚠️"}),d.jsx("strong",{style:{color:"#e65100",fontSize:"18px"},children:"100% PERFECT ACCURACY REQUIRED"})]}),d.jsxs("div",{style:{color:"#e65100",fontSize:"14px"},children:["You must score 2/2 points (exact answer) on all three practice tasks to proceed.",d.jsx("br",{}),d.jsx("strong",{children:"No partial credit in practice mode!"})]}),d.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"12px"},children:[d.jsxs("span",{style:{padding:"4px 12px",background:t.g2t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g2t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g2t1?"#4CAF50":"#ffb74d"}`},children:["Materials ",t.g2t1?"✓":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g1t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g1t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g1t1?"#4CAF50":"#ffb74d"}`},children:["Research ",t.g1t1?"✓":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g3t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g3t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g3t1?"#4CAF50":"#ffb74d"}`},children:["Engagement ",t.g3t1?"✓":"Required"]})]})]}),d.jsx("p",{className:"practice-hint",style:{textAlign:"center",fontSize:"16px",color:"#666",marginBottom:"30px"},children:"Try each task type before starting the main challenge. No time pressure!"}),d.jsxs("div",{className:"practice-cards",children:[d.jsxs("div",{className:"practice-card materials",children:[d.jsx("h3",{children:"🎯 Materials"}),d.jsx("p",{children:"Hold and drag slider to match target values"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Base points - directly added to score"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g2t1"),r&&r("g2t1")},className:t.g2t1?"completed":"",disabled:!1,children:t.g2t1?"✓ Completed":"Try Materials"})})]}),d.jsxs("div",{className:"practice-card research",children:[d.jsx("h3",{children:"📚 Research"}),d.jsx("p",{children:"Count words or letters in text passages"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 15% multiplier per point in main game"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g1t1"),r&&r("g1t1")},className:t.g1t1?"completed":"",disabled:!1,children:t.g1t1?"✓ Completed":"Try Research"})})]}),d.jsxs("div",{className:"practice-card engagement",children:[d.jsx("h3",{children:"✉️ Engagement"}),d.jsx("p",{children:"Type patterns exactly as shown"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 0.15% compound interest per point"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g3t1"),r&&r("g3t1")},className:t.g3t1?"completed":"",disabled:!1,children:t.g3t1?"✓ Completed":"Try Engagement"})})]})]}),d.jsxs("div",{style:{marginTop:"25px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h4",{style:{margin:"0 0 10px 0",color:"#333",fontSize:"16px"},children:"Practice Progress:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[d.jsxs("div",{style:{padding:"8px 15px",background:t.g2t1?"#4CAF50":"#e0e0e0",color:t.g2t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Materials ",t.g2t1&&"✓"]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g1t1?"#9C27B0":"#e0e0e0",color:t.g1t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Research ",t.g1t1&&"✓"]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g3t1?"#f44336":"#e0e0e0",color:t.g3t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Engagement ",t.g3t1&&"✓"]})]}),d.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#666"},children:[d.jsx("strong",{children:"100% accuracy required"})," to complete each practice task"]})]}),d.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:d.jsx("button",{className:"start-main-game-btn",onClick:n,style:{opacity:!s&&!u?.5:1,cursor:!s&&!u?"not-allowed":"pointer"},disabled:!s&&!u,children:s?"Start Main Game (Admin)":u?"Start Main Game - You're Ready! 🚀":"Complete Practice First"})})]});if(!i)return h();const p=i[1],g=1;return d.jsxs("div",{className:"practice-container",children:[d.jsx("button",{className:"back-to-menu",onClick:()=>a(null),children:"← Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),d.jsxs("div",{className:"practice-task-wrapper",children:[p==="1"&&d.jsx(md,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i}),p==="2"&&d.jsx(gd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i}),p==="3"&&d.jsx(yd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i})]})]})}class fI{constructor(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={}}getUniversalAttemptNumber(){return this.totalAIUsage}shouldAIBeCorrect(e){let n;return e===1||e===2||e===4||e===5?n=!0:e===3?n=!1:n=Math.random()<.75,n}getTaskUsageCount(e){return this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]}incrementTaskUsage(e,n){this.totalAIUsage++,this.usageCount[n]++,this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]++}resetForNewSemester(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={},console.log("🔄 AI Help usage reset for new semester")}helpWithSlider(e,n){this.incrementTaskUsage(n,"materials");const r=this.getUniversalAttemptNumber();let s;if(this.shouldAIBeCorrect(r))s=e;else if(r===3){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else if(Math.random()<.5){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else{const i=(Math.random()<.5?-1:1)*(2+Math.random()*2);s=Math.max(0,Math.min(10,e+i))}return{action:"moveSlider",value:s,animate:!0}}helpWithCounting(e,n,r){this.incrementTaskUsage(r,"research");const s=this.getUniversalAttemptNumber(),i=this.shouldAIBeCorrect(s);return n.length===1||n.includes(" and ")||n.includes(",")?this.helpWithLetterCounting(e,n,s,i):this.helpWithWordCounting(e,n,s,i)}helpWithLetterCounting(e,n,r,s){let i=[];n.includes(" and ")||n.includes(",")?i=n.match(/[a-z]/gi)||[]:i=[n];let a=0;i.forEach(h=>{const p=new RegExp(h,"gi"),g=e.match(p);a+=g?g.length:0});let l=a,u=[...i];if(!s){r===3||Math.random()<.5?l=a+1:l=a+Math.floor(Math.random()*3)+2,l=Math.max(0,l);const p="abcdefghijklmnopqrstuvwxyz".split("").filter(m=>!i.includes(m.toLowerCase())),g=Math.floor(Math.random()*2)+1;for(let m=0;m<g&&p.length>0;m++){const I=Math.floor(Math.random()*p.length);u.push(p[I]),p.splice(I,1)}}return{action:"highlightAndCount",highlightWords:[],suggestedCount:l,animate:!0,isMultiLetter:!0,targetLetters:u}}helpWithWordCounting(e,n,r,s){const i=e.split(/\s+/),a=[];let l=0,u=0;if(i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&u++}),s)i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&(a.push(h),l++)});else if(r===3){l=u+1,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());if(h.length>0&&a.length<l){const p=h[Math.floor(Math.random()*h.length)];a.push(p)}}else{Math.random()<.5?l=u+1:l=u+Math.floor(Math.random()*3)+2,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());for(;a.length<l&&h.length>0;){const p=Math.floor(Math.random()*h.length),g=h[p];a.includes(g)||a.push(g),h.splice(p,1)}}return{action:"highlightAndCount",highlightWords:a,suggestedCount:l,animate:!0}}helpWithTyping(e,n){this.incrementTaskUsage(n,"engagement");const r=this.getUniversalAttemptNumber();let s=e;const i={0:["o","O"],o:["0"],O:["0"],1:["l","I","i"],l:["1","I","i"],I:["1","l","i"],i:["1","l","I"],e:["3"],3:["e"],a:["@"],"@":["a"],s:["5","$"],S:["5","$"],5:["s","S"],$:["s","S"],g:["9"],9:["g"],b:["6"],6:["b"],z:["2"],2:["z"],B:["8"],8:["B"]},a=l=>{const u=l.split(""),h=u.map((p,g)=>i[p]?g:-1).filter(p=>p!==-1);if(h.length>0){const p=h[Math.floor(Math.random()*h.length)],g=u[p],m=i[g];m&&m.length>0&&(u[p]=m[Math.floor(Math.random()*m.length)])}else{const p=["transpose","duplicate","missing"],g=p[Math.floor(Math.random()*p.length)],m=Math.floor(Math.random()*u.length);switch(g){case"transpose":m<u.length-1&&([u[m],u[m+1]]=[u[m+1],u[m]]);break;case"duplicate":u.splice(m,0,u[m]);break;case"missing":u.splice(m,1);break}}return u.join("")};if(this.shouldAIBeCorrect(r))s=e;else if(r===3)s=a(e);else if(Math.random()<.5)s=a(e);else{let l=e;const u=Math.floor(Math.random()*3)+2;for(let h=0;h<u;h++)l=a(l);s=l}return{action:"autoType",text:s,typeSpeed:50,perfect:this.shouldAIBeCorrect(r)}}}const Ct=new fI;function pI({bonusPrompts:t=0,currentTask:e="",categoryPoints:n=null,timeRemaining:r=null,calculateStudentLearning:s=()=>0}){const[i,a]=j.useState(!0),[l,u]=j.useState(0),[h,p]=j.useState(!1);j.useEffect(()=>{const S=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");a(S.hasAI!==!1)},[]),j.useEffect(()=>{if(e){const S=Ct.getTaskUsageCount(e)>=1;p(S)}},[e]),j.useEffect(()=>{const S=()=>{u(Ct.totalAIUsage)},x=setInterval(S,1e3);return S(),()=>clearInterval(x)},[]);const[g,m]=j.useState([{sender:"bot",text:i?"Hello! I'm your AI teaching assistant. You get ONE AI help attempt per task - use it wisely!":"Hello! This is the chat interface. AI assistance is not available for this session."}]),[I,R]=j.useState(""),[P,O]=j.useState(!1),[k,A]=j.useState({materials:0,research:0,engagement:0}),C=j.useRef(null),N=()=>e?e.startsWith("g1")?"research":e.startsWith("g2")?"materials":e.startsWith("g3")?"engagement":null:null,V=(S=null)=>{const x=S||N();if(!x){m(Y=>[...Y,{sender:"bot",text:"Please start a task first, then I can help you!"}]);return}if(Ct.getTaskUsageCount(e)>=1){m(Y=>[...Y,{sender:"bot",text:"❌ You've already used AI help for this task. Only 1 AI attempt allowed per task!"}]);return}const ee=Date.now();if(ee-k[x]<3e3){m(Y=>[...Y,{sender:"bot",text:"Please wait a moment before requesting help again!"}]);return}switch(A(Y=>({...Y,[x]:ee})),x){case"materials":F();break;case"research":w();break;case"engagement":E();break;default:m(Y=>[...Y,{sender:"bot",text:"I'm not sure which task you're on. Please try again!"}])}},F=()=>{var Y,B;const S=((Y=document.querySelector("[data-target-value]"))==null?void 0:Y.getAttribute("data-target-value"))||((B=document.querySelector(".target-value"))==null?void 0:B.textContent)||5,x=Ct.helpWithSlider(parseFloat(S),e),X=Ct.getUniversalAttemptNumber(),ee=Ct.shouldAIBeCorrect(X);je.trackAITaskHelp(e,"slider",x.value,ee,X),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"slider",suggestion:x.value,timestamp:Date.now(),wasCorrect:ee})),window.dispatchEvent(new CustomEvent("aiSliderHelp",{detail:x})),u(Ct.totalAIUsage),p(!0),m(D=>[...D,{sender:"bot",text:`📊 Helping with materials...
Suggested value: ${x.value.toFixed(2)}`}])},w=()=>{var X;const S=document.querySelector(".text-to-count"),x=document.querySelector(".count-target");if(S&&x){const ee=S.getAttribute("data-counting-text")||"";let Y=((X=x.getAttribute("data-pattern"))==null?void 0:X.replace(/['"]/g,"").trim())||"";const B=Ct.helpWithCounting(ee,Y,e),D=B.suggestedCount;window.dispatchEvent(new CustomEvent("aiCountingHelp",{detail:B}));const z=Ct.getUniversalAttemptNumber(),L=Ct.shouldAIBeCorrect(z);je.trackAITaskHelp(e,"counting",D,L,z),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"counting",suggestion:D,timestamp:Date.now(),wasCorrect:L,highlightedWords:B.highlightWords||[],targetLetters:B.targetLetters||[]})),u(Ct.totalAIUsage),p(!0);const W=B.isMultiLetter?"letters/characters":"words";m(J=>[...J,{sender:"bot",text:`🔬 Helping with research...
Found ${D} ${W}`}])}},v=()=>{const S=["🎯 CRITICAL STRATEGY: Do tasks in this EXACT order → 1️⃣ Engagement (builds interest from the start) 2️⃣ Research (multiplies future materials) 3️⃣ Materials (gets all multipliers). Materials done early = WASTED points!","📊 MAXIMUM SCORE ORDER: Engagement FIRST → Research SECOND → Materials LAST! Why? Engagement compounds every task, Research only multiplies FUTURE materials. Doing materials early gets ZERO multiplier!","⚠️ WARNING: Research multipliers ONLY apply to materials earned AFTER! If you do materials first, you get NO bonus. Always do ALL engagement & research before touching ANY materials!","💡 PRO TIP: Complete 100% of Engagement tasks first (builds interest early), then 100% of Research (sets up multipliers), THEN do Materials. This order can DOUBLE your score vs doing materials first!","🚀 OPTIMAL PATH: Think of it like this - Engagement = compound interest (starts early), Research = multiplier (affects future only), Materials = base score (save for last). Wrong order = lost points forever!"],x=S[Math.floor(Math.random()*S.length)];m(X=>[...X,{sender:"bot",text:x}]),je.trackUserAction("planning_help_requested",{response:x,currentTask:e,timestamp:Date.now()})},E=()=>{const S=document.querySelector("[data-typing-pattern]");if(S){const x=S.getAttribute("data-typing-pattern");if(x){const X=Ct.helpWithTyping(x,e),ee=Ct.getUniversalAttemptNumber(),Y=X.perfect;je.trackAITaskHelp(e,"typing",X.text,Y,ee),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"typing",suggestion:X.text,timestamp:Date.now(),wasCorrect:Y,originalPattern:x})),window.dispatchEvent(new CustomEvent("aiTypingHelp",{detail:X})),u(Ct.totalAIUsage),p(!0),m(B=>[...B,{sender:"bot",text:`✉️ Helping with engagement...
Typing: "${X.text.substring(0,30)}${X.text.length>30?"...":""}"`}])}}else m(x=>[...x,{sender:"bot",text:"Please navigate to the engagement tab first!"}])},T=()=>{if(!I.trim())return;if(!i){m(X=>[...X,{sender:"user",text:I},{sender:"bot",text:"AI assistance is not available for this session."}]),R("");return}const S=I.toLowerCase().trim(),x=I;m(X=>[...X,{sender:"user",text:I}]),R(""),O(!0),setTimeout(()=>{let X="",ee="general";if(S.includes("help"))if(ee="help_request",S.includes("material")||S.includes("slider")){V("materials"),O(!1);return}else if(S.includes("research")||S.includes("count")){V("research"),O(!1);return}else if(S.includes("engagement")||S.includes("typ")){V("engagement"),O(!1);return}else X="Click the help buttons below for task assistance!";else if(S.includes("strategy")||S.includes("plan")||S.includes("order")){ee="strategy";const Y=["🎯 CRITICAL STRATEGY: Do tasks in this EXACT order → 1️⃣ Engagement (builds interest from the start) 2️⃣ Research (multiplies future materials) 3️⃣ Materials (gets all multipliers). Materials done early = WASTED points!","📊 MAXIMUM SCORE ORDER: Engagement FIRST → Research SECOND → Materials LAST! Why? Engagement compounds every task, Research only multiplies FUTURE materials. Doing materials early gets ZERO multiplier!","⚠️ WARNING: Research multipliers ONLY apply to materials earned AFTER! If you do materials first, you get NO bonus. Always do ALL engagement & research before touching ANY materials!","💡 PRO TIP: Complete 100% of Engagement tasks first (builds interest early), then 100% of Research (sets up multipliers), THEN do Materials. This order can DOUBLE your score vs doing materials first!","🚀 OPTIMAL PATH: Think of it like this - Engagement = compound interest (starts early), Research = multiplier (affects future only), Materials = base score (save for last). Wrong order = lost points forever!"];X=Y[Math.floor(Math.random()*Y.length)]}else if(S.includes("tip")||S.includes("advice"))ee="advice",X="Strategic tip: Do Research tasks first for the multiplier effect, then Materials for base points, finally Engagement for compound interest!";else{const Y=["Keep pushing! You're doing great!","Remember: Materials × Research × Engagement = Success!","Focus on accuracy for those 2-point rewards!",`The checkpoint at minute ${(()=>{const D=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").semesterDuration||12e5,z=Math.floor(D/2e3);return Math.floor(z/60)})()} can give huge bonuses!`,"Try the help buttons below for task assistance!"];X=Y[Math.floor(Math.random()*Y.length)]}je.trackUserAction("chat_message",{query:x,queryType:ee,response:X,currentTask:e,categoryPoints:n,studentLearning:s(),aiUsageCount:Ct.totalAIUsage}),m(Y=>[...Y,{sender:"bot",text:X}]),O(!1)},800)},_=N();return d.jsxs("div",{className:"chat-container-sidebar",style:{height:"100%",display:"flex",flexDirection:"column"},children:[d.jsxs("div",{className:"chat-header",children:[d.jsx("h3",{children:i?"AI Teaching Assistant":"Chat Interface"}),d.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"2px"},children:i?"1 AI help per task (reliability varies)":"AI assistance disabled for this session"}),d.jsxs("div",{style:{marginTop:"10px",padding:"8px",background:"#e3f2fd",borderRadius:"6px",border:"1px solid #2196F3"},children:[d.jsxs("div",{style:{fontSize:"12px",color:"#1976d2",fontWeight:"bold"},children:["Student Learning: ",Math.round(s())," pts"]}),d.jsxs("div",{style:{fontSize:"10px",color:"#666",marginTop:"2px"},children:[n.materials||0," ×"," ",(1+(n.research||0)*.15).toFixed(2)," + Interest"]})]})]}),d.jsxs("div",{className:"messages-sidebar",children:[g.map((S,x)=>d.jsxs("div",{className:`message ${S.sender}`,children:[d.jsxs("div",{className:"message-sender",children:[S.sender==="user"?"You":i?"AI":"System",":"]}),d.jsx("div",{className:"message-text",children:S.text})]},x)),P&&i&&d.jsxs("div",{className:"message bot",children:[d.jsx("div",{className:"message-sender",children:"AI:"}),d.jsx("div",{className:"message-text typing",children:"..."})]}),d.jsx("div",{ref:C})]}),d.jsxs("div",{className:"chat-input-sidebar",children:[d.jsx("input",{type:"text",placeholder:i?"Ask about strategy and tips here...":"Chat disabled - no AI available",value:I,onChange:S=>R(S.target.value),onKeyPress:S=>S.key==="Enter"&&T(),disabled:!i}),d.jsx("button",{onClick:T,disabled:!I.trim()||!i,children:"Send"})]}),i&&d.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f8f9fa"},children:[d.jsxs("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:["AI Usage: ",l," total attempts",h&&d.jsxs("span",{style:{color:"#ff9800",fontWeight:"bold"},children:[" ","| Current task: 1/1 used"]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"10px"},children:[d.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[d.jsxs("button",{onClick:()=>V(),disabled:!_||h,style:{padding:"12px",background:h?"#ff9800":_?"#2196F3":"#ccc",color:"white",border:"none",borderRadius:"8px",cursor:_&&!h?"pointer":"not-allowed",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[d.jsx("span",{style:{fontSize:"18px"},children:"🤖"}),h?"AI Used (1/1)":_?"Help Task":"Start task first"]}),d.jsxs("button",{onClick:v,style:{padding:"12px",background:"#FF9800",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[d.jsx("span",{style:{fontSize:"18px"},children:"📊"}),"Help Plan"]})]}),d.jsx("button",{onClick:()=>V("research"),disabled:!e.startsWith("g1")||h,style:{padding:"10px",background:e.startsWith("g1")&&!h?"#9C27B0":h&&e.startsWith("g1")?"#ff9800":"#e0e0e0",color:e.startsWith("g1")||h?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g1")&&!h?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:"📚 Research"}),d.jsx("button",{onClick:()=>V("materials"),disabled:!e.startsWith("g2")||h,style:{padding:"10px",background:e.startsWith("g2")&&!h?"#4CAF50":h&&e.startsWith("g2")?"#ff9800":"#e0e0e0",color:e.startsWith("g2")||h?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g2")&&!h?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:"🎯 Materials"}),d.jsx("button",{onClick:()=>V("engagement"),disabled:!e.startsWith("g3")||h,style:{padding:"10px",background:e.startsWith("g3")&&!h?"#f44336":h&&e.startsWith("g3")?"#ff9800":"#e0e0e0",color:e.startsWith("g3")||h?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g3")&&!h?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:"✉️ Engage"})]}),d.jsx("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:_?d.jsx("span",{style:{color:"#4CAF50"},children:"✓ AI ready to help"}):d.jsx("span",{style:{color:"#999"},children:"⏸ Navigate to a task to enable AI help"})})]}),!i&&d.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f5f5f5",textAlign:"center",color:"#666",fontSize:"14px"},children:[d.jsx("div",{style:{marginBottom:"5px"},children:"📝 No AI Assistant"}),d.jsx("div",{style:{fontSize:"12px"},children:"Complete tasks using your own judgment"})]})]})}const Pl={generateCode(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`${t}-${e}`.toUpperCase()},async createCode(t={}){return{success:!0,code:this.generateCode(),data:t}},async markCodeAsUsed(t,e){if(!t)return{success:!1,error:"No code provided"};try{const n={code:t,status:"used",usedAt:dn(),sessionId:e,createdAt:dn()};return await ZT(un(Ye,"accessCodes",t),n),{success:!0}}catch(n){return console.error("Error marking code as used:",n),{success:!1,error:n.message}}},async checkCodeUsage(t){if(!t)return{used:!1};try{const e=await JT(un(Ye,"accessCodes",t));if(e.exists()){const n=e.data();return{used:n.status==="used",sessionId:n.sessionId,usedAt:n.usedAt}}return{used:!1}}catch(e){return console.error("Error checking code usage:",e),{used:!1,error:e.message}}},getCodeFromURL(){const t=new URLSearchParams(window.location.search);return t.get("code")||t.get("c")||null},async verifyQualtricsCode(t){return{valid:!1,reason:"Qualtrics codes not yet supported"}}};function mI({onLoginSuccess:t}){const[e,n]=j.useState(""),[r,s]=j.useState(!1),[i,a]=j.useState(""),[l,u]=j.useState(!1),h={"ADMIN-MASTER":{role:"master_admin",name:"Master Administrator",hasAI:!1,isMasterInterface:!0},...Array.from({length:10},(I,R)=>({[`ADMIN-TEST${R+1}`]:{role:"test",semesterDuration:72e4,name:`Test User ${R+1}`,hasAI:!0,checkpointSemester2:!0,isTestCode:!0}})).reduce((I,R)=>({...I,...R}),{}),"ADMIN-REGULAR":{role:"admin",semesterDuration:72e4,name:"Admin Regular Mode",hasAI:!0,checkpointSemester2:!0},"ADMIN-FAST":{role:"admin",semesterDuration:12e4,name:"Admin Fast Mode",hasAI:!0,checkpointSemester2:!0},"ADMIN-1-CP":{role:"admin",semesterDuration:12e4,name:"Admin Section 1 WITH Checkpoint",hasAI:!1,checkpointSemester2:!0},"ADMIN-1-NCP":{role:"admin",semesterDuration:12e4,name:"Admin Section 1 NO Checkpoint",hasAI:!1,checkpointSemester2:!1},"ADMIN-2-CP":{role:"admin",semesterDuration:12e4,name:"Admin Section 2 WITH Checkpoint",hasAI:!0,checkpointSemester2:!0},"ADMIN-2-NCP":{role:"admin",semesterDuration:12e4,name:"Admin Section 2 NO Checkpoint",hasAI:!0,checkpointSemester2:!1}},p=I=>({section:"TESTING-AI-CP",hasAI:!0,checkpointSemester2:!0,displayName:`${I} (Internal Tester - AI + Checkpoint)`}),g=I=>{if(h[I])return{valid:!0,type:"master",data:h[I]};const R=I.trim().replace(/[^a-zA-Z0-9\s\-_]/g,"");return R.length<2?{valid:!1,error:"Please enter a name with at least 2 characters"}:R.length>50?{valid:!1,error:"Name too long. Please use 50 characters or less"}:{valid:!0,type:"tester",condition:p(R),cleanName:R}},m=async I=>{if(I.preventDefault(),!e.trim()){a("Please enter your name");return}s(!0),a("");try{const R=g(e.trim());if(!R.valid){a(R.error||"Invalid Student ID"),s(!1);return}let P={timestamp:new Date().toISOString()};if(R.type==="master"){if(P={...P,studentIdentifier:e,role:R.data.role,semesterDuration:R.data.semesterDuration,displayName:R.data.name,section:R.data.isTestCode?"ADMIN-TEST":"ADMIN",hasAI:R.data.hasAI,checkpointSemester2:R.data.checkpointSemester2,isMasterCode:!0,isTestCode:R.data.isTestCode||!1,isMasterInterface:R.data.isMasterInterface||!1},R.data.isMasterInterface){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",displayName:R.data.name,section:"master_admin",hasAI:!0,checkpointSemester2:!0})),window.location.href=`${window.location.origin}?master=true`;return}}else if(R.type==="tester"){const k=R.condition,A=R.cleanName;P={...P,studentIdentifier:A,role:"tester",semesterDuration:72e4,displayName:k.displayName,section:k.section,hasAI:k.hasAI,checkpointSemester2:k.checkpointSemester2,isMasterCode:!1,isTestUser:!0}}const O=await Pl.createCode(P);O.success?(sessionStorage.setItem("gameConfig",JSON.stringify({semesterDuration:P.semesterDuration,role:P.role,studentId:P.studentIdentifier,displayName:P.displayName,section:P.section,hasAI:P.hasAI,checkpointSemester2:P.checkpointSemester2})),window.location.href=`${window.location.origin}?code=${O.code}`):a("Failed to generate access code. Please try again.")}catch(R){console.error("Login error:",R),a("System error. Please try again.")}finally{s(!1)}};return d.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",padding:"20px"},children:[d.jsxs("div",{style:{background:"white",padding:"48px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",maxWidth:"480px",width:"100%"},children:[d.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[d.jsxs("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a202c",marginBottom:"8px",lineHeight:"1.2"},children:["Scheduling Challenge:",d.jsx("br",{}),"Can you beat Park?"]}),d.jsx("p",{style:{fontSize:"16px",color:"#718096",marginTop:"12px"},children:"Enter your name to access the game"})]}),d.jsxs("form",{onSubmit:m,children:[d.jsxs("div",{style:{marginBottom:"24px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#2d3748",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.025em"},children:"Your Name:"}),d.jsx("input",{type:"text",value:e,onChange:I=>n(I.target.value),disabled:r,style:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e2e8f0",borderRadius:"8px",boxSizing:"border-box",fontFamily:"'SF Mono', Monaco, 'Courier New', monospace",transition:"all 0.2s ease",background:"#f7fafc",outline:"none"},onFocus:I=>{I.target.style.borderColor="#2196F3",I.target.style.background="white",I.target.style.boxShadow="0 0 0 3px rgba(33, 150, 243, 0.1)"},onBlur:I=>{I.target.style.borderColor="#e2e8f0",I.target.style.background="#f7fafc",I.target.style.boxShadow="none"}}),d.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"#a0aec0",lineHeight:"1.4"},children:"Enter your first and last name (2-50 characters)"})]}),i&&d.jsxs("div",{style:{background:"#fed7d7",color:"#c53030",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",fontSize:"14px",display:"flex",alignItems:"center",border:"1px solid #fc8181"},children:[d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",style:{marginRight:"8px",flexShrink:0},children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i]}),d.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:"600",background:r?"#cbd5e0":"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:r?"none":"0 4px 6px rgba(33, 150, 243, 0.25)",transform:r?"none":"translateY(0)"},onMouseDown:I=>{r||(I.target.style.transform="translateY(2px)",I.target.style.boxShadow="0 2px 4px rgba(33, 150, 243, 0.25)")},onMouseUp:I=>{r||(I.target.style.transform="translateY(0)",I.target.style.boxShadow="0 4px 6px rgba(33, 150, 243, 0.25)")},onMouseOver:I=>{r||(I.target.style.background="#1976D2")},onMouseOut:I=>{r||(I.target.style.background="#2196F3")},children:r?d.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[d.jsxs("svg",{className:"animate-spin",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px",animation:"spin 1s linear infinite"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",strokeOpacity:"0.25"}),d.jsx("path",{d:"M4 12a8 8 0 018-8",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),"Verifying Name..."]}):"Access Game"})]}),d.jsxs("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[d.jsx("p",{style:{fontSize:"14px",color:"#718096",marginBottom:"12px"},children:"Having trouble? Contact your instructor:"}),d.jsxs("p",{style:{fontSize:"16px",color:"#2196F3",fontWeight:"500"},children:["Park Sinchaisri",d.jsx("br",{}),d.jsx("a",{href:"mailto:parksinchaisri@haas.berkeley.edu",style:{color:"#2196F3",textDecoration:"none",borderBottom:"1px solid #2196F3",fontSize:"15px"},children:"parksinchaisri@haas.berkeley.edu"})]}),l&&d.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#f7fafc",borderRadius:"8px",fontSize:"11px",color:"#4a5568",lineHeight:"1.8"},children:[d.jsx("strong",{children:"Test Codes:"}),d.jsxs("div",{style:{marginTop:"8px",fontFamily:"monospace"},children:[d.jsx("div",{children:"ADMIN-TEST1 to ADMIN-TEST10 (Test users)"}),d.jsx("div",{children:"ADMIN-1-CP (No AI, With Checkpoint)"}),d.jsx("div",{children:"ADMIN-1-NCP (No AI, No Checkpoint)"}),d.jsx("div",{children:"ADMIN-2-CP (AI, With Checkpoint)"}),d.jsx("div",{children:"ADMIN-2-NCP (AI, No Checkpoint)"}),d.jsx("div",{children:"ADMIN-REGULAR (Original)"}),d.jsx("div",{children:"ADMIN-FAST (2 min test)"}),d.jsx("div",{children:"ADMIN-MASTER (Master interface)"})]})]})]})]}),d.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const Lm={async checkDailyLimit(t){var r;if(!t)return{allowed:!0};const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);try{const s=Hn(Ye,"sessions"),i=qi(s,fd("studentId","==",t),fd("startTime",">=",n)),a=await bs(i);if(!a.empty){const l=a.docs[0].data(),u=(r=l.startTime)!=null&&r.toDate?l.startTime.toDate():new Date(l.clientStartTime);return{allowed:!1,reason:"daily_limit",existingSession:l,nextAvailable:new Date(n.getTime()+24*60*60*1e3)}}return{allowed:!0}}catch(s){console.error("Error checking daily limit:",s);const i=`played_${t}_${n.toISOString().split("T")[0]}`;return localStorage.getItem(i)?{allowed:!1,reason:"daily_limit",nextAvailable:new Date(n.getTime()+24*60*60*1e3)}:{allowed:!0}}},async markDailyPlay(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=`played_${t}_${n.toISOString().split("T")[0]}`;localStorage.setItem(r,"true");const s=new Date(Date.now()-7*24*60*60*1e3);for(let i=0;i<localStorage.length;i++){const a=localStorage.key(i);if(a&&a.startsWith("played_")){const l=a.split("_")[2];l&&new Date(l)<s&&localStorage.removeItem(a)}}},async checkAccess(){try{const t=Pl.getCodeFromURL();if(!t)return{allowed:!1,reason:"Please login with your student ID",requiresCode:!0};const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),n=e.role==="admin"||e.role==="master_admin";if(!n&&e.studentId){const r=await this.checkDailyLimit(e.studentId);if(!r.allowed&&!r.refreshGranted){const i=r.nextAvailable;return{allowed:!1,reason:`You have already completed today's session. Please come back in ${Math.ceil((i-Date.now())/(1e3*60*60))} hours (after midnight).`,dailyLimitReached:!0,nextAvailable:i}}if(sessionStorage.getItem("activeSessionId"))return{allowed:!1,reason:"Page refresh is not allowed during the game. Your session has been terminated.",refreshAttempt:!0}}return e.studentId?(n||await this.markDailyPlay(e.studentId),{allowed:!0,newSession:!0,code:t,codeData:{status:"new",metadata:e},isAdmin:n}):{allowed:!1,reason:"Please login with your Berkeley student ID",requiresCode:!0}}catch(t){console.error("Error in checkAccess:",t);const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");return e.role==="admin"?{allowed:!0,newSession:!0,code:Pl.getCodeFromURL(),codeData:{status:"error_bypass",metadata:e},isAdmin:!0}:{allowed:!1,reason:"System error. Please try again.",requiresCode:!0}}},async createSession(t=null,e=null,n=!1){try{const r=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),s=r.role==="admin"||r.role==="master_admin",i={id:crypto.randomUUID(),accessCode:t,studentId:r.studentId||null,role:r.role||"student",semesterDuration:r.semesterDuration||72e4,displayName:r.displayName||"Student",startTime:dn(),clientStartTime:new Date().toISOString(),status:"active",completedTasks:{},isPractice:n,isAdminSession:s,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`,section:r.section,hasAI:r.hasAI,checkpointSemester2:r.checkpointSemester2},l=(await Kh(Hn(Ye,"sessions"),i)).id;return localStorage.setItem("sessionId",l),sessionStorage.setItem("activeSessionId",l),s||(window.addEventListener("beforeunload",u=>{u.preventDefault(),u.returnValue="Your progress will be lost if you leave this page.",this.handleSessionAbandonment()}),document.addEventListener("visibilitychange",()=>{!s&&document.hidden})),l}catch(r){console.error("Error creating session:",r);const s=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(s.role==="admin"){const i="offline-"+Date.now();localStorage.setItem("sessionId",i),sessionStorage.setItem("activeSessionId",i);const a={id:i,accessCode:t,startTime:Date.now(),status:"active",isOffline:!0,studentId:s.studentId||null,role:s.role||"admin"};return localStorage.setItem("offlineSession",JSON.stringify(a)),i}throw r}},async handleSessionAbandonment(){const t=localStorage.getItem("sessionId");if(t&&!t.startsWith("offline-"))try{await qn(un(Ye,"sessions",t),{status:"abandoned",abandonedAt:dn(),abandonReason:"page_unload"})}catch(e){console.error("Error marking session as abandoned:",e)}sessionStorage.removeItem("activeSessionId"),sessionStorage.removeItem("gameConfig")}};function gI(){const[t,e]=j.useState(""),[n,r]=j.useState(!1),[s,i]=j.useState(""),[a,l]=j.useState(!1),u=async()=>{r(!0),i(""),l(!1);try{const p=await Pl.createCode({createdBy:"admin",timestamp:new Date().toISOString()});p.success?e(p.code):i("Failed to generate code: "+p.error)}catch(p){i("Error: "+p.message)}finally{r(!1)}},h=()=>{const p=`${window.location.origin}?code=${t}`;navigator.clipboard.writeText(p),l(!0),setTimeout(()=>l(!1),2e3)};return d.jsxs("div",{style:{padding:"40px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, -apple-system, sans-serif"},children:[d.jsx("h1",{style:{color:"#333",marginBottom:"10px"},children:"Admin Dashboard"}),d.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:"Generate access codes for participants"}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("button",{onClick:u,disabled:n,style:{padding:"12px 30px",fontSize:"16px",background:n?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:"bold"},children:n?"Generating...":"Generate New Access Code"}),t&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"white",borderRadius:"6px",border:"1px solid #e0e0e0"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Generated Code"}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Access Code:"}),d.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"18px",fontWeight:"bold"},children:t})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Full URL:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"stretch"},children:[d.jsx("input",{type:"text",value:`${window.location.origin}?code=${t}`,readOnly:!0,style:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",background:"#f9f9f9"}}),d.jsx("button",{onClick:h,style:{padding:"10px 20px",background:a?"#4CAF50":"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:a?"✓ Copied!":"Copy URL"})]})]}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"4px",fontSize:"14px",color:"#1976d2"},children:[d.jsx("strong",{children:"Note:"})," This code is valid for 24 hours and can only be used once."]})]}),s&&d.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"#ffebee",color:"#c62828",borderRadius:"4px"},children:s})]}),d.jsxs("div",{style:{marginTop:"40px",padding:"20px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"How to use:"}),d.jsxs("ol",{style:{margin:"10px 0",paddingLeft:"20px"},children:[d.jsx("li",{children:"Generate a code using the button above"}),d.jsx("li",{children:"Copy the full URL"}),d.jsx("li",{children:"Share the URL with participants"}),d.jsx("li",{children:"Each participant can use their unique code once"})]})]})]})}function yI({sessionId:t,completedLevels:e,totalTime:n,gameMode:r}){const[s,i]=j.useState(""),[a,l]=j.useState(!1);j.useEffect(()=>{u()},[]);const u=()=>{const p=Date.now().toString(36).toUpperCase(),g=e.toString().padStart(2,"0"),m=r.limit==="time"?"T":"A",I=r.accuracy==="strict"?"S":"L",O=`GAME-${`${t}-${g}-${n}`.split("").reduce((k,A)=>k+A.charCodeAt(0),0).toString(36).toUpperCase().slice(-3)}-${g}-${m}${I}-${p}`;i(O)},h=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(s),l(!0),setTimeout(()=>l(!1),3e3);else{const p=document.createElement("textarea");p.value=s,p.style.position="fixed",p.style.top="0",p.style.left="0",p.style.width="2em",p.style.height="2em",p.style.padding="0",p.style.border="none",p.style.outline="none",p.style.boxShadow="none",p.style.background="transparent",p.style.opacity="0",document.body.appendChild(p),p.focus(),p.select();try{document.execCommand("copy")?(l(!0),setTimeout(()=>l(!1),3e3)):(console.error("Failed to copy using execCommand"),alert("Copy failed. Please manually select and copy the code."))}catch(g){console.error("Failed to copy:",g),alert("Copy failed. Please manually select and copy the code.")}document.body.removeChild(p)}}catch(p){console.error("Clipboard operation failed:",p),alert(`Copy failed. Here's your code to copy manually:

${s}`)}};return d.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"30px",marginTop:"30px",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},children:[d.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:"🎊 Your Completion Code"}),d.jsx("p",{style:{marginBottom:"20px",opacity:.9,fontSize:"16px"},children:"Copy this code and paste it into the Qualtrics survey to verify your completion:"}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"20px",marginBottom:"20px",backdropFilter:"blur(10px)"},children:[d.jsx("div",{style:{fontFamily:"monospace",fontSize:"28px",fontWeight:"bold",letterSpacing:"2px",marginBottom:"15px",wordBreak:"break-all",textShadow:"2px 2px 4px rgba(0,0,0,0.2)",userSelect:"text",cursor:"text"},onClick:p=>{const g=window.getSelection(),m=document.createRange();m.selectNodeContents(p.currentTarget),g.removeAllRanges(),g.addRange(m)},title:"Click to select all text",children:s}),d.jsx("button",{onClick:h,style:{padding:"12px 30px",fontSize:"16px",fontWeight:"bold",background:a?"#4CAF50":"white",color:a?"white":"#764ba2",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:a?"✓ Copied!":"📋 Copy Code"})]}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:"6px",padding:"15px",fontSize:"14px",lineHeight:"1.5"},children:[d.jsx("strong",{children:"⚠️ Important:"})," This code is your proof of completion. Make sure to copy it before closing this window!",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"13px",opacity:.9},children:"💡 Tip: If the Copy button doesn't work, click on the code text to select it, then use Ctrl+C (or Cmd+C on Mac) to copy."})]}),d.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[d.jsx("summary",{style:{cursor:"pointer",opacity:.8,fontSize:"12px",marginBottom:"10px"},children:"Code Details ▼"}),d.jsxs("div",{style:{fontSize:"12px",opacity:.7,background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",fontFamily:"monospace"},children:[d.jsxs("div",{children:["Levels Completed: ",e,"/45"]}),d.jsxs("div",{children:["Game Mode: ",r.limit==="time"?"Time Challenge":"Task Attempts"]}),d.jsxs("div",{children:["Accuracy Mode: ",r.accuracy==="strict"?"Strict (100%)":"Lenient"]}),d.jsxs("div",{children:["Total Time: ",Math.floor(n/60),"m ",n%60,"s"]}),d.jsxs("div",{children:["Generated: ",new Date().toLocaleString()]})]})]})]})}function vI(){const[t,e]=j.useState([]),[n,r]=j.useState(!0),[s,i]=j.useState(null),[a,l]=j.useState(!1),[u,h]=j.useState(""),p=["3040748714","3040729812","3040859968","3040852909","3040869211","3040849958","3039838870","15177695","3040849997","3039845630","3040682661","26416809","3039850622","3040869510","3031977170","3040806629","3040848528","3039840443","3040848749","3040849893","3039850830","3039850713"],g=["3040850023","22900589","3039850570","3040882302","3040815651","3040701758","3040852077","3036343361","3040869458","3040705047","3040702343","3039842887","3040848593","3040702603","3039840222","3039840209","3040861190","18565110","3040869302","3040814338","3039754031"],m=["3040705476","3040697715","3039753992","3040729513","3040681595","3040850010","3032682772","3039842484","3040869445","3040814455","3039840781","3040696831","3040705125","3034184066","3039843004","3039842835","3040860072","3040871018","3039839026","3040814429","3040869094","3040748064","3040875945","3040701589","3040682193","3040729422","3040836165","21798975","3038626424","3039753017","3039840287","3040806382"],I=["25958106","3040814351","3040848697","3040684039","3040869289","22971551","3040837218","3040864570","3040705099","3034288430","3040848541","3040864531","3040869237","3032342054","3040682479","3039840170","3032397447","3039850856","3039840118","3040729552","3040683181","3040861073","3031968434","3040882575","3035320237","3040823815","3039842575","24261697","23420611","3032000089","3040882341"],R=_=>p.includes(_)?{section:"01A-Checkpoint",hasCheckpoint:!0,isAdmin:!1}:g.includes(_)?{section:"01A-No Checkpoint",hasCheckpoint:!1,isAdmin:!1}:m.includes(_)?{section:"02A-Checkpoint",hasCheckpoint:!0,isAdmin:!1}:I.includes(_)?{section:"02A-No Checkpoint",hasCheckpoint:!1,isAdmin:!1}:_.startsWith("ADMIN-TEST")?{section:"ADMIN-TEST",hasCheckpoint:!0,isAdmin:!0}:_.includes("ADMIN")||_.includes("admin")?{section:"ADMIN",hasCheckpoint:!1,isAdmin:!0}:{section:"Unknown",hasCheckpoint:!1,isAdmin:!1};j.useEffect(()=>{P()},[]);const P=async()=>{r(!0);try{const _=await bs(Hn(Ye,"sessions")),S=new Date,x=`${S.getFullYear()}-${String(S.getMonth()+1).padStart(2,"0")}-${String(S.getDate()).padStart(2,"0")}`,X=qi(Hn(Ye,"accessRefreshes"),fd("refreshedAt",">=",new Date(x))),ee=await bs(X),Y=new Set;ee.forEach(L=>{const W=L.data();Y.add(W.studentId)});const B={};_.forEach(L=>{var J;const W=L.data();if(W.role!=="master_admin"&&W.studentId){const ie=R(W.studentId);B[W.studentId]||(B[W.studentId]={studentId:W.studentId,sessions:[],latestAccess:null,totalAccesses:0,displayName:`Student ${W.studentId}`,section:ie.section,hasCheckpoint:ie.hasCheckpoint,hasPlayed:!0,isAdmin:ie.isAdmin,hasBeenRefreshedToday:Y.has(W.studentId)}),B[W.studentId].sessions.push({id:L.id,timestamp:(J=W.startTime)!=null&&J.toDate?W.startTime.toDate():new Date(W.clientStartTime),status:W.status,completedTasks:Object.keys(W.completedTasks||{}).length,finalScore:W.finalScore||0,currentSemester:W.currentSemester||1,timeElapsed:W.timeElapsed||W.totalTime||0})}}),Object.values(B).forEach(L=>{var W;L.sessions.sort((J,ie)=>ie.timestamp-J.timestamp),L.latestAccess=((W=L.sessions[0])==null?void 0:W.timestamp)||null,L.totalAccesses=L.sessions.length});const D=[];[...p,...g,...m,...I].forEach(L=>{if(B[L])D.push(B[L]);else{const W=R(L);D.push({studentId:L,sessions:[],latestAccess:null,totalAccesses:0,displayName:`Student ${L}`,section:W.section,hasCheckpoint:W.hasCheckpoint,hasPlayed:!1,isAdmin:W.isAdmin,hasBeenRefreshedToday:Y.has(L)})}}),D.sort((L,W)=>L.hasPlayed&&!W.hasPlayed?-1:!L.hasPlayed&&W.hasPlayed?1:L.latestAccess&&W.latestAccess?W.latestAccess-L.latestAccess:L.studentId.localeCompare(W.studentId)),e(D)}catch(_){console.error("Error loading student data:",_)}finally{r(!1)}},O=async _=>{l(!0);try{const x=new Date().toISOString().split("T")[0],X=`played_${_}_${x}`;localStorage.removeItem(X),await Kh(Hn(Ye,"accessRefreshes"),{studentId:_,refreshedBy:"MASTER_ADMIN",refreshedAt:dn(),reason:"Manual refresh by admin"}),alert(`Access refreshed for student ${_}. They can now play again today.`),await P()}catch(S){console.error("Error refreshing access:",S),alert(`Failed to refresh access: ${S.message}`)}finally{l(!1)}},k=async()=>{if(confirm(`⚠️ DANGER: This will permanently delete ALL student sessions, events, and access data.

This action cannot be undone. Are you absolutely sure?`)){l(!0);try{const _=qi(Hn(Ye,"sessions")),S=await bs(_),x=S.docs.map(L=>Zu(L.ref)),X=qi(Hn(Ye,"events")),ee=await bs(X),Y=ee.docs.map(L=>Zu(L.ref)),B=qi(Hn(Ye,"accessRefreshes")),D=await bs(B),z=D.docs.map(L=>Zu(L.ref));Object.keys(localStorage).forEach(L=>{L.startsWith("played_")&&localStorage.removeItem(L)}),await Promise.all([...x,...Y,...z]),alert(`✅ All data reset complete!

Deleted:
- ${S.size} sessions
- ${ee.size} events
- ${D.size} access refreshes
- All localStorage data`),await P()}catch(_){console.error("Error resetting all data:",_),alert("Failed to reset data. Please check console for details.")}finally{l(!1)}}},A=t.filter(_=>_.studentId.toLowerCase().includes(u.toLowerCase())),C=_=>_?new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).format(_):"Never",N=_=>!_.sessions||_.sessions.length===0?0:Math.max(..._.sessions.map(S=>S.finalScore||0)),V=_=>!_.sessions||_.sessions.length===0?0:_.sessions.reduce((x,X)=>(X.finalScore||0)>(x.finalScore||0)?X:x,_.sessions[0]).timeElapsed||0,F=_=>{if(!_)return"N/A";const S=Math.floor(_/60),x=_%60;return`${S}:${x.toString().padStart(2,"0")}`},w=t.filter(_=>!_.section.includes("ADMIN")).length,v=t.filter(_=>!_.section.includes("ADMIN")&&_.hasPlayed).length,E=t.filter(_=>!_.section.includes("ADMIN")).reduce((_,S)=>_+S.totalAccesses,0);t.filter(_=>!_.section.includes("ADMIN")&&_.hasPlayed).reduce((_,S)=>_+N(S),0)/(v||1);const T=t.filter(_=>!_.section.includes("ADMIN")&&!_.hasPlayed).length;return d.jsxs("div",{style:{padding:"20px",maxWidth:"1400px",margin:"0 auto"},children:[d.jsx("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"30px",borderRadius:"12px",marginBottom:"30px",color:"white"},children:d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("div",{children:[d.jsx("h1",{style:{margin:"0 0 10px 0"},children:"🔐 Master Admin Dashboard"}),d.jsx("p",{style:{margin:0,opacity:.9},children:"Manage student access and view activity logs"})]}),d.jsx("button",{onClick:k,disabled:a,style:{padding:"12px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",opacity:a?.6:1},children:a?"Processing...":"🗑️ Reset All Data"})]})}),d.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"25px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"30px"},children:[d.jsx("h2",{style:{margin:"0 0 20px 0",color:"#333",fontSize:"20px"},children:"📋 Admin Code Reference"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px"},children:[d.jsxs("div",{style:{border:"2px solid #4CAF50",borderRadius:"8px",padding:"15px",background:"#f8fff8"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#4CAF50",fontSize:"16px"},children:"🧪 Test Codes (Internal Use)"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px"},children:[d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-TEST1"})," to ",d.jsx("code",{children:"ADMIN-TEST10"})]}),d.jsx("li",{children:"Student-like experience with infinite attempts"}),d.jsx("li",{children:"12-minute duration, AI enabled, checkpoints"}),d.jsx("li",{children:"Data tracked like regular students"})]})]}),d.jsxs("div",{style:{border:"2px solid #2196F3",borderRadius:"8px",padding:"15px",background:"#f8fcff"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#2196F3",fontSize:"16px"},children:"⚙️ Admin Codes (Testing)"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px"},children:[d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-REGULAR"})," - Standard 12min, AI enabled"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-FAST"})," - Quick 2min test mode"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-1-CP"})," - No AI, with checkpoint"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-1-NCP"})," - No AI, no checkpoint"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-2-CP"})," - AI enabled, with checkpoint"]}),d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-2-NCP"})," - AI enabled, no checkpoint"]})]})]}),d.jsxs("div",{style:{border:"2px solid #9C27B0",borderRadius:"8px",padding:"15px",background:"#fdf8ff"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#9C27B0",fontSize:"16px"},children:"🔐 Master Admin"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px"},children:[d.jsxs("li",{children:[d.jsx("code",{children:"ADMIN-MASTER"})," - Access to this interface"]}),d.jsx("li",{children:"Student data management and analysis"}),d.jsx("li",{children:"Access refresh and data reset capabilities"}),d.jsx("li",{children:"No gameplay, admin interface only"})]})]})]})]}),d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"12px",marginBottom:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[d.jsxs("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[d.jsx("input",{type:"text",placeholder:"Search by Student ID...",value:u,onChange:_=>h(_.target.value),style:{flex:1,padding:"10px 15px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"14px"}}),d.jsx("button",{onClick:P,disabled:n,style:{padding:"10px 20px",background:"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold"},children:"🔄 Refresh Data"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"15px",marginTop:"20px"},children:[d.jsxs("div",{style:{padding:"15px",background:"#e3f2fd",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:w}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Students"})]}),d.jsxs("div",{style:{padding:"15px",background:"#e8f5e9",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:v}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Have Played"})]}),d.jsxs("div",{style:{padding:"15px",background:"#fff3e0",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:E}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Sessions"})]}),d.jsxs("div",{style:{padding:"15px",background:"#fce4ec",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#e91e63"},children:T}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Never Played"})]}),d.jsxs("div",{style:{padding:"15px",background:"#f3e5f5",borderRadius:"8px",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#9c27b0"},children:T}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Never Played"})]})]})]}),d.jsx("div",{style:{background:"white",borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:d.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[d.jsx("thead",{children:d.jsxs("tr",{style:{background:"#f5f5f5"},children:[d.jsx("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600"},children:"Student ID"}),d.jsx("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600"},children:"Section"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Status"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Latest Access"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Highest Score"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Time Taken"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Total"}),d.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Actions"})]})}),d.jsx("tbody",{children:n?d.jsx("tr",{children:d.jsx("td",{colSpan:"8",style:{padding:"40px",textAlign:"center"},children:"Loading student data..."})}):A.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:"8",style:{padding:"40px",textAlign:"center"},children:"No students found"})}):A.map(_=>{const S=N(_);return d.jsxs("tr",{style:{borderBottom:"1px solid #e0e0e0",background:s===_.studentId?"#f0f8ff":_.hasPlayed?_.isAdmin?"#fff9c4":"white":"#fafafa"},children:[d.jsx("td",{style:{padding:"15px",fontFamily:"monospace"},children:_.studentId}),d.jsx("td",{style:{padding:"15px"},children:d.jsx("span",{style:{padding:"4px 8px",background:_.isAdmin?"#ffeb3b":_.section.includes("01A")?"#e3f2fd":_.section.includes("02A")?"#f3e5f5":"#f5f5f5",borderRadius:"4px",fontSize:"12px",fontWeight:_.isAdmin?"bold":"normal",color:_.isAdmin?"#333":"inherit"},children:_.section})}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:_.isAdmin?d.jsx("span",{style:{padding:"4px 8px",background:"#9C27B0",color:"white",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:"Unlimited"}):!_.hasPlayed||_.hasBeenRefreshedToday?d.jsx("span",{style:{padding:"4px 8px",background:"#e8f5e9",color:"#2e7d32",borderRadius:"12px",fontSize:"12px"},children:"Active"}):d.jsx("span",{style:{padding:"4px 8px",background:"#ffeb3b",color:"#f57c00",borderRadius:"12px",fontSize:"12px"},children:"Restricted"})}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:C(_.latestAccess)}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:d.jsx("span",{style:{padding:"4px 8px",background:S>=1e3?"#e8f5e9":S>0?"#fff3e0":"#f5f5f5",color:S>=1e3?"#2e7d32":S>0?"#f57c00":"#999",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:S})}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:d.jsx("span",{style:{fontFamily:"monospace",fontSize:"12px",color:"#666",fontWeight:"bold"},children:F(V(_))})}),d.jsx("td",{style:{padding:"15px",textAlign:"center",fontWeight:"bold"},children:_.totalAccesses}),d.jsx("td",{style:{padding:"15px",textAlign:"center"},children:_.isAdmin?d.jsx("span",{style:{color:"#999",fontSize:"12px"},children:"N/A"}):d.jsx("button",{onClick:()=>{i(_.studentId),confirm(`Reset access for Student ${_.studentId} (${_.section})?

This will allow them to play again today.`)&&O(_.studentId)},disabled:a,style:{padding:"6px 12px",background:"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:"🔄 Reset"})})]},_.studentId)})})]})}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",fontSize:"12px",color:"#666",textAlign:"center"},children:["Daily automatic reset is disabled. Use refresh button to manually grant access to students who have already played.",d.jsx("br",{}),"Total roster: ",w," students across 4 conditions (01A-Checkpoint, 01A-No Checkpoint, 02A-Checkpoint, 02A-No Checkpoint)"]})]})}const _I={notifyGameComplete(t={}){try{window.parent.postMessage({type:"gameComplete",status:"finished",timestamp:new Date().toISOString(),...t},"*");try{if(window.parent&&window.parent.document){const e=window.parent.document.querySelector("#NextButton");e&&(e.style.display="inline-block",e.style.visibility="visible",e.disabled=!1)}}catch{window.parent.postMessage({type:"showNextButton",action:"show"},"*")}console.log("✅ Game completion notification sent to Qualtrics")}catch(e){console.error("Failed to notify Qualtrics:",e)}},notifySemesterComplete(t,e,n={}){try{window.parent.postMessage({type:"semesterComplete",semester:t,totalSemesters:e,timestamp:new Date().toISOString(),...n},"*"),window.parent.postMessage({type:"keepNextButtonVisible",action:"maintain"},"*"),console.log(`📚 Semester ${t} completion notification sent`)}catch(r){console.error("Failed to notify Qualtrics of semester completion:",r)}},ensureNextButtonVisible(){try{window.parent.postMessage({type:"ensureNextButton",action:"show",timestamp:new Date().toISOString()},"*")}catch(t){console.error("Failed to ensure Next button visibility:",t)}}};function xI(t,e){const n=t.length,r=e.length,s=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let i=0;i<=n;i++)s[i][0]=i;for(let i=0;i<=r;i++)s[0][i]=i;for(let i=1;i<=n;i++)for(let a=1;a<=r;a++)t[i-1]===e[a-1]?s[i][a]=s[i-1][a-1]:s[i][a]=Math.min(s[i-1][a]+1,s[i][a-1]+1,s[i-1][a-1]+1);return s[n][r]}function wI(){const e=new URLSearchParams(window.location.search).get("admin")==="berkeley2024",[n,r]=j.useState("landing"),[s,i]=j.useState(null),[a,l]=j.useState(null),[u,h]=j.useState("g2t1"),[p,g]=j.useState({}),[m,I]=j.useState(0),[R,P]=j.useState(null),[O,k]=j.useState(!1),[A,C]=j.useState(""),[N,V]=j.useState(!0),[F,w]=j.useState(0),[v,E]=j.useState({}),[T,_]=j.useState(0),[S,x]=j.useState(0),[X,ee]=j.useState(!1),[Y,B]=j.useState(null),[D,z]=j.useState(!1),[L,W]=j.useState(30),[J,ie]=j.useState(!1),[Ae,we]=j.useState(5),[he,de]=j.useState(!1),[Fe,Se]=j.useState(0),[ne,Ce]=j.useState(1),[be]=j.useState(2),[ke,_t]=j.useState([]),[Wt,Ht]=j.useState(null),[qt,Gt]=j.useState(!1),[Qt,or]=j.useState(0),[An,ar]=j.useState(null),[Re,_i]=j.useState({g2t1:!1,g1t1:!1,g3t1:!1}),[Qo,st]=j.useState(1200),[Ze,Br]=j.useState(1200),[xi,Ko]=j.useState(0),[me,Cn]=j.useState({materials:0,research:0,engagement:0,bonus:0}),[Ur,_s]=j.useState({}),[Yo,Xo]=j.useState({}),[uu,xs]=j.useState({}),ws=j.useRef(Date.now()),lr=j.useRef(null);j.useRef(null),j.useRef(null);const Fn=j.useRef(null),Ss=j.useRef(Date.now());j.useRef(1200),j.useRef(1200);const kn=()=>{const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").semesterDuration||12e5,G=Math.floor(q/2e3);return Math.floor(G/60)};if(j.useEffect(()=>{(async()=>{try{const q=new URLSearchParams(window.location.search),G=q.has("code")||q.has("c");if((q.get("code")||q.get("c"))==="ADMIN-MASTER"){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",section:"master_admin",hasAI:!1,isMasterInterface:!0,displayName:"Master Administrator"})),V(!1);return}if(e&&!sessionStorage.getItem("gameConfig")&&sessionStorage.setItem("gameConfig",JSON.stringify({role:"admin",section:"admin",hasAI:!0,checkpointSemester2:!0,displayName:"Admin User"})),!G){r("studentLogin"),V(!1);return}const{allowed:De,reason:ot,resumeSession:ct,newSession:wt,code:ze,codeData:bt}=await Lm.checkAccess();if(!De){k(!0),C(ot),V(!1);return}if(ct)P(ct),localStorage.setItem("sessionId",ct);else if(wt){const Rn=await Lm.createSession(ze,bt);P(Rn)}await je.syncOfflineEvents(),V(!1)}catch{V(!1)}})()},[]),j.useEffect(()=>{n==="complete"&&ne>=be&&_I.notifyGameComplete({finalScore:Math.round(xt())+(me.bonus||0),totalTime:F,semestersCompleted:ne,sessionId:R})},[n,ne,be,F,me.bonus,R]),j.useEffect(()=>{localStorage.setItem("currentTask",u)},[u]),j.useEffect(()=>{localStorage.setItem("gameMode",JSON.stringify(s))},[s]),j.useEffect(()=>{localStorage.setItem("currentSemester",ne.toString())},[ne]),j.useEffect(()=>{localStorage.setItem("totalSemesters",be.toString())},[be]),j.useEffect(()=>{localStorage.setItem("completedTasksCount",Object.keys(p).length.toString())},[p]),j.useEffect(()=>{localStorage.setItem("completedLevels",m.toString())},[m]),j.useEffect(()=>{localStorage.setItem("totalSwitches",T.toString())},[T]),j.useEffect(()=>{localStorage.setItem("categoryPoints",JSON.stringify(me))},[me]),j.useEffect(()=>{localStorage.setItem("studentLearningScore",xi.toString())},[xi]),j.useEffect(()=>{const K=Re.g2t1&&Re.g1t1&&Re.g3t1;localStorage.setItem("practiceCompleted",K.toString())},[Re]),N)return d.jsx("div",{className:"app",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:d.jsx("h2",{children:"Loading..."})});if(window.location.search.includes("master=true")&&JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="master_admin")return d.jsx(vI,{});if(window.location.search.includes("admin=true"))return d.jsx(gI,{});const xt=(K=me,q=Ur)=>{let G=0;Object.entries(q).forEach(([wt,ze])=>{const Rn=1+parseInt(wt)*.15;G+=ze*Rn});const oe=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,De=G+oe,ot=K.materials||0,ct=K.research||0;return console.log(`📊 STUDENT LEARNING: ${De.toFixed(1)} pts | Materials: ${ot} (with sequential multipliers) | Research: ${ct} | Interest: ${oe.toFixed(1)} = ${De.toFixed(1)}`),isNaN(De)?0:De},Jo=()=>{const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(!(ne===2&&K.checkpointSemester2))return;Gt(!0),xt()>=300?(or(300),Cn(De=>({...De,bonus:(De.bonus||0)+300}))):or(0),ee(!0),B("checkpoint")},$r=()=>{const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),q=K.semesterDuration||12e5,G=Math.floor(q/1e3);st(G),Br(G),ws.current=Date.now(),lr.current=setInterval(()=>{const De=Date.now()-ws.current,ot=Math.floor(De/1e3);w(ot);const ct=Math.max(0,G-ot);if(Br(ct),ot%10===0&&R&&!R.startsWith("offline-")&&qn(un(Ye,"sessions",R),{timeElapsed:ot,lastUpdated:dn()}).catch(ze=>console.error("Failed to update session time:",ze)),ne===2&&K.checkpointSemester2){const ze=K.semesterDuration||12e5,bt=Math.floor(ze/2e3);ot===bt&&!qt&&Jo()}ct<=0&&(clearInterval(lr.current),lr.current=null,Wr("semester_complete"))},1e3)},wi=K=>{const G=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin",oe=Re.g2t1&&Re.g1t1&&Re.g3t1;l(K),je.logEvent("practice_choice",{choice:K}),K==="no"?!G&&!oe?(zn("You must complete all three practice tasks first!"),r("practice")):ur():r("practice")},ur=()=>{if(!Wt){const K=Math.floor(Math.random()*1e6);Ht(K),Xn.initializeSeed(K),R&&!R.startsWith("offline-")&&qn(un(Ye,"sessions",R),{randomSeed:K,[`semesterSeeds.semester${ne}`]:K})}localStorage.setItem("engagementInterest","0"),Cn({materials:0,research:0,engagement:0,bonus:0}),_s({}),r("challenge"),g({}),I(0),_(0),x(0),h("g2t1"),Gt(!1),Xo({}),xs({}),$r(),E({g2t1:Date.now()}),je.setPageStartTime("g2t1"),je.logEvent("game_start",{practiceCompleted:a==="yes",timestamp:Date.now(),gameMode:s,currentSemester:ne,totalSemesters:be,isAdminMode:e})},Es=async(K,q)=>{Ss.current=Date.now();let G=0;const oe=K.startsWith("g1")?"research":K.startsWith("g2")?"materials":"engagement";if(oe==="materials")if(q.points!==void 0)G=q.points;else{const ae=parseFloat(q.userAnswer||q.userValue||0),et=parseFloat(q.correctAnswer||q.targetValue||0),Xt=Math.abs(ae-et);Xt===0?G=2:Xt<=1?G=1:G=0}else if(oe==="research")if(q.points!==void 0)G=q.points;else{const ae=parseInt(q.userAnswer||0),et=parseInt(q.correctAnswer||0),Xt=Math.abs(ae-et);Xt===0?G=2:Xt<=1?G=1:G=0}else if(oe==="engagement")if(q.points!==void 0)G=q.points;else{const ae=q.userAnswer||"",et=q.correctAnswer||"";ae===et?G=2:xI(ae,et)===1?G=1:G=0}if(Cn(ae=>{const et={...ae,[oe]:ae[oe]+G};return console.log(`🎯 Updated ${oe}: +${G} (total: ${et[oe]})`),et}),oe==="materials"&&G>0){const ae=me.research;_s(et=>{const Xt=et[ae]||0;return{...et,[ae]:Xt+G}})}const ot=.0015*(oe==="engagement"?me.engagement+G:me.engagement),ct={...me,[oe]:me[oe]+G};let wt=Ur;if(oe==="materials"&&G>0){const ae=me.research,et=Ur[ae]||0;wt={...Ur,[ae]:et+G}}let ze=0;Object.entries(wt).forEach(([ae,et])=>{const qr=1+parseInt(ae)*.15;ze+=et*qr});const Rn=parseFloat(localStorage.getItem("engagementInterest")||"0")+ot*ze;localStorage.setItem("engagementInterest",Rn.toString()),xs(ae=>({...ae,[K]:G})),Xo(ae=>({...ae,[K]:(ae[K]||0)+1}));const Si={...me,[oe]:me[oe]+G},Hr=xt(Si,wt);Ko(Hr);let Yt="";if(oe==="materials"){const ae=Math.abs((q.userValue||0)-(q.targetValue||0));ae===0?Yt="Perfect materials!":ae<=1?Yt=`Off by ${ae.toFixed(2)}`:Yt=`Off by ${ae.toFixed(2)}`}else if(oe==="research"){const ae=Math.abs((q.userAnswer||0)-(q.correctAnswer||0));ae===0?Yt="Perfect research!":ae<=1?Yt=`Off by ${ae}`:Yt=`Off by ${ae}`}else oe==="engagement"&&(G===2?Yt="Perfect engagement!":G===1?Yt="One typo":Yt="Multiple errors");if(zn(`${Yt} | +${G} ${oe} pts`),g(ae=>({...ae,[K]:!0})),I(ae=>ae+1),x(ae=>ae+1),await je.trackTaskComplete(K,q.attempts,q.totalTime,q.accuracy||q.difference||0),await je.logEvent("task_complete",{taskId:K,...q,pointsEarned:G,categoryPoints:ct,studentLearningScore:Hr,engagementInterest:Rn,completionContext:{totalTasksCompleted:Object.keys(p).length+1,currentGameTime:F,switchesBeforeCompletion:T,bonusPromptsEarned:S+1,timeRemaining:Ze}}),R&&!R.startsWith("offline-")&&await qn(un(Ye,"sessions",R),{[`completedTasks.${K}`]:!0,[`taskPoints.${K}`]:G,categoryPoints:ct,studentLearningScore:Hr,engagementInterest:Rn,bonusPrompts:S+1,lastActivity:dn()}),u!==K)return;const Zo=K[1],ea=parseInt(K.substring(3));if(ea<100){const ae=`g${Zo}t${ea+1}`;p[ae]||it(ae,!0)}},it=async(K,q=!1)=>{if(!X){if(p[K]&&!q){zn("Task already completed! Choose a different task.");return}if(q||await je.logEvent("manual_tab_switch",{from:u,to:K,reason:"user_clicked"}),Ss.current=Date.now(),J&&(ie(!1),we(5),Fn.current&&(clearInterval(Fn.current),Fn.current=null)),u!==K&&!q&&_(G=>G+1),await je.trackPageSwitch(u,K,q),v[u]){const G=Date.now()-v[u];await je.logEvent("task_time",{taskId:u,timeSpent:G,completed:p[u]||!1,leftForTask:K})}h(K),E(G=>({...G,[K]:Date.now()})),je.setPageStartTime(K)}},zn=K=>{const q=document.createElement("div");q.className="notification-enter",q.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",q.textContent=K,document.body.appendChild(q),setTimeout(()=>{q.className="notification-exit",setTimeout(()=>{document.body.contains(q)&&document.body.removeChild(q)},500)},3e3)},Wr=async(K="semester_complete")=>{lr.current&&clearInterval(lr.current);const q=Math.floor((Date.now()-ws.current-Fe)/1e3),G=xt(),oe=me.bonus||0,De=Math.round(G)+oe;await je.logEvent("game_complete",{totalTime:q,totalSwitches:T,completedTasks:Object.keys(p).length,completedLevels:m,completionReason:K,gameMode:s,currentSemester:ne,categoryPoints:me,studentLearningScore:G,totalBonus:oe,finalScore:De,finalContext:{practiceCompleted:a==="yes",totalPrompts:3+S,isAdminMode:e}}),R&&!R.startsWith("offline-")&&await qn(un(Ye,"sessions",R),{status:"completed",completedAt:dn(),finalTime:q,timeElapsed:q,totalSwitches:T,completionReason:K,currentSemester:ne,finalScore:De,studentLearningScore:G}),r("complete")},Kt=(K,q)=>{if(q&&q.points&&q.points===2)_i(G=>({...G,[K]:!0})),zn("Perfect! Practice task completed."),setTimeout(()=>{ar(null)},1500);else{const G=(q==null?void 0:q.points)||0;zn(`Practice requires 100% accuracy. You scored ${G===1?"50%":"0%"}. Try again!`),setTimeout(()=>{ar(null)},2e3)}},cu=()=>{const K=u[1],q=parseInt(u.substring(3)),G=n==="practice";return K==="1"?d.jsx(md,{taskNum:q,onComplete:G?Kt:Es,currentTaskId:u,isPractice:G}):K==="2"?d.jsx(gd,{taskNum:q,onComplete:G?Kt:Es,currentTaskId:u,isPractice:G}):d.jsx(yd,{taskNum:q,onComplete:G?Kt:Es,currentTaskId:u,isPractice:G})};if(n==="studentLogin")return d.jsx(mI,{onLoginSuccess:K=>{window.location.href=`${window.location.origin}?code=${K}`}});if(O)return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"600px",margin:"50px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[d.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Access Denied"}),d.jsx("p",{style:{fontSize:"18px",marginBottom:"20px"},children:A}),d.jsx("div",{style:{padding:"15px",background:"#ffebee",borderRadius:"8px",border:"1px solid #f44336"},children:d.jsx("p",{style:{color:"#c62828",margin:0},children:"If you believe this is an error, please contact your instructor."})})]})});if(n==="semesterBreak"){const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),q=ne===2&&K.checkpointSemester2;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"700px",margin:"50px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsxs("h1",{style:{color:"#2196F3",marginBottom:"30px"},children:["🎉 Semester ",ne-1," Complete!"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsx("h3",{style:{color:"#1976d2",marginBottom:"10px"},children:"Take a Break!"}),d.jsxs("p",{style:{fontSize:"16px",color:"#666",marginBottom:"0"},children:["Great job completing Semester ",ne-1,"! Take a moment to rest your eyes, stretch, or grab some water before continuing."]})]}),q&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",padding:"25px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #ff9800"},children:[d.jsx("h3",{style:{color:"#f57c00",marginBottom:"15px"},children:"📚 Midterm Checkpoint Coming!"}),d.jsxs("div",{style:{fontSize:"16px",color:"#666",textAlign:"left"},children:[d.jsx("p",{style:{marginBottom:"10px"},children:d.jsxs("strong",{children:["Semester 2 includes a midterm exam at the"," ",kn(),"-minute mark!"]})}),d.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"10px"},children:[d.jsx("li",{children:"Your students will be tested at the midpoint"}),d.jsxs("li",{children:["If student learning ≥ 300 points:"," ",d.jsx("strong",{children:"+300 bonus points!"})]}),d.jsx("li",{children:"Build up your teaching effectiveness early to maximize the bonus"})]}),d.jsxs("p",{style:{background:"white",padding:"10px",borderRadius:"4px",textAlign:"center",fontWeight:"bold",color:"#f57c00"},children:["Goal: Reach 300+ Student Learning by minute"," ",kn()]})]})]}),ke.length>0&&d.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"10px"},children:"Your Performance So Far:"}),ke.map((G,oe)=>d.jsxs("div",{style:{marginBottom:"8px",fontSize:"16px"},children:["Semester ",oe+1,":"," ",d.jsxs("strong",{children:[G.finalScore," points"]})]},oe))]}),d.jsxs("div",{style:{marginTop:"30px"},children:[d.jsxs("button",{onClick:()=>{r("challenge"),$r(),E({g2t1:Date.now()}),je.setPageStartTime("g2t1"),je.logEvent("semester_start",{semester:ne,timestamp:Date.now(),hasCheckpoint:q})},style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:G=>{G.currentTarget.style.transform="translateY(-2px)",G.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:G=>{G.currentTarget.style.transform="translateY(0)",G.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["I'm Ready - Start Semester ",ne]}),d.jsx("p",{style:{marginTop:"15px",fontSize:"14px",color:"#999"},children:"Click when you're ready to continue. The timer will start immediately."})]})]})})}if(n==="landing"){s||i({accuracy:"lenient",limit:"time"});const K=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),q=K.role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",style:{padding:"40px",maxWidth:"900px"},children:[d.jsxs("h1",{style:{color:"#333",marginBottom:"30px",fontSize:"32px",textAlign:"left"},children:["Can you beat Park? - Semester ",ne,"/",be]}),d.jsxs("div",{className:"game-info",style:{textAlign:"left"},children:[d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#f44336",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:"✉️"})," Engagement"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Build interest that compounds! Each point adds 0.15% interest after every task completion."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#9C27B0",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:"📚"})," Research"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Research amplifies your FUTURE materials! Each point adds +15% multiplier to materials earned after the research (order matters!)."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#4CAF50",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:"🎯"})," Materials"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Create teaching materials - each point directly contributes to your goal points!"})]}),d.jsxs("div",{style:{background:"#f0f8ff",borderRadius:"8px",padding:"25px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{color:"#2196F3",fontSize:"20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:"📊"})," Student Learning Formula"]}),d.jsxs("div",{style:{background:"white",padding:"18px",borderRadius:"6px",fontFamily:"monospace",fontSize:"18px",textAlign:"center",marginBottom:"20px",border:"1px solid #e0e0e0",lineHeight:"1.8"},children:["Goal ="," ",d.jsx("strong",{children:"Materials × (1 + Research×0.15) + Engagement Interest"}),d.jsx("br",{}),d.jsxs("div",{style:{fontSize:"14px",marginTop:"10px",fontFamily:"sans-serif"},children:["Research multipliers apply only to materials earned"," ",d.jsx("em",{children:"after"})," the research"]})]}),d.jsxs("ul",{style:{color:"#333",lineHeight:"2",margin:"0",paddingLeft:"25px",fontSize:"15px",textAlign:"left"},children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Scoring:"})," Exact = 2 pts | Within 1 = 1 pt | Otherwise = 0 pts"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Timing:"})," Task completion order affects your final score"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Strategy:"})," Think carefully about when to complete each task type!"]}),ne===2&&d.jsxs("li",{children:["At minute ",kn(),": Exam checkpoint with bonus opportunity (300+ Student Learning = 300 bonus)"]})]})]}),K.hasAI&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"1px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"AI Assistant Available:"}),d.jsxs("ul",{style:{color:"#856404",lineHeight:"1.6",margin:"0",paddingLeft:"20px",fontSize:"14px"},children:[d.jsx("li",{children:"Click the help buttons below each task for AI assistance"}),d.jsx("li",{children:"Unlimited use but reliability varies"}),d.jsx("li",{children:'Type "strategy" or "order" in chat for strategic advice!'})]})]}),ne===2&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"2px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"📚 Semester 2: Midterm Checkpoint!"}),d.jsxs("p",{style:{color:"#856404",fontSize:"14px",margin:0},children:["At the ",kn(),"-minute mark, if you have 300+ student learning points, you'll earn a 300-point bonus!"]})]})]}),!q&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)",borderRadius:"12px",padding:"20px",marginTop:"20px",marginBottom:"20px",border:"2px solid #d32f2f",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"12px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:"⚠️"}),d.jsx("h3",{style:{color:"#b71c1c",margin:0,fontSize:"18px",fontWeight:"600"},children:"ONE ATTEMPT ONLY - NO RESTART"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:"❌"}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No refresh/close"})," - Session ends"]})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:"❌"}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No tab switching"})," - 30s warning"]})]})]}),d.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"6px",textAlign:"center",fontSize:"14px",color:"#b71c1c",fontWeight:"600"},children:"⏰ Ensure 40 minutes uninterrupted before starting"})]}),d.jsxs("button",{className:"start-button",onClick:()=>r("practiceChoice"),children:["Start Semester ",ne]}),e&&d.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#ffcccb",borderRadius:"6px",border:"2px solid #ff0000",fontWeight:"bold",color:"#d00"},children:["ADMIN MODE: ",Qo/60," minute timer, checkpoint at"," ",kn(),"minute"]}),ke.length>0&&d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"6px",fontSize:"14px"},children:[d.jsx("strong",{children:"Previous Semesters:"}),ke.map((G,oe)=>d.jsxs("div",{style:{marginTop:"5px"},children:["Semester ",oe+1,": ",G.finalScore," points"]},oe))]})]})})})}if(n==="practiceChoice"){const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",children:[d.jsx("h2",{style:{color:"#333",marginBottom:"20px"},children:q?"Practice Mode (Optional for Admin)":"Practice Mode (Required)"}),d.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:q?"As an admin, you can skip practice or try it first.":"You must complete all three practice tasks before starting the main game."}),d.jsx("p",{style:{color:"#888",fontSize:"14px",marginBottom:"30px",fontStyle:"italic"},children:"Practice lets you try each teaching task without time pressure."}),!q&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #1976d2",boxShadow:"0 4px 6px rgba(25, 118, 210, 0.1)"},children:[d.jsxs("h4",{style:{color:"#0d47a1",margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:"📋"}),"Required Practice Tasks (100% accuracy needed):"]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Re.g2t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Re.g2t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:"🎯"}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Materials"})}),Re.g2t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:"✓"}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Re.g1t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Re.g1t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:"📚"}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Research"})}),Re.g1t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:"✓"}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Re.g3t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Re.g3t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:"✉️"}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Engagement"})}),Re.g3t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:"✓"}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]})]}),d.jsx("div",{style:{marginTop:"16px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"6px",fontSize:"13px",color:"#0d47a1",textAlign:"center",fontStyle:"italic"},children:"💡 Each task must be completed perfectly to proceed"})]}),d.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[d.jsx("button",{onClick:()=>wi("yes"),style:{padding:"15px 30px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:q?"Try Practice Mode":"Start Required Practice"}),q&&d.jsx("button",{onClick:()=>wi("no"),style:{padding:"15px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:"Skip Practice (Admin)"})]})]})})})}if(n==="practice"){const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";if(!An)return d.jsxs("div",{className:"app",children:[d.jsx("h1",{children:"Teaching Simulation - Practice Mode"}),d.jsx(hI,{practiceCompleted:Re,onPracticeComplete:Kt,onSelectPractice:ar,onStartMainGame:()=>{const De=Re.g2t1&&Re.g1t1&&Re.g3t1;!q&&!De?zn("You must complete all three practice tasks first!"):ur()},isAdmin:q})]});const G=An[1],oe=1;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[d.jsx("button",{onClick:()=>ar(null),style:{marginBottom:"20px",padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"← Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),G==="1"&&d.jsx(md,{taskNum:oe,onComplete:Kt,currentTaskId:An,isPractice:!0}),G==="2"&&d.jsx(gd,{taskNum:oe,onComplete:Kt,currentTaskId:An,isPractice:!0}),G==="3"&&d.jsx(yd,{taskNum:oe,onComplete:Kt,currentTaskId:An,isPractice:!0})]})})}if(n==="complete"){const K=Math.floor(F/60),q=F%60,G=Math.round(xt()),oe=me.bonus||0,De=G+oe,ot={semester:ne,totalTime:F,completedLevels:m,categoryPoints:me,switches:T,gameMode:s,randomSeed:Wt,studentLearningScore:G,finalScore:De},ct=async()=>{const ze=[...ke,ot];_t(ze),localStorage.setItem("engagementInterest","0"),Cn({materials:0,research:0,engagement:0,bonus:0}),_s({}),R&&!R.startsWith("offline-")&&await qn(un(Ye,"sessions",R),{[`semesterHistory.semester${ne}`]:ot,currentSemester:ne+1,lastActivity:dn()}),Ce(ne+1),Ct.resetForNewSemester(),r("semesterBreak"),g({}),I(0),_(0),x(0),w(0),Se(0),h("g2t1"),Gt(!1);const bt=Math.floor(Math.random()*1e6);Ht(bt),Xn.initializeSeed(bt)},wt=ne>=be;return d.jsxs("div",{className:"app",children:[d.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[d.jsx("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"8px",border:"2px solid #2196F3"},children:d.jsxs("h2",{style:{color:"#2196F3",margin:0},children:["Semester ",ne," of ",be," Complete!"]})}),wt&&d.jsx(yI,{sessionId:R,completedLevels:m,totalTime:F,gameMode:s}),d.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginTop:"20px"},children:[d.jsxs("h2",{style:{color:"#333",marginBottom:"20px"},children:["📊 Semester ",ne," Performance"]}),d.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2196F3",marginBottom:"30px"},children:["Final Score: ",De," points"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{margin:"0 0 15px 0",color:"#1976d2"},children:["Student Learning Score: ",G]}),d.jsxs("div",{style:{fontSize:"16px",color:"#666"},children:["= ",me.materials||0," (Materials) ×"," ",(1+(me.research||0)*.15).toFixed(2)," ","(Research)",parseFloat(localStorage.getItem("engagementInterest")||"0")>0&&` + ${parseFloat(localStorage.getItem("engagementInterest")||"0").toFixed(2)} (Interest)`]}),oe>0&&d.jsxs("div",{style:{marginTop:"10px",fontSize:"16px",color:"#1976d2"},children:["+ ",oe," Checkpoint Bonus"]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Total Time"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[K,"m ",q,"s"]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Student Learning"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:G})]}),(ne===2||oe>0)&&d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Checkpoint Bonus"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:["+",oe]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Tasks Completed"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:m})]})]}),d.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:"Teaching Performance by Category"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f0f8f0",padding:"15px",borderRadius:"6px",border:"2px solid #4CAF5020"},children:[d.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",marginBottom:"5px"},children:"🎯 Materials"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:me.materials||0}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Base points"})]}),d.jsxs("div",{style:{background:"#f8f0ff",padding:"15px",borderRadius:"6px",border:"2px solid #9C27B020"},children:[d.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold",marginBottom:"5px"},children:"📚 Research"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:me.research||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(me.research||0)*15,"% to future materials"]})]}),d.jsxs("div",{style:{background:"#fff0f0",padding:"15px",borderRadius:"6px",border:"2px solid #f4433620"},children:[d.jsx("div",{style:{color:"#f44336",fontWeight:"bold",marginBottom:"5px"},children:"✉️ Engagement"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:me.engagement||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",((me.engagement||0)*.15).toFixed(1),"% interest/task"]})]})]})]}),ne===2&&me.bonus>0&&d.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[d.jsxs("strong",{style:{color:"#856404"},children:["📚 Exam Season Bonus:"," "]}),d.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#856404"},children:["+",me.bonus," points"]})]}),ke.length>0&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"15px"},children:"Progress Over Semesters"}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px"},children:[...ke,ot].map((ze,bt)=>d.jsxs("div",{style:{padding:"10px",background:bt===ke.length?"#e3f2fd":"white",borderRadius:"6px",border:"1px solid #e0e0e0",textAlign:"center"},children:[d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Semester ",bt+1]}),d.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:ze.finalScore})]},bt))})]})]}),d.jsx("div",{style:{marginTop:"30px",textAlign:"center"},children:wt?d.jsxs("div",{style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h3",{style:{color:"#856404",marginBottom:"10px"},children:"⚠️ All semesters complete!"}),d.jsx("p",{style:{color:"#856404",marginBottom:"0"},children:"Return to the Qualtrics survey and enter your completion code to finish the study."})]}):d.jsxs("button",{onClick:ct,style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",ne+1," →"]})})]})}return d.jsxs("div",{className:"app",children:[X&&Y==="checkpoint"&&d.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.8)",zIndex:999999,display:"flex",alignItems:"center",justifyContent:"center"},children:d.jsxs("div",{style:{background:"white",padding:"40px",borderRadius:"12px",textAlign:"center",maxWidth:"700px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[d.jsx("h2",{style:{color:"#4CAF50",marginBottom:"25px",fontSize:"28px"},children:"📚 Midterm Exam Results!"}),d.jsxs("div",{style:{fontSize:"18px",marginBottom:"25px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[d.jsx("p",{style:{marginBottom:"15px"},children:"The midterm exam has arrived! Let's see how your students performed..."}),d.jsxs("div",{style:{fontSize:"20px",fontWeight:"bold",color:"#1976d2",padding:"15px",background:"white",borderRadius:"6px",margin:"15px 0"},children:["Student Learning Score: ",Math.round(xt())," ","pts"]})]}),d.jsxs("div",{style:{marginBottom:"25px",padding:"20px",background:"#e3f2fd",borderRadius:"8px",textAlign:"left"},children:[d.jsx("h3",{style:{marginBottom:"15px",textAlign:"center"},children:"Your Teaching Performance:"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[d.jsxs("div",{style:{padding:"10px",background:"white",borderRadius:"6px",textAlign:"center"},children:[d.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold"},children:"Materials"}),d.jsxs("div",{style:{fontSize:"20px"},children:[me.materials," pts"]})]}),d.jsxs("div",{style:{padding:"10px",background:"white",borderRadius:"6px",textAlign:"center"},children:[d.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold"},children:"Research"}),d.jsxs("div",{style:{fontSize:"20px"},children:[me.research," pts"]}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["×",(1+me.research*.15).toFixed(2)]})]}),d.jsxs("div",{style:{padding:"10px",background:"white",borderRadius:"6px",textAlign:"center"},children:[d.jsx("div",{style:{color:"#f44336",fontWeight:"bold"},children:"Engagement"}),d.jsxs("div",{style:{fontSize:"20px"},children:[me.engagement," pts"]}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(me.engagement*.15).toFixed(1),"% interest"]})]})]})]}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",padding:"20px",borderRadius:"8px",marginBottom:"25px",background:Qt>0?"linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%)":"linear-gradient(135deg, #fff3cd 0%, #ffe082 100%)",border:`2px solid ${Qt>0?"#4CAF50":"#ff9800"}`,color:Qt>0?"#2e7d32":"#f57c00"},children:ne===2?Qt>0?d.jsxs(d.Fragment,{children:["🎉 Excellent Teaching! +",Qt," bonus points earned!"]}):d.jsxs(d.Fragment,{children:["📚 Goal was 300+ points (you had"," ",Math.round(xt()),"). Keep teaching!"]}):d.jsx(d.Fragment,{children:"Checkpoint reached! Keep going!"})}),d.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666",textAlign:"left"},children:[d.jsx("strong",{children:"Tips for the rest of the semester:"}),d.jsxs("ul",{style:{margin:"10px 0 0 20px",lineHeight:"1.6"},children:[d.jsxs("li",{children:["You have about ",kn()," minutes remaining"]}),d.jsx("li",{children:"Focus on accuracy - every point counts!"}),d.jsx("li",{children:"Research multiplies everything, Engagement compounds over time"}),d.jsx("li",{children:"Materials give direct points - use them strategically"})]})]}),d.jsx("button",{onClick:()=>{ee(!1),B(null)},style:{padding:"12px 35px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 3px 6px rgba(0,0,0,0.15)",transition:"all 0.3s"},onMouseOver:K=>{K.currentTarget.style.transform="translateY(-2px)",K.currentTarget.style.boxShadow="0 5px 10px rgba(0,0,0,0.2)"},onMouseOut:K=>{K.currentTarget.style.transform="translateY(0)",K.currentTarget.style.boxShadow="0 3px 6px rgba(0,0,0,0.15)"},children:"Continue Teaching →"}),d.jsx("p",{style:{marginTop:"10px",color:"#999",fontSize:"12px"},children:"The timer is paused. Click to continue when ready."})]})}),he&&d.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.9)",zIndex:999999,display:"flex",alignItems:"center",justifyContent:"center"},children:d.jsxs("div",{style:{background:"white",padding:"40px",borderRadius:"10px",textAlign:"center",maxWidth:"500px"},children:[d.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Session Ended"}),d.jsx("p",{style:{marginBottom:"30px"},children:"Your session has been terminated due to inactivity or switching away from the game."}),d.jsx("p",{style:{color:"#c62828",fontWeight:"bold"},children:"You cannot restart. This was your only attempt."})]})}),D&&d.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",background:"#ff9800",color:"white",padding:"15px 20px",borderRadius:"8px",zIndex:1e4,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[d.jsx("strong",{children:"⚠️ Focus Warning"}),d.jsx("br",{}),"Game will be blocked in ",L," seconds"]}),d.jsxs("div",{style:{padding:"20px",maxWidth:"1400px",margin:"0 auto"},children:[d.jsxs("h1",{style:{marginBottom:"30px",textAlign:"center"},children:["Can you beat Park? - Semester ",ne,"/",be]}),d.jsx(dI,{current:u,completed:p,onSwitch:it,limitMode:"time",taskPoints:uu,categoryMultipliers:{},starGoals:{},categoryPoints:me,timeRemaining:Ze}),d.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"stretch",marginTop:"20px",minHeight:"650px",width:"100%"},children:[d.jsx("div",{style:{flex:"0 0 66.666%",minHeight:"650px",display:"flex",alignItems:"center",justifyContent:"center",background:"white",borderRadius:"8px",border:"1px solid #e0e0e0",overflow:"visible"},children:d.jsx("div",{className:"task-container",style:{width:"100%",minHeight:"650px",padding:"20px",display:"flex",alignItems:"center",justifyContent:"center",overflow:"visible"},children:cu()})}),d.jsx("div",{style:{flex:"0 0 33.333%",background:"white",borderRadius:"8px",border:"1px solid #e0e0e0",overflow:"visible",height:"680px",display:"flex",flexDirection:"column"},children:d.jsx(pI,{bonusPrompts:S,currentTask:u,categoryPoints:me,categoryMultipliers:{},starGoals:{},timeRemaining:Ze,calculateStudentLearning:xt,onAIHelp:K=>{window.dispatchEvent(new CustomEvent("aiHelp",{detail:K}))}})})]})]})]})}Yy(document.getElementById("root")).render(d.jsx(j.StrictMode,{children:d.jsx(wI,{})}));
//# sourceMappingURL=index-9hXqlZ8T.js.map
