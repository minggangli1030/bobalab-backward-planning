(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var Gm={exports:{}},zl={},Qm={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uo=Symbol.for("react.element"),s_=Symbol.for("react.portal"),o_=Symbol.for("react.fragment"),a_=Symbol.for("react.strict_mode"),l_=Symbol.for("react.profiler"),u_=Symbol.for("react.provider"),c_=Symbol.for("react.context"),d_=Symbol.for("react.forward_ref"),h_=Symbol.for("react.suspense"),f_=Symbol.for("react.memo"),p_=Symbol.for("react.lazy"),Of=Symbol.iterator;function m_(t){return t===null||typeof t!="object"?null:(t=Of&&t[Of]||t["@@iterator"],typeof t=="function"?t:null)}var Km={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ym=Object.assign,Xm={};function vs(t,e,n){this.props=t,this.context=e,this.refs=Xm,this.updater=n||Km}vs.prototype.isReactComponent={};vs.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vs.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Jm(){}Jm.prototype=vs.prototype;function Dd(t,e,n){this.props=t,this.context=e,this.refs=Xm,this.updater=n||Km}var Nd=Dd.prototype=new Jm;Nd.constructor=Dd;Ym(Nd,vs.prototype);Nd.isPureReactComponent=!0;var Ff=Array.isArray,Zm=Object.prototype.hasOwnProperty,jd={current:null},eg={key:!0,ref:!0,__self:!0,__source:!0};function tg(t,e,n){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)Zm.call(e,r)&&!eg.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];i.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Uo,type:t,key:s,ref:a,props:i,_owner:jd.current}}function g_(t,e){return{$$typeof:Uo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Vd(t){return typeof t=="object"&&t!==null&&t.$$typeof===Uo}function y_(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var zf=/\/+/g;function Iu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?y_(""+t.key):e.toString(36)}function Ua(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Uo:case s_:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+Iu(a,0):r,Ff(i)?(n="",t!=null&&(n=t.replace(zf,"$&/")+"/"),Ua(i,e,n,"",function(h){return h})):i!=null&&(Vd(i)&&(i=g_(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(zf,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",Ff(t))for(var l=0;l<t.length;l++){s=t[l];var u=r+Iu(s,l);a+=Ua(s,e,n,u,i)}else if(u=m_(t),typeof u=="function")for(t=u.call(t),l=0;!(s=t.next()).done;)s=s.value,u=r+Iu(s,l++),a+=Ua(s,e,n,u,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function wa(t,e,n){if(t==null)return t;var r=[],i=0;return Ua(t,r,"","",function(s){return e.call(n,s,i++)}),r}function v_(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Mt={current:null},$a={transition:null},__={ReactCurrentDispatcher:Mt,ReactCurrentBatchConfig:$a,ReactCurrentOwner:jd};function ng(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:wa,forEach:function(t,e,n){wa(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return wa(t,function(){e++}),e},toArray:function(t){return wa(t,function(e){return e})||[]},only:function(t){if(!Vd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fe.Component=vs;fe.Fragment=o_;fe.Profiler=l_;fe.PureComponent=Dd;fe.StrictMode=a_;fe.Suspense=h_;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=__;fe.act=ng;fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Ym({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=jd.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Zm.call(e,u)&&!eg.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:Uo,type:t.type,key:i,ref:s,props:r,_owner:a}};fe.createContext=function(t){return t={$$typeof:c_,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:u_,_context:t},t.Consumer=t};fe.createElement=tg;fe.createFactory=function(t){var e=tg.bind(null,t);return e.type=t,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(t){return{$$typeof:d_,render:t}};fe.isValidElement=Vd;fe.lazy=function(t){return{$$typeof:p_,_payload:{_status:-1,_result:t},_init:v_}};fe.memo=function(t,e){return{$$typeof:f_,type:t,compare:e===void 0?null:e}};fe.startTransition=function(t){var e=$a.transition;$a.transition={};try{t()}finally{$a.transition=e}};fe.unstable_act=ng;fe.useCallback=function(t,e){return Mt.current.useCallback(t,e)};fe.useContext=function(t){return Mt.current.useContext(t)};fe.useDebugValue=function(){};fe.useDeferredValue=function(t){return Mt.current.useDeferredValue(t)};fe.useEffect=function(t,e){return Mt.current.useEffect(t,e)};fe.useId=function(){return Mt.current.useId()};fe.useImperativeHandle=function(t,e,n){return Mt.current.useImperativeHandle(t,e,n)};fe.useInsertionEffect=function(t,e){return Mt.current.useInsertionEffect(t,e)};fe.useLayoutEffect=function(t,e){return Mt.current.useLayoutEffect(t,e)};fe.useMemo=function(t,e){return Mt.current.useMemo(t,e)};fe.useReducer=function(t,e,n){return Mt.current.useReducer(t,e,n)};fe.useRef=function(t){return Mt.current.useRef(t)};fe.useState=function(t){return Mt.current.useState(t)};fe.useSyncExternalStore=function(t,e,n){return Mt.current.useSyncExternalStore(t,e,n)};fe.useTransition=function(){return Mt.current.useTransition()};fe.version="18.3.1";Qm.exports=fe;var D=Qm.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x_=D,w_=Symbol.for("react.element"),S_=Symbol.for("react.fragment"),E_=Object.prototype.hasOwnProperty,T_=x_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,I_={key:!0,ref:!0,__self:!0,__source:!0};function rg(t,e,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)E_.call(e,r)&&!I_.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:w_,type:t,key:s,ref:a,props:i,_owner:T_.current}}zl.Fragment=S_;zl.jsx=rg;zl.jsxs=rg;Gm.exports=zl;var d=Gm.exports,ig={exports:{}},on={},sg={exports:{}},og={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,O){var G=N.length;N.push(O);e:for(;0<G;){var Z=G-1>>>1,ee=N[Z];if(0<i(ee,O))N[Z]=O,N[G]=ee,G=Z;else break e}}function n(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var O=N[0],G=N.pop();if(G!==O){N[0]=G;e:for(var Z=0,ee=N.length,le=ee>>>1;Z<le;){var Ae=2*(Z+1)-1,we=N[Ae],pe=Ae+1,de=N[pe];if(0>i(we,G))pe<ee&&0>i(de,we)?(N[Z]=de,N[pe]=G,Z=pe):(N[Z]=we,N[Ae]=G,Z=Ae);else if(pe<ee&&0>i(de,G))N[Z]=de,N[pe]=G,Z=pe;else break e}}return O}function i(N,O){var G=N.sortIndex-O.sortIndex;return G!==0?G:N.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],h=[],p=1,g=null,y=3,E=!1,C=!1,P=!1,M=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(N){for(var O=n(h);O!==null;){if(O.callback===null)r(h);else if(O.startTime<=N)r(h),O.sortIndex=O.expirationTime,e(u,O);else break;O=n(h)}}function V(N){if(P=!1,k(N),!C)if(n(u)!==null)C=!0,ie(F);else{var O=n(h);O!==null&&$(V,O.startTime-N)}}function F(N,O){C=!1,P&&(P=!1,T(m),m=-1),E=!0;var G=y;try{for(k(O),g=n(u);g!==null&&(!(g.expirationTime>O)||N&&!A());){var Z=g.callback;if(typeof Z=="function"){g.callback=null,y=g.priorityLevel;var ee=Z(g.expirationTime<=O);O=t.unstable_now(),typeof ee=="function"?g.callback=ee:g===n(u)&&r(u),k(O)}else r(u);g=n(u)}if(g!==null)var le=!0;else{var Ae=n(h);Ae!==null&&$(V,Ae.startTime-O),le=!1}return le}finally{g=null,y=G,E=!1}}var L=!1,v=null,m=-1,x=5,S=-1;function A(){return!(t.unstable_now()-S<x)}function R(){if(v!==null){var N=t.unstable_now();S=N;var O=!0;try{O=v(!0,N)}finally{O?I():(L=!1,v=null)}}else L=!1}var I;if(typeof w=="function")I=function(){w(R)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,ne=se.port2;se.port1.onmessage=R,I=function(){ne.postMessage(null)}}else I=function(){M(R,0)};function ie(N){v=N,L||(L=!0,I())}function $(N,O){m=M(function(){N(t.unstable_now())},O)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){C||E||(C=!0,ie(F))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(N){switch(y){case 1:case 2:case 3:var O=3;break;default:O=y}var G=y;y=O;try{return N()}finally{y=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,O){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var G=y;y=N;try{return O()}finally{y=G}},t.unstable_scheduleCallback=function(N,O,G){var Z=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?Z+G:Z):G=Z,N){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=G+ee,N={id:p++,callback:O,priorityLevel:N,startTime:G,expirationTime:ee,sortIndex:-1},G>Z?(N.sortIndex=G,e(h,N),n(u)===null&&N===n(h)&&(P?(T(m),m=-1):P=!0,$(V,G-Z))):(N.sortIndex=ee,e(u,N),C||E||(C=!0,ie(F))),N},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(N){var O=y;return function(){var G=y;y=O;try{return N.apply(this,arguments)}finally{y=G}}}})(og);sg.exports=og;var C_=sg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A_=D,sn=C_;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ag=new Set,po={};function yi(t,e){is(t,e),is(t+"Capture",e)}function is(t,e){for(po[t]=e,t=0;t<e.length;t++)ag.add(e[t])}var Zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hc=Object.prototype.hasOwnProperty,k_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bf={},Uf={};function R_(t){return hc.call(Uf,t)?!0:hc.call(Bf,t)?!1:k_.test(t)?Uf[t]=!0:(Bf[t]=!0,!1)}function P_(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function b_(t,e,n,r){if(e===null||typeof e>"u"||P_(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Lt(t,e,n,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var _t={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){_t[t]=new Lt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];_t[e]=new Lt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){_t[t]=new Lt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){_t[t]=new Lt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){_t[t]=new Lt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){_t[t]=new Lt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){_t[t]=new Lt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){_t[t]=new Lt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){_t[t]=new Lt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Md=/[\-:]([a-z])/g;function Ld(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Md,Ld);_t[e]=new Lt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Md,Ld);_t[e]=new Lt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Md,Ld);_t[e]=new Lt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){_t[t]=new Lt(t,1,!1,t.toLowerCase(),null,!1,!1)});_t.xlinkHref=new Lt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){_t[t]=new Lt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Od(t,e,n,r){var i=_t.hasOwnProperty(e)?_t[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(b_(e,n,i,r)&&(n=null),r||i===null?R_(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ar=A_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sa=Symbol.for("react.element"),Fi=Symbol.for("react.portal"),zi=Symbol.for("react.fragment"),Fd=Symbol.for("react.strict_mode"),fc=Symbol.for("react.profiler"),lg=Symbol.for("react.provider"),ug=Symbol.for("react.context"),zd=Symbol.for("react.forward_ref"),pc=Symbol.for("react.suspense"),mc=Symbol.for("react.suspense_list"),Bd=Symbol.for("react.memo"),yr=Symbol.for("react.lazy"),cg=Symbol.for("react.offscreen"),$f=Symbol.iterator;function Ls(t){return t===null||typeof t!="object"?null:(t=$f&&t[$f]||t["@@iterator"],typeof t=="function"?t:null)}var $e=Object.assign,Cu;function qs(t){if(Cu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Cu=e&&e[1]||""}return`
`+Cu+t}var Au=!1;function ku(t,e){if(!t||Au)return"";Au=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,l=s.length-1;1<=a&&0<=l&&i[a]!==s[l];)l--;for(;1<=a&&0<=l;a--,l--)if(i[a]!==s[l]){if(a!==1||l!==1)do if(a--,l--,0>l||i[a]!==s[l]){var u=`
`+i[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{Au=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?qs(t):""}function D_(t){switch(t.tag){case 5:return qs(t.type);case 16:return qs("Lazy");case 13:return qs("Suspense");case 19:return qs("SuspenseList");case 0:case 2:case 15:return t=ku(t.type,!1),t;case 11:return t=ku(t.type.render,!1),t;case 1:return t=ku(t.type,!0),t;default:return""}}function gc(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zi:return"Fragment";case Fi:return"Portal";case fc:return"Profiler";case Fd:return"StrictMode";case pc:return"Suspense";case mc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ug:return(t.displayName||"Context")+".Consumer";case lg:return(t._context.displayName||"Context")+".Provider";case zd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Bd:return e=t.displayName||null,e!==null?e:gc(t.type)||"Memo";case yr:e=t._payload,t=t._init;try{return gc(t(e))}catch{}}return null}function N_(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gc(e);case 8:return e===Fd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Mr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function dg(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function j_(t){var e=dg(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ea(t){t._valueTracker||(t._valueTracker=j_(t))}function hg(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=dg(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function sl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function yc(t,e){var n=e.checked;return $e({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Wf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Mr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function fg(t,e){e=e.checked,e!=null&&Od(t,"checked",e,!1)}function vc(t,e){fg(t,e);var n=Mr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?_c(t,e.type,n):e.hasOwnProperty("defaultValue")&&_c(t,e.type,Mr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Hf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function _c(t,e,n){(e!=="number"||sl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Gs=Array.isArray;function Xi(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Mr(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function xc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return $e({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function qf(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(Gs(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Mr(n)}}function pg(t,e){var n=Mr(e.value),r=Mr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Gf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function mg(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?mg(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ta,gg=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ta=Ta||document.createElement("div"),Ta.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ta.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function mo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var eo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},V_=["Webkit","ms","Moz","O"];Object.keys(eo).forEach(function(t){V_.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),eo[e]=eo[t]})});function yg(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||eo.hasOwnProperty(t)&&eo[t]?(""+e).trim():e+"px"}function vg(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=yg(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var M_=$e({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sc(t,e){if(e){if(M_[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function Ec(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tc=null;function Ud(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ic=null,Ji=null,Zi=null;function Qf(t){if(t=Ho(t)){if(typeof Ic!="function")throw Error(W(280));var e=t.stateNode;e&&(e=Hl(e),Ic(t.stateNode,t.type,e))}}function _g(t){Ji?Zi?Zi.push(t):Zi=[t]:Ji=t}function xg(){if(Ji){var t=Ji,e=Zi;if(Zi=Ji=null,Qf(t),e)for(t=0;t<e.length;t++)Qf(e[t])}}function wg(t,e){return t(e)}function Sg(){}var Ru=!1;function Eg(t,e,n){if(Ru)return t(e,n);Ru=!0;try{return wg(t,e,n)}finally{Ru=!1,(Ji!==null||Zi!==null)&&(Sg(),xg())}}function go(t,e){var n=t.stateNode;if(n===null)return null;var r=Hl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var Cc=!1;if(Zn)try{var Os={};Object.defineProperty(Os,"passive",{get:function(){Cc=!0}}),window.addEventListener("test",Os,Os),window.removeEventListener("test",Os,Os)}catch{Cc=!1}function L_(t,e,n,r,i,s,a,l,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var to=!1,ol=null,al=!1,Ac=null,O_={onError:function(t){to=!0,ol=t}};function F_(t,e,n,r,i,s,a,l,u){to=!1,ol=null,L_.apply(O_,arguments)}function z_(t,e,n,r,i,s,a,l,u){if(F_.apply(this,arguments),to){if(to){var h=ol;to=!1,ol=null}else throw Error(W(198));al||(al=!0,Ac=h)}}function vi(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Tg(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Kf(t){if(vi(t)!==t)throw Error(W(188))}function B_(t){var e=t.alternate;if(!e){if(e=vi(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Kf(i),t;if(s===r)return Kf(i),e;s=s.sibling}throw Error(W(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function Ig(t){return t=B_(t),t!==null?Cg(t):null}function Cg(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Cg(t);if(e!==null)return e;t=t.sibling}return null}var Ag=sn.unstable_scheduleCallback,Yf=sn.unstable_cancelCallback,U_=sn.unstable_shouldYield,$_=sn.unstable_requestPaint,Je=sn.unstable_now,W_=sn.unstable_getCurrentPriorityLevel,$d=sn.unstable_ImmediatePriority,kg=sn.unstable_UserBlockingPriority,ll=sn.unstable_NormalPriority,H_=sn.unstable_LowPriority,Rg=sn.unstable_IdlePriority,Bl=null,Mn=null;function q_(t){if(Mn&&typeof Mn.onCommitFiberRoot=="function")try{Mn.onCommitFiberRoot(Bl,t,void 0,(t.current.flags&128)===128)}catch{}}var In=Math.clz32?Math.clz32:K_,G_=Math.log,Q_=Math.LN2;function K_(t){return t>>>=0,t===0?32:31-(G_(t)/Q_|0)|0}var Ia=64,Ca=4194304;function Qs(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ul(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~i;l!==0?r=Qs(l):(s&=a,s!==0&&(r=Qs(s)))}else a=n&~i,a!==0?r=Qs(a):s!==0&&(r=Qs(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-In(e),i=1<<n,r|=t[n],e&=~i;return r}function Y_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function X_(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-In(s),l=1<<a,u=i[a];u===-1?(!(l&n)||l&r)&&(i[a]=Y_(l,e)):u<=e&&(t.expiredLanes|=l),s&=~l}}function kc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Pg(){var t=Ia;return Ia<<=1,!(Ia&4194240)&&(Ia=64),t}function Pu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function $o(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-In(e),t[e]=n}function J_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-In(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Wd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-In(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Te=0;function bg(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Dg,Hd,Ng,jg,Vg,Rc=!1,Aa=[],Tr=null,Ir=null,Cr=null,yo=new Map,vo=new Map,_r=[],Z_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Xf(t,e){switch(t){case"focusin":case"focusout":Tr=null;break;case"dragenter":case"dragleave":Ir=null;break;case"mouseover":case"mouseout":Cr=null;break;case"pointerover":case"pointerout":yo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":vo.delete(e.pointerId)}}function Fs(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Ho(e),e!==null&&Hd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function ex(t,e,n,r,i){switch(e){case"focusin":return Tr=Fs(Tr,t,e,n,r,i),!0;case"dragenter":return Ir=Fs(Ir,t,e,n,r,i),!0;case"mouseover":return Cr=Fs(Cr,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return yo.set(s,Fs(yo.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,vo.set(s,Fs(vo.get(s)||null,t,e,n,r,i)),!0}return!1}function Mg(t){var e=ni(t.target);if(e!==null){var n=vi(e);if(n!==null){if(e=n.tag,e===13){if(e=Tg(n),e!==null){t.blockedOn=e,Vg(t.priority,function(){Ng(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Wa(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Pc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Tc=r,n.target.dispatchEvent(r),Tc=null}else return e=Ho(n),e!==null&&Hd(e),t.blockedOn=n,!1;e.shift()}return!0}function Jf(t,e,n){Wa(t)&&n.delete(e)}function tx(){Rc=!1,Tr!==null&&Wa(Tr)&&(Tr=null),Ir!==null&&Wa(Ir)&&(Ir=null),Cr!==null&&Wa(Cr)&&(Cr=null),yo.forEach(Jf),vo.forEach(Jf)}function zs(t,e){t.blockedOn===e&&(t.blockedOn=null,Rc||(Rc=!0,sn.unstable_scheduleCallback(sn.unstable_NormalPriority,tx)))}function _o(t){function e(i){return zs(i,t)}if(0<Aa.length){zs(Aa[0],t);for(var n=1;n<Aa.length;n++){var r=Aa[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Tr!==null&&zs(Tr,t),Ir!==null&&zs(Ir,t),Cr!==null&&zs(Cr,t),yo.forEach(e),vo.forEach(e),n=0;n<_r.length;n++)r=_r[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<_r.length&&(n=_r[0],n.blockedOn===null);)Mg(n),n.blockedOn===null&&_r.shift()}var es=ar.ReactCurrentBatchConfig,cl=!0;function nx(t,e,n,r){var i=Te,s=es.transition;es.transition=null;try{Te=1,qd(t,e,n,r)}finally{Te=i,es.transition=s}}function rx(t,e,n,r){var i=Te,s=es.transition;es.transition=null;try{Te=4,qd(t,e,n,r)}finally{Te=i,es.transition=s}}function qd(t,e,n,r){if(cl){var i=Pc(t,e,n,r);if(i===null)zu(t,e,r,dl,n),Xf(t,r);else if(ex(i,t,e,n,r))r.stopPropagation();else if(Xf(t,r),e&4&&-1<Z_.indexOf(t)){for(;i!==null;){var s=Ho(i);if(s!==null&&Dg(s),s=Pc(t,e,n,r),s===null&&zu(t,e,r,dl,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else zu(t,e,r,null,n)}}var dl=null;function Pc(t,e,n,r){if(dl=null,t=Ud(r),t=ni(t),t!==null)if(e=vi(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Tg(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return dl=t,null}function Lg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(W_()){case $d:return 1;case kg:return 4;case ll:case H_:return 16;case Rg:return 536870912;default:return 16}default:return 16}}var wr=null,Gd=null,Ha=null;function Og(){if(Ha)return Ha;var t,e=Gd,n=e.length,r,i="value"in wr?wr.value:wr.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[s-r];r++);return Ha=i.slice(t,1<r?1-r:void 0)}function qa(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ka(){return!0}function Zf(){return!1}function an(t){function e(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ka:Zf,this.isPropagationStopped=Zf,this}return $e(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ka)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ka)},persist:function(){},isPersistent:ka}),e}var _s={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qd=an(_s),Wo=$e({},_s,{view:0,detail:0}),ix=an(Wo),bu,Du,Bs,Ul=$e({},Wo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bs&&(Bs&&t.type==="mousemove"?(bu=t.screenX-Bs.screenX,Du=t.screenY-Bs.screenY):Du=bu=0,Bs=t),bu)},movementY:function(t){return"movementY"in t?t.movementY:Du}}),ep=an(Ul),sx=$e({},Ul,{dataTransfer:0}),ox=an(sx),ax=$e({},Wo,{relatedTarget:0}),Nu=an(ax),lx=$e({},_s,{animationName:0,elapsedTime:0,pseudoElement:0}),ux=an(lx),cx=$e({},_s,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),dx=an(cx),hx=$e({},_s,{data:0}),tp=an(hx),fx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},px={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gx(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=mx[t])?!!e[t]:!1}function Kd(){return gx}var yx=$e({},Wo,{key:function(t){if(t.key){var e=fx[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=qa(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?px[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kd,charCode:function(t){return t.type==="keypress"?qa(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?qa(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),vx=an(yx),_x=$e({},Ul,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),np=an(_x),xx=$e({},Wo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kd}),wx=an(xx),Sx=$e({},_s,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ex=an(Sx),Tx=$e({},Ul,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ix=an(Tx),Cx=[9,13,27,32],Yd=Zn&&"CompositionEvent"in window,no=null;Zn&&"documentMode"in document&&(no=document.documentMode);var Ax=Zn&&"TextEvent"in window&&!no,Fg=Zn&&(!Yd||no&&8<no&&11>=no),rp=" ",ip=!1;function zg(t,e){switch(t){case"keyup":return Cx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bg(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Bi=!1;function kx(t,e){switch(t){case"compositionend":return Bg(e);case"keypress":return e.which!==32?null:(ip=!0,rp);case"textInput":return t=e.data,t===rp&&ip?null:t;default:return null}}function Rx(t,e){if(Bi)return t==="compositionend"||!Yd&&zg(t,e)?(t=Og(),Ha=Gd=wr=null,Bi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Fg&&e.locale!=="ko"?null:e.data;default:return null}}var Px={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Px[t.type]:e==="textarea"}function Ug(t,e,n,r){_g(r),e=hl(e,"onChange"),0<e.length&&(n=new Qd("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ro=null,xo=null;function bx(t){Zg(t,0)}function $l(t){var e=Wi(t);if(hg(e))return t}function Dx(t,e){if(t==="change")return e}var $g=!1;if(Zn){var ju;if(Zn){var Vu="oninput"in document;if(!Vu){var op=document.createElement("div");op.setAttribute("oninput","return;"),Vu=typeof op.oninput=="function"}ju=Vu}else ju=!1;$g=ju&&(!document.documentMode||9<document.documentMode)}function ap(){ro&&(ro.detachEvent("onpropertychange",Wg),xo=ro=null)}function Wg(t){if(t.propertyName==="value"&&$l(xo)){var e=[];Ug(e,xo,t,Ud(t)),Eg(bx,e)}}function Nx(t,e,n){t==="focusin"?(ap(),ro=e,xo=n,ro.attachEvent("onpropertychange",Wg)):t==="focusout"&&ap()}function jx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return $l(xo)}function Vx(t,e){if(t==="click")return $l(e)}function Mx(t,e){if(t==="input"||t==="change")return $l(e)}function Lx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var kn=typeof Object.is=="function"?Object.is:Lx;function wo(t,e){if(kn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!hc.call(e,i)||!kn(t[i],e[i]))return!1}return!0}function lp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function up(t,e){var n=lp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=lp(n)}}function Hg(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Hg(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function qg(){for(var t=window,e=sl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=sl(t.document)}return e}function Xd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Ox(t){var e=qg(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Hg(n.ownerDocument.documentElement,n)){if(r!==null&&Xd(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=up(n,s);var a=up(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Fx=Zn&&"documentMode"in document&&11>=document.documentMode,Ui=null,bc=null,io=null,Dc=!1;function cp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Dc||Ui==null||Ui!==sl(r)||(r=Ui,"selectionStart"in r&&Xd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),io&&wo(io,r)||(io=r,r=hl(bc,"onSelect"),0<r.length&&(e=new Qd("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ui)))}function Ra(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var $i={animationend:Ra("Animation","AnimationEnd"),animationiteration:Ra("Animation","AnimationIteration"),animationstart:Ra("Animation","AnimationStart"),transitionend:Ra("Transition","TransitionEnd")},Mu={},Gg={};Zn&&(Gg=document.createElement("div").style,"AnimationEvent"in window||(delete $i.animationend.animation,delete $i.animationiteration.animation,delete $i.animationstart.animation),"TransitionEvent"in window||delete $i.transitionend.transition);function Wl(t){if(Mu[t])return Mu[t];if(!$i[t])return t;var e=$i[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Gg)return Mu[t]=e[n];return t}var Qg=Wl("animationend"),Kg=Wl("animationiteration"),Yg=Wl("animationstart"),Xg=Wl("transitionend"),Jg=new Map,dp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Br(t,e){Jg.set(t,e),yi(e,[t])}for(var Lu=0;Lu<dp.length;Lu++){var Ou=dp[Lu],zx=Ou.toLowerCase(),Bx=Ou[0].toUpperCase()+Ou.slice(1);Br(zx,"on"+Bx)}Br(Qg,"onAnimationEnd");Br(Kg,"onAnimationIteration");Br(Yg,"onAnimationStart");Br("dblclick","onDoubleClick");Br("focusin","onFocus");Br("focusout","onBlur");Br(Xg,"onTransitionEnd");is("onMouseEnter",["mouseout","mouseover"]);is("onMouseLeave",["mouseout","mouseover"]);is("onPointerEnter",["pointerout","pointerover"]);is("onPointerLeave",["pointerout","pointerover"]);yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yi("onBeforeInput",["compositionend","keypress","textInput","paste"]);yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ks="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ux=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ks));function hp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,z_(r,e,void 0,t),t.currentTarget=null}function Zg(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],u=l.instance,h=l.currentTarget;if(l=l.listener,u!==s&&i.isPropagationStopped())break e;hp(i,l,h),s=u}else for(a=0;a<r.length;a++){if(l=r[a],u=l.instance,h=l.currentTarget,l=l.listener,u!==s&&i.isPropagationStopped())break e;hp(i,l,h),s=u}}}if(al)throw t=Ac,al=!1,Ac=null,t}function Ne(t,e){var n=e[Lc];n===void 0&&(n=e[Lc]=new Set);var r=t+"__bubble";n.has(r)||(ey(e,t,2,!1),n.add(r))}function Fu(t,e,n){var r=0;e&&(r|=4),ey(n,t,r,e)}var Pa="_reactListening"+Math.random().toString(36).slice(2);function So(t){if(!t[Pa]){t[Pa]=!0,ag.forEach(function(n){n!=="selectionchange"&&(Ux.has(n)||Fu(n,!1,t),Fu(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Pa]||(e[Pa]=!0,Fu("selectionchange",!1,e))}}function ey(t,e,n,r){switch(Lg(e)){case 1:var i=nx;break;case 4:i=rx;break;default:i=qd}n=i.bind(null,e,n,t),i=void 0,!Cc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function zu(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;a=a.return}for(;l!==null;){if(a=ni(l),a===null)return;if(u=a.tag,u===5||u===6){r=s=a;continue e}l=l.parentNode}}r=r.return}Eg(function(){var h=s,p=Ud(n),g=[];e:{var y=Jg.get(t);if(y!==void 0){var E=Qd,C=t;switch(t){case"keypress":if(qa(n)===0)break e;case"keydown":case"keyup":E=vx;break;case"focusin":C="focus",E=Nu;break;case"focusout":C="blur",E=Nu;break;case"beforeblur":case"afterblur":E=Nu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=ep;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=ox;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=wx;break;case Qg:case Kg:case Yg:E=ux;break;case Xg:E=Ex;break;case"scroll":E=ix;break;case"wheel":E=Ix;break;case"copy":case"cut":case"paste":E=dx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=np}var P=(e&4)!==0,M=!P&&t==="scroll",T=P?y!==null?y+"Capture":null:y;P=[];for(var w=h,k;w!==null;){k=w;var V=k.stateNode;if(k.tag===5&&V!==null&&(k=V,T!==null&&(V=go(w,T),V!=null&&P.push(Eo(w,V,k)))),M)break;w=w.return}0<P.length&&(y=new E(y,C,null,n,p),g.push({event:y,listeners:P}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",y&&n!==Tc&&(C=n.relatedTarget||n.fromElement)&&(ni(C)||C[er]))break e;if((E||y)&&(y=p.window===p?p:(y=p.ownerDocument)?y.defaultView||y.parentWindow:window,E?(C=n.relatedTarget||n.toElement,E=h,C=C?ni(C):null,C!==null&&(M=vi(C),C!==M||C.tag!==5&&C.tag!==6)&&(C=null)):(E=null,C=h),E!==C)){if(P=ep,V="onMouseLeave",T="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(P=np,V="onPointerLeave",T="onPointerEnter",w="pointer"),M=E==null?y:Wi(E),k=C==null?y:Wi(C),y=new P(V,w+"leave",E,n,p),y.target=M,y.relatedTarget=k,V=null,ni(p)===h&&(P=new P(T,w+"enter",C,n,p),P.target=k,P.relatedTarget=M,V=P),M=V,E&&C)t:{for(P=E,T=C,w=0,k=P;k;k=Vi(k))w++;for(k=0,V=T;V;V=Vi(V))k++;for(;0<w-k;)P=Vi(P),w--;for(;0<k-w;)T=Vi(T),k--;for(;w--;){if(P===T||T!==null&&P===T.alternate)break t;P=Vi(P),T=Vi(T)}P=null}else P=null;E!==null&&fp(g,y,E,P,!1),C!==null&&M!==null&&fp(g,M,C,P,!0)}}e:{if(y=h?Wi(h):window,E=y.nodeName&&y.nodeName.toLowerCase(),E==="select"||E==="input"&&y.type==="file")var F=Dx;else if(sp(y))if($g)F=Mx;else{F=jx;var L=Nx}else(E=y.nodeName)&&E.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(F=Vx);if(F&&(F=F(t,h))){Ug(g,F,n,p);break e}L&&L(t,y,h),t==="focusout"&&(L=y._wrapperState)&&L.controlled&&y.type==="number"&&_c(y,"number",y.value)}switch(L=h?Wi(h):window,t){case"focusin":(sp(L)||L.contentEditable==="true")&&(Ui=L,bc=h,io=null);break;case"focusout":io=bc=Ui=null;break;case"mousedown":Dc=!0;break;case"contextmenu":case"mouseup":case"dragend":Dc=!1,cp(g,n,p);break;case"selectionchange":if(Fx)break;case"keydown":case"keyup":cp(g,n,p)}var v;if(Yd)e:{switch(t){case"compositionstart":var m="onCompositionStart";break e;case"compositionend":m="onCompositionEnd";break e;case"compositionupdate":m="onCompositionUpdate";break e}m=void 0}else Bi?zg(t,n)&&(m="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(m="onCompositionStart");m&&(Fg&&n.locale!=="ko"&&(Bi||m!=="onCompositionStart"?m==="onCompositionEnd"&&Bi&&(v=Og()):(wr=p,Gd="value"in wr?wr.value:wr.textContent,Bi=!0)),L=hl(h,m),0<L.length&&(m=new tp(m,t,null,n,p),g.push({event:m,listeners:L}),v?m.data=v:(v=Bg(n),v!==null&&(m.data=v)))),(v=Ax?kx(t,n):Rx(t,n))&&(h=hl(h,"onBeforeInput"),0<h.length&&(p=new tp("onBeforeInput","beforeinput",null,n,p),g.push({event:p,listeners:h}),p.data=v))}Zg(g,e)})}function Eo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function hl(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=go(t,n),s!=null&&r.unshift(Eo(t,s,i)),s=go(t,e),s!=null&&r.push(Eo(t,s,i))),t=t.return}return r}function Vi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function fp(t,e,n,r,i){for(var s=e._reactName,a=[];n!==null&&n!==r;){var l=n,u=l.alternate,h=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&h!==null&&(l=h,i?(u=go(n,s),u!=null&&a.unshift(Eo(n,u,l))):i||(u=go(n,s),u!=null&&a.push(Eo(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var $x=/\r\n?/g,Wx=/\u0000|\uFFFD/g;function pp(t){return(typeof t=="string"?t:""+t).replace($x,`
`).replace(Wx,"")}function ba(t,e,n){if(e=pp(e),pp(t)!==e&&n)throw Error(W(425))}function fl(){}var Nc=null,jc=null;function Vc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Mc=typeof setTimeout=="function"?setTimeout:void 0,Hx=typeof clearTimeout=="function"?clearTimeout:void 0,mp=typeof Promise=="function"?Promise:void 0,qx=typeof queueMicrotask=="function"?queueMicrotask:typeof mp<"u"?function(t){return mp.resolve(null).then(t).catch(Gx)}:Mc;function Gx(t){setTimeout(function(){throw t})}function Bu(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),_o(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);_o(e)}function Ar(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function gp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var xs=Math.random().toString(36).slice(2),Vn="__reactFiber$"+xs,To="__reactProps$"+xs,er="__reactContainer$"+xs,Lc="__reactEvents$"+xs,Qx="__reactListeners$"+xs,Kx="__reactHandles$"+xs;function ni(t){var e=t[Vn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[er]||n[Vn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=gp(t);t!==null;){if(n=t[Vn])return n;t=gp(t)}return e}t=n,n=t.parentNode}return null}function Ho(t){return t=t[Vn]||t[er],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Wi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function Hl(t){return t[To]||null}var Oc=[],Hi=-1;function Ur(t){return{current:t}}function Ve(t){0>Hi||(t.current=Oc[Hi],Oc[Hi]=null,Hi--)}function be(t,e){Hi++,Oc[Hi]=t.current,t.current=e}var Lr={},bt=Ur(Lr),$t=Ur(!1),ui=Lr;function ss(t,e){var n=t.type.contextTypes;if(!n)return Lr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Wt(t){return t=t.childContextTypes,t!=null}function pl(){Ve($t),Ve(bt)}function yp(t,e,n){if(bt.current!==Lr)throw Error(W(168));be(bt,e),be($t,n)}function ty(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(W(108,N_(t)||"Unknown",i));return $e({},n,r)}function ml(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Lr,ui=bt.current,be(bt,t),be($t,$t.current),!0}function vp(t,e,n){var r=t.stateNode;if(!r)throw Error(W(169));n?(t=ty(t,e,ui),r.__reactInternalMemoizedMergedChildContext=t,Ve($t),Ve(bt),be(bt,t)):Ve($t),be($t,n)}var qn=null,ql=!1,Uu=!1;function ny(t){qn===null?qn=[t]:qn.push(t)}function Yx(t){ql=!0,ny(t)}function $r(){if(!Uu&&qn!==null){Uu=!0;var t=0,e=Te;try{var n=qn;for(Te=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}qn=null,ql=!1}catch(i){throw qn!==null&&(qn=qn.slice(t+1)),Ag($d,$r),i}finally{Te=e,Uu=!1}}return null}var qi=[],Gi=0,gl=null,yl=0,dn=[],hn=0,ci=null,Qn=1,Kn="";function Zr(t,e){qi[Gi++]=yl,qi[Gi++]=gl,gl=t,yl=e}function ry(t,e,n){dn[hn++]=Qn,dn[hn++]=Kn,dn[hn++]=ci,ci=t;var r=Qn;t=Kn;var i=32-In(r)-1;r&=~(1<<i),n+=1;var s=32-In(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Qn=1<<32-In(e)+i|n<<i|r,Kn=s+t}else Qn=1<<s|n<<i|r,Kn=t}function Jd(t){t.return!==null&&(Zr(t,1),ry(t,1,0))}function Zd(t){for(;t===gl;)gl=qi[--Gi],qi[Gi]=null,yl=qi[--Gi],qi[Gi]=null;for(;t===ci;)ci=dn[--hn],dn[hn]=null,Kn=dn[--hn],dn[hn]=null,Qn=dn[--hn],dn[hn]=null}var rn=null,tn=null,Oe=!1,En=null;function iy(t,e){var n=fn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function _p(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,rn=t,tn=Ar(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,rn=t,tn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ci!==null?{id:Qn,overflow:Kn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=fn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,rn=t,tn=null,!0):!1;default:return!1}}function Fc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function zc(t){if(Oe){var e=tn;if(e){var n=e;if(!_p(t,e)){if(Fc(t))throw Error(W(418));e=Ar(n.nextSibling);var r=rn;e&&_p(t,e)?iy(r,n):(t.flags=t.flags&-4097|2,Oe=!1,rn=t)}}else{if(Fc(t))throw Error(W(418));t.flags=t.flags&-4097|2,Oe=!1,rn=t}}}function xp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;rn=t}function Da(t){if(t!==rn)return!1;if(!Oe)return xp(t),Oe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Vc(t.type,t.memoizedProps)),e&&(e=tn)){if(Fc(t))throw sy(),Error(W(418));for(;e;)iy(t,e),e=Ar(e.nextSibling)}if(xp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){tn=Ar(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}tn=null}}else tn=rn?Ar(t.stateNode.nextSibling):null;return!0}function sy(){for(var t=tn;t;)t=Ar(t.nextSibling)}function os(){tn=rn=null,Oe=!1}function eh(t){En===null?En=[t]:En.push(t)}var Xx=ar.ReactCurrentBatchConfig;function Us(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var l=i.refs;a===null?delete l[s]:l[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function Na(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function wp(t){var e=t._init;return e(t._payload)}function oy(t){function e(T,w){if(t){var k=T.deletions;k===null?(T.deletions=[w],T.flags|=16):k.push(w)}}function n(T,w){if(!t)return null;for(;w!==null;)e(T,w),w=w.sibling;return null}function r(T,w){for(T=new Map;w!==null;)w.key!==null?T.set(w.key,w):T.set(w.index,w),w=w.sibling;return T}function i(T,w){return T=br(T,w),T.index=0,T.sibling=null,T}function s(T,w,k){return T.index=k,t?(k=T.alternate,k!==null?(k=k.index,k<w?(T.flags|=2,w):k):(T.flags|=2,w)):(T.flags|=1048576,w)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function l(T,w,k,V){return w===null||w.tag!==6?(w=Ku(k,T.mode,V),w.return=T,w):(w=i(w,k),w.return=T,w)}function u(T,w,k,V){var F=k.type;return F===zi?p(T,w,k.props.children,V,k.key):w!==null&&(w.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===yr&&wp(F)===w.type)?(V=i(w,k.props),V.ref=Us(T,w,k),V.return=T,V):(V=Za(k.type,k.key,k.props,null,T.mode,V),V.ref=Us(T,w,k),V.return=T,V)}function h(T,w,k,V){return w===null||w.tag!==4||w.stateNode.containerInfo!==k.containerInfo||w.stateNode.implementation!==k.implementation?(w=Yu(k,T.mode,V),w.return=T,w):(w=i(w,k.children||[]),w.return=T,w)}function p(T,w,k,V,F){return w===null||w.tag!==7?(w=ai(k,T.mode,V,F),w.return=T,w):(w=i(w,k),w.return=T,w)}function g(T,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Ku(""+w,T.mode,k),w.return=T,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Sa:return k=Za(w.type,w.key,w.props,null,T.mode,k),k.ref=Us(T,null,w),k.return=T,k;case Fi:return w=Yu(w,T.mode,k),w.return=T,w;case yr:var V=w._init;return g(T,V(w._payload),k)}if(Gs(w)||Ls(w))return w=ai(w,T.mode,k,null),w.return=T,w;Na(T,w)}return null}function y(T,w,k,V){var F=w!==null?w.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return F!==null?null:l(T,w,""+k,V);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Sa:return k.key===F?u(T,w,k,V):null;case Fi:return k.key===F?h(T,w,k,V):null;case yr:return F=k._init,y(T,w,F(k._payload),V)}if(Gs(k)||Ls(k))return F!==null?null:p(T,w,k,V,null);Na(T,k)}return null}function E(T,w,k,V,F){if(typeof V=="string"&&V!==""||typeof V=="number")return T=T.get(k)||null,l(w,T,""+V,F);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Sa:return T=T.get(V.key===null?k:V.key)||null,u(w,T,V,F);case Fi:return T=T.get(V.key===null?k:V.key)||null,h(w,T,V,F);case yr:var L=V._init;return E(T,w,k,L(V._payload),F)}if(Gs(V)||Ls(V))return T=T.get(k)||null,p(w,T,V,F,null);Na(w,V)}return null}function C(T,w,k,V){for(var F=null,L=null,v=w,m=w=0,x=null;v!==null&&m<k.length;m++){v.index>m?(x=v,v=null):x=v.sibling;var S=y(T,v,k[m],V);if(S===null){v===null&&(v=x);break}t&&v&&S.alternate===null&&e(T,v),w=s(S,w,m),L===null?F=S:L.sibling=S,L=S,v=x}if(m===k.length)return n(T,v),Oe&&Zr(T,m),F;if(v===null){for(;m<k.length;m++)v=g(T,k[m],V),v!==null&&(w=s(v,w,m),L===null?F=v:L.sibling=v,L=v);return Oe&&Zr(T,m),F}for(v=r(T,v);m<k.length;m++)x=E(v,T,m,k[m],V),x!==null&&(t&&x.alternate!==null&&v.delete(x.key===null?m:x.key),w=s(x,w,m),L===null?F=x:L.sibling=x,L=x);return t&&v.forEach(function(A){return e(T,A)}),Oe&&Zr(T,m),F}function P(T,w,k,V){var F=Ls(k);if(typeof F!="function")throw Error(W(150));if(k=F.call(k),k==null)throw Error(W(151));for(var L=F=null,v=w,m=w=0,x=null,S=k.next();v!==null&&!S.done;m++,S=k.next()){v.index>m?(x=v,v=null):x=v.sibling;var A=y(T,v,S.value,V);if(A===null){v===null&&(v=x);break}t&&v&&A.alternate===null&&e(T,v),w=s(A,w,m),L===null?F=A:L.sibling=A,L=A,v=x}if(S.done)return n(T,v),Oe&&Zr(T,m),F;if(v===null){for(;!S.done;m++,S=k.next())S=g(T,S.value,V),S!==null&&(w=s(S,w,m),L===null?F=S:L.sibling=S,L=S);return Oe&&Zr(T,m),F}for(v=r(T,v);!S.done;m++,S=k.next())S=E(v,T,m,S.value,V),S!==null&&(t&&S.alternate!==null&&v.delete(S.key===null?m:S.key),w=s(S,w,m),L===null?F=S:L.sibling=S,L=S);return t&&v.forEach(function(R){return e(T,R)}),Oe&&Zr(T,m),F}function M(T,w,k,V){if(typeof k=="object"&&k!==null&&k.type===zi&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case Sa:e:{for(var F=k.key,L=w;L!==null;){if(L.key===F){if(F=k.type,F===zi){if(L.tag===7){n(T,L.sibling),w=i(L,k.props.children),w.return=T,T=w;break e}}else if(L.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===yr&&wp(F)===L.type){n(T,L.sibling),w=i(L,k.props),w.ref=Us(T,L,k),w.return=T,T=w;break e}n(T,L);break}else e(T,L);L=L.sibling}k.type===zi?(w=ai(k.props.children,T.mode,V,k.key),w.return=T,T=w):(V=Za(k.type,k.key,k.props,null,T.mode,V),V.ref=Us(T,w,k),V.return=T,T=V)}return a(T);case Fi:e:{for(L=k.key;w!==null;){if(w.key===L)if(w.tag===4&&w.stateNode.containerInfo===k.containerInfo&&w.stateNode.implementation===k.implementation){n(T,w.sibling),w=i(w,k.children||[]),w.return=T,T=w;break e}else{n(T,w);break}else e(T,w);w=w.sibling}w=Yu(k,T.mode,V),w.return=T,T=w}return a(T);case yr:return L=k._init,M(T,w,L(k._payload),V)}if(Gs(k))return C(T,w,k,V);if(Ls(k))return P(T,w,k,V);Na(T,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,w!==null&&w.tag===6?(n(T,w.sibling),w=i(w,k),w.return=T,T=w):(n(T,w),w=Ku(k,T.mode,V),w.return=T,T=w),a(T)):n(T,w)}return M}var as=oy(!0),ay=oy(!1),vl=Ur(null),_l=null,Qi=null,th=null;function nh(){th=Qi=_l=null}function rh(t){var e=vl.current;Ve(vl),t._currentValue=e}function Bc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ts(t,e){_l=t,th=Qi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ut=!0),t.firstContext=null)}function mn(t){var e=t._currentValue;if(th!==t)if(t={context:t,memoizedValue:e,next:null},Qi===null){if(_l===null)throw Error(W(308));Qi=t,_l.dependencies={lanes:0,firstContext:t}}else Qi=Qi.next=t;return e}var ri=null;function ih(t){ri===null?ri=[t]:ri.push(t)}function ly(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,ih(e)):(n.next=i.next,i.next=n),e.interleaved=n,tr(t,r)}function tr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var vr=!1;function sh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uy(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Yn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function kr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,tr(t,n)}return i=r.interleaved,i===null?(e.next=e,ih(r)):(e.next=i.next,i.next=e),r.interleaved=e,tr(t,n)}function Ga(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Wd(t,n)}}function Sp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function xl(t,e,n,r){var i=t.updateQueue;vr=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,h=u.next;u.next=null,a===null?s=h:a.next=h,a=u;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==a&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=u))}if(s!==null){var g=i.baseState;a=0,p=h=u=null,l=s;do{var y=l.lane,E=l.eventTime;if((r&y)===y){p!==null&&(p=p.next={eventTime:E,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var C=t,P=l;switch(y=e,E=n,P.tag){case 1:if(C=P.payload,typeof C=="function"){g=C.call(E,g,y);break e}g=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=P.payload,y=typeof C=="function"?C.call(E,g,y):C,y==null)break e;g=$e({},g,y);break e;case 2:vr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=i.effects,y===null?i.effects=[l]:y.push(l))}else E={eventTime:E,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=E,u=g):p=p.next=E,a|=y;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;y=l,l=y.next,y.next=null,i.lastBaseUpdate=y,i.shared.pending=null}}while(!0);if(p===null&&(u=g),i.baseState=u,i.firstBaseUpdate=h,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);hi|=a,t.lanes=a,t.memoizedState=g}}function Ep(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(W(191,i));i.call(r)}}}var qo={},Ln=Ur(qo),Io=Ur(qo),Co=Ur(qo);function ii(t){if(t===qo)throw Error(W(174));return t}function oh(t,e){switch(be(Co,e),be(Io,t),be(Ln,qo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:wc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=wc(e,t)}Ve(Ln),be(Ln,e)}function ls(){Ve(Ln),Ve(Io),Ve(Co)}function cy(t){ii(Co.current);var e=ii(Ln.current),n=wc(e,t.type);e!==n&&(be(Io,t),be(Ln,n))}function ah(t){Io.current===t&&(Ve(Ln),Ve(Io))}var Be=Ur(0);function wl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var $u=[];function lh(){for(var t=0;t<$u.length;t++)$u[t]._workInProgressVersionPrimary=null;$u.length=0}var Qa=ar.ReactCurrentDispatcher,Wu=ar.ReactCurrentBatchConfig,di=0,Ue=null,st=null,ct=null,Sl=!1,so=!1,Ao=0,Jx=0;function It(){throw Error(W(321))}function uh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!kn(t[n],e[n]))return!1;return!0}function ch(t,e,n,r,i,s){if(di=s,Ue=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Qa.current=t===null||t.memoizedState===null?n1:r1,t=n(r,i),so){s=0;do{if(so=!1,Ao=0,25<=s)throw Error(W(301));s+=1,ct=st=null,e.updateQueue=null,Qa.current=i1,t=n(r,i)}while(so)}if(Qa.current=El,e=st!==null&&st.next!==null,di=0,ct=st=Ue=null,Sl=!1,e)throw Error(W(300));return t}function dh(){var t=Ao!==0;return Ao=0,t}function jn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ct===null?Ue.memoizedState=ct=t:ct=ct.next=t,ct}function gn(){if(st===null){var t=Ue.alternate;t=t!==null?t.memoizedState:null}else t=st.next;var e=ct===null?Ue.memoizedState:ct.next;if(e!==null)ct=e,st=t;else{if(t===null)throw Error(W(310));st=t,t={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},ct===null?Ue.memoizedState=ct=t:ct=ct.next=t}return ct}function ko(t,e){return typeof e=="function"?e(t):e}function Hu(t){var e=gn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=st,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=a=null,u=null,h=s;do{var p=h.lane;if((di&p)===p)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var g={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(l=u=g,a=r):u=u.next=g,Ue.lanes|=p,hi|=p}h=h.next}while(h!==null&&h!==s);u===null?a=r:u.next=l,kn(r,e.memoizedState)||(Ut=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Ue.lanes|=s,hi|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function qu(t){var e=gn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);kn(s,e.memoizedState)||(Ut=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function dy(){}function hy(t,e){var n=Ue,r=gn(),i=e(),s=!kn(r.memoizedState,i);if(s&&(r.memoizedState=i,Ut=!0),r=r.queue,hh(my.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||ct!==null&&ct.memoizedState.tag&1){if(n.flags|=2048,Ro(9,py.bind(null,n,r,i,e),void 0,null),dt===null)throw Error(W(349));di&30||fy(n,e,i)}return i}function fy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function py(t,e,n,r){e.value=n,e.getSnapshot=r,gy(e)&&yy(t)}function my(t,e,n){return n(function(){gy(e)&&yy(t)})}function gy(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!kn(t,n)}catch{return!0}}function yy(t){var e=tr(t,1);e!==null&&Cn(e,t,1,-1)}function Tp(t){var e=jn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ko,lastRenderedState:t},e.queue=t,t=t.dispatch=t1.bind(null,Ue,t),[e.memoizedState,t]}function Ro(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function vy(){return gn().memoizedState}function Ka(t,e,n,r){var i=jn();Ue.flags|=t,i.memoizedState=Ro(1|e,n,void 0,r===void 0?null:r)}function Gl(t,e,n,r){var i=gn();r=r===void 0?null:r;var s=void 0;if(st!==null){var a=st.memoizedState;if(s=a.destroy,r!==null&&uh(r,a.deps)){i.memoizedState=Ro(e,n,s,r);return}}Ue.flags|=t,i.memoizedState=Ro(1|e,n,s,r)}function Ip(t,e){return Ka(8390656,8,t,e)}function hh(t,e){return Gl(2048,8,t,e)}function _y(t,e){return Gl(4,2,t,e)}function xy(t,e){return Gl(4,4,t,e)}function wy(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Sy(t,e,n){return n=n!=null?n.concat([t]):null,Gl(4,4,wy.bind(null,e,t),n)}function fh(){}function Ey(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&uh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ty(t,e){var n=gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&uh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Iy(t,e,n){return di&21?(kn(n,e)||(n=Pg(),Ue.lanes|=n,hi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ut=!0),t.memoizedState=n)}function Zx(t,e){var n=Te;Te=n!==0&&4>n?n:4,t(!0);var r=Wu.transition;Wu.transition={};try{t(!1),e()}finally{Te=n,Wu.transition=r}}function Cy(){return gn().memoizedState}function e1(t,e,n){var r=Pr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ay(t))ky(e,n);else if(n=ly(t,e,n,r),n!==null){var i=jt();Cn(n,t,r,i),Ry(n,e,r)}}function t1(t,e,n){var r=Pr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ay(t))ky(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,l=s(a,n);if(i.hasEagerState=!0,i.eagerState=l,kn(l,a)){var u=e.interleaved;u===null?(i.next=i,ih(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=ly(t,e,i,r),n!==null&&(i=jt(),Cn(n,t,r,i),Ry(n,e,r))}}function Ay(t){var e=t.alternate;return t===Ue||e!==null&&e===Ue}function ky(t,e){so=Sl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ry(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Wd(t,n)}}var El={readContext:mn,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useInsertionEffect:It,useLayoutEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useMutableSource:It,useSyncExternalStore:It,useId:It,unstable_isNewReconciler:!1},n1={readContext:mn,useCallback:function(t,e){return jn().memoizedState=[t,e===void 0?null:e],t},useContext:mn,useEffect:Ip,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ka(4194308,4,wy.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ka(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ka(4,2,t,e)},useMemo:function(t,e){var n=jn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=jn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=e1.bind(null,Ue,t),[r.memoizedState,t]},useRef:function(t){var e=jn();return t={current:t},e.memoizedState=t},useState:Tp,useDebugValue:fh,useDeferredValue:function(t){return jn().memoizedState=t},useTransition:function(){var t=Tp(!1),e=t[0];return t=Zx.bind(null,t[1]),jn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ue,i=jn();if(Oe){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),dt===null)throw Error(W(349));di&30||fy(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Ip(my.bind(null,r,s,t),[t]),r.flags|=2048,Ro(9,py.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=jn(),e=dt.identifierPrefix;if(Oe){var n=Kn,r=Qn;n=(r&~(1<<32-In(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ao++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Jx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},r1={readContext:mn,useCallback:Ey,useContext:mn,useEffect:hh,useImperativeHandle:Sy,useInsertionEffect:_y,useLayoutEffect:xy,useMemo:Ty,useReducer:Hu,useRef:vy,useState:function(){return Hu(ko)},useDebugValue:fh,useDeferredValue:function(t){var e=gn();return Iy(e,st.memoizedState,t)},useTransition:function(){var t=Hu(ko)[0],e=gn().memoizedState;return[t,e]},useMutableSource:dy,useSyncExternalStore:hy,useId:Cy,unstable_isNewReconciler:!1},i1={readContext:mn,useCallback:Ey,useContext:mn,useEffect:hh,useImperativeHandle:Sy,useInsertionEffect:_y,useLayoutEffect:xy,useMemo:Ty,useReducer:qu,useRef:vy,useState:function(){return qu(ko)},useDebugValue:fh,useDeferredValue:function(t){var e=gn();return st===null?e.memoizedState=t:Iy(e,st.memoizedState,t)},useTransition:function(){var t=qu(ko)[0],e=gn().memoizedState;return[t,e]},useMutableSource:dy,useSyncExternalStore:hy,useId:Cy,unstable_isNewReconciler:!1};function wn(t,e){if(t&&t.defaultProps){e=$e({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Uc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:$e({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ql={isMounted:function(t){return(t=t._reactInternals)?vi(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=jt(),i=Pr(t),s=Yn(r,i);s.payload=e,n!=null&&(s.callback=n),e=kr(t,s,i),e!==null&&(Cn(e,t,i,r),Ga(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=jt(),i=Pr(t),s=Yn(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=kr(t,s,i),e!==null&&(Cn(e,t,i,r),Ga(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=jt(),r=Pr(t),i=Yn(n,r);i.tag=2,e!=null&&(i.callback=e),e=kr(t,i,r),e!==null&&(Cn(e,t,r,n),Ga(e,t,r))}};function Cp(t,e,n,r,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!wo(n,r)||!wo(i,s):!0}function Py(t,e,n){var r=!1,i=Lr,s=e.contextType;return typeof s=="object"&&s!==null?s=mn(s):(i=Wt(e)?ui:bt.current,r=e.contextTypes,s=(r=r!=null)?ss(t,i):Lr),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ql,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Ap(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ql.enqueueReplaceState(e,e.state,null)}function $c(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},sh(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=mn(s):(s=Wt(e)?ui:bt.current,i.context=ss(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Uc(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Ql.enqueueReplaceState(i,i.state,null),xl(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function us(t,e){try{var n="",r=e;do n+=D_(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Gu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Wc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var s1=typeof WeakMap=="function"?WeakMap:Map;function by(t,e,n){n=Yn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Il||(Il=!0,ed=r),Wc(t,e)},n}function Dy(t,e,n){n=Yn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Wc(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Wc(t,e),typeof r!="function"&&(Rr===null?Rr=new Set([this]):Rr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function kp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new s1;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=_1.bind(null,t,e,n),e.then(t,t))}function Rp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Pp(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Yn(-1,1),e.tag=2,kr(n,e,1))),n.lanes|=1),t)}var o1=ar.ReactCurrentOwner,Ut=!1;function Nt(t,e,n,r){e.child=t===null?ay(e,null,n,r):as(e,t.child,n,r)}function bp(t,e,n,r,i){n=n.render;var s=e.ref;return ts(e,i),r=ch(t,e,n,r,s,i),n=dh(),t!==null&&!Ut?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,nr(t,e,i)):(Oe&&n&&Jd(e),e.flags|=1,Nt(t,e,r,i),e.child)}function Dp(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!wh(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Ny(t,e,s,r,i)):(t=Za(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:wo,n(a,r)&&t.ref===e.ref)return nr(t,e,i)}return e.flags|=1,t=br(s,r),t.ref=e.ref,t.return=e,e.child=t}function Ny(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(wo(s,r)&&t.ref===e.ref)if(Ut=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Ut=!0);else return e.lanes=t.lanes,nr(t,e,i)}return Hc(t,e,n,r,i)}function jy(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},be(Yi,en),en|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,be(Yi,en),en|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,be(Yi,en),en|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,be(Yi,en),en|=r;return Nt(t,e,i,n),e.child}function Vy(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Hc(t,e,n,r,i){var s=Wt(n)?ui:bt.current;return s=ss(e,s),ts(e,i),n=ch(t,e,n,r,s,i),r=dh(),t!==null&&!Ut?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,nr(t,e,i)):(Oe&&r&&Jd(e),e.flags|=1,Nt(t,e,n,i),e.child)}function Np(t,e,n,r,i){if(Wt(n)){var s=!0;ml(e)}else s=!1;if(ts(e,i),e.stateNode===null)Ya(t,e),Py(e,n,r),$c(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=mn(h):(h=Wt(n)?ui:bt.current,h=ss(e,h));var p=n.getDerivedStateFromProps,g=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";g||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||u!==h)&&Ap(e,a,r,h),vr=!1;var y=e.memoizedState;a.state=y,xl(e,r,a,i),u=e.memoizedState,l!==r||y!==u||$t.current||vr?(typeof p=="function"&&(Uc(e,n,p,r),u=e.memoizedState),(l=vr||Cp(e,n,l,r,y,u,h))?(g||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,uy(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:wn(e.type,l),a.props=h,g=e.pendingProps,y=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=mn(u):(u=Wt(n)?ui:bt.current,u=ss(e,u));var E=n.getDerivedStateFromProps;(p=typeof E=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==g||y!==u)&&Ap(e,a,r,u),vr=!1,y=e.memoizedState,a.state=y,xl(e,r,a,i);var C=e.memoizedState;l!==g||y!==C||$t.current||vr?(typeof E=="function"&&(Uc(e,n,E,r),C=e.memoizedState),(h=vr||Cp(e,n,h,r,y,C,u)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,C,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,C,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=C),a.props=r,a.state=C,a.context=u,r=h):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return qc(t,e,n,r,s,i)}function qc(t,e,n,r,i,s){Vy(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&vp(e,n,!1),nr(t,e,s);r=e.stateNode,o1.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=as(e,t.child,null,s),e.child=as(e,null,l,s)):Nt(t,e,l,s),e.memoizedState=r.state,i&&vp(e,n,!0),e.child}function My(t){var e=t.stateNode;e.pendingContext?yp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&yp(t,e.context,!1),oh(t,e.containerInfo)}function jp(t,e,n,r,i){return os(),eh(i),e.flags|=256,Nt(t,e,n,r),e.child}var Gc={dehydrated:null,treeContext:null,retryLane:0};function Qc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ly(t,e,n){var r=e.pendingProps,i=Be.current,s=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),be(Be,i&1),t===null)return zc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Xl(a,r,0,null),t=ai(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Qc(n),e.memoizedState=Gc,t):ph(e,a));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return a1(t,e,a,r,l,i,n);if(s){s=r.fallback,a=e.mode,i=t.child,l=i.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=br(i,u),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=br(l,s):(s=ai(s,a,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=t.child.memoizedState,a=a===null?Qc(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=Gc,r}return s=t.child,t=s.sibling,r=br(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ph(t,e){return e=Xl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ja(t,e,n,r){return r!==null&&eh(r),as(e,t.child,null,n),t=ph(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function a1(t,e,n,r,i,s,a){if(n)return e.flags&256?(e.flags&=-257,r=Gu(Error(W(422))),ja(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Xl({mode:"visible",children:r.children},i,0,null),s=ai(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&as(e,t.child,null,a),e.child.memoizedState=Qc(a),e.memoizedState=Gc,s);if(!(e.mode&1))return ja(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(W(419)),r=Gu(s,r,void 0),ja(t,e,a,r)}if(l=(a&t.childLanes)!==0,Ut||l){if(r=dt,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,tr(t,i),Cn(r,t,i,-1))}return xh(),r=Gu(Error(W(421))),ja(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=x1.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,tn=Ar(i.nextSibling),rn=e,Oe=!0,En=null,t!==null&&(dn[hn++]=Qn,dn[hn++]=Kn,dn[hn++]=ci,Qn=t.id,Kn=t.overflow,ci=e),e=ph(e,r.children),e.flags|=4096,e)}function Vp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Bc(t.return,e,n)}function Qu(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Oy(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Nt(t,e,r.children,n),r=Be.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Vp(t,n,e);else if(t.tag===19)Vp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(be(Be,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&wl(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Qu(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&wl(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Qu(e,!0,n,null,s);break;case"together":Qu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ya(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function nr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),hi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=br(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=br(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function l1(t,e,n){switch(e.tag){case 3:My(e),os();break;case 5:cy(e);break;case 1:Wt(e.type)&&ml(e);break;case 4:oh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;be(vl,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(be(Be,Be.current&1),e.flags|=128,null):n&e.child.childLanes?Ly(t,e,n):(be(Be,Be.current&1),t=nr(t,e,n),t!==null?t.sibling:null);be(Be,Be.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Oy(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),be(Be,Be.current),r)break;return null;case 22:case 23:return e.lanes=0,jy(t,e,n)}return nr(t,e,n)}var Fy,Kc,zy,By;Fy=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Kc=function(){};zy=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ii(Ln.current);var s=null;switch(n){case"input":i=yc(t,i),r=yc(t,r),s=[];break;case"select":i=$e({},i,{value:void 0}),r=$e({},r,{value:void 0}),s=[];break;case"textarea":i=xc(t,i),r=xc(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=fl)}Sc(n,r);var a;n=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var l=i[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(po.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var u=r[h];if(l=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&u!==l&&(u!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(s||(s=[]),s.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(s=s||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(po.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&Ne("scroll",t),s||l===u||(s=[])):(s=s||[]).push(h,u))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};By=function(t,e,n,r){n!==r&&(e.flags|=4)};function $s(t,e){if(!Oe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ct(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function u1(t,e,n){var r=e.pendingProps;switch(Zd(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ct(e),null;case 1:return Wt(e.type)&&pl(),Ct(e),null;case 3:return r=e.stateNode,ls(),Ve($t),Ve(bt),lh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Da(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,En!==null&&(rd(En),En=null))),Kc(t,e),Ct(e),null;case 5:ah(e);var i=ii(Co.current);if(n=e.type,t!==null&&e.stateNode!=null)zy(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return Ct(e),null}if(t=ii(Ln.current),Da(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Vn]=e,r[To]=s,t=(e.mode&1)!==0,n){case"dialog":Ne("cancel",r),Ne("close",r);break;case"iframe":case"object":case"embed":Ne("load",r);break;case"video":case"audio":for(i=0;i<Ks.length;i++)Ne(Ks[i],r);break;case"source":Ne("error",r);break;case"img":case"image":case"link":Ne("error",r),Ne("load",r);break;case"details":Ne("toggle",r);break;case"input":Wf(r,s),Ne("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ne("invalid",r);break;case"textarea":qf(r,s),Ne("invalid",r)}Sc(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&ba(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&ba(r.textContent,l,t),i=["children",""+l]):po.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Ne("scroll",r)}switch(n){case"input":Ea(r),Hf(r,s,!0);break;case"textarea":Ea(r),Gf(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=fl)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=mg(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Vn]=e,t[To]=r,Fy(t,e,!1,!1),e.stateNode=t;e:{switch(a=Ec(n,r),n){case"dialog":Ne("cancel",t),Ne("close",t),i=r;break;case"iframe":case"object":case"embed":Ne("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ks.length;i++)Ne(Ks[i],t);i=r;break;case"source":Ne("error",t),i=r;break;case"img":case"image":case"link":Ne("error",t),Ne("load",t),i=r;break;case"details":Ne("toggle",t),i=r;break;case"input":Wf(t,r),i=yc(t,r),Ne("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=$e({},r,{value:void 0}),Ne("invalid",t);break;case"textarea":qf(t,r),i=xc(t,r),Ne("invalid",t);break;default:i=r}Sc(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?vg(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&gg(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&mo(t,u):typeof u=="number"&&mo(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(po.hasOwnProperty(s)?u!=null&&s==="onScroll"&&Ne("scroll",t):u!=null&&Od(t,s,u,a))}switch(n){case"input":Ea(t),Hf(t,r,!1);break;case"textarea":Ea(t),Gf(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Mr(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Xi(t,!!r.multiple,s,!1):r.defaultValue!=null&&Xi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=fl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ct(e),null;case 6:if(t&&e.stateNode!=null)By(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(n=ii(Co.current),ii(Ln.current),Da(e)){if(r=e.stateNode,n=e.memoizedProps,r[Vn]=e,(s=r.nodeValue!==n)&&(t=rn,t!==null))switch(t.tag){case 3:ba(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ba(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Vn]=e,e.stateNode=r}return Ct(e),null;case 13:if(Ve(Be),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Oe&&tn!==null&&e.mode&1&&!(e.flags&128))sy(),os(),e.flags|=98560,s=!1;else if(s=Da(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(W(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(W(317));s[Vn]=e}else os(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ct(e),s=!1}else En!==null&&(rd(En),En=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Be.current&1?ot===0&&(ot=3):xh())),e.updateQueue!==null&&(e.flags|=4),Ct(e),null);case 4:return ls(),Kc(t,e),t===null&&So(e.stateNode.containerInfo),Ct(e),null;case 10:return rh(e.type._context),Ct(e),null;case 17:return Wt(e.type)&&pl(),Ct(e),null;case 19:if(Ve(Be),s=e.memoizedState,s===null)return Ct(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)$s(s,!1);else{if(ot!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=wl(t),a!==null){for(e.flags|=128,$s(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return be(Be,Be.current&1|2),e.child}t=t.sibling}s.tail!==null&&Je()>cs&&(e.flags|=128,r=!0,$s(s,!1),e.lanes=4194304)}else{if(!r)if(t=wl(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),$s(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Oe)return Ct(e),null}else 2*Je()-s.renderingStartTime>cs&&n!==1073741824&&(e.flags|=128,r=!0,$s(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Je(),e.sibling=null,n=Be.current,be(Be,r?n&1|2:n&1),e):(Ct(e),null);case 22:case 23:return _h(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?en&1073741824&&(Ct(e),e.subtreeFlags&6&&(e.flags|=8192)):Ct(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function c1(t,e){switch(Zd(e),e.tag){case 1:return Wt(e.type)&&pl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ls(),Ve($t),Ve(bt),lh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ah(e),null;case 13:if(Ve(Be),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));os()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ve(Be),null;case 4:return ls(),null;case 10:return rh(e.type._context),null;case 22:case 23:return _h(),null;case 24:return null;default:return null}}var Va=!1,kt=!1,d1=typeof WeakSet=="function"?WeakSet:Set,Y=null;function Ki(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ge(t,e,r)}else n.current=null}function Yc(t,e,n){try{n()}catch(r){Ge(t,e,r)}}var Mp=!1;function h1(t,e){if(Nc=cl,t=qg(),Xd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,l=-1,u=-1,h=0,p=0,g=t,y=null;t:for(;;){for(var E;g!==n||i!==0&&g.nodeType!==3||(l=a+i),g!==s||r!==0&&g.nodeType!==3||(u=a+r),g.nodeType===3&&(a+=g.nodeValue.length),(E=g.firstChild)!==null;)y=g,g=E;for(;;){if(g===t)break t;if(y===n&&++h===i&&(l=a),y===s&&++p===r&&(u=a),(E=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=E}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(jc={focusedElem:t,selectionRange:n},cl=!1,Y=e;Y!==null;)if(e=Y,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Y=t;else for(;Y!==null;){e=Y;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var P=C.memoizedProps,M=C.memoizedState,T=e.stateNode,w=T.getSnapshotBeforeUpdate(e.elementType===e.type?P:wn(e.type,P),M);T.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var k=e.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(V){Ge(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,Y=t;break}Y=e.return}return C=Mp,Mp=!1,C}function oo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Yc(e,n,s)}i=i.next}while(i!==r)}}function Kl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Xc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Uy(t){var e=t.alternate;e!==null&&(t.alternate=null,Uy(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Vn],delete e[To],delete e[Lc],delete e[Qx],delete e[Kx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function $y(t){return t.tag===5||t.tag===3||t.tag===4}function Lp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||$y(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Jc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=fl));else if(r!==4&&(t=t.child,t!==null))for(Jc(t,e,n),t=t.sibling;t!==null;)Jc(t,e,n),t=t.sibling}function Zc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Zc(t,e,n),t=t.sibling;t!==null;)Zc(t,e,n),t=t.sibling}var pt=null,Sn=!1;function gr(t,e,n){for(n=n.child;n!==null;)Wy(t,e,n),n=n.sibling}function Wy(t,e,n){if(Mn&&typeof Mn.onCommitFiberUnmount=="function")try{Mn.onCommitFiberUnmount(Bl,n)}catch{}switch(n.tag){case 5:kt||Ki(n,e);case 6:var r=pt,i=Sn;pt=null,gr(t,e,n),pt=r,Sn=i,pt!==null&&(Sn?(t=pt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):pt.removeChild(n.stateNode));break;case 18:pt!==null&&(Sn?(t=pt,n=n.stateNode,t.nodeType===8?Bu(t.parentNode,n):t.nodeType===1&&Bu(t,n),_o(t)):Bu(pt,n.stateNode));break;case 4:r=pt,i=Sn,pt=n.stateNode.containerInfo,Sn=!0,gr(t,e,n),pt=r,Sn=i;break;case 0:case 11:case 14:case 15:if(!kt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Yc(n,e,a),i=i.next}while(i!==r)}gr(t,e,n);break;case 1:if(!kt&&(Ki(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ge(n,e,l)}gr(t,e,n);break;case 21:gr(t,e,n);break;case 22:n.mode&1?(kt=(r=kt)||n.memoizedState!==null,gr(t,e,n),kt=r):gr(t,e,n);break;default:gr(t,e,n)}}function Op(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new d1),e.forEach(function(r){var i=w1.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function xn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:pt=l.stateNode,Sn=!1;break e;case 3:pt=l.stateNode.containerInfo,Sn=!0;break e;case 4:pt=l.stateNode.containerInfo,Sn=!0;break e}l=l.return}if(pt===null)throw Error(W(160));Wy(s,a,i),pt=null,Sn=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(h){Ge(i,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Hy(e,t),e=e.sibling}function Hy(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(xn(e,t),Nn(t),r&4){try{oo(3,t,t.return),Kl(3,t)}catch(P){Ge(t,t.return,P)}try{oo(5,t,t.return)}catch(P){Ge(t,t.return,P)}}break;case 1:xn(e,t),Nn(t),r&512&&n!==null&&Ki(n,n.return);break;case 5:if(xn(e,t),Nn(t),r&512&&n!==null&&Ki(n,n.return),t.flags&32){var i=t.stateNode;try{mo(i,"")}catch(P){Ge(t,t.return,P)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&fg(i,s),Ec(l,a);var h=Ec(l,s);for(a=0;a<u.length;a+=2){var p=u[a],g=u[a+1];p==="style"?vg(i,g):p==="dangerouslySetInnerHTML"?gg(i,g):p==="children"?mo(i,g):Od(i,p,g,h)}switch(l){case"input":vc(i,s);break;case"textarea":pg(i,s);break;case"select":var y=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var E=s.value;E!=null?Xi(i,!!s.multiple,E,!1):y!==!!s.multiple&&(s.defaultValue!=null?Xi(i,!!s.multiple,s.defaultValue,!0):Xi(i,!!s.multiple,s.multiple?[]:"",!1))}i[To]=s}catch(P){Ge(t,t.return,P)}}break;case 6:if(xn(e,t),Nn(t),r&4){if(t.stateNode===null)throw Error(W(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(P){Ge(t,t.return,P)}}break;case 3:if(xn(e,t),Nn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{_o(e.containerInfo)}catch(P){Ge(t,t.return,P)}break;case 4:xn(e,t),Nn(t);break;case 13:xn(e,t),Nn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(yh=Je())),r&4&&Op(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(kt=(h=kt)||p,xn(e,t),kt=h):xn(e,t),Nn(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(Y=t,p=t.child;p!==null;){for(g=Y=p;Y!==null;){switch(y=Y,E=y.child,y.tag){case 0:case 11:case 14:case 15:oo(4,y,y.return);break;case 1:Ki(y,y.return);var C=y.stateNode;if(typeof C.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(P){Ge(r,n,P)}}break;case 5:Ki(y,y.return);break;case 22:if(y.memoizedState!==null){zp(g);continue}}E!==null?(E.return=y,Y=E):zp(g)}p=p.sibling}e:for(p=null,g=t;;){if(g.tag===5){if(p===null){p=g;try{i=g.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=g.stateNode,u=g.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=yg("display",a))}catch(P){Ge(t,t.return,P)}}}else if(g.tag===6){if(p===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(P){Ge(t,t.return,P)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;p===g&&(p=null),g=g.return}p===g&&(p=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:xn(e,t),Nn(t),r&4&&Op(t);break;case 21:break;default:xn(e,t),Nn(t)}}function Nn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if($y(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(mo(i,""),r.flags&=-33);var s=Lp(t);Zc(t,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,l=Lp(t);Jc(t,l,a);break;default:throw Error(W(161))}}catch(u){Ge(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function f1(t,e,n){Y=t,qy(t)}function qy(t,e,n){for(var r=(t.mode&1)!==0;Y!==null;){var i=Y,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Va;if(!a){var l=i.alternate,u=l!==null&&l.memoizedState!==null||kt;l=Va;var h=kt;if(Va=a,(kt=u)&&!h)for(Y=i;Y!==null;)a=Y,u=a.child,a.tag===22&&a.memoizedState!==null?Bp(i):u!==null?(u.return=a,Y=u):Bp(i);for(;s!==null;)Y=s,qy(s),s=s.sibling;Y=i,Va=l,kt=h}Fp(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Y=s):Fp(t)}}function Fp(t){for(;Y!==null;){var e=Y;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:kt||Kl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!kt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:wn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Ep(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Ep(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var g=p.dehydrated;g!==null&&_o(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}kt||e.flags&512&&Xc(e)}catch(y){Ge(e,e.return,y)}}if(e===t){Y=null;break}if(n=e.sibling,n!==null){n.return=e.return,Y=n;break}Y=e.return}}function zp(t){for(;Y!==null;){var e=Y;if(e===t){Y=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Y=n;break}Y=e.return}}function Bp(t){for(;Y!==null;){var e=Y;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Kl(4,e)}catch(u){Ge(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){Ge(e,i,u)}}var s=e.return;try{Xc(e)}catch(u){Ge(e,s,u)}break;case 5:var a=e.return;try{Xc(e)}catch(u){Ge(e,a,u)}}}catch(u){Ge(e,e.return,u)}if(e===t){Y=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Y=l;break}Y=e.return}}var p1=Math.ceil,Tl=ar.ReactCurrentDispatcher,mh=ar.ReactCurrentOwner,pn=ar.ReactCurrentBatchConfig,ve=0,dt=null,nt=null,yt=0,en=0,Yi=Ur(0),ot=0,Po=null,hi=0,Yl=0,gh=0,ao=null,zt=null,yh=0,cs=1/0,Hn=null,Il=!1,ed=null,Rr=null,Ma=!1,Sr=null,Cl=0,lo=0,td=null,Xa=-1,Ja=0;function jt(){return ve&6?Je():Xa!==-1?Xa:Xa=Je()}function Pr(t){return t.mode&1?ve&2&&yt!==0?yt&-yt:Xx.transition!==null?(Ja===0&&(Ja=Pg()),Ja):(t=Te,t!==0||(t=window.event,t=t===void 0?16:Lg(t.type)),t):1}function Cn(t,e,n,r){if(50<lo)throw lo=0,td=null,Error(W(185));$o(t,n,r),(!(ve&2)||t!==dt)&&(t===dt&&(!(ve&2)&&(Yl|=n),ot===4&&xr(t,yt)),Ht(t,r),n===1&&ve===0&&!(e.mode&1)&&(cs=Je()+500,ql&&$r()))}function Ht(t,e){var n=t.callbackNode;X_(t,e);var r=ul(t,t===dt?yt:0);if(r===0)n!==null&&Yf(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Yf(n),e===1)t.tag===0?Yx(Up.bind(null,t)):ny(Up.bind(null,t)),qx(function(){!(ve&6)&&$r()}),n=null;else{switch(bg(r)){case 1:n=$d;break;case 4:n=kg;break;case 16:n=ll;break;case 536870912:n=Rg;break;default:n=ll}n=e0(n,Gy.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Gy(t,e){if(Xa=-1,Ja=0,ve&6)throw Error(W(327));var n=t.callbackNode;if(ns()&&t.callbackNode!==n)return null;var r=ul(t,t===dt?yt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Al(t,r);else{e=r;var i=ve;ve|=2;var s=Ky();(dt!==t||yt!==e)&&(Hn=null,cs=Je()+500,oi(t,e));do try{y1();break}catch(l){Qy(t,l)}while(!0);nh(),Tl.current=s,ve=i,nt!==null?e=0:(dt=null,yt=0,e=ot)}if(e!==0){if(e===2&&(i=kc(t),i!==0&&(r=i,e=nd(t,i))),e===1)throw n=Po,oi(t,0),xr(t,r),Ht(t,Je()),n;if(e===6)xr(t,r);else{if(i=t.current.alternate,!(r&30)&&!m1(i)&&(e=Al(t,r),e===2&&(s=kc(t),s!==0&&(r=s,e=nd(t,s))),e===1))throw n=Po,oi(t,0),xr(t,r),Ht(t,Je()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:ei(t,zt,Hn);break;case 3:if(xr(t,r),(r&130023424)===r&&(e=yh+500-Je(),10<e)){if(ul(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){jt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Mc(ei.bind(null,t,zt,Hn),e);break}ei(t,zt,Hn);break;case 4:if(xr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-In(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=Je()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*p1(r/1960))-r,10<r){t.timeoutHandle=Mc(ei.bind(null,t,zt,Hn),r);break}ei(t,zt,Hn);break;case 5:ei(t,zt,Hn);break;default:throw Error(W(329))}}}return Ht(t,Je()),t.callbackNode===n?Gy.bind(null,t):null}function nd(t,e){var n=ao;return t.current.memoizedState.isDehydrated&&(oi(t,e).flags|=256),t=Al(t,e),t!==2&&(e=zt,zt=n,e!==null&&rd(e)),t}function rd(t){zt===null?zt=t:zt.push.apply(zt,t)}function m1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!kn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function xr(t,e){for(e&=~gh,e&=~Yl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-In(e),r=1<<n;t[n]=-1,e&=~r}}function Up(t){if(ve&6)throw Error(W(327));ns();var e=ul(t,0);if(!(e&1))return Ht(t,Je()),null;var n=Al(t,e);if(t.tag!==0&&n===2){var r=kc(t);r!==0&&(e=r,n=nd(t,r))}if(n===1)throw n=Po,oi(t,0),xr(t,e),Ht(t,Je()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ei(t,zt,Hn),Ht(t,Je()),null}function vh(t,e){var n=ve;ve|=1;try{return t(e)}finally{ve=n,ve===0&&(cs=Je()+500,ql&&$r())}}function fi(t){Sr!==null&&Sr.tag===0&&!(ve&6)&&ns();var e=ve;ve|=1;var n=pn.transition,r=Te;try{if(pn.transition=null,Te=1,t)return t()}finally{Te=r,pn.transition=n,ve=e,!(ve&6)&&$r()}}function _h(){en=Yi.current,Ve(Yi)}function oi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Hx(n)),nt!==null)for(n=nt.return;n!==null;){var r=n;switch(Zd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&pl();break;case 3:ls(),Ve($t),Ve(bt),lh();break;case 5:ah(r);break;case 4:ls();break;case 13:Ve(Be);break;case 19:Ve(Be);break;case 10:rh(r.type._context);break;case 22:case 23:_h()}n=n.return}if(dt=t,nt=t=br(t.current,null),yt=en=e,ot=0,Po=null,gh=Yl=hi=0,zt=ao=null,ri!==null){for(e=0;e<ri.length;e++)if(n=ri[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}ri=null}return t}function Qy(t,e){do{var n=nt;try{if(nh(),Qa.current=El,Sl){for(var r=Ue.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Sl=!1}if(di=0,ct=st=Ue=null,so=!1,Ao=0,mh.current=null,n===null||n.return===null){ot=1,Po=e,nt=null;break}e:{var s=t,a=n.return,l=n,u=e;if(e=yt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,p=l,g=p.tag;if(!(p.mode&1)&&(g===0||g===11||g===15)){var y=p.alternate;y?(p.updateQueue=y.updateQueue,p.memoizedState=y.memoizedState,p.lanes=y.lanes):(p.updateQueue=null,p.memoizedState=null)}var E=Rp(a);if(E!==null){E.flags&=-257,Pp(E,a,l,s,e),E.mode&1&&kp(s,h,e),e=E,u=h;var C=e.updateQueue;if(C===null){var P=new Set;P.add(u),e.updateQueue=P}else C.add(u);break e}else{if(!(e&1)){kp(s,h,e),xh();break e}u=Error(W(426))}}else if(Oe&&l.mode&1){var M=Rp(a);if(M!==null){!(M.flags&65536)&&(M.flags|=256),Pp(M,a,l,s,e),eh(us(u,l));break e}}s=u=us(u,l),ot!==4&&(ot=2),ao===null?ao=[s]:ao.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var T=by(s,u,e);Sp(s,T);break e;case 1:l=u;var w=s.type,k=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Rr===null||!Rr.has(k)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=Dy(s,l,e);Sp(s,V);break e}}s=s.return}while(s!==null)}Xy(n)}catch(F){e=F,nt===n&&n!==null&&(nt=n=n.return);continue}break}while(!0)}function Ky(){var t=Tl.current;return Tl.current=El,t===null?El:t}function xh(){(ot===0||ot===3||ot===2)&&(ot=4),dt===null||!(hi&268435455)&&!(Yl&268435455)||xr(dt,yt)}function Al(t,e){var n=ve;ve|=2;var r=Ky();(dt!==t||yt!==e)&&(Hn=null,oi(t,e));do try{g1();break}catch(i){Qy(t,i)}while(!0);if(nh(),ve=n,Tl.current=r,nt!==null)throw Error(W(261));return dt=null,yt=0,ot}function g1(){for(;nt!==null;)Yy(nt)}function y1(){for(;nt!==null&&!U_();)Yy(nt)}function Yy(t){var e=Zy(t.alternate,t,en);t.memoizedProps=t.pendingProps,e===null?Xy(t):nt=e,mh.current=null}function Xy(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=c1(n,e),n!==null){n.flags&=32767,nt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ot=6,nt=null;return}}else if(n=u1(n,e,en),n!==null){nt=n;return}if(e=e.sibling,e!==null){nt=e;return}nt=e=t}while(e!==null);ot===0&&(ot=5)}function ei(t,e,n){var r=Te,i=pn.transition;try{pn.transition=null,Te=1,v1(t,e,n,r)}finally{pn.transition=i,Te=r}return null}function v1(t,e,n,r){do ns();while(Sr!==null);if(ve&6)throw Error(W(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(J_(t,s),t===dt&&(nt=dt=null,yt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ma||(Ma=!0,e0(ll,function(){return ns(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=pn.transition,pn.transition=null;var a=Te;Te=1;var l=ve;ve|=4,mh.current=null,h1(t,n),Hy(n,t),Ox(jc),cl=!!Nc,jc=Nc=null,t.current=n,f1(n),$_(),ve=l,Te=a,pn.transition=s}else t.current=n;if(Ma&&(Ma=!1,Sr=t,Cl=i),s=t.pendingLanes,s===0&&(Rr=null),q_(n.stateNode),Ht(t,Je()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Il)throw Il=!1,t=ed,ed=null,t;return Cl&1&&t.tag!==0&&ns(),s=t.pendingLanes,s&1?t===td?lo++:(lo=0,td=t):lo=0,$r(),null}function ns(){if(Sr!==null){var t=bg(Cl),e=pn.transition,n=Te;try{if(pn.transition=null,Te=16>t?16:t,Sr===null)var r=!1;else{if(t=Sr,Sr=null,Cl=0,ve&6)throw Error(W(331));var i=ve;for(ve|=4,Y=t.current;Y!==null;){var s=Y,a=s.child;if(Y.flags&16){var l=s.deletions;if(l!==null){for(var u=0;u<l.length;u++){var h=l[u];for(Y=h;Y!==null;){var p=Y;switch(p.tag){case 0:case 11:case 15:oo(8,p,s)}var g=p.child;if(g!==null)g.return=p,Y=g;else for(;Y!==null;){p=Y;var y=p.sibling,E=p.return;if(Uy(p),p===h){Y=null;break}if(y!==null){y.return=E,Y=y;break}Y=E}}}var C=s.alternate;if(C!==null){var P=C.child;if(P!==null){C.child=null;do{var M=P.sibling;P.sibling=null,P=M}while(P!==null)}}Y=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Y=a;else e:for(;Y!==null;){if(s=Y,s.flags&2048)switch(s.tag){case 0:case 11:case 15:oo(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,Y=T;break e}Y=s.return}}var w=t.current;for(Y=w;Y!==null;){a=Y;var k=a.child;if(a.subtreeFlags&2064&&k!==null)k.return=a,Y=k;else e:for(a=w;Y!==null;){if(l=Y,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Kl(9,l)}}catch(F){Ge(l,l.return,F)}if(l===a){Y=null;break e}var V=l.sibling;if(V!==null){V.return=l.return,Y=V;break e}Y=l.return}}if(ve=i,$r(),Mn&&typeof Mn.onPostCommitFiberRoot=="function")try{Mn.onPostCommitFiberRoot(Bl,t)}catch{}r=!0}return r}finally{Te=n,pn.transition=e}}return!1}function $p(t,e,n){e=us(n,e),e=by(t,e,1),t=kr(t,e,1),e=jt(),t!==null&&($o(t,1,e),Ht(t,e))}function Ge(t,e,n){if(t.tag===3)$p(t,t,n);else for(;e!==null;){if(e.tag===3){$p(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rr===null||!Rr.has(r))){t=us(n,t),t=Dy(e,t,1),e=kr(e,t,1),t=jt(),e!==null&&($o(e,1,t),Ht(e,t));break}}e=e.return}}function _1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=jt(),t.pingedLanes|=t.suspendedLanes&n,dt===t&&(yt&n)===n&&(ot===4||ot===3&&(yt&130023424)===yt&&500>Je()-yh?oi(t,0):gh|=n),Ht(t,e)}function Jy(t,e){e===0&&(t.mode&1?(e=Ca,Ca<<=1,!(Ca&130023424)&&(Ca=4194304)):e=1);var n=jt();t=tr(t,e),t!==null&&($o(t,e,n),Ht(t,n))}function x1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Jy(t,n)}function w1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),Jy(t,n)}var Zy;Zy=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||$t.current)Ut=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ut=!1,l1(t,e,n);Ut=!!(t.flags&131072)}else Ut=!1,Oe&&e.flags&1048576&&ry(e,yl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ya(t,e),t=e.pendingProps;var i=ss(e,bt.current);ts(e,n),i=ch(null,e,r,t,i,n);var s=dh();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Wt(r)?(s=!0,ml(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,sh(e),i.updater=Ql,e.stateNode=i,i._reactInternals=e,$c(e,r,t,n),e=qc(null,e,r,!0,s,n)):(e.tag=0,Oe&&s&&Jd(e),Nt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ya(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=E1(r),t=wn(r,t),i){case 0:e=Hc(null,e,r,t,n);break e;case 1:e=Np(null,e,r,t,n);break e;case 11:e=bp(null,e,r,t,n);break e;case 14:e=Dp(null,e,r,wn(r.type,t),n);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wn(r,i),Hc(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wn(r,i),Np(t,e,r,i,n);case 3:e:{if(My(e),t===null)throw Error(W(387));r=e.pendingProps,s=e.memoizedState,i=s.element,uy(t,e),xl(e,r,null,n);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=us(Error(W(423)),e),e=jp(t,e,r,n,i);break e}else if(r!==i){i=us(Error(W(424)),e),e=jp(t,e,r,n,i);break e}else for(tn=Ar(e.stateNode.containerInfo.firstChild),rn=e,Oe=!0,En=null,n=ay(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(os(),r===i){e=nr(t,e,n);break e}Nt(t,e,r,n)}e=e.child}return e;case 5:return cy(e),t===null&&zc(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Vc(r,i)?a=null:s!==null&&Vc(r,s)&&(e.flags|=32),Vy(t,e),Nt(t,e,a,n),e.child;case 6:return t===null&&zc(e),null;case 13:return Ly(t,e,n);case 4:return oh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=as(e,null,r,n):Nt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wn(r,i),bp(t,e,r,i,n);case 7:return Nt(t,e,e.pendingProps,n),e.child;case 8:return Nt(t,e,e.pendingProps.children,n),e.child;case 12:return Nt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,be(vl,r._currentValue),r._currentValue=a,s!==null)if(kn(s.value,a)){if(s.children===i.children&&!$t.current){e=nr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){a=s.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=Yn(-1,n&-n),u.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?u.next=u:(u.next=p.next,p.next=u),h.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),Bc(s.return,n,e),l.lanes|=n;break}u=u.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(W(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Bc(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Nt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ts(e,n),i=mn(i),r=r(i),e.flags|=1,Nt(t,e,r,n),e.child;case 14:return r=e.type,i=wn(r,e.pendingProps),i=wn(r.type,i),Dp(t,e,r,i,n);case 15:return Ny(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:wn(r,i),Ya(t,e),e.tag=1,Wt(r)?(t=!0,ml(e)):t=!1,ts(e,n),Py(e,r,i),$c(e,r,i,n),qc(null,e,r,!0,t,n);case 19:return Oy(t,e,n);case 22:return jy(t,e,n)}throw Error(W(156,e.tag))};function e0(t,e){return Ag(t,e)}function S1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fn(t,e,n,r){return new S1(t,e,n,r)}function wh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function E1(t){if(typeof t=="function")return wh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===zd)return 11;if(t===Bd)return 14}return 2}function br(t,e){var n=t.alternate;return n===null?(n=fn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Za(t,e,n,r,i,s){var a=2;if(r=t,typeof t=="function")wh(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case zi:return ai(n.children,i,s,e);case Fd:a=8,i|=8;break;case fc:return t=fn(12,n,e,i|2),t.elementType=fc,t.lanes=s,t;case pc:return t=fn(13,n,e,i),t.elementType=pc,t.lanes=s,t;case mc:return t=fn(19,n,e,i),t.elementType=mc,t.lanes=s,t;case cg:return Xl(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case lg:a=10;break e;case ug:a=9;break e;case zd:a=11;break e;case Bd:a=14;break e;case yr:a=16,r=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=fn(a,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ai(t,e,n,r){return t=fn(7,t,r,e),t.lanes=n,t}function Xl(t,e,n,r){return t=fn(22,t,r,e),t.elementType=cg,t.lanes=n,t.stateNode={isHidden:!1},t}function Ku(t,e,n){return t=fn(6,t,null,e),t.lanes=n,t}function Yu(t,e,n){return e=fn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function T1(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Pu(0),this.expirationTimes=Pu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pu(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Sh(t,e,n,r,i,s,a,l,u){return t=new T1(t,e,n,l,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=fn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},sh(s),t}function I1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function t0(t){if(!t)return Lr;t=t._reactInternals;e:{if(vi(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Wt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(Wt(n))return ty(t,n,e)}return e}function n0(t,e,n,r,i,s,a,l,u){return t=Sh(n,r,!0,t,i,s,a,l,u),t.context=t0(null),n=t.current,r=jt(),i=Pr(n),s=Yn(r,i),s.callback=e??null,kr(n,s,i),t.current.lanes=i,$o(t,i,r),Ht(t,r),t}function Jl(t,e,n,r){var i=e.current,s=jt(),a=Pr(i);return n=t0(n),e.context===null?e.context=n:e.pendingContext=n,e=Yn(s,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=kr(i,e,a),t!==null&&(Cn(t,i,a,s),Ga(t,i,a)),a}function kl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Wp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Eh(t,e){Wp(t,e),(t=t.alternate)&&Wp(t,e)}function C1(){return null}var r0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Th(t){this._internalRoot=t}Zl.prototype.render=Th.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));Jl(t,e,null,null)};Zl.prototype.unmount=Th.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;fi(function(){Jl(null,t,null,null)}),e[er]=null}};function Zl(t){this._internalRoot=t}Zl.prototype.unstable_scheduleHydration=function(t){if(t){var e=jg();t={blockedOn:null,target:t,priority:e};for(var n=0;n<_r.length&&e!==0&&e<_r[n].priority;n++);_r.splice(n,0,t),n===0&&Mg(t)}};function Ih(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function eu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Hp(){}function A1(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=kl(a);s.call(h)}}var a=n0(e,r,t,0,null,!1,!1,"",Hp);return t._reactRootContainer=a,t[er]=a.current,So(t.nodeType===8?t.parentNode:t),fi(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var h=kl(u);l.call(h)}}var u=Sh(t,0,!1,null,null,!1,!1,"",Hp);return t._reactRootContainer=u,t[er]=u.current,So(t.nodeType===8?t.parentNode:t),fi(function(){Jl(e,u,n,r)}),u}function tu(t,e,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var l=i;i=function(){var u=kl(a);l.call(u)}}Jl(e,a,t,i)}else a=A1(n,e,t,i,r);return kl(a)}Dg=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Qs(e.pendingLanes);n!==0&&(Wd(e,n|1),Ht(e,Je()),!(ve&6)&&(cs=Je()+500,$r()))}break;case 13:fi(function(){var r=tr(t,1);if(r!==null){var i=jt();Cn(r,t,1,i)}}),Eh(t,1)}};Hd=function(t){if(t.tag===13){var e=tr(t,134217728);if(e!==null){var n=jt();Cn(e,t,134217728,n)}Eh(t,134217728)}};Ng=function(t){if(t.tag===13){var e=Pr(t),n=tr(t,e);if(n!==null){var r=jt();Cn(n,t,e,r)}Eh(t,e)}};jg=function(){return Te};Vg=function(t,e){var n=Te;try{return Te=t,e()}finally{Te=n}};Ic=function(t,e,n){switch(e){case"input":if(vc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Hl(r);if(!i)throw Error(W(90));hg(r),vc(r,i)}}}break;case"textarea":pg(t,n);break;case"select":e=n.value,e!=null&&Xi(t,!!n.multiple,e,!1)}};wg=vh;Sg=fi;var k1={usingClientEntryPoint:!1,Events:[Ho,Wi,Hl,_g,xg,vh]},Ws={findFiberByHostInstance:ni,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},R1={bundleType:Ws.bundleType,version:Ws.version,rendererPackageName:Ws.rendererPackageName,rendererConfig:Ws.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ar.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ig(t),t===null?null:t.stateNode},findFiberByHostInstance:Ws.findFiberByHostInstance||C1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var La=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!La.isDisabled&&La.supportsFiber)try{Bl=La.inject(R1),Mn=La}catch{}}on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k1;on.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ih(e))throw Error(W(200));return I1(t,e,null,n)};on.createRoot=function(t,e){if(!Ih(t))throw Error(W(299));var n=!1,r="",i=r0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Sh(t,1,!1,null,null,n,!1,r,i),t[er]=e.current,So(t.nodeType===8?t.parentNode:t),new Th(e)};on.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=Ig(e),t=t===null?null:t.stateNode,t};on.flushSync=function(t){return fi(t)};on.hydrate=function(t,e,n){if(!eu(e))throw Error(W(200));return tu(null,t,e,!0,n)};on.hydrateRoot=function(t,e,n){if(!Ih(t))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=r0;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=n0(e,null,t,1,n??null,i,!1,s,a),t[er]=e.current,So(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Zl(e)};on.render=function(t,e,n){if(!eu(e))throw Error(W(200));return tu(null,t,e,!1,n)};on.unmountComponentAtNode=function(t){if(!eu(t))throw Error(W(40));return t._reactRootContainer?(fi(function(){tu(null,null,t,!1,function(){t._reactRootContainer=null,t[er]=null})}),!0):!1};on.unstable_batchedUpdates=vh;on.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!eu(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return tu(t,e,n,!1,r)};on.version="18.3.1-next-f1338f8080-20240426";function i0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i0)}catch(t){console.error(t)}}i0(),ig.exports=on;var P1=ig.exports,s0,qp=P1;s0=qp.createRoot,qp.hydrateRoot;var Gp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},b1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],a=t[n++],l=t[n++],u=((i&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=t[n++],a=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},a0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,l=a?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,p=s>>2,g=(s&3)<<4|l>>4;let y=(l&15)<<2|h>>6,E=h&63;u||(E=64,a||(y=64)),r.push(n[p],n[g],n[y],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(o0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):b1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const h=i<t.length?n[t.charAt(i)]:64;++i;const g=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||h==null||g==null)throw new D1;const y=s<<2|l>>4;if(r.push(y),h!==64){const E=l<<4&240|h>>2;if(r.push(E),g!==64){const C=h<<6&192|g;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class D1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const N1=function(t){const e=o0(t);return a0.encodeByteArray(e,!0)},l0=function(t){return N1(t).replace(/\./g,"")},j1=function(t){try{return a0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1=()=>V1().__FIREBASE_DEFAULTS__,L1=()=>{if(typeof process>"u"||typeof Gp>"u")return;const t=Gp.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},O1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&j1(t[1]);return e&&JSON.parse(e)},Ch=()=>{try{return M1()||L1()||O1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},F1=t=>{var e,n;return(n=(e=Ch())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},z1=t=>{const e=F1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},u0=()=>{var t;return(t=Ch())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U1(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $1(){var t;const e=(t=Ch())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function W1(){return!$1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function H1(){try{return typeof indexedDB=="object"}catch{return!1}}function q1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1="FirebaseError";class ws extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=G1,Object.setPrototypeOf(this,ws.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,c0.prototype.create)}}class c0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?Q1(s,r):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new ws(i,l,r)}}function Q1(t,e){return t.replace(K1,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const K1=/\{\$([^}]+)}/g;function Rl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],a=e[i];if(Qp(s)&&Qp(a)){if(!Rl(s,a))return!1}else if(s!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Qp(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rn(t){return t&&t._delegate?t._delegate:t}class ds{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new B1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(J1(e))try{this.getOrInitializeService({instanceIdentifier:ti})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ti){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ti){return this.instances.has(e)}getOptions(e=ti){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&a.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:X1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ti){return this.component?this.component.multipleInstances?e:ti:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function X1(t){return t===ti?void 0:t}function J1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Y1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ye||(ye={}));const ew={debug:ye.DEBUG,verbose:ye.VERBOSE,info:ye.INFO,warn:ye.WARN,error:ye.ERROR,silent:ye.SILENT},tw=ye.INFO,nw={[ye.DEBUG]:"log",[ye.VERBOSE]:"log",[ye.INFO]:"info",[ye.WARN]:"warn",[ye.ERROR]:"error"},rw=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=nw[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class d0{constructor(e){this.name=e,this._logLevel=tw,this._logHandler=rw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ew[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ye.DEBUG,...e),this._logHandler(this,ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ye.VERBOSE,...e),this._logHandler(this,ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ye.INFO,...e),this._logHandler(this,ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ye.WARN,...e),this._logHandler(this,ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ye.ERROR,...e),this._logHandler(this,ye.ERROR,...e)}}const iw=(t,e)=>e.some(n=>t instanceof n);let Kp,Yp;function sw(){return Kp||(Kp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ow(){return Yp||(Yp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const h0=new WeakMap,id=new WeakMap,f0=new WeakMap,Xu=new WeakMap,Ah=new WeakMap;function aw(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{n(Dr(t.result)),i()},a=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&h0.set(n,t)}).catch(()=>{}),Ah.set(e,t),e}function lw(t){if(id.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{n(),i()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});id.set(t,e)}let sd={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return id.get(t);if(e==="objectStoreNames")return t.objectStoreNames||f0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Dr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function uw(t){sd=t(sd)}function cw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Ju(this),e,...n);return f0.set(r,e.sort?e.sort():[e]),Dr(r)}:ow().includes(t)?function(...e){return t.apply(Ju(this),e),Dr(h0.get(this))}:function(...e){return Dr(t.apply(Ju(this),e))}}function dw(t){return typeof t=="function"?cw(t):(t instanceof IDBTransaction&&lw(t),iw(t,sw())?new Proxy(t,sd):t)}function Dr(t){if(t instanceof IDBRequest)return aw(t);if(Xu.has(t))return Xu.get(t);const e=dw(t);return e!==t&&(Xu.set(t,e),Ah.set(e,t)),e}const Ju=t=>Ah.get(t);function hw(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),l=Dr(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Dr(a.result),u.oldVersion,u.newVersion,Dr(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const fw=["get","getKey","getAll","getAllKeys","count"],pw=["put","add","delete","clear"],Zu=new Map;function Xp(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Zu.get(e))return Zu.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=pw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||fw.includes(n)))return;const s=async function(a,...l){const u=this.transaction(a,i?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),i&&u.done]))[0]};return Zu.set(e,s),s}uw(t=>({...t,get:(e,n,r)=>Xp(e,n)||t.get(e,n,r),has:(e,n)=>!!Xp(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(gw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function gw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const od="@firebase/app",Jp="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr=new d0("@firebase/app"),yw="@firebase/app-compat",vw="@firebase/analytics-compat",_w="@firebase/analytics",xw="@firebase/app-check-compat",ww="@firebase/app-check",Sw="@firebase/auth",Ew="@firebase/auth-compat",Tw="@firebase/database",Iw="@firebase/data-connect",Cw="@firebase/database-compat",Aw="@firebase/functions",kw="@firebase/functions-compat",Rw="@firebase/installations",Pw="@firebase/installations-compat",bw="@firebase/messaging",Dw="@firebase/messaging-compat",Nw="@firebase/performance",jw="@firebase/performance-compat",Vw="@firebase/remote-config",Mw="@firebase/remote-config-compat",Lw="@firebase/storage",Ow="@firebase/storage-compat",Fw="@firebase/firestore",zw="@firebase/vertexai-preview",Bw="@firebase/firestore-compat",Uw="firebase",$w="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ad="[DEFAULT]",Ww={[od]:"fire-core",[yw]:"fire-core-compat",[_w]:"fire-analytics",[vw]:"fire-analytics-compat",[ww]:"fire-app-check",[xw]:"fire-app-check-compat",[Sw]:"fire-auth",[Ew]:"fire-auth-compat",[Tw]:"fire-rtdb",[Iw]:"fire-data-connect",[Cw]:"fire-rtdb-compat",[Aw]:"fire-fn",[kw]:"fire-fn-compat",[Rw]:"fire-iid",[Pw]:"fire-iid-compat",[bw]:"fire-fcm",[Dw]:"fire-fcm-compat",[Nw]:"fire-perf",[jw]:"fire-perf-compat",[Vw]:"fire-rc",[Mw]:"fire-rc-compat",[Lw]:"fire-gcs",[Ow]:"fire-gcs-compat",[Fw]:"fire-fst",[Bw]:"fire-fst-compat",[zw]:"fire-vertex","fire-js":"fire-js",[Uw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pl=new Map,Hw=new Map,ld=new Map;function Zp(t,e){try{t.container.addComponent(e)}catch(n){rr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function bo(t){const e=t.name;if(ld.has(e))return rr.debug(`There were multiple attempts to register component ${e}.`),!1;ld.set(e,t);for(const n of Pl.values())Zp(n,t);for(const n of Hw.values())Zp(n,t);return!0}function p0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Nr=new c0("app","Firebase",qw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ds("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Nr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw=$w;function m0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ad,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Nr.create("bad-app-name",{appName:String(i)});if(n||(n=u0()),!n)throw Nr.create("no-options");const s=Pl.get(i);if(s){if(Rl(n,s.options)&&Rl(r,s.config))return s;throw Nr.create("duplicate-app",{appName:i})}const a=new Z1(i);for(const u of ld.values())a.addComponent(u);const l=new Gw(n,r,a);return Pl.set(i,l),l}function Kw(t=ad){const e=Pl.get(t);if(!e&&t===ad&&u0())return m0();if(!e)throw Nr.create("no-app",{appName:t});return e}function jr(t,e,n){var r;let i=(r=Ww[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),rr.warn(l.join(" "));return}bo(new ds(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw="firebase-heartbeat-database",Xw=1,Do="firebase-heartbeat-store";let ec=null;function g0(){return ec||(ec=hw(Yw,Xw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Do)}catch(n){console.warn(n)}}}}).catch(t=>{throw Nr.create("idb-open",{originalErrorMessage:t.message})})),ec}async function Jw(t){try{const n=(await g0()).transaction(Do),r=await n.objectStore(Do).get(y0(t));return await n.done,r}catch(e){if(e instanceof ws)rr.warn(e.message);else{const n=Nr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});rr.warn(n.message)}}}async function em(t,e){try{const r=(await g0()).transaction(Do,"readwrite");await r.objectStore(Do).put(e,y0(t)),await r.done}catch(n){if(n instanceof ws)rr.warn(n.message);else{const r=Nr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});rr.warn(r.message)}}}function y0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw=1024,eS=30*24*60*60*1e3;class tS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new rS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=tm();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=eS}),this._storage.overwrite(this._heartbeatsCache))}catch(r){rr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=tm(),{heartbeatsToSend:r,unsentEntries:i}=nS(this._heartbeatsCache.heartbeats),s=l0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return rr.warn(n),""}}}function tm(){return new Date().toISOString().substring(0,10)}function nS(t,e=Zw){const n=[];let r=t.slice();for(const i of t){const s=n.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),nm(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),nm(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class rS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return H1()?q1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Jw(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return em(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return em(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function nm(t){return l0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t){bo(new ds("platform-logger",e=>new mw(e),"PRIVATE")),bo(new ds("heartbeat",e=>new tS(e),"PRIVATE")),jr(od,Jp,t),jr(od,Jp,"esm2017"),jr("fire-js","")}iS("");var sS="firebase",oS="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jr(sS,oS,"app");var rm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var li,v0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(v,m){function x(){}x.prototype=m.prototype,v.D=m.prototype,v.prototype=new x,v.prototype.constructor=v,v.C=function(S,A,R){for(var I=Array(arguments.length-2),se=2;se<arguments.length;se++)I[se-2]=arguments[se];return m.prototype[A].apply(S,I)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(v,m,x){x||(x=0);var S=Array(16);if(typeof m=="string")for(var A=0;16>A;++A)S[A]=m.charCodeAt(x++)|m.charCodeAt(x++)<<8|m.charCodeAt(x++)<<16|m.charCodeAt(x++)<<24;else for(A=0;16>A;++A)S[A]=m[x++]|m[x++]<<8|m[x++]<<16|m[x++]<<24;m=v.g[0],x=v.g[1],A=v.g[2];var R=v.g[3],I=m+(R^x&(A^R))+S[0]+3614090360&4294967295;m=x+(I<<7&4294967295|I>>>25),I=R+(A^m&(x^A))+S[1]+3905402710&4294967295,R=m+(I<<12&4294967295|I>>>20),I=A+(x^R&(m^x))+S[2]+606105819&4294967295,A=R+(I<<17&4294967295|I>>>15),I=x+(m^A&(R^m))+S[3]+3250441966&4294967295,x=A+(I<<22&4294967295|I>>>10),I=m+(R^x&(A^R))+S[4]+4118548399&4294967295,m=x+(I<<7&4294967295|I>>>25),I=R+(A^m&(x^A))+S[5]+1200080426&4294967295,R=m+(I<<12&4294967295|I>>>20),I=A+(x^R&(m^x))+S[6]+2821735955&4294967295,A=R+(I<<17&4294967295|I>>>15),I=x+(m^A&(R^m))+S[7]+4249261313&4294967295,x=A+(I<<22&4294967295|I>>>10),I=m+(R^x&(A^R))+S[8]+1770035416&4294967295,m=x+(I<<7&4294967295|I>>>25),I=R+(A^m&(x^A))+S[9]+2336552879&4294967295,R=m+(I<<12&4294967295|I>>>20),I=A+(x^R&(m^x))+S[10]+4294925233&4294967295,A=R+(I<<17&4294967295|I>>>15),I=x+(m^A&(R^m))+S[11]+2304563134&4294967295,x=A+(I<<22&4294967295|I>>>10),I=m+(R^x&(A^R))+S[12]+1804603682&4294967295,m=x+(I<<7&4294967295|I>>>25),I=R+(A^m&(x^A))+S[13]+4254626195&4294967295,R=m+(I<<12&4294967295|I>>>20),I=A+(x^R&(m^x))+S[14]+2792965006&4294967295,A=R+(I<<17&4294967295|I>>>15),I=x+(m^A&(R^m))+S[15]+1236535329&4294967295,x=A+(I<<22&4294967295|I>>>10),I=m+(A^R&(x^A))+S[1]+4129170786&4294967295,m=x+(I<<5&4294967295|I>>>27),I=R+(x^A&(m^x))+S[6]+3225465664&4294967295,R=m+(I<<9&4294967295|I>>>23),I=A+(m^x&(R^m))+S[11]+643717713&4294967295,A=R+(I<<14&4294967295|I>>>18),I=x+(R^m&(A^R))+S[0]+3921069994&4294967295,x=A+(I<<20&4294967295|I>>>12),I=m+(A^R&(x^A))+S[5]+3593408605&4294967295,m=x+(I<<5&4294967295|I>>>27),I=R+(x^A&(m^x))+S[10]+38016083&4294967295,R=m+(I<<9&4294967295|I>>>23),I=A+(m^x&(R^m))+S[15]+3634488961&4294967295,A=R+(I<<14&4294967295|I>>>18),I=x+(R^m&(A^R))+S[4]+3889429448&4294967295,x=A+(I<<20&4294967295|I>>>12),I=m+(A^R&(x^A))+S[9]+568446438&4294967295,m=x+(I<<5&4294967295|I>>>27),I=R+(x^A&(m^x))+S[14]+3275163606&4294967295,R=m+(I<<9&4294967295|I>>>23),I=A+(m^x&(R^m))+S[3]+4107603335&4294967295,A=R+(I<<14&4294967295|I>>>18),I=x+(R^m&(A^R))+S[8]+1163531501&4294967295,x=A+(I<<20&4294967295|I>>>12),I=m+(A^R&(x^A))+S[13]+2850285829&4294967295,m=x+(I<<5&4294967295|I>>>27),I=R+(x^A&(m^x))+S[2]+4243563512&4294967295,R=m+(I<<9&4294967295|I>>>23),I=A+(m^x&(R^m))+S[7]+1735328473&4294967295,A=R+(I<<14&4294967295|I>>>18),I=x+(R^m&(A^R))+S[12]+2368359562&4294967295,x=A+(I<<20&4294967295|I>>>12),I=m+(x^A^R)+S[5]+4294588738&4294967295,m=x+(I<<4&4294967295|I>>>28),I=R+(m^x^A)+S[8]+2272392833&4294967295,R=m+(I<<11&4294967295|I>>>21),I=A+(R^m^x)+S[11]+1839030562&4294967295,A=R+(I<<16&4294967295|I>>>16),I=x+(A^R^m)+S[14]+4259657740&4294967295,x=A+(I<<23&4294967295|I>>>9),I=m+(x^A^R)+S[1]+2763975236&4294967295,m=x+(I<<4&4294967295|I>>>28),I=R+(m^x^A)+S[4]+1272893353&4294967295,R=m+(I<<11&4294967295|I>>>21),I=A+(R^m^x)+S[7]+4139469664&4294967295,A=R+(I<<16&4294967295|I>>>16),I=x+(A^R^m)+S[10]+3200236656&4294967295,x=A+(I<<23&4294967295|I>>>9),I=m+(x^A^R)+S[13]+681279174&4294967295,m=x+(I<<4&4294967295|I>>>28),I=R+(m^x^A)+S[0]+3936430074&4294967295,R=m+(I<<11&4294967295|I>>>21),I=A+(R^m^x)+S[3]+3572445317&4294967295,A=R+(I<<16&4294967295|I>>>16),I=x+(A^R^m)+S[6]+76029189&4294967295,x=A+(I<<23&4294967295|I>>>9),I=m+(x^A^R)+S[9]+3654602809&4294967295,m=x+(I<<4&4294967295|I>>>28),I=R+(m^x^A)+S[12]+3873151461&4294967295,R=m+(I<<11&4294967295|I>>>21),I=A+(R^m^x)+S[15]+530742520&4294967295,A=R+(I<<16&4294967295|I>>>16),I=x+(A^R^m)+S[2]+3299628645&4294967295,x=A+(I<<23&4294967295|I>>>9),I=m+(A^(x|~R))+S[0]+4096336452&4294967295,m=x+(I<<6&4294967295|I>>>26),I=R+(x^(m|~A))+S[7]+1126891415&4294967295,R=m+(I<<10&4294967295|I>>>22),I=A+(m^(R|~x))+S[14]+2878612391&4294967295,A=R+(I<<15&4294967295|I>>>17),I=x+(R^(A|~m))+S[5]+4237533241&4294967295,x=A+(I<<21&4294967295|I>>>11),I=m+(A^(x|~R))+S[12]+1700485571&4294967295,m=x+(I<<6&4294967295|I>>>26),I=R+(x^(m|~A))+S[3]+2399980690&4294967295,R=m+(I<<10&4294967295|I>>>22),I=A+(m^(R|~x))+S[10]+4293915773&4294967295,A=R+(I<<15&4294967295|I>>>17),I=x+(R^(A|~m))+S[1]+2240044497&4294967295,x=A+(I<<21&4294967295|I>>>11),I=m+(A^(x|~R))+S[8]+1873313359&4294967295,m=x+(I<<6&4294967295|I>>>26),I=R+(x^(m|~A))+S[15]+4264355552&4294967295,R=m+(I<<10&4294967295|I>>>22),I=A+(m^(R|~x))+S[6]+2734768916&4294967295,A=R+(I<<15&4294967295|I>>>17),I=x+(R^(A|~m))+S[13]+1309151649&4294967295,x=A+(I<<21&4294967295|I>>>11),I=m+(A^(x|~R))+S[4]+4149444226&4294967295,m=x+(I<<6&4294967295|I>>>26),I=R+(x^(m|~A))+S[11]+3174756917&4294967295,R=m+(I<<10&4294967295|I>>>22),I=A+(m^(R|~x))+S[2]+718787259&4294967295,A=R+(I<<15&4294967295|I>>>17),I=x+(R^(A|~m))+S[9]+3951481745&4294967295,v.g[0]=v.g[0]+m&4294967295,v.g[1]=v.g[1]+(A+(I<<21&4294967295|I>>>11))&4294967295,v.g[2]=v.g[2]+A&4294967295,v.g[3]=v.g[3]+R&4294967295}r.prototype.u=function(v,m){m===void 0&&(m=v.length);for(var x=m-this.blockSize,S=this.B,A=this.h,R=0;R<m;){if(A==0)for(;R<=x;)i(this,v,R),R+=this.blockSize;if(typeof v=="string"){for(;R<m;)if(S[A++]=v.charCodeAt(R++),A==this.blockSize){i(this,S),A=0;break}}else for(;R<m;)if(S[A++]=v[R++],A==this.blockSize){i(this,S),A=0;break}}this.h=A,this.o+=m},r.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var m=1;m<v.length-8;++m)v[m]=0;var x=8*this.o;for(m=v.length-8;m<v.length;++m)v[m]=x&255,x/=256;for(this.u(v),v=Array(16),m=x=0;4>m;++m)for(var S=0;32>S;S+=8)v[x++]=this.g[m]>>>S&255;return v};function s(v,m){var x=l;return Object.prototype.hasOwnProperty.call(x,v)?x[v]:x[v]=m(v)}function a(v,m){this.h=m;for(var x=[],S=!0,A=v.length-1;0<=A;A--){var R=v[A]|0;S&&R==m||(x[A]=R,S=!1)}this.g=x}var l={};function u(v){return-128<=v&&128>v?s(v,function(m){return new a([m|0],0>m?-1:0)}):new a([v|0],0>v?-1:0)}function h(v){if(isNaN(v)||!isFinite(v))return g;if(0>v)return M(h(-v));for(var m=[],x=1,S=0;v>=x;S++)m[S]=v/x|0,x*=4294967296;return new a(m,0)}function p(v,m){if(v.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(v.charAt(0)=="-")return M(p(v.substring(1),m));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var x=h(Math.pow(m,8)),S=g,A=0;A<v.length;A+=8){var R=Math.min(8,v.length-A),I=parseInt(v.substring(A,A+R),m);8>R?(R=h(Math.pow(m,R)),S=S.j(R).add(h(I))):(S=S.j(x),S=S.add(h(I)))}return S}var g=u(0),y=u(1),E=u(16777216);t=a.prototype,t.m=function(){if(P(this))return-M(this).m();for(var v=0,m=1,x=0;x<this.g.length;x++){var S=this.i(x);v+=(0<=S?S:4294967296+S)*m,m*=4294967296}return v},t.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(C(this))return"0";if(P(this))return"-"+M(this).toString(v);for(var m=h(Math.pow(v,6)),x=this,S="";;){var A=V(x,m).g;x=T(x,A.j(m));var R=((0<x.g.length?x.g[0]:x.h)>>>0).toString(v);if(x=A,C(x))return R+S;for(;6>R.length;)R="0"+R;S=R+S}},t.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function C(v){if(v.h!=0)return!1;for(var m=0;m<v.g.length;m++)if(v.g[m]!=0)return!1;return!0}function P(v){return v.h==-1}t.l=function(v){return v=T(this,v),P(v)?-1:C(v)?0:1};function M(v){for(var m=v.g.length,x=[],S=0;S<m;S++)x[S]=~v.g[S];return new a(x,~v.h).add(y)}t.abs=function(){return P(this)?M(this):this},t.add=function(v){for(var m=Math.max(this.g.length,v.g.length),x=[],S=0,A=0;A<=m;A++){var R=S+(this.i(A)&65535)+(v.i(A)&65535),I=(R>>>16)+(this.i(A)>>>16)+(v.i(A)>>>16);S=I>>>16,R&=65535,I&=65535,x[A]=I<<16|R}return new a(x,x[x.length-1]&-2147483648?-1:0)};function T(v,m){return v.add(M(m))}t.j=function(v){if(C(this)||C(v))return g;if(P(this))return P(v)?M(this).j(M(v)):M(M(this).j(v));if(P(v))return M(this.j(M(v)));if(0>this.l(E)&&0>v.l(E))return h(this.m()*v.m());for(var m=this.g.length+v.g.length,x=[],S=0;S<2*m;S++)x[S]=0;for(S=0;S<this.g.length;S++)for(var A=0;A<v.g.length;A++){var R=this.i(S)>>>16,I=this.i(S)&65535,se=v.i(A)>>>16,ne=v.i(A)&65535;x[2*S+2*A]+=I*ne,w(x,2*S+2*A),x[2*S+2*A+1]+=R*ne,w(x,2*S+2*A+1),x[2*S+2*A+1]+=I*se,w(x,2*S+2*A+1),x[2*S+2*A+2]+=R*se,w(x,2*S+2*A+2)}for(S=0;S<m;S++)x[S]=x[2*S+1]<<16|x[2*S];for(S=m;S<2*m;S++)x[S]=0;return new a(x,0)};function w(v,m){for(;(v[m]&65535)!=v[m];)v[m+1]+=v[m]>>>16,v[m]&=65535,m++}function k(v,m){this.g=v,this.h=m}function V(v,m){if(C(m))throw Error("division by zero");if(C(v))return new k(g,g);if(P(v))return m=V(M(v),m),new k(M(m.g),M(m.h));if(P(m))return m=V(v,M(m)),new k(M(m.g),m.h);if(30<v.g.length){if(P(v)||P(m))throw Error("slowDivide_ only works with positive integers.");for(var x=y,S=m;0>=S.l(v);)x=F(x),S=F(S);var A=L(x,1),R=L(S,1);for(S=L(S,2),x=L(x,2);!C(S);){var I=R.add(S);0>=I.l(v)&&(A=A.add(x),R=I),S=L(S,1),x=L(x,1)}return m=T(v,A.j(m)),new k(A,m)}for(A=g;0<=v.l(m);){for(x=Math.max(1,Math.floor(v.m()/m.m())),S=Math.ceil(Math.log(x)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),R=h(x),I=R.j(m);P(I)||0<I.l(v);)x-=S,R=h(x),I=R.j(m);C(R)&&(R=y),A=A.add(R),v=T(v,I)}return new k(A,v)}t.A=function(v){return V(this,v).h},t.and=function(v){for(var m=Math.max(this.g.length,v.g.length),x=[],S=0;S<m;S++)x[S]=this.i(S)&v.i(S);return new a(x,this.h&v.h)},t.or=function(v){for(var m=Math.max(this.g.length,v.g.length),x=[],S=0;S<m;S++)x[S]=this.i(S)|v.i(S);return new a(x,this.h|v.h)},t.xor=function(v){for(var m=Math.max(this.g.length,v.g.length),x=[],S=0;S<m;S++)x[S]=this.i(S)^v.i(S);return new a(x,this.h^v.h)};function F(v){for(var m=v.g.length+1,x=[],S=0;S<m;S++)x[S]=v.i(S)<<1|v.i(S-1)>>>31;return new a(x,v.h)}function L(v,m){var x=m>>5;m%=32;for(var S=v.g.length-x,A=[],R=0;R<S;R++)A[R]=0<m?v.i(R+x)>>>m|v.i(R+x+1)<<32-m:v.i(R+x);return new a(A,v.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,v0=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,li=a}).apply(typeof rm<"u"?rm:typeof self<"u"?self:typeof window<"u"?window:{});var Oa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _0,Ys,x0,el,ud,w0,S0,E0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,f){return o==Array.prototype||o==Object.prototype||(o[c]=f.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Oa=="object"&&Oa];for(var c=0;c<o.length;++c){var f=o[c];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function i(o,c){if(c)e:{var f=r;o=o.split(".");for(var _=0;_<o.length-1;_++){var b=o[_];if(!(b in f))break e;f=f[b]}o=o[o.length-1],_=f[o],c=c(_),c!=_&&c!=null&&e(f,o,{configurable:!0,writable:!0,value:c})}}function s(o,c){o instanceof String&&(o+="");var f=0,_=!1,b={next:function(){if(!_&&f<o.length){var j=f++;return{value:c(j,o[j]),done:!1}}return _=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}i("Array.prototype.values",function(o){return o||function(){return s(this,function(c,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function h(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function p(o,c,f){return o.call.apply(o.bind,arguments)}function g(o,c,f){if(!o)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,_),o.apply(c,b)}}return function(){return o.apply(c,arguments)}}function y(o,c,f){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,y.apply(null,arguments)}function E(o,c){var f=Array.prototype.slice.call(arguments,1);return function(){var _=f.slice();return _.push.apply(_,arguments),o.apply(this,_)}}function C(o,c){function f(){}f.prototype=c.prototype,o.aa=c.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(_,b,j){for(var Q=Array(arguments.length-2),Ce=2;Ce<arguments.length;Ce++)Q[Ce-2]=arguments[Ce];return c.prototype[b].apply(_,Q)}}function P(o){const c=o.length;if(0<c){const f=Array(c);for(let _=0;_<c;_++)f[_]=o[_];return f}return[]}function M(o,c){for(let f=1;f<arguments.length;f++){const _=arguments[f];if(u(_)){const b=o.length||0,j=_.length||0;o.length=b+j;for(let Q=0;Q<j;Q++)o[b+Q]=_[Q]}else o.push(_)}}class T{constructor(c,f){this.i=c,this.j=f,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function w(o){return/^[\s\xa0]*$/.test(o)}function k(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function V(o){return V[" "](o),o}V[" "]=function(){};var F=k().indexOf("Gecko")!=-1&&!(k().toLowerCase().indexOf("webkit")!=-1&&k().indexOf("Edge")==-1)&&!(k().indexOf("Trident")!=-1||k().indexOf("MSIE")!=-1)&&k().indexOf("Edge")==-1;function L(o,c,f){for(const _ in o)c.call(f,o[_],_,o)}function v(o,c){for(const f in o)c.call(void 0,o[f],f,o)}function m(o){const c={};for(const f in o)c[f]=o[f];return c}const x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(o,c){let f,_;for(let b=1;b<arguments.length;b++){_=arguments[b];for(f in _)o[f]=_[f];for(let j=0;j<x.length;j++)f=x[j],Object.prototype.hasOwnProperty.call(_,f)&&(o[f]=_[f])}}function A(o){var c=1;o=o.split(":");const f=[];for(;0<c&&o.length;)f.push(o.shift()),c--;return o.length&&f.push(o.join(":")),f}function R(o){l.setTimeout(()=>{throw o},0)}function I(){var o=O;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class se{constructor(){this.h=this.g=null}add(c,f){const _=ne.get();_.set(c,f),this.h?this.h.next=_:this.g=_,this.h=_}}var ne=new T(()=>new ie,o=>o.reset());class ie{constructor(){this.next=this.g=this.h=null}set(c,f){this.h=c,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let $,N=!1,O=new se,G=()=>{const o=l.Promise.resolve(void 0);$=()=>{o.then(Z)}};var Z=()=>{for(var o;o=I();){try{o.h.call(o.g)}catch(f){R(f)}var c=ne;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}N=!1};function ee(){this.s=this.s,this.C=this.C}ee.prototype.s=!1,ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function le(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}le.prototype.h=function(){this.defaultPrevented=!0};var Ae=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};l.addEventListener("test",f,c),l.removeEventListener("test",f,c)}catch{}return o}();function we(o,c){if(le.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,_=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(F){e:{try{V(c.nodeName);var b=!0;break e}catch{}b=!1}b||(c=null)}}else f=="mouseover"?c=o.fromElement:f=="mouseout"&&(c=o.toElement);this.relatedTarget=c,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:pe[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&we.aa.h.call(this)}}C(we,le);var pe={2:"touch",3:"pen",4:"mouse"};we.prototype.h=function(){we.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),Fe=0;function Se(o,c,f,_,b){this.listener=o,this.proxy=null,this.src=c,this.type=f,this.capture=!!_,this.ha=b,this.key=++Fe,this.da=this.fa=!1}function te(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function ke(o){this.src=o,this.g={},this.h=0}ke.prototype.add=function(o,c,f,_,b){var j=o.toString();o=this.g[j],o||(o=this.g[j]=[],this.h++);var Q=Re(o,c,_,b);return-1<Q?(c=o[Q],f||(c.fa=!1)):(c=new Se(c,this.src,j,!!_,b),c.fa=f,o.push(c)),c};function ze(o,c){var f=c.type;if(f in o.g){var _=o.g[f],b=Array.prototype.indexOf.call(_,c,void 0),j;(j=0<=b)&&Array.prototype.splice.call(_,b,1),j&&(te(c),o.g[f].length==0&&(delete o.g[f],o.h--))}}function Re(o,c,f,_){for(var b=0;b<o.length;++b){var j=o[b];if(!j.da&&j.listener==c&&j.capture==!!f&&j.ha==_)return b}return-1}var wt="closure_lm_"+(1e6*Math.random()|0),qt={};function Gt(o,c,f,_,b){if(Array.isArray(c)){for(var j=0;j<c.length;j++)Gt(o,c[j],f,_,b);return null}return f=ta(f),o&&o[de]?o.K(c,f,h(_)?!!_.capture:!1,b):Qt(o,c,f,!1,_,b)}function Qt(o,c,f,_,b,j){if(!c)throw Error("Invalid event type");var Q=h(b)?!!b.capture:!!b,Ce=Pe(o);if(Ce||(o[wt]=Ce=new ke(o)),f=Ce.add(c,f,_,Q,j),f.proxy)return f;if(_=Kt(),f.proxy=_,_.src=o,_.listener=f,o.addEventListener)Ae||(b=Q),b===void 0&&(b=!1),o.addEventListener(c.toString(),_,b);else if(o.attachEvent)o.attachEvent(bn(c.toString()),_);else if(o.addListener&&o.removeListener)o.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Kt(){function o(f){return c.call(o.src,o.listener,f)}const c=cr;return o}function lr(o,c,f,_,b){if(Array.isArray(c))for(var j=0;j<c.length;j++)lr(o,c[j],f,_,b);else _=h(_)?!!_.capture:!!_,f=ta(f),o&&o[de]?(o=o.i,c=String(c).toString(),c in o.g&&(j=o.g[c],f=Re(j,f,_,b),-1<f&&(te(j[f]),Array.prototype.splice.call(j,f,1),j.length==0&&(delete o.g[c],o.h--)))):o&&(o=Pe(o))&&(c=o.g[c.toString()],o=-1,c&&(o=Re(c,f,_,b)),(f=-1<o?c[o]:null)&&ur(f))}function ur(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[de])ze(c.i,o);else{var f=o.type,_=o.proxy;c.removeEventListener?c.removeEventListener(f,_,o.capture):c.detachEvent?c.detachEvent(bn(f),_):c.addListener&&c.removeListener&&c.removeListener(_),(f=Pe(c))?(ze(f,o),f.h==0&&(f.src=null,c[wt]=null)):te(o)}}}function bn(o){return o in qt?qt[o]:qt[o]="on"+o}function cr(o,c){if(o.da)o=!0;else{c=new we(c,this);var f=o.listener,_=o.ha||o.src;o.fa&&ur(o),o=f.call(_,c)}return o}function Pe(o){return o=o[wt],o instanceof ke?o:null}var As="__closure_events_fn_"+(1e9*Math.random()>>>0);function ta(o){return typeof o=="function"?o:(o[As]||(o[As]=function(c){return o.handleEvent(c)}),o[As])}function it(){ee.call(this),this.i=new ke(this),this.M=this,this.F=null}C(it,ee),it.prototype[de]=!0,it.prototype.removeEventListener=function(o,c,f,_){lr(this,o,c,f,_)};function Qe(o,c){var f,_=o.F;if(_)for(f=[];_;_=_.F)f.push(_);if(o=o.M,_=c.type||c,typeof c=="string")c=new le(c,o);else if(c instanceof le)c.target=c.target||o;else{var b=c;c=new le(_,o),S(c,b)}if(b=!0,f)for(var j=f.length-1;0<=j;j--){var Q=c.g=f[j];b=dr(Q,_,!0,c)&&b}if(Q=c.g=o,b=dr(Q,_,!0,c)&&b,b=dr(Q,_,!1,c)&&b,f)for(j=0;j<f.length;j++)Q=c.g=f[j],b=dr(Q,_,!1,c)&&b}it.prototype.N=function(){if(it.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var f=o.g[c],_=0;_<f.length;_++)te(f[_]);delete o.g[c],o.h--}}this.F=null},it.prototype.K=function(o,c,f,_){return this.i.add(String(o),c,!1,f,_)},it.prototype.L=function(o,c,f,_){return this.i.add(String(o),c,!0,f,_)};function dr(o,c,f,_){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var b=!0,j=0;j<c.length;++j){var Q=c[j];if(Q&&!Q.da&&Q.capture==f){var Ce=Q.listener,ft=Q.ha||Q.src;Q.fa&&ze(o.i,Q),b=Ce.call(ft,_)!==!1&&b}}return b&&!_.defaultPrevented}function wi(o,c,f){if(typeof o=="function")f&&(o=y(o,f));else if(o&&typeof o.handleEvent=="function")o=y(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(o,c||0)}function na(o){o.g=wi(()=>{o.g=null,o.i&&(o.i=!1,na(o))},o.l);const c=o.h;o.h=null,o.m.apply(null,c)}class Ee extends ee{constructor(c,f){super(),this.m=c,this.l=f,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:na(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ln(o){ee.call(this),this.h=o,this.g={}}C(ln,ee);var Hr=[];function Si(o){L(o.g,function(c,f){this.g.hasOwnProperty(f)&&ur(c)},o),o.g={}}ln.prototype.N=function(){ln.aa.N.call(this),Si(this)},ln.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ra=l.JSON.stringify,ia=l.JSON.parse,df=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function Ei(){}Ei.prototype.h=null;function ht(o){return o.h||(o.h=o.i())}function sa(){}var Yt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function qr(){le.call(this,"d")}C(qr,le);function Bn(){le.call(this,"c")}C(Bn,le);var Dn={},oa=null;function Ti(){return oa=oa||new it}Dn.La="serverreachability";function yu(o){le.call(this,Dn.La,o)}C(yu,le);function Ii(o){const c=Ti();Qe(c,new yu(c))}Dn.STAT_EVENT="statevent";function Ci(o,c){le.call(this,Dn.STAT_EVENT,o),this.stat=c}C(Ci,le);function Ke(o){const c=Ti();Qe(c,new Ci(c,o))}Dn.Ma="timingevent";function Ai(o,c){le.call(this,Dn.Ma,o),this.size=c}C(Ai,le);function hr(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},c)}function Gr(){this.g=!0}Gr.prototype.xa=function(){this.g=!1};function vu(o,c,f,_,b,j){o.info(function(){if(o.g)if(j)for(var Q="",Ce=j.split("&"),ft=0;ft<Ce.length;ft++){var _e=Ce[ft].split("=");if(1<_e.length){var Et=_e[0];_e=_e[1];var Tt=Et.split("_");Q=2<=Tt.length&&Tt[1]=="type"?Q+(Et+"="+_e+"&"):Q+(Et+"=redacted&")}}else Q=null;else Q=j;return"XMLHTTP REQ ("+_+") [attempt "+b+"]: "+c+`
`+f+`
`+Q})}function Qr(o,c,f,_,b,j,Q){o.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+b+"]: "+c+`
`+f+`
`+j+" "+Q})}function Xt(o,c,f,_){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+aa(o,f)+(_?" "+_:"")})}function _u(o,c){o.info(function(){return"TIMEOUT: "+c})}Gr.prototype.info=function(){};function aa(o,c){if(!o.g)return c;if(!c)return null;try{var f=JSON.parse(c);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var _=f[o];if(!(2>_.length)){var b=_[1];if(Array.isArray(b)&&!(1>b.length)){var j=b[0];if(j!="noop"&&j!="stop"&&j!="close")for(var Q=1;Q<b.length;Q++)b[Q]=""}}}}return ra(f)}catch{return c}}var Kr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ks={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Rs;function ki(){}C(ki,Ei),ki.prototype.g=function(){return new XMLHttpRequest},ki.prototype.i=function(){return{}},Rs=new ki;function un(o,c,f,_){this.j=o,this.i=c,this.l=f,this.R=_||1,this.U=new ln(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ri}function Ri(){this.i=null,this.g="",this.h=!1}var yn={},fr={};function vn(o,c,f){o.L=1,o.v=ha(Un(c)),o.m=f,o.P=!0,la(o,null)}function la(o,c){o.F=Date.now(),H(o),o.A=Un(o.v);var f=o.A,_=o.R;Array.isArray(_)||(_=[String(_)]),gf(f.i,"t",_),o.C=0,f=o.j.J,o.h=new Ri,o.g=jf(o.j,f?c:null,!o.m),0<o.O&&(o.M=new Ee(y(o.Y,o,o.g),o.O)),c=o.U,f=o.g,_=o.ca;var b="readystatechange";Array.isArray(b)||(b&&(Hr[0]=b.toString()),b=Hr);for(var j=0;j<b.length;j++){var Q=Gt(f,b[j],_||c.handleEvent,!1,c.h||c);if(!Q)break;c.g[Q.key]=Q}c=o.H?m(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),Ii(),vu(o.i,o.u,o.A,o.l,o.R,o.m)}un.prototype.ca=function(o){o=o.target;const c=this.M;c&&$n(o)==3?c.j():this.Y(o)},un.prototype.Y=function(o){try{if(o==this.g)e:{const Tt=$n(this.g);var c=this.g.Ba();const ji=this.g.Z();if(!(3>Tt)&&(Tt!=3||this.g&&(this.h.h||this.g.oa()||Ef(this.g)))){this.J||Tt!=4||c==7||(c==8||0>=ji?Ii(3):Ii(2)),he(this);var f=this.g.Z();this.X=f;t:if(q(this)){var _=Ef(this.g);o="";var b=_.length,j=$n(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Le(this),Me(this);var Q="";break t}this.h.i=new l.TextDecoder}for(c=0;c<b;c++)this.h.h=!0,o+=this.h.i.decode(_[c],{stream:!(j&&c==b-1)});_.length=0,this.h.g+=o,this.C=0,Q=this.h.g}else Q=this.g.oa();if(this.o=f==200,Qr(this.i,this.u,this.A,this.l,this.R,Tt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Ce,ft=this.g;if((Ce=ft.g?ft.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Ce)){var _e=Ce;break t}}_e=null}if(f=_e)Xt(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,He(this,f);else{this.o=!1,this.s=3,Ke(12),Le(this),Me(this);break e}}if(this.P){f=!0;let _n;for(;!this.J&&this.C<Q.length;)if(_n=B(this,Q),_n==fr){Tt==4&&(this.s=4,Ke(14),f=!1),Xt(this.i,this.l,null,"[Incomplete Response]");break}else if(_n==yn){this.s=4,Ke(15),Xt(this.i,this.l,Q,"[Invalid Chunk]"),f=!1;break}else Xt(this.i,this.l,_n,null),He(this,_n);if(q(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Tt!=4||Q.length!=0||this.h.h||(this.s=1,Ke(16),f=!1),this.o=this.o&&f,!f)Xt(this.i,this.l,Q,"[Invalid Chunked Response]"),Le(this),Me(this);else if(0<Q.length&&!this.W){this.W=!0;var Et=this.j;Et.g==this&&Et.ba&&!Et.M&&(Et.j.info("Great, no buffering proxy detected. Bytes received: "+Q.length),Eu(Et),Et.M=!0,Ke(11))}}else Xt(this.i,this.l,Q,null),He(this,Q);Tt==4&&Le(this),this.o&&!this.J&&(Tt==4?Pf(this.j,this):(this.o=!1,H(this)))}else r_(this.g),f==400&&0<Q.indexOf("Unknown SID")?(this.s=3,Ke(12)):(this.s=0,Ke(13)),Le(this),Me(this)}}}catch{}finally{}};function q(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function B(o,c){var f=o.C,_=c.indexOf(`
`,f);return _==-1?fr:(f=Number(c.substring(f,_)),isNaN(f)?yn:(_+=1,_+f>c.length?fr:(c=c.slice(_,_+f),o.C=_+f,c)))}un.prototype.cancel=function(){this.J=!0,Le(this)};function H(o){o.S=Date.now()+o.I,X(o,o.I)}function X(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=hr(y(o.ba,o),c)}function he(o){o.B&&(l.clearTimeout(o.B),o.B=null)}un.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(_u(this.i,this.A),this.L!=2&&(Ii(),Ke(17)),Le(this),this.s=2,Me(this)):X(this,this.S-o)};function Me(o){o.j.G==0||o.J||Pf(o.j,o)}function Le(o){he(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,Si(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function He(o,c){try{var f=o.j;if(f.G!=0&&(f.g==o||Yr(f.h,o))){if(!o.K&&Yr(f.h,o)&&f.G==3){try{var _=f.Da.g.parse(c)}catch{_=null}if(Array.isArray(_)&&_.length==3){var b=_;if(b[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)va(f),ga(f);else break e;Su(f),Ke(18)}}else f.za=b[1],0<f.za-f.T&&37500>b[2]&&f.F&&f.v==0&&!f.C&&(f.C=hr(y(f.Za,f),6e3));if(1>=lt(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Jr(f,11)}else if((o.K||f.g==o)&&va(f),!w(c))for(b=f.Da.g.parse(c),c=0;c<b.length;c++){let _e=b[c];if(f.T=_e[0],_e=_e[1],f.G==2)if(_e[0]=="c"){f.K=_e[1],f.ia=_e[2];const Et=_e[3];Et!=null&&(f.la=Et,f.j.info("VER="+f.la));const Tt=_e[4];Tt!=null&&(f.Aa=Tt,f.j.info("SVER="+f.Aa));const ji=_e[5];ji!=null&&typeof ji=="number"&&0<ji&&(_=1.5*ji,f.L=_,f.j.info("backChannelRequestTimeoutMs_="+_)),_=f;const _n=o.g;if(_n){const xa=_n.g?_n.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xa){var j=_.h;j.g||xa.indexOf("spdy")==-1&&xa.indexOf("quic")==-1&&xa.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(Ot(j,j.h),j.h=null))}if(_.D){const Tu=_n.g?_n.g.getResponseHeader("X-HTTP-Session-Id"):null;Tu&&(_.ya=Tu,De(_.I,_.D,Tu))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),_=f;var Q=o;if(_.qa=Nf(_,_.J?_.ia:null,_.W),Q.K){Pi(_.h,Q);var Ce=Q,ft=_.L;ft&&(Ce.I=ft),Ce.B&&(he(Ce),H(Ce)),_.g=Q}else kf(_);0<f.i.length&&ya(f)}else _e[0]!="stop"&&_e[0]!="close"||Jr(f,7);else f.G==3&&(_e[0]=="stop"||_e[0]=="close"?_e[0]=="stop"?Jr(f,7):wu(f):_e[0]!="noop"&&f.l&&f.l.ta(_e),f.v=0)}}Ii(4)}catch{}}var St=class{constructor(o,c){this.g=o,this.map=c}};function Dt(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function cn(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function lt(o){return o.h?1:o.g?o.g.size:0}function Yr(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function Ot(o,c){o.g?o.g.add(c):o.h=c}function Pi(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Dt.prototype.cancel=function(){if(this.i=oe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function oe(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(const f of o.g.values())c=c.concat(f.D);return c}return P(o.i)}function Ye(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var c=[],f=o.length,_=0;_<f;_++)c.push(o[_]);return c}c=[],f=0;for(_ in o)c[f++]=o[_];return c}function Jt(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var c=[];o=o.length;for(var f=0;f<o;f++)c.push(f);return c}c=[],f=0;for(const _ in o)c[f++]=_;return c}}}function bi(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var f=Jt(o),_=Ye(o),b=_.length,j=0;j<b;j++)c.call(void 0,_[j],f&&f[j],o)}var ua=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wv(o,c){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var _=o[f].indexOf("="),b=null;if(0<=_){var j=o[f].substring(0,_);b=o[f].substring(_+1)}else j=o[f];c(j,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function Xr(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Xr){this.h=o.h,ca(this,o.j),this.o=o.o,this.g=o.g,da(this,o.s),this.l=o.l;var c=o.i,f=new Ds;f.i=c.i,c.g&&(f.g=new Map(c.g),f.h=c.h),hf(this,f),this.m=o.m}else o&&(c=String(o).match(ua))?(this.h=!1,ca(this,c[1]||"",!0),this.o=Ps(c[2]||""),this.g=Ps(c[3]||"",!0),da(this,c[4]),this.l=Ps(c[5]||"",!0),hf(this,c[6]||"",!0),this.m=Ps(c[7]||"")):(this.h=!1,this.i=new Ds(null,this.h))}Xr.prototype.toString=function(){var o=[],c=this.j;c&&o.push(bs(c,ff,!0),":");var f=this.g;return(f||c=="file")&&(o.push("//"),(c=this.o)&&o.push(bs(c,ff,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(bs(f,f.charAt(0)=="/"?Gv:qv,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",bs(f,Kv)),o.join("")};function Un(o){return new Xr(o)}function ca(o,c,f){o.j=f?Ps(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function da(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function hf(o,c,f){c instanceof Ds?(o.i=c,Yv(o.i,o.h)):(f||(c=bs(c,Qv)),o.i=new Ds(c,o.h))}function De(o,c,f){o.i.set(c,f)}function ha(o){return De(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Ps(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function bs(o,c,f){return typeof o=="string"?(o=encodeURI(o).replace(c,Hv),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Hv(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var ff=/[#\/\?@]/g,qv=/[#\?:]/g,Gv=/[#\?]/g,Qv=/[#\?@]/g,Kv=/#/g;function Ds(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function pr(o){o.g||(o.g=new Map,o.h=0,o.i&&Wv(o.i,function(c,f){o.add(decodeURIComponent(c.replace(/\+/g," ")),f)}))}t=Ds.prototype,t.add=function(o,c){pr(this),this.i=null,o=Di(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(c),this.h+=1,this};function pf(o,c){pr(o),c=Di(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function mf(o,c){return pr(o),c=Di(o,c),o.g.has(c)}t.forEach=function(o,c){pr(this),this.g.forEach(function(f,_){f.forEach(function(b){o.call(c,b,_,this)},this)},this)},t.na=function(){pr(this);const o=Array.from(this.g.values()),c=Array.from(this.g.keys()),f=[];for(let _=0;_<c.length;_++){const b=o[_];for(let j=0;j<b.length;j++)f.push(c[_])}return f},t.V=function(o){pr(this);let c=[];if(typeof o=="string")mf(this,o)&&(c=c.concat(this.g.get(Di(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)c=c.concat(o[f])}return c},t.set=function(o,c){return pr(this),this.i=null,o=Di(this,o),mf(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},t.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function gf(o,c,f){pf(o,c),0<f.length&&(o.i=null,o.g.set(Di(o,c),P(f)),o.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],c=Array.from(this.g.keys());for(var f=0;f<c.length;f++){var _=c[f];const j=encodeURIComponent(String(_)),Q=this.V(_);for(_=0;_<Q.length;_++){var b=j;Q[_]!==""&&(b+="="+encodeURIComponent(String(Q[_]))),o.push(b)}}return this.i=o.join("&")};function Di(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function Yv(o,c){c&&!o.j&&(pr(o),o.i=null,o.g.forEach(function(f,_){var b=_.toLowerCase();_!=b&&(pf(this,_),gf(this,b,f))},o)),o.j=c}function Xv(o,c){const f=new Gr;if(l.Image){const _=new Image;_.onload=E(mr,f,"TestLoadImage: loaded",!0,c,_),_.onerror=E(mr,f,"TestLoadImage: error",!1,c,_),_.onabort=E(mr,f,"TestLoadImage: abort",!1,c,_),_.ontimeout=E(mr,f,"TestLoadImage: timeout",!1,c,_),l.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=o}else c(!1)}function Jv(o,c){const f=new Gr,_=new AbortController,b=setTimeout(()=>{_.abort(),mr(f,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:_.signal}).then(j=>{clearTimeout(b),j.ok?mr(f,"TestPingServer: ok",!0,c):mr(f,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(b),mr(f,"TestPingServer: error",!1,c)})}function mr(o,c,f,_,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),_(f)}catch{}}function Zv(){this.g=new df}function e_(o,c,f){const _=f||"";try{bi(o,function(b,j){let Q=b;h(b)&&(Q=ra(b)),c.push(_+j+"="+encodeURIComponent(Q))})}catch(b){throw c.push(_+"type="+encodeURIComponent("_badmap")),b}}function fa(o){this.l=o.Ub||null,this.j=o.eb||!1}C(fa,Ei),fa.prototype.g=function(){return new pa(this.l,this.j)},fa.prototype.i=function(o){return function(){return o}}({});function pa(o,c){it.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(pa,it),t=pa.prototype,t.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,js(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ns(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,js(this)),this.g&&(this.readyState=3,js(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;yf(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function yf(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Ns(this):js(this),this.readyState==3&&yf(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,Ns(this))},t.Qa=function(o){this.g&&(this.response=o,Ns(this))},t.ga=function(){this.g&&Ns(this)};function Ns(o){o.readyState=4,o.l=null,o.j=null,o.v=null,js(o)}t.setRequestHeader=function(o,c){this.u.append(o,c)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],c=this.h.entries();for(var f=c.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=c.next();return o.join(`\r
`)};function js(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(pa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function vf(o){let c="";return L(o,function(f,_){c+=_,c+=":",c+=f,c+=`\r
`}),c}function xu(o,c,f){e:{for(_ in f){var _=!1;break e}_=!0}_||(f=vf(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):De(o,c,f))}function qe(o){it.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(qe,it);var t_=/^https?$/i,n_=["POST","PUT"];t=qe.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,c,f,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Rs.g(),this.v=this.o?ht(this.o):ht(Rs),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(j){_f(this,j);return}if(o=f||"",f=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var b in _)f.set(b,_[b]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const j of _.keys())f.set(j,_.get(j));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(f.keys()).find(j=>j.toLowerCase()=="content-type"),b=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(n_,c,void 0))||_||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,Q]of f)this.g.setRequestHeader(j,Q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Sf(this),this.u=!0,this.g.send(o),this.u=!1}catch(j){_f(this,j)}};function _f(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,xf(o),ma(o)}function xf(o){o.A||(o.A=!0,Qe(o,"complete"),Qe(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Qe(this,"complete"),Qe(this,"abort"),ma(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ma(this,!0)),qe.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?wf(this):this.bb())},t.bb=function(){wf(this)};function wf(o){if(o.h&&typeof a<"u"&&(!o.v[1]||$n(o)!=4||o.Z()!=2)){if(o.u&&$n(o)==4)wi(o.Ea,0,o);else if(Qe(o,"readystatechange"),$n(o)==4){o.h=!1;try{const Q=o.Z();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var f;if(!(f=c)){var _;if(_=Q===0){var b=String(o.D).match(ua)[1]||null;!b&&l.self&&l.self.location&&(b=l.self.location.protocol.slice(0,-1)),_=!t_.test(b?b.toLowerCase():"")}f=_}if(f)Qe(o,"complete"),Qe(o,"success");else{o.m=6;try{var j=2<$n(o)?o.g.statusText:""}catch{j=""}o.l=j+" ["+o.Z()+"]",xf(o)}}finally{ma(o)}}}}function ma(o,c){if(o.g){Sf(o);const f=o.g,_=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||Qe(o,"ready");try{f.onreadystatechange=_}catch{}}}function Sf(o){o.I&&(l.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function $n(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<$n(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),ia(c)}};function Ef(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function r_(o){const c={};o=(o.g&&2<=$n(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<o.length;_++){if(w(o[_]))continue;var f=A(o[_]);const b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const j=c[b]||[];c[b]=j,j.push(f)}v(c,function(_){return _.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vs(o,c,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||c}function Tf(o){this.Aa=0,this.i=[],this.j=new Gr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Vs("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Vs("baseRetryDelayMs",5e3,o),this.cb=Vs("retryDelaySeedMs",1e4,o),this.Wa=Vs("forwardChannelMaxRetries",2,o),this.wa=Vs("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Dt(o&&o.concurrentRequestLimit),this.Da=new Zv,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Tf.prototype,t.la=8,t.G=1,t.connect=function(o,c,f,_){Ke(0),this.W=o,this.H=c||{},f&&_!==void 0&&(this.H.OSID=f,this.H.OAID=_),this.F=this.X,this.I=Nf(this,null,this.W),ya(this)};function wu(o){if(If(o),o.G==3){var c=o.U++,f=Un(o.I);if(De(f,"SID",o.K),De(f,"RID",c),De(f,"TYPE","terminate"),Ms(o,f),c=new un(o,o.j,c),c.L=2,c.v=ha(Un(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=c.v,f=!0),f||(c.g=jf(c.j,null),c.g.ea(c.v)),c.F=Date.now(),H(c)}Df(o)}function ga(o){o.g&&(Eu(o),o.g.cancel(),o.g=null)}function If(o){ga(o),o.u&&(l.clearTimeout(o.u),o.u=null),va(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function ya(o){if(!cn(o.h)&&!o.s){o.s=!0;var c=o.Ga;$||G(),N||($(),N=!0),O.add(c,o),o.B=0}}function i_(o,c){return lt(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=hr(y(o.Ga,o,c),bf(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const b=new un(this,this.j,o);let j=this.o;if(this.S&&(j?(j=m(j),S(j,this.S)):j=this.S),this.m!==null||this.O||(b.H=j,j=null),this.P)e:{for(var c=0,f=0;f<this.i.length;f++){t:{var _=this.i[f];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(c+=_,4096<c){c=f;break e}if(c===4096||f===this.i.length-1){c=f+1;break e}}c=1e3}else c=1e3;c=Af(this,b,c),f=Un(this.I),De(f,"RID",o),De(f,"CVER",22),this.D&&De(f,"X-HTTP-Session-Id",this.D),Ms(this,f),j&&(this.O?c="headers="+encodeURIComponent(String(vf(j)))+"&"+c:this.m&&xu(f,this.m,j)),Ot(this.h,b),this.Ua&&De(f,"TYPE","init"),this.P?(De(f,"$req",c),De(f,"SID","null"),b.T=!0,vn(b,f,null)):vn(b,f,c),this.G=2}}else this.G==3&&(o?Cf(this,o):this.i.length==0||cn(this.h)||Cf(this))};function Cf(o,c){var f;c?f=c.l:f=o.U++;const _=Un(o.I);De(_,"SID",o.K),De(_,"RID",f),De(_,"AID",o.T),Ms(o,_),o.m&&o.o&&xu(_,o.m,o.o),f=new un(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),c&&(o.i=c.D.concat(o.i)),c=Af(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),Ot(o.h,f),vn(f,_,c)}function Ms(o,c){o.H&&L(o.H,function(f,_){De(c,_,f)}),o.l&&bi({},function(f,_){De(c,_,f)})}function Af(o,c,f){f=Math.min(o.i.length,f);var _=o.l?y(o.l.Na,o.l,o):null;e:{var b=o.i;let j=-1;for(;;){const Q=["count="+f];j==-1?0<f?(j=b[0].g,Q.push("ofs="+j)):j=0:Q.push("ofs="+j);let Ce=!0;for(let ft=0;ft<f;ft++){let _e=b[ft].g;const Et=b[ft].map;if(_e-=j,0>_e)j=Math.max(0,b[ft].g-100),Ce=!1;else try{e_(Et,Q,"req"+_e+"_")}catch{_&&_(Et)}}if(Ce){_=Q.join("&");break e}}}return o=o.i.splice(0,f),c.D=o,_}function kf(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;$||G(),N||($(),N=!0),O.add(c,o),o.v=0}}function Su(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=hr(y(o.Fa,o),bf(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,Rf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=hr(y(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ke(10),ga(this),Rf(this))};function Eu(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function Rf(o){o.g=new un(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=Un(o.qa);De(c,"RID","rpc"),De(c,"SID",o.K),De(c,"AID",o.T),De(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&De(c,"TO",o.ja),De(c,"TYPE","xmlhttp"),Ms(o,c),o.m&&o.o&&xu(c,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=ha(Un(c)),f.m=null,f.P=!0,la(f,o)}t.Za=function(){this.C!=null&&(this.C=null,ga(this),Su(this),Ke(19))};function va(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function Pf(o,c){var f=null;if(o.g==c){va(o),Eu(o),o.g=null;var _=2}else if(Yr(o.h,c))f=c.D,Pi(o.h,c),_=1;else return;if(o.G!=0){if(c.o)if(_==1){f=c.m?c.m.length:0,c=Date.now()-c.F;var b=o.B;_=Ti(),Qe(_,new Ai(_,f)),ya(o)}else kf(o);else if(b=c.s,b==3||b==0&&0<c.X||!(_==1&&i_(o,c)||_==2&&Su(o)))switch(f&&0<f.length&&(c=o.h,c.i=c.i.concat(f)),b){case 1:Jr(o,5);break;case 4:Jr(o,10);break;case 3:Jr(o,6);break;default:Jr(o,2)}}}function bf(o,c){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*c}function Jr(o,c){if(o.j.info("Error code "+c),c==2){var f=y(o.fb,o),_=o.Xa;const b=!_;_=new Xr(_||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ca(_,"https"),ha(_),b?Xv(_.toString(),f):Jv(_.toString(),f)}else Ke(2);o.G=0,o.l&&o.l.sa(c),Df(o),If(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Ke(2)):(this.j.info("Failed to ping google.com"),Ke(1))};function Df(o){if(o.G=0,o.ka=[],o.l){const c=oe(o.h);(c.length!=0||o.i.length!=0)&&(M(o.ka,c),M(o.ka,o.i),o.h.i.length=0,P(o.i),o.i.length=0),o.l.ra()}}function Nf(o,c,f){var _=f instanceof Xr?Un(f):new Xr(f);if(_.g!="")c&&(_.g=c+"."+_.g),da(_,_.s);else{var b=l.location;_=b.protocol,c=c?c+"."+b.hostname:b.hostname,b=+b.port;var j=new Xr(null);_&&ca(j,_),c&&(j.g=c),b&&da(j,b),f&&(j.l=f),_=j}return f=o.D,c=o.ya,f&&c&&De(_,f,c),De(_,"VER",o.la),Ms(o,_),_}function jf(o,c,f){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new qe(new fa({eb:f})):new qe(o.pa),c.Ha(o.J),c}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vf(){}t=Vf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function _a(){}_a.prototype.g=function(o,c){return new Zt(o,c)};function Zt(o,c){it.call(this),this.g=new Tf(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!w(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!w(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new Ni(this)}C(Zt,it),Zt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Zt.prototype.close=function(){wu(this.g)},Zt.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=ra(o),o=f);c.i.push(new St(c.Ya++,o)),c.G==3&&ya(c)},Zt.prototype.N=function(){this.g.l=null,delete this.j,wu(this.g),delete this.g,Zt.aa.N.call(this)};function Mf(o){qr.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(const f in c){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}C(Mf,qr);function Lf(){Bn.call(this),this.status=1}C(Lf,Bn);function Ni(o){this.g=o}C(Ni,Vf),Ni.prototype.ua=function(){Qe(this.g,"a")},Ni.prototype.ta=function(o){Qe(this.g,new Mf(o))},Ni.prototype.sa=function(o){Qe(this.g,new Lf)},Ni.prototype.ra=function(){Qe(this.g,"b")},_a.prototype.createWebChannel=_a.prototype.g,Zt.prototype.send=Zt.prototype.o,Zt.prototype.open=Zt.prototype.m,Zt.prototype.close=Zt.prototype.close,E0=function(){return new _a},S0=function(){return Ti()},w0=Dn,ud={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Kr.NO_ERROR=0,Kr.TIMEOUT=8,Kr.HTTP_ERROR=6,el=Kr,ks.COMPLETE="complete",x0=ks,sa.EventType=Yt,Yt.OPEN="a",Yt.CLOSE="b",Yt.ERROR="c",Yt.MESSAGE="d",it.prototype.listen=it.prototype.K,Ys=sa,qe.prototype.listenOnce=qe.prototype.L,qe.prototype.getLastError=qe.prototype.Ka,qe.prototype.getLastErrorCode=qe.prototype.Ba,qe.prototype.getStatus=qe.prototype.Z,qe.prototype.getResponseJson=qe.prototype.Oa,qe.prototype.getResponseText=qe.prototype.oa,qe.prototype.send=qe.prototype.ea,qe.prototype.setWithCredentials=qe.prototype.Ha,_0=qe}).apply(typeof Oa<"u"?Oa:typeof self<"u"?self:typeof window<"u"?window:{});const im="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ft.UNAUTHENTICATED=new Ft(null),Ft.GOOGLE_CREDENTIALS=new Ft("google-credentials-uid"),Ft.FIRST_PARTY=new Ft("first-party-uid"),Ft.MOCK_USER=new Ft("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ss="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi=new d0("@firebase/firestore");function Hs(){return pi.logLevel}function J(t,...e){if(pi.logLevel<=ye.DEBUG){const n=e.map(kh);pi.debug(`Firestore (${Ss}): ${t}`,...n)}}function ir(t,...e){if(pi.logLevel<=ye.ERROR){const n=e.map(kh);pi.error(`Firestore (${Ss}): ${t}`,...n)}}function No(t,...e){if(pi.logLevel<=ye.WARN){const n=e.map(kh);pi.warn(`Firestore (${Ss}): ${t}`,...n)}}function kh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t="Unexpected state"){const e=`FIRESTORE (${Ss}) INTERNAL ASSERTION FAILED: `+t;throw ir(e),new Error(e)}function Ie(t,e){t||ae()}function ce(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class K extends ws{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class lS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ft.UNAUTHENTICATED))}shutdown(){}}class uS{constructor(e){this.t=e,this.currentUser=Ft.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ie(this.o===void 0);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let s=new Xn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Xn,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},l=u=>{J("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(J("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Xn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(J("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ie(typeof r.accessToken=="string"),new aS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ie(e===null||typeof e=="string"),new Ft(e)}}class cS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ft.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class dS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new cS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ft.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class hS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Ie(this.o===void 0);const r=s=>{s.error!=null&&J("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,J("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{J("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):J("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ie(typeof n.token=="string"),this.R=n.token,new hS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=pS(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function xe(t,e){return t<e?-1:t>e?1:0}function hs(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new K(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new K(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new K(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new K(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return at.fromMillis(Date.now())}static fromDate(e){return at.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new at(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ue(e)}static min(){return new ue(new at(0,0))}static max(){return new ue(new at(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(),r===void 0?r=e.length-n:r>e.length-n&&ae(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return jo.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof jo?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),a=n.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class je extends jo{construct(e,n,r){return new je(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new K(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new je(n)}static emptyPath(){return new je([])}}const mS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gt extends jo{construct(e,n,r){return new gt(e,n,r)}static isValidIdentifier(e){return mS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new gt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new K(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new K(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new K(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(r+=l,i++):(s(),i++)}if(s(),a)throw new K(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gt(n)}static emptyPath(){return new gt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.path=e}static fromPath(e){return new re(je.fromString(e))}static fromName(e){return new re(je.fromString(e).popFirst(5))}static empty(){return new re(je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return je.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new re(new je(e.slice()))}}function gS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ue.fromTimestamp(r===1e9?new at(n+1,0):new at(n,r));return new Or(i,re.empty(),e)}function yS(t){return new Or(t.readTime,t.key,-1)}class Or{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Or(ue.min(),re.empty(),-1)}static max(){return new Or(ue.max(),re.empty(),-1)}}function vS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=re.comparator(t.documentKey,e.documentKey),n!==0?n:xe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Go(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==_S)throw t;J("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let i=0,s=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++s,a&&s===i&&n()},u=>r(u))}),a=!0,s===i&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(i=>i?U.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new U((r,i)=>{const s=e.length,a=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;n(e[h]).next(p=>{a[h]=p,++l,l===s&&r(a)},p=>i(p))}})}static doWhile(e,n){return new U((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function wS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Qo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Rh.oe=-1;function nu(t){return t==null}function bl(t){return t===0&&1/t==-1/0}function SS(t){return typeof t=="number"&&Number.isInteger(t)&&!bl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sm(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function _i(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function I0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e,n){this.comparator=e,this.root=n||mt.EMPTY}insert(e,n){return new We(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,mt.BLACK,null,null))}remove(e){return new We(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fa(this.root,e,this.comparator,!0)}}class Fa{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??mt.RED,this.left=i??mt.EMPTY,this.right=s??mt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new mt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return mt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return mt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ae();const e=this.left.check();if(e!==this.right.check())throw ae();return e+(this.isRed()?0:1)}}mt.EMPTY=null,mt.RED=!0,mt.BLACK=!1;mt.EMPTY=new class{constructor(){this.size=0}get key(){throw ae()}get value(){throw ae()}get color(){throw ae()}get left(){throw ae()}get right(){throw ae()}copy(e,n,r,i,s){return this}insert(e,n,r){return new mt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.comparator=e,this.data=new We(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new om(this.data.getIterator())}getIteratorFrom(e){return new om(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof vt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new vt(this.comparator);return n.data=e,n}}class om{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.fields=e,e.sort(gt.comparator)}static empty(){return new nn([])}unionWith(e){let n=new vt(gt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new nn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return hs(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new C0("Invalid base64 string: "+s):s}}(e);return new xt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new xt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}xt.EMPTY_BYTE_STRING=new xt("");const ES=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fr(t){if(Ie(!!t),typeof t=="string"){let e=0;const n=ES.exec(t);if(Ie(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Xe(t.seconds),nanos:Xe(t.nanos)}}function Xe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function mi(t){return typeof t=="string"?xt.fromBase64String(t):xt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ph(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function bh(t){const e=t.mapValue.fields.__previous_value__;return Ph(e)?bh(e):e}function Vo(t){const e=Fr(t.mapValue.fields.__local_write_time__.timestampValue);return new at(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(e,n,r,i,s,a,l,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}}class Mo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Mo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Mo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const za={mapValue:{}};function gi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ph(t)?4:CS(t)?9007199254740991:IS(t)?10:11:ae()}function zn(t,e){if(t===e)return!0;const n=gi(t);if(n!==gi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Vo(t).isEqual(Vo(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Fr(i.timestampValue),l=Fr(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return mi(i.bytesValue).isEqual(mi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Xe(i.geoPointValue.latitude)===Xe(s.geoPointValue.latitude)&&Xe(i.geoPointValue.longitude)===Xe(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Xe(i.integerValue)===Xe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Xe(i.doubleValue),l=Xe(s.doubleValue);return a===l?bl(a)===bl(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return hs(t.arrayValue.values||[],e.arrayValue.values||[],zn);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(sm(a)!==sm(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!zn(a[u],l[u])))return!1;return!0}(t,e);default:return ae()}}function Lo(t,e){return(t.values||[]).find(n=>zn(n,e))!==void 0}function fs(t,e){if(t===e)return 0;const n=gi(t),r=gi(e);if(n!==r)return xe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xe(t.booleanValue,e.booleanValue);case 2:return function(s,a){const l=Xe(s.integerValue||s.doubleValue),u=Xe(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return am(t.timestampValue,e.timestampValue);case 4:return am(Vo(t),Vo(e));case 5:return xe(t.stringValue,e.stringValue);case 6:return function(s,a){const l=mi(s),u=mi(a);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const l=s.split("/"),u=a.split("/");for(let h=0;h<l.length&&h<u.length;h++){const p=xe(l[h],u[h]);if(p!==0)return p}return xe(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const l=xe(Xe(s.latitude),Xe(a.latitude));return l!==0?l:xe(Xe(s.longitude),Xe(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return lm(t.arrayValue,e.arrayValue);case 10:return function(s,a){var l,u,h,p;const g=s.fields||{},y=a.fields||{},E=(l=g.value)===null||l===void 0?void 0:l.arrayValue,C=(u=y.value)===null||u===void 0?void 0:u.arrayValue,P=xe(((h=E==null?void 0:E.values)===null||h===void 0?void 0:h.length)||0,((p=C==null?void 0:C.values)===null||p===void 0?void 0:p.length)||0);return P!==0?P:lm(E,C)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===za.mapValue&&a===za.mapValue)return 0;if(s===za.mapValue)return 1;if(a===za.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=a.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let g=0;g<u.length&&g<p.length;++g){const y=xe(u[g],p[g]);if(y!==0)return y;const E=fs(l[u[g]],h[p[g]]);if(E!==0)return E}return xe(u.length,p.length)}(t.mapValue,e.mapValue);default:throw ae()}}function am(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xe(t,e);const n=Fr(t),r=Fr(e),i=xe(n.seconds,r.seconds);return i!==0?i:xe(n.nanos,r.nanos)}function lm(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=fs(n[i],r[i]);if(s)return s}return xe(n.length,r.length)}function ps(t){return cd(t)}function cd(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Fr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return mi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return re.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=cd(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const a of r)s?s=!1:i+=",",i+=`${a}:${cd(n.fields[a])}`;return i+"}"}(t.mapValue):ae()}function um(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function dd(t){return!!t&&"integerValue"in t}function Dh(t){return!!t&&"arrayValue"in t}function cm(t){return!!t&&"nullValue"in t}function dm(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function tl(t){return!!t&&"mapValue"in t}function IS(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function uo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return _i(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=uo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=uo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function CS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.value=e}static empty(){return new Bt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!tl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=uo(n)}setAll(e){let n=gt.emptyPath(),r={},i=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=l.popLast()}a?r[l.lastSegment()]=uo(a):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());tl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return zn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];tl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){_i(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Bt(uo(this.value))}}function A0(t){const e=[];return _i(t.fields,(n,r)=>{const i=new gt([n]);if(tl(r)){const s=A0(r.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new nn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,n,r,i,s,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Rt(e,0,ue.min(),ue.min(),ue.min(),Bt.empty(),0)}static newFoundDocument(e,n,r,i){return new Rt(e,1,n,ue.min(),r,i,0)}static newNoDocument(e,n){return new Rt(e,2,n,ue.min(),ue.min(),Bt.empty(),0)}static newUnknownDocument(e,n){return new Rt(e,3,n,ue.min(),ue.min(),Bt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Rt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,n){this.position=e,this.inclusive=n}}function hm(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?r=re.comparator(re.fromName(a.referenceValue),n.key):r=fs(a,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function fm(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!zn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,n="asc"){this.field=e,this.dir=n}}function AS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{}class rt extends k0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new RS(e,n,r):n==="array-contains"?new DS(e,r):n==="in"?new NS(e,r):n==="not-in"?new jS(e,r):n==="array-contains-any"?new VS(e,r):new rt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new PS(e,r):new bS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(fs(n,this.value)):n!==null&&gi(this.value)===gi(n)&&this.matchesComparison(fs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pn extends k0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Pn(e,n)}matches(e){return R0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function R0(t){return t.op==="and"}function P0(t){return kS(t)&&R0(t)}function kS(t){for(const e of t.filters)if(e instanceof Pn)return!1;return!0}function hd(t){if(t instanceof rt)return t.field.canonicalString()+t.op.toString()+ps(t.value);if(P0(t))return t.filters.map(e=>hd(e)).join(",");{const e=t.filters.map(n=>hd(n)).join(",");return`${t.op}(${e})`}}function b0(t,e){return t instanceof rt?function(r,i){return i instanceof rt&&r.op===i.op&&r.field.isEqual(i.field)&&zn(r.value,i.value)}(t,e):t instanceof Pn?function(r,i){return i instanceof Pn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,l)=>s&&b0(a,i.filters[l]),!0):!1}(t,e):void ae()}function D0(t){return t instanceof rt?function(n){return`${n.field.canonicalString()} ${n.op} ${ps(n.value)}`}(t):t instanceof Pn?function(n){return n.op.toString()+" {"+n.getFilters().map(D0).join(" ,")+"}"}(t):"Filter"}class RS extends rt{constructor(e,n,r){super(e,n,r),this.key=re.fromName(r.referenceValue)}matches(e){const n=re.comparator(e.key,this.key);return this.matchesComparison(n)}}class PS extends rt{constructor(e,n){super(e,"in",n),this.keys=N0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class bS extends rt{constructor(e,n){super(e,"not-in",n),this.keys=N0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function N0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>re.fromName(r.referenceValue))}class DS extends rt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Dh(n)&&Lo(n.arrayValue,this.value)}}class NS extends rt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Lo(this.value.arrayValue,n)}}class jS extends rt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Lo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Lo(this.value.arrayValue,n)}}class VS extends rt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Dh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Lo(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,n=null,r=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.ue=null}}function pm(t,e=null,n=[],r=[],i=null,s=null,a=null){return new MS(t,e,n,r,i,s,a)}function Nh(t){const e=ce(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>hd(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),nu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ps(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ps(r)).join(",")),e.ue=n}return e.ue}function jh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!AS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!b0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!fm(t.startAt,e.startAt)&&fm(t.endAt,e.endAt)}function fd(t){return re.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e,n=null,r=[],i=[],s=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function LS(t,e,n,r,i,s,a,l){return new Ko(t,e,n,r,i,s,a,l)}function Vh(t){return new Ko(t)}function mm(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function j0(t){return t.collectionGroup!==null}function co(t){const e=ce(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new vt(gt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Nl(s,r))}),n.has(gt.keyField().canonicalString())||e.ce.push(new Nl(gt.keyField(),r))}return e.ce}function On(t){const e=ce(t);return e.le||(e.le=OS(e,co(t))),e.le}function OS(t,e){if(t.limitType==="F")return pm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Nl(i.field,s)});const n=t.endAt?new Dl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Dl(t.startAt.position,t.startAt.inclusive):null;return pm(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function pd(t,e){const n=t.filters.concat([e]);return new Ko(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function md(t,e,n){return new Ko(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ru(t,e){return jh(On(t),On(e))&&t.limitType===e.limitType}function V0(t){return`${Nh(On(t))}|lt:${t.limitType}`}function Mi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>D0(i)).join(", ")}]`),nu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>ps(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>ps(i)).join(",")),`Target(${r})`}(On(t))}; limitType=${t.limitType})`}function iu(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):re.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of co(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(a,l,u){const h=hm(a,l,u);return a.inclusive?h<=0:h<0}(r.startAt,co(r),i)||r.endAt&&!function(a,l,u){const h=hm(a,l,u);return a.inclusive?h>=0:h>0}(r.endAt,co(r),i))}(t,e)}function FS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function M0(t){return(e,n)=>{let r=!1;for(const i of co(t)){const s=zS(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function zS(t,e,n){const r=t.field.isKeyField()?re.comparator(e.key,n.key):function(s,a,l){const u=a.data.field(s),h=l.data.field(s);return u!==null&&h!==null?fs(u,h):ae()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){_i(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return I0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS=new We(re.comparator);function sr(){return BS}const L0=new We(re.comparator);function Xs(...t){let e=L0;for(const n of t)e=e.insert(n.key,n);return e}function O0(t){let e=L0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function si(){return ho()}function F0(){return ho()}function ho(){return new Es(t=>t.toString(),(t,e)=>t.isEqual(e))}const US=new We(re.comparator),$S=new vt(re.comparator);function me(...t){let e=$S;for(const n of t)e=e.add(n);return e}const WS=new vt(xe);function HS(){return WS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bl(e)?"-0":e}}function z0(t){return{integerValue:""+t}}function qS(t,e){return SS(e)?z0(e):Mh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(){this._=void 0}}function GS(t,e,n){return t instanceof Oo?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Ph(s)&&(s=bh(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(n,e):t instanceof Fo?U0(t,e):t instanceof zo?$0(t,e):function(i,s){const a=B0(i,s),l=gm(a)+gm(i.Pe);return dd(a)&&dd(i.Pe)?z0(l):Mh(i.serializer,l)}(t,e)}function QS(t,e,n){return t instanceof Fo?U0(t,e):t instanceof zo?$0(t,e):n}function B0(t,e){return t instanceof jl?function(r){return dd(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Oo extends su{}class Fo extends su{constructor(e){super(),this.elements=e}}function U0(t,e){const n=W0(e);for(const r of t.elements)n.some(i=>zn(i,r))||n.push(r);return{arrayValue:{values:n}}}class zo extends su{constructor(e){super(),this.elements=e}}function $0(t,e){let n=W0(e);for(const r of t.elements)n=n.filter(i=>!zn(i,r));return{arrayValue:{values:n}}}class jl extends su{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function gm(t){return Xe(t.integerValue||t.doubleValue)}function W0(t){return Dh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,n){this.field=e,this.transform=n}}function YS(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Fo&&i instanceof Fo||r instanceof zo&&i instanceof zo?hs(r.elements,i.elements,zn):r instanceof jl&&i instanceof jl?zn(r.Pe,i.Pe):r instanceof Oo&&i instanceof Oo}(t.transform,e.transform)}class XS{constructor(e,n){this.version=e,this.transformResults=n}}class An{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new An}static exists(e){return new An(void 0,e)}static updateTime(e){return new An(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ou{}function H0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new G0(t.key,An.none()):new Yo(t.key,t.data,An.none());{const n=t.data,r=Bt.empty();let i=new vt(gt.comparator);for(let s of e.fields)if(!i.has(s)){let a=n.field(s);a===null&&s.length>1&&(s=s.popLast(),a=n.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Wr(t.key,r,new nn(i.toArray()),An.none())}}function JS(t,e,n){t instanceof Yo?function(i,s,a){const l=i.value.clone(),u=vm(i.fieldTransforms,s,a.transformResults);l.setAll(u),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Wr?function(i,s,a){if(!nl(i.precondition,s))return void s.convertToUnknownDocument(a.version);const l=vm(i.fieldTransforms,s,a.transformResults),u=s.data;u.setAll(q0(i)),u.setAll(l),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function fo(t,e,n,r){return t instanceof Yo?function(s,a,l,u){if(!nl(s.precondition,a))return l;const h=s.value.clone(),p=_m(s.fieldTransforms,u,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof Wr?function(s,a,l,u){if(!nl(s.precondition,a))return l;const h=_m(s.fieldTransforms,u,a),p=a.data;return p.setAll(q0(s)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(s,a,l){return nl(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function ZS(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=B0(r.transform,i||null);s!=null&&(n===null&&(n=Bt.empty()),n.set(r.field,s))}return n||null}function ym(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&hs(r,i,(s,a)=>YS(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Yo extends ou{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Wr extends ou{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function q0(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function vm(t,e,n){const r=new Map;Ie(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],a=s.transform,l=e.data.field(s.field);r.set(s.field,QS(a,l,n[i]))}return r}function _m(t,e,n){const r=new Map;for(const i of t){const s=i.transform,a=n.data.field(i.field);r.set(i.field,GS(s,a,e))}return r}class G0 extends ou{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class eE extends ou{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&JS(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=fo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=fo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=F0();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=n.has(i.key)?null:l;const u=H0(a,l);u!==null&&r.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(ue.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),me())}isEqual(e){return this.batchId===e.batchId&&hs(this.mutations,e.mutations,(n,r)=>ym(n,r))&&hs(this.baseMutations,e.baseMutations,(n,r)=>ym(n,r))}}class Lh{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Ie(e.mutations.length===r.length);let i=function(){return US}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new Lh(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ze,ge;function iE(t){switch(t){default:return ae();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function Q0(t){if(t===void 0)return ir("GRPC error has no .code"),z.UNKNOWN;switch(t){case Ze.OK:return z.OK;case Ze.CANCELLED:return z.CANCELLED;case Ze.UNKNOWN:return z.UNKNOWN;case Ze.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case Ze.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case Ze.INTERNAL:return z.INTERNAL;case Ze.UNAVAILABLE:return z.UNAVAILABLE;case Ze.UNAUTHENTICATED:return z.UNAUTHENTICATED;case Ze.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case Ze.NOT_FOUND:return z.NOT_FOUND;case Ze.ALREADY_EXISTS:return z.ALREADY_EXISTS;case Ze.PERMISSION_DENIED:return z.PERMISSION_DENIED;case Ze.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case Ze.ABORTED:return z.ABORTED;case Ze.OUT_OF_RANGE:return z.OUT_OF_RANGE;case Ze.UNIMPLEMENTED:return z.UNIMPLEMENTED;case Ze.DATA_LOSS:return z.DATA_LOSS;default:return ae()}}(ge=Ze||(Ze={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oE=new li([4294967295,4294967295],0);function xm(t){const e=sE().encode(t),n=new v0;return n.update(e),new Uint8Array(n.digest())}function wm(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new li([n,r],0),new li([i,s],0)]}class Oh{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Js(`Invalid padding: ${n}`);if(r<0)throw new Js(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Js(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Js(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=li.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(li.fromNumber(r)));return i.compare(oE)===1&&(i=new li([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=xm(e),[r,i]=wm(n);for(let s=0;s<this.hashCount;s++){const a=this.Ee(r,i,s);if(!this.de(a))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Oh(s,i,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=xm(e),[r,i]=wm(n);for(let s=0;s<this.hashCount;s++){const a=this.Ee(r,i,s);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Js extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Xo.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new au(ue.min(),i,new We(xe),sr(),me())}}class Xo{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Xo(r,n,me(),me(),me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class K0{constructor(e,n){this.targetId=e,this.me=n}}class Y0{constructor(e,n,r=xt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Sm{constructor(){this.fe=0,this.ge=Tm(),this.pe=xt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=me(),n=me(),r=me();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ae()}}),new Xo(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Tm()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ie(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class aE{constructor(e){this.Le=e,this.Be=new Map,this.ke=sr(),this.qe=Em(),this.Qe=new We(xe)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ae()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(fd(s))if(r===0){const a=new re(s.path);this.Ue(n,a,Rt.newNoDocument(a,ue.min()))}else Ie(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),u=l?this.Xe(l,e,a):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let a,l;try{a=mi(r).toUint8Array()}catch(u){if(u instanceof C0)return No("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Oh(a,i,s)}catch(u){return No(u instanceof Js?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,a)=>{const l=this.Je(a);if(l){if(s.current&&fd(l.target)){const u=new re(l.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,Rt.newNoDocument(u,e))}s.be&&(n.set(a,s.ve()),s.Ce())}});let r=me();this.qe.forEach((s,a)=>{let l=!0;a.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new au(e,n,this.Qe,this.ke,r);return this.ke=sr(),this.qe=Em(),this.Qe=new We(xe),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Sm,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new vt(xe),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||J("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Sm),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Em(){return new We(re.comparator)}function Tm(){return new We(re.comparator)}const lE={asc:"ASCENDING",desc:"DESCENDING"},uE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cE={and:"AND",or:"OR"};class dE{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function gd(t,e){return t.useProto3Json||nu(e)?e:{value:e}}function Vl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function X0(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function hE(t,e){return Vl(t,e.toTimestamp())}function Fn(t){return Ie(!!t),ue.fromTimestamp(function(n){const r=Fr(n);return new at(r.seconds,r.nanos)}(t))}function Fh(t,e){return yd(t,e).canonicalString()}function yd(t,e){const n=function(i){return new je(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function J0(t){const e=je.fromString(t);return Ie(rv(e)),e}function vd(t,e){return Fh(t.databaseId,e.path)}function tc(t,e){const n=J0(e);if(n.get(1)!==t.databaseId.projectId)throw new K(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new K(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new re(ev(n))}function Z0(t,e){return Fh(t.databaseId,e)}function fE(t){const e=J0(t);return e.length===4?je.emptyPath():ev(e)}function _d(t){return new je(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ev(t){return Ie(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Im(t,e,n){return{name:vd(t,e),fields:n.value.mapValue.fields}}function pE(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,p){return h.useProto3Json?(Ie(p===void 0||typeof p=="string"),xt.fromBase64String(p||"")):(Ie(p===void 0||p instanceof Buffer||p instanceof Uint8Array),xt.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){const p=h.code===void 0?z.UNKNOWN:Q0(h.code);return new K(p,h.message||"")}(a);n=new Y0(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=tc(t,r.document.name),s=Fn(r.document.updateTime),a=r.document.createTime?Fn(r.document.createTime):ue.min(),l=new Bt({mapValue:{fields:r.document.fields}}),u=Rt.newFoundDocument(i,s,a,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new rl(h,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=tc(t,r.document),s=r.readTime?Fn(r.readTime):ue.min(),a=Rt.newNoDocument(i,s),l=r.removedTargetIds||[];n=new rl([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=tc(t,r.document),s=r.removedTargetIds||[];n=new rl([],s,i,null)}else{if(!("filter"in e))return ae();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,a=new rE(i,s),l=r.targetId;n=new K0(l,a)}}return n}function mE(t,e){let n;if(e instanceof Yo)n={update:Im(t,e.key,e.value)};else if(e instanceof G0)n={delete:vd(t,e.key)};else if(e instanceof Wr)n={update:Im(t,e.key,e.data),updateMask:TE(e.fieldMask)};else{if(!(e instanceof eE))return ae();n={verify:vd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,a){const l=a.transform;if(l instanceof Oo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Fo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof zo)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof jl)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw ae()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:hE(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ae()}(t,e.precondition)),n}function gE(t,e){return t&&t.length>0?(Ie(e!==void 0),t.map(n=>function(i,s){let a=i.updateTime?Fn(i.updateTime):Fn(s);return a.isEqual(ue.min())&&(a=Fn(s)),new XS(a,i.transformResults||[])}(n,e))):[]}function yE(t,e){return{documents:[Z0(t,e.path)]}}function vE(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Z0(t,i);const s=function(h){if(h.length!==0)return nv(Pn.create(h,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const a=function(h){if(h.length!==0)return h.map(p=>function(y){return{field:Li(y.field),direction:wE(y.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=gd(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:i}}function _E(t){let e=fE(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ie(r===1);const p=n.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];n.where&&(s=function(g){const y=tv(g);return y instanceof Pn&&P0(y)?y.getFilters():[y]}(n.where));let a=[];n.orderBy&&(a=function(g){return g.map(y=>function(C){return new Nl(Oi(C.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(y))}(n.orderBy));let l=null;n.limit&&(l=function(g){let y;return y=typeof g=="object"?g.value:g,nu(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(g){const y=!!g.before,E=g.values||[];return new Dl(E,y)}(n.startAt));let h=null;return n.endAt&&(h=function(g){const y=!g.before,E=g.values||[];return new Dl(E,y)}(n.endAt)),LS(e,i,a,s,l,"F",u,h)}function xE(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function tv(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Oi(n.unaryFilter.field);return rt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Oi(n.unaryFilter.field);return rt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Oi(n.unaryFilter.field);return rt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Oi(n.unaryFilter.field);return rt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ae()}}(t):t.fieldFilter!==void 0?function(n){return rt.create(Oi(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ae()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Pn.create(n.compositeFilter.filters.map(r=>tv(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ae()}}(n.compositeFilter.op))}(t):ae()}function wE(t){return lE[t]}function SE(t){return uE[t]}function EE(t){return cE[t]}function Li(t){return{fieldPath:t.canonicalString()}}function Oi(t){return gt.fromServerFormat(t.fieldPath)}function nv(t){return t instanceof rt?function(n){if(n.op==="=="){if(dm(n.value))return{unaryFilter:{field:Li(n.field),op:"IS_NAN"}};if(cm(n.value))return{unaryFilter:{field:Li(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(dm(n.value))return{unaryFilter:{field:Li(n.field),op:"IS_NOT_NAN"}};if(cm(n.value))return{unaryFilter:{field:Li(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Li(n.field),op:SE(n.op),value:n.value}}}(t):t instanceof Pn?function(n){const r=n.getFilters().map(i=>nv(i));return r.length===1?r[0]:{compositeFilter:{op:EE(n.op),filters:r}}}(t):ae()}function TE(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function rv(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,n,r,i,s=ue.min(),a=ue.min(),l=xt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Er(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(e){this.ct=e}}function CE(t){const e=_E({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?md(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(){this.un=new kE}addToCollectionParentIndex(e,n){return this.un.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(Or.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(Or.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class kE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new vt(je.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new vt(je.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ms(0)}static kn(){return new ms(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(){this.changes=new Es(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Rt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&fo(r.mutation,i,nn.empty(),at.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,me()).next(()=>r))}getLocalViewOfDocuments(e,n,r=me()){const i=si();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let a=Xs();return s.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=si();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,me()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,i){let s=sr();const a=ho(),l=function(){return ho()}();return n.forEach((u,h)=>{const p=r.get(h.key);i.has(h.key)&&(p===void 0||p.mutation instanceof Wr)?s=s.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),fo(p.mutation,h,p.mutation.getFieldMask(),at.now())):a.set(h.key,nn.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((h,p)=>a.set(h,p)),n.forEach((h,p)=>{var g;return l.set(h,new PE(p,(g=a.get(h))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=ho();let i=new We((a,l)=>a-l),s=me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let p=r.get(u)||nn.empty();p=l.applyToLocalView(h,p),r.set(u,p);const g=(i.get(l.batchId)||me()).add(u);i=i.insert(l.batchId,g)})}).next(()=>{const a=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,p=u.value,g=F0();p.forEach(y=>{if(!s.has(y)){const E=H0(n.get(y),r.get(y));E!==null&&g.set(y,E),s=s.add(y)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return U.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(a){return re.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):j0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):U.resolve(si());let l=-1,u=s;return a.next(h=>U.forEach(h,(p,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),s.get(p)?U.resolve():this.remoteDocumentCache.getEntry(e,p).next(y=>{u=u.insert(p,y)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,u,h,me())).next(p=>({batchId:l,changes:O0(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new re(n)).next(r=>{let i=Xs();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let a=Xs();return this.indexManager.getCollectionParents(e,s).next(l=>U.forEach(l,u=>{const h=function(g,y){return new Ko(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(p=>{p.forEach((g,y)=>{a=a.insert(g,y)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(a=>{s.forEach((u,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,Rt.newInvalidDocument(p)))});let l=Xs();return a.forEach((u,h)=>{const p=s.get(u);p!==void 0&&fo(p.mutation,h,nn.empty(),at.now()),iu(n,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return U.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Fn(i.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:CE(i.bundledQuery),readTime:Fn(i.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(){this.overlays=new We(re.comparator),this.Ir=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=si();return U.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const i=si(),s=n.length+1,a=new re(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return U.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new We((h,p)=>h-p);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=s.get(h.largestBatchId);p===null&&(p=si(),s=s.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=si(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=i)););return U.resolve(l)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new nE(n,r));let s=this.Ir.get(n);s===void 0&&(s=me(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(){this.sessionToken=xt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(){this.Tr=new vt(ut.Er),this.dr=new vt(ut.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new ut(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new ut(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new re(new je([])),r=new ut(n,e),i=new ut(n,e+1),s=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new re(new je([])),r=new ut(n,e),i=new ut(n,e+1);let s=me();return this.dr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){const n=new ut(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ut{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return re.comparator(e.key,n.key)||xe(e.wr,n.wr)}static Ar(e,n){return xe(e.wr,n.wr)||re.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new vt(ut.Er)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new tE(s,n,r,i);this.mutationQueue.push(a);for(const l of i)this.br=this.br.add(new ut(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(a)}lookupMutationBatch(e,n){return U.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return U.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ut(n,0),i=new ut(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],a=>{const l=this.Dr(a.wr);s.push(l)}),U.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new vt(xe);return n.forEach(i=>{const s=new ut(i,0),a=new ut(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],l=>{r=r.add(l.wr)})}),U.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;re.isDocumentKey(s)||(s=s.child(""));const a=new ut(new re(s),0);let l=new vt(xe);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(l=l.add(u.wr)),!0)},a),U.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Ie(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return U.forEach(n.mutations,i=>{const s=new ut(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new ut(n,0),i=this.br.firstAfterOrEqual(r);return U.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(e){this.Mr=e,this.docs=function(){return new We(re.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():Rt.newInvalidDocument(n))}getEntries(e,n){let r=sr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Rt.newInvalidDocument(i))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=sr();const a=n.path,l=new re(a.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||vS(yS(p),r)<=0||(i.has(p.key)||iu(n,p))&&(s=s.insert(p.key,p.mutableCopy()))}return U.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ae()}Or(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new LE(this)}getSize(e){return U.resolve(this.size)}}class LE extends RE{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e){this.persistence=e,this.Nr=new Es(n=>Nh(n),jh),this.lastRemoteSnapshotVersion=ue.min(),this.highestTargetId=0,this.Lr=0,this.Br=new zh,this.targetCount=0,this.kr=ms.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),U.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ms(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Kn(n),U.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),U.waitFor(s).next(()=>i)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),U.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Rh(0),this.Kr=!1,this.Kr=!0,this.$r=new jE,this.referenceDelegate=e(this),this.Ur=new OE(this),this.indexManager=new AE,this.remoteDocumentCache=function(i){return new ME(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new IE(n),this.Gr=new DE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new NE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new VE(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){J("MemoryPersistence","Starting transaction:",e);const i=new zE(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return U.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class zE extends xS{constructor(e){super(),this.currentSequenceNumber=e}}class Bh{constructor(e){this.persistence=e,this.Jr=new zh,this.Yr=null}static Zr(e){return new Bh(e)}get Xr(){if(this.Yr)return this.Yr;throw ae()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),U.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.Xr,r=>{const i=re.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,ue.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return U.or([()=>U.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=me(),i=me();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Uh(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return W1()?8:wS(U1())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new BE;return this.Xi(e,n,a).next(l=>{if(s.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Hs()<=ye.DEBUG&&J("QueryEngine","SDK will not create cache indexes for query:",Mi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),U.resolve()):(Hs()<=ye.DEBUG&&J("QueryEngine","Query:",Mi(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Hs()<=ye.DEBUG&&J("QueryEngine","The SDK decides to create cache indexes for query:",Mi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,On(n))):U.resolve())}Yi(e,n){if(mm(n))return U.resolve(null);let r=On(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=md(n,null,"F"),r=On(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const a=me(...s);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,l);return this.ns(n,h,a,u.readTime)?this.Yi(e,md(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,i){return mm(n)||i.isEqual(ue.min())?U.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const a=this.ts(n,s);return this.ns(n,a,r,i)?U.resolve(null):(Hs()<=ye.DEBUG&&J("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Mi(n)),this.rs(e,a,n,gS(i,-1)).next(l=>l))})}ts(e,n){let r=new vt(M0(e));return n.forEach((i,s)=>{iu(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return Hs()<=ye.DEBUG&&J("QueryEngine","Using full collection scan to execute query:",Mi(n)),this.Ji.getDocumentsMatchingQuery(e,n,Or.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new We(xe),this._s=new Es(s=>Nh(s),jh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function WE(t,e,n,r){return new $E(t,e,n,r)}async function iv(t,e){const n=ce(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const a=[],l=[];let u=me();for(const h of i){a.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of s){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:a,addedBatchIds:l}))})})}function HE(t,e){const n=ce(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,h,p){const g=h.batch,y=g.keys();let E=U.resolve();return y.forEach(C=>{E=E.next(()=>p.getEntry(u,C)).next(P=>{const M=h.docVersions.get(C);Ie(M!==null),P.version.compareTo(M)<0&&(g.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),p.addEntry(P)))})}),E.next(()=>l.mutationQueue.removeMutationBatch(u,g))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=me();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function sv(t){const e=ce(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function qE(t,e){const n=ce(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const l=[];e.targetChanges.forEach((p,g)=>{const y=i.get(g);if(!y)return;l.push(n.Ur.removeMatchingKeys(s,p.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(s,p.addedDocuments,g)));let E=y.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?E=E.withResumeToken(xt.EMPTY_BYTE_STRING,ue.min()).withLastLimboFreeSnapshotVersion(ue.min()):p.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(p.resumeToken,r)),i=i.insert(g,E),function(P,M,T){return P.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(y,E,p)&&l.push(n.Ur.updateTargetData(s,E))});let u=sr(),h=me();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(GE(s,a,e.documentUpdates).next(p=>{u=p.Ps,h=p.Is})),!r.isEqual(ue.min())){const p=n.Ur.getLastRemoteSnapshotVersion(s).next(g=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(p)}return U.waitFor(l).next(()=>a.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,h)).next(()=>u)}).then(s=>(n.os=i,s))}function GE(t,e,n){let r=me(),i=me();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let a=sr();return n.forEach((l,u)=>{const h=s.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(ue.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):J("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ps:a,Is:i}})}function QE(t,e){const n=ce(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function KE(t,e){const n=ce(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,U.resolve(i)):n.Ur.allocateTargetId(r).next(a=>(i=new Er(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function xd(t,e,n){const r=ce(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Qo(a))throw a;J("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Cm(t,e,n){const r=ce(t);let i=ue.min(),s=me();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,p){const g=ce(u),y=g._s.get(p);return y!==void 0?U.resolve(g.os.get(y)):g.Ur.getTargetData(h,p)}(r,a,On(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(u=>{s=u})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?i:ue.min(),n?s:me())).next(l=>(YE(r,FS(e),l),{documents:l,Ts:s})))}function YE(t,e,n){let r=t.us.get(e)||ue.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class Am{constructor(){this.activeTargetIds=HS()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class XE{constructor(){this.so=new Am,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Am,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){J("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){J("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ba=null;function nc(){return Ba===null?Ba=function(){return 268435456+Math.round(2147483648*Math.random())}():Ba++,"0x"+Ba.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const At="WebChannelConnection";class tT extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,a){const l=nc(),u=this.xo(n,r.toUriEncodedString());J("RestConnection",`Sending RPC '${n}' ${l}:`,u,i);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,s,a),this.No(n,u,h,i).then(p=>(J("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw No("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",u,"request:",i),p})}Lo(n,r,i,s,a,l){return this.Mo(n,r,i,s,a)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ss}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>n[a]=s),i&&i.headers.forEach((s,a)=>n[a]=s)}xo(n,r){const i=ZE[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=nc();return new Promise((a,l)=>{const u=new _0;u.setWithCredentials(!0),u.listenOnce(x0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case el.NO_ERROR:const p=u.getResponseJson();J(At,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case el.TIMEOUT:J(At,`RPC '${e}' ${s} timed out`),l(new K(z.DEADLINE_EXCEEDED,"Request time out"));break;case el.HTTP_ERROR:const g=u.getStatus();if(J(At,`RPC '${e}' ${s} failed with status:`,g,"response text:",u.getResponseText()),g>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const E=y==null?void 0:y.error;if(E&&E.status&&E.message){const C=function(M){const T=M.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(T)>=0?T:z.UNKNOWN}(E.status);l(new K(C,E.message))}else l(new K(z.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new K(z.UNAVAILABLE,"Connection failed."));break;default:ae()}}finally{J(At,`RPC '${e}' ${s} completed.`)}});const h=JSON.stringify(i);J(At,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const i=nc(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=E0(),l=S0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const p=s.join("");J(At,`Creating RPC '${e}' stream ${i}: ${p}`,u);const g=a.createWebChannel(p,u);let y=!1,E=!1;const C=new eT({Io:M=>{E?J(At,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(y||(J(At,`Opening RPC '${e}' stream ${i} transport.`),g.open(),y=!0),J(At,`RPC '${e}' stream ${i} sending:`,M),g.send(M))},To:()=>g.close()}),P=(M,T,w)=>{M.listen(T,k=>{try{w(k)}catch(V){setTimeout(()=>{throw V},0)}})};return P(g,Ys.EventType.OPEN,()=>{E||(J(At,`RPC '${e}' stream ${i} transport opened.`),C.yo())}),P(g,Ys.EventType.CLOSE,()=>{E||(E=!0,J(At,`RPC '${e}' stream ${i} transport closed`),C.So())}),P(g,Ys.EventType.ERROR,M=>{E||(E=!0,No(At,`RPC '${e}' stream ${i} transport errored:`,M),C.So(new K(z.UNAVAILABLE,"The operation could not be completed")))}),P(g,Ys.EventType.MESSAGE,M=>{var T;if(!E){const w=M.data[0];Ie(!!w);const k=w,V=k.error||((T=k[0])===null||T===void 0?void 0:T.error);if(V){J(At,`RPC '${e}' stream ${i} received error:`,V);const F=V.status;let L=function(x){const S=Ze[x];if(S!==void 0)return Q0(S)}(F),v=V.message;L===void 0&&(L=z.INTERNAL,v="Unknown error status: "+F+" with message "+V.message),E=!0,C.So(new K(L,v)),g.close()}else J(At,`RPC '${e}' stream ${i} received:`,w),C.bo(w)}}),P(l,w0.STAT_EVENT,M=>{M.stat===ud.PROXY?J(At,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===ud.NOPROXY&&J(At,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{C.wo()},0),C}}function rc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lu(t){return new dE(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&J("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,n,r,i,s,a,l,u){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new ov(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(ir(n.toString()),ir("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new K(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return J("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(J("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nT extends av{constructor(e,n,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=pE(this.serializer,e),r=function(s){if(!("targetChange"in s))return ue.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?ue.min():a.readTime?Fn(a.readTime):ue.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=_d(this.serializer),n.addTarget=function(s,a){let l;const u=a.target;if(l=fd(u)?{documents:yE(s,u)}:{query:vE(s,u)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=X0(s,a.resumeToken);const h=gd(s,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(ue.min())>0){l.readTime=Vl(s,a.snapshotVersion.toTimestamp());const h=gd(s,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=xE(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=_d(this.serializer),n.removeTarget=e,this.a_(n)}}class rT extends av{constructor(e,n,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Ie(!!e.streamToken),this.lastStreamToken=e.streamToken,Ie(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ie(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=gE(e.writeResults,e.commitTime),r=Fn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=_d(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>mE(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new K(z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,yd(n,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new K(z.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,yd(n,r),i,a,l,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new K(z.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class sT{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ir(n),this.D_=!1):J("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{r.enqueueAndForget(async()=>{xi(this)&&(J("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=ce(u);h.L_.add(4),await Jo(h),h.q_.set("Unknown"),h.L_.delete(4),await uu(h)}(this))})}),this.q_=new sT(r,i)}}async function uu(t){if(xi(t))for(const e of t.B_)await e(!0)}async function Jo(t){for(const e of t.B_)await e(!1)}function lv(t,e){const n=ce(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),qh(n)?Hh(n):Ts(n).r_()&&Wh(n,e))}function $h(t,e){const n=ce(t),r=Ts(n);n.N_.delete(e),r.r_()&&uv(n,e),n.N_.size===0&&(r.r_()?r.o_():xi(n)&&n.q_.set("Unknown"))}function Wh(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ts(t).A_(e)}function uv(t,e){t.Q_.xe(e),Ts(t).R_(e)}function Hh(t){t.Q_=new aE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ts(t).start(),t.q_.v_()}function qh(t){return xi(t)&&!Ts(t).n_()&&t.N_.size>0}function xi(t){return ce(t).L_.size===0}function cv(t){t.Q_=void 0}async function aT(t){t.q_.set("Online")}async function lT(t){t.N_.forEach((e,n)=>{Wh(t,e)})}async function uT(t,e){cv(t),qh(t)?(t.q_.M_(e),Hh(t)):t.q_.set("Unknown")}async function cT(t,e,n){if(t.q_.set("Online"),e instanceof Y0&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,a),i.N_.delete(l),i.Q_.removeTarget(l))}(t,e)}catch(r){J("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ml(t,r)}else if(e instanceof rl?t.Q_.Ke(e):e instanceof K0?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ue.min()))try{const r=await sv(t.localStore);n.compareTo(r)>=0&&await function(s,a){const l=s.Q_.rt(a);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=s.N_.get(h);p&&s.N_.set(h,p.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,h)=>{const p=s.N_.get(u);if(!p)return;s.N_.set(u,p.withResumeToken(xt.EMPTY_BYTE_STRING,p.snapshotVersion)),uv(s,u);const g=new Er(p.target,u,h,p.sequenceNumber);Wh(s,g)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){J("RemoteStore","Failed to raise snapshot:",r),await Ml(t,r)}}async function Ml(t,e,n){if(!Qo(e))throw e;t.L_.add(1),await Jo(t),t.q_.set("Offline"),n||(n=()=>sv(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{J("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await uu(t)})}function dv(t,e){return e().catch(n=>Ml(t,n,e))}async function cu(t){const e=ce(t),n=zr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;dT(e);)try{const i=await QE(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,hT(e,i)}catch(i){await Ml(e,i)}hv(e)&&fv(e)}function dT(t){return xi(t)&&t.O_.length<10}function hT(t,e){t.O_.push(e);const n=zr(t);n.r_()&&n.V_&&n.m_(e.mutations)}function hv(t){return xi(t)&&!zr(t).n_()&&t.O_.length>0}function fv(t){zr(t).start()}async function fT(t){zr(t).p_()}async function pT(t){const e=zr(t);for(const n of t.O_)e.m_(n.mutations)}async function mT(t,e,n){const r=t.O_.shift(),i=Lh.from(r,e,n);await dv(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await cu(t)}async function gT(t,e){e&&zr(t).V_&&await async function(r,i){if(function(a){return iE(a)&&a!==z.ABORTED}(i.code)){const s=r.O_.shift();zr(r).s_(),await dv(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await cu(r)}}(t,e),hv(t)&&fv(t)}async function Rm(t,e){const n=ce(t);n.asyncQueue.verifyOperationInProgress(),J("RemoteStore","RemoteStore received new credentials");const r=xi(n);n.L_.add(3),await Jo(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await uu(n)}async function yT(t,e){const n=ce(t);e?(n.L_.delete(2),await uu(n)):e||(n.L_.add(2),await Jo(n),n.q_.set("Unknown"))}function Ts(t){return t.K_||(t.K_=function(n,r,i){const s=ce(n);return s.w_(),new nT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:aT.bind(null,t),Ro:lT.bind(null,t),mo:uT.bind(null,t),d_:cT.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),qh(t)?Hh(t):t.q_.set("Unknown")):(await t.K_.stop(),cv(t))})),t.K_}function zr(t){return t.U_||(t.U_=function(n,r,i){const s=ce(n);return s.w_(),new rT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:fT.bind(null,t),mo:gT.bind(null,t),f_:pT.bind(null,t),g_:mT.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await cu(t)):(await t.U_.stop(),t.O_.length>0&&(J("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Xn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const a=Date.now()+r,l=new Gh(e,n,a,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new K(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Qh(t,e){if(ir("AsyncQueue",`${e}: ${t}`),Qo(t))return new K(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e){this.comparator=e?(n,r)=>e(n,r)||re.comparator(n.key,r.key):(n,r)=>re.comparator(n.key,r.key),this.keyedMap=Xs(),this.sortedSet=new We(this.comparator)}static emptySet(e){return new rs(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof rs)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new rs;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm{constructor(){this.W_=new We(re.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ae():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class gs{constructor(e,n,r,i,s,a,l,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,i,s){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new gs(e,n,rs.emptySet(n),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ru(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class _T{constructor(){this.queries=bm(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=ce(n),s=i.queries;i.queries=bm(),s.forEach((a,l)=>{for(const u of l.j_)u.onError(r)})})(this,new K(z.ABORTED,"Firestore shutting down"))}}function bm(){return new Es(t=>V0(t),ru)}async function pv(t,e){const n=ce(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new vT,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(a){const l=Qh(a,`Initialization of query '${Mi(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&Kh(n)}async function mv(t,e){const n=ce(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function xT(t,e){const n=ce(t);let r=!1;for(const i of e){const s=i.query,a=n.queries.get(s);if(a){for(const l of a.j_)l.X_(i)&&(r=!0);a.z_=i}}r&&Kh(n)}function wT(t,e,n){const r=ce(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function Kh(t){t.Y_.forEach(e=>{e.next()})}var wd,Dm;(Dm=wd||(wd={})).ea="default",Dm.Cache="cache";class gv{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new gs(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=gs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==wd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yv{constructor(e){this.key=e}}class vv{constructor(e){this.key=e}}class ST{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=me(),this.mutatedKeys=me(),this.Aa=M0(e),this.Ra=new rs(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Pm,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,a=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,g)=>{const y=i.get(p),E=iu(this.query,g)?g:null,C=!!y&&this.mutatedKeys.has(y.key),P=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let M=!1;y&&E?y.data.isEqual(E.data)?C!==P&&(r.track({type:3,doc:E}),M=!0):this.ga(y,E)||(r.track({type:2,doc:E}),M=!0,(u&&this.Aa(E,u)>0||h&&this.Aa(E,h)<0)&&(l=!0)):!y&&E?(r.track({type:0,doc:E}),M=!0):y&&!E&&(r.track({type:1,doc:y}),M=!0,(u||h)&&(l=!0)),M&&(E?(a=a.add(E),s=P?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:l,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((p,g)=>function(E,C){const P=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae()}};return P(E)-P(C)}(p.type,g.type)||this.Aa(p.doc,g.doc)),this.pa(r),i=i!=null&&i;const l=n&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,h=u!==this.Ea;return this.Ea=u,a.length!==0||h?{snapshot:new gs(this.query,e.Ra,s,a,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Pm,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=me(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new vv(r))}),this.da.forEach(r=>{e.has(r)||n.push(new yv(r))}),n}ba(e){this.Ta=e.Ts,this.da=me();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return gs.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class ET{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class TT{constructor(e){this.key=e,this.va=!1}}class IT{constructor(e,n,r,i,s,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Es(l=>V0(l),ru),this.Ma=new Map,this.xa=new Set,this.Oa=new We(re.comparator),this.Na=new Map,this.La=new zh,this.Ba={},this.ka=new Map,this.qa=ms.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function CT(t,e,n=!0){const r=Tv(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await _v(r,e,n,!0),i}async function AT(t,e){const n=Tv(t);await _v(n,e,!0,!1)}async function _v(t,e,n,r){const i=await KE(t.localStore,On(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,n);let l;return r&&(l=await kT(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&n&&lv(t.remoteStore,i),l}async function kT(t,e,n,r,i){t.Ka=(g,y,E)=>async function(P,M,T,w){let k=M.view.ma(T);k.ns&&(k=await Cm(P.localStore,M.query,!1).then(({documents:v})=>M.view.ma(v,k)));const V=w&&w.targetChanges.get(M.targetId),F=w&&w.targetMismatches.get(M.targetId)!=null,L=M.view.applyChanges(k,P.isPrimaryClient,V,F);return jm(P,M.targetId,L.wa),L.snapshot}(t,g,y,E);const s=await Cm(t.localStore,e,!0),a=new ST(e,s.Ts),l=a.ma(s.documents),u=Xo.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),h=a.applyChanges(l,t.isPrimaryClient,u);jm(t,n,h.wa);const p=new ET(e,n,a);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function RT(t,e,n){const r=ce(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(a=>!ru(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await xd(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&$h(r.remoteStore,i.targetId),Sd(r,i.targetId)}).catch(Go)):(Sd(r,i.targetId),await xd(r.localStore,i.targetId,!0))}async function PT(t,e){const n=ce(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),$h(n.remoteStore,r.targetId))}async function bT(t,e,n){const r=OT(t);try{const i=await function(a,l){const u=ce(a),h=at.now(),p=l.reduce((E,C)=>E.add(C.key),me());let g,y;return u.persistence.runTransaction("Locally write mutations","readwrite",E=>{let C=sr(),P=me();return u.cs.getEntries(E,p).next(M=>{C=M,C.forEach((T,w)=>{w.isValidDocument()||(P=P.add(T))})}).next(()=>u.localDocuments.getOverlayedDocuments(E,C)).next(M=>{g=M;const T=[];for(const w of l){const k=ZS(w,g.get(w.key).overlayedDocument);k!=null&&T.push(new Wr(w.key,k,A0(k.value.mapValue),An.exists(!0)))}return u.mutationQueue.addMutationBatch(E,h,T,l)}).next(M=>{y=M;const T=M.applyToLocalDocumentSet(g,P);return u.documentOverlayCache.saveOverlays(E,M.batchId,T)})}).then(()=>({batchId:y.batchId,changes:O0(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,u){let h=a.Ba[a.currentUser.toKey()];h||(h=new We(xe)),h=h.insert(l,u),a.Ba[a.currentUser.toKey()]=h}(r,i.batchId,n),await Zo(r,i.changes),await cu(r.remoteStore)}catch(i){const s=Qh(i,"Failed to persist write");n.reject(s)}}async function xv(t,e){const n=ce(t);try{const r=await qE(n.localStore,e);e.targetChanges.forEach((i,s)=>{const a=n.Na.get(s);a&&(Ie(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?Ie(a.va):i.removedDocuments.size>0&&(Ie(a.va),a.va=!1))}),await Zo(n,r,e)}catch(r){await Go(r)}}function Nm(t,e,n){const r=ce(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,a)=>{const l=a.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){const u=ce(a);u.onlineState=l;let h=!1;u.queries.forEach((p,g)=>{for(const y of g.j_)y.Z_(l)&&(h=!0)}),h&&Kh(u)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function DT(t,e,n){const r=ce(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let a=new We(re.comparator);a=a.insert(s,Rt.newNoDocument(s,ue.min()));const l=me().add(s),u=new au(ue.min(),new Map,new We(xe),a,l);await xv(r,u),r.Oa=r.Oa.remove(s),r.Na.delete(e),Yh(r)}else await xd(r.localStore,e,!1).then(()=>Sd(r,e,n)).catch(Go)}async function NT(t,e){const n=ce(t),r=e.batch.batchId;try{const i=await HE(n.localStore,e);Sv(n,r,null),wv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Zo(n,i)}catch(i){await Go(i)}}async function jT(t,e,n){const r=ce(t);try{const i=await function(a,l){const u=ce(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,l).next(g=>(Ie(g!==null),p=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(r.localStore,e);Sv(r,e,n),wv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Zo(r,i)}catch(i){await Go(i)}}function wv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Sv(t,e,n){const r=ce(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Sd(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Ev(t,r)})}function Ev(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&($h(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Yh(t))}function jm(t,e,n){for(const r of n)r instanceof yv?(t.La.addReference(r.key,e),VT(t,r)):r instanceof vv?(J("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Ev(t,r.key)):ae()}function VT(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(J("SyncEngine","New document in limbo: "+n),t.xa.add(r),Yh(t))}function Yh(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new re(je.fromString(e)),r=t.qa.next();t.Na.set(r,new TT(n)),t.Oa=t.Oa.insert(n,r),lv(t.remoteStore,new Er(On(Vh(n.path)),r,"TargetPurposeLimboResolution",Rh.oe))}}async function Zo(t,e,n){const r=ce(t),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{a.push(r.Ka(u,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const g=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){i.push(h);const g=Uh.Wi(u.targetId,h);s.push(g)}}))}),await Promise.all(a),r.Ca.d_(i),await async function(u,h){const p=ce(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>U.forEach(h,y=>U.forEach(y.$i,E=>p.persistence.referenceDelegate.addReference(g,y.targetId,E)).next(()=>U.forEach(y.Ui,E=>p.persistence.referenceDelegate.removeReference(g,y.targetId,E)))))}catch(g){if(!Qo(g))throw g;J("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const y=g.targetId;if(!g.fromCache){const E=p.os.get(y),C=E.snapshotVersion,P=E.withLastLimboFreeSnapshotVersion(C);p.os=p.os.insert(y,P)}}}(r.localStore,s))}async function MT(t,e){const n=ce(t);if(!n.currentUser.isEqual(e)){J("SyncEngine","User change. New user:",e.toKey());const r=await iv(n.localStore,e);n.currentUser=e,function(s,a){s.ka.forEach(l=>{l.forEach(u=>{u.reject(new K(z.CANCELLED,a))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Zo(n,r.hs)}}function LT(t,e){const n=ce(t),r=n.Na.get(e);if(r&&r.va)return me().add(r.key);{let i=me();const s=n.Ma.get(e);if(!s)return i;for(const a of s){const l=n.Fa.get(a);i=i.unionWith(l.view.Va)}return i}}function Tv(t){const e=ce(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=xv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=LT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=DT.bind(null,e),e.Ca.d_=xT.bind(null,e.eventManager),e.Ca.$a=wT.bind(null,e.eventManager),e}function OT(t){const e=ce(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=NT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=jT.bind(null,e),e}class Ll{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=lu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return WE(this.persistence,new UE,e.initialUser,this.serializer)}Ga(e){return new FE(Bh.Zr,this.serializer)}Wa(e){return new XE}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ll.provider={build:()=>new Ll};class Ed{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Nm(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=MT.bind(null,this.syncEngine),await yT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new _T}()}createDatastore(e){const n=lu(e.databaseInfo.databaseId),r=function(s){return new tT(s)}(e.databaseInfo);return function(s,a,l,u){return new iT(s,a,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,a,l){return new oT(r,i,s,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Nm(this.syncEngine,n,0),function(){return km.D()?new km:new JE}())}createSyncEngine(e,n){return function(i,s,a,l,u,h,p){const g=new IT(i,s,a,l,u,h);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=ce(i);J("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Jo(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Ed.provider={build:()=>new Ed};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ir("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Ft.UNAUTHENTICATED,this.clientId=T0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async a=>{J("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(J("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Qh(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ic(t,e){t.asyncQueue.verifyOperationInProgress(),J("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await iv(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Vm(t,e){t.asyncQueue.verifyOperationInProgress();const n=await zT(t);J("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Rm(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Rm(e.remoteStore,i)),t._onlineComponents=e}async function zT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){J("FirestoreClient","Using user provided OfflineComponentProvider");try{await ic(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===z.FAILED_PRECONDITION||i.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;No("Error using user provided cache. Falling back to memory cache: "+n),await ic(t,new Ll)}}else J("FirestoreClient","Using default OfflineComponentProvider"),await ic(t,new Ll);return t._offlineComponents}async function Cv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(J("FirestoreClient","Using user provided OnlineComponentProvider"),await Vm(t,t._uninitializedComponentsProvider._online)):(J("FirestoreClient","Using default OnlineComponentProvider"),await Vm(t,new Ed))),t._onlineComponents}function BT(t){return Cv(t).then(e=>e.syncEngine)}async function Av(t){const e=await Cv(t),n=e.eventManager;return n.onListen=CT.bind(null,e.syncEngine),n.onUnlisten=RT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=AT.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=PT.bind(null,e.syncEngine),n}function UT(t,e,n={}){const r=new Xn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,l,u,h){const p=new Iv({next:y=>{p.Za(),a.enqueueAndForget(()=>mv(s,g));const E=y.docs.has(l);!E&&y.fromCache?h.reject(new K(z.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&y.fromCache&&u&&u.source==="server"?h.reject(new K(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(y)},error:y=>h.reject(y)}),g=new gv(Vh(l.path),p,{includeMetadataChanges:!0,_a:!0});return pv(s,g)}(await Av(t),t.asyncQueue,e,n,r)),r.promise}function $T(t,e,n={}){const r=new Xn;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,l,u,h){const p=new Iv({next:y=>{p.Za(),a.enqueueAndForget(()=>mv(s,g)),y.fromCache&&u.source==="server"?h.reject(new K(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(y)},error:y=>h.reject(y)}),g=new gv(l,p,{includeMetadataChanges:!0,_a:!0});return pv(s,g)}(await Av(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mm=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(t,e,n){if(!n)throw new K(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function WT(t,e,n,r){if(e===!0&&r===!0)throw new K(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Lm(t){if(!re.isDocumentKey(t))throw new K(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Om(t){if(re.isDocumentKey(t))throw new K(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function du(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae()}function or(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new K(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=du(t);throw new K(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new K(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new K(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}WT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new K(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new K(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new K(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Xh{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Fm({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new K(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new K(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Fm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new lS;switch(r.type){case"firstParty":return new dS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new K(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Mm.get(n);r&&(J("ComponentProvider","Removing Datastore"),Mm.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Is(this.firestore,e,this._query)}}class Vt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vt(this.firestore,e,this._key)}}class Vr extends Is{constructor(e,n,r){super(e,n,Vh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vt(this.firestore,null,new re(e))}withConverter(e){return new Vr(this.firestore,e,this._path)}}function Bo(t,e,...n){if(t=Rn(t),Rv("collection","path",e),t instanceof Xh){const r=je.fromString(e,...n);return Om(r),new Vr(t,null,r)}{if(!(t instanceof Vt||t instanceof Vr))throw new K(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return Om(r),new Vr(t.firestore,null,r)}}function Pt(t,e,...n){if(t=Rn(t),arguments.length===1&&(e=T0.newId()),Rv("doc","path",e),t instanceof Xh){const r=je.fromString(e,...n);return Lm(r),new Vt(t,null,new re(r))}{if(!(t instanceof Vt||t instanceof Vr))throw new K(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return Lm(r),new Vt(t.firestore,t instanceof Vr?t.converter:null,new re(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new ov(this,"async_queue_retry"),this.Vu=()=>{const r=rc();r&&J("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=rc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=rc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Xn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Qo(e))throw e;J("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw ir("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Gh.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ae()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Cs extends Xh{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new zm,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new zm(e),this._firestoreClient=void 0,await e}}}function HT(t,e,n){n||(n="(default)");const r=p0(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),s=r.getOptions(n);if(Rl(s,e))return i;throw new K(z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new K(z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new K(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function Jh(t){if(t._terminated)throw new K(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||qT(t),t._firestoreClient}function qT(t){var e,n,r;const i=t._freezeSettings(),s=function(l,u,h,p){return new TS(l,u,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,kv(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new FT(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ys(xt.fromBase64String(e))}catch(n){throw new K(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ys(xt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new K(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new K(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new K(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GT=/^__.*__$/;class QT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Wr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Yo(e,this.data,n,this.fieldTransforms)}}class Pv{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Wr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function bv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae()}}class tf{constructor(e,n,r,i,s,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new tf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ol(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(bv(this.Cu)&&GT.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class KT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||lu(e)}Qu(e,n,r,i=!1){return new tf({Cu:e,methodName:n,qu:r,path:gt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function pu(t){const e=t._freezeSettings(),n=lu(t._databaseId);return new KT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Dv(t,e,n,r,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);rf("Data must be an object, but it was:",a,r);const l=Nv(r,a);let u,h;if(s.merge)u=new nn(a.fieldMask),h=a.fieldTransforms;else if(s.mergeFields){const p=[];for(const g of s.mergeFields){const y=Td(e,g,n);if(!a.contains(y))throw new K(z.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Vv(p,y)||p.push(y)}u=new nn(p),h=a.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=a.fieldTransforms;return new QT(new Bt(l),u,h)}class mu extends fu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof mu}}class nf extends fu{_toFieldTransform(e){return new KS(e.path,new Oo)}isEqual(e){return e instanceof nf}}function YT(t,e,n,r){const i=t.Qu(1,e,n);rf("Data must be an object, but it was:",i,r);const s=[],a=Bt.empty();_i(r,(u,h)=>{const p=sf(e,u,n);h=Rn(h);const g=i.Nu(p);if(h instanceof mu)s.push(p);else{const y=ea(h,g);y!=null&&(s.push(p),a.set(p,y))}});const l=new nn(s);return new Pv(a,l,i.fieldTransforms)}function XT(t,e,n,r,i,s){const a=t.Qu(1,e,n),l=[Td(e,r,n)],u=[i];if(s.length%2!=0)throw new K(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<s.length;y+=2)l.push(Td(e,s[y])),u.push(s[y+1]);const h=[],p=Bt.empty();for(let y=l.length-1;y>=0;--y)if(!Vv(h,l[y])){const E=l[y];let C=u[y];C=Rn(C);const P=a.Nu(E);if(C instanceof mu)h.push(E);else{const M=ea(C,P);M!=null&&(h.push(E),p.set(E,M))}}const g=new nn(h);return new Pv(p,g,a.fieldTransforms)}function JT(t,e,n,r=!1){return ea(n,t.Qu(r?4:3,e))}function ea(t,e){if(jv(t=Rn(t)))return rf("Unsupported field value:",e,t),Nv(t,e);if(t instanceof fu)return function(r,i){if(!bv(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let a=0;for(const l of r){let u=ea(l,i.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),a++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Rn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return qS(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=at.fromDate(r);return{timestampValue:Vl(i.serializer,s)}}if(r instanceof at){const s=new at(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Vl(i.serializer,s)}}if(r instanceof Zh)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ys)return{bytesValue:X0(i.serializer,r._byteString)};if(r instanceof Vt){const s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Fh(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ef)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return Mh(l.serializer,u)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${du(r)}`)}(t,e)}function Nv(t,e){const n={};return I0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):_i(t,(r,i)=>{const s=ea(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function jv(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof at||t instanceof Zh||t instanceof ys||t instanceof Vt||t instanceof fu||t instanceof ef)}function rf(t,e,n){if(!jv(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=du(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Td(t,e,n){if((e=Rn(e))instanceof hu)return e._internalPath;if(typeof e=="string")return sf(t,e);throw Ol("Field path arguments must be of type string or ",t,!1,void 0,n)}const ZT=new RegExp("[~\\*/\\[\\]]");function sf(t,e,n){if(e.search(ZT)>=0)throw Ol(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new hu(...e.split("."))._internalPath}catch{throw Ol(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ol(t,e,n,r,i){const s=r&&!r.isEmpty(),a=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||a)&&(u+=" (found",s&&(u+=` in field ${r}`),a&&(u+=` in document ${i}`),u+=")"),new K(z.INVALID_ARGUMENT,l+t+u)}function Vv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Vt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new eI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(of("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class eI extends Mv{data(){return super.data()}}function of(t,e){return typeof e=="string"?sf(t,e):e instanceof hu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new K(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class af{}class nI extends af{}function rI(t,e,...n){let r=[];e instanceof af&&r.push(e),r=r.concat(n),function(s){const a=s.filter(u=>u instanceof lf).length,l=s.filter(u=>u instanceof gu).length;if(a>1||a>0&&l>0)throw new K(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class gu extends nI{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new gu(e,n,r)}_apply(e){const n=this._parse(e);return Lv(e._query,n),new Is(e.firestore,e.converter,pd(e._query,n))}_parse(e){const n=pu(e.firestore);return function(s,a,l,u,h,p,g){let y;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new K(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){$m(g,p);const E=[];for(const C of g)E.push(Um(u,s,C));y={arrayValue:{values:E}}}else y=Um(u,s,g)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||$m(g,p),y=JT(l,a,g,p==="in"||p==="not-in");return rt.create(h,p,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Bm(t,e,n){const r=e,i=of("where",t);return gu._create(i,r,n)}class lf extends af{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new lf(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Pn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let a=i;const l=s.getFlattenedFilters();for(const u of l)Lv(a,u),a=pd(a,u)}(e._query,n),new Is(e.firestore,e.converter,pd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Um(t,e,n){if(typeof(n=Rn(n))=="string"){if(n==="")throw new K(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!j0(e)&&n.indexOf("/")!==-1)throw new K(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(je.fromString(n));if(!re.isDocumentKey(r))throw new K(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return um(t,new re(r))}if(n instanceof Vt)return um(t,n._key);throw new K(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${du(n)}.`)}function $m(t,e){if(!Array.isArray(t)||t.length===0)throw new K(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Lv(t,e){const n=function(i,s){for(const a of i)for(const l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new K(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new K(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class iI{convertValue(e,n="none"){switch(gi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(mi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ae()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return _i(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>Xe(a.doubleValue));return new ef(s)}convertGeoPoint(e){return new Zh(Xe(e.latitude),Xe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=bh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Vo(e));default:return null}}convertTimestamp(e){const n=Fr(e);return new at(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=je.fromString(e);Ie(rv(r));const i=new Mo(r.get(1),r.get(3)),s=new re(r.popFirst(5));return i.isEqual(n)||ir(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ov(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fv extends Mv{constructor(e,n,r,i,s,a){super(e,n,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new il(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(of("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class il extends Fv{data(e={}){return super.data(e)}}class sI{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Zs(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new il(this._firestore,this._userDataWriter,r.key,r,new Zs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new K(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{const u=new il(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Zs(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const u=new il(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Zs(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,p=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:oI(l.type),doc:u,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function oI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uf(t){t=or(t,Vt);const e=or(t.firestore,Cs);return UT(Jh(e),t._key).then(n=>aI(e,t,n))}class zv extends iI{constructor(e){super(),this.firestore=e}convertBytes(e){return new ys(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Vt(this.firestore,null,n)}}function Id(t){t=or(t,Is);const e=or(t.firestore,Cs),n=Jh(e),r=new zv(e);return tI(t._query),$T(n,t._query).then(i=>new sI(e,r,t,i))}function Cd(t,e,n){t=or(t,Vt);const r=or(t.firestore,Cs),i=Ov(t.converter,e,n);return cf(r,[Dv(pu(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,An.none())])}function Gn(t,e,n,...r){t=or(t,Vt);const i=or(t.firestore,Cs),s=pu(i);let a;return a=typeof(e=Rn(e))=="string"||e instanceof hu?XT(s,"updateDoc",t._key,e,n,r):YT(s,"updateDoc",t._key,e),cf(i,[a.toMutation(t._key,An.exists(!0))])}function Bv(t,e){const n=or(t.firestore,Cs),r=Pt(t),i=Ov(t.converter,e);return cf(n,[Dv(pu(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,An.exists(!1))]).then(()=>r)}function cf(t,e){return function(r,i){const s=new Xn;return r.asyncQueue.enqueueAndForget(async()=>bT(await BT(r),i,s)),s.promise}(Jh(t),e)}function aI(t,e,n){const r=n.docs.get(e._key),i=new zv(t);return new Fv(t,i,e._key,r,new Zs(n.hasPendingWrites,n.fromCache),e.converter)}function Tn(){return new nf("serverTimestamp")}(function(e,n=!0){(function(i){Ss=i})(Qw),bo(new ds("firestore",(r,{instanceIdentifier:i,options:s})=>{const a=r.getProvider("app").getImmediate(),l=new Cs(new uS(r.getProvider("auth-internal")),new fS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new K(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Mo(h.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:n},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),jr(im,"4.7.3",e),jr(im,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad="us-central1";class uI{constructor(e,n,r,i,s=Ad,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new lI(n,r,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(s);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Ad}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function cI(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const Wm="@firebase/functions",Hm="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI="auth-internal",hI="app-check-internal",fI="messaging-internal";function pI(t,e){const n=(r,{instanceIdentifier:i})=>{const s=r.getProvider("app").getImmediate(),a=r.getProvider(dI),l=r.getProvider(fI),u=r.getProvider(hI);return new uI(s,a,l,u,i,t)};bo(new ds(Uv,n,"PUBLIC").setMultipleInstances(!0)),jr(Wm,Hm,e),jr(Wm,Hm,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mI(t=Kw(),e=Ad){const r=p0(Rn(t),Uv).getImmediate({identifier:e}),i=z1("functions");return i&&gI(r,...i),r}function gI(t,e,n){cI(Rn(t),e,n)}pI(fetch.bind(self));const yI={apiKey:'"AIzaSyDRdl4zhwoZumVtphmJ19orZ8HoR0WQQZM",',authDomain:'"qualtrics-game-backend.firebaseapp.com",',projectId:'"qualtrics-game-backend",',storageBucket:'"qualtrics-game-backend.firebasestorage.app",',messagingSenderId:'"441267092549",',appId:"1:441267092549:web:6ce075f5f3ea7cf958772c"},$v=m0(yI),tt=HT($v,{experimentalForceLongPolling:!1,useFetchStreams:!1});mI($v);const et={init(){localStorage.getItem("sessionId")||(localStorage.setItem("sessionId",this.generateSessionId()),localStorage.setItem("sessionStartTime",Date.now().toString())),localStorage.getItem("semesterStartTime")||localStorage.setItem("semesterStartTime",Date.now().toString())},generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},async logEvent(t,e){const n=localStorage.getItem("sessionId")||this.generateSessionId(),r=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),i=Date.now(),s=i-r,a=(s/1e3).toFixed(1),l=Math.floor(s/6e4),u=Math.floor(s%6e4/1e3),h=`${l}:${u.toString().padStart(2,"0")}`,p=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),g=this.getFullGameContext(),y={sessionId:n,studentId:p.studentId||null,type:t,timestamp:new Date().toISOString(),clientTimestamp:i,timeElapsedSeconds:parseFloat(a),readableTime:h,semesterTime:this.getSemesterTime(),...g,isAdminMode:p.role==="admin",hasCheckpoint:p.checkpointSemester2||!1,hasAI:p.hasAI||!1,section:p.section||null,...this.convertTimesToSeconds(e)};(t==="user_action"||t==="task_attempt")&&console.log(`DEBUG: Event ${t} - studentId: ${y.studentId}, role: ${p.role}`);try{await Bv(Bo(tt,"events"),y)}catch(E){console.error("Failed to log event:",E),this.storeOfflineEvent(y)}},convertTimesToSeconds(t){const e={...t},n=["timeTaken","timeSpent","totalTime","timeOnPreviousPage","averageTime","timeBetweenHelpAndSubmit"];for(const r of n)e[r]!==void 0&&e[r]!==null&&(e[`${r}Seconds`]=(e[r]/1e3).toFixed(1),delete e[r]);return e.timeProgression&&(e.timeProgressionSeconds=e.timeProgression.map(r=>(r/1e3).toFixed(1)),delete e.timeProgression),e.timePerAttempt&&(e.timePerAttemptSeconds=e.timePerAttempt.map(r=>(r/1e3).toFixed(1)),delete e.timePerAttempt),e},getSemesterTime(){const t=parseInt(localStorage.getItem("semesterStartTime")||Date.now()),e=Date.now()-t,n=(e/1e3).toFixed(1),r=Math.floor(e/6e4),i=Math.floor(e%6e4/1e3);return{elapsedSeconds:parseFloat(n),readable:`${r}:${i.toString().padStart(2,"0")}`,minutes:r,seconds:i}},getCurrentContext(){const t=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),e=((Date.now()-t)/1e3).toFixed(1);return{currentTask:localStorage.getItem("currentTask"),gameMode:localStorage.getItem("gameMode"),totalCompleted:this.getCompletedTaskCount(),currentStreak:this.getCurrentStreak(),sessionDurationSeconds:parseFloat(e)}},getFullGameContext(){const t=localStorage.getItem("currentTask")||"",e=localStorage.getItem("gameMode")||"",n=parseInt(localStorage.getItem("currentSemester")||"1"),r=parseInt(localStorage.getItem("totalSemesters")||"2"),i=localStorage.getItem("practiceCompleted")==="true",s=parseInt(localStorage.getItem("completedTasksCount")||"0"),a=parseInt(localStorage.getItem("completedLevels")||"0"),l=parseInt(localStorage.getItem("totalSwitches")||"0"),u=parseInt(localStorage.getItem("aiUsageCount")||"0"),h=JSON.parse(localStorage.getItem("categoryPoints")||"{}"),p=parseFloat(localStorage.getItem("studentLearningScore")||"0");return{currentTask:t,gameMode:e,currentSemester:n,totalSemesters:r,practiceCompleted:i,completedTasks:s,completedLevels:a,totalSwitches:l,aiUsageCount:u,studentLearning:p,totalBonus:h.bonus||0,finalScore:Math.round(p)+(h.bonus||0),semester:n}},calculateImprovementTrend(t){if(!t||t.length<3)return"needs_more_data";const n=t.slice(-5).map(i=>i.accuracy),r=this.calculateTrend(n);return r>5?"rapid_improvement":r>2?"steady_improvement":r>0?"slight_improvement":r>-2?"stable":r>-5?"slight_decline":"rapid_decline"},calculateImprovementRate(t){if(!t||t.length<2)return{overall:0,trend:0,isImproving:!1,dataPoints:t?t.length:0};const e=t[0].accuracy,r=t[t.length-1].accuracy-e;if(t.length<3)return{overall:r,trend:r,isImproving:r>0,dataPoints:t.length};const i=Math.floor(t.length/2),s=t.slice(0,i).reduce((u,h)=>u+h.accuracy,0)/i,l=t.slice(i).reduce((u,h)=>u+h.accuracy,0)/(t.length-i)-s;return{overall:r,trend:l,isImproving:l>0,dataPoints:t.length}},setPageStartTime(t){t&&localStorage.setItem(`pageStartTime_${t}`,Date.now().toString())},getTimeOnCurrentPage(t){if(!t)return 0;const e=localStorage.getItem(`pageStartTime_${t}`);return e?Date.now()-parseInt(e):0},ensureSession(){localStorage.getItem("sessionId")||this.init()},async trackAIHelpResponse(t,e,n,r,i,s){const a=parseInt(localStorage.getItem("aiUsageCount")||"0");return localStorage.setItem("aiUsageCount",(a+1).toString()),this.logEvent("ai_help_response",{taskId:t,helpType:e,suggestion:n,playerAction:r,playerValue:i,timeBetween:s})},async trackTaskAttempt(t,e){return this.logEvent("task_attempt",{taskId:t,...e})},async trackUserAction(t,e){return this.logEvent("user_action",{action:t,response:e.response||"",query:e.query||"",queryType:e.queryType||"",choice:e.choice||"",currentMode:e.currentMode||"",...e})},async syncOfflineEvents(){return console.log("Syncing offline events..."),Promise.resolve()},async trackTaskComplete(t,e){return this.logEvent("task_complete",{taskId:t,...e})},async trackPageSwitch(t,e,n){return this.logEvent("page_switch",{from:t,to:e,isAutoAdvance:n})},trackAITaskHelp(t,e,n,r,i){return this.logEvent("ai_task_help",{taskId:t,taskType:e,suggestion:n,wasCorrect:r,attemptNumber:i})}};et.init();const Jn={seedRandom:null,currentSeed:null,initializeSeed(t){this.currentSeed=t;let e=t;this.seedRandom=function(){return e=(e*9301+49297)%233280,e/233280}},getRandom(){return this.seedRandom?this.seedRandom():Math.random()},generateCountingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n;e==="easy"?n=(t-1)%5+1:e==="medium"?n=(t-11)%5+6:n=(t-25)%5+11;const i={easy:{1:{target:"the",type:"word"},2:{target:"and",type:"word"},3:{target:"of",type:"word"},4:{target:"to",type:"word"},5:{target:"in",type:"word"}},medium:{6:{target:"e",type:"letter"},7:{target:"a",type:"letter"},8:{target:"i",type:"letter"},9:{target:"o",type:"letter"},10:{target:"s",type:"letter"}},hard:{11:{targets:["a","e"],type:"multi-letter"},12:{targets:["i","o"],type:"multi-letter"},13:{targets:["s","t"],type:"multi-letter"},14:{targets:["n","r"],type:"multi-letter"},15:{targets:["l","d"],type:"multi-letter"}}}[e][n];let s="";return i.type==="word"?s=`Count how many times the word "${i.target}" appears:`:i.type==="letter"?s=`Count how many times the letter "${i.target}" appears (case-insensitive):`:s=`Count how many times the letters "${i.targets[0]}" and "${i.targets[1]}" appear in total:`,{...i,instruction:s,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},generateSliderPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n,r,i;return e==="easy"?(n=Math.floor(this.getRandom()*11),r=1,i=!0):e==="medium"?(n=Math.round(this.getRandom()*10*10)/10,r=.1,i=!0):(n=Math.round(this.getRandom()*10*100)/100,r=.01,i=(t-25)%5!==0),{target:n,step:r,showValue:i,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1),precision:e==="easy"?0:e==="medium"?1:2}},generateTypingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard",n={easy:["hello world","quick test","type this","easy mode","simple text","good job","keep going","nice work","almost done","level up"],medium:["HeLLo WoRLd","QuIcK tEsT","TyPe ThIs","MeDiUm MoDe","MiXeD cAsE","KeEp GoInG","NiCe WoRk","AlMoSt DoNe","LeVeL uP","ChAlLeNgE","TeSt RuN","NeXt LeVeL","TrY aGaIn","GoOd LuCk","FiNaL tEsT"],hard:["Test@123","Go4It!Now","X9%Y8&Z7*","P6!Q5?R4+","Z1@Y2#X3$","M7&N8*O9!","J4%K5^L6&","D1!E2@F3#","A7$B8%C9^","V3*W4+X5=","Q2#R3$S4%","H5^I6&J7*","K8(L9)M0!","N1@O2#P3$","T4%U5^V6&","W7*X8(Y9)","C0!D1@E2#","F3$G4%H5^","I6&J7*K8(","L9)M0!N1@","O2#P3$Q4%","R5^S6&T7*","U8(V9)W0!","X1@Y2#Z3$","A4%B5^C6&"]};let r;if(e==="easy"){const i=(t-1)%n.easy.length;r=n.easy[i]}else if(e==="medium"){const i=(t-11)%n.medium.length;r=n.medium[i]}else{const i=(t-25)%n.hard.length;r=n.hard[i]}return{pattern:r,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},textPassages:["The University of California, Berkeley (UC Berkeley, Berkeley, Cal, or California) is a public land-grant research university in Berkeley, California, United States. Founded in 1868 and named after the Anglo-Irish philosopher George Berkeley, it is the state's first land-grant university and is the founding campus of the University of California system.","Berkeley has an enrollment of more than 45,000 students. The university is organized around fifteen schools of study on the same campus, including the College of Chemistry, the College of Engineering, College of Letters and Science, and the Haas School of Business.",'The Berkeley campus encompasses approximately 1,232 acres, though the "central campus" occupies only the low-lying western 178 acres. The campus contains numerous wooded areas, including the Eucalyptus Grove and Strawberry Creek, which runs through the center of campus.',"Oski the Bear (Oski) is the official mascot of the University of California, Berkeley, representing the California Golden Bears. Named after the Oski Yell, he made his debut at a freshman rally in the Greek Theatre on September 25, 1941.","Berkeley faculty, alumni, and researchers have won 111 Nobel laureates, 25 Turing Award winners, and 19 Academy Award winners. The university has produced many notable alumni in various fields including science, politics, business, and entertainment.","The university's athletic teams compete as the California Golden Bears and are members of the Atlantic Coast Conference for most sports. Berkeley teams have won 107 national championships, including 45 NCAA national championships.","Research at Berkeley is conducted within departments, organized research units, and interdisciplinary research centers. Berkeley operates Lawrence Berkeley National Laboratory, manages Los Alamos National Laboratory, and is a founding partner of the Space Sciences Laboratory.","The Berkeley campus offers over 350 degree programs through its 14 colleges and schools. Popular majors include Computer Science, Economics, Political Science, and Business Administration. The student-faculty ratio is 17:1.","Berkeley's libraries contain more than 13 million volumes and maintain special collections including the Mark Twain Papers, the Oral History Center, and the Bancroft Library, which houses the largest collection of materials on California history.","The campus is home to several museums including the Berkeley Art Museum and Pacific Film Archive, the Lawrence Hall of Science, and the UC Botanical Garden. These facilities serve both educational and public outreach purposes.","Notable Berkeley inventions and discoveries include the cyclotron, the atomic bomb, the flu vaccine, and vitamin E. Berkeley researchers discovered 16 chemical elements of the periodic table, more than any other university.","The Free Speech Movement, which took place during the 1964-65 academic year, was a pivotal moment in the history of civil liberties in the United States. It began when students protested a ban on political activities on campus.","Berkeley's Campanile, known as Sather Tower, is the third-tallest clock tower in the world at 307 feet. It was completed in 1914 and is visible for miles, serving as a symbol of the university.","The university operates on a semester system, with fall semester beginning in late August and spring semester beginning in mid-January. Berkeley offers over 5,000 courses each semester across all disciplines.",`Cal Bears have won at least one team national title in 13 different sports. The university's traditional rival is Stanford University, with the annual football game known as "The Big Game" dating back to 1892.`],getTextPassage(t){if(this.seedRandom){const e=Math.floor(this.getRandom()*this.textPassages.length),n=(t-1+e)%this.textPassages.length;return this.textPassages[n]}else{const e=(t-1)%this.textPassages.length;return this.textPassages[e]}}};function kd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[i,s]=D.useState(""),[a,l]=D.useState(""),[u,h]=D.useState(null),[p,g]=D.useState(""),[y,E]=D.useState(null),[C,P]=D.useState(""),[M,T]=D.useState(""),[w]=D.useState(Date.now()),[k,V]=D.useState(""),[F,L]=D.useState(!1),[v,m]=D.useState(new Set),x=D.useRef(0);D.useRef(null);const S=(ne,ie=null,$=null)=>{const N=document.createElement("canvas"),O=N.getContext("2d");N.width=900,N.height=400,O.fillStyle="#fafafa",O.fillRect(0,0,N.width,N.height),O.strokeStyle="#e0e0e0",O.lineWidth=2,O.strokeRect(0,0,N.width,N.height),O.font="24px monospace",O.fillStyle="#333";const G=36,Z=25,ee=N.width-Z*2;return((we,pe)=>{const de=we.split(" "),Fe=[];let Se="";for(let te of de){const ke=Se+(Se?" ":"")+te;O.measureText(ke).width>pe&&Se?(Fe.push(Se),Se=te):Se=ke}return Se&&Fe.push(Se),Fe})(ne,ee).forEach((we,pe)=>{const de=Z+(pe+1)*G;let Fe=Z;if(t<=5){const Se=we.split(" ");let te=0;Se.forEach(ke=>{const ze=$&&$.has(te),Re=ie&&ie.some(wt=>ke.toLowerCase()===wt.toLowerCase());if(ze){const wt=O.measureText(ke).width;O.fillStyle="yellow",O.fillRect(Fe-2,de-18,wt+4,24)}else if(Re){const wt=O.measureText(ke).width;O.fillStyle="rgba(255, 215, 0, 0.4)",O.fillRect(Fe-2,de-18,wt+4,24)}O.fillStyle="#333",O.fillText(ke,Fe,de),Fe+=O.measureText(ke+" ").width,te++})}else for(let Se=0;Se<we.length;Se++){const te=we[Se],ke=O.measureText(te).width;ie&&ie.some(Re=>te.toLowerCase()===Re.toLowerCase())&&(O.fillStyle="rgba(255, 215, 0, 0.4)",O.fillRect(Fe-1,de-18,ke+2,24)),O.fillStyle="#333",O.fillText(te,Fe,de),Fe+=ke}}),N.toDataURL()};D.useEffect(()=>{g(0),E(null),x.current=0},[t]),D.useEffect(()=>{const ne=async($,N)=>{const O=document.createElement("canvas"),G=O.getContext("2d");O.width=900,O.height=350,G.fillStyle="#fafafa",G.fillRect(0,0,O.width,O.height),G.strokeStyle="#e0e0e0",G.lineWidth=2,G.strokeRect(0,0,O.width,O.height),G.font="24px monospace";const Z=36,ee=20,le=O.width-ee*2,we=((pe,de)=>{const Fe=pe.split(" "),Se=[];let te="";for(let ke of Fe){const ze=te+(te?" ":"")+ke;G.measureText(ze).width>de&&te?(Se.push(te),te=ke):te=ze}return te&&Se.push(te),Se})(C,le);for(let pe=0;pe<$.length;pe++)$[pe],we.forEach((de,Fe)=>{const Se=ee+(Fe+1)*Z;let te=ee;for(let ke=0;ke<de.length;ke++){const ze=de[ke],Re=G.measureText(ze).width;$.some(qt=>ze.toLowerCase()===qt.toLowerCase())&&(G.fillStyle="rgba(255, 255, 0, 0.6)",G.fillRect(te-1,Se-20,Re+2,26)),G.fillStyle="#333",G.fillText(ze,te,Se),te+=Re}}),V(O.toDataURL()),await new Promise(de=>setTimeout(de,300));setTimeout(()=>{g(N.toString())},300)},ie=async $=>{const{action:N,highlightWords:O,suggestedCount:G,animate:Z,isMultiLetter:ee,targetLetters:le}=$.detail||{};if(N==="highlightAndCount"){if(ee&&Array.isArray(le)){Z&&await ne(le,G);return}if(Array.isArray(O)&&Z){C.split(" ");let Ae=[];for(let we=0;we<O.length;we++){Ae.push(O[we]);const pe=document.createElement("canvas"),de=pe.getContext("2d");pe.width=900,pe.height=350,de.fillStyle="#fafafa",de.fillRect(0,0,pe.width,pe.height),de.strokeStyle="#e0e0e0",de.lineWidth=2,de.strokeRect(0,0,pe.width,pe.height),de.font="24px monospace";const Fe=36,Se=20,te=pe.width-Se*2;((Re,wt)=>{const qt=Re.split(" "),Gt=[];let Qt="";for(let Kt of qt){const lr=Qt+(Qt?" ":"")+Kt;de.measureText(lr).width>wt&&Qt?(Gt.push(Qt),Qt=Kt):Qt=lr}return Qt&&Gt.push(Qt),Gt})(C,te).forEach((Re,wt)=>{const qt=Se+(wt+1)*Fe;let Gt=Se;Re.split(" ").forEach(Kt=>{const lr=de.measureText(Kt).width;Ae.some(bn=>{const cr=Kt.replace(/[.,;!?]/g,"").toLowerCase(),Pe=bn.replace(/[.,;!?]/g,"").toLowerCase();return cr===Pe})&&(de.fillStyle="rgba(255, 255, 0, 0.5)",de.fillRect(Gt-2,qt-18,lr+4,24)),de.fillStyle="#333",de.fillText(Kt,Gt,qt),Gt+=de.measureText(Kt+" ").width})}),V(pe.toDataURL()),await new Promise(Re=>setTimeout(Re,200))}setTimeout(()=>{g(G.toString())},300)}}};return window.addEventListener("aiCountingHelp",ie),()=>window.removeEventListener("aiCountingHelp",ie)},[C,t]),D.useEffect(()=>{var O;const ne=Jn.generateCountingPattern(t),ie=Jn.getTextPassage(t);P(ie),s(ne.target||((O=ne.targets)==null?void 0:O.join(", "))),l(ne.instruction);let $=0;if(ne.type==="word"){const G=new RegExp(`\\b${ne.target}\\b`,"gi"),Z=ie.match(G);$=Z?Z.length:0}else if(ne.type==="letter"){const G=new RegExp(ne.target,"gi"),Z=ie.match(G);$=Z?Z.length:0}else ne.type==="multi-letter"&&ne.targets.forEach(G=>{const Z=new RegExp(G,"gi"),ee=ie.match(Z);$+=ee?ee.length:0});h($);const N=S(ie,null);V(N)},[t]);const A=async()=>{const ne=Date.now()-w,ie=parseInt(p,10)||0,$=u??0,N=Math.abs(ie-$),O=`g1t${t}`,G=localStorage.getItem(`lastAIHelp_${O}`);if(G){const le=JSON.parse(G),Ae=Date.now()-le.timestamp,we=ie===le.suggestion?"accepted":"modified";await et.trackAIHelpResponse(O,le.type,le.suggestion,we,ie,Ae),localStorage.removeItem(`lastAIHelp_${O}`)}let Z=0;N===0?Z=2:N<=1?Z=1:Z=0,x.current+=1,await et.trackTaskAttempt(O,x.current,!0,ne,ie,$);const ee=localStorage.getItem("sessionId");if(ee&&!ee.startsWith("offline-"))try{await Gn(Pt(tt,"sessions",ee),{[`taskAccuracies.g1t${t}`]:Z===2?100:Z===1?70:0,[`taskTimes.g1t${t}`]:ne,[`taskPoints.g1t${t}`]:Z,lastActivity:Tn()})}catch(le){console.error("Error storing accuracy:",le)}E(Z===2?" Perfect! 2 points earned!":Z===1?` Off by ${N} - 1 point earned!`:` Off by ${N} - 0 points earned.`),setTimeout(()=>{e==null||e(`g1t${t}`,{attempts:x.current,totalTime:ne,accuracy:Z===2?100:Z===1?70:0,userAnswer:ie,correctAnswer:$,points:Z})},500)},I=Jn.generateCountingPattern(t).difficultyLabel,se=t<=5?"easy":t<=10?"medium":"hard";return d.jsxs("div",{className:"task counting",children:[d.jsxs("h3",{children:["Research Content - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${se}`,children:I}),d.jsxs("p",{className:"instruction",children:[d.jsx("strong",{children:a}),d.jsx("br",{}),d.jsx("span",{className:"hint",children:"(Case-insensitive)"})]}),d.jsxs("div",{className:"text-display text-to-count","data-counting-text":C,children:[d.jsx("div",{className:"count-target","data-pattern":i,style:{display:"none"},children:i}),k?d.jsx("img",{src:k,alt:"Text passage for counting",style:{width:"100%",maxWidth:"900px",height:"auto",maxHeight:"350px",objectFit:"contain",border:"none",userSelect:"none",pointerEvents:"none"},onContextMenu:ne=>ne.preventDefault(),draggable:!1}):d.jsx("div",{dangerouslySetInnerHTML:{__html:M}})]}),d.jsxs("div",{className:"input-section",children:[d.jsx("label",{children:"Your answer:"}),d.jsx("input",{type:"number",min:"0",max:"999",value:p,onChange:ne=>g(ne.target.value),onKeyPress:ne=>{ne.key==="Enter"&&A()},placeholder:"Enter count"})]}),d.jsx("button",{onClick:A,className:"submit-btn",style:{display:"block",margin:"20px auto 0"},children:"Submit"}),y&&d.jsx("div",{className:`feedback ${y.includes("2 points")?"correct":y.includes("0 points")?"incorrect":"partial"}`,children:y})]})}function Rd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[i,s]=D.useState(5),[a,l]=D.useState(0),[u,h]=D.useState(null),[p]=D.useState(Date.now()),[g,y]=D.useState(1),[E,C]=D.useState(!0),[P,M]=D.useState(!1),[T,w]=D.useState(!1),[k,V]=D.useState(!1),[F,L]=D.useState(!1),v=D.useRef(null),m=D.useRef(0);D.useEffect(()=>{if(n)s(3),y(1),C(!0);else{const $=Jn.generateSliderPattern(t);s($.target),y($.step),C($.showValue)}l(0),h(null),m.current=0},[t,n]),D.useEffect(()=>{const $=N=>{const{action:O,value:G,animate:Z}=N.detail;if(O==="moveSlider")if(w(!0),Z){const ee=parseFloat(a),le=parseFloat(G),Ae=1e3,we=30;let pe=0;const de=setInterval(()=>{pe++;const Fe=pe/we,Se=1-Math.pow(1-Fe,3),te=ee+(le-ee)*Se;l(parseFloat(te.toFixed(2))),pe>=we&&(clearInterval(de),w(!1),l(parseFloat(le.toFixed(2))))},Ae/we)}else l(parseFloat(G.toFixed(2))),w(!1)};return window.addEventListener("aiSliderHelp",$),()=>window.removeEventListener("aiSliderHelp",$)},[a]),D.useEffect(()=>{const $=N=>{N.key==="Enter"&&!T&&R()};return document.addEventListener("keypress",$),()=>document.removeEventListener("keypress",$)},[T,a,i]);const x=$=>{if(T)return;const N=v.current;if(!N)return;$.preventDefault();const O=N.getBoundingClientRect(),G=a/10,Z=O.left+O.width*G,ee=$.clientX||$.touches&&$.touches[0].clientX;Math.abs(ee-Z)<30&&(V(!0),L(!0))},S=$=>{if(!k||T)return;const N=v.current;if(!N)return;const O=N.getBoundingClientRect(),G=$.clientX||$.touches&&$.touches[0].clientX,ee=Math.max(0,Math.min(1,(G-O.left)/O.width))*10,le=Math.round(ee/g)*g;l(parseFloat(le.toFixed(2)))},A=()=>{V(!1)};D.useEffect(()=>{if(k){const $=O=>S(O),N=()=>A();return document.addEventListener("mousemove",$),document.addEventListener("mouseup",N),document.addEventListener("touchmove",$),document.addEventListener("touchend",N),()=>{document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",N),document.removeEventListener("touchmove",$),document.removeEventListener("touchend",N)}}},[k,g,T]);const R=async()=>{const $=Date.now()-p,N=parseFloat(a),O=Math.abs(N-i),G=`g2t${t}`,Z=localStorage.getItem(`lastAIHelp_${G}`);if(Z){const Ae=JSON.parse(Z),we=Date.now()-Ae.timestamp,pe=N===Ae.suggestion?"accepted":"modified";await et.trackAIHelpResponse(G,Ae.type,Ae.suggestion,pe,N,we),localStorage.removeItem(`lastAIHelp_${G}`)}let ee=0;O===0?ee=2:O<=1?ee=1:ee=0,m.current+=1,await et.trackTaskAttempt(G,m.current,!0,$,N,i);const le=localStorage.getItem("sessionId");if(le&&!le.startsWith("offline-"))try{await Gn(Pt(tt,"sessions",le),{[`taskDifferences.g2t${t}`]:O,[`taskTimes.g2t${t}`]:$,[`taskPoints.g2t${t}`]:ee,lastActivity:Tn()})}catch(Ae){console.error("Error storing difference:",Ae)}h(ee===2?" Perfect! 2 points earned!":ee===1?` Off by ${O.toFixed(2)} - 1 point earned!`:` Off by ${O.toFixed(2)} - 0 points earned.`),setTimeout(()=>{e(`g2t${t}`,{attempts:m.current,totalTime:$,accuracy:ee===2?100:ee===1?70:0,userAnswer:N,correctAnswer:i,points:ee})},500)},I=Jn.generateSliderPattern(t),se=I.difficultyLabel,ne=I.difficulty,ie=()=>{const $=[];for(let N=0;N<=10;N++)$.push(d.jsxs("div",{style:{position:"absolute",left:`${N*10}%`,transform:"translateX(-50%)",textAlign:"center"},children:[d.jsx("div",{style:{width:"2px",height:"12px",background:"#666",margin:"0 auto"}}),d.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:N})]},N));return $};return d.jsxs("div",{className:`task slider ${T?"ai-controlled":""}`,children:[d.jsxs("h3",{children:["Material Creation - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${ne}`,children:se}),d.jsxs("p",{className:"instruction",children:["Move the slider to:"," ",d.jsx("strong",{className:"target-value","data-target-value":i,children:i}),d.jsx("br",{}),d.jsx("span",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:!F&&"Hold and drag the slider handle to move it"})]}),d.jsxs("div",{className:"slider-container",children:[d.jsxs("div",{className:"range-labels",children:[d.jsx("span",{children:"0"}),d.jsx("span",{children:"10"})]}),d.jsxs("div",{style:{position:"relative",padding:"20px 0 30px 0"},children:[d.jsx("div",{style:{position:"absolute",width:"100%",height:"20px",top:"0"},children:ie()}),d.jsx("div",{style:{position:"relative",marginTop:"20px"},children:d.jsx("input",{ref:v,type:"range",min:"0",max:"10",step:g,value:a,onChange:$=>{!k&&!T&&(l(parseFloat($.target.value)),L(!0))},className:"slider-input",style:{width:"100%",cursor:k?"grabbing":"grab"},onMouseDown:x,onTouchStart:x})})]}),d.jsx("div",{className:"current-value",children:E?parseFloat(a).toFixed(n?0:I.precision):"??"})]}),d.jsx("button",{onClick:R,className:"submit-btn",disabled:T,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function Pd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[i,s]=D.useState(""),[a,l]=D.useState(""),[u,h]=D.useState(null),[p]=D.useState(Date.now()),[g,y]=D.useState(""),[E,C]=D.useState(!1),P=D.useRef(0),M=F=>{const L=document.createElement("canvas"),v=L.getContext("2d");return L.width=600,L.height=150,v.fillStyle="#f5f5f5",v.fillRect(0,0,L.width,L.height),v.font='bold 40px "Courier New", monospace',v.fillStyle="#333",v.textAlign="center",v.textBaseline="middle",v.fillText(F,L.width/2,L.height/2),L.toDataURL()};D.useEffect(()=>{const L=Jn.generateTypingPattern(t).pattern;s(L);const v=M(L);y(v)},[t]),D.useEffect(()=>{l(""),h(null),P.current=0},[t]),D.useEffect(()=>{const F=L=>{const{action:v,text:m,typeSpeed:x}=L.detail;if(v==="autoType"&&m){C(!0),l("");let S="",A=0;const R=setInterval(()=>{A<m.length?(S+=m[A],l(S),A++):(clearInterval(R),C(!1))},x||50);return()=>clearInterval(R)}};return window.addEventListener("aiTypingHelp",F),()=>window.removeEventListener("aiTypingHelp",F)},[]);const T=async()=>{const F=Date.now()-p,L=`g3t${t}`,v=localStorage.getItem(`lastAIHelp_${L}`);if(v){const R=JSON.parse(v),I=Date.now()-R.timestamp,se=a===R.suggestion?"accepted":"modified";await et.trackAIHelpResponse(L,R.type,R.suggestion,se,a,I),localStorage.removeItem(`lastAIHelp_${L}`)}const x=((R,I)=>{const se=R.length,ne=I.length,ie=Array(se+1).fill(null).map(()=>Array(ne+1).fill(0));for(let $=0;$<=se;$++)ie[$][0]=$;for(let $=0;$<=ne;$++)ie[0][$]=$;for(let $=1;$<=se;$++)for(let N=1;N<=ne;N++)R[$-1]===I[N-1]?ie[$][N]=ie[$-1][N-1]:ie[$][N]=Math.min(ie[$-1][N]+1,ie[$][N-1]+1,ie[$-1][N-1]+1);return ie[se][ne]})(a,i);let S=0;x===0?S=2:x===1?S=1:S=0,P.current+=1,await et.trackTaskAttempt(L,P.current,!0,F,a,i);const A=localStorage.getItem("sessionId");if(A&&!A.startsWith("offline-"))try{await Gn(Pt(tt,"sessions",A),{[`taskAccuracies.g3t${t}`]:S===2?100:S===1?70:0,[`taskTimes.g3t${t}`]:F,[`taskPoints.g3t${t}`]:S,lastActivity:Tn()})}catch(R){console.error("Error storing accuracy:",R)}h(S===2?" Perfect! 2 points earned!":S===1?" 1 typo - 1 point earned!":` ${x} errors - 0 points earned.`),setTimeout(()=>{e(`g3t${t}`,{attempts:P.current,totalTime:F,accuracy:S===2?100:S===1?70:0,userAnswer:a,correctAnswer:i,points:S})},500)},w=Jn.generateTypingPattern(t),k=w.difficultyLabel,V=w.difficulty;return d.jsxs("div",{className:"task typing",style:{maxWidth:"100%"},children:[d.jsxs("h3",{children:["Student Engagement - Level ",t]}),d.jsx("div",{className:`difficulty-badge ${V}`,children:k}),d.jsx("p",{className:"instruction",children:"Type this pattern exactly:"}),d.jsxs("div",{className:"pattern-display",children:[d.jsx("div",{className:"typing-pattern","data-typing-pattern":i,style:{display:"none"},children:i}),g?d.jsx("img",{src:g,alt:"Pattern to type",style:{width:"100%",maxWidth:"600px",height:"auto",userSelect:"none",pointerEvents:"none"},onContextMenu:F=>F.preventDefault(),draggable:!1}):d.jsx("span",{className:"pattern-text",children:i})]}),d.jsx("div",{className:"input-section",style:{width:"90%",maxWidth:"900px",margin:"20px auto 0"},children:d.jsx("input",{type:"text",inputMode:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:a,onChange:F=>!E&&l(F.target.value),onKeyPress:F=>{F.key==="Enter"&&!E&&(F.preventDefault(),T())},placeholder:"Type here...",className:"typing-input",disabled:E,style:{backgroundColor:E?"#e3f2fd":"white",transition:"background-color 0.3s",width:"100%",maxWidth:"100%",fontFamily:'"Courier New", monospace',fontSize:"28px",padding:"12px 14px",border:"2px solid #e0e0e0",borderRadius:"8px",boxSizing:"border-box"}})}),d.jsx("button",{onClick:T,className:"submit-btn",disabled:E,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&d.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function vI({practiceCompleted:t={},onPracticeComplete:e,onStartMainGame:n,onSelectPractice:r,isAdmin:i=!1}){const[s,a]=D.useState(null),l=(y,E)=>{if(E&&E.points===2){typeof e=="function"&&e(y,E);const C=document.createElement("div");C.className="notification-enter",C.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",C.textContent="Perfect! Practice task completed. Returning to menu...",document.body.appendChild(C),setTimeout(()=>{a(null),document.body.contains(C)&&document.body.removeChild(C)},1500)}else{const C=(E==null?void 0:E.points)||0,P=document.createElement("div");P.className="notification-enter",P.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #ff9800; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",P.textContent=`Practice requires 100% accuracy. You scored ${C===1?"50%":"0%"}. Try again!`,document.body.appendChild(P),setTimeout(()=>{document.body.contains(P)&&document.body.removeChild(P)},3e3)}},u=t.g2t1&&t.g1t1&&t.g3t1,h=()=>d.jsxs("div",{className:"practice-menu",children:[d.jsxs("h2",{children:["Practice Mode ",!i&&"(Required)"]}),!i&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",borderRadius:"12px",padding:"16px",marginBottom:"25px",border:"2px solid #f57c00",boxShadow:"0 4px 6px rgba(245, 124, 0, 0.1)",textAlign:"center"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:""}),d.jsx("strong",{style:{color:"#e65100",fontSize:"18px"},children:"100% PERFECT ACCURACY REQUIRED"})]}),d.jsxs("div",{style:{color:"#e65100",fontSize:"14px"},children:["You must score 2/2 points (exact answer) on all three practice tasks to proceed.",d.jsx("br",{}),d.jsx("strong",{children:"No partial credit in practice mode!"})]}),d.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"12px"},children:[d.jsxs("span",{style:{padding:"4px 12px",background:t.g2t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g2t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g2t1?"#4CAF50":"#ffb74d"}`},children:["Materials ",t.g2t1?"":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g1t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g1t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g1t1?"#4CAF50":"#ffb74d"}`},children:["Research ",t.g1t1?"":"Required"]}),d.jsxs("span",{style:{padding:"4px 12px",background:t.g3t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g3t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g3t1?"#4CAF50":"#ffb74d"}`},children:["Engagement ",t.g3t1?"":"Required"]})]})]}),d.jsx("p",{className:"practice-hint",style:{textAlign:"center",fontSize:"16px",color:"#666",marginBottom:"30px"},children:"Try each task type before starting the main challenge. No time pressure!"}),d.jsxs("div",{className:"practice-cards",children:[d.jsxs("div",{className:"practice-card materials",children:[d.jsx("h3",{children:" Materials"}),d.jsx("p",{children:"Hold and drag slider to match target values"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Base points - directly added to score"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g2t1"),r&&r("g2t1")},className:t.g2t1?"completed":"",disabled:!1,children:t.g2t1?" Completed":"Try Materials"})})]}),d.jsxs("div",{className:"practice-card research",children:[d.jsx("h3",{children:" Research"}),d.jsx("p",{children:"Count words or letters in text passages"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 15% multiplier per point in main game"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g1t1"),r&&r("g1t1")},className:t.g1t1?"completed":"",disabled:!1,children:t.g1t1?" Completed":"Try Research"})})]}),d.jsxs("div",{className:"practice-card engagement",children:[d.jsx("h3",{children:" Engagement"}),d.jsx("p",{children:"Type patterns exactly as shown"}),d.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 0.15% compound interest per point"}),d.jsx("div",{className:"practice-buttons",children:d.jsx("button",{onClick:()=>{a("g3t1"),r&&r("g3t1")},className:t.g3t1?"completed":"",disabled:!1,children:t.g3t1?" Completed":"Try Engagement"})})]})]}),d.jsxs("div",{style:{marginTop:"25px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h4",{style:{margin:"0 0 10px 0",color:"#333",fontSize:"16px"},children:"Practice Progress:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[d.jsxs("div",{style:{padding:"8px 15px",background:t.g2t1?"#4CAF50":"#e0e0e0",color:t.g2t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Materials ",t.g2t1&&""]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g1t1?"#9C27B0":"#e0e0e0",color:t.g1t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Research ",t.g1t1&&""]}),d.jsxs("div",{style:{padding:"8px 15px",background:t.g3t1?"#f44336":"#e0e0e0",color:t.g3t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Engagement ",t.g3t1&&""]})]}),d.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#666"},children:[d.jsx("strong",{children:"100% accuracy required"})," to complete each practice task"]})]}),d.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:d.jsx("button",{className:"start-main-game-btn",onClick:n,style:{opacity:!i&&!u?.5:1,cursor:!i&&!u?"not-allowed":"pointer"},disabled:!i&&!u,children:i?"Start Main Game (Admin)":u?"Start Main Game - You're Ready! ":"Complete Practice First"})})]});if(!s)return h();const p=s[1],g=1;return d.jsxs("div",{className:"practice-container",children:[d.jsx("button",{className:"back-to-menu",onClick:()=>a(null),children:" Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),d.jsxs("div",{className:"practice-task-wrapper",children:[p==="1"&&d.jsx(kd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:s}),p==="2"&&d.jsx(Rd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:s}),p==="3"&&d.jsx(Pd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:s})]})]})}class _I{constructor(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={}}getUniversalAttemptNumber(){return this.totalAIUsage}shouldAIBeCorrect(e){let n;return e===1||e===2||e===4||e===5?n=!0:e===3?n=!1:n=Math.random()<.75,n}getTaskUsageCount(e){return this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]}incrementTaskUsage(e,n){this.totalAIUsage++,this.usageCount[n]++,this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]++}resetForNewSemester(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={},console.log(" AI Help usage reset for new semester")}helpWithSlider(e,n){this.incrementTaskUsage(n,"materials");const r=this.getUniversalAttemptNumber();let i;if(this.shouldAIBeCorrect(r))i=e;else if(r===3){const s=Math.random()<.5?-1:1;i=Math.max(0,Math.min(10,e+s))}else if(Math.random()<.5){const s=Math.random()<.5?-1:1;i=Math.max(0,Math.min(10,e+s))}else{const s=(Math.random()<.5?-1:1)*(2+Math.random()*2);i=Math.max(0,Math.min(10,e+s))}return{action:"moveSlider",value:i,animate:!0}}helpWithCounting(e,n,r){this.incrementTaskUsage(r,"research");const i=this.getUniversalAttemptNumber(),s=this.shouldAIBeCorrect(i);return n.length===1||n.includes(" and ")||n.includes(",")?this.helpWithLetterCounting(e,n,i,s):this.helpWithWordCounting(e,n,i,s)}helpWithLetterCounting(e,n,r,i){let s=[];n.includes(" and ")||n.includes(",")?s=n.match(/[a-z]/gi)||[]:s=[n];let a=0;s.forEach(h=>{const p=new RegExp(h,"gi"),g=e.match(p);a+=g?g.length:0});let l=a,u=[...s];if(!i){r===3||Math.random()<.5?l=a+1:l=a+Math.floor(Math.random()*3)+2,l=Math.max(0,l);const p="abcdefghijklmnopqrstuvwxyz".split("").filter(y=>!s.includes(y.toLowerCase())),g=Math.floor(Math.random()*2)+1;for(let y=0;y<g&&p.length>0;y++){const E=Math.floor(Math.random()*p.length);u.push(p[E]),p.splice(E,1)}}return{action:"highlightAndCount",highlightWords:[],suggestedCount:l,animate:!0,isMultiLetter:!0,targetLetters:u}}helpWithWordCounting(e,n,r,i){const s=e.split(/\s+/),a=[];let l=0,u=0;if(s.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&u++}),i)s.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&(a.push(h),l++)});else if(r===3){l=u+1,l=Math.max(0,l),s.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=s.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());if(h.length>0&&a.length<l){const p=h[Math.floor(Math.random()*h.length)];a.push(p)}}else{Math.random()<.5?l=u+1:l=u+Math.floor(Math.random()*3)+2,l=Math.max(0,l),s.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=s.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());for(;a.length<l&&h.length>0;){const p=Math.floor(Math.random()*h.length),g=h[p];a.includes(g)||a.push(g),h.splice(p,1)}}return{action:"highlightAndCount",highlightWords:a,suggestedCount:l,animate:!0}}helpWithTyping(e,n){this.incrementTaskUsage(n,"engagement");const r=this.getUniversalAttemptNumber();let i=e;const s={0:["o","O"],o:["0"],O:["0"],1:["l","I","i"],l:["1","I","i"],I:["1","l","i"],i:["1","l","I"],e:["3"],3:["e"],a:["@"],"@":["a"],s:["5","$"],S:["5","$"],5:["s","S"],$:["s","S"],g:["9"],9:["g"],b:["6"],6:["b"],z:["2"],2:["z"],B:["8"],8:["B"]},a=l=>{const u=l.split(""),h=u.map((p,g)=>s[p]?g:-1).filter(p=>p!==-1);if(h.length>0){const p=h[Math.floor(Math.random()*h.length)],g=u[p],y=s[g];y&&y.length>0&&(u[p]=y[Math.floor(Math.random()*y.length)])}else{const p=["transpose","duplicate","missing"],g=p[Math.floor(Math.random()*p.length)],y=Math.floor(Math.random()*u.length);switch(g){case"transpose":y<u.length-1&&([u[y],u[y+1]]=[u[y+1],u[y]]);break;case"duplicate":u.splice(y,0,u[y]);break;case"missing":u.splice(y,1);break}}return u.join("")};if(this.shouldAIBeCorrect(r))i=e;else if(r===3)i=a(e);else if(Math.random()<.5)i=a(e);else{let l=e;const u=Math.floor(Math.random()*3)+2;for(let h=0;h<u;h++)l=a(l);i=l}return{action:"autoType",text:i,typeSpeed:50,perfect:this.shouldAIBeCorrect(r)}}}const bd=new _I;function xI({bonusPrompts:t=0,currentTask:e="",categoryPoints:n=null,timeRemaining:r=null,calculateStudentLearning:i=()=>0,aiCost:s=0,onAiCost:a}){const[l,u]=D.useState(!0),[h,p]=D.useState(0),[g,y]=D.useState(!1);D.useEffect(()=>{const F=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");u(F.hasAI!==!1)},[]),D.useEffect(()=>{if(e){const F=bd.getTaskUsageCount(e)>=1;y(F)}},[e]),D.useEffect(()=>{const F=()=>{p(bd.totalAIUsage)},L=setInterval(F,1e3);return F(),()=>clearInterval(L)},[]);const[E,C]=D.useState([{sender:"bot",text:l?"Hello! I'm your AI teaching assistant. You get ONE AI help attempt per task - use it wisely!":"Hello! This is the chat interface. AI assistance is not available for this session."}]),[P,M]=D.useState(""),[T,w]=D.useState(!1),[k,V]=D.useState({materials:0,research:0,engagement:0});D.useRef(null)}const Fl={generateCode(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`${t}-${e}`.toUpperCase()},async createCode(t={}){return{success:!0,code:this.generateCode(),data:t}},async markCodeAsUsed(t,e){if(!t)return{success:!1,error:"No code provided"};try{const n={code:t,status:"used",usedAt:Tn(),sessionId:e,createdAt:Tn()};return await Cd(Pt(tt,"accessCodes",t),n),{success:!0}}catch(n){return console.error("Error marking code as used:",n),{success:!1,error:n.message}}},async checkCodeUsage(t){if(!t)return{used:!1};try{const e=await uf(Pt(tt,"accessCodes",t));if(e.exists()){const n=e.data();return{used:n.status==="used",sessionId:n.sessionId,usedAt:n.usedAt}}return{used:!1}}catch(e){return console.error("Error checking code usage:",e),{used:!1,error:e.message}}},getCodeFromURL(){const t=new URLSearchParams(window.location.search);return t.get("code")||t.get("c")||null},async verifyQualtricsCode(t){return{valid:!1,reason:"Qualtrics codes not yet supported"}}};function wI({onLoginSuccess:t}){const[e,n]=D.useState(""),[r,i]=D.useState(!1),[s,a]=D.useState(""),[l,u]=D.useState(!1),h={MASTER:{section:"ADMIN-MASTER",role:"master_admin",name:"Master Administrator",hasAI:!1,isMasterInterface:!0},ADMIN:{role:"admin",semesterDuration:72e4,name:"Admin User",hasAI:!0,checkpointSemester2:!0}},p=E=>({section:"TESTING-AI-CP",hasAI:!0,checkpointSemester2:!0,displayName:`${E} (Internal Tester - AI + Checkpoint)`}),g=E=>{if(h[E])return{valid:!0,type:"master",data:h[E]};const C=E.trim().replace(/[^a-zA-Z0-9\s\-_]/g,"");return C.length<2?{valid:!1,error:"Please enter a name with at least 2 characters"}:C.length>50?{valid:!1,error:"Name too long. Please use 50 characters or less"}:{valid:!0,type:"tester",condition:p(C),cleanName:C}},y=async E=>{if(E.preventDefault(),!e.trim()){a("Please enter your name");return}i(!0),a("");try{const C=g(e.trim());if(!C.valid){a(C.error||"Invalid Student ID"),i(!1);return}let P={timestamp:new Date().toISOString()};if(C.type==="master"){if(P={...P,studentIdentifier:e,role:C.data.role,semesterDuration:C.data.semesterDuration,displayName:C.data.name,section:C.data.isTestCode?"ADMIN-TEST":"ADMIN",hasAI:C.data.hasAI,checkpointSemester2:C.data.checkpointSemester2,isMasterCode:!0,isTestCode:C.data.isTestCode||!1,isMasterInterface:C.data.isMasterInterface||!1},C.data.isMasterInterface){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",displayName:C.data.name,section:"master_admin",hasAI:!0,checkpointSemester2:!0})),window.location.href=`${window.location.origin}?master=true`;return}}else if(C.type==="tester"){const T=C.condition,w=C.cleanName;P={...P,studentIdentifier:w,role:"tester",semesterDuration:72e4,displayName:T.displayName,section:T.section,hasAI:T.hasAI,checkpointSemester2:T.checkpointSemester2,isMasterCode:!1,isTestUser:!0}}const M=await Fl.createCode(P);M.success?(sessionStorage.setItem("gameConfig",JSON.stringify({semesterDuration:P.semesterDuration,role:P.role,studentId:P.studentIdentifier,displayName:P.displayName,section:P.section,hasAI:P.hasAI,checkpointSemester2:P.checkpointSemester2})),window.location.href=`${window.location.origin}?code=${M.code}`):a("Failed to generate access code. Please try again.")}catch(C){console.error("Login error:",C),a("System error. Please try again.")}finally{i(!1)}};return d.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",padding:"20px"},children:[d.jsxs("div",{style:{background:"white",padding:"48px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",maxWidth:"480px",width:"100%"},children:[d.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[d.jsxs("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a202c",marginBottom:"8px",lineHeight:"1.2"},children:["Scheduling Challenge:",d.jsx("br",{}),"Can you beat Park?"]}),d.jsx("p",{style:{fontSize:"16px",color:"#718096",marginTop:"12px"},children:"Enter your name to access the game"})]}),d.jsxs("form",{onSubmit:y,children:[d.jsxs("div",{style:{marginBottom:"24px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#2d3748",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.025em"},children:"Your Name:"}),d.jsx("input",{type:"text",value:e,onChange:E=>n(E.target.value),disabled:r,style:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e2e8f0",borderRadius:"8px",boxSizing:"border-box",fontFamily:"'SF Mono', Monaco, 'Courier New', monospace",transition:"all 0.2s ease",background:"#f7fafc",outline:"none"},onFocus:E=>{E.target.style.borderColor="#2196F3",E.target.style.background="white",E.target.style.boxShadow="0 0 0 3px rgba(33, 150, 243, 0.1)"},onBlur:E=>{E.target.style.borderColor="#e2e8f0",E.target.style.background="#f7fafc",E.target.style.boxShadow="none"}}),d.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"#a0aec0",lineHeight:"1.4"},children:"Enter your first and last name (2-50 characters)"})]}),s&&d.jsxs("div",{style:{background:"#fed7d7",color:"#c53030",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",fontSize:"14px",display:"flex",alignItems:"center",border:"1px solid #fc8181"},children:[d.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",style:{marginRight:"8px",flexShrink:0},children:d.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),s]}),d.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:"600",background:r?"#cbd5e0":"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:r?"none":"0 4px 6px rgba(33, 150, 243, 0.25)",transform:r?"none":"translateY(0)"},onMouseDown:E=>{r||(E.target.style.transform="translateY(2px)",E.target.style.boxShadow="0 2px 4px rgba(33, 150, 243, 0.25)")},onMouseUp:E=>{r||(E.target.style.transform="translateY(0)",E.target.style.boxShadow="0 4px 6px rgba(33, 150, 243, 0.25)")},onMouseOver:E=>{r||(E.target.style.background="#1976D2")},onMouseOut:E=>{r||(E.target.style.background="#2196F3")},children:r?d.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[d.jsxs("svg",{className:"animate-spin",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px",animation:"spin 1s linear infinite"},children:[d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",strokeOpacity:"0.25"}),d.jsx("path",{d:"M4 12a8 8 0 018-8",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),"Verifying Name..."]}):"Access Game"})]}),d.jsxs("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[d.jsx("p",{style:{fontSize:"14px",color:"#718096",marginBottom:"12px"},children:"Having trouble? Contact your instructor:"}),d.jsxs("p",{style:{fontSize:"16px",color:"#2196F3",fontWeight:"500"},children:["Park Sinchaisri",d.jsx("br",{}),d.jsx("a",{href:"mailto:parksinchaisri@haas.berkeley.edu",style:{color:"#2196F3",textDecoration:"none",borderBottom:"1px solid #2196F3",fontSize:"15px"},children:"parksinchaisri@haas.berkeley.edu"})]}),l&&d.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#f7fafc",borderRadius:"8px",fontSize:"11px",color:"#4a5568",lineHeight:"1.8"},children:[d.jsx("strong",{children:"Test Codes:"}),d.jsxs("div",{style:{marginTop:"8px",fontFamily:"monospace"},children:[d.jsx("div",{children:"ADMIN (Standard Game Mode)"}),d.jsx("div",{children:"MASTER (Master interface)"})]})]})]})]}),d.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const qm={async checkDailyLimit(t){var r;if(!t)return{allowed:!0};const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);try{const i=Bo(tt,"sessions"),s=rI(i,Bm("studentId","==",t),Bm("startTime",">=",n)),a=await Id(s);if(!a.empty){const l=a.docs[0].data(),u=(r=l.startTime)!=null&&r.toDate?l.startTime.toDate():new Date(l.clientStartTime);return{allowed:!1,reason:"daily_limit",existingSession:l,nextAvailable:new Date(n.getTime()+24*60*60*1e3)}}return{allowed:!0}}catch(i){console.error("Error checking daily limit:",i);const s=`played_${t}_${n.toISOString().split("T")[0]}`;return localStorage.getItem(s)?{allowed:!1,reason:"daily_limit",nextAvailable:new Date(n.getTime()+24*60*60*1e3)}:{allowed:!0}}},async markDailyPlay(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=`played_${t}_${n.toISOString().split("T")[0]}`;localStorage.setItem(r,"true");const i=new Date(Date.now()-7*24*60*60*1e3);for(let s=0;s<localStorage.length;s++){const a=localStorage.key(s);if(a&&a.startsWith("played_")){const l=a.split("_")[2];l&&new Date(l)<i&&localStorage.removeItem(a)}}},async checkAccess(){try{const t=Fl.getCodeFromURL();if(!t)return{allowed:!1,reason:"Please login with your student ID",requiresCode:!0};const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),n=e.role==="admin"||e.role==="master_admin";if(!n&&e.studentId){const r=await this.checkDailyLimit(e.studentId);if(!r.allowed&&!r.refreshGranted){const s=r.nextAvailable;return{allowed:!1,reason:`You have already completed today's session. Please come back in ${Math.ceil((s-Date.now())/(1e3*60*60))} hours (after midnight).`,dailyLimitReached:!0,nextAvailable:s}}if(sessionStorage.getItem("activeSessionId"))return{allowed:!1,reason:"Page refresh is not allowed during the game. Your session has been terminated.",refreshAttempt:!0}}return e.studentId?(n||await this.markDailyPlay(e.studentId),{allowed:!0,newSession:!0,code:t,codeData:{status:"new",metadata:e},isAdmin:n}):{allowed:!1,reason:"Please login with your Berkeley student ID",requiresCode:!0}}catch(t){console.error("Error in checkAccess:",t);const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");return e.role==="admin"?{allowed:!0,newSession:!0,code:Fl.getCodeFromURL(),codeData:{status:"error_bypass",metadata:e},isAdmin:!0}:{allowed:!1,reason:"System error. Please try again.",requiresCode:!0}}},async createSession(t=null,e=null,n=!1){try{const r=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),i=r.role==="admin"||r.role==="master_admin",s={id:crypto.randomUUID(),accessCode:t,studentId:r.studentId||null,role:r.role||"student",semesterDuration:r.semesterDuration||72e4,displayName:r.displayName||"Student",startTime:Tn(),clientStartTime:new Date().toISOString(),status:"active",completedTasks:{},isPractice:n,isAdminSession:i,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`,section:r.section,hasAI:r.hasAI,checkpointSemester2:r.checkpointSemester2},l=(await Bv(Bo(tt,"sessions"),s)).id;return localStorage.setItem("sessionId",l),sessionStorage.setItem("activeSessionId",l),i||(window.addEventListener("beforeunload",u=>{u.preventDefault(),u.returnValue="Your progress will be lost if you leave this page.",this.handleSessionAbandonment()}),document.addEventListener("visibilitychange",()=>{!i&&document.hidden})),l}catch(r){console.error("Error creating session:",r);const i=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(i.role==="admin"){const s="offline-"+Date.now();localStorage.setItem("sessionId",s),sessionStorage.setItem("activeSessionId",s);const a={id:s,accessCode:t,startTime:Date.now(),status:"active",isOffline:!0,studentId:i.studentId||null,role:i.role||"admin"};return localStorage.setItem("offlineSession",JSON.stringify(a)),s}throw r}},async handleSessionAbandonment(){const t=localStorage.getItem("sessionId");if(t&&!t.startsWith("offline-"))try{await Gn(Pt(tt,"sessions",t),{status:"abandoned",abandonedAt:Tn(),abandonReason:"page_unload"})}catch(e){console.error("Error marking session as abandoned:",e)}sessionStorage.removeItem("activeSessionId"),sessionStorage.removeItem("gameConfig")}};function SI(){const[t,e]=D.useState(""),[n,r]=D.useState(!1),[i,s]=D.useState(""),[a,l]=D.useState(!1),u=async()=>{r(!0),s(""),l(!1);try{const p=await Fl.createCode({createdBy:"admin",timestamp:new Date().toISOString()});p.success?e(p.code):s("Failed to generate code: "+p.error)}catch(p){s("Error: "+p.message)}finally{r(!1)}},h=()=>{const p=`${window.location.origin}?code=${t}`;navigator.clipboard.writeText(p),l(!0),setTimeout(()=>l(!1),2e3)};return d.jsxs("div",{style:{padding:"40px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, -apple-system, sans-serif"},children:[d.jsx("h1",{style:{color:"#333",marginBottom:"10px"},children:"Admin Dashboard"}),d.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:"Generate access codes for participants"}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("button",{onClick:u,disabled:n,style:{padding:"12px 30px",fontSize:"16px",background:n?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:"bold"},children:n?"Generating...":"Generate New Access Code"}),t&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"white",borderRadius:"6px",border:"1px solid #e0e0e0"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Generated Code"}),d.jsxs("div",{style:{marginBottom:"20px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Access Code:"}),d.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"18px",fontWeight:"bold"},children:t})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Full URL:"}),d.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"stretch"},children:[d.jsx("input",{type:"text",value:`${window.location.origin}?code=${t}`,readOnly:!0,style:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",background:"#f9f9f9"}}),d.jsx("button",{onClick:h,style:{padding:"10px 20px",background:a?"#4CAF50":"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:a?" Copied!":"Copy URL"})]})]}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"4px",fontSize:"14px",color:"#1976d2"},children:[d.jsx("strong",{children:"Note:"})," This code is valid for 24 hours and can only be used once."]})]}),i&&d.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"#ffebee",color:"#c62828",borderRadius:"4px"},children:i})]}),d.jsxs("div",{style:{marginTop:"40px",padding:"20px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666"},children:[d.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"How to use:"}),d.jsxs("ol",{style:{margin:"10px 0",paddingLeft:"20px"},children:[d.jsx("li",{children:"Generate a code using the button above"}),d.jsx("li",{children:"Copy the full URL"}),d.jsx("li",{children:"Share the URL with participants"}),d.jsx("li",{children:"Each participant can use their unique code once"})]})]})]})}function EI({sessionId:t,completedLevels:e,totalTime:n,gameMode:r}){const[i,s]=D.useState(""),[a,l]=D.useState(!1);D.useEffect(()=>{u()},[]);const u=()=>{const p=Date.now().toString(36).toUpperCase(),g=e.toString().padStart(2,"0"),y=r.limit==="time"?"T":"A",E=r.accuracy==="strict"?"S":"L",M=`GAME-${`${t}-${g}-${n}`.split("").reduce((T,w)=>T+w.charCodeAt(0),0).toString(36).toUpperCase().slice(-3)}-${g}-${y}${E}-${p}`;s(M)},h=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(i),l(!0),setTimeout(()=>l(!1),3e3);else{const p=document.createElement("textarea");p.value=i,p.style.position="fixed",p.style.top="0",p.style.left="0",p.style.width="2em",p.style.height="2em",p.style.padding="0",p.style.border="none",p.style.outline="none",p.style.boxShadow="none",p.style.background="transparent",p.style.opacity="0",document.body.appendChild(p),p.focus(),p.select();try{document.execCommand("copy")?(l(!0),setTimeout(()=>l(!1),3e3)):(console.error("Failed to copy using execCommand"),alert("Copy failed. Please manually select and copy the code."))}catch(g){console.error("Failed to copy:",g),alert("Copy failed. Please manually select and copy the code.")}document.body.removeChild(p)}}catch(p){console.error("Clipboard operation failed:",p),alert(`Copy failed. Here's your code to copy manually:

${i}`)}};return d.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"30px",marginTop:"30px",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},children:[d.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:" Your Completion Code"}),d.jsx("p",{style:{marginBottom:"20px",opacity:.9,fontSize:"16px"},children:"Copy this code and paste it into the Qualtrics survey to verify your completion:"}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"20px",marginBottom:"20px",backdropFilter:"blur(10px)"},children:[d.jsx("div",{style:{fontFamily:"monospace",fontSize:"28px",fontWeight:"bold",letterSpacing:"2px",marginBottom:"15px",wordBreak:"break-all",textShadow:"2px 2px 4px rgba(0,0,0,0.2)",userSelect:"text",cursor:"text"},onClick:p=>{const g=window.getSelection(),y=document.createRange();y.selectNodeContents(p.currentTarget),g.removeAllRanges(),g.addRange(y)},title:"Click to select all text",children:i}),d.jsx("button",{onClick:h,style:{padding:"12px 30px",fontSize:"16px",fontWeight:"bold",background:a?"#4CAF50":"white",color:a?"white":"#764ba2",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:a?" Copied!":" Copy Code"})]}),d.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:"6px",padding:"15px",fontSize:"14px",lineHeight:"1.5"},children:[d.jsx("strong",{children:" Important:"})," This code is your proof of completion. Make sure to copy it before closing this window!",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"13px",opacity:.9},children:" Tip: If the Copy button doesn't work, click on the code text to select it, then use Ctrl+C (or Cmd+C on Mac) to copy."})]}),d.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[d.jsx("summary",{style:{cursor:"pointer",opacity:.8,fontSize:"12px",marginBottom:"10px"},children:"Code Details "}),d.jsxs("div",{style:{fontSize:"12px",opacity:.7,background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",fontFamily:"monospace"},children:[d.jsxs("div",{children:["Levels Completed: ",e,"/45"]}),d.jsxs("div",{children:["Game Mode: ",r.limit==="time"?"Time Challenge":"Task Attempts"]}),d.jsxs("div",{children:["Accuracy Mode: ",r.accuracy==="strict"?"Strict (100%)":"Lenient"]}),d.jsxs("div",{children:["Total Time: ",Math.floor(n/60),"m ",n%60,"s"]}),d.jsxs("div",{children:["Generated: ",new Date().toLocaleString()]})]})]})]})}function TI({onClose:t}){const[e,n]=D.useState("config"),[r,i]=D.useState([]),[s,a]=D.useState(!0),[l,u]=D.useState(!1),[h,p]=D.useState(""),[g,y]=D.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,wrongAnswerPenalty:2,switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0,taskOrderStrategy:"sequential_task",difficultyMode:"fixed"}),[E,C]=D.useState(!1);D.useEffect(()=>{P(),w()},[]);const P=async()=>{try{const v=Pt(tt,"game_settings","global"),m=await uf(v);m.exists()&&y({...g,...m.data()})}catch(v){console.error("Error loading game config:",v)}},M=async()=>{C(!0);try{const v=Pt(tt,"game_settings","global");await Cd(v,g,{merge:!0}),alert("Configuration saved successfully!")}catch(v){console.error("Error saving config:",v),alert("Failed to save configuration")}finally{C(!1)}},T=(v,m)=>{y(x=>({...x,[v]:m}))},w=async()=>{a(!0);try{const v=Bo(tt,"students"),x=(await Id(v)).docs.map(S=>({id:S.id,...S.data()}));i(x)}catch(v){console.error("Error fetching students:",v)}finally{a(!1)}},k=async()=>{if(window.confirm("Are you sure you want to reset ALL student data? This cannot be undone!")){u(!0);try{const v=Bo(tt,"students"),m=await Id(v);for(const x of m.docs)await Cd(Pt(tt,"students",x.id),{hasPlayed:!1,totalAccesses:0,scores:[]},{merge:!0});alert("All student data has been reset!"),await w()}catch(v){console.error("Error resetting data:",v),alert("Failed to reset data")}finally{u(!1)}}},V=v=>({padding:"12px 24px",background:v?"#2196F3":"transparent",color:v?"white":"#666",border:"none",borderBottom:v?"3px solid #2196F3":"3px solid transparent",cursor:"pointer",fontSize:"14px",fontWeight:v?"600":"normal",transition:"all 0.2s"}),F=r.filter(v=>{var m;return!((m=v.section)!=null&&m.includes("ADMIN"))}).length,L=r.filter(v=>{var m;return!((m=v.section)!=null&&m.includes("ADMIN"))&&v.hasPlayed}).length;return d.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[d.jsx("h1",{style:{margin:0,color:"#333"},children:" Master Admin Dashboard"}),d.jsx("button",{onClick:t,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"500"},children:"Exit Admin"})]}),d.jsxs("div",{style:{display:"flex",borderBottom:"1px solid #e0e0e0",marginBottom:"30px"},children:[d.jsx("button",{onClick:()=>n("config"),style:V(e==="config"),children:" Game Configuration"}),d.jsx("button",{onClick:()=>n("players"),style:V(e==="players"),children:" Player Data"}),d.jsx("button",{onClick:()=>n("advice"),style:V(e==="advice"),children:" Game Advice"})]}),e==="config"&&d.jsxs("div",{children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"20px",marginBottom:"20px"},children:[d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Time & Semesters"}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Semester Duration (Minutes)"}),d.jsx("input",{type:"number",value:g.semesterDuration,onChange:v=>T("semesterDuration",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Semesters"}),d.jsx("input",{type:"number",value:g.totalSemesters,onChange:v=>T("totalSemesters",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("input",{type:"checkbox",checked:g.midtermEnabled,onChange:v=>T("midtermEnabled",v.target.checked),id:"midtermCheck"}),d.jsx("label",{htmlFor:"midtermCheck",style:{fontSize:"13px",cursor:"pointer"},children:"Enable Midterm Checkpoint"})]})]}),d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Task Settings"}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Total Tasks per Semester"}),d.jsx("input",{type:"number",value:g.totalTasks,onChange:v=>T("totalTasks",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Difficulty Configuration"}),d.jsxs("select",{value:g.difficultyMode||"fixed",onChange:v=>T("difficultyMode",v.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[d.jsx("option",{value:"fixed",children:"Fixed (50% Easy, 30% Medium, 20% Hard)"}),d.jsx("option",{value:"manual",children:"Manual (User chooses difficulty)"})]})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Task Order Strategy"}),d.jsxs("select",{value:g.taskOrderStrategy,onChange:v=>T("taskOrderStrategy",v.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"},children:[d.jsx("option",{value:"sequential_task",children:"Order by Task (Materials  Research  Engagement)"}),d.jsx("option",{value:"sequential_difficulty",children:"Order by Difficulty (Easy  Medium  Hard)"})]})]})]}),d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#555"},children:" Penalties & Mechanics"}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"AI Help Cost (Points)"}),d.jsx("input",{type:"number",value:g.aiCost,onChange:v=>T("aiCost",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),d.jsxs("div",{style:{marginBottom:"15px"},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"13px",fontWeight:"600"},children:"Incorrect Answer Penalty (Points)"}),d.jsx("input",{type:"number",value:g.wrongAnswerPenalty||2,onChange:v=>T("wrongAnswerPenalty",parseInt(v.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px"}})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Switch Cost (Points)"}),d.jsx("input",{type:"number",value:g.switchCost||0,onChange:v=>T("switchCost",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Refill Freeze (Seconds)"}),d.jsx("input",{type:"number",value:g.jarRefillFreezeTime||0,onChange:v=>T("jarRefillFreezeTime",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"Unfinished Jar Penalty (Pts)"}),d.jsx("input",{type:"number",value:g.unfinishedJarPenalty||0,onChange:v=>T("unfinishedJarPenalty",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]}),d.jsxs("div",{children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"600"},children:"AI Delay (Seconds)"}),d.jsx("input",{type:"number",value:g.aiDelay||0,onChange:v=>T("aiDelay",parseInt(v.target.value)),style:{width:"100%",padding:"6px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"13px"}})]})]})]})]}),d.jsx("div",{style:{textAlign:"right"},children:d.jsx("button",{onClick:M,disabled:E,style:{padding:"12px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:E?"not-allowed":"pointer",fontWeight:"600",fontSize:"14px",opacity:E?.6:1},children:E?"Saving...":" Save Settings"})})]}),e==="players"&&d.jsxs("div",{style:{background:"white",padding:"25px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[d.jsx("h2",{style:{margin:0,fontSize:"18px"},children:"Active Sessions"}),d.jsx("button",{onClick:k,disabled:l,style:{padding:"10px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:l?"not-allowed":"pointer",fontWeight:"500",opacity:l?.6:1},children:l?"Processing...":" Reset All Data"})]}),d.jsx("div",{style:{marginBottom:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"6px"},children:d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",textAlign:"center"},children:[d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:F}),d.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Total Students"})]}),d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:L}),d.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Have Played"})]}),d.jsxs("div",{children:[d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:F-L}),d.jsx("div",{style:{fontSize:"13px",color:"#666"},children:"Never Played"})]})]})}),s?d.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"Loading student data..."}):d.jsx("div",{style:{overflowX:"auto"},children:d.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[d.jsx("thead",{children:d.jsxs("tr",{style:{background:"#f5f5f5",textAlign:"left"},children:[d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Student ID"}),d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Section"}),d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Has Played"}),d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Total Accesses"}),d.jsx("th",{style:{padding:"12px",borderBottom:"2px solid #ddd",fontSize:"13px"},children:"Highest Score"})]})}),d.jsx("tbody",{children:r.filter(v=>{var m;return!((m=v.section)!=null&&m.includes("ADMIN"))}).map(v=>d.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[d.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:v.sid||v.id}),d.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:v.section||"N/A"}),d.jsx("td",{style:{padding:"12px",fontSize:"13px"},children:d.jsx("span",{style:{padding:"4px 12px",borderRadius:"12px",background:v.hasPlayed?"#e8f5e9":"#f5f5f5",color:v.hasPlayed?"#4CAF50":"#999",fontSize:"12px",fontWeight:"500"},children:v.hasPlayed?"Yes":"No"})}),d.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600"},children:v.totalAccesses||0}),d.jsx("td",{style:{padding:"12px",fontSize:"13px",fontWeight:"600",color:"#2196F3"},children:v.scores&&v.scores.length>0?Math.max(...v.scores.map(m=>m.total||0)):0})]},v.id))})]})})]}),e==="advice"&&d.jsxs("div",{style:{background:"white",padding:"60px 40px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:""}),d.jsx("h2",{style:{fontSize:"24px",color:"#666",marginBottom:"15px",fontWeight:"500"},children:"Game Advice Configuration"}),d.jsx("p",{style:{color:"#999",maxWidth:"600px",margin:"0 auto 30px",lineHeight:"1.6"},children:"Configure contextual advice prompts based on remaining time and tasks completed. This feature will allow you to define dynamic advice messages for different game states."}),d.jsxs("div",{style:{marginTop:"40px",padding:"30px",background:"#f9f9f9",borderRadius:"8px",maxWidth:"500px",margin:"40px auto 0",border:"2px dashed #ddd"},children:[d.jsx("p",{style:{color:"#666",fontSize:"15px",margin:0,fontWeight:"500"},children:"Coming Soon: Dynamic 2D Advice Matrix"}),d.jsx("p",{style:{color:"#999",fontSize:"13px",margin:"10px 0 0",lineHeight:"1.5"},children:"Define advice based on time remaining  tasks completed thresholds"})]})]})]})}const II={notifyGameComplete(t={}){try{window.parent.postMessage({type:"gameComplete",status:"finished",timestamp:new Date().toISOString(),...t},"*");try{if(window.parent&&window.parent.document){const e=window.parent.document.querySelector("#NextButton");e&&(e.style.display="inline-block",e.style.visibility="visible",e.disabled=!1)}}catch{window.parent.postMessage({type:"showNextButton",action:"show"},"*")}console.log(" Game completion notification sent to Qualtrics")}catch(e){console.error("Failed to notify Qualtrics:",e)}},notifySemesterComplete(t,e,n={}){try{window.parent.postMessage({type:"semesterComplete",semester:t,totalSemesters:e,timestamp:new Date().toISOString(),...n},"*"),window.parent.postMessage({type:"keepNextButtonVisible",action:"maintain"},"*"),console.log(` Semester ${t} completion notification sent`)}catch(r){console.error("Failed to notify Qualtrics of semester completion:",r)}},ensureNextButtonVisible(){try{window.parent.postMessage({type:"ensureNextButton",action:"show",timestamp:new Date().toISOString()},"*")}catch(t){console.error("Failed to ensure Next button visibility:",t)}}};function CI({onStart:t,totalTasks:e=10,orderStrategy:n="sequential_task",durationMinutes:r=12,difficultyMode:i="fixed"}){const[s,a]=D.useState({g2:0,g1:0,g3:0}),[l,u]=D.useState({g2:{easy:0,medium:0,hard:0},g1:{easy:0,medium:0,hard:0},g3:{easy:0,medium:0,hard:0}}),[h,p]=D.useState([]),[g,y]=D.useState(0),[E,C]=D.useState(null),P=["It's generally smart to do roughly an even number of each task.","This is because the tasks that are worth more points take more time to do, so you don't want to only do the shorter tasks or only do the longer tasks.","Of course, you might prefer one task over another, so you could take that into account. Do you feel like you are particularly good at one of the tasks?"],M=()=>{g<P.length?(p(m=>[...m,{sender:"AI",text:P[g]}]),y(m=>m+1)):p(m=>[...m,{sender:"AI",text:"I've shared my best advice! It's up to you now."}])},T=(m,x)=>{const S=parseInt(x)||0;a(A=>({...A,[m]:Math.max(0,S)})),C(null)},w=(m,x,S)=>{const A=parseInt(S)||0;u(R=>({...R,[m]:{...R[m],[x]:Math.max(0,A)}})),C(null)},F=i==="manual"?(()=>{let m=0;return Object.values(l).forEach(x=>{m+=x.easy+x.medium+x.hard}),m})():Object.values(s).reduce((m,x)=>m+x,0),L=F===e,v=()=>{if(F!==e){C(`Total tasks must equal ${e}. Currently: ${F}`);return}let m=[];i==="fixed"?["g2","g1","g3"].forEach(se=>{const ne=s[se];if(ne>0){const ie=Math.max(0,Math.round(ne*.5)),$=Math.max(0,Math.round(ne*.3)),N=Math.max(0,ne-ie-$);for(let O=0;O<ie;O++)m.push({type:se,difficulty:"easy"});for(let O=0;O<$;O++)m.push({type:se,difficulty:"medium"});for(let O=0;O<N;O++)m.push({type:se,difficulty:"hard"})}}):["g2","g1","g3"].forEach(se=>{const{easy:ne,medium:ie,hard:$}=l[se];for(let N=0;N<ne;N++)m.push({type:se,difficulty:"easy"});for(let N=0;N<ie;N++)m.push({type:se,difficulty:"medium"});for(let N=0;N<$;N++)m.push({type:se,difficulty:"hard"})});const x={g2:{easy:1,medium:6,hard:11},g1:{easy:1,medium:6,hard:11},g3:{easy:1,medium:6,hard:11}},S=m.map(se=>{const{type:ne,difficulty:ie}=se,$=x[ne][ie]++;return{...se,id:`${ne}t${$}`}});let A=[];if(n==="sequential_difficulty"){const se={easy:1,medium:2,hard:3},ne={g2:1,g1:2,g3:3};A=S.sort((ie,$)=>se[ie.difficulty]!==se[$.difficulty]?se[ie.difficulty]-se[$.difficulty]:ne[ie.type]-ne[$.type])}else{const se={g2:1,g1:2,g3:3},ne={easy:1,medium:2,hard:3};A=S.sort((ie,$)=>se[ie.type]!==se[$.type]?se[ie.type]-se[$.type]:ne[ie.difficulty]-ne[$.difficulty])}const R=A.map(se=>se.id),I=i==="fixed"?s:{g2:l.g2.easy+l.g2.medium+l.g2.hard,g1:l.g1.easy+l.g1.medium+l.g1.hard,g3:l.g3.easy+l.g3.medium+l.g3.hard};t(R,I)};return d.jsxs("div",{style:{maxWidth:"900px",margin:"40px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[d.jsx("h1",{style:{textAlign:"center",marginBottom:"30px",color:"#333"},children:"Task Allocation Strategy"}),d.jsxs("div",{style:{marginBottom:"30px",lineHeight:"1.6",color:"#555"},children:[d.jsxs("p",{children:["You have ",d.jsxs("strong",{children:[r," minutes"]})," to complete ",d.jsxs("strong",{children:[e," tasks"]}),"."]}),d.jsx("p",{children:"You must decide now how many of each task type you want to perform."}),d.jsxs("p",{children:["Total tasks must add up to ",d.jsx("strong",{children:e}),"."]}),i==="fixed"&&d.jsx("p",{style:{fontSize:"14px",fontStyle:"italic",color:"#666"},children:"* Tasks are automatically distributed as 50% Easy, 30% Medium, 20% Hard."})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"40px",marginBottom:"40px"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[i==="fixed"?d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:sc,children:[d.jsxs("label",{style:ac,children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 1: Slider (Materials)"]}),d.jsx("input",{type:"number",min:"0",max:e,value:s.g2,onChange:m=>T("g2",m.target.value),style:lc})]}),d.jsxs("div",{style:sc,children:[d.jsxs("label",{style:ac,children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 2: Counting (Research)"]}),d.jsx("input",{type:"number",min:"0",max:e,value:s.g1,onChange:m=>T("g1",m.target.value),style:lc})]}),d.jsxs("div",{style:sc,children:[d.jsxs("label",{style:ac,children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 3: Typing (Engagement)"]}),d.jsx("input",{type:"number",min:"0",max:e,value:s.g3,onChange:m=>T("g3",m.target.value),style:lc})]})]}):d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[d.jsxs("div",{style:oc,children:[d.jsxs("div",{style:{fontWeight:"bold",marginBottom:"10px",display:"flex",alignItems:"center"},children:[d.jsx("span",{style:{fontSize:"20px",marginRight:"10px"},children:""})," Materials (Slider)"]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[d.jsx(Wn,{label:"Easy",value:l.g2.easy,onChange:m=>w("g2","easy",m)}),d.jsx(Wn,{label:"Medium",value:l.g2.medium,onChange:m=>w("g2","medium",m)}),d.jsx(Wn,{label:"Hard",value:l.g2.hard,onChange:m=>w("g2","hard",m)})]})]}),d.jsxs("div",{style:oc,children:[d.jsxs("div",{style:{fontWeight:"bold",marginBottom:"10px",display:"flex",alignItems:"center"},children:[d.jsx("span",{style:{fontSize:"20px",marginRight:"10px"},children:""})," Research (Counting)"]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[d.jsx(Wn,{label:"Easy",value:l.g1.easy,onChange:m=>w("g1","easy",m)}),d.jsx(Wn,{label:"Medium",value:l.g1.medium,onChange:m=>w("g1","medium",m)}),d.jsx(Wn,{label:"Hard",value:l.g1.hard,onChange:m=>w("g1","hard",m)})]})]}),d.jsxs("div",{style:oc,children:[d.jsxs("div",{style:{fontWeight:"bold",marginBottom:"10px",display:"flex",alignItems:"center"},children:[d.jsx("span",{style:{fontSize:"20px",marginRight:"10px"},children:""})," Engagement (Typing)"]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[d.jsx(Wn,{label:"Easy",value:l.g3.easy,onChange:m=>w("g3","easy",m)}),d.jsx(Wn,{label:"Medium",value:l.g3.medium,onChange:m=>w("g3","medium",m)}),d.jsx(Wn,{label:"Hard",value:l.g3.hard,onChange:m=>w("g3","hard",m)})]})]})]}),d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:L?"#e8f5e9":"#ffebee",borderRadius:"8px",textAlign:"center",fontWeight:"bold",color:L?"#2e7d32":"#c62828"},children:["Total Allocated: ",F," / ",e]}),E&&d.jsx("div",{style:{color:"red",textAlign:"center",fontSize:"14px"},children:E})]}),d.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"12px",padding:"20px",display:"flex",flexDirection:"column"},children:[d.jsxs("div",{style:{flex:1,marginBottom:"15px",overflowY:"auto",maxHeight:"300px",display:"flex",flexDirection:"column",gap:"10px"},children:[h.length===0&&d.jsx("div",{style:{color:"#999",fontStyle:"italic",textAlign:"center",marginTop:"40px"},children:"Need advice? Ask the AI helper."}),h.map((m,x)=>d.jsxs("div",{style:{background:"#f0f7ff",padding:"10px 15px",borderRadius:"12px 12px 12px 0",alignSelf:"flex-start",maxWidth:"90%"},children:[d.jsx("strong",{children:" AI:"})," ",m.text]},x))]}),d.jsxs("button",{onClick:M,style:{background:"#2196F3",color:"white",border:"none",padding:"12px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[d.jsx("span",{children:""})," Ask AI for Recommendation"]})]})]}),d.jsx("div",{style:{textAlign:"center"},children:d.jsx("button",{onClick:v,disabled:!L,style:{background:L?"#4CAF50":"#ccc",color:"white",border:"none",padding:"15px 40px",fontSize:"18px",borderRadius:"30px",cursor:L?"pointer":"not-allowed",fontWeight:"bold",boxShadow:L?"0 4px 15px rgba(76, 175, 80, 0.3)":"none",transition:"all 0.2s"},children:"Start Experiment"})})]})}const Wn=({label:t,value:e,onChange:n})=>d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[d.jsx("label",{style:{fontSize:"12px",marginBottom:"4px",color:"#666"},children:t}),d.jsx("input",{type:"number",min:"0",value:e,onChange:r=>n(r.target.value),style:{width:"50px",padding:"8px",textAlign:"center",border:"1px solid #ddd",borderRadius:"4px"}})]}),sc={display:"flex",alignItems:"center",justifyContent:"space-between",background:"#f9f9f9",padding:"15px",borderRadius:"8px"},oc={background:"#f9f9f9",padding:"15px",borderRadius:"8px",border:"1px solid #eee"},ac={fontWeight:"bold",color:"#333",display:"flex",alignItems:"center"},lc={width:"60px",padding:"10px",fontSize:"18px",textAlign:"center",borderRadius:"6px",border:"1px solid #ddd"};function AI({currentTaskIndex:t,totalTasks:e,taskQueue:n,onSwitchTask:r,onRefill:i,children:s,points:a,timeRemaining:l,onTimeUp:u,chatInterface:h}){const p=n[t],g=M=>M.startsWith("g1")?{name:"Research",icon:"",color:"#9C27B0"}:M.startsWith("g2")?{name:"Materials",icon:"",color:"#4CAF50"}:M.startsWith("g3")?{name:"Engagement",icon:"",color:"#f44336"}:{name:"Unknown",icon:"",color:"#333"};g(p);const y={g1:n.filter(M=>M.startsWith("g1")).length,g2:n.filter(M=>M.startsWith("g2")).length,g3:n.filter(M=>M.startsWith("g3")).length},E=y.g1>0,C=y.g2>0,P=y.g3>0;return d.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",padding:"20px"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"white",padding:"15px 25px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[d.jsx("div",{style:{width:"200px"},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""}),d.jsx("div",{children:d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:l<60?"#f44336":"#333",animation:l<60?"pulse 1s infinite":"none"},children:[Math.floor(l/60),":",(l%60).toString().padStart(2,"0")]})})]})}),d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Points"}),d.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#2196F3"},children:a})]}),d.jsxs("div",{style:{textAlign:"right",width:"200px"},children:[d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Task Progress"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[t+1," / ",e]})]})]}),d.jsxs("div",{className:"task-runner-layout",style:{display:"grid",gridTemplateColumns:"250px 1fr 300px",gap:"20px",height:"calc(100vh - 140px)",boxSizing:"border-box"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#666"},children:"Task Jars"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[d.jsxs("button",{disabled:!C||p.startsWith("g2"),onClick:()=>r("g2"),style:uc(C&&!p.startsWith("g2"),"#4CAF50"),children:[d.jsx("span",{children:""})," Materials (",y.g2,")"]}),!C&&d.jsx("button",{onClick:()=>i&&i("g2"),style:cc,children:" Refill Materials"})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[d.jsxs("button",{disabled:!E||p.startsWith("g1"),onClick:()=>r("g1"),style:uc(E&&!p.startsWith("g1"),"#9C27B0"),children:[d.jsx("span",{children:""})," Research (",y.g1,")"]}),!E&&d.jsx("button",{onClick:()=>i&&i("g1"),style:cc,children:" Refill Research"})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[d.jsxs("button",{disabled:!P||p.startsWith("g3"),onClick:()=>r("g3"),style:uc(P&&!p.startsWith("g3"),"#f44336"),children:[d.jsx("span",{children:""})," Engagement (",y.g3,")"]}),!P&&d.jsx("button",{onClick:()=>i&&i("g3"),style:cc,children:" Refill Engagement"})]})]})]}),d.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",flex:1,overflowY:"auto"},children:[d.jsx("h3",{style:{margin:"0 0 15px 0",fontSize:"16px",color:"#666"},children:"Up Next"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[n.slice(t+1,t+6).map((M,T)=>{const w=g(M);return d.jsxs("div",{style:{padding:"10px",background:"#f8f9fa",borderRadius:"6px",borderLeft:`3px solid ${w.color}`,fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{children:w.icon}),d.jsx("span",{children:w.name})]},T)}),n.length>t+6&&d.jsxs("div",{style:{textAlign:"center",color:"#999",fontSize:"12px",marginTop:"5px"},children:["+ ",n.length-(t+6)," more"]})]})]})]}),d.jsx("div",{style:{background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",overflow:"hidden",display:"flex",flexDirection:"column"},children:s}),d.jsx("div",{children:h&&d.jsx("div",{style:{position:"sticky",top:"20px"},children:h})})]}),d.jsx("style",{children:`
        @keyframes pulse {
          0% { opacity: 1; }
          50% { opacity: 0.5; }
          100% { opacity: 1; }
        }
      `})]})}const uc=(t,e)=>({display:"flex",alignItems:"center",gap:"10px",padding:"12px",border:`1px solid ${t?e:"#ddd"}`,borderRadius:"8px",background:t?"white":"#f5f5f5",color:t?e:"#999",cursor:t?"pointer":"not-allowed",fontWeight:"bold",transition:"all 0.2s",opacity:t?1:.7}),cc={padding:"8px",fontSize:"12px",background:"#eee",border:"1px dashed #999",borderRadius:"4px",cursor:"pointer",color:"#333",marginTop:"5px"};function kI({timeRemaining:t,onSelectTask:e,onFinishEarly:n}){return d.jsxs("div",{style:{maxWidth:"800px",margin:"40px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsx("h1",{style:{color:"#2196F3",marginBottom:"20px"},children:" All Tasks Completed!"}),d.jsxs("div",{style:{fontSize:"18px",color:"#555",marginBottom:"30px",lineHeight:"1.6"},children:[d.jsx("p",{children:"You have finished all 10 allocated tasks with time to spare."}),d.jsxs("p",{children:["You currently have ",d.jsxs("strong",{children:[Math.floor(t/60)," minutes and ",t%60," seconds"]})," remaining."]}),d.jsxs("p",{children:["You can choose to do more tasks for ",d.jsx("strong",{children:"1/2 credit"})," to increase your score, or finish the experiment now."]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"40px"},children:[d.jsxs("button",{onClick:()=>e("g2"),style:dc("#4CAF50"),children:[d.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Materials Task",d.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),d.jsxs("button",{onClick:()=>e("g1"),style:dc("#9C27B0"),children:[d.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Research Task",d.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),d.jsxs("button",{onClick:()=>e("g3"),style:dc("#f44336"),children:[d.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Engagement Task",d.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]})]}),d.jsx("div",{style:{borderTop:"1px solid #eee",paddingTop:"30px"},children:d.jsx("button",{onClick:n,style:{background:"#f5f5f5",color:"#666",border:"1px solid #ddd",padding:"12px 30px",fontSize:"16px",borderRadius:"30px",cursor:"pointer",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:r=>r.target.style.background="#e0e0e0",onMouseLeave:r=>r.target.style.background="#f5f5f5",children:"No thanks, I'm done"})})]})}const dc=t=>({background:"white",border:`2px solid ${t}`,color:t,padding:"20px",borderRadius:"12px",cursor:"pointer",fontSize:"16px",fontWeight:"bold",transition:"all 0.2s",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"});function RI(t,e){const n=t.length,r=e.length,i=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let s=0;s<=n;s++)i[s][0]=s;for(let s=0;s<=r;s++)i[0][s]=s;for(let s=1;s<=n;s++)for(let a=1;a<=r;a++)t[s-1]===e[a-1]?i[s][a]=i[s-1][a-1]:i[s][a]=Math.min(i[s-1][a]+1,i[s][a-1]+1,i[s-1][a-1]+1);return i[n][r]}function PI(){const e=new URLSearchParams(window.location.search).get("admin")==="berkeley2024",[n,r]=D.useState("landing"),[i,s]=D.useState(null),[a,l]=D.useState(null),[u,h]=D.useState("g2t1"),[p,g]=D.useState({}),[y,E]=D.useState(0),[C,P]=D.useState(null),[M,T]=D.useState(!1),[w,k]=D.useState(""),[V,F]=D.useState(!0),[L,v]=D.useState(0),[m,x]=D.useState({}),[S,A]=D.useState(0),[R,I]=D.useState(0),[se,ne]=D.useState(!1),[ie,$]=D.useState(null),[N,O]=D.useState(!1),[G,Z]=D.useState(30),[ee,le]=D.useState(!1),[Ae,we]=D.useState(5),[pe,de]=D.useState(!1),[Fe,Se]=D.useState(0),[te,ke]=D.useState(1),[ze]=D.useState(2),[Re,wt]=D.useState([]),[qt,Gt]=D.useState(null),[Qt,Kt]=D.useState(!1),[lr,ur]=D.useState(0),[bn,cr]=D.useState(null),[Pe,As]=D.useState({g2t1:!1,g1t1:!1,g3t1:!1}),[ta,it]=D.useState(720),[Qe,dr]=D.useState(720),[wi,na]=D.useState(0),[Ee,ln]=D.useState({materials:0,research:0,engagement:0,bonus:0}),[Hr,Si]=D.useState({}),[ra,ia]=D.useState({}),[df,Ei]=D.useState({}),[ht,sa]=D.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,unfinishedTaskPenalty:0,taskOrderStrategy:"sequential_task",freezePenalty:0,contextAdviceEnabled:!0,difficultyMode:"fixed",switchCost:0,jarRefillFreezeTime:0,unfinishedJarPenalty:0,aiDelay:0});D.useEffect(()=>{(async()=>{try{const B=Pt(tt,"game_settings","global"),H=await uf(B);if(H.exists()){const X=H.data();if(sa(he=>({...he,...X})),X.semesterDuration){const he=X.semesterDuration*60;it(he),dr(he),vu.current=he,Gr.current=he}}}catch(B){console.error("Error loading global config:",B)}})()},[]);const[Yt,qr]=D.useState([]),[Bn,Dn]=D.useState(0),[oa,Ti]=D.useState(null),[yu,Ii]=D.useState(!1),Ci=D.useRef(Date.now()),Ke=D.useRef(null);D.useRef(null),D.useRef(null);const Ai=D.useRef(null),hr=D.useRef(Date.now()),Gr=D.useRef(720),vu=D.useRef(720),Qr=()=>{const q=(ht.semesterDuration||12)*60*1e3,B=Math.floor(q/2e3);return Math.floor(B/60)};if(D.useEffect(()=>{(async()=>{try{const B=new URLSearchParams(window.location.search),H=B.has("code")||B.has("c");if((B.get("code")||B.get("c"))==="MASTER"){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",section:"master_admin",hasAI:!1,isMasterInterface:!0,displayName:"Master Administrator"})),F(!1);return}if(e&&!sessionStorage.getItem("gameConfig")&&sessionStorage.setItem("gameConfig",JSON.stringify({role:"admin",section:"admin",hasAI:!0,checkpointSemester2:!0,displayName:"Admin User"})),!H){r("studentLogin"),F(!1);return}const{allowed:he,reason:Me,resumeSession:Le,newSession:He,code:St,codeData:Dt}=await qm.checkAccess();if(!he){T(!0),k(Me),F(!1);return}if(Le)P(Le),localStorage.setItem("sessionId",Le);else if(He){const cn=await qm.createSession(St,Dt);P(cn)}await et.syncOfflineEvents(),F(!1)}catch{F(!1)}})()},[]),D.useEffect(()=>{n==="complete"&&te>=ze&&II.notifyGameComplete({finalScore:Math.round(Xt())+(Ee.bonus||0),totalTime:L,semestersCompleted:te,sessionId:C})},[n,te,ze,L,Ee.bonus,C]),D.useEffect(()=>{localStorage.setItem("currentTask",u)},[u]),D.useEffect(()=>{localStorage.setItem("gameMode",JSON.stringify(i))},[i]),D.useEffect(()=>{localStorage.setItem("currentSemester",te.toString())},[te]),D.useEffect(()=>{localStorage.setItem("totalSemesters",ze.toString())},[ze]),D.useEffect(()=>{localStorage.setItem("completedTasksCount",Object.keys(p).length.toString())},[p]),D.useEffect(()=>{localStorage.setItem("completedLevels",y.toString())},[y]),D.useEffect(()=>{localStorage.setItem("totalSwitches",S.toString())},[S]),D.useEffect(()=>{localStorage.setItem("categoryPoints",JSON.stringify(Ee))},[Ee]),D.useEffect(()=>{localStorage.setItem("studentLearningScore",wi.toString())},[wi]),D.useEffect(()=>{const q=Pe.g2t1&&Pe.g1t1&&Pe.g3t1;localStorage.setItem("practiceCompleted",q.toString())},[Pe]),V)return d.jsx("div",{className:"app",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:d.jsx("h2",{children:"Loading..."})});if(window.location.search.includes("master=true")&&JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="master_admin")return d.jsx(TI,{});if(window.location.search.includes("admin=true"))return d.jsx(SI,{});const Xt=(q=Ee,B=Hr)=>{let H=0;Object.entries(B).forEach(([He,St])=>{const cn=1+parseInt(He)*.15;H+=St*cn});const X=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,he=H+X,Me=q.materials||0,Le=q.research||0;return console.log(` STUDENT LEARNING: ${he.toFixed(1)} pts | Materials: ${Me} (with sequential multipliers) | Research: ${Le} | Interest: ${X.toFixed(1)} = ${he.toFixed(1)}`),isNaN(he)?0:he},_u=()=>{if(!(te===2&&ht.midtermEnabled))return;Kt(!0),Xt()>=300?(ur(300),ln(X=>({...X,bonus:(X.bonus||0)+300}))):ur(0),ne(!0),$("checkpoint")},aa=()=>{const q=(ht.semesterDuration||12)*60*1e3,B=Math.floor(q/1e3);it(B),dr(B),Ci.current=Date.now(),Ke.current=setInterval(()=>{const X=Date.now()-Ci.current,he=Math.floor(X/1e3);v(he);const Me=Math.max(0,B-he);if(dr(Me),he%10===0&&C&&!C.startsWith("offline-")&&Gn(Pt(tt,"sessions",C),{timeElapsed:he,lastUpdated:Tn()}).catch(He=>console.error("Failed to update session time:",He)),te===2&&ht.midtermEnabled){const He=(ht.semesterDuration||12)*60*1e3,St=Math.floor(He/2e3);he===St&&!Qt&&_u()}Me<=0&&(clearInterval(Ke.current),Ke.current=null,fr("semester_complete"))},1e3)},Kr=q=>{const H=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin",X=Pe.g2t1&&Pe.g1t1&&Pe.g3t1;l(q),et.logEvent("practice_choice",{choice:q}),q==="no"?!H&&!X?(yn("You must complete all three practice tasks first!"),r("practice")):ks():r("practice")},ks=()=>{if(!qt){const q=Math.floor(Math.random()*1e6);Gt(q),Jn.initializeSeed(q),C&&!C.startsWith("offline-")&&Gn(Pt(tt,"sessions",C),{randomSeed:q,[`semesterSeeds.semester${te}`]:q})}localStorage.setItem("engagementInterest","0"),ln({materials:0,research:0,engagement:0,bonus:0}),Si({}),r("allocation"),g({}),E(0),A(0),I(0),Kt(!1),ia({}),Ei({})},Rs=(q,B)=>{qr(q),Ti(B),Dn(0),r("challenge");const X=`${q[0]}t1`;h(X),x({[X]:Date.now()}),et.setPageStartTime(X),aa(),et.logEvent("allocation_complete",{counts:B,queue:q,timestamp:Date.now()})},ki=q=>{const B=Yt[Bn].substring(0,2);if(B===q)return;const H=ht.switchCost||0;H>0&&(ln(lt=>({...lt,bonus:(lt.bonus||0)-H})),yn(`Switching tasks cost ${H} points!`));const X=[...Yt],he=X.slice(Bn),Me=X.slice(0,Bn),Le=he.filter(lt=>lt.startsWith(B)),He=he.filter(lt=>lt.startsWith(q)),St=he.filter(lt=>!lt.startsWith(B)&&!lt.startsWith(q)),Dt=[...He,...St,...Le],cn=[...Me,...Dt];if(qr(cn),A(lt=>lt+1),He.length>0){const lt=He[0];Ri(lt)}},un=async(q,B)=>{hr.current=Date.now();let H=0;const X=q.startsWith("g1")?"research":q.startsWith("g2")?"materials":"engagement";if(X==="materials")if(B.points!==void 0)H=B.points;else{const oe=parseFloat(B.userAnswer||B.userValue||0),Ye=parseFloat(B.correctAnswer||B.targetValue||0),Jt=Math.abs(oe-Ye);Jt===0?H=2:Jt<=1?H=1:H=0}else if(X==="research")if(B.points!==void 0)H=B.points;else{const oe=parseInt(B.userAnswer||0),Ye=parseInt(B.correctAnswer||0),Jt=Math.abs(oe-Ye);Jt===0?H=2:Jt<=1?H=1:H=0}else if(X==="engagement")if(B.points!==void 0)H=B.points;else{const oe=B.userAnswer||"",Ye=B.correctAnswer||"";oe===Ye?H=2:RI(oe,Ye)===1?H=1:H=0}if(ln(oe=>{const Ye={...oe,[X]:oe[X]+H};return console.log(` Updated ${X}: +${H} (total: ${Ye[X]})`),Ye}),X==="materials"&&H>0){const oe=Ee.research;Si(Ye=>{const Jt=Ye[oe]||0;return{...Ye,[oe]:Jt+H}})}const Me=.0015*(X==="engagement"?Ee.engagement+H:Ee.engagement),Le={...Ee,[X]:Ee[X]+H};let He=Hr;if(X==="materials"&&H>0){const oe=Ee.research,Ye=Hr[oe]||0;He={...Hr,[oe]:Ye+H}}let St=0;Object.entries(He).forEach(([oe,Ye])=>{const bi=1+parseInt(oe)*.15;St+=Ye*bi});const cn=parseFloat(localStorage.getItem("engagementInterest")||"0")+Me*St;localStorage.setItem("engagementInterest",cn.toString()),Ei(oe=>({...oe,[q]:H})),ia(oe=>({...oe,[q]:(oe[q]||0)+1}));const lt={...Ee,[X]:Ee[X]+H},Yr=Xt(lt,He);na(Yr);let Ot="";if(X==="materials"){const oe=Math.abs((B.userValue||0)-(B.targetValue||0));oe===0?Ot="Perfect materials!":oe<=1?Ot=`Off by ${oe.toFixed(2)}`:Ot=`Off by ${oe.toFixed(2)}`}else if(X==="research"){const oe=Math.abs((B.userAnswer||0)-(B.correctAnswer||0));oe===0?Ot="Perfect research!":oe<=1?Ot=`Off by ${oe}`:Ot=`Off by ${oe}`}else X==="engagement"&&(H===2?Ot="Perfect engagement!":H===1?Ot="One typo":Ot="Multiple errors");yn(`${Ot} | +${H} ${X} pts`),g(oe=>({...oe,[q]:!0})),E(oe=>oe+1),I(oe=>oe+1),await et.trackTaskComplete(q,B.attempts,B.totalTime,B.accuracy||B.difference||0),await et.logEvent("task_complete",{taskId:q,...B,pointsEarned:H,categoryPoints:Le,studentLearningScore:Yr,engagementInterest:cn,completionContext:{totalTasksCompleted:Object.keys(p).length+1,currentGameTime:L,switchesBeforeCompletion:S,bonusPromptsEarned:R+1,timeRemaining:Qe}}),C&&!C.startsWith("offline-")&&await Gn(Pt(tt,"sessions",C),{[`completedTasks.${q}`]:!0,[`taskPoints.${q}`]:H,categoryPoints:Le,studentLearningScore:Yr,engagementInterest:cn,bonusPrompts:R+1,lastActivity:Tn()});const Pi=Bn+1;if(Pi<Yt.length){Dn(Pi);const oe=Yt[Pi];let Ye=Object.keys(p).filter(ua=>ua.startsWith(oe)).length;oe===q.substring(0,2)&&q.startsWith(oe)&&(Ye+=1);const Jt=Ye+1,bi=`${oe}t${Jt}`;Ri(bi,!0)}else Qe>0?r("bonus_round"):fr("all_tasks_done")},Ri=async(q,B=!1)=>{if(!se){if(p[q]&&!B){yn("Task already completed! Choose a different task.");return}if(B||await et.logEvent("manual_tab_switch",{from:u,to:q,reason:"user_clicked"}),hr.current=Date.now(),ee&&(le(!1),we(5),Ai.current&&(clearInterval(Ai.current),Ai.current=null)),u!==q&&!B&&A(H=>H+1),await et.trackPageSwitch(u,q,B),m[u]){const H=Date.now()-m[u];await et.logEvent("task_time",{taskId:u,timeSpent:H,completed:p[u]||!1,leftForTask:q})}h(q),x(H=>({...H,[q]:Date.now()})),et.setPageStartTime(q)}},yn=q=>{const B=document.createElement("div");B.className="notification-enter",B.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",B.textContent=q,document.body.appendChild(B),setTimeout(()=>{B.className="notification-exit",setTimeout(()=>{document.body.contains(B)&&document.body.removeChild(B)},500)},3e3)},fr=async(q="semester_complete")=>{Ke.current&&clearInterval(Ke.current);const B=Math.floor((Date.now()-Ci.current-Fe)/1e3),H=Xt(),X=Ee.bonus||0,he=Math.max(0,ht.totalTasks-Object.keys(p).length),Me=he*(ht.unfinishedTaskPenalty||0),Le=Math.round(H)+X-Me;Me>0&&console.log(` Unfinished Penalty: -${Me} pts (${he} tasks x ${ht.unfinishedTaskPenalty})`),await et.logEvent("game_complete",{totalTime:B,totalSwitches:S,completedTasks:Object.keys(p).length,completedLevels:y,completionReason:q,gameMode:i,currentSemester:te,categoryPoints:Ee,studentLearningScore:H,totalBonus:X,finalScore:Le,finalContext:{practiceCompleted:a==="yes",totalPrompts:3+R,isAdminMode:e}}),C&&!C.startsWith("offline-")&&await Gn(Pt(tt,"sessions",C),{status:"completed",completedAt:Tn(),finalTime:B,timeElapsed:B,totalSwitches:S,completionReason:q,currentSemester:te,finalScore:Le,studentLearningScore:H}),r("complete")},vn=(q,B)=>{if(B&&B.points&&B.points===2)As(H=>({...H,[q]:!0})),yn("Perfect! Practice task completed."),setTimeout(()=>{cr(null)},1500);else{const H=(B==null?void 0:B.points)||0;yn(`Practice requires 100% accuracy. You scored ${H===1?"50%":"0%"}. Try again!`),setTimeout(()=>{cr(null)},2e3)}},la=()=>{const q=u[1],B=parseInt(u.substring(3)),H=n==="practice";return q==="1"?d.jsx(kd,{taskNum:B,onComplete:H?vn:un,currentTaskId:u,isPractice:H}):q==="2"?d.jsx(Rd,{taskNum:B,onComplete:H?vn:un,currentTaskId:u,isPractice:H}):d.jsx(Pd,{taskNum:B,onComplete:H?vn:un,currentTaskId:u,isPractice:H})};if(n==="studentLogin")return d.jsx(wI,{onLoginSuccess:q=>{window.location.href=`${window.location.origin}?code=${q}`}});if(M)return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"600px",margin:"50px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[d.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Access Denied"}),d.jsx("p",{style:{fontSize:"18px",marginBottom:"20px"},children:w}),d.jsx("div",{style:{padding:"15px",background:"#ffebee",borderRadius:"8px",border:"1px solid #f44336"},children:d.jsx("p",{style:{color:"#c62828",margin:0},children:"If you believe this is an error, please contact your instructor."})})]})});if(n==="semesterBreak"){const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),B=te===2&&q.checkpointSemester2;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{maxWidth:"700px",margin:"50px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsxs("h1",{style:{color:"#2196F3",marginBottom:"30px"},children:[" Semester ",te-1," Complete!"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsx("h3",{style:{color:"#1976d2",marginBottom:"10px"},children:"Take a Break!"}),d.jsxs("p",{style:{fontSize:"16px",color:"#666",marginBottom:"0"},children:["Great job completing Semester ",te-1,"! Take a moment to rest your eyes, stretch, or grab some water before continuing."]})]}),B&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",padding:"25px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #ff9800"},children:[d.jsx("h3",{style:{color:"#f57c00",marginBottom:"15px"},children:" Midterm Checkpoint Coming!"}),d.jsxs("div",{style:{fontSize:"16px",color:"#666",textAlign:"left"},children:[d.jsx("p",{style:{marginBottom:"10px"},children:d.jsxs("strong",{children:["Semester 2 includes a midterm exam at the"," ",Qr(),"-minute mark!"]})}),d.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"10px"},children:[d.jsx("li",{children:"Your students will be tested at the midpoint"}),d.jsxs("li",{children:["If student learning  300 points:"," ",d.jsx("strong",{children:"+300 bonus points!"})]}),d.jsx("li",{children:"Build up your teaching effectiveness early to maximize the bonus"})]}),d.jsxs("p",{style:{background:"white",padding:"10px",borderRadius:"4px",textAlign:"center",fontWeight:"bold",color:"#f57c00"},children:["Goal: Reach 300+ Student Learning by minute"," ",Qr()]})]})]}),Re.length>0&&d.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"10px"},children:"Your Performance So Far:"}),Re.map((H,X)=>d.jsxs("div",{style:{marginBottom:"8px",fontSize:"16px"},children:["Semester ",X+1,":"," ",d.jsxs("strong",{children:[H.finalScore," points"]})]},X))]}),d.jsxs("div",{style:{marginTop:"30px"},children:[d.jsxs("button",{onClick:()=>{r("challenge"),aa(),x({g2t1:Date.now()}),et.setPageStartTime("g2t1"),et.logEvent("semester_start",{semester:te,timestamp:Date.now(),hasCheckpoint:B})},style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:H=>{H.currentTarget.style.transform="translateY(-2px)",H.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:H=>{H.currentTarget.style.transform="translateY(0)",H.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["I'm Ready - Start Semester ",te]}),d.jsx("p",{style:{marginTop:"15px",fontSize:"14px",color:"#999"},children:"Click when you're ready to continue. The timer will start immediately."})]})]})})}if(n==="landing"){i||s({accuracy:"lenient",limit:"time"});const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),B=q.role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",style:{padding:"40px",maxWidth:"900px"},children:[d.jsxs("h1",{style:{color:"#333",marginBottom:"30px",fontSize:"32px",textAlign:"left"},children:["Can you beat Park? - Semester ",te,"/",ze]}),d.jsxs("div",{className:"game-info",style:{textAlign:"left"},children:[d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#f44336",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Engagement"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Build interest that compounds! Each point adds 0.15% interest after every task completion."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#9C27B0",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Research"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Research amplifies your FUTURE materials! Each point adds +15% multiplier to materials earned after the research (order matters!)."})]}),d.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[d.jsxs("h3",{style:{color:"#4CAF50",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Materials"]}),d.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Create teaching materials - each point directly contributes to your goal points!"})]}),d.jsxs("div",{style:{background:"#f0f8ff",borderRadius:"8px",padding:"25px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{color:"#2196F3",fontSize:"20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""})," Student Learning Formula"]}),d.jsxs("div",{style:{background:"white",padding:"18px",borderRadius:"6px",fontFamily:"monospace",fontSize:"18px",textAlign:"center",marginBottom:"20px",border:"1px solid #e0e0e0",lineHeight:"1.8"},children:["Goal ="," ",d.jsx("strong",{children:"Materials  (1 + Research0.15) + Engagement Interest"}),d.jsx("br",{}),d.jsxs("div",{style:{fontSize:"14px",marginTop:"10px",fontFamily:"sans-serif"},children:["Research multipliers apply only to materials earned"," ",d.jsx("em",{children:"after"})," the research"]})]}),d.jsxs("ul",{style:{color:"#333",lineHeight:"2",margin:"0",paddingLeft:"25px",fontSize:"15px",textAlign:"left"},children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Scoring:"})," Exact = 2 pts | Within 1 = 1 pt | Otherwise = 0 pts"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Timing:"})," Task completion order affects your final score"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Strategy:"})," Think carefully about when to complete each task type!"]}),te===2&&d.jsxs("li",{children:["At minute ",Qr(),": Exam checkpoint with bonus opportunity (300+ Student Learning = 300 bonus)"]})]})]}),q.hasAI&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"1px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"AI Assistant Available:"}),d.jsxs("ul",{style:{color:"#856404",lineHeight:"1.6",margin:"0",paddingLeft:"20px",fontSize:"14px"},children:[d.jsx("li",{children:"Click the help buttons below each task for AI assistance"}),d.jsx("li",{children:"Unlimited use but reliability varies"}),d.jsx("li",{children:'Type "strategy" or "order" in chat for strategic advice!'})]})]}),te===2&&d.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"2px solid #ffc107"},children:[d.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:" Semester 2: Midterm Checkpoint!"}),d.jsxs("p",{style:{color:"#856404",fontSize:"14px",margin:0},children:["At the ",Qr(),"-minute mark, if you have 300+ student learning points, you'll earn a 300-point bonus!"]})]})]}),!B&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)",borderRadius:"12px",padding:"20px",marginTop:"20px",marginBottom:"20px",border:"2px solid #d32f2f",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"12px"},children:[d.jsx("span",{style:{fontSize:"24px"},children:""}),d.jsx("h3",{style:{color:"#b71c1c",margin:0,fontSize:"18px",fontWeight:"600"},children:"ONE ATTEMPT ONLY - NO RESTART"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No refresh/close"})," - Session ends"]})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),d.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[d.jsx("strong",{children:"No tab switching"})," - 30s warning"]})]})]}),d.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"6px",textAlign:"center",fontSize:"14px",color:"#b71c1c",fontWeight:"600"},children:" Ensure 40 minutes uninterrupted before starting"})]}),d.jsxs("button",{className:"start-button",onClick:()=>r("practiceChoice"),children:["Start Semester ",te]}),e&&d.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#ffcccb",borderRadius:"6px",border:"2px solid #ff0000",fontWeight:"bold",color:"#d00"},children:["ADMIN MODE: ",ta/60," minute timer, checkpoint at"," ",Qr(),"minute"]}),Re.length>0&&d.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"6px",fontSize:"14px"},children:[d.jsx("strong",{children:"Previous Semesters:"}),Re.map((H,X)=>d.jsxs("div",{style:{marginTop:"5px"},children:["Semester ",X+1,": ",H.finalScore," points"]},X))]})]})})})}if(n==="practiceChoice"){const B=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";return d.jsx("div",{className:"app",children:d.jsx("div",{className:"landing-container",children:d.jsxs("div",{className:"landing-card",children:[d.jsx("h2",{style:{color:"#333",marginBottom:"20px"},children:B?"Practice Mode (Optional for Admin)":"Practice Mode (Required)"}),d.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:B?"As an admin, you can skip practice or try it first.":"You must complete all three practice tasks before starting the main game."}),d.jsx("p",{style:{color:"#888",fontSize:"14px",marginBottom:"30px",fontStyle:"italic"},children:"Practice lets you try each teaching task without time pressure."}),!B&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #1976d2",boxShadow:"0 4px 6px rgba(25, 118, 210, 0.1)"},children:[d.jsxs("h4",{style:{color:"#0d47a1",margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[d.jsx("span",{style:{fontSize:"20px"},children:""}),"Required Practice Tasks (100% accuracy needed):"]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Pe.g2t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Pe.g2t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Materials"})}),Pe.g2t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Pe.g1t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Pe.g1t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Research"})}),Pe.g1t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Pe.g3t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Pe.g3t1?"#4CAF50":"#e0e0e0"}`},children:[d.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),d.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:d.jsx("strong",{children:"Engagement"})}),Pe.g3t1?d.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):d.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]})]}),d.jsx("div",{style:{marginTop:"16px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"6px",fontSize:"13px",color:"#0d47a1",textAlign:"center",fontStyle:"italic"},children:" Each task must be completed perfectly to proceed"})]}),d.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[d.jsx("button",{onClick:()=>Kr("yes"),style:{padding:"15px 30px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:B?"Try Practice Mode":"Start Required Practice"}),B&&d.jsx("button",{onClick:()=>Kr("no"),style:{padding:"15px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:"Skip Practice (Admin)"})]})]})})})}if(n==="practice"){const B=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";if(!bn)return d.jsxs("div",{className:"app",children:[d.jsx("h1",{children:"Teaching Simulation - Practice Mode"}),d.jsx(vI,{practiceCompleted:Pe,onPracticeComplete:vn,onSelectPractice:cr,onStartMainGame:()=>{const he=Pe.g2t1&&Pe.g1t1&&Pe.g3t1;!B&&!he?yn("You must complete all three practice tasks first!"):ks()},isAdmin:B})]});const H=bn[1],X=1;return d.jsx("div",{className:"app",children:d.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[d.jsx("button",{onClick:()=>cr(null),style:{marginBottom:"20px",padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:" Back to Practice Menu"}),d.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[d.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),H==="1"&&d.jsx(kd,{taskNum:X,onComplete:vn,currentTaskId:bn,isPractice:!0}),H==="2"&&d.jsx(Rd,{taskNum:X,onComplete:vn,currentTaskId:bn,isPractice:!0}),H==="3"&&d.jsx(Pd,{taskNum:X,onComplete:vn,currentTaskId:bn,isPractice:!0})]})})}if(n==="complete"){const q=Math.floor(L/60),B=L%60,H=Math.round(Xt()),X=Ee.bonus||0,he=H+X,Me={semester:te,totalTime:L,completedLevels:y,categoryPoints:Ee,switches:S,gameMode:i,randomSeed:qt,studentLearningScore:H,finalScore:he},Le=async()=>{const St=[...Re,Me];wt(St),localStorage.setItem("engagementInterest","0"),ln({materials:0,research:0,engagement:0,bonus:0}),Si({}),C&&!C.startsWith("offline-")&&await Gn(Pt(tt,"sessions",C),{[`semesterHistory.semester${te}`]:Me,currentSemester:te+1,lastActivity:Tn()}),ke(te+1),bd.resetForNewSemester(),r("semesterBreak"),g({}),E(0),A(0),I(0),v(0),Se(0),h("g2t1"),Kt(!1);const Dt=Math.floor(Math.random()*1e6);Gt(Dt),Jn.initializeSeed(Dt)},He=te>=ze;return d.jsxs("div",{className:"app",children:[d.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[d.jsx("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"8px",border:"2px solid #2196F3"},children:d.jsxs("h2",{style:{color:"#2196F3",margin:0},children:["Semester ",te," of ",ze," Complete!"]})}),He&&d.jsx(EI,{sessionId:C,completedLevels:y,totalTime:L,gameMode:i}),d.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginTop:"20px"},children:[d.jsxs("h2",{style:{color:"#333",marginBottom:"20px"},children:[" Semester ",te," Performance"]}),d.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2196F3",marginBottom:"30px"},children:["Final Score: ",he," points"]}),d.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[d.jsxs("h3",{style:{margin:"0 0 15px 0",color:"#1976d2"},children:["Student Learning Score: ",H]}),d.jsxs("div",{style:{fontSize:"16px",color:"#666"},children:["= ",Ee.materials||0," (Materials) "," ",(1+(Ee.research||0)*.15).toFixed(2)," ","(Research)",parseFloat(localStorage.getItem("engagementInterest")||"0")>0&&` + ${parseFloat(localStorage.getItem("engagementInterest")||"0").toFixed(2)} (Interest)`]}),X>0&&d.jsxs("div",{style:{marginTop:"10px",fontSize:"16px",color:"#1976d2"},children:["+ ",X," Checkpoint Bonus"]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Total Time"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[q,"m ",B,"s"]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Student Learning"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:H})]})]}),(te===2||X>0)&&d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Checkpoint Bonus"}),d.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:["+",X]})]}),d.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[d.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Tasks Completed"}),d.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:y})]})]}),d.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:"Teaching Performance by Category"}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"30px"},children:[d.jsxs("div",{style:{background:"#f0f8f0",padding:"15px",borderRadius:"6px",border:"2px solid #4CAF5020"},children:[d.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",marginBottom:"5px"},children:" Materials"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ee.materials||0}),d.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Base points"})]}),d.jsxs("div",{style:{background:"#f8f0ff",padding:"15px",borderRadius:"6px",border:"2px solid #9C27B020"},children:[d.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold",marginBottom:"5px"},children:" Research"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ee.research||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(Ee.research||0)*15,"% to future materials"]})]}),d.jsxs("div",{style:{background:"#fff0f0",padding:"15px",borderRadius:"6px",border:"2px solid #f4433620"},children:[d.jsx("div",{style:{color:"#f44336",fontWeight:"bold",marginBottom:"5px"},children:" Engagement"}),d.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ee.engagement||0}),d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",((Ee.engagement||0)*.15).toFixed(1),"% interest/task"]})]})]})]}),te===2&&Ee.bonus>0&&d.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[d.jsxs("strong",{style:{color:"#856404"},children:[" Exam Season Bonus:"," "]}),d.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#856404"},children:["+",Ee.bonus," points"]})]}),Re.length>0&&d.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[d.jsx("h4",{style:{color:"#666",marginBottom:"15px"},children:"Progress Over Semesters"}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px"},children:[...Re,Me].map((St,Dt)=>d.jsxs("div",{style:{padding:"10px",background:Dt===Re.length?"#e3f2fd":"white",borderRadius:"6px",border:"1px solid #e0e0e0",textAlign:"center"},children:[d.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Semester ",Dt+1]}),d.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:St.finalScore})]},Dt))})]}),d.jsx("div",{style:{marginTop:"30px",textAlign:"center"},children:He?d.jsxs("div",{style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px",textAlign:"center"},children:[d.jsx("h3",{style:{color:"#856404",marginBottom:"10px"},children:" All semesters complete!"}),d.jsx("p",{style:{color:"#856404",marginBottom:"0"},children:"Return to the Qualtrics survey and enter your completion code to finish the study."})]}):d.jsxs("button",{onClick:Le,style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",te+1," "]})})]})}return n==="allocation"?d.jsx(CI,{onStart:Rs,totalTasks:ht.totalTasks,orderStrategy:ht.taskOrderStrategy,durationMinutes:ht.semesterDuration,difficultyMode:ht.difficultyMode}):n==="bonus_round"?d.jsx(kI,{timeRemaining:Qe,onSelectTask:q=>{const B=[...Yt,q];qr(B);const H=Object.keys(p).filter(he=>he.startsWith(q)).length,X=`${q}t${H+1}`;r("challenge"),Ri(X,!0)},onFinishEarly:()=>fr("finished_early")}):d.jsx("div",{className:"app",children:d.jsx(AI,{currentTaskIndex:Bn,totalTasks:Yt.length,taskQueue:Yt,onSwitchTask:ki,onRefill:handleRefillJar,allocationCounts:oa,points:Math.round(wi),timeRemaining:Qe,onTimeUp:()=>fr("time_up"),chatInterface:d.jsx(xI,{bonusPrompts:R,currentTask:u,categoryPoints:Ee,timeRemaining:Qe,calculateStudentLearning:Xt,aiCost:ht.aiCost,onAiCost:q=>{ln(B=>({...B,bonus:(B.bonus||0)-q})),yn(`AI Usage Penalty: -${q} pts`)}}),children:la()})})}s0(document.getElementById("root")).render(d.jsx(D.StrictMode,{children:d.jsx(PI,{})}));
//# sourceMappingURL=index-DoSOz16f.js.map
