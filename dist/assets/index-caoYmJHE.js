(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Km={exports:{}},Ul={},Ym={exports:{}},ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wo=Symbol.for("react.element"),ox=Symbol.for("react.portal"),ax=Symbol.for("react.fragment"),lx=Symbol.for("react.strict_mode"),ux=Symbol.for("react.profiler"),cx=Symbol.for("react.provider"),dx=Symbol.for("react.context"),hx=Symbol.for("react.forward_ref"),fx=Symbol.for("react.suspense"),px=Symbol.for("react.memo"),mx=Symbol.for("react.lazy"),Bf=Symbol.iterator;function gx(t){return t===null||typeof t!="object"?null:(t=Bf&&t[Bf]||t["@@iterator"],typeof t=="function"?t:null)}var Xm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Jm=Object.assign,Zm={};function wi(t,e,n){this.props=t,this.context=e,this.refs=Zm,this.updater=n||Xm}wi.prototype.isReactComponent={};wi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};wi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function eg(){}eg.prototype=wi.prototype;function jd(t,e,n){this.props=t,this.context=e,this.refs=Zm,this.updater=n||Xm}var Vd=jd.prototype=new eg;Vd.constructor=jd;Jm(Vd,wi.prototype);Vd.isPureReactComponent=!0;var Uf=Array.isArray,tg=Object.prototype.hasOwnProperty,Md={current:null},ng={key:!0,ref:!0,__self:!0,__source:!0};function rg(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)tg.call(e,r)&&!ng.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Wo,type:t,key:i,ref:a,props:s,_owner:Md.current}}function yx(t,e){return{$$typeof:Wo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ld(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wo}function vx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var $f=/\/+/g;function Ru(t,e){return typeof t=="object"&&t!==null&&t.key!=null?vx(""+t.key):e.toString(36)}function Wa(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Wo:case ox:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+Ru(a,0):r,Uf(s)?(n="",t!=null&&(n=t.replace($f,"$&/")+"/"),Wa(s,e,n,"",function(h){return h})):s!=null&&(Ld(s)&&(s=yx(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace($f,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",Uf(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Ru(i,l);a+=Wa(i,e,n,u,s)}else if(u=gx(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Ru(i,l++),a+=Wa(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Ea(t,e,n){if(t==null)return t;var r=[],s=0;return Wa(t,r,"","",function(i){return e.call(n,i,s++)}),r}function xx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Mt={current:null},Ha={transition:null},_x={ReactCurrentDispatcher:Mt,ReactCurrentBatchConfig:Ha,ReactCurrentOwner:Md};function sg(){throw Error("act(...) is not supported in production builds of React.")}ye.Children={map:Ea,forEach:function(t,e,n){Ea(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ea(t,function(){e++}),e},toArray:function(t){return Ea(t,function(e){return e})||[]},only:function(t){if(!Ld(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ye.Component=wi;ye.Fragment=ax;ye.Profiler=ux;ye.PureComponent=jd;ye.StrictMode=lx;ye.Suspense=fx;ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_x;ye.act=sg;ye.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Jm({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Md.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)tg.call(e,u)&&!ng.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:Wo,type:t.type,key:s,ref:i,props:r,_owner:a}};ye.createContext=function(t){return t={$$typeof:dx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:cx,_context:t},t.Consumer=t};ye.createElement=rg;ye.createFactory=function(t){var e=rg.bind(null,t);return e.type=t,e};ye.createRef=function(){return{current:null}};ye.forwardRef=function(t){return{$$typeof:hx,render:t}};ye.isValidElement=Ld;ye.lazy=function(t){return{$$typeof:mx,_payload:{_status:-1,_result:t},_init:xx}};ye.memo=function(t,e){return{$$typeof:px,type:t,compare:e===void 0?null:e}};ye.startTransition=function(t){var e=Ha.transition;Ha.transition={};try{t()}finally{Ha.transition=e}};ye.unstable_act=sg;ye.useCallback=function(t,e){return Mt.current.useCallback(t,e)};ye.useContext=function(t){return Mt.current.useContext(t)};ye.useDebugValue=function(){};ye.useDeferredValue=function(t){return Mt.current.useDeferredValue(t)};ye.useEffect=function(t,e){return Mt.current.useEffect(t,e)};ye.useId=function(){return Mt.current.useId()};ye.useImperativeHandle=function(t,e,n){return Mt.current.useImperativeHandle(t,e,n)};ye.useInsertionEffect=function(t,e){return Mt.current.useInsertionEffect(t,e)};ye.useLayoutEffect=function(t,e){return Mt.current.useLayoutEffect(t,e)};ye.useMemo=function(t,e){return Mt.current.useMemo(t,e)};ye.useReducer=function(t,e,n){return Mt.current.useReducer(t,e,n)};ye.useRef=function(t){return Mt.current.useRef(t)};ye.useState=function(t){return Mt.current.useState(t)};ye.useSyncExternalStore=function(t,e,n){return Mt.current.useSyncExternalStore(t,e,n)};ye.useTransition=function(){return Mt.current.useTransition()};ye.version="18.3.1";Ym.exports=ye;var j=Ym.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wx=j,Sx=Symbol.for("react.element"),Ex=Symbol.for("react.fragment"),Tx=Object.prototype.hasOwnProperty,Ix=wx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ax={key:!0,ref:!0,__self:!0,__source:!0};function ig(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)Tx.call(e,r)&&!Ax.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Sx,type:t,key:i,ref:a,props:s,_owner:Ix.current}}Ul.Fragment=Ex;Ul.jsx=ig;Ul.jsxs=ig;Km.exports=Ul;var c=Km.exports,og={exports:{}},an={},ag={exports:{}},lg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(x,N){var U=x.length;x.push(N);e:for(;0<U;){var J=U-1>>>1,ee=x[J];if(0<s(ee,N))x[J]=N,x[U]=ee,U=J;else break e}}function n(x){return x.length===0?null:x[0]}function r(x){if(x.length===0)return null;var N=x[0],U=x.pop();if(U!==N){x[0]=U;e:for(var J=0,ee=x.length,le=ee>>>1;J<le;){var me=2*(J+1)-1,fe=x[me],pe=me+1,Z=x[pe];if(0>s(fe,U))pe<ee&&0>s(Z,fe)?(x[J]=Z,x[pe]=U,J=pe):(x[J]=fe,x[me]=U,J=me);else if(pe<ee&&0>s(Z,U))x[J]=Z,x[pe]=U,J=pe;else break e}}return N}function s(x,N){var U=x.sortIndex-N.sortIndex;return U!==0?U:x.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],h=[],p=1,g=null,y=3,T=!1,C=!1,b=!1,O=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(x){for(var N=n(h);N!==null;){if(N.callback===null)r(h);else if(N.startTime<=x)r(h),N.sortIndex=N.expirationTime,e(u,N);else break;N=n(h)}}function M(x){if(b=!1,R(x),!C)if(n(u)!==null)C=!0,K(B);else{var N=n(h);N!==null&&F(M,N.startTime-x)}}function B(x,N){C=!1,b&&(b=!1,A(m),m=-1),T=!0;var U=y;try{for(R(N),g=n(u);g!==null&&(!(g.expirationTime>N)||x&&!k());){var J=g.callback;if(typeof J=="function"){g.callback=null,y=g.priorityLevel;var ee=J(g.expirationTime<=N);N=t.unstable_now(),typeof ee=="function"?g.callback=ee:g===n(u)&&r(u),R(N)}else r(u);g=n(u)}if(g!==null)var le=!0;else{var me=n(h);me!==null&&F(M,me.startTime-N),le=!1}return le}finally{g=null,y=U,T=!1}}var L=!1,w=null,m=-1,_=5,E=-1;function k(){return!(t.unstable_now()-E<_)}function P(){if(w!==null){var x=t.unstable_now();E=x;var N=!0;try{N=w(!0,x)}finally{N?I():(L=!1,w=null)}}else L=!1}var I;if(typeof S=="function")I=function(){S(P)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,Q=H.port2;H.port1.onmessage=P,I=function(){Q.postMessage(null)}}else I=function(){O(P,0)};function K(x){w=x,L||(L=!0,I())}function F(x,N){m=O(function(){x(t.unstable_now())},N)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(x){x.callback=null},t.unstable_continueExecution=function(){C||T||(C=!0,K(B))},t.unstable_forceFrameRate=function(x){0>x||125<x?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<x?Math.floor(1e3/x):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(x){switch(y){case 1:case 2:case 3:var N=3;break;default:N=y}var U=y;y=N;try{return x()}finally{y=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(x,N){switch(x){case 1:case 2:case 3:case 4:case 5:break;default:x=3}var U=y;y=x;try{return N()}finally{y=U}},t.unstable_scheduleCallback=function(x,N,U){var J=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?J+U:J):U=J,x){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=U+ee,x={id:p++,callback:N,priorityLevel:x,startTime:U,expirationTime:ee,sortIndex:-1},U>J?(x.sortIndex=U,e(h,x),n(u)===null&&x===n(h)&&(b?(A(m),m=-1):b=!0,F(M,U-J))):(x.sortIndex=ee,e(u,x),C||T||(C=!0,K(B))),x},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(x){var N=y;return function(){var U=y;y=N;try{return x.apply(this,arguments)}finally{y=U}}}})(lg);ag.exports=lg;var Cx=ag.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kx=j,on=Cx;function G(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ug=new Set,yo={};function vs(t,e){ai(t,e),ai(t+"Capture",e)}function ai(t,e){for(yo[t]=e,t=0;t<e.length;t++)ug.add(e[t])}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gc=Object.prototype.hasOwnProperty,Rx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Wf={},Hf={};function Px(t){return gc.call(Hf,t)?!0:gc.call(Wf,t)?!1:Rx.test(t)?Hf[t]=!0:(Wf[t]=!0,!1)}function bx(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Dx(t,e,n,r){if(e===null||typeof e>"u"||bx(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Lt(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){yt[t]=new Lt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];yt[e]=new Lt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){yt[t]=new Lt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){yt[t]=new Lt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){yt[t]=new Lt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){yt[t]=new Lt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){yt[t]=new Lt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){yt[t]=new Lt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){yt[t]=new Lt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Od=/[\-:]([a-z])/g;function Fd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Od,Fd);yt[e]=new Lt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Od,Fd);yt[e]=new Lt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Od,Fd);yt[e]=new Lt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){yt[t]=new Lt(t,1,!1,t.toLowerCase(),null,!1,!1)});yt.xlinkHref=new Lt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){yt[t]=new Lt(t,1,!1,t.toLowerCase(),null,!0,!0)});function zd(t,e,n,r){var s=yt.hasOwnProperty(e)?yt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Dx(e,n,s,r)&&(n=null),r||s===null?Px(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var lr=kx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ta=Symbol.for("react.element"),Us=Symbol.for("react.portal"),$s=Symbol.for("react.fragment"),Bd=Symbol.for("react.strict_mode"),yc=Symbol.for("react.profiler"),cg=Symbol.for("react.provider"),dg=Symbol.for("react.context"),Ud=Symbol.for("react.forward_ref"),vc=Symbol.for("react.suspense"),xc=Symbol.for("react.suspense_list"),$d=Symbol.for("react.memo"),vr=Symbol.for("react.lazy"),hg=Symbol.for("react.offscreen"),qf=Symbol.iterator;function Fi(t){return t===null||typeof t!="object"?null:(t=qf&&t[qf]||t["@@iterator"],typeof t=="function"?t:null)}var He=Object.assign,Pu;function Qi(t){if(Pu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Pu=e&&e[1]||""}return`
`+Pu+t}var bu=!1;function Du(t,e){if(!t||bu)return"";bu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var s=h.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{bu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Qi(t):""}function Nx(t){switch(t.tag){case 5:return Qi(t.type);case 16:return Qi("Lazy");case 13:return Qi("Suspense");case 19:return Qi("SuspenseList");case 0:case 2:case 15:return t=Du(t.type,!1),t;case 11:return t=Du(t.type.render,!1),t;case 1:return t=Du(t.type,!0),t;default:return""}}function _c(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case $s:return"Fragment";case Us:return"Portal";case yc:return"Profiler";case Bd:return"StrictMode";case vc:return"Suspense";case xc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case dg:return(t.displayName||"Context")+".Consumer";case cg:return(t._context.displayName||"Context")+".Provider";case Ud:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case $d:return e=t.displayName||null,e!==null?e:_c(t.type)||"Memo";case vr:e=t._payload,t=t._init;try{return _c(t(e))}catch{}}return null}function jx(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _c(e);case 8:return e===Bd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Lr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function fg(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Vx(t){var e=fg(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ia(t){t._valueTracker||(t._valueTracker=Vx(t))}function pg(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=fg(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function al(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function wc(t,e){var n=e.checked;return He({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Gf(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Lr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function mg(t,e){e=e.checked,e!=null&&zd(t,"checked",e,!1)}function Sc(t,e){mg(t,e);var n=Lr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ec(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ec(t,e.type,Lr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Qf(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ec(t,e,n){(e!=="number"||al(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ki=Array.isArray;function ei(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Lr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Tc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(G(91));return He({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Kf(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(G(92));if(Ki(n)){if(1<n.length)throw Error(G(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Lr(n)}}function gg(t,e){var n=Lr(e.value),r=Lr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Yf(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yg(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ic(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yg(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Aa,vg=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Aa=Aa||document.createElement("div"),Aa.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Aa.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function vo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ro={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mx=["Webkit","ms","Moz","O"];Object.keys(ro).forEach(function(t){Mx.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ro[e]=ro[t]})});function xg(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ro.hasOwnProperty(t)&&ro[t]?(""+e).trim():e+"px"}function _g(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=xg(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Lx=He({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ac(t,e){if(e){if(Lx[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(G(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(G(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(G(61))}if(e.style!=null&&typeof e.style!="object")throw Error(G(62))}}function Cc(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kc=null;function Wd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Rc=null,ti=null,ni=null;function Xf(t){if(t=Go(t)){if(typeof Rc!="function")throw Error(G(280));var e=t.stateNode;e&&(e=Gl(e),Rc(t.stateNode,t.type,e))}}function wg(t){ti?ni?ni.push(t):ni=[t]:ti=t}function Sg(){if(ti){var t=ti,e=ni;if(ni=ti=null,Xf(t),e)for(t=0;t<e.length;t++)Xf(e[t])}}function Eg(t,e){return t(e)}function Tg(){}var Nu=!1;function Ig(t,e,n){if(Nu)return t(e,n);Nu=!0;try{return Eg(t,e,n)}finally{Nu=!1,(ti!==null||ni!==null)&&(Tg(),Sg())}}function xo(t,e){var n=t.stateNode;if(n===null)return null;var r=Gl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(G(231,e,typeof n));return n}var Pc=!1;if(tr)try{var zi={};Object.defineProperty(zi,"passive",{get:function(){Pc=!0}}),window.addEventListener("test",zi,zi),window.removeEventListener("test",zi,zi)}catch{Pc=!1}function Ox(t,e,n,r,s,i,a,l,u){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var so=!1,ll=null,ul=!1,bc=null,Fx={onError:function(t){so=!0,ll=t}};function zx(t,e,n,r,s,i,a,l,u){so=!1,ll=null,Ox.apply(Fx,arguments)}function Bx(t,e,n,r,s,i,a,l,u){if(zx.apply(this,arguments),so){if(so){var h=ll;so=!1,ll=null}else throw Error(G(198));ul||(ul=!0,bc=h)}}function xs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ag(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Jf(t){if(xs(t)!==t)throw Error(G(188))}function Ux(t){var e=t.alternate;if(!e){if(e=xs(t),e===null)throw Error(G(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Jf(s),t;if(i===r)return Jf(s),e;i=i.sibling}throw Error(G(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(G(189))}}if(n.alternate!==r)throw Error(G(190))}if(n.tag!==3)throw Error(G(188));return n.stateNode.current===n?t:e}function Cg(t){return t=Ux(t),t!==null?kg(t):null}function kg(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=kg(t);if(e!==null)return e;t=t.sibling}return null}var Rg=on.unstable_scheduleCallback,Zf=on.unstable_cancelCallback,$x=on.unstable_shouldYield,Wx=on.unstable_requestPaint,Ze=on.unstable_now,Hx=on.unstable_getCurrentPriorityLevel,Hd=on.unstable_ImmediatePriority,Pg=on.unstable_UserBlockingPriority,cl=on.unstable_NormalPriority,qx=on.unstable_LowPriority,bg=on.unstable_IdlePriority,$l=null,Ln=null;function Gx(t){if(Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot($l,t,void 0,(t.current.flags&128)===128)}catch{}}var In=Math.clz32?Math.clz32:Yx,Qx=Math.log,Kx=Math.LN2;function Yx(t){return t>>>=0,t===0?32:31-(Qx(t)/Kx|0)|0}var Ca=64,ka=4194304;function Yi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function dl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Yi(l):(i&=a,i!==0&&(r=Yi(i)))}else a=n&~s,a!==0?r=Yi(a):i!==0&&(r=Yi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-In(e),s=1<<n,r|=t[n],e&=~s;return r}function Xx(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jx(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-In(i),l=1<<a,u=s[a];u===-1?(!(l&n)||l&r)&&(s[a]=Xx(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Dc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Dg(){var t=Ca;return Ca<<=1,!(Ca&4194240)&&(Ca=64),t}function ju(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ho(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-In(e),t[e]=n}function Zx(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-In(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function qd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-In(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ae=0;function Ng(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var jg,Gd,Vg,Mg,Lg,Nc=!1,Ra=[],Ir=null,Ar=null,Cr=null,_o=new Map,wo=new Map,_r=[],e_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ep(t,e){switch(t){case"focusin":case"focusout":Ir=null;break;case"dragenter":case"dragleave":Ar=null;break;case"mouseover":case"mouseout":Cr=null;break;case"pointerover":case"pointerout":_o.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":wo.delete(e.pointerId)}}function Bi(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Go(e),e!==null&&Gd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function t_(t,e,n,r,s){switch(e){case"focusin":return Ir=Bi(Ir,t,e,n,r,s),!0;case"dragenter":return Ar=Bi(Ar,t,e,n,r,s),!0;case"mouseover":return Cr=Bi(Cr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return _o.set(i,Bi(_o.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,wo.set(i,Bi(wo.get(i)||null,t,e,n,r,s)),!0}return!1}function Og(t){var e=rs(t.target);if(e!==null){var n=xs(e);if(n!==null){if(e=n.tag,e===13){if(e=Ag(n),e!==null){t.blockedOn=e,Lg(t.priority,function(){Vg(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function qa(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=jc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);kc=r,n.target.dispatchEvent(r),kc=null}else return e=Go(n),e!==null&&Gd(e),t.blockedOn=n,!1;e.shift()}return!0}function tp(t,e,n){qa(t)&&n.delete(e)}function n_(){Nc=!1,Ir!==null&&qa(Ir)&&(Ir=null),Ar!==null&&qa(Ar)&&(Ar=null),Cr!==null&&qa(Cr)&&(Cr=null),_o.forEach(tp),wo.forEach(tp)}function Ui(t,e){t.blockedOn===e&&(t.blockedOn=null,Nc||(Nc=!0,on.unstable_scheduleCallback(on.unstable_NormalPriority,n_)))}function So(t){function e(s){return Ui(s,t)}if(0<Ra.length){Ui(Ra[0],t);for(var n=1;n<Ra.length;n++){var r=Ra[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ir!==null&&Ui(Ir,t),Ar!==null&&Ui(Ar,t),Cr!==null&&Ui(Cr,t),_o.forEach(e),wo.forEach(e),n=0;n<_r.length;n++)r=_r[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<_r.length&&(n=_r[0],n.blockedOn===null);)Og(n),n.blockedOn===null&&_r.shift()}var ri=lr.ReactCurrentBatchConfig,hl=!0;function r_(t,e,n,r){var s=Ae,i=ri.transition;ri.transition=null;try{Ae=1,Qd(t,e,n,r)}finally{Ae=s,ri.transition=i}}function s_(t,e,n,r){var s=Ae,i=ri.transition;ri.transition=null;try{Ae=4,Qd(t,e,n,r)}finally{Ae=s,ri.transition=i}}function Qd(t,e,n,r){if(hl){var s=jc(t,e,n,r);if(s===null)Wu(t,e,r,fl,n),ep(t,r);else if(t_(s,t,e,n,r))r.stopPropagation();else if(ep(t,r),e&4&&-1<e_.indexOf(t)){for(;s!==null;){var i=Go(s);if(i!==null&&jg(i),i=jc(t,e,n,r),i===null&&Wu(t,e,r,fl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Wu(t,e,r,null,n)}}var fl=null;function jc(t,e,n,r){if(fl=null,t=Wd(r),t=rs(t),t!==null)if(e=xs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ag(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return fl=t,null}function Fg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hx()){case Hd:return 1;case Pg:return 4;case cl:case qx:return 16;case bg:return 536870912;default:return 16}default:return 16}}var Sr=null,Kd=null,Ga=null;function zg(){if(Ga)return Ga;var t,e=Kd,n=e.length,r,s="value"in Sr?Sr.value:Sr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Ga=s.slice(t,1<r?1-r:void 0)}function Qa(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Pa(){return!0}function np(){return!1}function ln(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Pa:np,this.isPropagationStopped=np,this}return He(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Pa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Pa)},persist:function(){},isPersistent:Pa}),e}var Si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yd=ln(Si),qo=He({},Si,{view:0,detail:0}),i_=ln(qo),Vu,Mu,$i,Wl=He({},qo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==$i&&($i&&t.type==="mousemove"?(Vu=t.screenX-$i.screenX,Mu=t.screenY-$i.screenY):Mu=Vu=0,$i=t),Vu)},movementY:function(t){return"movementY"in t?t.movementY:Mu}}),rp=ln(Wl),o_=He({},Wl,{dataTransfer:0}),a_=ln(o_),l_=He({},qo,{relatedTarget:0}),Lu=ln(l_),u_=He({},Si,{animationName:0,elapsedTime:0,pseudoElement:0}),c_=ln(u_),d_=He({},Si,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),h_=ln(d_),f_=He({},Si,{data:0}),sp=ln(f_),p_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},m_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},g_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function y_(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=g_[t])?!!e[t]:!1}function Xd(){return y_}var v_=He({},qo,{key:function(t){if(t.key){var e=p_[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Qa(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?m_[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xd,charCode:function(t){return t.type==="keypress"?Qa(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Qa(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),x_=ln(v_),__=He({},Wl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ip=ln(__),w_=He({},qo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xd}),S_=ln(w_),E_=He({},Si,{propertyName:0,elapsedTime:0,pseudoElement:0}),T_=ln(E_),I_=He({},Wl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),A_=ln(I_),C_=[9,13,27,32],Jd=tr&&"CompositionEvent"in window,io=null;tr&&"documentMode"in document&&(io=document.documentMode);var k_=tr&&"TextEvent"in window&&!io,Bg=tr&&(!Jd||io&&8<io&&11>=io),op=" ",ap=!1;function Ug(t,e){switch(t){case"keyup":return C_.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $g(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ws=!1;function R_(t,e){switch(t){case"compositionend":return $g(e);case"keypress":return e.which!==32?null:(ap=!0,op);case"textInput":return t=e.data,t===op&&ap?null:t;default:return null}}function P_(t,e){if(Ws)return t==="compositionend"||!Jd&&Ug(t,e)?(t=zg(),Ga=Kd=Sr=null,Ws=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Bg&&e.locale!=="ko"?null:e.data;default:return null}}var b_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!b_[t.type]:e==="textarea"}function Wg(t,e,n,r){wg(r),e=pl(e,"onChange"),0<e.length&&(n=new Yd("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var oo=null,Eo=null;function D_(t){ty(t,0)}function Hl(t){var e=Gs(t);if(pg(e))return t}function N_(t,e){if(t==="change")return e}var Hg=!1;if(tr){var Ou;if(tr){var Fu="oninput"in document;if(!Fu){var up=document.createElement("div");up.setAttribute("oninput","return;"),Fu=typeof up.oninput=="function"}Ou=Fu}else Ou=!1;Hg=Ou&&(!document.documentMode||9<document.documentMode)}function cp(){oo&&(oo.detachEvent("onpropertychange",qg),Eo=oo=null)}function qg(t){if(t.propertyName==="value"&&Hl(Eo)){var e=[];Wg(e,Eo,t,Wd(t)),Ig(D_,e)}}function j_(t,e,n){t==="focusin"?(cp(),oo=e,Eo=n,oo.attachEvent("onpropertychange",qg)):t==="focusout"&&cp()}function V_(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Hl(Eo)}function M_(t,e){if(t==="click")return Hl(e)}function L_(t,e){if(t==="input"||t==="change")return Hl(e)}function O_(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Cn=typeof Object.is=="function"?Object.is:O_;function To(t,e){if(Cn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!gc.call(e,s)||!Cn(t[s],e[s]))return!1}return!0}function dp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hp(t,e){var n=dp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dp(n)}}function Gg(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Gg(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Qg(){for(var t=window,e=al();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=al(t.document)}return e}function Zd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function F_(t){var e=Qg(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Gg(n.ownerDocument.documentElement,n)){if(r!==null&&Zd(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=hp(n,i);var a=hp(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var z_=tr&&"documentMode"in document&&11>=document.documentMode,Hs=null,Vc=null,ao=null,Mc=!1;function fp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Mc||Hs==null||Hs!==al(r)||(r=Hs,"selectionStart"in r&&Zd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ao&&To(ao,r)||(ao=r,r=pl(Vc,"onSelect"),0<r.length&&(e=new Yd("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Hs)))}function ba(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var qs={animationend:ba("Animation","AnimationEnd"),animationiteration:ba("Animation","AnimationIteration"),animationstart:ba("Animation","AnimationStart"),transitionend:ba("Transition","TransitionEnd")},zu={},Kg={};tr&&(Kg=document.createElement("div").style,"AnimationEvent"in window||(delete qs.animationend.animation,delete qs.animationiteration.animation,delete qs.animationstart.animation),"TransitionEvent"in window||delete qs.transitionend.transition);function ql(t){if(zu[t])return zu[t];if(!qs[t])return t;var e=qs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Kg)return zu[t]=e[n];return t}var Yg=ql("animationend"),Xg=ql("animationiteration"),Jg=ql("animationstart"),Zg=ql("transitionend"),ey=new Map,pp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ur(t,e){ey.set(t,e),vs(e,[t])}for(var Bu=0;Bu<pp.length;Bu++){var Uu=pp[Bu],B_=Uu.toLowerCase(),U_=Uu[0].toUpperCase()+Uu.slice(1);Ur(B_,"on"+U_)}Ur(Yg,"onAnimationEnd");Ur(Xg,"onAnimationIteration");Ur(Jg,"onAnimationStart");Ur("dblclick","onDoubleClick");Ur("focusin","onFocus");Ur("focusout","onBlur");Ur(Zg,"onTransitionEnd");ai("onMouseEnter",["mouseout","mouseover"]);ai("onMouseLeave",["mouseout","mouseover"]);ai("onPointerEnter",["pointerout","pointerover"]);ai("onPointerLeave",["pointerout","pointerover"]);vs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vs("onBeforeInput",["compositionend","keypress","textInput","paste"]);vs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xi));function mp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Bx(r,e,void 0,t),t.currentTarget=null}function ty(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],u=l.instance,h=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;mp(s,l,h),i=u}else for(a=0;a<r.length;a++){if(l=r[a],u=l.instance,h=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;mp(s,l,h),i=u}}}if(ul)throw t=bc,ul=!1,bc=null,t}function Me(t,e){var n=e[Bc];n===void 0&&(n=e[Bc]=new Set);var r=t+"__bubble";n.has(r)||(ny(e,t,2,!1),n.add(r))}function $u(t,e,n){var r=0;e&&(r|=4),ny(n,t,r,e)}var Da="_reactListening"+Math.random().toString(36).slice(2);function Io(t){if(!t[Da]){t[Da]=!0,ug.forEach(function(n){n!=="selectionchange"&&($_.has(n)||$u(n,!1,t),$u(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Da]||(e[Da]=!0,$u("selectionchange",!1,e))}}function ny(t,e,n,r){switch(Fg(e)){case 1:var s=r_;break;case 4:s=s_;break;default:s=Qd}n=s.bind(null,e,n,t),s=void 0,!Pc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Wu(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;l!==null;){if(a=rs(l),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}l=l.parentNode}}r=r.return}Ig(function(){var h=i,p=Wd(n),g=[];e:{var y=ey.get(t);if(y!==void 0){var T=Yd,C=t;switch(t){case"keypress":if(Qa(n)===0)break e;case"keydown":case"keyup":T=x_;break;case"focusin":C="focus",T=Lu;break;case"focusout":C="blur",T=Lu;break;case"beforeblur":case"afterblur":T=Lu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":T=rp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":T=a_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":T=S_;break;case Yg:case Xg:case Jg:T=c_;break;case Zg:T=T_;break;case"scroll":T=i_;break;case"wheel":T=A_;break;case"copy":case"cut":case"paste":T=h_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":T=ip}var b=(e&4)!==0,O=!b&&t==="scroll",A=b?y!==null?y+"Capture":null:y;b=[];for(var S=h,R;S!==null;){R=S;var M=R.stateNode;if(R.tag===5&&M!==null&&(R=M,A!==null&&(M=xo(S,A),M!=null&&b.push(Ao(S,M,R)))),O)break;S=S.return}0<b.length&&(y=new T(y,C,null,n,p),g.push({event:y,listeners:b}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",T=t==="mouseout"||t==="pointerout",y&&n!==kc&&(C=n.relatedTarget||n.fromElement)&&(rs(C)||C[nr]))break e;if((T||y)&&(y=p.window===p?p:(y=p.ownerDocument)?y.defaultView||y.parentWindow:window,T?(C=n.relatedTarget||n.toElement,T=h,C=C?rs(C):null,C!==null&&(O=xs(C),C!==O||C.tag!==5&&C.tag!==6)&&(C=null)):(T=null,C=h),T!==C)){if(b=rp,M="onMouseLeave",A="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(b=ip,M="onPointerLeave",A="onPointerEnter",S="pointer"),O=T==null?y:Gs(T),R=C==null?y:Gs(C),y=new b(M,S+"leave",T,n,p),y.target=O,y.relatedTarget=R,M=null,rs(p)===h&&(b=new b(A,S+"enter",C,n,p),b.target=R,b.relatedTarget=O,M=b),O=M,T&&C)t:{for(b=T,A=C,S=0,R=b;R;R=Ls(R))S++;for(R=0,M=A;M;M=Ls(M))R++;for(;0<S-R;)b=Ls(b),S--;for(;0<R-S;)A=Ls(A),R--;for(;S--;){if(b===A||A!==null&&b===A.alternate)break t;b=Ls(b),A=Ls(A)}b=null}else b=null;T!==null&&gp(g,y,T,b,!1),C!==null&&O!==null&&gp(g,O,C,b,!0)}}e:{if(y=h?Gs(h):window,T=y.nodeName&&y.nodeName.toLowerCase(),T==="select"||T==="input"&&y.type==="file")var B=N_;else if(lp(y))if(Hg)B=L_;else{B=V_;var L=j_}else(T=y.nodeName)&&T.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(B=M_);if(B&&(B=B(t,h))){Wg(g,B,n,p);break e}L&&L(t,y,h),t==="focusout"&&(L=y._wrapperState)&&L.controlled&&y.type==="number"&&Ec(y,"number",y.value)}switch(L=h?Gs(h):window,t){case"focusin":(lp(L)||L.contentEditable==="true")&&(Hs=L,Vc=h,ao=null);break;case"focusout":ao=Vc=Hs=null;break;case"mousedown":Mc=!0;break;case"contextmenu":case"mouseup":case"dragend":Mc=!1,fp(g,n,p);break;case"selectionchange":if(z_)break;case"keydown":case"keyup":fp(g,n,p)}var w;if(Jd)e:{switch(t){case"compositionstart":var m="onCompositionStart";break e;case"compositionend":m="onCompositionEnd";break e;case"compositionupdate":m="onCompositionUpdate";break e}m=void 0}else Ws?Ug(t,n)&&(m="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(m="onCompositionStart");m&&(Bg&&n.locale!=="ko"&&(Ws||m!=="onCompositionStart"?m==="onCompositionEnd"&&Ws&&(w=zg()):(Sr=p,Kd="value"in Sr?Sr.value:Sr.textContent,Ws=!0)),L=pl(h,m),0<L.length&&(m=new sp(m,t,null,n,p),g.push({event:m,listeners:L}),w?m.data=w:(w=$g(n),w!==null&&(m.data=w)))),(w=k_?R_(t,n):P_(t,n))&&(h=pl(h,"onBeforeInput"),0<h.length&&(p=new sp("onBeforeInput","beforeinput",null,n,p),g.push({event:p,listeners:h}),p.data=w))}ty(g,e)})}function Ao(t,e,n){return{instance:t,listener:e,currentTarget:n}}function pl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=xo(t,n),i!=null&&r.unshift(Ao(t,i,s)),i=xo(t,e),i!=null&&r.push(Ao(t,i,s))),t=t.return}return r}function Ls(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function gp(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,u=l.alternate,h=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&h!==null&&(l=h,s?(u=xo(n,i),u!=null&&a.unshift(Ao(n,u,l))):s||(u=xo(n,i),u!=null&&a.push(Ao(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var W_=/\r\n?/g,H_=/\u0000|\uFFFD/g;function yp(t){return(typeof t=="string"?t:""+t).replace(W_,`
`).replace(H_,"")}function Na(t,e,n){if(e=yp(e),yp(t)!==e&&n)throw Error(G(425))}function ml(){}var Lc=null,Oc=null;function Fc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var zc=typeof setTimeout=="function"?setTimeout:void 0,q_=typeof clearTimeout=="function"?clearTimeout:void 0,vp=typeof Promise=="function"?Promise:void 0,G_=typeof queueMicrotask=="function"?queueMicrotask:typeof vp<"u"?function(t){return vp.resolve(null).then(t).catch(Q_)}:zc;function Q_(t){setTimeout(function(){throw t})}function Hu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),So(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);So(e)}function kr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function xp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ei=Math.random().toString(36).slice(2),Mn="__reactFiber$"+Ei,Co="__reactProps$"+Ei,nr="__reactContainer$"+Ei,Bc="__reactEvents$"+Ei,K_="__reactListeners$"+Ei,Y_="__reactHandles$"+Ei;function rs(t){var e=t[Mn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[nr]||n[Mn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=xp(t);t!==null;){if(n=t[Mn])return n;t=xp(t)}return e}t=n,n=t.parentNode}return null}function Go(t){return t=t[Mn]||t[nr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Gs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(G(33))}function Gl(t){return t[Co]||null}var Uc=[],Qs=-1;function $r(t){return{current:t}}function Fe(t){0>Qs||(t.current=Uc[Qs],Uc[Qs]=null,Qs--)}function je(t,e){Qs++,Uc[Qs]=t.current,t.current=e}var Or={},Pt=$r(Or),Wt=$r(!1),cs=Or;function li(t,e){var n=t.type.contextTypes;if(!n)return Or;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ht(t){return t=t.childContextTypes,t!=null}function gl(){Fe(Wt),Fe(Pt)}function _p(t,e,n){if(Pt.current!==Or)throw Error(G(168));je(Pt,e),je(Wt,n)}function ry(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(G(108,jx(t)||"Unknown",s));return He({},n,r)}function yl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Or,cs=Pt.current,je(Pt,t),je(Wt,Wt.current),!0}function wp(t,e,n){var r=t.stateNode;if(!r)throw Error(G(169));n?(t=ry(t,e,cs),r.__reactInternalMemoizedMergedChildContext=t,Fe(Wt),Fe(Pt),je(Pt,t)):Fe(Wt),je(Wt,n)}var Gn=null,Ql=!1,qu=!1;function sy(t){Gn===null?Gn=[t]:Gn.push(t)}function X_(t){Ql=!0,sy(t)}function Wr(){if(!qu&&Gn!==null){qu=!0;var t=0,e=Ae;try{var n=Gn;for(Ae=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Gn=null,Ql=!1}catch(s){throw Gn!==null&&(Gn=Gn.slice(t+1)),Rg(Hd,Wr),s}finally{Ae=e,qu=!1}}return null}var Ks=[],Ys=0,vl=null,xl=0,cn=[],dn=0,ds=null,Yn=1,Xn="";function es(t,e){Ks[Ys++]=xl,Ks[Ys++]=vl,vl=t,xl=e}function iy(t,e,n){cn[dn++]=Yn,cn[dn++]=Xn,cn[dn++]=ds,ds=t;var r=Yn;t=Xn;var s=32-In(r)-1;r&=~(1<<s),n+=1;var i=32-In(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Yn=1<<32-In(e)+s|n<<s|r,Xn=i+t}else Yn=1<<i|n<<s|r,Xn=t}function eh(t){t.return!==null&&(es(t,1),iy(t,1,0))}function th(t){for(;t===vl;)vl=Ks[--Ys],Ks[Ys]=null,xl=Ks[--Ys],Ks[Ys]=null;for(;t===ds;)ds=cn[--dn],cn[dn]=null,Xn=cn[--dn],cn[dn]=null,Yn=cn[--dn],cn[dn]=null}var sn=null,nn=null,ze=!1,Tn=null;function oy(t,e){var n=hn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Sp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,sn=t,nn=kr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,sn=t,nn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ds!==null?{id:Yn,overflow:Xn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=hn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,sn=t,nn=null,!0):!1;default:return!1}}function $c(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Wc(t){if(ze){var e=nn;if(e){var n=e;if(!Sp(t,e)){if($c(t))throw Error(G(418));e=kr(n.nextSibling);var r=sn;e&&Sp(t,e)?oy(r,n):(t.flags=t.flags&-4097|2,ze=!1,sn=t)}}else{if($c(t))throw Error(G(418));t.flags=t.flags&-4097|2,ze=!1,sn=t}}}function Ep(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;sn=t}function ja(t){if(t!==sn)return!1;if(!ze)return Ep(t),ze=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Fc(t.type,t.memoizedProps)),e&&(e=nn)){if($c(t))throw ay(),Error(G(418));for(;e;)oy(t,e),e=kr(e.nextSibling)}if(Ep(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){nn=kr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}nn=null}}else nn=sn?kr(t.stateNode.nextSibling):null;return!0}function ay(){for(var t=nn;t;)t=kr(t.nextSibling)}function ui(){nn=sn=null,ze=!1}function nh(t){Tn===null?Tn=[t]:Tn.push(t)}var J_=lr.ReactCurrentBatchConfig;function Wi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(G(309));var r=n.stateNode}if(!r)throw Error(G(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(G(284));if(!n._owner)throw Error(G(290,t))}return t}function Va(t,e){throw t=Object.prototype.toString.call(e),Error(G(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Tp(t){var e=t._init;return e(t._payload)}function ly(t){function e(A,S){if(t){var R=A.deletions;R===null?(A.deletions=[S],A.flags|=16):R.push(S)}}function n(A,S){if(!t)return null;for(;S!==null;)e(A,S),S=S.sibling;return null}function r(A,S){for(A=new Map;S!==null;)S.key!==null?A.set(S.key,S):A.set(S.index,S),S=S.sibling;return A}function s(A,S){return A=Dr(A,S),A.index=0,A.sibling=null,A}function i(A,S,R){return A.index=R,t?(R=A.alternate,R!==null?(R=R.index,R<S?(A.flags|=2,S):R):(A.flags|=2,S)):(A.flags|=1048576,S)}function a(A){return t&&A.alternate===null&&(A.flags|=2),A}function l(A,S,R,M){return S===null||S.tag!==6?(S=Zu(R,A.mode,M),S.return=A,S):(S=s(S,R),S.return=A,S)}function u(A,S,R,M){var B=R.type;return B===$s?p(A,S,R.props.children,M,R.key):S!==null&&(S.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===vr&&Tp(B)===S.type)?(M=s(S,R.props),M.ref=Wi(A,S,R),M.return=A,M):(M=tl(R.type,R.key,R.props,null,A.mode,M),M.ref=Wi(A,S,R),M.return=A,M)}function h(A,S,R,M){return S===null||S.tag!==4||S.stateNode.containerInfo!==R.containerInfo||S.stateNode.implementation!==R.implementation?(S=ec(R,A.mode,M),S.return=A,S):(S=s(S,R.children||[]),S.return=A,S)}function p(A,S,R,M,B){return S===null||S.tag!==7?(S=ls(R,A.mode,M,B),S.return=A,S):(S=s(S,R),S.return=A,S)}function g(A,S,R){if(typeof S=="string"&&S!==""||typeof S=="number")return S=Zu(""+S,A.mode,R),S.return=A,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ta:return R=tl(S.type,S.key,S.props,null,A.mode,R),R.ref=Wi(A,null,S),R.return=A,R;case Us:return S=ec(S,A.mode,R),S.return=A,S;case vr:var M=S._init;return g(A,M(S._payload),R)}if(Ki(S)||Fi(S))return S=ls(S,A.mode,R,null),S.return=A,S;Va(A,S)}return null}function y(A,S,R,M){var B=S!==null?S.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return B!==null?null:l(A,S,""+R,M);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Ta:return R.key===B?u(A,S,R,M):null;case Us:return R.key===B?h(A,S,R,M):null;case vr:return B=R._init,y(A,S,B(R._payload),M)}if(Ki(R)||Fi(R))return B!==null?null:p(A,S,R,M,null);Va(A,R)}return null}function T(A,S,R,M,B){if(typeof M=="string"&&M!==""||typeof M=="number")return A=A.get(R)||null,l(S,A,""+M,B);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Ta:return A=A.get(M.key===null?R:M.key)||null,u(S,A,M,B);case Us:return A=A.get(M.key===null?R:M.key)||null,h(S,A,M,B);case vr:var L=M._init;return T(A,S,R,L(M._payload),B)}if(Ki(M)||Fi(M))return A=A.get(R)||null,p(S,A,M,B,null);Va(S,M)}return null}function C(A,S,R,M){for(var B=null,L=null,w=S,m=S=0,_=null;w!==null&&m<R.length;m++){w.index>m?(_=w,w=null):_=w.sibling;var E=y(A,w,R[m],M);if(E===null){w===null&&(w=_);break}t&&w&&E.alternate===null&&e(A,w),S=i(E,S,m),L===null?B=E:L.sibling=E,L=E,w=_}if(m===R.length)return n(A,w),ze&&es(A,m),B;if(w===null){for(;m<R.length;m++)w=g(A,R[m],M),w!==null&&(S=i(w,S,m),L===null?B=w:L.sibling=w,L=w);return ze&&es(A,m),B}for(w=r(A,w);m<R.length;m++)_=T(w,A,m,R[m],M),_!==null&&(t&&_.alternate!==null&&w.delete(_.key===null?m:_.key),S=i(_,S,m),L===null?B=_:L.sibling=_,L=_);return t&&w.forEach(function(k){return e(A,k)}),ze&&es(A,m),B}function b(A,S,R,M){var B=Fi(R);if(typeof B!="function")throw Error(G(150));if(R=B.call(R),R==null)throw Error(G(151));for(var L=B=null,w=S,m=S=0,_=null,E=R.next();w!==null&&!E.done;m++,E=R.next()){w.index>m?(_=w,w=null):_=w.sibling;var k=y(A,w,E.value,M);if(k===null){w===null&&(w=_);break}t&&w&&k.alternate===null&&e(A,w),S=i(k,S,m),L===null?B=k:L.sibling=k,L=k,w=_}if(E.done)return n(A,w),ze&&es(A,m),B;if(w===null){for(;!E.done;m++,E=R.next())E=g(A,E.value,M),E!==null&&(S=i(E,S,m),L===null?B=E:L.sibling=E,L=E);return ze&&es(A,m),B}for(w=r(A,w);!E.done;m++,E=R.next())E=T(w,A,m,E.value,M),E!==null&&(t&&E.alternate!==null&&w.delete(E.key===null?m:E.key),S=i(E,S,m),L===null?B=E:L.sibling=E,L=E);return t&&w.forEach(function(P){return e(A,P)}),ze&&es(A,m),B}function O(A,S,R,M){if(typeof R=="object"&&R!==null&&R.type===$s&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case Ta:e:{for(var B=R.key,L=S;L!==null;){if(L.key===B){if(B=R.type,B===$s){if(L.tag===7){n(A,L.sibling),S=s(L,R.props.children),S.return=A,A=S;break e}}else if(L.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===vr&&Tp(B)===L.type){n(A,L.sibling),S=s(L,R.props),S.ref=Wi(A,L,R),S.return=A,A=S;break e}n(A,L);break}else e(A,L);L=L.sibling}R.type===$s?(S=ls(R.props.children,A.mode,M,R.key),S.return=A,A=S):(M=tl(R.type,R.key,R.props,null,A.mode,M),M.ref=Wi(A,S,R),M.return=A,A=M)}return a(A);case Us:e:{for(L=R.key;S!==null;){if(S.key===L)if(S.tag===4&&S.stateNode.containerInfo===R.containerInfo&&S.stateNode.implementation===R.implementation){n(A,S.sibling),S=s(S,R.children||[]),S.return=A,A=S;break e}else{n(A,S);break}else e(A,S);S=S.sibling}S=ec(R,A.mode,M),S.return=A,A=S}return a(A);case vr:return L=R._init,O(A,S,L(R._payload),M)}if(Ki(R))return C(A,S,R,M);if(Fi(R))return b(A,S,R,M);Va(A,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,S!==null&&S.tag===6?(n(A,S.sibling),S=s(S,R),S.return=A,A=S):(n(A,S),S=Zu(R,A.mode,M),S.return=A,A=S),a(A)):n(A,S)}return O}var ci=ly(!0),uy=ly(!1),_l=$r(null),wl=null,Xs=null,rh=null;function sh(){rh=Xs=wl=null}function ih(t){var e=_l.current;Fe(_l),t._currentValue=e}function Hc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function si(t,e){wl=t,rh=Xs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&($t=!0),t.firstContext=null)}function gn(t){var e=t._currentValue;if(rh!==t)if(t={context:t,memoizedValue:e,next:null},Xs===null){if(wl===null)throw Error(G(308));Xs=t,wl.dependencies={lanes:0,firstContext:t}}else Xs=Xs.next=t;return e}var ss=null;function oh(t){ss===null?ss=[t]:ss.push(t)}function cy(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,oh(e)):(n.next=s.next,s.next=n),e.interleaved=n,rr(t,r)}function rr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var xr=!1;function ah(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dy(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Jn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Rr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Se&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,rr(t,n)}return s=r.interleaved,s===null?(e.next=e,oh(r)):(e.next=s.next,s.next=e),r.interleaved=e,rr(t,n)}function Ka(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,qd(t,n)}}function Ip(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Sl(t,e,n,r){var s=t.updateQueue;xr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,h=u.next;u.next=null,a===null?i=h:a.next=h,a=u;var p=t.alternate;p!==null&&(p=p.updateQueue,l=p.lastBaseUpdate,l!==a&&(l===null?p.firstBaseUpdate=h:l.next=h,p.lastBaseUpdate=u))}if(i!==null){var g=s.baseState;a=0,p=h=u=null,l=i;do{var y=l.lane,T=l.eventTime;if((r&y)===y){p!==null&&(p=p.next={eventTime:T,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var C=t,b=l;switch(y=e,T=n,b.tag){case 1:if(C=b.payload,typeof C=="function"){g=C.call(T,g,y);break e}g=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=b.payload,y=typeof C=="function"?C.call(T,g,y):C,y==null)break e;g=He({},g,y);break e;case 2:xr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[l]:y.push(l))}else T={eventTime:T,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},p===null?(h=p=T,u=g):p=p.next=T,a|=y;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;y=l,l=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(p===null&&(u=g),s.baseState=u,s.firstBaseUpdate=h,s.lastBaseUpdate=p,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);fs|=a,t.lanes=a,t.memoizedState=g}}function Ap(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(G(191,s));s.call(r)}}}var Qo={},On=$r(Qo),ko=$r(Qo),Ro=$r(Qo);function is(t){if(t===Qo)throw Error(G(174));return t}function lh(t,e){switch(je(Ro,e),je(ko,t),je(On,Qo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ic(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ic(e,t)}Fe(On),je(On,e)}function di(){Fe(On),Fe(ko),Fe(Ro)}function hy(t){is(Ro.current);var e=is(On.current),n=Ic(e,t.type);e!==n&&(je(ko,t),je(On,n))}function uh(t){ko.current===t&&(Fe(On),Fe(ko))}var Ue=$r(0);function El(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Gu=[];function ch(){for(var t=0;t<Gu.length;t++)Gu[t]._workInProgressVersionPrimary=null;Gu.length=0}var Ya=lr.ReactCurrentDispatcher,Qu=lr.ReactCurrentBatchConfig,hs=0,We=null,it=null,ut=null,Tl=!1,lo=!1,Po=0,Z_=0;function Tt(){throw Error(G(321))}function dh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Cn(t[n],e[n]))return!1;return!0}function hh(t,e,n,r,s,i){if(hs=i,We=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ya.current=t===null||t.memoizedState===null?r1:s1,t=n(r,s),lo){i=0;do{if(lo=!1,Po=0,25<=i)throw Error(G(301));i+=1,ut=it=null,e.updateQueue=null,Ya.current=i1,t=n(r,s)}while(lo)}if(Ya.current=Il,e=it!==null&&it.next!==null,hs=0,ut=it=We=null,Tl=!1,e)throw Error(G(300));return t}function fh(){var t=Po!==0;return Po=0,t}function Vn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ut===null?We.memoizedState=ut=t:ut=ut.next=t,ut}function yn(){if(it===null){var t=We.alternate;t=t!==null?t.memoizedState:null}else t=it.next;var e=ut===null?We.memoizedState:ut.next;if(e!==null)ut=e,it=t;else{if(t===null)throw Error(G(310));it=t,t={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},ut===null?We.memoizedState=ut=t:ut=ut.next=t}return ut}function bo(t,e){return typeof e=="function"?e(t):e}function Ku(t){var e=yn(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=it,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,u=null,h=i;do{var p=h.lane;if((hs&p)===p)u!==null&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var g={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};u===null?(l=u=g,a=r):u=u.next=g,We.lanes|=p,fs|=p}h=h.next}while(h!==null&&h!==i);u===null?a=r:u.next=l,Cn(r,e.memoizedState)||($t=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,We.lanes|=i,fs|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Yu(t){var e=yn(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Cn(i,e.memoizedState)||($t=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function fy(){}function py(t,e){var n=We,r=yn(),s=e(),i=!Cn(r.memoizedState,s);if(i&&(r.memoizedState=s,$t=!0),r=r.queue,ph(yy.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ut!==null&&ut.memoizedState.tag&1){if(n.flags|=2048,Do(9,gy.bind(null,n,r,s,e),void 0,null),ct===null)throw Error(G(349));hs&30||my(n,e,s)}return s}function my(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function gy(t,e,n,r){e.value=n,e.getSnapshot=r,vy(e)&&xy(t)}function yy(t,e,n){return n(function(){vy(e)&&xy(t)})}function vy(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Cn(t,n)}catch{return!0}}function xy(t){var e=rr(t,1);e!==null&&An(e,t,1,-1)}function Cp(t){var e=Vn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bo,lastRenderedState:t},e.queue=t,t=t.dispatch=n1.bind(null,We,t),[e.memoizedState,t]}function Do(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function _y(){return yn().memoizedState}function Xa(t,e,n,r){var s=Vn();We.flags|=t,s.memoizedState=Do(1|e,n,void 0,r===void 0?null:r)}function Kl(t,e,n,r){var s=yn();r=r===void 0?null:r;var i=void 0;if(it!==null){var a=it.memoizedState;if(i=a.destroy,r!==null&&dh(r,a.deps)){s.memoizedState=Do(e,n,i,r);return}}We.flags|=t,s.memoizedState=Do(1|e,n,i,r)}function kp(t,e){return Xa(8390656,8,t,e)}function ph(t,e){return Kl(2048,8,t,e)}function wy(t,e){return Kl(4,2,t,e)}function Sy(t,e){return Kl(4,4,t,e)}function Ey(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Ty(t,e,n){return n=n!=null?n.concat([t]):null,Kl(4,4,Ey.bind(null,e,t),n)}function mh(){}function Iy(t,e){var n=yn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&dh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Ay(t,e){var n=yn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&dh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Cy(t,e,n){return hs&21?(Cn(n,e)||(n=Dg(),We.lanes|=n,fs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,$t=!0),t.memoizedState=n)}function e1(t,e){var n=Ae;Ae=n!==0&&4>n?n:4,t(!0);var r=Qu.transition;Qu.transition={};try{t(!1),e()}finally{Ae=n,Qu.transition=r}}function ky(){return yn().memoizedState}function t1(t,e,n){var r=br(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ry(t))Py(e,n);else if(n=cy(t,e,n,r),n!==null){var s=jt();An(n,t,r,s),by(n,e,r)}}function n1(t,e,n){var r=br(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ry(t))Py(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,Cn(l,a)){var u=e.interleaved;u===null?(s.next=s,oh(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=cy(t,e,s,r),n!==null&&(s=jt(),An(n,t,r,s),by(n,e,r))}}function Ry(t){var e=t.alternate;return t===We||e!==null&&e===We}function Py(t,e){lo=Tl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function by(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,qd(t,n)}}var Il={readContext:gn,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},r1={readContext:gn,useCallback:function(t,e){return Vn().memoizedState=[t,e===void 0?null:e],t},useContext:gn,useEffect:kp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Xa(4194308,4,Ey.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Xa(4194308,4,t,e)},useInsertionEffect:function(t,e){return Xa(4,2,t,e)},useMemo:function(t,e){var n=Vn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Vn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=t1.bind(null,We,t),[r.memoizedState,t]},useRef:function(t){var e=Vn();return t={current:t},e.memoizedState=t},useState:Cp,useDebugValue:mh,useDeferredValue:function(t){return Vn().memoizedState=t},useTransition:function(){var t=Cp(!1),e=t[0];return t=e1.bind(null,t[1]),Vn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=We,s=Vn();if(ze){if(n===void 0)throw Error(G(407));n=n()}else{if(n=e(),ct===null)throw Error(G(349));hs&30||my(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,kp(yy.bind(null,r,i,t),[t]),r.flags|=2048,Do(9,gy.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Vn(),e=ct.identifierPrefix;if(ze){var n=Xn,r=Yn;n=(r&~(1<<32-In(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Po++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Z_++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},s1={readContext:gn,useCallback:Iy,useContext:gn,useEffect:ph,useImperativeHandle:Ty,useInsertionEffect:wy,useLayoutEffect:Sy,useMemo:Ay,useReducer:Ku,useRef:_y,useState:function(){return Ku(bo)},useDebugValue:mh,useDeferredValue:function(t){var e=yn();return Cy(e,it.memoizedState,t)},useTransition:function(){var t=Ku(bo)[0],e=yn().memoizedState;return[t,e]},useMutableSource:fy,useSyncExternalStore:py,useId:ky,unstable_isNewReconciler:!1},i1={readContext:gn,useCallback:Iy,useContext:gn,useEffect:ph,useImperativeHandle:Ty,useInsertionEffect:wy,useLayoutEffect:Sy,useMemo:Ay,useReducer:Yu,useRef:_y,useState:function(){return Yu(bo)},useDebugValue:mh,useDeferredValue:function(t){var e=yn();return it===null?e.memoizedState=t:Cy(e,it.memoizedState,t)},useTransition:function(){var t=Yu(bo)[0],e=yn().memoizedState;return[t,e]},useMutableSource:fy,useSyncExternalStore:py,useId:ky,unstable_isNewReconciler:!1};function Sn(t,e){if(t&&t.defaultProps){e=He({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function qc(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:He({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Yl={isMounted:function(t){return(t=t._reactInternals)?xs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=jt(),s=br(t),i=Jn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Rr(t,i,s),e!==null&&(An(e,t,s,r),Ka(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=jt(),s=br(t),i=Jn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Rr(t,i,s),e!==null&&(An(e,t,s,r),Ka(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=jt(),r=br(t),s=Jn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Rr(t,s,r),e!==null&&(An(e,t,r,n),Ka(e,t,r))}};function Rp(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!To(n,r)||!To(s,i):!0}function Dy(t,e,n){var r=!1,s=Or,i=e.contextType;return typeof i=="object"&&i!==null?i=gn(i):(s=Ht(e)?cs:Pt.current,r=e.contextTypes,i=(r=r!=null)?li(t,s):Or),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Yl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Pp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Yl.enqueueReplaceState(e,e.state,null)}function Gc(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},ah(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=gn(i):(i=Ht(e)?cs:Pt.current,s.context=li(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(qc(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Yl.enqueueReplaceState(s,s.state,null),Sl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function hi(t,e){try{var n="",r=e;do n+=Nx(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Xu(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Qc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var o1=typeof WeakMap=="function"?WeakMap:Map;function Ny(t,e,n){n=Jn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Cl||(Cl=!0,sd=r),Qc(t,e)},n}function jy(t,e,n){n=Jn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Qc(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Qc(t,e),typeof r!="function"&&(Pr===null?Pr=new Set([this]):Pr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function bp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new o1;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=_1.bind(null,t,e,n),e.then(t,t))}function Dp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Np(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Jn(-1,1),e.tag=2,Rr(n,e,1))),n.lanes|=1),t)}var a1=lr.ReactCurrentOwner,$t=!1;function Dt(t,e,n,r){e.child=t===null?uy(e,null,n,r):ci(e,t.child,n,r)}function jp(t,e,n,r,s){n=n.render;var i=e.ref;return si(e,s),r=hh(t,e,n,r,i,s),n=fh(),t!==null&&!$t?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,sr(t,e,s)):(ze&&n&&eh(e),e.flags|=1,Dt(t,e,r,s),e.child)}function Vp(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Eh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Vy(t,e,i,r,s)):(t=tl(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:To,n(a,r)&&t.ref===e.ref)return sr(t,e,s)}return e.flags|=1,t=Dr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Vy(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(To(i,r)&&t.ref===e.ref)if($t=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&($t=!0);else return e.lanes=t.lanes,sr(t,e,s)}return Kc(t,e,n,r,s)}function My(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},je(Zs,tn),tn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,je(Zs,tn),tn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,je(Zs,tn),tn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,je(Zs,tn),tn|=r;return Dt(t,e,s,n),e.child}function Ly(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Kc(t,e,n,r,s){var i=Ht(n)?cs:Pt.current;return i=li(e,i),si(e,s),n=hh(t,e,n,r,i,s),r=fh(),t!==null&&!$t?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,sr(t,e,s)):(ze&&r&&eh(e),e.flags|=1,Dt(t,e,n,s),e.child)}function Mp(t,e,n,r,s){if(Ht(n)){var i=!0;yl(e)}else i=!1;if(si(e,s),e.stateNode===null)Ja(t,e),Dy(e,n,r),Gc(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,h=n.contextType;typeof h=="object"&&h!==null?h=gn(h):(h=Ht(n)?cs:Pt.current,h=li(e,h));var p=n.getDerivedStateFromProps,g=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";g||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||u!==h)&&Pp(e,a,r,h),xr=!1;var y=e.memoizedState;a.state=y,Sl(e,r,a,s),u=e.memoizedState,l!==r||y!==u||Wt.current||xr?(typeof p=="function"&&(qc(e,n,p,r),u=e.memoizedState),(l=xr||Rp(e,n,l,r,y,u,h))?(g||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=h,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,dy(t,e),l=e.memoizedProps,h=e.type===e.elementType?l:Sn(e.type,l),a.props=h,g=e.pendingProps,y=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=gn(u):(u=Ht(n)?cs:Pt.current,u=li(e,u));var T=n.getDerivedStateFromProps;(p=typeof T=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==g||y!==u)&&Pp(e,a,r,u),xr=!1,y=e.memoizedState,a.state=y,Sl(e,r,a,s);var C=e.memoizedState;l!==g||y!==C||Wt.current||xr?(typeof T=="function"&&(qc(e,n,T,r),C=e.memoizedState),(h=xr||Rp(e,n,h,r,y,C,u)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,C,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,C,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=C),a.props=r,a.state=C,a.context=u,r=h):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return Yc(t,e,n,r,i,s)}function Yc(t,e,n,r,s,i){Ly(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&wp(e,n,!1),sr(t,e,i);r=e.stateNode,a1.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=ci(e,t.child,null,i),e.child=ci(e,null,l,i)):Dt(t,e,l,i),e.memoizedState=r.state,s&&wp(e,n,!0),e.child}function Oy(t){var e=t.stateNode;e.pendingContext?_p(t,e.pendingContext,e.pendingContext!==e.context):e.context&&_p(t,e.context,!1),lh(t,e.containerInfo)}function Lp(t,e,n,r,s){return ui(),nh(s),e.flags|=256,Dt(t,e,n,r),e.child}var Xc={dehydrated:null,treeContext:null,retryLane:0};function Jc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Fy(t,e,n){var r=e.pendingProps,s=Ue.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),je(Ue,s&1),t===null)return Wc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Zl(a,r,0,null),t=ls(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Jc(n),e.memoizedState=Xc,t):gh(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return l1(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Dr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Dr(l,i):(i=ls(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?Jc(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=Xc,r}return i=t.child,t=i.sibling,r=Dr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function gh(t,e){return e=Zl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ma(t,e,n,r){return r!==null&&nh(r),ci(e,t.child,null,n),t=gh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function l1(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=Xu(Error(G(422))),Ma(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Zl({mode:"visible",children:r.children},s,0,null),i=ls(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ci(e,t.child,null,a),e.child.memoizedState=Jc(a),e.memoizedState=Xc,i);if(!(e.mode&1))return Ma(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(G(419)),r=Xu(i,r,void 0),Ma(t,e,a,r)}if(l=(a&t.childLanes)!==0,$t||l){if(r=ct,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,rr(t,s),An(r,t,s,-1))}return Sh(),r=Xu(Error(G(421))),Ma(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=w1.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,nn=kr(s.nextSibling),sn=e,ze=!0,Tn=null,t!==null&&(cn[dn++]=Yn,cn[dn++]=Xn,cn[dn++]=ds,Yn=t.id,Xn=t.overflow,ds=e),e=gh(e,r.children),e.flags|=4096,e)}function Op(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Hc(t.return,e,n)}function Ju(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function zy(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Dt(t,e,r.children,n),r=Ue.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Op(t,n,e);else if(t.tag===19)Op(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(je(Ue,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&El(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Ju(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&El(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Ju(e,!0,n,null,i);break;case"together":Ju(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ja(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function sr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),fs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(G(153));if(e.child!==null){for(t=e.child,n=Dr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Dr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function u1(t,e,n){switch(e.tag){case 3:Oy(e),ui();break;case 5:hy(e);break;case 1:Ht(e.type)&&yl(e);break;case 4:lh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;je(_l,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(je(Ue,Ue.current&1),e.flags|=128,null):n&e.child.childLanes?Fy(t,e,n):(je(Ue,Ue.current&1),t=sr(t,e,n),t!==null?t.sibling:null);je(Ue,Ue.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return zy(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),je(Ue,Ue.current),r)break;return null;case 22:case 23:return e.lanes=0,My(t,e,n)}return sr(t,e,n)}var By,Zc,Uy,$y;By=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Zc=function(){};Uy=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,is(On.current);var i=null;switch(n){case"input":s=wc(t,s),r=wc(t,r),i=[];break;case"select":s=He({},s,{value:void 0}),r=He({},r,{value:void 0}),i=[];break;case"textarea":s=Tc(t,s),r=Tc(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ml)}Ac(n,r);var a;n=null;for(h in s)if(!r.hasOwnProperty(h)&&s.hasOwnProperty(h)&&s[h]!=null)if(h==="style"){var l=s[h];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(yo.hasOwnProperty(h)?i||(i=[]):(i=i||[]).push(h,null));for(h in r){var u=r[h];if(l=s!=null?s[h]:void 0,r.hasOwnProperty(h)&&u!==l&&(u!=null||l!=null))if(h==="style")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(h,n)),n=u;else h==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(h,u)):h==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(h,""+u):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(yo.hasOwnProperty(h)?(u!=null&&h==="onScroll"&&Me("scroll",t),i||l===u||(i=[])):(i=i||[]).push(h,u))}n&&(i=i||[]).push("style",n);var h=i;(e.updateQueue=h)&&(e.flags|=4)}};$y=function(t,e,n,r){n!==r&&(e.flags|=4)};function Hi(t,e){if(!ze)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function It(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function c1(t,e,n){var r=e.pendingProps;switch(th(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(e),null;case 1:return Ht(e.type)&&gl(),It(e),null;case 3:return r=e.stateNode,di(),Fe(Wt),Fe(Pt),ch(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ja(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Tn!==null&&(ad(Tn),Tn=null))),Zc(t,e),It(e),null;case 5:uh(e);var s=is(Ro.current);if(n=e.type,t!==null&&e.stateNode!=null)Uy(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(G(166));return It(e),null}if(t=is(On.current),ja(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Mn]=e,r[Co]=i,t=(e.mode&1)!==0,n){case"dialog":Me("cancel",r),Me("close",r);break;case"iframe":case"object":case"embed":Me("load",r);break;case"video":case"audio":for(s=0;s<Xi.length;s++)Me(Xi[s],r);break;case"source":Me("error",r);break;case"img":case"image":case"link":Me("error",r),Me("load",r);break;case"details":Me("toggle",r);break;case"input":Gf(r,i),Me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Me("invalid",r);break;case"textarea":Kf(r,i),Me("invalid",r)}Ac(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Na(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Na(r.textContent,l,t),s=["children",""+l]):yo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Me("scroll",r)}switch(n){case"input":Ia(r),Qf(r,i,!0);break;case"textarea":Ia(r),Yf(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ml)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yg(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Mn]=e,t[Co]=r,By(t,e,!1,!1),e.stateNode=t;e:{switch(a=Cc(n,r),n){case"dialog":Me("cancel",t),Me("close",t),s=r;break;case"iframe":case"object":case"embed":Me("load",t),s=r;break;case"video":case"audio":for(s=0;s<Xi.length;s++)Me(Xi[s],t);s=r;break;case"source":Me("error",t),s=r;break;case"img":case"image":case"link":Me("error",t),Me("load",t),s=r;break;case"details":Me("toggle",t),s=r;break;case"input":Gf(t,r),s=wc(t,r),Me("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=He({},r,{value:void 0}),Me("invalid",t);break;case"textarea":Kf(t,r),s=Tc(t,r),Me("invalid",t);break;default:s=r}Ac(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?_g(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&vg(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&vo(t,u):typeof u=="number"&&vo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(yo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Me("scroll",t):u!=null&&zd(t,i,u,a))}switch(n){case"input":Ia(t),Qf(t,r,!1);break;case"textarea":Ia(t),Yf(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Lr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ei(t,!!r.multiple,i,!1):r.defaultValue!=null&&ei(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=ml)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return It(e),null;case 6:if(t&&e.stateNode!=null)$y(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(G(166));if(n=is(Ro.current),is(On.current),ja(e)){if(r=e.stateNode,n=e.memoizedProps,r[Mn]=e,(i=r.nodeValue!==n)&&(t=sn,t!==null))switch(t.tag){case 3:Na(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Na(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Mn]=e,e.stateNode=r}return It(e),null;case 13:if(Fe(Ue),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ze&&nn!==null&&e.mode&1&&!(e.flags&128))ay(),ui(),e.flags|=98560,i=!1;else if(i=ja(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(G(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(G(317));i[Mn]=e}else ui(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;It(e),i=!1}else Tn!==null&&(ad(Tn),Tn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ue.current&1?ot===0&&(ot=3):Sh())),e.updateQueue!==null&&(e.flags|=4),It(e),null);case 4:return di(),Zc(t,e),t===null&&Io(e.stateNode.containerInfo),It(e),null;case 10:return ih(e.type._context),It(e),null;case 17:return Ht(e.type)&&gl(),It(e),null;case 19:if(Fe(Ue),i=e.memoizedState,i===null)return It(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Hi(i,!1);else{if(ot!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=El(t),a!==null){for(e.flags|=128,Hi(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return je(Ue,Ue.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ze()>fi&&(e.flags|=128,r=!0,Hi(i,!1),e.lanes=4194304)}else{if(!r)if(t=El(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Hi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!ze)return It(e),null}else 2*Ze()-i.renderingStartTime>fi&&n!==1073741824&&(e.flags|=128,r=!0,Hi(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ze(),e.sibling=null,n=Ue.current,je(Ue,r?n&1|2:n&1),e):(It(e),null);case 22:case 23:return wh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?tn&1073741824&&(It(e),e.subtreeFlags&6&&(e.flags|=8192)):It(e),null;case 24:return null;case 25:return null}throw Error(G(156,e.tag))}function d1(t,e){switch(th(e),e.tag){case 1:return Ht(e.type)&&gl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return di(),Fe(Wt),Fe(Pt),ch(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return uh(e),null;case 13:if(Fe(Ue),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(G(340));ui()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Fe(Ue),null;case 4:return di(),null;case 10:return ih(e.type._context),null;case 22:case 23:return wh(),null;case 24:return null;default:return null}}var La=!1,kt=!1,h1=typeof WeakSet=="function"?WeakSet:Set,re=null;function Js(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Qe(t,e,r)}else n.current=null}function ed(t,e,n){try{n()}catch(r){Qe(t,e,r)}}var Fp=!1;function f1(t,e){if(Lc=hl,t=Qg(),Zd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,u=-1,h=0,p=0,g=t,y=null;t:for(;;){for(var T;g!==n||s!==0&&g.nodeType!==3||(l=a+s),g!==i||r!==0&&g.nodeType!==3||(u=a+r),g.nodeType===3&&(a+=g.nodeValue.length),(T=g.firstChild)!==null;)y=g,g=T;for(;;){if(g===t)break t;if(y===n&&++h===s&&(l=a),y===i&&++p===r&&(u=a),(T=g.nextSibling)!==null)break;g=y,y=g.parentNode}g=T}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Oc={focusedElem:t,selectionRange:n},hl=!1,re=e;re!==null;)if(e=re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,re=t;else for(;re!==null;){e=re;try{var C=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var b=C.memoizedProps,O=C.memoizedState,A=e.stateNode,S=A.getSnapshotBeforeUpdate(e.elementType===e.type?b:Sn(e.type,b),O);A.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var R=e.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(M){Qe(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,re=t;break}re=e.return}return C=Fp,Fp=!1,C}function uo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&ed(e,n,i)}s=s.next}while(s!==r)}}function Xl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function td(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Wy(t){var e=t.alternate;e!==null&&(t.alternate=null,Wy(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Mn],delete e[Co],delete e[Bc],delete e[K_],delete e[Y_])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Hy(t){return t.tag===5||t.tag===3||t.tag===4}function zp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Hy(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function nd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ml));else if(r!==4&&(t=t.child,t!==null))for(nd(t,e,n),t=t.sibling;t!==null;)nd(t,e,n),t=t.sibling}function rd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(rd(t,e,n),t=t.sibling;t!==null;)rd(t,e,n),t=t.sibling}var ht=null,En=!1;function yr(t,e,n){for(n=n.child;n!==null;)qy(t,e,n),n=n.sibling}function qy(t,e,n){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount($l,n)}catch{}switch(n.tag){case 5:kt||Js(n,e);case 6:var r=ht,s=En;ht=null,yr(t,e,n),ht=r,En=s,ht!==null&&(En?(t=ht,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ht.removeChild(n.stateNode));break;case 18:ht!==null&&(En?(t=ht,n=n.stateNode,t.nodeType===8?Hu(t.parentNode,n):t.nodeType===1&&Hu(t,n),So(t)):Hu(ht,n.stateNode));break;case 4:r=ht,s=En,ht=n.stateNode.containerInfo,En=!0,yr(t,e,n),ht=r,En=s;break;case 0:case 11:case 14:case 15:if(!kt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&ed(n,e,a),s=s.next}while(s!==r)}yr(t,e,n);break;case 1:if(!kt&&(Js(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Qe(n,e,l)}yr(t,e,n);break;case 21:yr(t,e,n);break;case 22:n.mode&1?(kt=(r=kt)||n.memoizedState!==null,yr(t,e,n),kt=r):yr(t,e,n);break;default:yr(t,e,n)}}function Bp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new h1),e.forEach(function(r){var s=S1.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function wn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:ht=l.stateNode,En=!1;break e;case 3:ht=l.stateNode.containerInfo,En=!0;break e;case 4:ht=l.stateNode.containerInfo,En=!0;break e}l=l.return}if(ht===null)throw Error(G(160));qy(i,a,s),ht=null,En=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(h){Qe(s,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Gy(e,t),e=e.sibling}function Gy(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(wn(e,t),jn(t),r&4){try{uo(3,t,t.return),Xl(3,t)}catch(b){Qe(t,t.return,b)}try{uo(5,t,t.return)}catch(b){Qe(t,t.return,b)}}break;case 1:wn(e,t),jn(t),r&512&&n!==null&&Js(n,n.return);break;case 5:if(wn(e,t),jn(t),r&512&&n!==null&&Js(n,n.return),t.flags&32){var s=t.stateNode;try{vo(s,"")}catch(b){Qe(t,t.return,b)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&mg(s,i),Cc(l,a);var h=Cc(l,i);for(a=0;a<u.length;a+=2){var p=u[a],g=u[a+1];p==="style"?_g(s,g):p==="dangerouslySetInnerHTML"?vg(s,g):p==="children"?vo(s,g):zd(s,p,g,h)}switch(l){case"input":Sc(s,i);break;case"textarea":gg(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var T=i.value;T!=null?ei(s,!!i.multiple,T,!1):y!==!!i.multiple&&(i.defaultValue!=null?ei(s,!!i.multiple,i.defaultValue,!0):ei(s,!!i.multiple,i.multiple?[]:"",!1))}s[Co]=i}catch(b){Qe(t,t.return,b)}}break;case 6:if(wn(e,t),jn(t),r&4){if(t.stateNode===null)throw Error(G(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(b){Qe(t,t.return,b)}}break;case 3:if(wn(e,t),jn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{So(e.containerInfo)}catch(b){Qe(t,t.return,b)}break;case 4:wn(e,t),jn(t);break;case 13:wn(e,t),jn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(xh=Ze())),r&4&&Bp(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(kt=(h=kt)||p,wn(e,t),kt=h):wn(e,t),jn(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&t.mode&1)for(re=t,p=t.child;p!==null;){for(g=re=p;re!==null;){switch(y=re,T=y.child,y.tag){case 0:case 11:case 14:case 15:uo(4,y,y.return);break;case 1:Js(y,y.return);var C=y.stateNode;if(typeof C.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(b){Qe(r,n,b)}}break;case 5:Js(y,y.return);break;case 22:if(y.memoizedState!==null){$p(g);continue}}T!==null?(T.return=y,re=T):$p(g)}p=p.sibling}e:for(p=null,g=t;;){if(g.tag===5){if(p===null){p=g;try{s=g.stateNode,h?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=g.stateNode,u=g.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=xg("display",a))}catch(b){Qe(t,t.return,b)}}}else if(g.tag===6){if(p===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(b){Qe(t,t.return,b)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;p===g&&(p=null),g=g.return}p===g&&(p=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:wn(e,t),jn(t),r&4&&Bp(t);break;case 21:break;default:wn(e,t),jn(t)}}function jn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Hy(n)){var r=n;break e}n=n.return}throw Error(G(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(vo(s,""),r.flags&=-33);var i=zp(t);rd(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=zp(t);nd(t,l,a);break;default:throw Error(G(161))}}catch(u){Qe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function p1(t,e,n){re=t,Qy(t)}function Qy(t,e,n){for(var r=(t.mode&1)!==0;re!==null;){var s=re,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||La;if(!a){var l=s.alternate,u=l!==null&&l.memoizedState!==null||kt;l=La;var h=kt;if(La=a,(kt=u)&&!h)for(re=s;re!==null;)a=re,u=a.child,a.tag===22&&a.memoizedState!==null?Wp(s):u!==null?(u.return=a,re=u):Wp(s);for(;i!==null;)re=i,Qy(i),i=i.sibling;re=s,La=l,kt=h}Up(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,re=i):Up(t)}}function Up(t){for(;re!==null;){var e=re;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:kt||Xl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!kt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Sn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Ap(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Ap(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var g=p.dehydrated;g!==null&&So(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}kt||e.flags&512&&td(e)}catch(y){Qe(e,e.return,y)}}if(e===t){re=null;break}if(n=e.sibling,n!==null){n.return=e.return,re=n;break}re=e.return}}function $p(t){for(;re!==null;){var e=re;if(e===t){re=null;break}var n=e.sibling;if(n!==null){n.return=e.return,re=n;break}re=e.return}}function Wp(t){for(;re!==null;){var e=re;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Xl(4,e)}catch(u){Qe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Qe(e,s,u)}}var i=e.return;try{td(e)}catch(u){Qe(e,i,u)}break;case 5:var a=e.return;try{td(e)}catch(u){Qe(e,a,u)}}}catch(u){Qe(e,e.return,u)}if(e===t){re=null;break}var l=e.sibling;if(l!==null){l.return=e.return,re=l;break}re=e.return}}var m1=Math.ceil,Al=lr.ReactCurrentDispatcher,yh=lr.ReactCurrentOwner,pn=lr.ReactCurrentBatchConfig,Se=0,ct=null,tt=null,mt=0,tn=0,Zs=$r(0),ot=0,No=null,fs=0,Jl=0,vh=0,co=null,Bt=null,xh=0,fi=1/0,qn=null,Cl=!1,sd=null,Pr=null,Oa=!1,Er=null,kl=0,ho=0,id=null,Za=-1,el=0;function jt(){return Se&6?Ze():Za!==-1?Za:Za=Ze()}function br(t){return t.mode&1?Se&2&&mt!==0?mt&-mt:J_.transition!==null?(el===0&&(el=Dg()),el):(t=Ae,t!==0||(t=window.event,t=t===void 0?16:Fg(t.type)),t):1}function An(t,e,n,r){if(50<ho)throw ho=0,id=null,Error(G(185));Ho(t,n,r),(!(Se&2)||t!==ct)&&(t===ct&&(!(Se&2)&&(Jl|=n),ot===4&&wr(t,mt)),qt(t,r),n===1&&Se===0&&!(e.mode&1)&&(fi=Ze()+500,Ql&&Wr()))}function qt(t,e){var n=t.callbackNode;Jx(t,e);var r=dl(t,t===ct?mt:0);if(r===0)n!==null&&Zf(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Zf(n),e===1)t.tag===0?X_(Hp.bind(null,t)):sy(Hp.bind(null,t)),G_(function(){!(Se&6)&&Wr()}),n=null;else{switch(Ng(r)){case 1:n=Hd;break;case 4:n=Pg;break;case 16:n=cl;break;case 536870912:n=bg;break;default:n=cl}n=n0(n,Ky.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Ky(t,e){if(Za=-1,el=0,Se&6)throw Error(G(327));var n=t.callbackNode;if(ii()&&t.callbackNode!==n)return null;var r=dl(t,t===ct?mt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Rl(t,r);else{e=r;var s=Se;Se|=2;var i=Xy();(ct!==t||mt!==e)&&(qn=null,fi=Ze()+500,as(t,e));do try{v1();break}catch(l){Yy(t,l)}while(!0);sh(),Al.current=i,Se=s,tt!==null?e=0:(ct=null,mt=0,e=ot)}if(e!==0){if(e===2&&(s=Dc(t),s!==0&&(r=s,e=od(t,s))),e===1)throw n=No,as(t,0),wr(t,r),qt(t,Ze()),n;if(e===6)wr(t,r);else{if(s=t.current.alternate,!(r&30)&&!g1(s)&&(e=Rl(t,r),e===2&&(i=Dc(t),i!==0&&(r=i,e=od(t,i))),e===1))throw n=No,as(t,0),wr(t,r),qt(t,Ze()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(G(345));case 2:ts(t,Bt,qn);break;case 3:if(wr(t,r),(r&130023424)===r&&(e=xh+500-Ze(),10<e)){if(dl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){jt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=zc(ts.bind(null,t,Bt,qn),e);break}ts(t,Bt,qn);break;case 4:if(wr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-In(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=Ze()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*m1(r/1960))-r,10<r){t.timeoutHandle=zc(ts.bind(null,t,Bt,qn),r);break}ts(t,Bt,qn);break;case 5:ts(t,Bt,qn);break;default:throw Error(G(329))}}}return qt(t,Ze()),t.callbackNode===n?Ky.bind(null,t):null}function od(t,e){var n=co;return t.current.memoizedState.isDehydrated&&(as(t,e).flags|=256),t=Rl(t,e),t!==2&&(e=Bt,Bt=n,e!==null&&ad(e)),t}function ad(t){Bt===null?Bt=t:Bt.push.apply(Bt,t)}function g1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Cn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wr(t,e){for(e&=~vh,e&=~Jl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-In(e),r=1<<n;t[n]=-1,e&=~r}}function Hp(t){if(Se&6)throw Error(G(327));ii();var e=dl(t,0);if(!(e&1))return qt(t,Ze()),null;var n=Rl(t,e);if(t.tag!==0&&n===2){var r=Dc(t);r!==0&&(e=r,n=od(t,r))}if(n===1)throw n=No,as(t,0),wr(t,e),qt(t,Ze()),n;if(n===6)throw Error(G(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ts(t,Bt,qn),qt(t,Ze()),null}function _h(t,e){var n=Se;Se|=1;try{return t(e)}finally{Se=n,Se===0&&(fi=Ze()+500,Ql&&Wr())}}function ps(t){Er!==null&&Er.tag===0&&!(Se&6)&&ii();var e=Se;Se|=1;var n=pn.transition,r=Ae;try{if(pn.transition=null,Ae=1,t)return t()}finally{Ae=r,pn.transition=n,Se=e,!(Se&6)&&Wr()}}function wh(){tn=Zs.current,Fe(Zs)}function as(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,q_(n)),tt!==null)for(n=tt.return;n!==null;){var r=n;switch(th(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&gl();break;case 3:di(),Fe(Wt),Fe(Pt),ch();break;case 5:uh(r);break;case 4:di();break;case 13:Fe(Ue);break;case 19:Fe(Ue);break;case 10:ih(r.type._context);break;case 22:case 23:wh()}n=n.return}if(ct=t,tt=t=Dr(t.current,null),mt=tn=e,ot=0,No=null,vh=Jl=fs=0,Bt=co=null,ss!==null){for(e=0;e<ss.length;e++)if(n=ss[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}ss=null}return t}function Yy(t,e){do{var n=tt;try{if(sh(),Ya.current=Il,Tl){for(var r=We.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Tl=!1}if(hs=0,ut=it=We=null,lo=!1,Po=0,yh.current=null,n===null||n.return===null){ot=1,No=e,tt=null;break}e:{var i=t,a=n.return,l=n,u=e;if(e=mt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var h=u,p=l,g=p.tag;if(!(p.mode&1)&&(g===0||g===11||g===15)){var y=p.alternate;y?(p.updateQueue=y.updateQueue,p.memoizedState=y.memoizedState,p.lanes=y.lanes):(p.updateQueue=null,p.memoizedState=null)}var T=Dp(a);if(T!==null){T.flags&=-257,Np(T,a,l,i,e),T.mode&1&&bp(i,h,e),e=T,u=h;var C=e.updateQueue;if(C===null){var b=new Set;b.add(u),e.updateQueue=b}else C.add(u);break e}else{if(!(e&1)){bp(i,h,e),Sh();break e}u=Error(G(426))}}else if(ze&&l.mode&1){var O=Dp(a);if(O!==null){!(O.flags&65536)&&(O.flags|=256),Np(O,a,l,i,e),nh(hi(u,l));break e}}i=u=hi(u,l),ot!==4&&(ot=2),co===null?co=[i]:co.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var A=Ny(i,u,e);Ip(i,A);break e;case 1:l=u;var S=i.type,R=i.stateNode;if(!(i.flags&128)&&(typeof S.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(Pr===null||!Pr.has(R)))){i.flags|=65536,e&=-e,i.lanes|=e;var M=jy(i,l,e);Ip(i,M);break e}}i=i.return}while(i!==null)}Zy(n)}catch(B){e=B,tt===n&&n!==null&&(tt=n=n.return);continue}break}while(!0)}function Xy(){var t=Al.current;return Al.current=Il,t===null?Il:t}function Sh(){(ot===0||ot===3||ot===2)&&(ot=4),ct===null||!(fs&268435455)&&!(Jl&268435455)||wr(ct,mt)}function Rl(t,e){var n=Se;Se|=2;var r=Xy();(ct!==t||mt!==e)&&(qn=null,as(t,e));do try{y1();break}catch(s){Yy(t,s)}while(!0);if(sh(),Se=n,Al.current=r,tt!==null)throw Error(G(261));return ct=null,mt=0,ot}function y1(){for(;tt!==null;)Jy(tt)}function v1(){for(;tt!==null&&!$x();)Jy(tt)}function Jy(t){var e=t0(t.alternate,t,tn);t.memoizedProps=t.pendingProps,e===null?Zy(t):tt=e,yh.current=null}function Zy(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=d1(n,e),n!==null){n.flags&=32767,tt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ot=6,tt=null;return}}else if(n=c1(n,e,tn),n!==null){tt=n;return}if(e=e.sibling,e!==null){tt=e;return}tt=e=t}while(e!==null);ot===0&&(ot=5)}function ts(t,e,n){var r=Ae,s=pn.transition;try{pn.transition=null,Ae=1,x1(t,e,n,r)}finally{pn.transition=s,Ae=r}return null}function x1(t,e,n,r){do ii();while(Er!==null);if(Se&6)throw Error(G(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(G(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Zx(t,i),t===ct&&(tt=ct=null,mt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Oa||(Oa=!0,n0(cl,function(){return ii(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=pn.transition,pn.transition=null;var a=Ae;Ae=1;var l=Se;Se|=4,yh.current=null,f1(t,n),Gy(n,t),F_(Oc),hl=!!Lc,Oc=Lc=null,t.current=n,p1(n),Wx(),Se=l,Ae=a,pn.transition=i}else t.current=n;if(Oa&&(Oa=!1,Er=t,kl=s),i=t.pendingLanes,i===0&&(Pr=null),Gx(n.stateNode),qt(t,Ze()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Cl)throw Cl=!1,t=sd,sd=null,t;return kl&1&&t.tag!==0&&ii(),i=t.pendingLanes,i&1?t===id?ho++:(ho=0,id=t):ho=0,Wr(),null}function ii(){if(Er!==null){var t=Ng(kl),e=pn.transition,n=Ae;try{if(pn.transition=null,Ae=16>t?16:t,Er===null)var r=!1;else{if(t=Er,Er=null,kl=0,Se&6)throw Error(G(331));var s=Se;for(Se|=4,re=t.current;re!==null;){var i=re,a=i.child;if(re.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var h=l[u];for(re=h;re!==null;){var p=re;switch(p.tag){case 0:case 11:case 15:uo(8,p,i)}var g=p.child;if(g!==null)g.return=p,re=g;else for(;re!==null;){p=re;var y=p.sibling,T=p.return;if(Wy(p),p===h){re=null;break}if(y!==null){y.return=T,re=y;break}re=T}}}var C=i.alternate;if(C!==null){var b=C.child;if(b!==null){C.child=null;do{var O=b.sibling;b.sibling=null,b=O}while(b!==null)}}re=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,re=a;else e:for(;re!==null;){if(i=re,i.flags&2048)switch(i.tag){case 0:case 11:case 15:uo(9,i,i.return)}var A=i.sibling;if(A!==null){A.return=i.return,re=A;break e}re=i.return}}var S=t.current;for(re=S;re!==null;){a=re;var R=a.child;if(a.subtreeFlags&2064&&R!==null)R.return=a,re=R;else e:for(a=S;re!==null;){if(l=re,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Xl(9,l)}}catch(B){Qe(l,l.return,B)}if(l===a){re=null;break e}var M=l.sibling;if(M!==null){M.return=l.return,re=M;break e}re=l.return}}if(Se=s,Wr(),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot($l,t)}catch{}r=!0}return r}finally{Ae=n,pn.transition=e}}return!1}function qp(t,e,n){e=hi(n,e),e=Ny(t,e,1),t=Rr(t,e,1),e=jt(),t!==null&&(Ho(t,1,e),qt(t,e))}function Qe(t,e,n){if(t.tag===3)qp(t,t,n);else for(;e!==null;){if(e.tag===3){qp(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Pr===null||!Pr.has(r))){t=hi(n,t),t=jy(e,t,1),e=Rr(e,t,1),t=jt(),e!==null&&(Ho(e,1,t),qt(e,t));break}}e=e.return}}function _1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=jt(),t.pingedLanes|=t.suspendedLanes&n,ct===t&&(mt&n)===n&&(ot===4||ot===3&&(mt&130023424)===mt&&500>Ze()-xh?as(t,0):vh|=n),qt(t,e)}function e0(t,e){e===0&&(t.mode&1?(e=ka,ka<<=1,!(ka&130023424)&&(ka=4194304)):e=1);var n=jt();t=rr(t,e),t!==null&&(Ho(t,e,n),qt(t,n))}function w1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),e0(t,n)}function S1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(G(314))}r!==null&&r.delete(e),e0(t,n)}var t0;t0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Wt.current)$t=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return $t=!1,u1(t,e,n);$t=!!(t.flags&131072)}else $t=!1,ze&&e.flags&1048576&&iy(e,xl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ja(t,e),t=e.pendingProps;var s=li(e,Pt.current);si(e,n),s=hh(null,e,r,t,s,n);var i=fh();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ht(r)?(i=!0,yl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ah(e),s.updater=Yl,e.stateNode=s,s._reactInternals=e,Gc(e,r,t,n),e=Yc(null,e,r,!0,i,n)):(e.tag=0,ze&&i&&eh(e),Dt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ja(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=T1(r),t=Sn(r,t),s){case 0:e=Kc(null,e,r,t,n);break e;case 1:e=Mp(null,e,r,t,n);break e;case 11:e=jp(null,e,r,t,n);break e;case 14:e=Vp(null,e,r,Sn(r.type,t),n);break e}throw Error(G(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Sn(r,s),Kc(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Sn(r,s),Mp(t,e,r,s,n);case 3:e:{if(Oy(e),t===null)throw Error(G(387));r=e.pendingProps,i=e.memoizedState,s=i.element,dy(t,e),Sl(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=hi(Error(G(423)),e),e=Lp(t,e,r,n,s);break e}else if(r!==s){s=hi(Error(G(424)),e),e=Lp(t,e,r,n,s);break e}else for(nn=kr(e.stateNode.containerInfo.firstChild),sn=e,ze=!0,Tn=null,n=uy(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ui(),r===s){e=sr(t,e,n);break e}Dt(t,e,r,n)}e=e.child}return e;case 5:return hy(e),t===null&&Wc(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Fc(r,s)?a=null:i!==null&&Fc(r,i)&&(e.flags|=32),Ly(t,e),Dt(t,e,a,n),e.child;case 6:return t===null&&Wc(e),null;case 13:return Fy(t,e,n);case 4:return lh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ci(e,null,r,n):Dt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Sn(r,s),jp(t,e,r,s,n);case 7:return Dt(t,e,e.pendingProps,n),e.child;case 8:return Dt(t,e,e.pendingProps.children,n),e.child;case 12:return Dt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,je(_l,r._currentValue),r._currentValue=a,i!==null)if(Cn(i.value,a)){if(i.children===s.children&&!Wt.current){e=sr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Jn(-1,n&-n),u.tag=2;var h=i.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?u.next=u:(u.next=p.next,p.next=u),h.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Hc(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(G(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Hc(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Dt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,si(e,n),s=gn(s),r=r(s),e.flags|=1,Dt(t,e,r,n),e.child;case 14:return r=e.type,s=Sn(r,e.pendingProps),s=Sn(r.type,s),Vp(t,e,r,s,n);case 15:return Vy(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Sn(r,s),Ja(t,e),e.tag=1,Ht(r)?(t=!0,yl(e)):t=!1,si(e,n),Dy(e,r,s),Gc(e,r,s,n),Yc(null,e,r,!0,t,n);case 19:return zy(t,e,n);case 22:return My(t,e,n)}throw Error(G(156,e.tag))};function n0(t,e){return Rg(t,e)}function E1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hn(t,e,n,r){return new E1(t,e,n,r)}function Eh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function T1(t){if(typeof t=="function")return Eh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ud)return 11;if(t===$d)return 14}return 2}function Dr(t,e){var n=t.alternate;return n===null?(n=hn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function tl(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")Eh(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case $s:return ls(n.children,s,i,e);case Bd:a=8,s|=8;break;case yc:return t=hn(12,n,e,s|2),t.elementType=yc,t.lanes=i,t;case vc:return t=hn(13,n,e,s),t.elementType=vc,t.lanes=i,t;case xc:return t=hn(19,n,e,s),t.elementType=xc,t.lanes=i,t;case hg:return Zl(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case cg:a=10;break e;case dg:a=9;break e;case Ud:a=11;break e;case $d:a=14;break e;case vr:a=16,r=null;break e}throw Error(G(130,t==null?t:typeof t,""))}return e=hn(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ls(t,e,n,r){return t=hn(7,t,r,e),t.lanes=n,t}function Zl(t,e,n,r){return t=hn(22,t,r,e),t.elementType=hg,t.lanes=n,t.stateNode={isHidden:!1},t}function Zu(t,e,n){return t=hn(6,t,null,e),t.lanes=n,t}function ec(t,e,n){return e=hn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function I1(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ju(0),this.expirationTimes=ju(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ju(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Th(t,e,n,r,s,i,a,l,u){return t=new I1(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=hn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(i),t}function A1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Us,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function r0(t){if(!t)return Or;t=t._reactInternals;e:{if(xs(t)!==t||t.tag!==1)throw Error(G(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ht(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(G(171))}if(t.tag===1){var n=t.type;if(Ht(n))return ry(t,n,e)}return e}function s0(t,e,n,r,s,i,a,l,u){return t=Th(n,r,!0,t,s,i,a,l,u),t.context=r0(null),n=t.current,r=jt(),s=br(n),i=Jn(r,s),i.callback=e??null,Rr(n,i,s),t.current.lanes=s,Ho(t,s,r),qt(t,r),t}function eu(t,e,n,r){var s=e.current,i=jt(),a=br(s);return n=r0(n),e.context===null?e.context=n:e.pendingContext=n,e=Jn(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Rr(s,e,a),t!==null&&(An(t,s,a,i),Ka(t,s,a)),a}function Pl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Gp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ih(t,e){Gp(t,e),(t=t.alternate)&&Gp(t,e)}function C1(){return null}var i0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ah(t){this._internalRoot=t}tu.prototype.render=Ah.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(G(409));eu(t,e,null,null)};tu.prototype.unmount=Ah.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ps(function(){eu(null,t,null,null)}),e[nr]=null}};function tu(t){this._internalRoot=t}tu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Mg();t={blockedOn:null,target:t,priority:e};for(var n=0;n<_r.length&&e!==0&&e<_r[n].priority;n++);_r.splice(n,0,t),n===0&&Og(t)}};function Ch(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function nu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Qp(){}function k1(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var h=Pl(a);i.call(h)}}var a=s0(e,r,t,0,null,!1,!1,"",Qp);return t._reactRootContainer=a,t[nr]=a.current,Io(t.nodeType===8?t.parentNode:t),ps(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var h=Pl(u);l.call(h)}}var u=Th(t,0,!1,null,null,!1,!1,"",Qp);return t._reactRootContainer=u,t[nr]=u.current,Io(t.nodeType===8?t.parentNode:t),ps(function(){eu(e,u,n,r)}),u}function ru(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var u=Pl(a);l.call(u)}}eu(e,a,t,s)}else a=k1(n,e,t,s,r);return Pl(a)}jg=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Yi(e.pendingLanes);n!==0&&(qd(e,n|1),qt(e,Ze()),!(Se&6)&&(fi=Ze()+500,Wr()))}break;case 13:ps(function(){var r=rr(t,1);if(r!==null){var s=jt();An(r,t,1,s)}}),Ih(t,1)}};Gd=function(t){if(t.tag===13){var e=rr(t,134217728);if(e!==null){var n=jt();An(e,t,134217728,n)}Ih(t,134217728)}};Vg=function(t){if(t.tag===13){var e=br(t),n=rr(t,e);if(n!==null){var r=jt();An(n,t,e,r)}Ih(t,e)}};Mg=function(){return Ae};Lg=function(t,e){var n=Ae;try{return Ae=t,e()}finally{Ae=n}};Rc=function(t,e,n){switch(e){case"input":if(Sc(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Gl(r);if(!s)throw Error(G(90));pg(r),Sc(r,s)}}}break;case"textarea":gg(t,n);break;case"select":e=n.value,e!=null&&ei(t,!!n.multiple,e,!1)}};Eg=_h;Tg=ps;var R1={usingClientEntryPoint:!1,Events:[Go,Gs,Gl,wg,Sg,_h]},qi={findFiberByHostInstance:rs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},P1={bundleType:qi.bundleType,version:qi.version,rendererPackageName:qi.rendererPackageName,rendererConfig:qi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Cg(t),t===null?null:t.stateNode},findFiberByHostInstance:qi.findFiberByHostInstance||C1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fa.isDisabled&&Fa.supportsFiber)try{$l=Fa.inject(P1),Ln=Fa}catch{}}an.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R1;an.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ch(e))throw Error(G(200));return A1(t,e,null,n)};an.createRoot=function(t,e){if(!Ch(t))throw Error(G(299));var n=!1,r="",s=i0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Th(t,1,!1,null,null,n,!1,r,s),t[nr]=e.current,Io(t.nodeType===8?t.parentNode:t),new Ah(e)};an.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(G(188)):(t=Object.keys(t).join(","),Error(G(268,t)));return t=Cg(e),t=t===null?null:t.stateNode,t};an.flushSync=function(t){return ps(t)};an.hydrate=function(t,e,n){if(!nu(e))throw Error(G(200));return ru(null,t,e,!0,n)};an.hydrateRoot=function(t,e,n){if(!Ch(t))throw Error(G(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=i0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=s0(e,null,t,1,n??null,s,!1,i,a),t[nr]=e.current,Io(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new tu(e)};an.render=function(t,e,n){if(!nu(e))throw Error(G(200));return ru(null,t,e,!1,n)};an.unmountComponentAtNode=function(t){if(!nu(t))throw Error(G(40));return t._reactRootContainer?(ps(function(){ru(null,null,t,!1,function(){t._reactRootContainer=null,t[nr]=null})}),!0):!1};an.unstable_batchedUpdates=_h;an.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!nu(n))throw Error(G(200));if(t==null||t._reactInternals===void 0)throw Error(G(38));return ru(t,e,n,!1,r)};an.version="18.3.1-next-f1338f8080-20240426";function o0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o0)}catch(t){console.error(t)}}o0(),og.exports=an;var b1=og.exports,a0,Kp=b1;a0=Kp.createRoot,Kp.hydrateRoot;var Yp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},D1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},u0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,u=s+2<t.length,h=u?t[s+2]:0,p=i>>2,g=(i&3)<<4|l>>4;let y=(l&15)<<2|h>>6,T=h&63;u||(T=64,a||(y=64)),r.push(n[p],n[g],n[y],n[T])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(l0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):D1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const g=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||h==null||g==null)throw new N1;const y=i<<2|l>>4;if(r.push(y),h!==64){const T=l<<4&240|h>>2;if(r.push(T),g!==64){const C=h<<6&192|g;r.push(C)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class N1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const j1=function(t){const e=l0(t);return u0.encodeByteArray(e,!0)},c0=function(t){return j1(t).replace(/\./g,"")},V1=function(t){try{return u0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1=()=>M1().__FIREBASE_DEFAULTS__,O1=()=>{if(typeof process>"u"||typeof Yp>"u")return;const t=Yp.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},F1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&V1(t[1]);return e&&JSON.parse(e)},kh=()=>{try{return L1()||O1()||F1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},z1=t=>{var e,n;return(n=(e=kh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},B1=t=>{const e=z1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},d0=()=>{var t;return(t=kh())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $1(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function W1(){var t;const e=(t=kh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function H1(){return!W1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function q1(){try{return typeof indexedDB=="object"}catch{return!1}}function G1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q1="FirebaseError";class Ti extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Q1,Object.setPrototypeOf(this,Ti.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,h0.prototype.create)}}class h0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?K1(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new Ti(s,l,r)}}function K1(t,e){return t.replace(Y1,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Y1=/\{\$([^}]+)}/g;function bl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(Xp(i)&&Xp(a)){if(!bl(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Xp(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kn(t){return t&&t._delegate?t._delegate:t}class pi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new U1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Z1(e))try{this.getOrInitializeService({instanceIdentifier:ns})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ns){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ns){return this.instances.has(e)}getOptions(e=ns){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:J1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ns){return this.component?this.component.multipleInstances?e:ns:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function J1(t){return t===ns?void 0:t}function Z1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new X1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var we;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(we||(we={}));const tw={debug:we.DEBUG,verbose:we.VERBOSE,info:we.INFO,warn:we.WARN,error:we.ERROR,silent:we.SILENT},nw=we.INFO,rw={[we.DEBUG]:"log",[we.VERBOSE]:"log",[we.INFO]:"info",[we.WARN]:"warn",[we.ERROR]:"error"},sw=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=rw[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class f0{constructor(e){this.name=e,this._logLevel=nw,this._logHandler=sw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in we))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?tw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,we.DEBUG,...e),this._logHandler(this,we.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,we.VERBOSE,...e),this._logHandler(this,we.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,we.INFO,...e),this._logHandler(this,we.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,we.WARN,...e),this._logHandler(this,we.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,we.ERROR,...e),this._logHandler(this,we.ERROR,...e)}}const iw=(t,e)=>e.some(n=>t instanceof n);let Jp,Zp;function ow(){return Jp||(Jp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function aw(){return Zp||(Zp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const p0=new WeakMap,ld=new WeakMap,m0=new WeakMap,tc=new WeakMap,Rh=new WeakMap;function lw(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Nr(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&p0.set(n,t)}).catch(()=>{}),Rh.set(e,t),e}function uw(t){if(ld.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});ld.set(t,e)}let ud={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ld.get(t);if(e==="objectStoreNames")return t.objectStoreNames||m0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Nr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function cw(t){ud=t(ud)}function dw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(nc(this),e,...n);return m0.set(r,e.sort?e.sort():[e]),Nr(r)}:aw().includes(t)?function(...e){return t.apply(nc(this),e),Nr(p0.get(this))}:function(...e){return Nr(t.apply(nc(this),e))}}function hw(t){return typeof t=="function"?dw(t):(t instanceof IDBTransaction&&uw(t),iw(t,ow())?new Proxy(t,ud):t)}function Nr(t){if(t instanceof IDBRequest)return lw(t);if(tc.has(t))return tc.get(t);const e=hw(t);return e!==t&&(tc.set(t,e),Rh.set(e,t)),e}const nc=t=>Rh.get(t);function fw(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=Nr(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Nr(a.result),u.oldVersion,u.newVersion,Nr(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const pw=["get","getKey","getAll","getAllKeys","count"],mw=["put","add","delete","clear"],rc=new Map;function em(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(rc.get(e))return rc.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=mw.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||pw.includes(n)))return;const i=async function(a,...l){const u=this.transaction(a,s?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[n](...l),s&&u.done]))[0]};return rc.set(e,i),i}cw(t=>({...t,get:(e,n,r)=>em(e,n)||t.get(e,n,r),has:(e,n)=>!!em(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(yw(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function yw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cd="@firebase/app",tm="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir=new f0("@firebase/app"),vw="@firebase/app-compat",xw="@firebase/analytics-compat",_w="@firebase/analytics",ww="@firebase/app-check-compat",Sw="@firebase/app-check",Ew="@firebase/auth",Tw="@firebase/auth-compat",Iw="@firebase/database",Aw="@firebase/data-connect",Cw="@firebase/database-compat",kw="@firebase/functions",Rw="@firebase/functions-compat",Pw="@firebase/installations",bw="@firebase/installations-compat",Dw="@firebase/messaging",Nw="@firebase/messaging-compat",jw="@firebase/performance",Vw="@firebase/performance-compat",Mw="@firebase/remote-config",Lw="@firebase/remote-config-compat",Ow="@firebase/storage",Fw="@firebase/storage-compat",zw="@firebase/firestore",Bw="@firebase/vertexai-preview",Uw="@firebase/firestore-compat",$w="firebase",Ww="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dd="[DEFAULT]",Hw={[cd]:"fire-core",[vw]:"fire-core-compat",[_w]:"fire-analytics",[xw]:"fire-analytics-compat",[Sw]:"fire-app-check",[ww]:"fire-app-check-compat",[Ew]:"fire-auth",[Tw]:"fire-auth-compat",[Iw]:"fire-rtdb",[Aw]:"fire-data-connect",[Cw]:"fire-rtdb-compat",[kw]:"fire-fn",[Rw]:"fire-fn-compat",[Pw]:"fire-iid",[bw]:"fire-iid-compat",[Dw]:"fire-fcm",[Nw]:"fire-fcm-compat",[jw]:"fire-perf",[Vw]:"fire-perf-compat",[Mw]:"fire-rc",[Lw]:"fire-rc-compat",[Ow]:"fire-gcs",[Fw]:"fire-gcs-compat",[zw]:"fire-fst",[Uw]:"fire-fst-compat",[Bw]:"fire-vertex","fire-js":"fire-js",[$w]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dl=new Map,qw=new Map,hd=new Map;function nm(t,e){try{t.container.addComponent(e)}catch(n){ir.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function jo(t){const e=t.name;if(hd.has(e))return ir.debug(`There were multiple attempts to register component ${e}.`),!1;hd.set(e,t);for(const n of Dl.values())nm(n,t);for(const n of qw.values())nm(n,t);return!0}function g0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},jr=new h0("app","Firebase",Gw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qw{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new pi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw jr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw=Ww;function y0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:dd,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw jr.create("bad-app-name",{appName:String(s)});if(n||(n=d0()),!n)throw jr.create("no-options");const i=Dl.get(s);if(i){if(bl(n,i.options)&&bl(r,i.config))return i;throw jr.create("duplicate-app",{appName:s})}const a=new ew(s);for(const u of hd.values())a.addComponent(u);const l=new Qw(n,r,a);return Dl.set(s,l),l}function Yw(t=dd){const e=Dl.get(t);if(!e&&t===dd&&d0())return y0();if(!e)throw jr.create("no-app",{appName:t});return e}function Vr(t,e,n){var r;let s=(r=Hw[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ir.warn(l.join(" "));return}jo(new pi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw="firebase-heartbeat-database",Jw=1,Vo="firebase-heartbeat-store";let sc=null;function v0(){return sc||(sc=fw(Xw,Jw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Vo)}catch(n){console.warn(n)}}}}).catch(t=>{throw jr.create("idb-open",{originalErrorMessage:t.message})})),sc}async function Zw(t){try{const n=(await v0()).transaction(Vo),r=await n.objectStore(Vo).get(x0(t));return await n.done,r}catch(e){if(e instanceof Ti)ir.warn(e.message);else{const n=jr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ir.warn(n.message)}}}async function rm(t,e){try{const r=(await v0()).transaction(Vo,"readwrite");await r.objectStore(Vo).put(e,x0(t)),await r.done}catch(n){if(n instanceof Ti)ir.warn(n.message);else{const r=jr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});ir.warn(r.message)}}}function x0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS=1024,tS=30*24*60*60*1e3;class nS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new sS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=sm();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=tS}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ir.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=sm(),{heartbeatsToSend:r,unsentEntries:s}=rS(this._heartbeatsCache.heartbeats),i=c0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return ir.warn(n),""}}}function sm(){return new Date().toISOString().substring(0,10)}function rS(t,e=eS){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),im(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),im(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class sS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return q1()?G1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Zw(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return rm(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return rm(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function im(t){return c0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t){jo(new pi("platform-logger",e=>new gw(e),"PRIVATE")),jo(new pi("heartbeat",e=>new nS(e),"PRIVATE")),Vr(cd,tm,t),Vr(cd,tm,"esm2017"),Vr("fire-js","")}iS("");var oS="firebase",aS="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vr(oS,aS,"app");var om=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var us,_0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,m){function _(){}_.prototype=m.prototype,w.D=m.prototype,w.prototype=new _,w.prototype.constructor=w,w.C=function(E,k,P){for(var I=Array(arguments.length-2),H=2;H<arguments.length;H++)I[H-2]=arguments[H];return m.prototype[k].apply(E,I)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,m,_){_||(_=0);var E=Array(16);if(typeof m=="string")for(var k=0;16>k;++k)E[k]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(k=0;16>k;++k)E[k]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=w.g[0],_=w.g[1],k=w.g[2];var P=w.g[3],I=m+(P^_&(k^P))+E[0]+3614090360&4294967295;m=_+(I<<7&4294967295|I>>>25),I=P+(k^m&(_^k))+E[1]+3905402710&4294967295,P=m+(I<<12&4294967295|I>>>20),I=k+(_^P&(m^_))+E[2]+606105819&4294967295,k=P+(I<<17&4294967295|I>>>15),I=_+(m^k&(P^m))+E[3]+3250441966&4294967295,_=k+(I<<22&4294967295|I>>>10),I=m+(P^_&(k^P))+E[4]+4118548399&4294967295,m=_+(I<<7&4294967295|I>>>25),I=P+(k^m&(_^k))+E[5]+1200080426&4294967295,P=m+(I<<12&4294967295|I>>>20),I=k+(_^P&(m^_))+E[6]+2821735955&4294967295,k=P+(I<<17&4294967295|I>>>15),I=_+(m^k&(P^m))+E[7]+4249261313&4294967295,_=k+(I<<22&4294967295|I>>>10),I=m+(P^_&(k^P))+E[8]+1770035416&4294967295,m=_+(I<<7&4294967295|I>>>25),I=P+(k^m&(_^k))+E[9]+2336552879&4294967295,P=m+(I<<12&4294967295|I>>>20),I=k+(_^P&(m^_))+E[10]+4294925233&4294967295,k=P+(I<<17&4294967295|I>>>15),I=_+(m^k&(P^m))+E[11]+2304563134&4294967295,_=k+(I<<22&4294967295|I>>>10),I=m+(P^_&(k^P))+E[12]+1804603682&4294967295,m=_+(I<<7&4294967295|I>>>25),I=P+(k^m&(_^k))+E[13]+4254626195&4294967295,P=m+(I<<12&4294967295|I>>>20),I=k+(_^P&(m^_))+E[14]+2792965006&4294967295,k=P+(I<<17&4294967295|I>>>15),I=_+(m^k&(P^m))+E[15]+1236535329&4294967295,_=k+(I<<22&4294967295|I>>>10),I=m+(k^P&(_^k))+E[1]+4129170786&4294967295,m=_+(I<<5&4294967295|I>>>27),I=P+(_^k&(m^_))+E[6]+3225465664&4294967295,P=m+(I<<9&4294967295|I>>>23),I=k+(m^_&(P^m))+E[11]+643717713&4294967295,k=P+(I<<14&4294967295|I>>>18),I=_+(P^m&(k^P))+E[0]+3921069994&4294967295,_=k+(I<<20&4294967295|I>>>12),I=m+(k^P&(_^k))+E[5]+3593408605&4294967295,m=_+(I<<5&4294967295|I>>>27),I=P+(_^k&(m^_))+E[10]+38016083&4294967295,P=m+(I<<9&4294967295|I>>>23),I=k+(m^_&(P^m))+E[15]+3634488961&4294967295,k=P+(I<<14&4294967295|I>>>18),I=_+(P^m&(k^P))+E[4]+3889429448&4294967295,_=k+(I<<20&4294967295|I>>>12),I=m+(k^P&(_^k))+E[9]+568446438&4294967295,m=_+(I<<5&4294967295|I>>>27),I=P+(_^k&(m^_))+E[14]+3275163606&4294967295,P=m+(I<<9&4294967295|I>>>23),I=k+(m^_&(P^m))+E[3]+4107603335&4294967295,k=P+(I<<14&4294967295|I>>>18),I=_+(P^m&(k^P))+E[8]+1163531501&4294967295,_=k+(I<<20&4294967295|I>>>12),I=m+(k^P&(_^k))+E[13]+2850285829&4294967295,m=_+(I<<5&4294967295|I>>>27),I=P+(_^k&(m^_))+E[2]+4243563512&4294967295,P=m+(I<<9&4294967295|I>>>23),I=k+(m^_&(P^m))+E[7]+1735328473&4294967295,k=P+(I<<14&4294967295|I>>>18),I=_+(P^m&(k^P))+E[12]+2368359562&4294967295,_=k+(I<<20&4294967295|I>>>12),I=m+(_^k^P)+E[5]+4294588738&4294967295,m=_+(I<<4&4294967295|I>>>28),I=P+(m^_^k)+E[8]+2272392833&4294967295,P=m+(I<<11&4294967295|I>>>21),I=k+(P^m^_)+E[11]+1839030562&4294967295,k=P+(I<<16&4294967295|I>>>16),I=_+(k^P^m)+E[14]+4259657740&4294967295,_=k+(I<<23&4294967295|I>>>9),I=m+(_^k^P)+E[1]+2763975236&4294967295,m=_+(I<<4&4294967295|I>>>28),I=P+(m^_^k)+E[4]+1272893353&4294967295,P=m+(I<<11&4294967295|I>>>21),I=k+(P^m^_)+E[7]+4139469664&4294967295,k=P+(I<<16&4294967295|I>>>16),I=_+(k^P^m)+E[10]+3200236656&4294967295,_=k+(I<<23&4294967295|I>>>9),I=m+(_^k^P)+E[13]+681279174&4294967295,m=_+(I<<4&4294967295|I>>>28),I=P+(m^_^k)+E[0]+3936430074&4294967295,P=m+(I<<11&4294967295|I>>>21),I=k+(P^m^_)+E[3]+3572445317&4294967295,k=P+(I<<16&4294967295|I>>>16),I=_+(k^P^m)+E[6]+76029189&4294967295,_=k+(I<<23&4294967295|I>>>9),I=m+(_^k^P)+E[9]+3654602809&4294967295,m=_+(I<<4&4294967295|I>>>28),I=P+(m^_^k)+E[12]+3873151461&4294967295,P=m+(I<<11&4294967295|I>>>21),I=k+(P^m^_)+E[15]+530742520&4294967295,k=P+(I<<16&4294967295|I>>>16),I=_+(k^P^m)+E[2]+3299628645&4294967295,_=k+(I<<23&4294967295|I>>>9),I=m+(k^(_|~P))+E[0]+4096336452&4294967295,m=_+(I<<6&4294967295|I>>>26),I=P+(_^(m|~k))+E[7]+1126891415&4294967295,P=m+(I<<10&4294967295|I>>>22),I=k+(m^(P|~_))+E[14]+2878612391&4294967295,k=P+(I<<15&4294967295|I>>>17),I=_+(P^(k|~m))+E[5]+4237533241&4294967295,_=k+(I<<21&4294967295|I>>>11),I=m+(k^(_|~P))+E[12]+1700485571&4294967295,m=_+(I<<6&4294967295|I>>>26),I=P+(_^(m|~k))+E[3]+2399980690&4294967295,P=m+(I<<10&4294967295|I>>>22),I=k+(m^(P|~_))+E[10]+4293915773&4294967295,k=P+(I<<15&4294967295|I>>>17),I=_+(P^(k|~m))+E[1]+2240044497&4294967295,_=k+(I<<21&4294967295|I>>>11),I=m+(k^(_|~P))+E[8]+1873313359&4294967295,m=_+(I<<6&4294967295|I>>>26),I=P+(_^(m|~k))+E[15]+4264355552&4294967295,P=m+(I<<10&4294967295|I>>>22),I=k+(m^(P|~_))+E[6]+2734768916&4294967295,k=P+(I<<15&4294967295|I>>>17),I=_+(P^(k|~m))+E[13]+1309151649&4294967295,_=k+(I<<21&4294967295|I>>>11),I=m+(k^(_|~P))+E[4]+4149444226&4294967295,m=_+(I<<6&4294967295|I>>>26),I=P+(_^(m|~k))+E[11]+3174756917&4294967295,P=m+(I<<10&4294967295|I>>>22),I=k+(m^(P|~_))+E[2]+718787259&4294967295,k=P+(I<<15&4294967295|I>>>17),I=_+(P^(k|~m))+E[9]+3951481745&4294967295,w.g[0]=w.g[0]+m&4294967295,w.g[1]=w.g[1]+(k+(I<<21&4294967295|I>>>11))&4294967295,w.g[2]=w.g[2]+k&4294967295,w.g[3]=w.g[3]+P&4294967295}r.prototype.u=function(w,m){m===void 0&&(m=w.length);for(var _=m-this.blockSize,E=this.B,k=this.h,P=0;P<m;){if(k==0)for(;P<=_;)s(this,w,P),P+=this.blockSize;if(typeof w=="string"){for(;P<m;)if(E[k++]=w.charCodeAt(P++),k==this.blockSize){s(this,E),k=0;break}}else for(;P<m;)if(E[k++]=w[P++],k==this.blockSize){s(this,E),k=0;break}}this.h=k,this.o+=m},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var m=1;m<w.length-8;++m)w[m]=0;var _=8*this.o;for(m=w.length-8;m<w.length;++m)w[m]=_&255,_/=256;for(this.u(w),w=Array(16),m=_=0;4>m;++m)for(var E=0;32>E;E+=8)w[_++]=this.g[m]>>>E&255;return w};function i(w,m){var _=l;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=m(w)}function a(w,m){this.h=m;for(var _=[],E=!0,k=w.length-1;0<=k;k--){var P=w[k]|0;E&&P==m||(_[k]=P,E=!1)}this.g=_}var l={};function u(w){return-128<=w&&128>w?i(w,function(m){return new a([m|0],0>m?-1:0)}):new a([w|0],0>w?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return g;if(0>w)return O(h(-w));for(var m=[],_=1,E=0;w>=_;E++)m[E]=w/_|0,_*=4294967296;return new a(m,0)}function p(w,m){if(w.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(w.charAt(0)=="-")return O(p(w.substring(1),m));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=h(Math.pow(m,8)),E=g,k=0;k<w.length;k+=8){var P=Math.min(8,w.length-k),I=parseInt(w.substring(k,k+P),m);8>P?(P=h(Math.pow(m,P)),E=E.j(P).add(h(I))):(E=E.j(_),E=E.add(h(I)))}return E}var g=u(0),y=u(1),T=u(16777216);t=a.prototype,t.m=function(){if(b(this))return-O(this).m();for(var w=0,m=1,_=0;_<this.g.length;_++){var E=this.i(_);w+=(0<=E?E:4294967296+E)*m,m*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(C(this))return"0";if(b(this))return"-"+O(this).toString(w);for(var m=h(Math.pow(w,6)),_=this,E="";;){var k=M(_,m).g;_=A(_,k.j(m));var P=((0<_.g.length?_.g[0]:_.h)>>>0).toString(w);if(_=k,C(_))return P+E;for(;6>P.length;)P="0"+P;E=P+E}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function C(w){if(w.h!=0)return!1;for(var m=0;m<w.g.length;m++)if(w.g[m]!=0)return!1;return!0}function b(w){return w.h==-1}t.l=function(w){return w=A(this,w),b(w)?-1:C(w)?0:1};function O(w){for(var m=w.g.length,_=[],E=0;E<m;E++)_[E]=~w.g[E];return new a(_,~w.h).add(y)}t.abs=function(){return b(this)?O(this):this},t.add=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],E=0,k=0;k<=m;k++){var P=E+(this.i(k)&65535)+(w.i(k)&65535),I=(P>>>16)+(this.i(k)>>>16)+(w.i(k)>>>16);E=I>>>16,P&=65535,I&=65535,_[k]=I<<16|P}return new a(_,_[_.length-1]&-2147483648?-1:0)};function A(w,m){return w.add(O(m))}t.j=function(w){if(C(this)||C(w))return g;if(b(this))return b(w)?O(this).j(O(w)):O(O(this).j(w));if(b(w))return O(this.j(O(w)));if(0>this.l(T)&&0>w.l(T))return h(this.m()*w.m());for(var m=this.g.length+w.g.length,_=[],E=0;E<2*m;E++)_[E]=0;for(E=0;E<this.g.length;E++)for(var k=0;k<w.g.length;k++){var P=this.i(E)>>>16,I=this.i(E)&65535,H=w.i(k)>>>16,Q=w.i(k)&65535;_[2*E+2*k]+=I*Q,S(_,2*E+2*k),_[2*E+2*k+1]+=P*Q,S(_,2*E+2*k+1),_[2*E+2*k+1]+=I*H,S(_,2*E+2*k+1),_[2*E+2*k+2]+=P*H,S(_,2*E+2*k+2)}for(E=0;E<m;E++)_[E]=_[2*E+1]<<16|_[2*E];for(E=m;E<2*m;E++)_[E]=0;return new a(_,0)};function S(w,m){for(;(w[m]&65535)!=w[m];)w[m+1]+=w[m]>>>16,w[m]&=65535,m++}function R(w,m){this.g=w,this.h=m}function M(w,m){if(C(m))throw Error("division by zero");if(C(w))return new R(g,g);if(b(w))return m=M(O(w),m),new R(O(m.g),O(m.h));if(b(m))return m=M(w,O(m)),new R(O(m.g),m.h);if(30<w.g.length){if(b(w)||b(m))throw Error("slowDivide_ only works with positive integers.");for(var _=y,E=m;0>=E.l(w);)_=B(_),E=B(E);var k=L(_,1),P=L(E,1);for(E=L(E,2),_=L(_,2);!C(E);){var I=P.add(E);0>=I.l(w)&&(k=k.add(_),P=I),E=L(E,1),_=L(_,1)}return m=A(w,k.j(m)),new R(k,m)}for(k=g;0<=w.l(m);){for(_=Math.max(1,Math.floor(w.m()/m.m())),E=Math.ceil(Math.log(_)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),P=h(_),I=P.j(m);b(I)||0<I.l(w);)_-=E,P=h(_),I=P.j(m);C(P)&&(P=y),k=k.add(P),w=A(w,I)}return new R(k,w)}t.A=function(w){return M(this,w).h},t.and=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],E=0;E<m;E++)_[E]=this.i(E)&w.i(E);return new a(_,this.h&w.h)},t.or=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],E=0;E<m;E++)_[E]=this.i(E)|w.i(E);return new a(_,this.h|w.h)},t.xor=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],E=0;E<m;E++)_[E]=this.i(E)^w.i(E);return new a(_,this.h^w.h)};function B(w){for(var m=w.g.length+1,_=[],E=0;E<m;E++)_[E]=w.i(E)<<1|w.i(E-1)>>>31;return new a(_,w.h)}function L(w,m){var _=m>>5;m%=32;for(var E=w.g.length-_,k=[],P=0;P<E;P++)k[P]=0<m?w.i(P+_)>>>m|w.i(P+_+1)<<32-m:w.i(P+_);return new a(k,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,_0=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,us=a}).apply(typeof om<"u"?om:typeof self<"u"?self:typeof window<"u"?window:{});var za=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var w0,Ji,S0,nl,fd,E0,T0,I0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,d,f){return o==Array.prototype||o==Object.prototype||(o[d]=f.value),o};function n(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof za=="object"&&za];for(var d=0;d<o.length;++d){var f=o[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(o,d){if(d)e:{var f=r;o=o.split(".");for(var v=0;v<o.length-1;v++){var D=o[v];if(!(D in f))break e;f=f[D]}o=o[o.length-1],v=f[o],d=d(v),d!=v&&d!=null&&e(f,o,{configurable:!0,writable:!0,value:d})}}function i(o,d){o instanceof String&&(o+="");var f=0,v=!1,D={next:function(){if(!v&&f<o.length){var V=f++;return{value:d(V,o[V]),done:!1}}return v=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}s("Array.prototype.values",function(o){return o||function(){return i(this,function(d,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function u(o){var d=typeof o;return d=d!="object"?d:o?Array.isArray(o)?"array":d:"null",d=="array"||d=="object"&&typeof o.length=="number"}function h(o){var d=typeof o;return d=="object"&&o!=null||d=="function"}function p(o,d,f){return o.call.apply(o.bind,arguments)}function g(o,d,f){if(!o)throw Error();if(2<arguments.length){var v=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,v),o.apply(d,D)}}return function(){return o.apply(d,arguments)}}function y(o,d,f){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,y.apply(null,arguments)}function T(o,d){var f=Array.prototype.slice.call(arguments,1);return function(){var v=f.slice();return v.push.apply(v,arguments),o.apply(this,v)}}function C(o,d){function f(){}f.prototype=d.prototype,o.aa=d.prototype,o.prototype=new f,o.prototype.constructor=o,o.Qb=function(v,D,V){for(var X=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)X[Pe-2]=arguments[Pe];return d.prototype[D].apply(v,X)}}function b(o){const d=o.length;if(0<d){const f=Array(d);for(let v=0;v<d;v++)f[v]=o[v];return f}return[]}function O(o,d){for(let f=1;f<arguments.length;f++){const v=arguments[f];if(u(v)){const D=o.length||0,V=v.length||0;o.length=D+V;for(let X=0;X<V;X++)o[D+X]=v[X]}else o.push(v)}}class A{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function S(o){return/^[\s\xa0]*$/.test(o)}function R(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function M(o){return M[" "](o),o}M[" "]=function(){};var B=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function L(o,d,f){for(const v in o)d.call(f,o[v],v,o)}function w(o,d){for(const f in o)d.call(void 0,o[f],f,o)}function m(o){const d={};for(const f in o)d[f]=o[f];return d}const _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(o,d){let f,v;for(let D=1;D<arguments.length;D++){v=arguments[D];for(f in v)o[f]=v[f];for(let V=0;V<_.length;V++)f=_[V],Object.prototype.hasOwnProperty.call(v,f)&&(o[f]=v[f])}}function k(o){var d=1;o=o.split(":");const f=[];for(;0<d&&o.length;)f.push(o.shift()),d--;return o.length&&f.push(o.join(":")),f}function P(o){l.setTimeout(()=>{throw o},0)}function I(){var o=N;let d=null;return o.g&&(d=o.g,o.g=o.g.next,o.g||(o.h=null),d.next=null),d}class H{constructor(){this.h=this.g=null}add(d,f){const v=Q.get();v.set(d,f),this.h?this.h.next=v:this.g=v,this.h=v}}var Q=new A(()=>new K,o=>o.reset());class K{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let F,x=!1,N=new H,U=()=>{const o=l.Promise.resolve(void 0);F=()=>{o.then(J)}};var J=()=>{for(var o;o=I();){try{o.h.call(o.g)}catch(f){P(f)}var d=Q;d.j(o),100>d.h&&(d.h++,o.next=d.g,d.g=o)}x=!1};function ee(){this.s=this.s,this.C=this.C}ee.prototype.s=!1,ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function le(o,d){this.type=o,this.g=this.target=d,this.defaultPrevented=!1}le.prototype.h=function(){this.defaultPrevented=!0};var me=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,d=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const f=()=>{};l.addEventListener("test",f,d),l.removeEventListener("test",f,d)}catch{}return o}();function fe(o,d){if(le.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var f=this.type=o.type,v=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=d,d=o.relatedTarget){if(B){e:{try{M(d.nodeName);var D=!0;break e}catch{}D=!1}D||(d=null)}}else f=="mouseover"?d=o.fromElement:f=="mouseout"&&(d=o.toElement);this.relatedTarget=d,v?(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:pe[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&fe.aa.h.call(this)}}C(fe,le);var pe={2:"touch",3:"pen",4:"mouse"};fe.prototype.h=function(){fe.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Z="closure_listenable_"+(1e6*Math.random()|0),oe=0;function ve(o,d,f,v,D){this.listener=o,this.proxy=null,this.src=d,this.type=f,this.capture=!!v,this.ha=D,this.key=++oe,this.da=this.fa=!1}function ne(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function be(o){this.src=o,this.g={},this.h=0}be.prototype.add=function(o,d,f,v,D){var V=o.toString();o=this.g[V],o||(o=this.g[V]=[],this.h++);var X=De(o,d,v,D);return-1<X?(d=o[X],f||(d.fa=!1)):(d=new ve(d,this.src,V,!!v,D),d.fa=f,o.push(d)),d};function Be(o,d){var f=d.type;if(f in o.g){var v=o.g[f],D=Array.prototype.indexOf.call(v,d,void 0),V;(V=0<=D)&&Array.prototype.splice.call(v,D,1),V&&(ne(d),o.g[f].length==0&&(delete o.g[f],o.h--))}}function De(o,d,f,v){for(var D=0;D<o.length;++D){var V=o[D];if(!V.da&&V.listener==d&&V.capture==!!f&&V.ha==v)return D}return-1}var xt="closure_lm_"+(1e6*Math.random()|0),Gt={};function Qt(o,d,f,v,D){if(Array.isArray(d)){for(var V=0;V<d.length;V++)Qt(o,d[V],f,v,D);return null}return f=ra(f),o&&o[Z]?o.K(d,f,h(v)?!!v.capture:!1,D):Kt(o,d,f,!1,v,D)}function Kt(o,d,f,v,D,V){if(!d)throw Error("Invalid event type");var X=h(D)?!!D.capture:!!D,Pe=Ne(o);if(Pe||(o[xt]=Pe=new be(o)),f=Pe.add(d,f,v,X,V),f.proxy)return f;if(v=Yt(),f.proxy=v,v.src=o,v.listener=f,o.addEventListener)me||(D=X),D===void 0&&(D=!1),o.addEventListener(d.toString(),v,D);else if(o.attachEvent)o.attachEvent(Pn(d.toString()),v);else if(o.addListener&&o.removeListener)o.addListener(v);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Yt(){function o(f){return d.call(o.src,o.listener,f)}const d=dr;return o}function ur(o,d,f,v,D){if(Array.isArray(d))for(var V=0;V<d.length;V++)ur(o,d[V],f,v,D);else v=h(v)?!!v.capture:!!v,f=ra(f),o&&o[Z]?(o=o.i,d=String(d).toString(),d in o.g&&(V=o.g[d],f=De(V,f,v,D),-1<f&&(ne(V[f]),Array.prototype.splice.call(V,f,1),V.length==0&&(delete o.g[d],o.h--)))):o&&(o=Ne(o))&&(d=o.g[d.toString()],o=-1,d&&(o=De(d,f,v,D)),(f=-1<o?d[o]:null)&&cr(f))}function cr(o){if(typeof o!="number"&&o&&!o.da){var d=o.src;if(d&&d[Z])Be(d.i,o);else{var f=o.type,v=o.proxy;d.removeEventListener?d.removeEventListener(f,v,o.capture):d.detachEvent?d.detachEvent(Pn(f),v):d.addListener&&d.removeListener&&d.removeListener(v),(f=Ne(d))?(Be(f,o),f.h==0&&(f.src=null,d[xt]=null)):ne(o)}}}function Pn(o){return o in Gt?Gt[o]:Gt[o]="on"+o}function dr(o,d){if(o.da)o=!0;else{d=new fe(d,this);var f=o.listener,v=o.ha||o.src;o.fa&&cr(o),o=f.call(v,d)}return o}function Ne(o){return o=o[xt],o instanceof be?o:null}var Ri="__closure_events_fn_"+(1e9*Math.random()>>>0);function ra(o){return typeof o=="function"?o:(o[Ri]||(o[Ri]=function(d){return o.handleEvent(d)}),o[Ri])}function rt(){ee.call(this),this.i=new be(this),this.M=this,this.F=null}C(rt,ee),rt.prototype[Z]=!0,rt.prototype.removeEventListener=function(o,d,f,v){ur(this,o,d,f,v)};function Ke(o,d){var f,v=o.F;if(v)for(f=[];v;v=v.F)f.push(v);if(o=o.M,v=d.type||d,typeof d=="string")d=new le(d,o);else if(d instanceof le)d.target=d.target||o;else{var D=d;d=new le(v,o),E(d,D)}if(D=!0,f)for(var V=f.length-1;0<=V;V--){var X=d.g=f[V];D=hr(X,v,!0,d)&&D}if(X=d.g=o,D=hr(X,v,!0,d)&&D,D=hr(X,v,!1,d)&&D,f)for(V=0;V<f.length;V++)X=d.g=f[V],D=hr(X,v,!1,d)&&D}rt.prototype.N=function(){if(rt.aa.N.call(this),this.i){var o=this.i,d;for(d in o.g){for(var f=o.g[d],v=0;v<f.length;v++)ne(f[v]);delete o.g[d],o.h--}}this.F=null},rt.prototype.K=function(o,d,f,v){return this.i.add(String(o),d,!1,f,v)},rt.prototype.L=function(o,d,f,v){return this.i.add(String(o),d,!0,f,v)};function hr(o,d,f,v){if(d=o.i.g[String(d)],!d)return!0;d=d.concat();for(var D=!0,V=0;V<d.length;++V){var X=d[V];if(X&&!X.da&&X.capture==f){var Pe=X.listener,dt=X.ha||X.src;X.fa&&Be(o.i,X),D=Pe.call(dt,v)!==!1&&D}}return D&&!v.defaultPrevented}function Es(o,d,f){if(typeof o=="function")f&&(o=y(o,f));else if(o&&typeof o.handleEvent=="function")o=y(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:l.setTimeout(o,d||0)}function sa(o){o.g=Es(()=>{o.g=null,o.i&&(o.i=!1,sa(o))},o.l);const d=o.h;o.h=null,o.m.apply(null,d)}class Ie extends ee{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:sa(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vn(o){ee.call(this),this.h=o,this.g={}}C(vn,ee);var qr=[];function Ts(o){L(o.g,function(d,f){this.g.hasOwnProperty(f)&&cr(d)},o),o.g={}}vn.prototype.N=function(){vn.aa.N.call(this),Ts(this)},vn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ia=l.JSON.stringify,oa=l.JSON.parse,pf=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function Is(){}Is.prototype.h=null;function _t(o){return o.h||(o.h=o.i())}function aa(){}var Xt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Gr(){le.call(this,"d")}C(Gr,le);function bn(){le.call(this,"c")}C(bn,le);var Dn={},_u=null;function As(){return _u=_u||new rt}Dn.La="serverreachability";function wu(o){le.call(this,Dn.La,o)}C(wu,le);function Cs(o){const d=As();Ke(d,new wu(d))}Dn.STAT_EVENT="statevent";function ks(o,d){le.call(this,Dn.STAT_EVENT,o),this.stat=d}C(ks,le);function Ye(o){const d=As();Ke(d,new ks(d,o))}Dn.Ma="timingevent";function Rs(o,d){le.call(this,Dn.Ma,o),this.size=d}C(Rs,le);function fr(o,d){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},d)}function Qr(){this.g=!0}Qr.prototype.xa=function(){this.g=!1};function Su(o,d,f,v,D,V){o.info(function(){if(o.g)if(V)for(var X="",Pe=V.split("&"),dt=0;dt<Pe.length;dt++){var Ee=Pe[dt].split("=");if(1<Ee.length){var St=Ee[0];Ee=Ee[1];var Et=St.split("_");X=2<=Et.length&&Et[1]=="type"?X+(St+"="+Ee+"&"):X+(St+"=redacted&")}}else X=null;else X=V;return"XMLHTTP REQ ("+v+") [attempt "+D+"]: "+d+`
`+f+`
`+X})}function Kr(o,d,f,v,D,V,X){o.info(function(){return"XMLHTTP RESP ("+v+") [ attempt "+D+"]: "+d+`
`+f+`
`+V+" "+X})}function Jt(o,d,f,v){o.info(function(){return"XMLHTTP TEXT ("+d+"): "+la(o,f)+(v?" "+v:"")})}function Eu(o,d){o.info(function(){return"TIMEOUT: "+d})}Qr.prototype.info=function(){};function la(o,d){if(!o.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(o=0;o<f.length;o++)if(Array.isArray(f[o])){var v=f[o];if(!(2>v.length)){var D=v[1];if(Array.isArray(D)&&!(1>D.length)){var V=D[0];if(V!="noop"&&V!="stop"&&V!="close")for(var X=1;X<D.length;X++)D[X]=""}}}}return ia(f)}catch{return d}}var Yr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pi={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},bi;function Ps(){}C(Ps,Is),Ps.prototype.g=function(){return new XMLHttpRequest},Ps.prototype.i=function(){return{}},bi=new Ps;function un(o,d,f,v){this.j=o,this.i=d,this.l=f,this.R=v||1,this.U=new vn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new bs}function bs(){this.i=null,this.g="",this.h=!1}var Nn={},pr={};function xn(o,d,f){o.L=1,o.v=pa($n(d)),o.m=f,o.P=!0,ua(o,null)}function ua(o,d){o.F=Date.now(),q(o),o.A=$n(o.v);var f=o.A,v=o.R;Array.isArray(v)||(v=[String(v)]),xf(f.i,"t",v),o.C=0,f=o.j.J,o.h=new bs,o.g=Lf(o.j,f?d:null,!o.m),0<o.O&&(o.M=new Ie(y(o.Y,o,o.g),o.O)),d=o.U,f=o.g,v=o.ca;var D="readystatechange";Array.isArray(D)||(D&&(qr[0]=D.toString()),D=qr);for(var V=0;V<D.length;V++){var X=Qt(f,D[V],v||d.handleEvent,!1,d.h||d);if(!X)break;d.g[X.key]=X}d=o.H?m(o.H):{},o.m?(o.u||(o.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,d)):(o.u="GET",o.g.ea(o.A,o.u,null,d)),Cs(),Su(o.i,o.u,o.A,o.l,o.R,o.m)}un.prototype.ca=function(o){o=o.target;const d=this.M;d&&Wn(o)==3?d.j():this.Y(o)},un.prototype.Y=function(o){try{if(o==this.g)e:{const Et=Wn(this.g);var d=this.g.Ba();const Ms=this.g.Z();if(!(3>Et)&&(Et!=3||this.g&&(this.h.h||this.g.oa()||Af(this.g)))){this.J||Et!=4||d==7||(d==8||0>=Ms?Cs(3):Cs(2)),ge(this);var f=this.g.Z();this.X=f;t:if(Y(this)){var v=Af(this.g);o="";var D=v.length,V=Wn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Re(this),ke(this);var X="";break t}this.h.i=new l.TextDecoder}for(d=0;d<D;d++)this.h.h=!0,o+=this.h.i.decode(v[d],{stream:!(V&&d==D-1)});v.length=0,this.h.g+=o,this.C=0,X=this.h.g}else X=this.g.oa();if(this.o=f==200,Kr(this.i,this.u,this.A,this.l,this.R,Et,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Pe,dt=this.g;if((Pe=dt.g?dt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(Pe)){var Ee=Pe;break t}}Ee=null}if(f=Ee)Jt(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,st(this,f);else{this.o=!1,this.s=3,Ye(12),Re(this),ke(this);break e}}if(this.P){f=!0;let _n;for(;!this.J&&this.C<X.length;)if(_n=W(this,X),_n==pr){Et==4&&(this.s=4,Ye(14),f=!1),Jt(this.i,this.l,null,"[Incomplete Response]");break}else if(_n==Nn){this.s=4,Ye(15),Jt(this.i,this.l,X,"[Invalid Chunk]"),f=!1;break}else Jt(this.i,this.l,_n,null),st(this,_n);if(Y(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Et!=4||X.length!=0||this.h.h||(this.s=1,Ye(16),f=!1),this.o=this.o&&f,!f)Jt(this.i,this.l,X,"[Invalid Chunked Response]"),Re(this),ke(this);else if(0<X.length&&!this.W){this.W=!0;var St=this.j;St.g==this&&St.ba&&!St.M&&(St.j.info("Great, no buffering proxy detected. Bytes received: "+X.length),Cu(St),St.M=!0,Ye(11))}}else Jt(this.i,this.l,X,null),st(this,X);Et==4&&Re(this),this.o&&!this.J&&(Et==4?Nf(this.j,this):(this.o=!1,q(this)))}else sx(this.g),f==400&&0<X.indexOf("Unknown SID")?(this.s=3,Ye(12)):(this.s=0,Ye(13)),Re(this),ke(this)}}}catch{}finally{}};function Y(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function W(o,d){var f=o.C,v=d.indexOf(`
`,f);return v==-1?pr:(f=Number(d.substring(f,v)),isNaN(f)?Nn:(v+=1,v+f>d.length?pr:(d=d.slice(v,v+f),o.C=v+f,d)))}un.prototype.cancel=function(){this.J=!0,Re(this)};function q(o){o.S=Date.now()+o.I,se(o,o.I)}function se(o,d){if(o.B!=null)throw Error("WatchDog timer not null");o.B=fr(y(o.ba,o),d)}function ge(o){o.B&&(l.clearTimeout(o.B),o.B=null)}un.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(Eu(this.i,this.A),this.L!=2&&(Cs(),Ye(17)),Re(this),this.s=2,ke(this)):se(this,this.S-o)};function ke(o){o.j.G==0||o.J||Nf(o.j,o)}function Re(o){ge(o);var d=o.M;d&&typeof d.ma=="function"&&d.ma(),o.M=null,Ts(o.U),o.g&&(d=o.g,o.g=null,d.abort(),d.ma())}function st(o,d){try{var f=o.j;if(f.G!=0&&(f.g==o||Xr(f.h,o))){if(!o.K&&Xr(f.h,o)&&f.G==3){try{var v=f.Da.g.parse(d)}catch{v=null}if(Array.isArray(v)&&v.length==3){var D=v;if(D[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<o.F)_a(f),va(f);else break e;Au(f),Ye(18)}}else f.za=D[1],0<f.za-f.T&&37500>D[2]&&f.F&&f.v==0&&!f.C&&(f.C=fr(y(f.Za,f),6e3));if(1>=ca(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Zr(f,11)}else if((o.K||f.g==o)&&_a(f),!S(d))for(D=f.Da.g.parse(d),d=0;d<D.length;d++){let Ee=D[d];if(f.T=Ee[0],Ee=Ee[1],f.G==2)if(Ee[0]=="c"){f.K=Ee[1],f.ia=Ee[2];const St=Ee[3];St!=null&&(f.la=St,f.j.info("VER="+f.la));const Et=Ee[4];Et!=null&&(f.Aa=Et,f.j.info("SVER="+f.Aa));const Ms=Ee[5];Ms!=null&&typeof Ms=="number"&&0<Ms&&(v=1.5*Ms,f.L=v,f.j.info("backChannelRequestTimeoutMs_="+v)),v=f;const _n=o.g;if(_n){const Sa=_n.g?_n.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Sa){var V=v.h;V.g||Sa.indexOf("spdy")==-1&&Sa.indexOf("quic")==-1&&Sa.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(Ft(V,V.h),V.h=null))}if(v.D){const ku=_n.g?_n.g.getResponseHeader("X-HTTP-Session-Id"):null;ku&&(v.ya=ku,Ve(v.I,v.D,ku))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-o.F,f.j.info("Handshake RTT: "+f.R+"ms")),v=f;var X=o;if(v.qa=Mf(v,v.J?v.ia:null,v.W),X.K){Ds(v.h,X);var Pe=X,dt=v.L;dt&&(Pe.I=dt),Pe.B&&(ge(Pe),q(Pe)),v.g=X}else bf(v);0<f.i.length&&xa(f)}else Ee[0]!="stop"&&Ee[0]!="close"||Zr(f,7);else f.G==3&&(Ee[0]=="stop"||Ee[0]=="close"?Ee[0]=="stop"?Zr(f,7):Iu(f):Ee[0]!="noop"&&f.l&&f.l.ta(Ee),f.v=0)}}Cs(4)}catch{}}var wt=class{constructor(o,d){this.g=o,this.map=d}};function bt(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ot(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function ca(o){return o.h?1:o.g?o.g.size:0}function Xr(o,d){return o.h?o.h==d:o.g?o.g.has(d):!1}function Ft(o,d){o.g?o.g.add(d):o.h=d}function Ds(o,d){o.h&&o.h==d?o.h=null:o.g&&o.g.has(d)&&o.g.delete(d)}bt.prototype.cancel=function(){if(this.i=ue(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function ue(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let d=o.i;for(const f of o.g.values())d=d.concat(f.D);return d}return b(o.i)}function Xe(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var d=[],f=o.length,v=0;v<f;v++)d.push(o[v]);return d}d=[],f=0;for(v in o)d[f++]=o[v];return d}function Zt(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var d=[];o=o.length;for(var f=0;f<o;f++)d.push(f);return d}d=[],f=0;for(const v in o)d[f++]=v;return d}}}function Ns(o,d){if(o.forEach&&typeof o.forEach=="function")o.forEach(d,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,d,void 0);else for(var f=Zt(o),v=Xe(o),D=v.length,V=0;V<D;V++)d.call(void 0,v[V],f&&f[V],o)}var da=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Hv(o,d){if(o){o=o.split("&");for(var f=0;f<o.length;f++){var v=o[f].indexOf("="),D=null;if(0<=v){var V=o[f].substring(0,v);D=o[f].substring(v+1)}else V=o[f];d(V,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function Jr(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Jr){this.h=o.h,ha(this,o.j),this.o=o.o,this.g=o.g,fa(this,o.s),this.l=o.l;var d=o.i,f=new ji;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),mf(this,f),this.m=o.m}else o&&(d=String(o).match(da))?(this.h=!1,ha(this,d[1]||"",!0),this.o=Di(d[2]||""),this.g=Di(d[3]||"",!0),fa(this,d[4]),this.l=Di(d[5]||"",!0),mf(this,d[6]||"",!0),this.m=Di(d[7]||"")):(this.h=!1,this.i=new ji(null,this.h))}Jr.prototype.toString=function(){var o=[],d=this.j;d&&o.push(Ni(d,gf,!0),":");var f=this.g;return(f||d=="file")&&(o.push("//"),(d=this.o)&&o.push(Ni(d,gf,!0),"@"),o.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&o.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&o.push("/"),o.push(Ni(f,f.charAt(0)=="/"?Qv:Gv,!0))),(f=this.i.toString())&&o.push("?",f),(f=this.m)&&o.push("#",Ni(f,Yv)),o.join("")};function $n(o){return new Jr(o)}function ha(o,d,f){o.j=f?Di(d,!0):d,o.j&&(o.j=o.j.replace(/:$/,""))}function fa(o,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);o.s=d}else o.s=null}function mf(o,d,f){d instanceof ji?(o.i=d,Xv(o.i,o.h)):(f||(d=Ni(d,Kv)),o.i=new ji(d,o.h))}function Ve(o,d,f){o.i.set(d,f)}function pa(o){return Ve(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Di(o,d){return o?d?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Ni(o,d,f){return typeof o=="string"?(o=encodeURI(o).replace(d,qv),f&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function qv(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var gf=/[#\/\?@]/g,Gv=/[#\?:]/g,Qv=/[#\?]/g,Kv=/[#\?@]/g,Yv=/#/g;function ji(o,d){this.h=this.g=null,this.i=o||null,this.j=!!d}function mr(o){o.g||(o.g=new Map,o.h=0,o.i&&Hv(o.i,function(d,f){o.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}t=ji.prototype,t.add=function(o,d){mr(this),this.i=null,o=js(this,o);var f=this.g.get(o);return f||this.g.set(o,f=[]),f.push(d),this.h+=1,this};function yf(o,d){mr(o),d=js(o,d),o.g.has(d)&&(o.i=null,o.h-=o.g.get(d).length,o.g.delete(d))}function vf(o,d){return mr(o),d=js(o,d),o.g.has(d)}t.forEach=function(o,d){mr(this),this.g.forEach(function(f,v){f.forEach(function(D){o.call(d,D,v,this)},this)},this)},t.na=function(){mr(this);const o=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let v=0;v<d.length;v++){const D=o[v];for(let V=0;V<D.length;V++)f.push(d[v])}return f},t.V=function(o){mr(this);let d=[];if(typeof o=="string")vf(this,o)&&(d=d.concat(this.g.get(js(this,o))));else{o=Array.from(this.g.values());for(let f=0;f<o.length;f++)d=d.concat(o[f])}return d},t.set=function(o,d){return mr(this),this.i=null,o=js(this,o),vf(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[d]),this.h+=1,this},t.get=function(o,d){return o?(o=this.V(o),0<o.length?String(o[0]):d):d};function xf(o,d,f){yf(o,d),0<f.length&&(o.i=null,o.g.set(js(o,d),b(f)),o.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var v=d[f];const V=encodeURIComponent(String(v)),X=this.V(v);for(v=0;v<X.length;v++){var D=V;X[v]!==""&&(D+="="+encodeURIComponent(String(X[v]))),o.push(D)}}return this.i=o.join("&")};function js(o,d){return d=String(d),o.j&&(d=d.toLowerCase()),d}function Xv(o,d){d&&!o.j&&(mr(o),o.i=null,o.g.forEach(function(f,v){var D=v.toLowerCase();v!=D&&(yf(this,v),xf(this,D,f))},o)),o.j=d}function Jv(o,d){const f=new Qr;if(l.Image){const v=new Image;v.onload=T(gr,f,"TestLoadImage: loaded",!0,d,v),v.onerror=T(gr,f,"TestLoadImage: error",!1,d,v),v.onabort=T(gr,f,"TestLoadImage: abort",!1,d,v),v.ontimeout=T(gr,f,"TestLoadImage: timeout",!1,d,v),l.setTimeout(function(){v.ontimeout&&v.ontimeout()},1e4),v.src=o}else d(!1)}function Zv(o,d){const f=new Qr,v=new AbortController,D=setTimeout(()=>{v.abort(),gr(f,"TestPingServer: timeout",!1,d)},1e4);fetch(o,{signal:v.signal}).then(V=>{clearTimeout(D),V.ok?gr(f,"TestPingServer: ok",!0,d):gr(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(D),gr(f,"TestPingServer: error",!1,d)})}function gr(o,d,f,v,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),v(f)}catch{}}function ex(){this.g=new pf}function tx(o,d,f){const v=f||"";try{Ns(o,function(D,V){let X=D;h(D)&&(X=ia(D)),d.push(v+V+"="+encodeURIComponent(X))})}catch(D){throw d.push(v+"type="+encodeURIComponent("_badmap")),D}}function ma(o){this.l=o.Ub||null,this.j=o.eb||!1}C(ma,Is),ma.prototype.g=function(){return new ga(this.l,this.j)},ma.prototype.i=function(o){return function(){return o}}({});function ga(o,d){rt.call(this),this.D=o,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(ga,rt),t=ga.prototype,t.open=function(o,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=d,this.readyState=1,Mi(this)},t.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(d.body=o),(this.D||l).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vi(this)),this.readyState=0},t.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Mi(this)),this.g&&(this.readyState=3,Mi(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;_f(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function _f(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}t.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var d=o.value?o.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!o.done}))&&(this.response=this.responseText+=d)}o.done?Vi(this):Mi(this),this.readyState==3&&_f(this)}},t.Ra=function(o){this.g&&(this.response=this.responseText=o,Vi(this))},t.Qa=function(o){this.g&&(this.response=o,Vi(this))},t.ga=function(){this.g&&Vi(this)};function Vi(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Mi(o)}t.setRequestHeader=function(o,d){this.u.append(o,d)},t.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,o.push(f[0]+": "+f[1]),f=d.next();return o.join(`\r
`)};function Mi(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(ga.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function wf(o){let d="";return L(o,function(f,v){d+=v,d+=":",d+=f,d+=`\r
`}),d}function Tu(o,d,f){e:{for(v in f){var v=!1;break e}v=!0}v||(f=wf(f),typeof o=="string"?f!=null&&encodeURIComponent(String(f)):Ve(o,d,f))}function Ge(o){rt.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(Ge,rt);var nx=/^https?$/i,rx=["POST","PUT"];t=Ge.prototype,t.Ha=function(o){this.J=o},t.ea=function(o,d,f,v){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);d=d?d.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():bi.g(),this.v=this.o?_t(this.o):_t(bi),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(d,String(o),!0),this.B=!1}catch(V){Sf(this,V);return}if(o=f||"",f=new Map(this.headers),v)if(Object.getPrototypeOf(v)===Object.prototype)for(var D in v)f.set(D,v[D]);else if(typeof v.keys=="function"&&typeof v.get=="function")for(const V of v.keys())f.set(V,v.get(V));else throw Error("Unknown input type for opt_headers: "+String(v));v=Array.from(f.keys()).find(V=>V.toLowerCase()=="content-type"),D=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(rx,d,void 0))||v||D||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,X]of f)this.g.setRequestHeader(V,X);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{If(this),this.u=!0,this.g.send(o),this.u=!1}catch(V){Sf(this,V)}};function Sf(o,d){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=d,o.m=5,Ef(o),ya(o)}function Ef(o){o.A||(o.A=!0,Ke(o,"complete"),Ke(o,"error"))}t.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Ke(this,"complete"),Ke(this,"abort"),ya(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ya(this,!0)),Ge.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Tf(this):this.bb())},t.bb=function(){Tf(this)};function Tf(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Wn(o)!=4||o.Z()!=2)){if(o.u&&Wn(o)==4)Es(o.Ea,0,o);else if(Ke(o,"readystatechange"),Wn(o)==4){o.h=!1;try{const X=o.Z();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var v;if(v=X===0){var D=String(o.D).match(da)[1]||null;!D&&l.self&&l.self.location&&(D=l.self.location.protocol.slice(0,-1)),v=!nx.test(D?D.toLowerCase():"")}f=v}if(f)Ke(o,"complete"),Ke(o,"success");else{o.m=6;try{var V=2<Wn(o)?o.g.statusText:""}catch{V=""}o.l=V+" ["+o.Z()+"]",Ef(o)}}finally{ya(o)}}}}function ya(o,d){if(o.g){If(o);const f=o.g,v=o.v[0]?()=>{}:null;o.g=null,o.v=null,d||Ke(o,"ready");try{f.onreadystatechange=v}catch{}}}function If(o){o.I&&(l.clearTimeout(o.I),o.I=null)}t.isActive=function(){return!!this.g};function Wn(o){return o.g?o.g.readyState:0}t.Z=function(){try{return 2<Wn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(o){if(this.g){var d=this.g.responseText;return o&&d.indexOf(o)==0&&(d=d.substring(o.length)),oa(d)}};function Af(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function sx(o){const d={};o=(o.g&&2<=Wn(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let v=0;v<o.length;v++){if(S(o[v]))continue;var f=k(o[v]);const D=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const V=d[D]||[];d[D]=V,V.push(f)}w(d,function(v){return v.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Li(o,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[o]||d}function Cf(o){this.Aa=0,this.i=[],this.j=new Qr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Li("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Li("baseRetryDelayMs",5e3,o),this.cb=Li("retryDelaySeedMs",1e4,o),this.Wa=Li("forwardChannelMaxRetries",2,o),this.wa=Li("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new bt(o&&o.concurrentRequestLimit),this.Da=new ex,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Cf.prototype,t.la=8,t.G=1,t.connect=function(o,d,f,v){Ye(0),this.W=o,this.H=d||{},f&&v!==void 0&&(this.H.OSID=f,this.H.OAID=v),this.F=this.X,this.I=Mf(this,null,this.W),xa(this)};function Iu(o){if(kf(o),o.G==3){var d=o.U++,f=$n(o.I);if(Ve(f,"SID",o.K),Ve(f,"RID",d),Ve(f,"TYPE","terminate"),Oi(o,f),d=new un(o,o.j,d),d.L=2,d.v=pa($n(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=d.v,f=!0),f||(d.g=Lf(d.j,null),d.g.ea(d.v)),d.F=Date.now(),q(d)}Vf(o)}function va(o){o.g&&(Cu(o),o.g.cancel(),o.g=null)}function kf(o){va(o),o.u&&(l.clearTimeout(o.u),o.u=null),_a(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function xa(o){if(!Ot(o.h)&&!o.s){o.s=!0;var d=o.Ga;F||U(),x||(F(),x=!0),N.add(d,o),o.B=0}}function ix(o,d){return ca(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=d.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=fr(y(o.Ga,o,d),jf(o,o.B)),o.B++,!0)}t.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const D=new un(this,this.j,o);let V=this.o;if(this.S&&(V?(V=m(V),E(V,this.S)):V=this.S),this.m!==null||this.O||(D.H=V,V=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var v=this.i[f];if("__data__"in v.map&&(v=v.map.__data__,typeof v=="string")){v=v.length;break t}v=void 0}if(v===void 0)break;if(d+=v,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=Pf(this,D,d),f=$n(this.I),Ve(f,"RID",o),Ve(f,"CVER",22),this.D&&Ve(f,"X-HTTP-Session-Id",this.D),Oi(this,f),V&&(this.O?d="headers="+encodeURIComponent(String(wf(V)))+"&"+d:this.m&&Tu(f,this.m,V)),Ft(this.h,D),this.Ua&&Ve(f,"TYPE","init"),this.P?(Ve(f,"$req",d),Ve(f,"SID","null"),D.T=!0,xn(D,f,null)):xn(D,f,d),this.G=2}}else this.G==3&&(o?Rf(this,o):this.i.length==0||Ot(this.h)||Rf(this))};function Rf(o,d){var f;d?f=d.l:f=o.U++;const v=$n(o.I);Ve(v,"SID",o.K),Ve(v,"RID",f),Ve(v,"AID",o.T),Oi(o,v),o.m&&o.o&&Tu(v,o.m,o.o),f=new un(o,o.j,f,o.B+1),o.m===null&&(f.H=o.o),d&&(o.i=d.D.concat(o.i)),d=Pf(o,f,1e3),f.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),Ft(o.h,f),xn(f,v,d)}function Oi(o,d){o.H&&L(o.H,function(f,v){Ve(d,v,f)}),o.l&&Ns({},function(f,v){Ve(d,v,f)})}function Pf(o,d,f){f=Math.min(o.i.length,f);var v=o.l?y(o.l.Na,o.l,o):null;e:{var D=o.i;let V=-1;for(;;){const X=["count="+f];V==-1?0<f?(V=D[0].g,X.push("ofs="+V)):V=0:X.push("ofs="+V);let Pe=!0;for(let dt=0;dt<f;dt++){let Ee=D[dt].g;const St=D[dt].map;if(Ee-=V,0>Ee)V=Math.max(0,D[dt].g-100),Pe=!1;else try{tx(St,X,"req"+Ee+"_")}catch{v&&v(St)}}if(Pe){v=X.join("&");break e}}}return o=o.i.splice(0,f),d.D=o,v}function bf(o){if(!o.g&&!o.u){o.Y=1;var d=o.Fa;F||U(),x||(F(),x=!0),N.add(d,o),o.v=0}}function Au(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=fr(y(o.Fa,o),jf(o,o.v)),o.v++,!0)}t.Fa=function(){if(this.u=null,Df(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=fr(y(this.ab,this),o)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ye(10),va(this),Df(this))};function Cu(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function Df(o){o.g=new un(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var d=$n(o.qa);Ve(d,"RID","rpc"),Ve(d,"SID",o.K),Ve(d,"AID",o.T),Ve(d,"CI",o.F?"0":"1"),!o.F&&o.ja&&Ve(d,"TO",o.ja),Ve(d,"TYPE","xmlhttp"),Oi(o,d),o.m&&o.o&&Tu(d,o.m,o.o),o.L&&(o.g.I=o.L);var f=o.g;o=o.ia,f.L=1,f.v=pa($n(d)),f.m=null,f.P=!0,ua(f,o)}t.Za=function(){this.C!=null&&(this.C=null,va(this),Au(this),Ye(19))};function _a(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function Nf(o,d){var f=null;if(o.g==d){_a(o),Cu(o),o.g=null;var v=2}else if(Xr(o.h,d))f=d.D,Ds(o.h,d),v=1;else return;if(o.G!=0){if(d.o)if(v==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var D=o.B;v=As(),Ke(v,new Rs(v,f)),xa(o)}else bf(o);else if(D=d.s,D==3||D==0&&0<d.X||!(v==1&&ix(o,d)||v==2&&Au(o)))switch(f&&0<f.length&&(d=o.h,d.i=d.i.concat(f)),D){case 1:Zr(o,5);break;case 4:Zr(o,10);break;case 3:Zr(o,6);break;default:Zr(o,2)}}}function jf(o,d){let f=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(f*=2),f*d}function Zr(o,d){if(o.j.info("Error code "+d),d==2){var f=y(o.fb,o),v=o.Xa;const D=!v;v=new Jr(v||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ha(v,"https"),pa(v),D?Jv(v.toString(),f):Zv(v.toString(),f)}else Ye(2);o.G=0,o.l&&o.l.sa(d),Vf(o),kf(o)}t.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Ye(2)):(this.j.info("Failed to ping google.com"),Ye(1))};function Vf(o){if(o.G=0,o.ka=[],o.l){const d=ue(o.h);(d.length!=0||o.i.length!=0)&&(O(o.ka,d),O(o.ka,o.i),o.h.i.length=0,b(o.i),o.i.length=0),o.l.ra()}}function Mf(o,d,f){var v=f instanceof Jr?$n(f):new Jr(f);if(v.g!="")d&&(v.g=d+"."+v.g),fa(v,v.s);else{var D=l.location;v=D.protocol,d=d?d+"."+D.hostname:D.hostname,D=+D.port;var V=new Jr(null);v&&ha(V,v),d&&(V.g=d),D&&fa(V,D),f&&(V.l=f),v=V}return f=o.D,d=o.ya,f&&d&&Ve(v,f,d),Ve(v,"VER",o.la),Oi(o,v),v}function Lf(o,d,f){if(d&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=o.Ca&&!o.pa?new Ge(new ma({eb:f})):new Ge(o.pa),d.Ha(o.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Of(){}t=Of.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function wa(){}wa.prototype.g=function(o,d){return new en(o,d)};function en(o,d){rt.call(this),this.g=new Cf(d),this.l=o,this.h=d&&d.messageUrlParams||null,o=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(o?o["X-WebChannel-Content-Type"]=d.messageContentType:o={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(o?o["X-WebChannel-Client-Profile"]=d.va:o={"X-WebChannel-Client-Profile":d.va}),this.g.S=o,(o=d&&d.Sb)&&!S(o)&&(this.g.m=o),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!S(d)&&(this.g.D=d,o=this.h,o!==null&&d in o&&(o=this.h,d in o&&delete o[d])),this.j=new Vs(this)}C(en,rt),en.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},en.prototype.close=function(){Iu(this.g)},en.prototype.o=function(o){var d=this.g;if(typeof o=="string"){var f={};f.__data__=o,o=f}else this.u&&(f={},f.__data__=ia(o),o=f);d.i.push(new wt(d.Ya++,o)),d.G==3&&xa(d)},en.prototype.N=function(){this.g.l=null,delete this.j,Iu(this.g),delete this.g,en.aa.N.call(this)};function Ff(o){Gr.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var d=o.__sm__;if(d){e:{for(const f in d){o=f;break e}o=void 0}(this.i=o)&&(o=this.i,d=d!==null&&o in d?d[o]:void 0),this.data=d}else this.data=o}C(Ff,Gr);function zf(){bn.call(this),this.status=1}C(zf,bn);function Vs(o){this.g=o}C(Vs,Of),Vs.prototype.ua=function(){Ke(this.g,"a")},Vs.prototype.ta=function(o){Ke(this.g,new Ff(o))},Vs.prototype.sa=function(o){Ke(this.g,new zf)},Vs.prototype.ra=function(){Ke(this.g,"b")},wa.prototype.createWebChannel=wa.prototype.g,en.prototype.send=en.prototype.o,en.prototype.open=en.prototype.m,en.prototype.close=en.prototype.close,I0=function(){return new wa},T0=function(){return As()},E0=Dn,fd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Yr.NO_ERROR=0,Yr.TIMEOUT=8,Yr.HTTP_ERROR=6,nl=Yr,Pi.COMPLETE="complete",S0=Pi,aa.EventType=Xt,Xt.OPEN="a",Xt.CLOSE="b",Xt.ERROR="c",Xt.MESSAGE="d",rt.prototype.listen=rt.prototype.K,Ji=aa,Ge.prototype.listenOnce=Ge.prototype.L,Ge.prototype.getLastError=Ge.prototype.Ka,Ge.prototype.getLastErrorCode=Ge.prototype.Ba,Ge.prototype.getStatus=Ge.prototype.Z,Ge.prototype.getResponseJson=Ge.prototype.Oa,Ge.prototype.getResponseText=Ge.prototype.oa,Ge.prototype.send=Ge.prototype.ea,Ge.prototype.setWithCredentials=Ge.prototype.Ha,w0=Ge}).apply(typeof za<"u"?za:typeof self<"u"?self:typeof window<"u"?window:{});const am="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}zt.UNAUTHENTICATED=new zt(null),zt.GOOGLE_CREDENTIALS=new zt("google-credentials-uid"),zt.FIRST_PARTY=new zt("first-party-uid"),zt.MOCK_USER=new zt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ii="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms=new f0("@firebase/firestore");function Gi(){return ms.logLevel}function ie(t,...e){if(ms.logLevel<=we.DEBUG){const n=e.map(Ph);ms.debug(`Firestore (${Ii}): ${t}`,...n)}}function or(t,...e){if(ms.logLevel<=we.ERROR){const n=e.map(Ph);ms.error(`Firestore (${Ii}): ${t}`,...n)}}function Mo(t,...e){if(ms.logLevel<=we.WARN){const n=e.map(Ph);ms.warn(`Firestore (${Ii}): ${t}`,...n)}}function Ph(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ce(t="Unexpected state"){const e=`FIRESTORE (${Ii}) INTERNAL ASSERTION FAILED: `+t;throw or(e),new Error(e)}function Ce(t,e){t||ce()}function he(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends Ti{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class uS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(zt.UNAUTHENTICATED))}shutdown(){}}class cS{constructor(e){this.t=e,this.currentUser=zt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ce(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Zn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Zn,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Zn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ce(typeof r.accessToken=="string"),new lS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ce(e===null||typeof e=="string"),new zt(e)}}class dS{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=zt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class hS{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new dS(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(zt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class fS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pS{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Ce(this.o===void 0);const r=i=>{i.error!=null&&ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,ie("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ce(typeof n.token=="string"),this.R=n.token,new fS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=mS(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Te(t,e){return t<e?-1:t>e?1:0}function mi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new te(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new te(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new te(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return at.fromMillis(Date.now())}static fromDate(e){return at.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new at(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{constructor(e){this.timestamp=e}static fromTimestamp(e){return new de(e)}static min(){return new de(new at(0,0))}static max(){return new de(new at(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,n,r){n===void 0?n=0:n>e.length&&ce(),r===void 0?r=e.length-n:r>e.length-n&&ce(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Lo.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Lo?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Oe extends Lo{construct(e,n,r){return new Oe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new te(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Oe(n)}static emptyPath(){return new Oe([])}}const gS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pt extends Lo{construct(e,n,r){return new pt(e,n,r)}static isValidIdentifier(e){return gS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new pt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new te(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new te(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new te(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new te(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pt(n)}static emptyPath(){return new pt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae(Oe.fromString(e))}static fromName(e){return new ae(Oe.fromString(e).popFirst(5))}static empty(){return new ae(Oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Oe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new Oe(e.slice()))}}function yS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=de.fromTimestamp(r===1e9?new at(n+1,0):new at(n,r));return new Fr(s,ae.empty(),e)}function vS(t){return new Fr(t.readTime,t.key,-1)}class Fr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Fr(de.min(),ae.empty(),-1)}static max(){return new Fr(de.max(),ae.empty(),-1)}}function xS(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ae.comparator(t.documentKey,e.documentKey),n!==0?n:Te(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ko(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==_S)throw t;ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ce(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new $((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof $?n:$.resolve(n)}catch(n){return $.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):$.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):$.reject(n)}static resolve(e){return new $((n,r)=>{n(e)})}static reject(e){return new $((n,r)=>{r(e)})}static waitFor(e){return new $((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(e){let n=$.resolve(!1);for(const r of e)n=n.next(s=>s?$.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new $((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let u=0;u<i;u++){const h=u;n(e[h]).next(p=>{a[h]=p,++l,l===i&&r(a)},p=>s(p))}})}static doWhile(e,n){return new $((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function SS(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Yo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}bh.oe=-1;function su(t){return t==null}function Nl(t){return t===0&&1/t==-1/0}function ES(t){return typeof t=="number"&&Number.isInteger(t)&&!Nl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lm(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function _s(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function C0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e,n){this.comparator=e,this.root=n||ft.EMPTY}insert(e,n){return new qe(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ft.BLACK,null,null))}remove(e){return new qe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ft.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ba(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ba(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ba(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ba(this.root,e,this.comparator,!0)}}class Ba{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ft{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ft.RED,this.left=s??ft.EMPTY,this.right=i??ft.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ft(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ft.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ft.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ce();const e=this.left.check();if(e!==this.right.check())throw ce();return e+(this.isRed()?0:1)}}ft.EMPTY=null,ft.RED=!0,ft.BLACK=!1;ft.EMPTY=new class{constructor(){this.size=0}get key(){throw ce()}get value(){throw ce()}get color(){throw ce()}get left(){throw ce()}get right(){throw ce()}copy(e,n,r,s,i){return this}insert(e,n,r){return new ft(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e){this.comparator=e,this.data=new qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new um(this.data.getIterator())}getIteratorFrom(e){return new um(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof gt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new gt(this.comparator);return n.data=e,n}}class um{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.fields=e,e.sort(pt.comparator)}static empty(){return new rn([])}unionWith(e){let n=new gt(pt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new rn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return mi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new k0("Invalid base64 string: "+i):i}}(e);return new vt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new vt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vt.EMPTY_BYTE_STRING=new vt("");const TS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zr(t){if(Ce(!!t),typeof t=="string"){let e=0;const n=TS.exec(t);if(Ce(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Je(t.seconds),nanos:Je(t.nanos)}}function Je(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function gs(t){return typeof t=="string"?vt.fromBase64String(t):vt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Nh(t){const e=t.mapValue.fields.__previous_value__;return Dh(e)?Nh(e):e}function Oo(t){const e=zr(t.mapValue.fields.__local_write_time__.timestampValue);return new at(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{constructor(e,n,r,s,i,a,l,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h}}class Fo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Fo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Fo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua={mapValue:{}};function ys(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Dh(t)?4:CS(t)?9007199254740991:AS(t)?10:11:ce()}function Bn(t,e){if(t===e)return!0;const n=ys(t);if(n!==ys(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Oo(t).isEqual(Oo(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=zr(s.timestampValue),l=zr(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return gs(s.bytesValue).isEqual(gs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Je(s.geoPointValue.latitude)===Je(i.geoPointValue.latitude)&&Je(s.geoPointValue.longitude)===Je(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Je(s.integerValue)===Je(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Je(s.doubleValue),l=Je(i.doubleValue);return a===l?Nl(a)===Nl(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return mi(t.arrayValue.values||[],e.arrayValue.values||[],Bn);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},l=i.mapValue.fields||{};if(lm(a)!==lm(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!Bn(a[u],l[u])))return!1;return!0}(t,e);default:return ce()}}function zo(t,e){return(t.values||[]).find(n=>Bn(n,e))!==void 0}function gi(t,e){if(t===e)return 0;const n=ys(t),r=ys(e);if(n!==r)return Te(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Te(t.booleanValue,e.booleanValue);case 2:return function(i,a){const l=Je(i.integerValue||i.doubleValue),u=Je(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return cm(t.timestampValue,e.timestampValue);case 4:return cm(Oo(t),Oo(e));case 5:return Te(t.stringValue,e.stringValue);case 6:return function(i,a){const l=gs(i),u=gs(a);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),u=a.split("/");for(let h=0;h<l.length&&h<u.length;h++){const p=Te(l[h],u[h]);if(p!==0)return p}return Te(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const l=Te(Je(i.latitude),Je(a.latitude));return l!==0?l:Te(Je(i.longitude),Je(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return dm(t.arrayValue,e.arrayValue);case 10:return function(i,a){var l,u,h,p;const g=i.fields||{},y=a.fields||{},T=(l=g.value)===null||l===void 0?void 0:l.arrayValue,C=(u=y.value)===null||u===void 0?void 0:u.arrayValue,b=Te(((h=T==null?void 0:T.values)===null||h===void 0?void 0:h.length)||0,((p=C==null?void 0:C.values)===null||p===void 0?void 0:p.length)||0);return b!==0?b:dm(T,C)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Ua.mapValue&&a===Ua.mapValue)return 0;if(i===Ua.mapValue)return 1;if(a===Ua.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),h=a.fields||{},p=Object.keys(h);u.sort(),p.sort();for(let g=0;g<u.length&&g<p.length;++g){const y=Te(u[g],p[g]);if(y!==0)return y;const T=gi(l[u[g]],h[p[g]]);if(T!==0)return T}return Te(u.length,p.length)}(t.mapValue,e.mapValue);default:throw ce()}}function cm(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Te(t,e);const n=zr(t),r=zr(e),s=Te(n.seconds,r.seconds);return s!==0?s:Te(n.nanos,r.nanos)}function dm(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=gi(n[s],r[s]);if(i)return i}return Te(n.length,r.length)}function yi(t){return pd(t)}function pd(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=zr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return gs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ae.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=pd(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${pd(n.fields[a])}`;return s+"}"}(t.mapValue):ce()}function hm(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function md(t){return!!t&&"integerValue"in t}function jh(t){return!!t&&"arrayValue"in t}function fm(t){return!!t&&"nullValue"in t}function pm(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function rl(t){return!!t&&"mapValue"in t}function AS(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function fo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return _s(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=fo(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=fo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function CS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.value=e}static empty(){return new Ut({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!rl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=fo(n)}setAll(e){let n=pt.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=fo(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());rl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Bn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];rl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){_s(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Ut(fo(this.value))}}function R0(t){const e=[];return _s(t.fields,(n,r)=>{const s=new pt([n]);if(rl(r)){const i=R0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new rn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Rt(e,0,de.min(),de.min(),de.min(),Ut.empty(),0)}static newFoundDocument(e,n,r,s){return new Rt(e,1,n,de.min(),r,s,0)}static newNoDocument(e,n){return new Rt(e,2,n,de.min(),de.min(),Ut.empty(),0)}static newUnknownDocument(e,n){return new Rt(e,3,n,de.min(),de.min(),Ut.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(de.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ut.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=de.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Rt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(e,n){this.position=e,this.inclusive=n}}function mm(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=ae.comparator(ae.fromName(a.referenceValue),n.key):r=gi(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function gm(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Bn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,n="asc"){this.field=e,this.dir=n}}function kS(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{}class nt extends P0{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new PS(e,n,r):n==="array-contains"?new NS(e,r):n==="in"?new jS(e,r):n==="not-in"?new VS(e,r):n==="array-contains-any"?new MS(e,r):new nt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new bS(e,r):new DS(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(gi(n,this.value)):n!==null&&ys(this.value)===ys(n)&&this.matchesComparison(gi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ce()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Rn extends P0{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Rn(e,n)}matches(e){return b0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function b0(t){return t.op==="and"}function D0(t){return RS(t)&&b0(t)}function RS(t){for(const e of t.filters)if(e instanceof Rn)return!1;return!0}function gd(t){if(t instanceof nt)return t.field.canonicalString()+t.op.toString()+yi(t.value);if(D0(t))return t.filters.map(e=>gd(e)).join(",");{const e=t.filters.map(n=>gd(n)).join(",");return`${t.op}(${e})`}}function N0(t,e){return t instanceof nt?function(r,s){return s instanceof nt&&r.op===s.op&&r.field.isEqual(s.field)&&Bn(r.value,s.value)}(t,e):t instanceof Rn?function(r,s){return s instanceof Rn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,l)=>i&&N0(a,s.filters[l]),!0):!1}(t,e):void ce()}function j0(t){return t instanceof nt?function(n){return`${n.field.canonicalString()} ${n.op} ${yi(n.value)}`}(t):t instanceof Rn?function(n){return n.op.toString()+" {"+n.getFilters().map(j0).join(" ,")+"}"}(t):"Filter"}class PS extends nt{constructor(e,n,r){super(e,n,r),this.key=ae.fromName(r.referenceValue)}matches(e){const n=ae.comparator(e.key,this.key);return this.matchesComparison(n)}}class bS extends nt{constructor(e,n){super(e,"in",n),this.keys=V0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class DS extends nt{constructor(e,n){super(e,"not-in",n),this.keys=V0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function V0(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ae.fromName(r.referenceValue))}class NS extends nt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return jh(n)&&zo(n.arrayValue,this.value)}}class jS extends nt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&zo(this.value.arrayValue,n)}}class VS extends nt{constructor(e,n){super(e,"not-in",n)}matches(e){if(zo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!zo(this.value.arrayValue,n)}}class MS extends nt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!jh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>zo(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.ue=null}}function ym(t,e=null,n=[],r=[],s=null,i=null,a=null){return new LS(t,e,n,r,s,i,a)}function Vh(t){const e=he(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>gd(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),su(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>yi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>yi(r)).join(",")),e.ue=n}return e.ue}function Mh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!kS(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!N0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!gm(t.startAt,e.startAt)&&gm(t.endAt,e.endAt)}function yd(t){return ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function OS(t,e,n,r,s,i,a,l){return new Xo(t,e,n,r,s,i,a,l)}function Lh(t){return new Xo(t)}function vm(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function M0(t){return t.collectionGroup!==null}function po(t){const e=he(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new gt(pt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(l=l.add(h.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Vl(i,r))}),n.has(pt.keyField().canonicalString())||e.ce.push(new Vl(pt.keyField(),r))}return e.ce}function Fn(t){const e=he(t);return e.le||(e.le=FS(e,po(t))),e.le}function FS(t,e){if(t.limitType==="F")return ym(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Vl(s.field,i)});const n=t.endAt?new jl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new jl(t.startAt.position,t.startAt.inclusive):null;return ym(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function vd(t,e){const n=t.filters.concat([e]);return new Xo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function xd(t,e,n){return new Xo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function iu(t,e){return Mh(Fn(t),Fn(e))&&t.limitType===e.limitType}function L0(t){return`${Vh(Fn(t))}|lt:${t.limitType}`}function Os(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>j0(s)).join(", ")}]`),su(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>yi(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>yi(s)).join(",")),`Target(${r})`}(Fn(t))}; limitType=${t.limitType})`}function ou(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ae.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of po(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(a,l,u){const h=mm(a,l,u);return a.inclusive?h<=0:h<0}(r.startAt,po(r),s)||r.endAt&&!function(a,l,u){const h=mm(a,l,u);return a.inclusive?h>=0:h>0}(r.endAt,po(r),s))}(t,e)}function zS(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function O0(t){return(e,n)=>{let r=!1;for(const s of po(t)){const i=BS(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function BS(t,e,n){const r=t.field.isKeyField()?ae.comparator(e.key,n.key):function(i,a,l){const u=a.data.field(i),h=l.data.field(i);return u!==null&&h!==null?gi(u,h):ce()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ce()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){_s(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return C0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const US=new qe(ae.comparator);function ar(){return US}const F0=new qe(ae.comparator);function Zi(...t){let e=F0;for(const n of t)e=e.insert(n.key,n);return e}function z0(t){let e=F0;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function os(){return mo()}function B0(){return mo()}function mo(){return new Ai(t=>t.toString(),(t,e)=>t.isEqual(e))}const $S=new qe(ae.comparator),WS=new gt(ae.comparator);function xe(...t){let e=WS;for(const n of t)e=e.add(n);return e}const HS=new gt(Te);function qS(){return HS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nl(e)?"-0":e}}function U0(t){return{integerValue:""+t}}function GS(t,e){return ES(e)?U0(e):Oh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(){this._=void 0}}function QS(t,e,n){return t instanceof Bo?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Dh(i)&&(i=Nh(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(n,e):t instanceof Uo?W0(t,e):t instanceof $o?H0(t,e):function(s,i){const a=$0(s,i),l=xm(a)+xm(s.Pe);return md(a)&&md(s.Pe)?U0(l):Oh(s.serializer,l)}(t,e)}function KS(t,e,n){return t instanceof Uo?W0(t,e):t instanceof $o?H0(t,e):n}function $0(t,e){return t instanceof Ml?function(r){return md(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Bo extends au{}class Uo extends au{constructor(e){super(),this.elements=e}}function W0(t,e){const n=q0(e);for(const r of t.elements)n.some(s=>Bn(s,r))||n.push(r);return{arrayValue:{values:n}}}class $o extends au{constructor(e){super(),this.elements=e}}function H0(t,e){let n=q0(e);for(const r of t.elements)n=n.filter(s=>!Bn(s,r));return{arrayValue:{values:n}}}class Ml extends au{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function xm(t){return Je(t.integerValue||t.doubleValue)}function q0(t){return jh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e,n){this.field=e,this.transform=n}}function XS(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Uo&&s instanceof Uo||r instanceof $o&&s instanceof $o?mi(r.elements,s.elements,Bn):r instanceof Ml&&s instanceof Ml?Bn(r.Pe,s.Pe):r instanceof Bo&&s instanceof Bo}(t.transform,e.transform)}class JS{constructor(e,n){this.version=e,this.transformResults=n}}class mn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new mn}static exists(e){return new mn(void 0,e)}static updateTime(e){return new mn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class lu{}function G0(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Fh(t.key,mn.none()):new Jo(t.key,t.data,mn.none());{const n=t.data,r=Ut.empty();let s=new gt(pt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Hr(t.key,r,new rn(s.toArray()),mn.none())}}function ZS(t,e,n){t instanceof Jo?function(s,i,a){const l=s.value.clone(),u=wm(s.fieldTransforms,i,a.transformResults);l.setAll(u),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Hr?function(s,i,a){if(!sl(s.precondition,i))return void i.convertToUnknownDocument(a.version);const l=wm(s.fieldTransforms,i,a.transformResults),u=i.data;u.setAll(Q0(s)),u.setAll(l),i.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function go(t,e,n,r){return t instanceof Jo?function(i,a,l,u){if(!sl(i.precondition,a))return l;const h=i.value.clone(),p=Sm(i.fieldTransforms,u,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof Hr?function(i,a,l,u){if(!sl(i.precondition,a))return l;const h=Sm(i.fieldTransforms,u,a),p=a.data;return p.setAll(Q0(i)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(g=>g.field))}(t,e,n,r):function(i,a,l){return sl(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function eE(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=$0(r.transform,s||null);i!=null&&(n===null&&(n=Ut.empty()),n.set(r.field,i))}return n||null}function _m(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&mi(r,s,(i,a)=>XS(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Jo extends lu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Hr extends lu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Q0(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function wm(t,e,n){const r=new Map;Ce(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,KS(a,l,n[s]))}return r}function Sm(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,QS(i,a,e))}return r}class Fh extends lu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tE extends lu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&ZS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=go(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=go(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=B0();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const u=G0(a,l);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(de.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),xe())}isEqual(e){return this.batchId===e.batchId&&mi(this.mutations,e.mutations,(n,r)=>_m(n,r))&&mi(this.baseMutations,e.baseMutations,(n,r)=>_m(n,r))}}class zh{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ce(e.mutations.length===r.length);let s=function(){return $S}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new zh(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et,_e;function iE(t){switch(t){default:return ce();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function K0(t){if(t===void 0)return or("GRPC error has no .code"),z.UNKNOWN;switch(t){case et.OK:return z.OK;case et.CANCELLED:return z.CANCELLED;case et.UNKNOWN:return z.UNKNOWN;case et.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case et.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case et.INTERNAL:return z.INTERNAL;case et.UNAVAILABLE:return z.UNAVAILABLE;case et.UNAUTHENTICATED:return z.UNAUTHENTICATED;case et.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case et.NOT_FOUND:return z.NOT_FOUND;case et.ALREADY_EXISTS:return z.ALREADY_EXISTS;case et.PERMISSION_DENIED:return z.PERMISSION_DENIED;case et.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case et.ABORTED:return z.ABORTED;case et.OUT_OF_RANGE:return z.OUT_OF_RANGE;case et.UNIMPLEMENTED:return z.UNIMPLEMENTED;case et.DATA_LOSS:return z.DATA_LOSS;default:return ce()}}(_e=et||(et={}))[_e.OK=0]="OK",_e[_e.CANCELLED=1]="CANCELLED",_e[_e.UNKNOWN=2]="UNKNOWN",_e[_e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_e[_e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_e[_e.NOT_FOUND=5]="NOT_FOUND",_e[_e.ALREADY_EXISTS=6]="ALREADY_EXISTS",_e[_e.PERMISSION_DENIED=7]="PERMISSION_DENIED",_e[_e.UNAUTHENTICATED=16]="UNAUTHENTICATED",_e[_e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_e[_e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_e[_e.ABORTED=10]="ABORTED",_e[_e.OUT_OF_RANGE=11]="OUT_OF_RANGE",_e[_e.UNIMPLEMENTED=12]="UNIMPLEMENTED",_e[_e.INTERNAL=13]="INTERNAL",_e[_e.UNAVAILABLE=14]="UNAVAILABLE",_e[_e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aE=new us([4294967295,4294967295],0);function Em(t){const e=oE().encode(t),n=new _0;return n.update(e),new Uint8Array(n.digest())}function Tm(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new us([n,r],0),new us([s,i],0)]}class Bh{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new eo(`Invalid padding: ${n}`);if(r<0)throw new eo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new eo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new eo(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=us.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(us.fromNumber(r)));return s.compare(aE)===1&&(s=new us([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Em(e),[r,s]=Tm(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Bh(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;const n=Em(e),[r,s]=Tm(n);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class eo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Zo.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new uu(de.min(),s,new qe(Te),ar(),xe())}}class Zo{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Zo(r,n,xe(),xe(),xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class Y0{constructor(e,n){this.targetId=e,this.me=n}}class X0{constructor(e,n,r=vt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Im{constructor(){this.fe=0,this.ge=Cm(),this.pe=vt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=xe(),n=xe(),r=xe();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ce()}}),new Zo(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Cm()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ce(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class lE{constructor(e){this.Le=e,this.Be=new Map,this.ke=ar(),this.qe=Am(),this.Qe=new qe(Te)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ce()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(yd(i))if(r===0){const a=new ae(i.path);this.Ue(n,a,Rt.newNoDocument(a,de.min()))}else Ce(r===1);else{const a=this.Ye(n);if(a!==r){const l=this.Ze(e),u=l?this.Xe(l,e,a):1;if(u!==0){this.je(n);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,h)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let a,l;try{a=gs(r).toUint8Array()}catch(u){if(u instanceof k0)return Mo("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Bh(a,s,i)}catch(u){return Mo(u instanceof eo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,a)=>{const l=this.Je(a);if(l){if(i.current&&yd(l.target)){const u=new ae(l.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,Rt.newNoDocument(u,e))}i.be&&(n.set(a,i.ve()),i.Ce())}});let r=xe();this.qe.forEach((i,a)=>{let l=!0;a.forEachWhile(u=>{const h=this.Je(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new uu(e,n,this.Qe,this.ke,r);return this.ke=ar(),this.qe=Am(),this.Qe=new qe(Te),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Im,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new gt(Te),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ie("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Im),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Am(){return new qe(ae.comparator)}function Cm(){return new qe(ae.comparator)}const uE={asc:"ASCENDING",desc:"DESCENDING"},cE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},dE={and:"AND",or:"OR"};class hE{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function _d(t,e){return t.useProto3Json||su(e)?e:{value:e}}function Ll(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function J0(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function fE(t,e){return Ll(t,e.toTimestamp())}function zn(t){return Ce(!!t),de.fromTimestamp(function(n){const r=zr(n);return new at(r.seconds,r.nanos)}(t))}function Uh(t,e){return wd(t,e).canonicalString()}function wd(t,e){const n=function(s){return new Oe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Z0(t){const e=Oe.fromString(t);return Ce(sv(e)),e}function Sd(t,e){return Uh(t.databaseId,e.path)}function ic(t,e){const n=Z0(e);if(n.get(1)!==t.databaseId.projectId)throw new te(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new te(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ae(tv(n))}function ev(t,e){return Uh(t.databaseId,e)}function pE(t){const e=Z0(t);return e.length===4?Oe.emptyPath():tv(e)}function Ed(t){return new Oe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function tv(t){return Ce(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function km(t,e,n){return{name:Sd(t,e),fields:n.value.mapValue.fields}}function mE(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ce()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,p){return h.useProto3Json?(Ce(p===void 0||typeof p=="string"),vt.fromBase64String(p||"")):(Ce(p===void 0||p instanceof Buffer||p instanceof Uint8Array),vt.fromUint8Array(p||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(h){const p=h.code===void 0?z.UNKNOWN:K0(h.code);return new te(p,h.message||"")}(a);n=new X0(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ic(t,r.document.name),i=zn(r.document.updateTime),a=r.document.createTime?zn(r.document.createTime):de.min(),l=new Ut({mapValue:{fields:r.document.fields}}),u=Rt.newFoundDocument(s,i,a,l),h=r.targetIds||[],p=r.removedTargetIds||[];n=new il(h,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ic(t,r.document),i=r.readTime?zn(r.readTime):de.min(),a=Rt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new il([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ic(t,r.document),i=r.removedTargetIds||[];n=new il([],i,s,null)}else{if(!("filter"in e))return ce();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new sE(s,i),l=r.targetId;n=new Y0(l,a)}}return n}function gE(t,e){let n;if(e instanceof Jo)n={update:km(t,e.key,e.value)};else if(e instanceof Fh)n={delete:Sd(t,e.key)};else if(e instanceof Hr)n={update:km(t,e.key,e.data),updateMask:IE(e.fieldMask)};else{if(!(e instanceof tE))return ce();n={verify:Sd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof Bo)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Uo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof $o)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ml)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw ce()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:fE(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ce()}(t,e.precondition)),n}function yE(t,e){return t&&t.length>0?(Ce(e!==void 0),t.map(n=>function(s,i){let a=s.updateTime?zn(s.updateTime):zn(i);return a.isEqual(de.min())&&(a=zn(i)),new JS(a,s.transformResults||[])}(n,e))):[]}function vE(t,e){return{documents:[ev(t,e.path)]}}function xE(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=ev(t,s);const i=function(h){if(h.length!==0)return rv(Rn.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const a=function(h){if(h.length!==0)return h.map(p=>function(y){return{field:Fs(y.field),direction:SE(y.dir)}}(p))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=_d(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{_t:n,parent:s}}function _E(t){let e=pE(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ce(r===1);const p=n.from[0];p.allDescendants?s=p.collectionId:e=e.child(p.collectionId)}let i=[];n.where&&(i=function(g){const y=nv(g);return y instanceof Rn&&D0(y)?y.getFilters():[y]}(n.where));let a=[];n.orderBy&&(a=function(g){return g.map(y=>function(C){return new Vl(zs(C.field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(y))}(n.orderBy));let l=null;n.limit&&(l=function(g){let y;return y=typeof g=="object"?g.value:g,su(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(g){const y=!!g.before,T=g.values||[];return new jl(T,y)}(n.startAt));let h=null;return n.endAt&&(h=function(g){const y=!g.before,T=g.values||[];return new jl(T,y)}(n.endAt)),OS(e,s,a,i,l,"F",u,h)}function wE(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ce()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function nv(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=zs(n.unaryFilter.field);return nt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=zs(n.unaryFilter.field);return nt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=zs(n.unaryFilter.field);return nt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=zs(n.unaryFilter.field);return nt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ce()}}(t):t.fieldFilter!==void 0?function(n){return nt.create(zs(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ce()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Rn.create(n.compositeFilter.filters.map(r=>nv(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ce()}}(n.compositeFilter.op))}(t):ce()}function SE(t){return uE[t]}function EE(t){return cE[t]}function TE(t){return dE[t]}function Fs(t){return{fieldPath:t.canonicalString()}}function zs(t){return pt.fromServerFormat(t.fieldPath)}function rv(t){return t instanceof nt?function(n){if(n.op==="=="){if(pm(n.value))return{unaryFilter:{field:Fs(n.field),op:"IS_NAN"}};if(fm(n.value))return{unaryFilter:{field:Fs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(pm(n.value))return{unaryFilter:{field:Fs(n.field),op:"IS_NOT_NAN"}};if(fm(n.value))return{unaryFilter:{field:Fs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fs(n.field),op:EE(n.op),value:n.value}}}(t):t instanceof Rn?function(n){const r=n.getFilters().map(s=>rv(s));return r.length===1?r[0]:{compositeFilter:{op:TE(n.op),filters:r}}}(t):ce()}function IE(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function sv(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,n,r,s,i=de.min(),a=de.min(),l=vt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new Tr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(e){this.ct=e}}function CE(t){const e=_E({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?xd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(){this.un=new RE}addToCollectionParentIndex(e,n){return this.un.add(n),$.resolve()}getCollectionParents(e,n){return $.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return $.resolve()}deleteFieldIndex(e,n){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,n){return $.resolve()}getDocumentsMatchingTarget(e,n){return $.resolve(null)}getIndexType(e,n){return $.resolve(0)}getFieldIndexes(e,n){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,n){return $.resolve(Fr.min())}getMinOffsetFromCollectionGroup(e,n){return $.resolve(Fr.min())}updateCollectionGroup(e,n,r){return $.resolve()}updateIndexEntries(e,n){return $.resolve()}}class RE{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new gt(Oe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new gt(Oe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new vi(0)}static kn(){return new vi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(){this.changes=new Ai(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Rt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?$.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&go(r.mutation,s,rn.empty(),at.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,xe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=xe()){const s=os();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=Zi();return i.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=os();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,xe()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=ar();const a=mo(),l=function(){return mo()}();return n.forEach((u,h)=>{const p=r.get(h.key);s.has(h.key)&&(p===void 0||p.mutation instanceof Hr)?i=i.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),go(p.mutation,h,p.mutation.getFieldMask(),at.now())):a.set(h.key,rn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,p)=>a.set(h,p)),n.forEach((h,p)=>{var g;return l.set(h,new bE(p,(g=a.get(h))!==null&&g!==void 0?g:null))}),l))}recalculateAndSaveOverlays(e,n){const r=mo();let s=new qe((a,l)=>a-l),i=xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const h=n.get(u);if(h===null)return;let p=r.get(u)||rn.empty();p=l.applyToLocalView(h,p),r.set(u,p);const g=(s.get(l.batchId)||xe()).add(u);s=s.insert(l.batchId,g)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,p=u.value,g=B0();p.forEach(y=>{if(!i.has(y)){const T=G0(n.get(y),r.get(y));T!==null&&g.set(y,T),i=i.add(y)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,g))}return $.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(a){return ae.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):M0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):$.resolve(os());let l=-1,u=i;return a.next(h=>$.forEach(h,(p,g)=>(l<g.largestBatchId&&(l=g.largestBatchId),i.get(p)?$.resolve():this.remoteDocumentCache.getEntry(e,p).next(y=>{u=u.insert(p,y)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,xe())).next(p=>({batchId:l,changes:z0(p)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ae(n)).next(r=>{let s=Zi();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let a=Zi();return this.indexManager.getCollectionParents(e,i).next(l=>$.forEach(l,u=>{const h=function(g,y){return new Xo(y,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next(p=>{p.forEach((g,y)=>{a=a.insert(g,y)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(a=>{i.forEach((u,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,Rt.newInvalidDocument(p)))});let l=Zi();return a.forEach((u,h)=>{const p=i.get(u);p!==void 0&&go(p.mutation,h,rn.empty(),at.now()),ou(n,h)&&(l=l.insert(u,h))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return $.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:zn(s.createTime)}}(n)),$.resolve()}getNamedQuery(e,n){return $.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:CE(s.bundledQuery),readTime:zn(s.readTime)}}(n)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(){this.overlays=new qe(ae.comparator),this.Ir=new Map}getOverlay(e,n){return $.resolve(this.overlays.get(n))}getOverlays(e,n){const r=os();return $.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),$.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),$.resolve()}getOverlaysForCollection(e,n,r){const s=os(),i=n.length+1,a=new ae(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return $.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new qe((h,p)=>h-p);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let p=i.get(h.largestBatchId);p===null&&(p=os(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=os(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>l.set(h,p)),!(l.size()>=s)););return $.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new rE(n,r));let i=this.Ir.get(n);i===void 0&&(i=xe(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(){this.sessionToken=vt.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(){this.Tr=new gt(lt.Er),this.dr=new gt(lt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new lt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new lt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ae(new Oe([])),r=new lt(n,e),s=new lt(n,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ae(new Oe([])),r=new lt(n,e),s=new lt(n,e+1);let i=xe();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new lt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class lt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ae.comparator(e.key,n.key)||Te(e.wr,n.wr)}static Ar(e,n){return Te(e.wr,n.wr)||ae.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new gt(lt.Er)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new nE(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.br=this.br.add(new lt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return $.resolve(a)}lookupMutationBatch(e,n){return $.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new lt(n,0),s=new lt(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const l=this.Dr(a.wr);i.push(l)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new gt(Te);return n.forEach(s=>{const i=new lt(s,0),a=new lt(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],l=>{r=r.add(l.wr)})}),$.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ae.isDocumentKey(i)||(i=i.child(""));const a=new lt(new ae(i),0);let l=new gt(Te);return this.br.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(l=l.add(u.wr)),!0)},a),$.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Ce(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return $.forEach(n.mutations,s=>{const i=new lt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new lt(n,0),s=this.br.firstAfterOrEqual(r);return $.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{constructor(e){this.Mr=e,this.docs=function(){return new qe(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return $.resolve(r?r.document.mutableCopy():Rt.newInvalidDocument(n))}getEntries(e,n){let r=ar();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Rt.newInvalidDocument(s))}),$.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=ar();const a=n.path,l=new ae(a.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:p}}=u.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||xS(vS(p),r)<=0||(s.has(p.key)||ou(n,p))&&(i=i.insert(p.key,p.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ce()}Or(e,n){return $.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new OE(this)}getSize(e){return $.resolve(this.size)}}class OE extends PE{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),$.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(e){this.persistence=e,this.Nr=new Ai(n=>Vh(n),Mh),this.lastRemoteSnapshotVersion=de.min(),this.highestTargetId=0,this.Lr=0,this.Br=new $h,this.targetCount=0,this.kr=vi.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),$.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new vi(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,$.resolve()}updateTargetData(e,n){return this.Kn(n),$.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),$.waitFor(i).next(()=>s)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return $.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),$.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),$.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return $.resolve(r)}containsKey(e,n){return $.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(e,n){this.qr={},this.overlays={},this.Qr=new bh(0),this.Kr=!1,this.Kr=!0,this.$r=new VE,this.referenceDelegate=e(this),this.Ur=new FE(this),this.indexManager=new kE,this.remoteDocumentCache=function(s){return new LE(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new AE(n),this.Gr=new NE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new jE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new ME(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ie("MemoryPersistence","Starting transaction:",e);const s=new BE(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return $.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class BE extends wS{constructor(e){super(),this.currentSequenceNumber=e}}class Wh{constructor(e){this.persistence=e,this.Jr=new $h,this.Yr=null}static Zr(e){return new Wh(e)}get Xr(){if(this.Yr)return this.Yr;throw ce()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),$.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),$.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.Xr,r=>{const s=ae.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,de.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return $.or([()=>$.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=xe(),s=xe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Hh(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return H1()?8:SS($1())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new UE;return this.Xi(e,n,a).next(l=>{if(i.result=l,this.zi)return this.es(e,n,a,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Gi()<=we.DEBUG&&ie("QueryEngine","SDK will not create cache indexes for query:",Os(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),$.resolve()):(Gi()<=we.DEBUG&&ie("QueryEngine","Query:",Os(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Gi()<=we.DEBUG&&ie("QueryEngine","The SDK decides to create cache indexes for query:",Os(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fn(n))):$.resolve())}Yi(e,n){if(vm(n))return $.resolve(null);let r=Fn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=xd(n,null,"F"),r=Fn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=xe(...i);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.ts(n,l);return this.ns(n,h,a,u.readTime)?this.Yi(e,xd(n,null,"F")):this.rs(e,h,n,u)}))})))}Zi(e,n,r,s){return vm(n)||s.isEqual(de.min())?$.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(n,i);return this.ns(n,a,r,s)?$.resolve(null):(Gi()<=we.DEBUG&&ie("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Os(n)),this.rs(e,a,n,yS(s,-1)).next(l=>l))})}ts(e,n){let r=new gt(O0(e));return n.forEach((s,i)=>{ou(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Gi()<=we.DEBUG&&ie("QueryEngine","Using full collection scan to execute query:",Os(n)),this.Ji.getDocumentsMatchingQuery(e,n,Fr.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WE{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new qe(Te),this._s=new Ai(i=>Vh(i),Mh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new DE(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function HE(t,e,n,r){return new WE(t,e,n,r)}async function iv(t,e){const n=he(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let u=xe();for(const h of s){a.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of i){l.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return n.localDocuments.getDocuments(r,u).next(h=>({hs:h,removedBatchIds:a,addedBatchIds:l}))})})}function qE(t,e){const n=he(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,h,p){const g=h.batch,y=g.keys();let T=$.resolve();return y.forEach(C=>{T=T.next(()=>p.getEntry(u,C)).next(b=>{const O=h.docVersions.get(C);Ce(O!==null),b.version.compareTo(O)<0&&(g.applyToRemoteDocument(b,h),b.isValidDocument()&&(b.setReadTime(h.commitVersion),p.addEntry(b)))})}),T.next(()=>l.mutationQueue.removeMutationBatch(u,g))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=xe();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function ov(t){const e=he(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function GE(t,e){const n=he(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((p,g)=>{const y=s.get(g);if(!y)return;l.push(n.Ur.removeMatchingKeys(i,p.removedDocuments,g).next(()=>n.Ur.addMatchingKeys(i,p.addedDocuments,g)));let T=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(g)!==null?T=T.withResumeToken(vt.EMPTY_BYTE_STRING,de.min()).withLastLimboFreeSnapshotVersion(de.min()):p.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(p.resumeToken,r)),s=s.insert(g,T),function(b,O,A){return b.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(y,T,p)&&l.push(n.Ur.updateTargetData(i,T))});let u=ar(),h=xe();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,p))}),l.push(QE(i,a,e.documentUpdates).next(p=>{u=p.Ps,h=p.Is})),!r.isEqual(de.min())){const p=n.Ur.getLastRemoteSnapshotVersion(i).next(g=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(p)}return $.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(n.os=s,i))}function QE(t,e,n){let r=xe(),s=xe();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=ar();return n.forEach((l,u)=>{const h=i.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(de.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):ie("LocalStore","Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)}),{Ps:a,Is:s}})}function KE(t,e){const n=he(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function YE(t,e){const n=he(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,$.resolve(s)):n.Ur.allocateTargetId(r).next(a=>(s=new Tr(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Td(t,e,n){const r=he(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Yo(a))throw a;ie("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function Rm(t,e,n){const r=he(t);let s=de.min(),i=xe();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,h,p){const g=he(u),y=g._s.get(p);return y!==void 0?$.resolve(g.os.get(y)):g.Ur.getTargetData(h,p)}(r,a,Fn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,n?s:de.min(),n?i:xe())).next(l=>(XE(r,zS(e),l),{documents:l,Ts:i})))}function XE(t,e,n){let r=t.us.get(e)||de.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Pm{constructor(){this.activeTargetIds=qS()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class JE{constructor(){this.so=new Pm,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Pm,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ie("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ie("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $a=null;function oc(){return $a===null?$a=function(){return 268435456+Math.round(2147483648*Math.random())}():$a++,"0x"+$a.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const At="WebChannelConnection";class nT extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,a){const l=oc(),u=this.xo(n,r.toUriEncodedString());ie("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const h={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(h,i,a),this.No(n,u,h,s).then(p=>(ie("RestConnection",`Received RPC '${n}' ${l}: `,p),p),p=>{throw Mo("RestConnection",`RPC '${n}' ${l} failed with error: `,p,"url: ",u,"request:",s),p})}Lo(n,r,s,i,a,l){return this.Mo(n,r,s,i,a)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ii}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>n[a]=i),s&&s.headers.forEach((i,a)=>n[a]=i)}xo(n,r){const s=eT[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=oc();return new Promise((a,l)=>{const u=new w0;u.setWithCredentials(!0),u.listenOnce(S0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case nl.NO_ERROR:const p=u.getResponseJson();ie(At,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(p)),a(p);break;case nl.TIMEOUT:ie(At,`RPC '${e}' ${i} timed out`),l(new te(z.DEADLINE_EXCEEDED,"Request time out"));break;case nl.HTTP_ERROR:const g=u.getStatus();if(ie(At,`RPC '${e}' ${i} failed with status:`,g,"response text:",u.getResponseText()),g>0){let y=u.getResponseJson();Array.isArray(y)&&(y=y[0]);const T=y==null?void 0:y.error;if(T&&T.status&&T.message){const C=function(O){const A=O.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(A)>=0?A:z.UNKNOWN}(T.status);l(new te(C,T.message))}else l(new te(z.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new te(z.UNAVAILABLE,"Connection failed."));break;default:ce()}}finally{ie(At,`RPC '${e}' ${i} completed.`)}});const h=JSON.stringify(s);ie(At,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",h,r,15)})}Bo(e,n,r){const s=oc(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=I0(),l=T0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const p=i.join("");ie(At,`Creating RPC '${e}' stream ${s}: ${p}`,u);const g=a.createWebChannel(p,u);let y=!1,T=!1;const C=new tT({Io:O=>{T?ie(At,`Not sending because RPC '${e}' stream ${s} is closed:`,O):(y||(ie(At,`Opening RPC '${e}' stream ${s} transport.`),g.open(),y=!0),ie(At,`RPC '${e}' stream ${s} sending:`,O),g.send(O))},To:()=>g.close()}),b=(O,A,S)=>{O.listen(A,R=>{try{S(R)}catch(M){setTimeout(()=>{throw M},0)}})};return b(g,Ji.EventType.OPEN,()=>{T||(ie(At,`RPC '${e}' stream ${s} transport opened.`),C.yo())}),b(g,Ji.EventType.CLOSE,()=>{T||(T=!0,ie(At,`RPC '${e}' stream ${s} transport closed`),C.So())}),b(g,Ji.EventType.ERROR,O=>{T||(T=!0,Mo(At,`RPC '${e}' stream ${s} transport errored:`,O),C.So(new te(z.UNAVAILABLE,"The operation could not be completed")))}),b(g,Ji.EventType.MESSAGE,O=>{var A;if(!T){const S=O.data[0];Ce(!!S);const R=S,M=R.error||((A=R[0])===null||A===void 0?void 0:A.error);if(M){ie(At,`RPC '${e}' stream ${s} received error:`,M);const B=M.status;let L=function(_){const E=et[_];if(E!==void 0)return K0(E)}(B),w=M.message;L===void 0&&(L=z.INTERNAL,w="Unknown error status: "+B+" with message "+M.message),T=!0,C.So(new te(L,w)),g.close()}else ie(At,`RPC '${e}' stream ${s} received:`,S),C.bo(S)}}),b(l,E0.STAT_EVENT,O=>{O.stat===fd.PROXY?ie(At,`RPC '${e}' stream ${s} detected buffering proxy`):O.stat===fd.NOPROXY&&ie(At,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{C.wo()},0),C}}function ac(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cu(t){return new hE(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&ie("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(e,n,r,s,i,a,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new av(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(or(n.toString()),or("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new te(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ie("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ie("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class rT extends lv{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=mE(this.serializer,e),r=function(i){if(!("targetChange"in i))return de.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?de.min():a.readTime?zn(a.readTime):de.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Ed(this.serializer),n.addTarget=function(i,a){let l;const u=a.target;if(l=yd(u)?{documents:vE(i,u)}:{query:xE(i,u)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=J0(i,a.resumeToken);const h=_d(i,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(de.min())>0){l.readTime=Ll(i,a.snapshotVersion.toTimestamp());const h=_d(i,a.expectedCount);h!==null&&(l.expectedCount=h)}return l}(this.serializer,e);const r=wE(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Ed(this.serializer),n.removeTarget=e,this.a_(n)}}class sT extends lv{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Ce(!!e.streamToken),this.lastStreamToken=e.streamToken,Ce(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ce(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=yE(e.writeResults,e.commitTime),r=zn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Ed(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>gE(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new te(z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,wd(n,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new te(z.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,wd(n,r),s,a,l,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new te(z.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class oT{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(or(n),this.D_=!1):ie("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{ws(this)&&(ie("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=he(u);h.L_.add(4),await ea(h),h.q_.set("Unknown"),h.L_.delete(4),await du(h)}(this))})}),this.q_=new oT(r,s)}}async function du(t){if(ws(t))for(const e of t.B_)await e(!0)}async function ea(t){for(const e of t.B_)await e(!1)}function uv(t,e){const n=he(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Kh(n)?Qh(n):Ci(n).r_()&&Gh(n,e))}function qh(t,e){const n=he(t),r=Ci(n);n.N_.delete(e),r.r_()&&cv(n,e),n.N_.size===0&&(r.r_()?r.o_():ws(n)&&n.q_.set("Unknown"))}function Gh(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(de.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ci(t).A_(e)}function cv(t,e){t.Q_.xe(e),Ci(t).R_(e)}function Qh(t){t.Q_=new lE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ci(t).start(),t.q_.v_()}function Kh(t){return ws(t)&&!Ci(t).n_()&&t.N_.size>0}function ws(t){return he(t).L_.size===0}function dv(t){t.Q_=void 0}async function lT(t){t.q_.set("Online")}async function uT(t){t.N_.forEach((e,n)=>{Gh(t,e)})}async function cT(t,e){dv(t),Kh(t)?(t.q_.M_(e),Qh(t)):t.q_.set("Unknown")}async function dT(t,e,n){if(t.q_.set("Online"),e instanceof X0&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){ie("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ol(t,r)}else if(e instanceof il?t.Q_.Ke(e):e instanceof Y0?t.Q_.He(e):t.Q_.We(e),!n.isEqual(de.min()))try{const r=await ov(t.localStore);n.compareTo(r)>=0&&await function(i,a){const l=i.Q_.rt(a);return l.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const p=i.N_.get(h);p&&i.N_.set(h,p.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,h)=>{const p=i.N_.get(u);if(!p)return;i.N_.set(u,p.withResumeToken(vt.EMPTY_BYTE_STRING,p.snapshotVersion)),cv(i,u);const g=new Tr(p.target,u,h,p.sequenceNumber);Gh(i,g)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ie("RemoteStore","Failed to raise snapshot:",r),await Ol(t,r)}}async function Ol(t,e,n){if(!Yo(e))throw e;t.L_.add(1),await ea(t),t.q_.set("Offline"),n||(n=()=>ov(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ie("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await du(t)})}function hv(t,e){return e().catch(n=>Ol(t,n,e))}async function hu(t){const e=he(t),n=Br(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;hT(e);)try{const s=await KE(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,fT(e,s)}catch(s){await Ol(e,s)}fv(e)&&pv(e)}function hT(t){return ws(t)&&t.O_.length<10}function fT(t,e){t.O_.push(e);const n=Br(t);n.r_()&&n.V_&&n.m_(e.mutations)}function fv(t){return ws(t)&&!Br(t).n_()&&t.O_.length>0}function pv(t){Br(t).start()}async function pT(t){Br(t).p_()}async function mT(t){const e=Br(t);for(const n of t.O_)e.m_(n.mutations)}async function gT(t,e,n){const r=t.O_.shift(),s=zh.from(r,e,n);await hv(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await hu(t)}async function yT(t,e){e&&Br(t).V_&&await async function(r,s){if(function(a){return iE(a)&&a!==z.ABORTED}(s.code)){const i=r.O_.shift();Br(r).s_(),await hv(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await hu(r)}}(t,e),fv(t)&&pv(t)}async function Dm(t,e){const n=he(t);n.asyncQueue.verifyOperationInProgress(),ie("RemoteStore","RemoteStore received new credentials");const r=ws(n);n.L_.add(3),await ea(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await du(n)}async function vT(t,e){const n=he(t);e?(n.L_.delete(2),await du(n)):e||(n.L_.add(2),await ea(n),n.q_.set("Unknown"))}function Ci(t){return t.K_||(t.K_=function(n,r,s){const i=he(n);return i.w_(),new rT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:lT.bind(null,t),Ro:uT.bind(null,t),mo:cT.bind(null,t),d_:dT.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Kh(t)?Qh(t):t.q_.set("Unknown")):(await t.K_.stop(),dv(t))})),t.K_}function Br(t){return t.U_||(t.U_=function(n,r,s){const i=he(n);return i.w_(),new sT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:pT.bind(null,t),mo:yT.bind(null,t),f_:mT.bind(null,t),g_:gT.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await hu(t)):(await t.U_.stop(),t.O_.length>0&&(ie("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Zn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new Yh(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xh(t,e){if(or("AsyncQueue",`${e}: ${t}`),Yo(t))return new te(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ae.comparator(n.key,r.key):(n,r)=>ae.comparator(n.key,r.key),this.keyedMap=Zi(),this.sortedSet=new qe(this.comparator)}static emptySet(e){return new oi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof oi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new oi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(){this.W_=new qe(ae.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ce():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class xi{constructor(e,n,r,s,i,a,l,u,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new xi(e,n,oi.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&iu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class _T{constructor(){this.queries=jm(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=he(n),i=s.queries;s.queries=jm(),i.forEach((a,l)=>{for(const u of l.j_)u.onError(r)})})(this,new te(z.ABORTED,"Firestore shutting down"))}}function jm(){return new Ai(t=>L0(t),iu)}async function mv(t,e){const n=he(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new xT,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(a){const l=Xh(a,`Initialization of query '${Os(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Jh(n)}async function gv(t,e){const n=he(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function wT(t,e){const n=he(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.j_)l.X_(s)&&(r=!0);a.z_=s}}r&&Jh(n)}function ST(t,e,n){const r=he(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Jh(t){t.Y_.forEach(e=>{e.next()})}var Id,Vm;(Vm=Id||(Id={})).ea="default",Vm.Cache="cache";class yv{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new xi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=xi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Id.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(e){this.key=e}}class xv{constructor(e){this.key=e}}class ET{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=xe(),this.mutatedKeys=xe(),this.Aa=O0(e),this.Ra=new oi(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Nm,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((p,g)=>{const y=s.get(p),T=ou(this.query,g)?g:null,C=!!y&&this.mutatedKeys.has(y.key),b=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let O=!1;y&&T?y.data.isEqual(T.data)?C!==b&&(r.track({type:3,doc:T}),O=!0):this.ga(y,T)||(r.track({type:2,doc:T}),O=!0,(u&&this.Aa(T,u)>0||h&&this.Aa(T,h)<0)&&(l=!0)):!y&&T?(r.track({type:0,doc:T}),O=!0):y&&!T&&(r.track({type:1,doc:y}),O=!0,(u||h)&&(l=!0)),O&&(T?(a=a.add(T),i=b?i.add(p):i.delete(p)):(a=a.delete(p),i=i.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((p,g)=>function(T,C){const b=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ce()}};return b(T)-b(C)}(p.type,g.type)||this.Aa(p.doc,g.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,h=u!==this.Ea;return this.Ea=u,a.length!==0||h?{snapshot:new xi(this.query,e.Ra,i,a,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Nm,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=xe(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new xv(r))}),this.da.forEach(r=>{e.has(r)||n.push(new vv(r))}),n}ba(e){this.Ta=e.Ts,this.da=xe();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return xi.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class TT{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class IT{constructor(e){this.key=e,this.va=!1}}class AT{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Ai(l=>L0(l),iu),this.Ma=new Map,this.xa=new Set,this.Oa=new qe(ae.comparator),this.Na=new Map,this.La=new $h,this.Ba={},this.ka=new Map,this.qa=vi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function CT(t,e,n=!0){const r=Iv(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await _v(r,e,n,!0),s}async function kT(t,e){const n=Iv(t);await _v(n,e,!0,!1)}async function _v(t,e,n,r){const s=await YE(t.localStore,Fn(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await RT(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&n&&uv(t.remoteStore,s),l}async function RT(t,e,n,r,s){t.Ka=(g,y,T)=>async function(b,O,A,S){let R=O.view.ma(A);R.ns&&(R=await Rm(b.localStore,O.query,!1).then(({documents:w})=>O.view.ma(w,R)));const M=S&&S.targetChanges.get(O.targetId),B=S&&S.targetMismatches.get(O.targetId)!=null,L=O.view.applyChanges(R,b.isPrimaryClient,M,B);return Lm(b,O.targetId,L.wa),L.snapshot}(t,g,y,T);const i=await Rm(t.localStore,e,!0),a=new ET(e,i.Ts),l=a.ma(i.documents),u=Zo.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=a.applyChanges(l,t.isPrimaryClient,u);Lm(t,n,h.wa);const p=new TT(e,n,a);return t.Fa.set(e,p),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),h.snapshot}async function PT(t,e,n){const r=he(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!iu(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Td(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&qh(r.remoteStore,s.targetId),Ad(r,s.targetId)}).catch(Ko)):(Ad(r,s.targetId),await Td(r.localStore,s.targetId,!0))}async function bT(t,e){const n=he(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),qh(n.remoteStore,r.targetId))}async function DT(t,e,n){const r=FT(t);try{const s=await function(a,l){const u=he(a),h=at.now(),p=l.reduce((T,C)=>T.add(C.key),xe());let g,y;return u.persistence.runTransaction("Locally write mutations","readwrite",T=>{let C=ar(),b=xe();return u.cs.getEntries(T,p).next(O=>{C=O,C.forEach((A,S)=>{S.isValidDocument()||(b=b.add(A))})}).next(()=>u.localDocuments.getOverlayedDocuments(T,C)).next(O=>{g=O;const A=[];for(const S of l){const R=eE(S,g.get(S.key).overlayedDocument);R!=null&&A.push(new Hr(S.key,R,R0(R.value.mapValue),mn.exists(!0)))}return u.mutationQueue.addMutationBatch(T,h,A,l)}).next(O=>{y=O;const A=O.applyToLocalDocumentSet(g,b);return u.documentOverlayCache.saveOverlays(T,O.batchId,A)})}).then(()=>({batchId:y.batchId,changes:z0(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,l,u){let h=a.Ba[a.currentUser.toKey()];h||(h=new qe(Te)),h=h.insert(l,u),a.Ba[a.currentUser.toKey()]=h}(r,s.batchId,n),await ta(r,s.changes),await hu(r.remoteStore)}catch(s){const i=Xh(s,"Failed to persist write");n.reject(i)}}async function wv(t,e){const n=he(t);try{const r=await GE(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.Na.get(i);a&&(Ce(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?Ce(a.va):s.removedDocuments.size>0&&(Ce(a.va),a.va=!1))}),await ta(n,r,e)}catch(r){await Ko(r)}}function Mm(t,e,n){const r=he(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,a)=>{const l=a.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const u=he(a);u.onlineState=l;let h=!1;u.queries.forEach((p,g)=>{for(const y of g.j_)y.Z_(l)&&(h=!0)}),h&&Jh(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function NT(t,e,n){const r=he(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new qe(ae.comparator);a=a.insert(i,Rt.newNoDocument(i,de.min()));const l=xe().add(i),u=new uu(de.min(),new Map,new qe(Te),a,l);await wv(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),Zh(r)}else await Td(r.localStore,e,!1).then(()=>Ad(r,e,n)).catch(Ko)}async function jT(t,e){const n=he(t),r=e.batch.batchId;try{const s=await qE(n.localStore,e);Ev(n,r,null),Sv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ta(n,s)}catch(s){await Ko(s)}}async function VT(t,e,n){const r=he(t);try{const s=await function(a,l){const u=he(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return u.mutationQueue.lookupMutationBatch(h,l).next(g=>(Ce(g!==null),p=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,p,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>u.localDocuments.getDocuments(h,p))})}(r.localStore,e);Ev(r,e,n),Sv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ta(r,s)}catch(s){await Ko(s)}}function Sv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Ev(t,e,n){const r=he(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Ad(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Tv(t,r)})}function Tv(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(qh(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Zh(t))}function Lm(t,e,n){for(const r of n)r instanceof vv?(t.La.addReference(r.key,e),MT(t,r)):r instanceof xv?(ie("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Tv(t,r.key)):ce()}function MT(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ie("SyncEngine","New document in limbo: "+n),t.xa.add(r),Zh(t))}function Zh(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ae(Oe.fromString(e)),r=t.qa.next();t.Na.set(r,new IT(n)),t.Oa=t.Oa.insert(n,r),uv(t.remoteStore,new Tr(Fn(Lh(n.path)),r,"TargetPurposeLimboResolution",bh.oe))}}async function ta(t,e,n){const r=he(t),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{a.push(r.Ka(u,e,n).then(h=>{var p;if((h||n)&&r.isPrimaryClient){const g=h?!h.fromCache:(p=n==null?void 0:n.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){s.push(h);const g=Hh.Wi(u.targetId,h);i.push(g)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(u,h){const p=he(u);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>$.forEach(h,y=>$.forEach(y.$i,T=>p.persistence.referenceDelegate.addReference(g,y.targetId,T)).next(()=>$.forEach(y.Ui,T=>p.persistence.referenceDelegate.removeReference(g,y.targetId,T)))))}catch(g){if(!Yo(g))throw g;ie("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const y=g.targetId;if(!g.fromCache){const T=p.os.get(y),C=T.snapshotVersion,b=T.withLastLimboFreeSnapshotVersion(C);p.os=p.os.insert(y,b)}}}(r.localStore,i))}async function LT(t,e){const n=he(t);if(!n.currentUser.isEqual(e)){ie("SyncEngine","User change. New user:",e.toKey());const r=await iv(n.localStore,e);n.currentUser=e,function(i,a){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new te(z.CANCELLED,a))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ta(n,r.hs)}}function OT(t,e){const n=he(t),r=n.Na.get(e);if(r&&r.va)return xe().add(r.key);{let s=xe();const i=n.Ma.get(e);if(!i)return s;for(const a of i){const l=n.Fa.get(a);s=s.unionWith(l.view.Va)}return s}}function Iv(t){const e=he(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=wv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=OT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=NT.bind(null,e),e.Ca.d_=wT.bind(null,e.eventManager),e.Ca.$a=ST.bind(null,e.eventManager),e}function FT(t){const e=he(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=jT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=VT.bind(null,e),e}class Fl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=cu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return HE(this.persistence,new $E,e.initialUser,this.serializer)}Ga(e){return new zE(Wh.Zr,this.serializer)}Wa(e){return new JE}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Fl.provider={build:()=>new Fl};class Cd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Mm(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=LT.bind(null,this.syncEngine),await vT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new _T}()}createDatastore(e){const n=cu(e.databaseInfo.databaseId),r=function(i){return new nT(i)}(e.databaseInfo);return function(i,a,l,u){return new iT(i,a,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,a,l){return new aT(r,s,i,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Mm(this.syncEngine,n,0),function(){return bm.D()?new bm:new ZE}())}createSyncEngine(e,n){return function(s,i,a,l,u,h,p){const g=new AT(s,i,a,l,u,h);return p&&(g.Qa=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=he(s);ie("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await ea(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Cd.provider={build:()=>new Cd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):or("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=zt.UNAUTHENTICATED,this.clientId=A0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{ie("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(ie("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Xh(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function lc(t,e){t.asyncQueue.verifyOperationInProgress(),ie("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await iv(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Om(t,e){t.asyncQueue.verifyOperationInProgress();const n=await BT(t);ie("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Dm(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Dm(e.remoteStore,s)),t._onlineComponents=e}async function BT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ie("FirestoreClient","Using user provided OfflineComponentProvider");try{await lc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Mo("Error using user provided cache. Falling back to memory cache: "+n),await lc(t,new Fl)}}else ie("FirestoreClient","Using default OfflineComponentProvider"),await lc(t,new Fl);return t._offlineComponents}async function Cv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ie("FirestoreClient","Using user provided OnlineComponentProvider"),await Om(t,t._uninitializedComponentsProvider._online)):(ie("FirestoreClient","Using default OnlineComponentProvider"),await Om(t,new Cd))),t._onlineComponents}function UT(t){return Cv(t).then(e=>e.syncEngine)}async function kv(t){const e=await Cv(t),n=e.eventManager;return n.onListen=CT.bind(null,e.syncEngine),n.onUnlisten=PT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=kT.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=bT.bind(null,e.syncEngine),n}function $T(t,e,n={}){const r=new Zn;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,h){const p=new Av({next:y=>{p.Za(),a.enqueueAndForget(()=>gv(i,g));const T=y.docs.has(l);!T&&y.fromCache?h.reject(new te(z.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&y.fromCache&&u&&u.source==="server"?h.reject(new te(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(y)},error:y=>h.reject(y)}),g=new yv(Lh(l.path),p,{includeMetadataChanges:!0,_a:!0});return mv(i,g)}(await kv(t),t.asyncQueue,e,n,r)),r.promise}function WT(t,e,n={}){const r=new Zn;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,l,u,h){const p=new Av({next:y=>{p.Za(),a.enqueueAndForget(()=>gv(i,g)),y.fromCache&&u.source==="server"?h.reject(new te(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(y)},error:y=>h.reject(y)}),g=new yv(l,p,{includeMetadataChanges:!0,_a:!0});return mv(i,g)}(await kv(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(t,e,n){if(!n)throw new te(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function HT(t,e,n,r){if(e===!0&&r===!0)throw new te(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function zm(t){if(!ae.isDocumentKey(t))throw new te(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Bm(t){if(ae.isDocumentKey(t))throw new te(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function fu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ce()}function Un(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new te(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=fu(t);throw new te(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new te(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}HT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Rv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new te(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new te(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new te(z.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ef{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Um({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Um(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new uS;switch(r.type){case"firstParty":return new hS(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new te(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Fm.get(n);r&&(ie("ComponentProvider","Removing Datastore"),Fm.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ki(this.firestore,e,this._query)}}class Vt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vt(this.firestore,e,this._key)}}class Mr extends ki{constructor(e,n,r){super(e,n,Lh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vt(this.firestore,null,new ae(e))}withConverter(e){return new Mr(this.firestore,e,this._path)}}function Qn(t,e,...n){if(t=kn(t),Pv("collection","path",e),t instanceof ef){const r=Oe.fromString(e,...n);return Bm(r),new Mr(t,null,r)}{if(!(t instanceof Vt||t instanceof Mr))throw new te(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Oe.fromString(e,...n));return Bm(r),new Mr(t.firestore,null,r)}}function Nt(t,e,...n){if(t=kn(t),arguments.length===1&&(e=A0.newId()),Pv("doc","path",e),t instanceof ef){const r=Oe.fromString(e,...n);return zm(r),new Vt(t,null,new ae(r))}{if(!(t instanceof Vt||t instanceof Mr))throw new te(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Oe.fromString(e,...n));return zm(r),new Vt(t.firestore,t instanceof Mr?t.converter:null,new ae(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new av(this,"async_queue_retry"),this.Vu=()=>{const r=ac();r&&ie("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=ac();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=ac();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Zn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Yo(e))throw e;ie("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(r);throw or("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=Yh.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&ce()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Ss extends ef{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new $m,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $m(e),this._firestoreClient=void 0,await e}}}function qT(t,e,n){n||(n="(default)");const r=g0(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(bl(i,e))return s;throw new te(z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new te(z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function tf(t){if(t._terminated)throw new te(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||GT(t),t._firestoreClient}function GT(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,h,p){return new IS(l,u,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Rv(p.experimentalLongPollingOptions),p.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new zT(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _i(vt.fromBase64String(e))}catch(n){throw new te(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new _i(vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new te(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new te(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new te(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QT=/^__.*__$/;class KT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Hr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Jo(e,this.data,n,this.fieldTransforms)}}class bv{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Hr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Dv(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ce()}}class sf{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new sf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return zl(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Dv(this.Cu)&&QT.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class YT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||cu(e)}Qu(e,n,r,s=!1){return new sf({Cu:e,methodName:n,qu:r,path:pt.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gu(t){const e=t._freezeSettings(),n=cu(t._databaseId);return new YT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Nv(t,e,n,r,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);af("Data must be an object, but it was:",a,r);const l=jv(r,a);let u,h;if(i.merge)u=new rn(a.fieldMask),h=a.fieldTransforms;else if(i.mergeFields){const p=[];for(const g of i.mergeFields){const y=kd(e,g,n);if(!a.contains(y))throw new te(z.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Mv(p,y)||p.push(y)}u=new rn(p),h=a.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=a.fieldTransforms;return new KT(new Ut(l),u,h)}class yu extends mu{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof yu}}class of extends mu{_toFieldTransform(e){return new YS(e.path,new Bo)}isEqual(e){return e instanceof of}}function XT(t,e,n,r){const s=t.Qu(1,e,n);af("Data must be an object, but it was:",s,r);const i=[],a=Ut.empty();_s(r,(u,h)=>{const p=lf(e,u,n);h=kn(h);const g=s.Nu(p);if(h instanceof yu)i.push(p);else{const y=na(h,g);y!=null&&(i.push(p),a.set(p,y))}});const l=new rn(i);return new bv(a,l,s.fieldTransforms)}function JT(t,e,n,r,s,i){const a=t.Qu(1,e,n),l=[kd(e,r,n)],u=[s];if(i.length%2!=0)throw new te(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)l.push(kd(e,i[y])),u.push(i[y+1]);const h=[],p=Ut.empty();for(let y=l.length-1;y>=0;--y)if(!Mv(h,l[y])){const T=l[y];let C=u[y];C=kn(C);const b=a.Nu(T);if(C instanceof yu)h.push(T);else{const O=na(C,b);O!=null&&(h.push(T),p.set(T,O))}}const g=new rn(h);return new bv(p,g,a.fieldTransforms)}function ZT(t,e,n,r=!1){return na(n,t.Qu(r?4:3,e))}function na(t,e){if(Vv(t=kn(t)))return af("Unsupported field value:",e,t),jv(t,e);if(t instanceof mu)return function(r,s){if(!Dv(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const l of r){let u=na(l,s.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),a++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=kn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return GS(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=at.fromDate(r);return{timestampValue:Ll(s.serializer,i)}}if(r instanceof at){const i=new at(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ll(s.serializer,i)}}if(r instanceof nf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof _i)return{bytesValue:J0(s.serializer,r._byteString)};if(r instanceof Vt){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Uh(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof rf)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return Oh(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${fu(r)}`)}(t,e)}function jv(t,e){const n={};return C0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):_s(t,(r,s)=>{const i=na(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Vv(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof at||t instanceof nf||t instanceof _i||t instanceof Vt||t instanceof mu||t instanceof rf)}function af(t,e,n){if(!Vv(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=fu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function kd(t,e,n){if((e=kn(e))instanceof pu)return e._internalPath;if(typeof e=="string")return lf(t,e);throw zl("Field path arguments must be of type string or ",t,!1,void 0,n)}const eI=new RegExp("[~\\*/\\[\\]]");function lf(t,e,n){if(e.search(eI)>=0)throw zl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new pu(...e.split("."))._internalPath}catch{throw zl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function zl(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new te(z.INVALID_ARGUMENT,l+t+u)}function Mv(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Vt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new tI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(uf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class tI extends Lv{data(){return super.data()}}function uf(t,e){return typeof e=="string"?lf(t,e):e instanceof pu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new te(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cf{}class rI extends cf{}function to(t,e,...n){let r=[];e instanceof cf&&r.push(e),r=r.concat(n),function(i){const a=i.filter(u=>u instanceof df).length,l=i.filter(u=>u instanceof vu).length;if(a>1||a>0&&l>0)throw new te(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class vu extends rI{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new vu(e,n,r)}_apply(e){const n=this._parse(e);return Ov(e._query,n),new ki(e.firestore,e.converter,vd(e._query,n))}_parse(e){const n=gu(e.firestore);return function(i,a,l,u,h,p,g){let y;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new te(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Hm(g,p);const T=[];for(const C of g)T.push(Wm(u,i,C));y={arrayValue:{values:T}}}else y=Wm(u,i,g)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Hm(g,p),y=ZT(l,a,g,p==="in"||p==="not-in");return nt.create(h,p,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Rd(t,e,n){const r=e,s=uf("where",t);return vu._create(s,r,n)}class df extends cf{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new df(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Rn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let a=s;const l=i.getFlattenedFilters();for(const u of l)Ov(a,u),a=vd(a,u)}(e._query,n),new ki(e.firestore,e.converter,vd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Wm(t,e,n){if(typeof(n=kn(n))=="string"){if(n==="")throw new te(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!M0(e)&&n.indexOf("/")!==-1)throw new te(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Oe.fromString(n));if(!ae.isDocumentKey(r))throw new te(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return hm(t,new ae(r))}if(n instanceof Vt)return hm(t,n._key);throw new te(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${fu(n)}.`)}function Hm(t,e){if(!Array.isArray(t)||t.length===0)throw new te(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ov(t,e){const n=function(s,i){for(const a of s)for(const l of a.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new te(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new te(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class sI{convertValue(e,n="none"){switch(ys(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Je(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(gs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ce()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return _s(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>Je(a.doubleValue));return new rf(i)}convertGeoPoint(e){return new nf(Je(e.latitude),Je(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Nh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Oo(e));default:return null}}convertTimestamp(e){const n=zr(e);return new at(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Oe.fromString(e);Ce(sv(r));const s=new Fo(r.get(1),r.get(3)),i=new ae(r.popFirst(5));return s.isEqual(n)||or(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fv(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class zv extends Lv{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ol(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(uf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class ol extends zv{data(e={}){return super.data(e)}}class iI{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new no(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new ol(this._firestore,this._userDataWriter,r.key,r,new no(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new te(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const u=new ol(s._firestore,s._userDataWriter,l.doc.key,l.doc,new no(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new ol(s._firestore,s._userDataWriter,l.doc.key,l.doc,new no(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,p=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:oI(l.type),doc:u,oldIndex:h,newIndex:p}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function oI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ce()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(t){t=Un(t,Vt);const e=Un(t.firestore,Ss);return $T(tf(e),t._key).then(n=>aI(e,t,n))}class Bv extends sI{constructor(e){super(),this.firestore=e}convertBytes(e){return new _i(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Vt(this.firestore,null,n)}}function Bs(t){t=Un(t,ki);const e=Un(t.firestore,Ss),n=tf(e),r=new Bv(e);return nI(t._query),WT(n,t._query).then(s=>new iI(e,r,t,s))}function Uv(t,e,n){t=Un(t,Vt);const r=Un(t.firestore,Ss),s=Fv(t.converter,e);return xu(r,[Nv(gu(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,mn.none())])}function Kn(t,e,n,...r){t=Un(t,Vt);const s=Un(t.firestore,Ss),i=gu(s);let a;return a=typeof(e=kn(e))=="string"||e instanceof pu?JT(i,"updateDoc",t._key,e,n,r):XT(i,"updateDoc",t._key,e),xu(s,[a.toMutation(t._key,mn.exists(!0))])}function uc(t){return xu(Un(t.firestore,Ss),[new Fh(t._key,mn.none())])}function ff(t,e){const n=Un(t.firestore,Ss),r=Nt(t),s=Fv(t.converter,e);return xu(n,[Nv(gu(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,mn.exists(!1))]).then(()=>r)}function xu(t,e){return function(r,s){const i=new Zn;return r.asyncQueue.enqueueAndForget(async()=>DT(await UT(r),s,i)),i.promise}(tf(t),e)}function aI(t,e,n){const r=n.docs.get(e._key),s=new Bv(t);return new zv(t,s,e._key,r,new no(n.hasPendingWrites,n.fromCache),e.converter)}function fn(){return new of("serverTimestamp")}(function(e,n=!0){(function(s){Ii=s})(Kw),jo(new pi("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),l=new Ss(new cS(r.getProvider("auth-internal")),new pS(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new te(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fo(h.options.projectId,p)}(a,s),a);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Vr(am,"4.7.3",e),Vr(am,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd="us-central1";class uI{constructor(e,n,r,s,i=Pd,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new lI(n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Pd}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function cI(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}const qm="@firebase/functions",Gm="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI="auth-internal",hI="app-check-internal",fI="messaging-internal";function pI(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),a=r.getProvider(dI),l=r.getProvider(fI),u=r.getProvider(hI);return new uI(i,a,l,u,s,t)};jo(new pi($v,n,"PUBLIC").setMultipleInstances(!0)),Vr(qm,Gm,e),Vr(qm,Gm,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mI(t=Yw(),e=Pd){const r=g0(kn(t),$v).getImmediate({identifier:e}),s=B1("functions");return s&&gI(r,...s),r}function gI(t,e,n){cI(kn(t),e,n)}pI(fetch.bind(self));const yI={apiKey:'"AIzaSyDRdl4zhwoZumVtphmJ19orZ8HoR0WQQZM",',authDomain:'"qualtrics-game-backend.firebaseapp.com",',projectId:'"qualtrics-game-backend",',storageBucket:'"qualtrics-game-backend.firebasestorage.app",',messagingSenderId:'"441267092549",',appId:"1:441267092549:web:6ce075f5f3ea7cf958772c"},Wv=y0(yI),$e=qT(Wv,{experimentalForceLongPolling:!1,useFetchStreams:!1});mI(Wv);const Le={init(){localStorage.getItem("sessionId")||(localStorage.setItem("sessionId",this.generateSessionId()),localStorage.setItem("sessionStartTime",Date.now().toString())),localStorage.getItem("semesterStartTime")||localStorage.setItem("semesterStartTime",Date.now().toString())},generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},async logEvent(t,e){const n=localStorage.getItem("sessionId")||this.generateSessionId(),r=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),s=Date.now(),i=s-r,a=(i/1e3).toFixed(1),l=Math.floor(i/6e4),u=Math.floor(i%6e4/1e3),h=`${l}:${u.toString().padStart(2,"0")}`,p=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),g=this.getFullGameContext(),y={sessionId:n,studentId:p.studentId||null,type:t,timestamp:new Date().toISOString(),clientTimestamp:s,timeElapsedSeconds:parseFloat(a),readableTime:h,semesterTime:this.getSemesterTime(),...g,isAdminMode:p.role==="admin",hasCheckpoint:p.checkpointSemester2||!1,hasAI:p.hasAI||!1,section:p.section||null,...this.convertTimesToSeconds(e)};(t==="user_action"||t==="task_attempt")&&console.log(`DEBUG: Event ${t} - studentId: ${y.studentId}, role: ${p.role}`);try{await ff(Qn($e,"events"),y)}catch(T){console.error("Failed to log event:",T),this.storeOfflineEvent(y)}},convertTimesToSeconds(t){const e={...t},n=["timeTaken","timeSpent","totalTime","timeOnPreviousPage","averageTime","timeBetweenHelpAndSubmit"];for(const r of n)e[r]!==void 0&&e[r]!==null&&(e[`${r}Seconds`]=(e[r]/1e3).toFixed(1),delete e[r]);return e.timeProgression&&(e.timeProgressionSeconds=e.timeProgression.map(r=>(r/1e3).toFixed(1)),delete e.timeProgression),e.timePerAttempt&&(e.timePerAttemptSeconds=e.timePerAttempt.map(r=>(r/1e3).toFixed(1)),delete e.timePerAttempt),e},getSemesterTime(){const t=parseInt(localStorage.getItem("semesterStartTime")||Date.now()),e=Date.now()-t,n=(e/1e3).toFixed(1),r=Math.floor(e/6e4),s=Math.floor(e%6e4/1e3);return{elapsedSeconds:parseFloat(n),readable:`${r}:${s.toString().padStart(2,"0")}`,minutes:r,seconds:s}},getCurrentContext(){const t=parseInt(localStorage.getItem("sessionStartTime")||Date.now()),e=((Date.now()-t)/1e3).toFixed(1);return{currentTask:localStorage.getItem("currentTask"),gameMode:localStorage.getItem("gameMode"),totalCompleted:this.getCompletedTaskCount(),currentStreak:this.getCurrentStreak(),sessionDurationSeconds:parseFloat(e)}},getFullGameContext(){const t=localStorage.getItem("currentTask")||"",e=localStorage.getItem("gameMode")||"",n=parseInt(localStorage.getItem("currentSemester")||"1"),r=parseInt(localStorage.getItem("totalSemesters")||"2"),s=localStorage.getItem("practiceCompleted")==="true",i=parseInt(localStorage.getItem("completedTasksCount")||"0"),a=parseInt(localStorage.getItem("completedLevels")||"0"),l=parseInt(localStorage.getItem("totalSwitches")||"0"),u=parseInt(localStorage.getItem("aiUsageCount")||"0"),h=JSON.parse(localStorage.getItem("categoryPoints")||"{}"),p=parseFloat(localStorage.getItem("studentLearningScore")||"0");return{currentTask:t,gameMode:e,currentSemester:n,totalSemesters:r,practiceCompleted:s,completedTasks:i,completedLevels:a,totalSwitches:l,aiUsageCount:u,studentLearning:p,totalBonus:h.bonus||0,finalScore:Math.round(p)+(h.bonus||0),semester:n}},calculateImprovementTrend(t){if(!t||t.length<3)return"needs_more_data";const n=t.slice(-5).map(s=>s.accuracy),r=this.calculateTrend(n);return r>5?"rapid_improvement":r>2?"steady_improvement":r>0?"slight_improvement":r>-2?"stable":r>-5?"slight_decline":"rapid_decline"},calculateImprovementRate(t){if(!t||t.length<2)return{overall:0,trend:0,isImproving:!1,dataPoints:t?t.length:0};const e=t[0].accuracy,r=t[t.length-1].accuracy-e;if(t.length<3)return{overall:r,trend:r,isImproving:r>0,dataPoints:t.length};const s=Math.floor(t.length/2),i=t.slice(0,s).reduce((u,h)=>u+h.accuracy,0)/s,l=t.slice(s).reduce((u,h)=>u+h.accuracy,0)/(t.length-s)-i;return{overall:r,trend:l,isImproving:l>0,dataPoints:t.length}},setPageStartTime(t){t&&localStorage.setItem(`pageStartTime_${t}`,Date.now().toString())},getTimeOnCurrentPage(t){if(!t)return 0;const e=localStorage.getItem(`pageStartTime_${t}`);return e?Date.now()-parseInt(e):0},ensureSession(){localStorage.getItem("sessionId")||this.init()},async trackAIHelpResponse(t,e,n,r,s,i){const a=parseInt(localStorage.getItem("aiUsageCount")||"0");return localStorage.setItem("aiUsageCount",(a+1).toString()),this.logEvent("ai_help_response",{taskId:t,helpType:e,suggestion:n,playerAction:r,playerValue:s,timeBetween:i})},async trackTaskAttempt(t,e){return this.logEvent("task_attempt",{taskId:t,...e})},async trackUserAction(t,e){return this.logEvent("user_action",{action:t,response:e.response||"",query:e.query||"",queryType:e.queryType||"",choice:e.choice||"",currentMode:e.currentMode||"",...e})},async syncOfflineEvents(){return console.log("Syncing offline events..."),Promise.resolve()},async trackTaskComplete(t,e){return this.logEvent("task_complete",{taskId:t,...e})},async trackPageSwitch(t,e,n){return this.logEvent("page_switch",{from:t,to:e,isAutoAdvance:n})},trackAITaskHelp(t,e,n,r,s){return this.logEvent("ai_task_help",{taskId:t,taskType:e,suggestion:n,wasCorrect:r,attemptNumber:s})}};Le.init();const er={seedRandom:null,currentSeed:null,initializeSeed(t){this.currentSeed=t;let e=t;this.seedRandom=function(){return e=(e*9301+49297)%233280,e/233280}},getRandom(){return this.seedRandom?this.seedRandom():Math.random()},generateCountingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n;e==="easy"?n=(t-1)%5+1:e==="medium"?n=(t-11)%5+6:n=(t-25)%5+11;const s={easy:{1:{target:"the",type:"word"},2:{target:"and",type:"word"},3:{target:"of",type:"word"},4:{target:"to",type:"word"},5:{target:"in",type:"word"}},medium:{6:{target:"e",type:"letter"},7:{target:"a",type:"letter"},8:{target:"i",type:"letter"},9:{target:"o",type:"letter"},10:{target:"s",type:"letter"}},hard:{11:{targets:["a","e"],type:"multi-letter"},12:{targets:["i","o"],type:"multi-letter"},13:{targets:["s","t"],type:"multi-letter"},14:{targets:["n","r"],type:"multi-letter"},15:{targets:["l","d"],type:"multi-letter"}}}[e][n];let i="";return s.type==="word"?i=`Count how many times the word "${s.target}" appears:`:s.type==="letter"?i=`Count how many times the letter "${s.target}" appears (case-insensitive):`:i=`Count how many times the letters "${s.targets[0]}" and "${s.targets[1]}" appear in total:`,{...s,instruction:i,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},generateSliderPattern(t){const e=t<=10?"easy":t<25?"medium":"hard";let n,r,s;return e==="easy"?(n=Math.floor(this.getRandom()*11),r=1,s=!0):e==="medium"?(n=Math.round(this.getRandom()*10*10)/10,r=.1,s=!0):(n=Math.round(this.getRandom()*10*100)/100,r=.01,s=(t-25)%5!==0),{target:n,step:r,showValue:s,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1),precision:e==="easy"?0:e==="medium"?1:2}},generateTypingPattern(t){const e=t<=10?"easy":t<25?"medium":"hard",n={easy:["hello world","quick test","type this","easy mode","simple text","good job","keep going","nice work","almost done","level up"],medium:["HeLLo WoRLd","QuIcK tEsT","TyPe ThIs","MeDiUm MoDe","MiXeD cAsE","KeEp GoInG","NiCe WoRk","AlMoSt DoNe","LeVeL uP","ChAlLeNgE","TeSt RuN","NeXt LeVeL","TrY aGaIn","GoOd LuCk","FiNaL tEsT"],hard:["Test@123","Go4It!Now","X9%Y8&Z7*","P6!Q5?R4+","Z1@Y2#X3$","M7&N8*O9!","J4%K5^L6&","D1!E2@F3#","A7$B8%C9^","V3*W4+X5=","Q2#R3$S4%","H5^I6&J7*","K8(L9)M0!","N1@O2#P3$","T4%U5^V6&","W7*X8(Y9)","C0!D1@E2#","F3$G4%H5^","I6&J7*K8(","L9)M0!N1@","O2#P3$Q4%","R5^S6&T7*","U8(V9)W0!","X1@Y2#Z3$","A4%B5^C6&"]};let r;if(e==="easy"){const s=(t-1)%n.easy.length;r=n.easy[s]}else if(e==="medium"){const s=(t-11)%n.medium.length;r=n.medium[s]}else{const s=(t-25)%n.hard.length;r=n.hard[s]}return{pattern:r,difficulty:e,difficultyLabel:e.charAt(0).toUpperCase()+e.slice(1)}},textPassages:["The University of California, Berkeley (UC Berkeley, Berkeley, Cal, or California) is a public land-grant research university in Berkeley, California, United States. Founded in 1868 and named after the Anglo-Irish philosopher George Berkeley, it is the state's first land-grant university and is the founding campus of the University of California system.","Berkeley has an enrollment of more than 45,000 students. The university is organized around fifteen schools of study on the same campus, including the College of Chemistry, the College of Engineering, College of Letters and Science, and the Haas School of Business.",'The Berkeley campus encompasses approximately 1,232 acres, though the "central campus" occupies only the low-lying western 178 acres. The campus contains numerous wooded areas, including the Eucalyptus Grove and Strawberry Creek, which runs through the center of campus.',"Oski the Bear (Oski) is the official mascot of the University of California, Berkeley, representing the California Golden Bears. Named after the Oski Yell, he made his debut at a freshman rally in the Greek Theatre on September 25, 1941.","Berkeley faculty, alumni, and researchers have won 111 Nobel laureates, 25 Turing Award winners, and 19 Academy Award winners. The university has produced many notable alumni in various fields including science, politics, business, and entertainment.","The university's athletic teams compete as the California Golden Bears and are members of the Atlantic Coast Conference for most sports. Berkeley teams have won 107 national championships, including 45 NCAA national championships.","Research at Berkeley is conducted within departments, organized research units, and interdisciplinary research centers. Berkeley operates Lawrence Berkeley National Laboratory, manages Los Alamos National Laboratory, and is a founding partner of the Space Sciences Laboratory.","The Berkeley campus offers over 350 degree programs through its 14 colleges and schools. Popular majors include Computer Science, Economics, Political Science, and Business Administration. The student-faculty ratio is 17:1.","Berkeley's libraries contain more than 13 million volumes and maintain special collections including the Mark Twain Papers, the Oral History Center, and the Bancroft Library, which houses the largest collection of materials on California history.","The campus is home to several museums including the Berkeley Art Museum and Pacific Film Archive, the Lawrence Hall of Science, and the UC Botanical Garden. These facilities serve both educational and public outreach purposes.","Notable Berkeley inventions and discoveries include the cyclotron, the atomic bomb, the flu vaccine, and vitamin E. Berkeley researchers discovered 16 chemical elements of the periodic table, more than any other university.","The Free Speech Movement, which took place during the 1964-65 academic year, was a pivotal moment in the history of civil liberties in the United States. It began when students protested a ban on political activities on campus.","Berkeley's Campanile, known as Sather Tower, is the third-tallest clock tower in the world at 307 feet. It was completed in 1914 and is visible for miles, serving as a symbol of the university.","The university operates on a semester system, with fall semester beginning in late August and spring semester beginning in mid-January. Berkeley offers over 5,000 courses each semester across all disciplines.",`Cal Bears have won at least one team national title in 13 different sports. The university's traditional rival is Stanford University, with the annual football game known as "The Big Game" dating back to 1892.`],getTextPassage(t){if(this.seedRandom){const e=Math.floor(this.getRandom()*this.textPassages.length),n=(t-1+e)%this.textPassages.length;return this.textPassages[n]}else{const e=(t-1)%this.textPassages.length;return this.textPassages[e]}}};function bd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=j.useState(""),[a,l]=j.useState(""),[u,h]=j.useState(null),[p,g]=j.useState(""),[y,T]=j.useState(null),[C,b]=j.useState(""),[O,A]=j.useState(""),[S]=j.useState(Date.now()),[R,M]=j.useState(""),[B,L]=j.useState(!1),[w,m]=j.useState(new Set),_=j.useRef(0);j.useRef(null);const E=(Q,K=null,F=null)=>{const x=document.createElement("canvas"),N=x.getContext("2d");x.width=900,x.height=400,N.fillStyle="#fafafa",N.fillRect(0,0,x.width,x.height),N.strokeStyle="#e0e0e0",N.lineWidth=2,N.strokeRect(0,0,x.width,x.height),N.font="24px monospace",N.fillStyle="#333";const U=36,J=25,ee=x.width-J*2;return((fe,pe)=>{const Z=fe.split(" "),oe=[];let ve="";for(let ne of Z){const be=ve+(ve?" ":"")+ne;N.measureText(be).width>pe&&ve?(oe.push(ve),ve=ne):ve=be}return ve&&oe.push(ve),oe})(Q,ee).forEach((fe,pe)=>{const Z=J+(pe+1)*U;let oe=J;if(t<=5){const ve=fe.split(" ");let ne=0;ve.forEach(be=>{const Be=F&&F.has(ne),De=K&&K.some(xt=>be.toLowerCase()===xt.toLowerCase());if(Be){const xt=N.measureText(be).width;N.fillStyle="yellow",N.fillRect(oe-2,Z-18,xt+4,24)}else if(De){const xt=N.measureText(be).width;N.fillStyle="rgba(255, 215, 0, 0.4)",N.fillRect(oe-2,Z-18,xt+4,24)}N.fillStyle="#333",N.fillText(be,oe,Z),oe+=N.measureText(be+" ").width,ne++})}else for(let ve=0;ve<fe.length;ve++){const ne=fe[ve],be=N.measureText(ne).width;K&&K.some(De=>ne.toLowerCase()===De.toLowerCase())&&(N.fillStyle="rgba(255, 215, 0, 0.4)",N.fillRect(oe-1,Z-18,be+2,24)),N.fillStyle="#333",N.fillText(ne,oe,Z),oe+=be}}),x.toDataURL()};j.useEffect(()=>{g(0),T(null),_.current=0},[t]),j.useEffect(()=>{const Q=async(F,x)=>{const N=document.createElement("canvas"),U=N.getContext("2d");N.width=900,N.height=350,U.fillStyle="#fafafa",U.fillRect(0,0,N.width,N.height),U.strokeStyle="#e0e0e0",U.lineWidth=2,U.strokeRect(0,0,N.width,N.height),U.font="24px monospace";const J=36,ee=20,le=N.width-ee*2,fe=((pe,Z)=>{const oe=pe.split(" "),ve=[];let ne="";for(let be of oe){const Be=ne+(ne?" ":"")+be;U.measureText(Be).width>Z&&ne?(ve.push(ne),ne=be):ne=Be}return ne&&ve.push(ne),ve})(C,le);for(let pe=0;pe<F.length;pe++)F[pe],fe.forEach((Z,oe)=>{const ve=ee+(oe+1)*J;let ne=ee;for(let be=0;be<Z.length;be++){const Be=Z[be],De=U.measureText(Be).width;F.some(Gt=>Be.toLowerCase()===Gt.toLowerCase())&&(U.fillStyle="rgba(255, 255, 0, 0.6)",U.fillRect(ne-1,ve-20,De+2,26)),U.fillStyle="#333",U.fillText(Be,ne,ve),ne+=De}}),M(N.toDataURL()),await new Promise(Z=>setTimeout(Z,300));setTimeout(()=>{g(x.toString())},300)},K=async F=>{const{action:x,highlightWords:N,suggestedCount:U,animate:J,isMultiLetter:ee,targetLetters:le}=F.detail||{};if(x==="highlightAndCount"){if(ee&&Array.isArray(le)){J&&await Q(le,U);return}if(Array.isArray(N)&&J){C.split(" ");let me=[];for(let fe=0;fe<N.length;fe++){me.push(N[fe]);const pe=document.createElement("canvas"),Z=pe.getContext("2d");pe.width=900,pe.height=350,Z.fillStyle="#fafafa",Z.fillRect(0,0,pe.width,pe.height),Z.strokeStyle="#e0e0e0",Z.lineWidth=2,Z.strokeRect(0,0,pe.width,pe.height),Z.font="24px monospace";const oe=36,ve=20,ne=pe.width-ve*2;((De,xt)=>{const Gt=De.split(" "),Qt=[];let Kt="";for(let Yt of Gt){const ur=Kt+(Kt?" ":"")+Yt;Z.measureText(ur).width>xt&&Kt?(Qt.push(Kt),Kt=Yt):Kt=ur}return Kt&&Qt.push(Kt),Qt})(C,ne).forEach((De,xt)=>{const Gt=ve+(xt+1)*oe;let Qt=ve;De.split(" ").forEach(Yt=>{const ur=Z.measureText(Yt).width;me.some(Pn=>{const dr=Yt.replace(/[.,;!?]/g,"").toLowerCase(),Ne=Pn.replace(/[.,;!?]/g,"").toLowerCase();return dr===Ne})&&(Z.fillStyle="rgba(255, 255, 0, 0.5)",Z.fillRect(Qt-2,Gt-18,ur+4,24)),Z.fillStyle="#333",Z.fillText(Yt,Qt,Gt),Qt+=Z.measureText(Yt+" ").width})}),M(pe.toDataURL()),await new Promise(De=>setTimeout(De,200))}setTimeout(()=>{g(U.toString())},300)}}};return window.addEventListener("aiCountingHelp",K),()=>window.removeEventListener("aiCountingHelp",K)},[C,t]),j.useEffect(()=>{var N;const Q=er.generateCountingPattern(t),K=er.getTextPassage(t);b(K),i(Q.target||((N=Q.targets)==null?void 0:N.join(", "))),l(Q.instruction);let F=0;if(Q.type==="word"){const U=new RegExp(`\\b${Q.target}\\b`,"gi"),J=K.match(U);F=J?J.length:0}else if(Q.type==="letter"){const U=new RegExp(Q.target,"gi"),J=K.match(U);F=J?J.length:0}else Q.type==="multi-letter"&&Q.targets.forEach(U=>{const J=new RegExp(U,"gi"),ee=K.match(J);F+=ee?ee.length:0});h(F);const x=E(K,null);M(x)},[t]);const k=async()=>{const Q=Date.now()-S,K=parseInt(p,10)||0,F=u??0,x=Math.abs(K-F),N=`g1t${t}`,U=localStorage.getItem(`lastAIHelp_${N}`);if(U){const le=JSON.parse(U),me=Date.now()-le.timestamp,fe=K===le.suggestion?"accepted":"modified";await Le.trackAIHelpResponse(N,le.type,le.suggestion,fe,K,me),localStorage.removeItem(`lastAIHelp_${N}`)}let J=0;x===0?J=2:x<=1?J=1:J=0,_.current+=1,await Le.trackTaskAttempt(N,_.current,!0,Q,K,F);const ee=localStorage.getItem("sessionId");if(ee&&!ee.startsWith("offline-"))try{await Kn(Nt($e,"sessions",ee),{[`taskAccuracies.g1t${t}`]:J===2?100:J===1?70:0,[`taskTimes.g1t${t}`]:Q,[`taskPoints.g1t${t}`]:J,lastActivity:fn()})}catch(le){console.error("Error storing accuracy:",le)}T(J===2?" Perfect! 2 points earned!":J===1?` Off by ${x} - 1 point earned!`:` Off by ${x} - 0 points earned.`),setTimeout(()=>{e==null||e(`g1t${t}`,{attempts:_.current,totalTime:Q,accuracy:J===2?100:J===1?70:0,userAnswer:K,correctAnswer:F,points:J})},500)},I=er.generateCountingPattern(t).difficultyLabel,H=t<=5?"easy":t<=10?"medium":"hard";return c.jsxs("div",{className:"task counting",children:[c.jsxs("h3",{children:["Research Content - Level ",t]}),c.jsx("div",{className:`difficulty-badge ${H}`,children:I}),c.jsxs("p",{className:"instruction",children:[c.jsx("strong",{children:a}),c.jsx("br",{}),c.jsx("span",{className:"hint",children:"(Case-insensitive)"})]}),c.jsxs("div",{className:"text-display text-to-count","data-counting-text":C,children:[c.jsx("div",{className:"count-target","data-pattern":s,style:{display:"none"},children:s}),R?c.jsx("img",{src:R,alt:"Text passage for counting",style:{width:"100%",maxWidth:"900px",height:"auto",maxHeight:"350px",objectFit:"contain",border:"none",userSelect:"none",pointerEvents:"none"},onContextMenu:Q=>Q.preventDefault(),draggable:!1}):c.jsx("div",{dangerouslySetInnerHTML:{__html:O}})]}),c.jsxs("div",{className:"input-section",children:[c.jsx("label",{children:"Your answer:"}),c.jsx("input",{type:"number",min:"0",max:"999",value:p,onChange:Q=>g(Q.target.value),onKeyPress:Q=>{Q.key==="Enter"&&k()},placeholder:"Enter count"})]}),c.jsx("button",{onClick:k,className:"submit-btn",style:{display:"block",margin:"20px auto 0"},children:"Submit"}),y&&c.jsx("div",{className:`feedback ${y.includes("2 points")?"correct":y.includes("0 points")?"incorrect":"partial"}`,children:y})]})}function Dd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=j.useState(5),[a,l]=j.useState(0),[u,h]=j.useState(null),[p]=j.useState(Date.now()),[g,y]=j.useState(1),[T,C]=j.useState(!0),[b,O]=j.useState(!1),[A,S]=j.useState(!1),[R,M]=j.useState(!1),[B,L]=j.useState(!1),w=j.useRef(null),m=j.useRef(0);j.useEffect(()=>{if(n)i(3),y(1),C(!0);else{const F=er.generateSliderPattern(t);i(F.target),y(F.step),C(F.showValue)}l(0),h(null),m.current=0},[t,n]),j.useEffect(()=>{const F=x=>{const{action:N,value:U,animate:J}=x.detail;if(N==="moveSlider")if(S(!0),J){const ee=parseFloat(a),le=parseFloat(U),me=1e3,fe=30;let pe=0;const Z=setInterval(()=>{pe++;const oe=pe/fe,ve=1-Math.pow(1-oe,3),ne=ee+(le-ee)*ve;l(parseFloat(ne.toFixed(2))),pe>=fe&&(clearInterval(Z),S(!1),l(parseFloat(le.toFixed(2))))},me/fe)}else l(parseFloat(U.toFixed(2))),S(!1)};return window.addEventListener("aiSliderHelp",F),()=>window.removeEventListener("aiSliderHelp",F)},[a]),j.useEffect(()=>{const F=x=>{x.key==="Enter"&&!A&&P()};return document.addEventListener("keypress",F),()=>document.removeEventListener("keypress",F)},[A,a,s]);const _=F=>{if(A)return;const x=w.current;if(!x)return;F.preventDefault();const N=x.getBoundingClientRect(),U=a/10,J=N.left+N.width*U,ee=F.clientX||F.touches&&F.touches[0].clientX;Math.abs(ee-J)<30&&(M(!0),L(!0))},E=F=>{if(!R||A)return;const x=w.current;if(!x)return;const N=x.getBoundingClientRect(),U=F.clientX||F.touches&&F.touches[0].clientX,ee=Math.max(0,Math.min(1,(U-N.left)/N.width))*10,le=Math.round(ee/g)*g;l(parseFloat(le.toFixed(2)))},k=()=>{M(!1)};j.useEffect(()=>{if(R){const F=N=>E(N),x=()=>k();return document.addEventListener("mousemove",F),document.addEventListener("mouseup",x),document.addEventListener("touchmove",F),document.addEventListener("touchend",x),()=>{document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",x),document.removeEventListener("touchmove",F),document.removeEventListener("touchend",x)}}},[R,g,A]);const P=async()=>{const F=Date.now()-p,x=parseFloat(a),N=Math.abs(x-s),U=`g2t${t}`,J=localStorage.getItem(`lastAIHelp_${U}`);if(J){const me=JSON.parse(J),fe=Date.now()-me.timestamp,pe=x===me.suggestion?"accepted":"modified";await Le.trackAIHelpResponse(U,me.type,me.suggestion,pe,x,fe),localStorage.removeItem(`lastAIHelp_${U}`)}let ee=0;N===0?ee=2:N<=1?ee=1:ee=0,m.current+=1,await Le.trackTaskAttempt(U,m.current,!0,F,x,s);const le=localStorage.getItem("sessionId");if(le&&!le.startsWith("offline-"))try{await Kn(Nt($e,"sessions",le),{[`taskDifferences.g2t${t}`]:N,[`taskTimes.g2t${t}`]:F,[`taskPoints.g2t${t}`]:ee,lastActivity:fn()})}catch(me){console.error("Error storing difference:",me)}h(ee===2?" Perfect! 2 points earned!":ee===1?` Off by ${N.toFixed(2)} - 1 point earned!`:` Off by ${N.toFixed(2)} - 0 points earned.`),setTimeout(()=>{e(`g2t${t}`,{attempts:m.current,totalTime:F,accuracy:ee===2?100:ee===1?70:0,userAnswer:x,correctAnswer:s,points:ee})},500)},I=er.generateSliderPattern(t),H=I.difficultyLabel,Q=I.difficulty,K=()=>{const F=[];for(let x=0;x<=10;x++)F.push(c.jsxs("div",{style:{position:"absolute",left:`${x*10}%`,transform:"translateX(-50%)",textAlign:"center"},children:[c.jsx("div",{style:{width:"2px",height:"12px",background:"#666",margin:"0 auto"}}),c.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:x})]},x));return F};return c.jsxs("div",{className:`task slider ${A?"ai-controlled":""}`,children:[c.jsxs("h3",{children:["Material Creation - Level ",t]}),c.jsx("div",{className:`difficulty-badge ${Q}`,children:H}),c.jsxs("p",{className:"instruction",children:["Move the slider to:"," ",c.jsx("strong",{className:"target-value","data-target-value":s,children:s}),c.jsx("br",{}),c.jsx("span",{style:{fontSize:"14px",color:"#666",fontStyle:"italic"},children:!B&&"Hold and drag the slider handle to move it"})]}),c.jsxs("div",{className:"slider-container",children:[c.jsxs("div",{className:"range-labels",children:[c.jsx("span",{children:"0"}),c.jsx("span",{children:"10"})]}),c.jsxs("div",{style:{position:"relative",padding:"20px 0 30px 0"},children:[c.jsx("div",{style:{position:"absolute",width:"100%",height:"20px",top:"0"},children:K()}),c.jsx("div",{style:{position:"relative",marginTop:"20px"},children:c.jsx("input",{ref:w,type:"range",min:"0",max:"10",step:g,value:a,onChange:F=>{!R&&!A&&(l(parseFloat(F.target.value)),L(!0))},className:"slider-input",style:{width:"100%",cursor:R?"grabbing":"grab"},onMouseDown:_,onTouchStart:_})})]}),c.jsx("div",{className:"current-value",children:T?parseFloat(a).toFixed(n?0:I.precision):"??"})]}),c.jsx("button",{onClick:P,className:"submit-btn",disabled:A,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&c.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function Nd({taskNum:t,onComplete:e,isPractice:n=!1,currentTaskId:r}){const[s,i]=j.useState(""),[a,l]=j.useState(""),[u,h]=j.useState(null),[p]=j.useState(Date.now()),[g,y]=j.useState(""),[T,C]=j.useState(!1),b=j.useRef(0),O=B=>{const L=document.createElement("canvas"),w=L.getContext("2d");return L.width=600,L.height=150,w.fillStyle="#f5f5f5",w.fillRect(0,0,L.width,L.height),w.font='bold 40px "Courier New", monospace',w.fillStyle="#333",w.textAlign="center",w.textBaseline="middle",w.fillText(B,L.width/2,L.height/2),L.toDataURL()};j.useEffect(()=>{const L=er.generateTypingPattern(t).pattern;i(L);const w=O(L);y(w)},[t]),j.useEffect(()=>{l(""),h(null),b.current=0},[t]),j.useEffect(()=>{const B=L=>{const{action:w,text:m,typeSpeed:_}=L.detail;if(w==="autoType"&&m){C(!0),l("");let E="",k=0;const P=setInterval(()=>{k<m.length?(E+=m[k],l(E),k++):(clearInterval(P),C(!1))},_||50);return()=>clearInterval(P)}};return window.addEventListener("aiTypingHelp",B),()=>window.removeEventListener("aiTypingHelp",B)},[]);const A=async()=>{const B=Date.now()-p,L=`g3t${t}`,w=localStorage.getItem(`lastAIHelp_${L}`);if(w){const P=JSON.parse(w),I=Date.now()-P.timestamp,H=a===P.suggestion?"accepted":"modified";await Le.trackAIHelpResponse(L,P.type,P.suggestion,H,a,I),localStorage.removeItem(`lastAIHelp_${L}`)}const _=((P,I)=>{const H=P.length,Q=I.length,K=Array(H+1).fill(null).map(()=>Array(Q+1).fill(0));for(let F=0;F<=H;F++)K[F][0]=F;for(let F=0;F<=Q;F++)K[0][F]=F;for(let F=1;F<=H;F++)for(let x=1;x<=Q;x++)P[F-1]===I[x-1]?K[F][x]=K[F-1][x-1]:K[F][x]=Math.min(K[F-1][x]+1,K[F][x-1]+1,K[F-1][x-1]+1);return K[H][Q]})(a,s);let E=0;_===0?E=2:_===1?E=1:E=0,b.current+=1,await Le.trackTaskAttempt(L,b.current,!0,B,a,s);const k=localStorage.getItem("sessionId");if(k&&!k.startsWith("offline-"))try{await Kn(Nt($e,"sessions",k),{[`taskAccuracies.g3t${t}`]:E===2?100:E===1?70:0,[`taskTimes.g3t${t}`]:B,[`taskPoints.g3t${t}`]:E,lastActivity:fn()})}catch(P){console.error("Error storing accuracy:",P)}h(E===2?" Perfect! 2 points earned!":E===1?" 1 typo - 1 point earned!":` ${_} errors - 0 points earned.`),setTimeout(()=>{e(`g3t${t}`,{attempts:b.current,totalTime:B,accuracy:E===2?100:E===1?70:0,userAnswer:a,correctAnswer:s,points:E})},500)},S=er.generateTypingPattern(t),R=S.difficultyLabel,M=S.difficulty;return c.jsxs("div",{className:"task typing",style:{maxWidth:"100%"},children:[c.jsxs("h3",{children:["Student Engagement - Level ",t]}),c.jsx("div",{className:`difficulty-badge ${M}`,children:R}),c.jsx("p",{className:"instruction",children:"Type this pattern exactly:"}),c.jsxs("div",{className:"pattern-display",children:[c.jsx("div",{className:"typing-pattern","data-typing-pattern":s,style:{display:"none"},children:s}),g?c.jsx("img",{src:g,alt:"Pattern to type",style:{width:"100%",maxWidth:"600px",height:"auto",userSelect:"none",pointerEvents:"none"},onContextMenu:B=>B.preventDefault(),draggable:!1}):c.jsx("span",{className:"pattern-text",children:s})]}),c.jsx("div",{className:"input-section",style:{width:"90%",maxWidth:"900px",margin:"20px auto 0"},children:c.jsx("input",{type:"text",inputMode:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,value:a,onChange:B=>!T&&l(B.target.value),onKeyPress:B=>{B.key==="Enter"&&!T&&(B.preventDefault(),A())},placeholder:"Type here...",className:"typing-input",disabled:T,style:{backgroundColor:T?"#e3f2fd":"white",transition:"background-color 0.3s",width:"100%",maxWidth:"100%",fontFamily:'"Courier New", monospace',fontSize:"28px",padding:"12px 14px",border:"2px solid #e0e0e0",borderRadius:"8px",boxSizing:"border-box"}})}),c.jsx("button",{onClick:A,className:"submit-btn",disabled:T,style:{display:"block",margin:"20px auto 0"},children:"Submit"}),u&&c.jsx("div",{className:`feedback ${u.includes("2 points")?"correct":u.includes("0 points")?"incorrect":"partial"}`,children:u})]})}function vI({practiceCompleted:t={},onPracticeComplete:e,onStartMainGame:n,onSelectPractice:r,isAdmin:s=!1}){const[i,a]=j.useState(null),l=(y,T)=>{if(T&&T.points===2){typeof e=="function"&&e(y,T);const C=document.createElement("div");C.className="notification-enter",C.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #4CAF50; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",C.textContent="Perfect! Practice task completed. Returning to menu...",document.body.appendChild(C),setTimeout(()=>{a(null),document.body.contains(C)&&document.body.removeChild(C)},1500)}else{const C=(T==null?void 0:T.points)||0,b=document.createElement("div");b.className="notification-enter",b.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #ff9800; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",b.textContent=`Practice requires 100% accuracy. You scored ${C===1?"50%":"0%"}. Try again!`,document.body.appendChild(b),setTimeout(()=>{document.body.contains(b)&&document.body.removeChild(b)},3e3)}},u=t.g2t1&&t.g1t1&&t.g3t1,h=()=>c.jsxs("div",{className:"practice-menu",children:[c.jsxs("h2",{children:["Practice Mode ",!s&&"(Required)"]}),!s&&c.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",borderRadius:"12px",padding:"16px",marginBottom:"25px",border:"2px solid #f57c00",boxShadow:"0 4px 6px rgba(245, 124, 0, 0.1)",textAlign:"center"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[c.jsx("span",{style:{fontSize:"20px"},children:""}),c.jsx("strong",{style:{color:"#e65100",fontSize:"18px"},children:"100% PERFECT ACCURACY REQUIRED"})]}),c.jsxs("div",{style:{color:"#e65100",fontSize:"14px"},children:["You must score 2/2 points (exact answer) on all three practice tasks to proceed.",c.jsx("br",{}),c.jsx("strong",{children:"No partial credit in practice mode!"})]}),c.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"12px"},children:[c.jsxs("span",{style:{padding:"4px 12px",background:t.g2t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g2t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g2t1?"#4CAF50":"#ffb74d"}`},children:["Materials ",t.g2t1?"":"Required"]}),c.jsxs("span",{style:{padding:"4px 12px",background:t.g1t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g1t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g1t1?"#4CAF50":"#ffb74d"}`},children:["Research ",t.g1t1?"":"Required"]}),c.jsxs("span",{style:{padding:"4px 12px",background:t.g3t1?"#e8f5e9":"white",borderRadius:"20px",fontSize:"13px",color:t.g3t1?"#4CAF50":"#f57c00",fontWeight:"600",border:`1px solid ${t.g3t1?"#4CAF50":"#ffb74d"}`},children:["Engagement ",t.g3t1?"":"Required"]})]})]}),c.jsx("p",{className:"practice-hint",style:{textAlign:"center",fontSize:"16px",color:"#666",marginBottom:"30px"},children:"Try each task type before starting the main challenge. No time pressure!"}),c.jsxs("div",{className:"practice-cards",children:[c.jsxs("div",{className:"practice-card materials",children:[c.jsx("h3",{children:" Materials"}),c.jsx("p",{children:"Hold and drag slider to match target values"}),c.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Base points - directly added to score"}),c.jsx("div",{className:"practice-buttons",children:c.jsx("button",{onClick:()=>{a("g2t1"),r&&r("g2t1")},className:t.g2t1?"completed":"",disabled:!1,children:t.g2t1?" Completed":"Try Materials"})})]}),c.jsxs("div",{className:"practice-card research",children:[c.jsx("h3",{children:" Research"}),c.jsx("p",{children:"Count words or letters in text passages"}),c.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 15% multiplier per point in main game"}),c.jsx("div",{className:"practice-buttons",children:c.jsx("button",{onClick:()=>{a("g1t1"),r&&r("g1t1")},className:t.g1t1?"completed":"",disabled:!1,children:t.g1t1?" Completed":"Try Research"})})]}),c.jsxs("div",{className:"practice-card engagement",children:[c.jsx("h3",{children:" Engagement"}),c.jsx("p",{children:"Type patterns exactly as shown"}),c.jsx("p",{style:{fontSize:"13px",color:"#666",marginTop:"10px"},children:"Worth 0.15% compound interest per point"}),c.jsx("div",{className:"practice-buttons",children:c.jsx("button",{onClick:()=>{a("g3t1"),r&&r("g3t1")},className:t.g3t1?"completed":"",disabled:!1,children:t.g3t1?" Completed":"Try Engagement"})})]})]}),c.jsxs("div",{style:{marginTop:"25px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",textAlign:"center"},children:[c.jsx("h4",{style:{margin:"0 0 10px 0",color:"#333",fontSize:"16px"},children:"Practice Progress:"}),c.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[c.jsxs("div",{style:{padding:"8px 15px",background:t.g2t1?"#4CAF50":"#e0e0e0",color:t.g2t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Materials ",t.g2t1&&""]}),c.jsxs("div",{style:{padding:"8px 15px",background:t.g1t1?"#9C27B0":"#e0e0e0",color:t.g1t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Research ",t.g1t1&&""]}),c.jsxs("div",{style:{padding:"8px 15px",background:t.g3t1?"#f44336":"#e0e0e0",color:t.g3t1?"white":"#666",borderRadius:"20px",fontSize:"14px"},children:["Engagement ",t.g3t1&&""]})]}),c.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#666"},children:[c.jsx("strong",{children:"100% accuracy required"})," to complete each practice task"]})]}),c.jsx("div",{style:{textAlign:"center",marginTop:"30px"},children:c.jsx("button",{className:"start-main-game-btn",onClick:n,style:{opacity:!s&&!u?.5:1,cursor:!s&&!u?"not-allowed":"pointer"},disabled:!s&&!u,children:s?"Start Main Game (Admin)":u?"Start Main Game - You're Ready! ":"Complete Practice First"})})]});if(!i)return h();const p=i[1],g=1;return c.jsxs("div",{className:"practice-container",children:[c.jsx("button",{className:"back-to-menu",onClick:()=>a(null),children:" Back to Practice Menu"}),c.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[c.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),c.jsxs("div",{className:"practice-task-wrapper",children:[p==="1"&&c.jsx(bd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i}),p==="2"&&c.jsx(Dd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i}),p==="3"&&c.jsx(Nd,{taskNum:g,onComplete:l,isPractice:!0,currentTaskId:i})]})]})}class xI{constructor(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={}}getUniversalAttemptNumber(){return this.totalAIUsage}shouldAIBeCorrect(e){let n;return e===1||e===2||e===4||e===5?n=!0:e===3?n=!1:n=Math.random()<.75,n}getTaskUsageCount(e){return this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]}incrementTaskUsage(e,n){this.totalAIUsage++,this.usageCount[n]++,this.taskUsageCount[e]||(this.taskUsageCount[e]=0),this.taskUsageCount[e]++}resetForNewSemester(){this.totalAIUsage=0,this.usageCount={materials:0,research:0,engagement:0},this.taskUsageCount={},console.log(" AI Help usage reset for new semester")}helpWithSlider(e,n){this.incrementTaskUsage(n,"materials");const r=this.getUniversalAttemptNumber();let s;if(this.shouldAIBeCorrect(r))s=e;else if(r===3){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else if(Math.random()<.5){const i=Math.random()<.5?-1:1;s=Math.max(0,Math.min(10,e+i))}else{const i=(Math.random()<.5?-1:1)*(2+Math.random()*2);s=Math.max(0,Math.min(10,e+i))}return{action:"moveSlider",value:s,animate:!0}}helpWithCounting(e,n,r){this.incrementTaskUsage(r,"research");const s=this.getUniversalAttemptNumber(),i=this.shouldAIBeCorrect(s);return n.length===1||n.includes(" and ")||n.includes(",")?this.helpWithLetterCounting(e,n,s,i):this.helpWithWordCounting(e,n,s,i)}helpWithLetterCounting(e,n,r,s){let i=[];n.includes(" and ")||n.includes(",")?i=n.match(/[a-z]/gi)||[]:i=[n];let a=0;i.forEach(h=>{const p=new RegExp(h,"gi"),g=e.match(p);a+=g?g.length:0});let l=a,u=[...i];if(!s){r===3||Math.random()<.5?l=a+1:l=a+Math.floor(Math.random()*3)+2,l=Math.max(0,l);const p="abcdefghijklmnopqrstuvwxyz".split("").filter(y=>!i.includes(y.toLowerCase())),g=Math.floor(Math.random()*2)+1;for(let y=0;y<g&&p.length>0;y++){const T=Math.floor(Math.random()*p.length);u.push(p[T]),p.splice(T,1)}}return{action:"highlightAndCount",highlightWords:[],suggestedCount:l,animate:!0,isMultiLetter:!0,targetLetters:u}}helpWithWordCounting(e,n,r,s){const i=e.split(/\s+/),a=[];let l=0,u=0;if(i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&u++}),s)i.forEach(h=>{h.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&(a.push(h),l++)});else if(r===3){l=u+1,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());if(h.length>0&&a.length<l){const p=h[Math.floor(Math.random()*h.length)];a.push(p)}}else{Math.random()<.5?l=u+1:l=u+Math.floor(Math.random()*3)+2,l=Math.max(0,l),i.forEach(p=>{p.replace(/[.,;!?]/g,"").toLowerCase()===n.toLowerCase()&&a.push(p)});const h=i.filter(p=>p.replace(/[.,;!?]/g,"").toLowerCase()!==n.toLowerCase());for(;a.length<l&&h.length>0;){const p=Math.floor(Math.random()*h.length),g=h[p];a.includes(g)||a.push(g),h.splice(p,1)}}return{action:"highlightAndCount",highlightWords:a,suggestedCount:l,animate:!0}}helpWithTyping(e,n){this.incrementTaskUsage(n,"engagement");const r=this.getUniversalAttemptNumber();let s=e;const i={0:["o","O"],o:["0"],O:["0"],1:["l","I","i"],l:["1","I","i"],I:["1","l","i"],i:["1","l","I"],e:["3"],3:["e"],a:["@"],"@":["a"],s:["5","$"],S:["5","$"],5:["s","S"],$:["s","S"],g:["9"],9:["g"],b:["6"],6:["b"],z:["2"],2:["z"],B:["8"],8:["B"]},a=l=>{const u=l.split(""),h=u.map((p,g)=>i[p]?g:-1).filter(p=>p!==-1);if(h.length>0){const p=h[Math.floor(Math.random()*h.length)],g=u[p],y=i[g];y&&y.length>0&&(u[p]=y[Math.floor(Math.random()*y.length)])}else{const p=["transpose","duplicate","missing"],g=p[Math.floor(Math.random()*p.length)],y=Math.floor(Math.random()*u.length);switch(g){case"transpose":y<u.length-1&&([u[y],u[y+1]]=[u[y+1],u[y]]);break;case"duplicate":u.splice(y,0,u[y]);break;case"missing":u.splice(y,1);break}}return u.join("")};if(this.shouldAIBeCorrect(r))s=e;else if(r===3)s=a(e);else if(Math.random()<.5)s=a(e);else{let l=e;const u=Math.floor(Math.random()*3)+2;for(let h=0;h<u;h++)l=a(l);s=l}return{action:"autoType",text:s,typeSpeed:50,perfect:this.shouldAIBeCorrect(r)}}}const Ct=new xI;function _I({bonusPrompts:t=0,currentTask:e="",categoryPoints:n=null,timeRemaining:r=null,calculateStudentLearning:s=()=>0,aiCost:i=0,onAiCost:a}){const[l,u]=j.useState(!0),[h,p]=j.useState(0),[g,y]=j.useState(!1);j.useEffect(()=>{const H=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");u(H.hasAI!==!1)},[]),j.useEffect(()=>{if(e){const H=Ct.getTaskUsageCount(e)>=1;y(H)}},[e]),j.useEffect(()=>{const H=()=>{p(Ct.totalAIUsage)},Q=setInterval(H,1e3);return H(),()=>clearInterval(Q)},[]);const[T,C]=j.useState([{sender:"bot",text:l?"Hello! I'm your AI teaching assistant. You get ONE AI help attempt per task - use it wisely!":"Hello! This is the chat interface. AI assistance is not available for this session."}]),[b,O]=j.useState(""),[A,S]=j.useState(!1),[R,M]=j.useState({materials:0,research:0,engagement:0}),B=j.useRef(null),L=()=>e?e.startsWith("g1")?"research":e.startsWith("g2")?"materials":e.startsWith("g3")?"engagement":null:null,w=(H=null)=>{const Q=H||L();if(!Q){C(x=>[...x,{sender:"bot",text:"Please start a task first, then I can help you!"}]);return}if(Ct.getTaskUsageCount(e)>=1){C(x=>[...x,{sender:"bot",text:" You've already used AI help for this task. Only 1 AI attempt allowed per task!"}]);return}const F=Date.now();if(F-R[Q]<3e3){C(x=>[...x,{sender:"bot",text:"Please wait a moment before requesting help again!"}]);return}switch(M(x=>({...x,[Q]:F})),Q){case"materials":m();break;case"research":_();break;case"engagement":k();break;default:C(x=>[...x,{sender:"bot",text:"I'm not sure which task you're on. Please try again!"}])}},m=()=>{var x,N;const H=((x=document.querySelector("[data-target-value]"))==null?void 0:x.getAttribute("data-target-value"))||((N=document.querySelector(".target-value"))==null?void 0:N.textContent)||5,Q=Ct.helpWithSlider(parseFloat(H),e),K=Ct.getUniversalAttemptNumber(),F=Ct.shouldAIBeCorrect(K);Le.trackAITaskHelp(e,"slider",Q.value,F,K),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"slider",suggestion:Q.value,timestamp:Date.now(),wasCorrect:F})),window.dispatchEvent(new CustomEvent("aiSliderHelp",{detail:Q})),p(Ct.totalAIUsage),y(!0),C(U=>[...U,{sender:"bot",text:` Helping with materials...
Suggested value: ${Q.value.toFixed(2)}`}])},_=()=>{var K;const H=document.querySelector(".text-to-count"),Q=document.querySelector(".count-target");if(H&&Q){const F=H.getAttribute("data-counting-text")||"";let x=((K=Q.getAttribute("data-pattern"))==null?void 0:K.replace(/['"]/g,"").trim())||"";const N=Ct.helpWithCounting(F,x,e),U=N.suggestedCount;window.dispatchEvent(new CustomEvent("aiCountingHelp",{detail:N}));const J=Ct.getUniversalAttemptNumber(),ee=Ct.shouldAIBeCorrect(J);Le.trackAITaskHelp(e,"counting",U,ee,J),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"counting",suggestion:U,timestamp:Date.now(),wasCorrect:ee,highlightedWords:N.highlightWords||[],targetLetters:N.targetLetters||[]})),p(Ct.totalAIUsage),y(!0);const le=N.isMultiLetter?"letters/characters":"words";C(me=>[...me,{sender:"bot",text:` Helping with research...
Found ${U} ${le}`}])}},E=()=>{const H=[" CRITICAL STRATEGY: Do tasks in this EXACT order  1 Engagement (builds interest from the start) 2 Research (multiplies future materials) 3 Materials (gets all multipliers). Materials done early = WASTED points!"," MAXIMUM SCORE ORDER: Engagement FIRST  Research SECOND  Materials LAST! Why? Engagement compounds every task, Research only multiplies FUTURE materials. Doing materials early gets ZERO multiplier!"," WARNING: Research multipliers ONLY apply to materials earned AFTER! If you do materials first, you get NO bonus. Always do ALL engagement & research before touching ANY materials!"," PRO TIP: Complete 100% of Engagement tasks first (builds interest early), then 100% of Research (sets up multipliers), THEN do Materials. This order can DOUBLE your score vs doing materials first!"," OPTIMAL PATH: Think of it like this - Engagement = compound interest (starts early), Research = multiplier (affects future only), Materials = base score (save for last). Wrong order = lost points forever!"],Q=H[Math.floor(Math.random()*H.length)];C(K=>[...K,{sender:"bot",text:Q}]),Le.trackUserAction("planning_help_requested",{response:Q,currentTask:e,timestamp:Date.now()})},k=()=>{const H=document.querySelector("[data-typing-pattern]");if(H){const Q=H.getAttribute("data-typing-pattern");if(Q){const K=Ct.helpWithTyping(Q,e),F=Ct.getUniversalAttemptNumber(),x=K.perfect;Le.trackAITaskHelp(e,"typing",K.text,x,F),localStorage.setItem(`lastAIHelp_${e}`,JSON.stringify({type:"typing",suggestion:K.text,timestamp:Date.now(),wasCorrect:x,originalPattern:Q})),window.dispatchEvent(new CustomEvent("aiTypingHelp",{detail:K})),p(Ct.totalAIUsage),y(!0),C(N=>[...N,{sender:"bot",text:` Helping with engagement...
Typing: "${K.text.substring(0,30)}${K.text.length>30?"...":""}"`}])}}else C(Q=>[...Q,{sender:"bot",text:"Please navigate to the engagement tab first!"}])},P=()=>{if(!b.trim())return;if(!l){C(K=>[...K,{sender:"user",text:b},{sender:"bot",text:"AI assistance is not available for this session."}]),O("");return}const H=b.toLowerCase().trim(),Q={role:"user",content:b};C(K=>[...K,Q]),O(""),S(!0),i>0&&a&&a(i),setTimeout(()=>{let K="",F="general";if(H.includes("help"))if(F="help_request",H.includes("material")||H.includes("slider")){w("materials"),S(!1);return}else if(H.includes("research")||H.includes("count")){w("research"),S(!1);return}else if(H.includes("engagement")||H.includes("typ")){w("engagement"),S(!1);return}else K="Click the help buttons below for task assistance!";else if(H.includes("strategy")||H.includes("plan")||H.includes("order")){F="strategy";const x=[" CRITICAL STRATEGY: Do tasks in this EXACT order  1 Engagement (builds interest from the start) 2 Research (multiplies future materials) 3 Materials (gets all multipliers). Materials done early = WASTED points!"," MAXIMUM SCORE ORDER: Engagement FIRST  Research SECOND  Materials LAST! Why? Engagement compounds every task, Research only multiplies FUTURE materials. Doing materials early gets ZERO multiplier!"," WARNING: Research multipliers ONLY apply to materials earned AFTER! If you do materials first, you get NO bonus. Always do ALL engagement & research before touching ANY materials!"," PRO TIP: Complete 100% of Engagement tasks first (builds interest early), then 100% of Research (sets up multipliers), THEN do Materials. This order can DOUBLE your score vs doing materials first!"," OPTIMAL PATH: Think of it like this - Engagement = compound interest (starts early), Research = multiplier (affects future only), Materials = base score (save for last). Wrong order = lost points forever!"];K=x[Math.floor(Math.random()*x.length)]}else if(H.includes("tip")||H.includes("advice"))F="advice",K="Strategic tip: Do Research tasks first for the multiplier effect, then Materials for base points, finally Engagement for compound interest!";else{const x=["Keep pushing! You're doing great!","Remember: Materials  Research  Engagement = Success!","Focus on accuracy for those 2-point rewards!",`The checkpoint at minute ${(()=>{const U=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").semesterDuration||12e5,J=Math.floor(U/2e3);return Math.floor(J/60)})()} can give huge bonuses!`,"Try the help buttons below for task assistance!"];K=x[Math.floor(Math.random()*x.length)]}Le.trackUserAction("chat_message",{query:fullQuery,queryType:F,response:K,currentTask:e,categoryPoints:n,studentLearning:s(),aiUsageCount:Ct.totalAIUsage}),C(x=>[...x,{sender:"bot",text:K}]),S(!1)},800)},I=L();return c.jsxs("div",{className:"chat-container-sidebar",style:{height:"100%",display:"flex",flexDirection:"column"},children:[c.jsxs("div",{className:"chat-header",children:[c.jsx("h3",{children:l?"AI Teaching Assistant":"Chat Interface"}),c.jsx("div",{style:{fontSize:"11px",color:"#888",marginTop:"2px"},children:l?"1 AI help per task (reliability varies)":"AI assistance disabled for this session"}),c.jsxs("div",{style:{marginTop:"10px",padding:"8px",background:"#e3f2fd",borderRadius:"6px",border:"1px solid #2196F3"},children:[c.jsxs("div",{style:{fontSize:"12px",color:"#1976d2",fontWeight:"bold"},children:["Student Learning: ",Math.round(s())," pts"]}),c.jsxs("div",{style:{fontSize:"10px",color:"#666",marginTop:"2px"},children:[n.materials||0," "," ",(1+(n.research||0)*.15).toFixed(2)," + Interest"]})]})]}),c.jsxs("div",{className:"messages-sidebar",children:[T.map((H,Q)=>c.jsxs("div",{className:`message ${H.sender}`,children:[c.jsxs("div",{className:"message-sender",children:[H.sender==="user"?"You":l?"AI":"System",":"]}),c.jsx("div",{className:"message-text",children:H.text})]},Q)),A&&l&&c.jsxs("div",{className:"message bot",children:[c.jsx("div",{className:"message-sender",children:"AI:"}),c.jsx("div",{className:"message-text typing",children:"..."})]}),c.jsx("div",{ref:B})]}),c.jsxs("div",{className:"chat-input-sidebar",children:[c.jsx("input",{type:"text",placeholder:l?"Ask about strategy and tips here...":"Chat disabled - no AI available",value:b,onChange:H=>O(H.target.value),onKeyPress:H=>H.key==="Enter"&&P(),disabled:!l}),c.jsx("button",{onClick:P,disabled:!b.trim()||!l,children:"Send"})]}),l&&c.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f8f9fa"},children:[c.jsxs("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:["AI Usage: ",h," total attempts",g&&c.jsxs("span",{style:{color:"#ff9800",fontWeight:"bold"},children:[" ","| Current task: 1/1 used"]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"10px"},children:[c.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[c.jsxs("button",{onClick:()=>w(),disabled:!I||g,style:{padding:"12px",background:g?"#ff9800":I?"#2196F3":"#ccc",color:"white",border:"none",borderRadius:"8px",cursor:I&&!g?"pointer":"not-allowed",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[c.jsx("span",{style:{fontSize:"18px"},children:""}),g?"AI Used (1/1)":I?"Help Task":"Start task first"]}),c.jsxs("button",{onClick:E,style:{padding:"12px",background:"#FF9800",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",transition:"all 0.2s",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[c.jsx("span",{style:{fontSize:"18px"},children:""}),"Help Plan"]})]}),c.jsx("button",{onClick:()=>w("research"),disabled:!e.startsWith("g1")||g,style:{padding:"10px",background:e.startsWith("g1")&&!g?"#9C27B0":g&&e.startsWith("g1")?"#ff9800":"#e0e0e0",color:e.startsWith("g1")||g?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g1")&&!g?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Research"}),c.jsx("button",{onClick:()=>w("materials"),disabled:!e.startsWith("g2")||g,style:{padding:"10px",background:e.startsWith("g2")&&!g?"#4CAF50":g&&e.startsWith("g2")?"#ff9800":"#e0e0e0",color:e.startsWith("g2")||g?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g2")&&!g?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Materials"}),c.jsx("button",{onClick:()=>w("engagement"),disabled:!e.startsWith("g3")||g,style:{padding:"10px",background:e.startsWith("g3")&&!g?"#f44336":g&&e.startsWith("g3")?"#ff9800":"#e0e0e0",color:e.startsWith("g3")||g?"white":"#999",border:"none",borderRadius:"6px",cursor:e.startsWith("g3")&&!g?"pointer":"not-allowed",fontWeight:"bold",fontSize:"12px"},children:" Engage"})]}),c.jsx("div",{style:{fontSize:"11px",color:"#666",textAlign:"center",marginBottom:"8px",padding:"4px",background:"white",borderRadius:"4px"},children:I?c.jsx("span",{style:{color:"#4CAF50"},children:" AI ready to help"}):c.jsx("span",{style:{color:"#999"},children:" Navigate to a task to enable AI help"})})]}),!l&&c.jsxs("div",{style:{padding:"15px",borderTop:"1px solid #e0e0e0",background:"#f5f5f5",textAlign:"center",color:"#666",fontSize:"14px"},children:[c.jsx("div",{style:{marginBottom:"5px"},children:" No AI Assistant"}),c.jsx("div",{style:{fontSize:"12px"},children:"Complete tasks using your own judgment"})]})]})}const Bl={generateCode(){const t=Date.now().toString(36),e=Math.random().toString(36).substring(2,8);return`${t}-${e}`.toUpperCase()},async createCode(t={}){return{success:!0,code:this.generateCode(),data:t}},async markCodeAsUsed(t,e){if(!t)return{success:!1,error:"No code provided"};try{const n={code:t,status:"used",usedAt:fn(),sessionId:e,createdAt:fn()};return await Uv(Nt($e,"accessCodes",t),n),{success:!0}}catch(n){return console.error("Error marking code as used:",n),{success:!1,error:n.message}}},async checkCodeUsage(t){if(!t)return{used:!1};try{const e=await hf(Nt($e,"accessCodes",t));if(e.exists()){const n=e.data();return{used:n.status==="used",sessionId:n.sessionId,usedAt:n.usedAt}}return{used:!1}}catch(e){return console.error("Error checking code usage:",e),{used:!1,error:e.message}}},getCodeFromURL(){const t=new URLSearchParams(window.location.search);return t.get("code")||t.get("c")||null},async verifyQualtricsCode(t){return{valid:!1,reason:"Qualtrics codes not yet supported"}}};function wI({onLoginSuccess:t}){const[e,n]=j.useState(""),[r,s]=j.useState(!1),[i,a]=j.useState(""),[l,u]=j.useState(!1),h={"ADMIN-MASTER":{role:"master_admin",name:"Master Administrator",hasAI:!1,isMasterInterface:!0},ADMIN:{role:"admin",semesterDuration:72e4,name:"Admin User",hasAI:!0,checkpointSemester2:!0}},p=T=>({section:"TESTING-AI-CP",hasAI:!0,checkpointSemester2:!0,displayName:`${T} (Internal Tester - AI + Checkpoint)`}),g=T=>{if(h[T])return{valid:!0,type:"master",data:h[T]};const C=T.trim().replace(/[^a-zA-Z0-9\s\-_]/g,"");return C.length<2?{valid:!1,error:"Please enter a name with at least 2 characters"}:C.length>50?{valid:!1,error:"Name too long. Please use 50 characters or less"}:{valid:!0,type:"tester",condition:p(C),cleanName:C}},y=async T=>{if(T.preventDefault(),!e.trim()){a("Please enter your name");return}s(!0),a("");try{const C=g(e.trim());if(!C.valid){a(C.error||"Invalid Student ID"),s(!1);return}let b={timestamp:new Date().toISOString()};if(C.type==="master"){if(b={...b,studentIdentifier:e,role:C.data.role,semesterDuration:C.data.semesterDuration,displayName:C.data.name,section:C.data.isTestCode?"ADMIN-TEST":"ADMIN",hasAI:C.data.hasAI,checkpointSemester2:C.data.checkpointSemester2,isMasterCode:!0,isTestCode:C.data.isTestCode||!1,isMasterInterface:C.data.isMasterInterface||!1},C.data.isMasterInterface){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",displayName:C.data.name,section:"master_admin",hasAI:!0,checkpointSemester2:!0})),window.location.href=`${window.location.origin}?master=true`;return}}else if(C.type==="tester"){const A=C.condition,S=C.cleanName;b={...b,studentIdentifier:S,role:"tester",semesterDuration:72e4,displayName:A.displayName,section:A.section,hasAI:A.hasAI,checkpointSemester2:A.checkpointSemester2,isMasterCode:!1,isTestUser:!0}}const O=await Bl.createCode(b);O.success?(sessionStorage.setItem("gameConfig",JSON.stringify({semesterDuration:b.semesterDuration,role:b.role,studentId:b.studentIdentifier,displayName:b.displayName,section:b.section,hasAI:b.hasAI,checkpointSemester2:b.checkpointSemester2})),window.location.href=`${window.location.origin}?code=${O.code}`):a("Failed to generate access code. Please try again.")}catch(C){console.error("Login error:",C),a("System error. Please try again.")}finally{s(!1)}};return c.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f5f5f5",padding:"20px"},children:[c.jsxs("div",{style:{background:"white",padding:"48px",borderRadius:"16px",boxShadow:"0 20px 40px rgba(0,0,0,0.15)",maxWidth:"480px",width:"100%"},children:[c.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[c.jsxs("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a202c",marginBottom:"8px",lineHeight:"1.2"},children:["Scheduling Challenge:",c.jsx("br",{}),"Can you beat Park?"]}),c.jsx("p",{style:{fontSize:"16px",color:"#718096",marginTop:"12px"},children:"Enter your name to access the game"})]}),c.jsxs("form",{onSubmit:y,children:[c.jsxs("div",{style:{marginBottom:"24px"},children:[c.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#2d3748",fontWeight:"600",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.025em"},children:"Your Name:"}),c.jsx("input",{type:"text",value:e,onChange:T=>n(T.target.value),disabled:r,style:{width:"100%",padding:"14px 16px",fontSize:"16px",border:"2px solid #e2e8f0",borderRadius:"8px",boxSizing:"border-box",fontFamily:"'SF Mono', Monaco, 'Courier New', monospace",transition:"all 0.2s ease",background:"#f7fafc",outline:"none"},onFocus:T=>{T.target.style.borderColor="#2196F3",T.target.style.background="white",T.target.style.boxShadow="0 0 0 3px rgba(33, 150, 243, 0.1)"},onBlur:T=>{T.target.style.borderColor="#e2e8f0",T.target.style.background="#f7fafc",T.target.style.boxShadow="none"}}),c.jsx("div",{style:{marginTop:"8px",fontSize:"13px",color:"#a0aec0",lineHeight:"1.4"},children:"Enter your first and last name (2-50 characters)"})]}),i&&c.jsxs("div",{style:{background:"#fed7d7",color:"#c53030",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",fontSize:"14px",display:"flex",alignItems:"center",border:"1px solid #fc8181"},children:[c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",style:{marginRight:"8px",flexShrink:0},children:c.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i]}),c.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"14px 24px",fontSize:"16px",fontWeight:"600",background:r?"#cbd5e0":"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:r?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:r?"none":"0 4px 6px rgba(33, 150, 243, 0.25)",transform:r?"none":"translateY(0)"},onMouseDown:T=>{r||(T.target.style.transform="translateY(2px)",T.target.style.boxShadow="0 2px 4px rgba(33, 150, 243, 0.25)")},onMouseUp:T=>{r||(T.target.style.transform="translateY(0)",T.target.style.boxShadow="0 4px 6px rgba(33, 150, 243, 0.25)")},onMouseOver:T=>{r||(T.target.style.background="#1976D2")},onMouseOut:T=>{r||(T.target.style.background="#2196F3")},children:r?c.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:[c.jsxs("svg",{className:"animate-spin",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"8px",animation:"spin 1s linear infinite"},children:[c.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",strokeOpacity:"0.25"}),c.jsx("path",{d:"M4 12a8 8 0 018-8",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round"})]}),"Verifying Name..."]}):"Access Game"})]}),c.jsxs("div",{style:{marginTop:"32px",paddingTop:"24px",borderTop:"1px solid #e2e8f0",textAlign:"center"},children:[c.jsx("p",{style:{fontSize:"14px",color:"#718096",marginBottom:"12px"},children:"Having trouble? Contact your instructor:"}),c.jsxs("p",{style:{fontSize:"16px",color:"#2196F3",fontWeight:"500"},children:["Park Sinchaisri",c.jsx("br",{}),c.jsx("a",{href:"mailto:parksinchaisri@haas.berkeley.edu",style:{color:"#2196F3",textDecoration:"none",borderBottom:"1px solid #2196F3",fontSize:"15px"},children:"parksinchaisri@haas.berkeley.edu"})]}),l&&c.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"#f7fafc",borderRadius:"8px",fontSize:"11px",color:"#4a5568",lineHeight:"1.8"},children:[c.jsx("strong",{children:"Test Codes:"}),c.jsxs("div",{style:{marginTop:"8px",fontFamily:"monospace"},children:[c.jsx("div",{children:"ADMIN (Standard Game Mode)"}),c.jsx("div",{children:"ADMIN-MASTER (Master interface)"})]})]})]})]}),c.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]})}const Qm={async checkDailyLimit(t){var r;if(!t)return{allowed:!0};const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);try{const s=Qn($e,"sessions"),i=to(s,Rd("studentId","==",t),Rd("startTime",">=",n)),a=await Bs(i);if(!a.empty){const l=a.docs[0].data(),u=(r=l.startTime)!=null&&r.toDate?l.startTime.toDate():new Date(l.clientStartTime);return{allowed:!1,reason:"daily_limit",existingSession:l,nextAvailable:new Date(n.getTime()+24*60*60*1e3)}}return{allowed:!0}}catch(s){console.error("Error checking daily limit:",s);const i=`played_${t}_${n.toISOString().split("T")[0]}`;return localStorage.getItem(i)?{allowed:!1,reason:"daily_limit",nextAvailable:new Date(n.getTime()+24*60*60*1e3)}:{allowed:!0}}},async markDailyPlay(t){const e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0),r=`played_${t}_${n.toISOString().split("T")[0]}`;localStorage.setItem(r,"true");const s=new Date(Date.now()-7*24*60*60*1e3);for(let i=0;i<localStorage.length;i++){const a=localStorage.key(i);if(a&&a.startsWith("played_")){const l=a.split("_")[2];l&&new Date(l)<s&&localStorage.removeItem(a)}}},async checkAccess(){try{const t=Bl.getCodeFromURL();if(!t)return{allowed:!1,reason:"Please login with your student ID",requiresCode:!0};const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),n=e.role==="admin"||e.role==="master_admin";if(!n&&e.studentId){const r=await this.checkDailyLimit(e.studentId);if(!r.allowed&&!r.refreshGranted){const i=r.nextAvailable;return{allowed:!1,reason:`You have already completed today's session. Please come back in ${Math.ceil((i-Date.now())/(1e3*60*60))} hours (after midnight).`,dailyLimitReached:!0,nextAvailable:i}}if(sessionStorage.getItem("activeSessionId"))return{allowed:!1,reason:"Page refresh is not allowed during the game. Your session has been terminated.",refreshAttempt:!0}}return e.studentId?(n||await this.markDailyPlay(e.studentId),{allowed:!0,newSession:!0,code:t,codeData:{status:"new",metadata:e},isAdmin:n}):{allowed:!1,reason:"Please login with your Berkeley student ID",requiresCode:!0}}catch(t){console.error("Error in checkAccess:",t);const e=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");return e.role==="admin"?{allowed:!0,newSession:!0,code:Bl.getCodeFromURL(),codeData:{status:"error_bypass",metadata:e},isAdmin:!0}:{allowed:!1,reason:"System error. Please try again.",requiresCode:!0}}},async createSession(t=null,e=null,n=!1){try{const r=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),s=r.role==="admin"||r.role==="master_admin",i={id:crypto.randomUUID(),accessCode:t,studentId:r.studentId||null,role:r.role||"student",semesterDuration:r.semesterDuration||72e4,displayName:r.displayName||"Student",startTime:fn(),clientStartTime:new Date().toISOString(),status:"active",completedTasks:{},isPractice:n,isAdminSession:s,userAgent:navigator.userAgent,screenResolution:`${window.screen.width}x${window.screen.height}`,section:r.section,hasAI:r.hasAI,checkpointSemester2:r.checkpointSemester2},l=(await ff(Qn($e,"sessions"),i)).id;return localStorage.setItem("sessionId",l),sessionStorage.setItem("activeSessionId",l),s||(window.addEventListener("beforeunload",u=>{u.preventDefault(),u.returnValue="Your progress will be lost if you leave this page.",this.handleSessionAbandonment()}),document.addEventListener("visibilitychange",()=>{!s&&document.hidden})),l}catch(r){console.error("Error creating session:",r);const s=JSON.parse(sessionStorage.getItem("gameConfig")||"{}");if(s.role==="admin"){const i="offline-"+Date.now();localStorage.setItem("sessionId",i),sessionStorage.setItem("activeSessionId",i);const a={id:i,accessCode:t,startTime:Date.now(),status:"active",isOffline:!0,studentId:s.studentId||null,role:s.role||"admin"};return localStorage.setItem("offlineSession",JSON.stringify(a)),i}throw r}},async handleSessionAbandonment(){const t=localStorage.getItem("sessionId");if(t&&!t.startsWith("offline-"))try{await Kn(Nt($e,"sessions",t),{status:"abandoned",abandonedAt:fn(),abandonReason:"page_unload"})}catch(e){console.error("Error marking session as abandoned:",e)}sessionStorage.removeItem("activeSessionId"),sessionStorage.removeItem("gameConfig")}};function SI(){const[t,e]=j.useState(""),[n,r]=j.useState(!1),[s,i]=j.useState(""),[a,l]=j.useState(!1),u=async()=>{r(!0),i(""),l(!1);try{const p=await Bl.createCode({createdBy:"admin",timestamp:new Date().toISOString()});p.success?e(p.code):i("Failed to generate code: "+p.error)}catch(p){i("Error: "+p.message)}finally{r(!1)}},h=()=>{const p=`${window.location.origin}?code=${t}`;navigator.clipboard.writeText(p),l(!0),setTimeout(()=>l(!1),2e3)};return c.jsxs("div",{style:{padding:"40px",maxWidth:"800px",margin:"0 auto",fontFamily:"system-ui, -apple-system, sans-serif"},children:[c.jsx("h1",{style:{color:"#333",marginBottom:"10px"},children:"Admin Dashboard"}),c.jsx("p",{style:{color:"#666",marginBottom:"30px"},children:"Generate access codes for participants"}),c.jsxs("div",{style:{background:"#f8f9fa",padding:"30px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[c.jsx("button",{onClick:u,disabled:n,style:{padding:"12px 30px",fontSize:"16px",background:n?"#ccc":"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:"bold"},children:n?"Generating...":"Generate New Access Code"}),t&&c.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"white",borderRadius:"6px",border:"1px solid #e0e0e0"},children:[c.jsx("h3",{style:{margin:"0 0 15px 0",color:"#333"},children:"Generated Code"}),c.jsxs("div",{style:{marginBottom:"20px"},children:[c.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Access Code:"}),c.jsx("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px",background:"#f5f5f5",borderRadius:"4px",fontFamily:"monospace",fontSize:"18px",fontWeight:"bold"},children:t})]}),c.jsxs("div",{children:[c.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#666",fontSize:"14px"},children:"Full URL:"}),c.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"stretch"},children:[c.jsx("input",{type:"text",value:`${window.location.origin}?code=${t}`,readOnly:!0,style:{flex:1,padding:"10px",border:"1px solid #ddd",borderRadius:"4px",fontFamily:"monospace",fontSize:"14px",background:"#f9f9f9"}}),c.jsx("button",{onClick:h,style:{padding:"10px 20px",background:a?"#4CAF50":"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:a?" Copied!":"Copy URL"})]})]}),c.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"4px",fontSize:"14px",color:"#1976d2"},children:[c.jsx("strong",{children:"Note:"})," This code is valid for 24 hours and can only be used once."]})]}),s&&c.jsx("div",{style:{marginTop:"20px",padding:"15px",background:"#ffebee",color:"#c62828",borderRadius:"4px"},children:s})]}),c.jsxs("div",{style:{marginTop:"40px",padding:"20px",background:"#f5f5f5",borderRadius:"6px",fontSize:"14px",color:"#666"},children:[c.jsx("h3",{style:{margin:"0 0 10px 0",color:"#333"},children:"How to use:"}),c.jsxs("ol",{style:{margin:"10px 0",paddingLeft:"20px"},children:[c.jsx("li",{children:"Generate a code using the button above"}),c.jsx("li",{children:"Copy the full URL"}),c.jsx("li",{children:"Share the URL with participants"}),c.jsx("li",{children:"Each participant can use their unique code once"})]})]})]})}function EI({sessionId:t,completedLevels:e,totalTime:n,gameMode:r}){const[s,i]=j.useState(""),[a,l]=j.useState(!1);j.useEffect(()=>{u()},[]);const u=()=>{const p=Date.now().toString(36).toUpperCase(),g=e.toString().padStart(2,"0"),y=r.limit==="time"?"T":"A",T=r.accuracy==="strict"?"S":"L",O=`GAME-${`${t}-${g}-${n}`.split("").reduce((A,S)=>A+S.charCodeAt(0),0).toString(36).toUpperCase().slice(-3)}-${g}-${y}${T}-${p}`;i(O)},h=async()=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(s),l(!0),setTimeout(()=>l(!1),3e3);else{const p=document.createElement("textarea");p.value=s,p.style.position="fixed",p.style.top="0",p.style.left="0",p.style.width="2em",p.style.height="2em",p.style.padding="0",p.style.border="none",p.style.outline="none",p.style.boxShadow="none",p.style.background="transparent",p.style.opacity="0",document.body.appendChild(p),p.focus(),p.select();try{document.execCommand("copy")?(l(!0),setTimeout(()=>l(!1),3e3)):(console.error("Failed to copy using execCommand"),alert("Copy failed. Please manually select and copy the code."))}catch(g){console.error("Failed to copy:",g),alert("Copy failed. Please manually select and copy the code.")}document.body.removeChild(p)}}catch(p){console.error("Clipboard operation failed:",p),alert(`Copy failed. Here's your code to copy manually:

${s}`)}};return c.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"12px",padding:"30px",marginTop:"30px",color:"white",textAlign:"center",boxShadow:"0 10px 30px rgba(0,0,0,0.2)"},children:[c.jsx("h2",{style:{marginBottom:"20px",fontSize:"24px"},children:" Your Completion Code"}),c.jsx("p",{style:{marginBottom:"20px",opacity:.9,fontSize:"16px"},children:"Copy this code and paste it into the Qualtrics survey to verify your completion:"}),c.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"8px",padding:"20px",marginBottom:"20px",backdropFilter:"blur(10px)"},children:[c.jsx("div",{style:{fontFamily:"monospace",fontSize:"28px",fontWeight:"bold",letterSpacing:"2px",marginBottom:"15px",wordBreak:"break-all",textShadow:"2px 2px 4px rgba(0,0,0,0.2)",userSelect:"text",cursor:"text"},onClick:p=>{const g=window.getSelection(),y=document.createRange();y.selectNodeContents(p.currentTarget),g.removeAllRanges(),g.addRange(y)},title:"Click to select all text",children:s}),c.jsx("button",{onClick:h,style:{padding:"12px 30px",fontSize:"16px",fontWeight:"bold",background:a?"#4CAF50":"white",color:a?"white":"#764ba2",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.3s",boxShadow:"0 4px 15px rgba(0,0,0,0.2)"},children:a?" Copied!":" Copy Code"})]}),c.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:"6px",padding:"15px",fontSize:"14px",lineHeight:"1.5"},children:[c.jsx("strong",{children:" Important:"})," This code is your proof of completion. Make sure to copy it before closing this window!",c.jsx("br",{}),c.jsx("span",{style:{fontSize:"13px",opacity:.9},children:" Tip: If the Copy button doesn't work, click on the code text to select it, then use Ctrl+C (or Cmd+C on Mac) to copy."})]}),c.jsxs("details",{style:{marginTop:"20px",textAlign:"left"},children:[c.jsx("summary",{style:{cursor:"pointer",opacity:.8,fontSize:"12px",marginBottom:"10px"},children:"Code Details "}),c.jsxs("div",{style:{fontSize:"12px",opacity:.7,background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",fontFamily:"monospace"},children:[c.jsxs("div",{children:["Levels Completed: ",e,"/45"]}),c.jsxs("div",{children:["Game Mode: ",r.limit==="time"?"Time Challenge":"Task Attempts"]}),c.jsxs("div",{children:["Accuracy Mode: ",r.accuracy==="strict"?"Strict (100%)":"Lenient"]}),c.jsxs("div",{children:["Total Time: ",Math.floor(n/60),"m ",n%60,"s"]}),c.jsxs("div",{children:["Generated: ",new Date().toLocaleString()]})]})]})]})}function TI(){const[t,e]=j.useState([]),[n,r]=j.useState(!0),[s,i]=j.useState(null),[a,l]=j.useState(!1),[u,h]=j.useState(""),[p,g]=j.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,unfinishedTaskPenalty:0,taskOrderStrategy:"sequential",freezePenalty:0,contextAdviceEnabled:!0}),[y,T]=j.useState(!1);j.useEffect(()=>{C()},[]);const C=async()=>{try{const x=Nt($e,"game_settings","global"),N=await hf(x);N.exists()&&g({...p,...N.data()})}catch(x){console.error("Error loading game config:",x)}},b=(x,N)=>{g(U=>({...U,[x]:N}))},O=async()=>{T(!0);try{await Uv(Nt($e,"game_settings","global"),p),alert(" Game configuration saved successfully!")}catch(x){console.error("Error saving config:",x),alert("Failed to save configuration.")}finally{T(!1)}},A=["3040748714","3040729812","3040859968","3040852909","3040869211","3040849958","3039838870","15177695","3040849997","3039845630","3040682661","26416809","3039850622","3040869510","3031977170","3040806629","3040848528","3039840443","3040848749","3040849893","3039850830","3039850713"],S=["3040850023","22900589","3039850570","3040882302","3040815651","3040701758","3040852077","3036343361","3040869458","3040705047","3040702343","3039842887","3040848593","3040702603","3039840222","3039840209","3040861190","18565110","3040869302","3040814338","3039754031"],R=["3040705476","3040697715","3039753992","3040729513","3040681595","3040850010","3032682772","3039842484","3040869445","3040814455","3039840781","3040696831","3040705125","3034184066","3039843004","3039842835","3040860072","3040871018","3039839026","3040814429","3040869094","3040748064","3040875945","3040701589","3040682193","3040729422","3040836165","21798975","3038626424","3039753017","3039840287","3040806382"],M=["25958106","3040814351","3040848697","3040684039","3040869289","22971551","3040837218","3040864570","3040705099","3034288430","3040848541","3040864531","3040869237","3032342054","3040682479","3039840170","3032397447","3039850856","3039840118","3040729552","3040683181","3040861073","3031968434","3040882575","3035320237","3040823815","3039842575","24261697","23420611","3032000089","3040882341"],B=x=>A.includes(x)?{section:"01A-Checkpoint",hasCheckpoint:!0,isAdmin:!1}:S.includes(x)?{section:"01A-No Checkpoint",hasCheckpoint:!1,isAdmin:!1}:R.includes(x)?{section:"02A-Checkpoint",hasCheckpoint:!0,isAdmin:!1}:M.includes(x)?{section:"02A-No Checkpoint",hasCheckpoint:!1,isAdmin:!1}:x.startsWith("ADMIN-TEST")?{section:"ADMIN-TEST",hasCheckpoint:!0,isAdmin:!0}:x.includes("ADMIN")||x.includes("admin")?{section:"ADMIN",hasCheckpoint:!1,isAdmin:!0}:{section:"Unknown",hasCheckpoint:!1,isAdmin:!1};j.useEffect(()=>{L()},[]);const L=async()=>{r(!0);try{const x=await Bs(Qn($e,"sessions")),N=new Date,U=`${N.getFullYear()}-${String(N.getMonth()+1).padStart(2,"0")}-${String(N.getDate()).padStart(2,"0")}`,J=to(Qn($e,"accessRefreshes"),Rd("refreshedAt",">=",new Date(U))),ee=await Bs(J),le=new Set;ee.forEach(Z=>{const oe=Z.data();le.add(oe.studentId)});const me={};x.forEach(Z=>{var ve;const oe=Z.data();if(oe.role!=="master_admin"&&oe.studentId){const ne=B(oe.studentId);me[oe.studentId]||(me[oe.studentId]={studentId:oe.studentId,sessions:[],latestAccess:null,totalAccesses:0,displayName:`Student ${oe.studentId}`,section:ne.section,hasCheckpoint:ne.hasCheckpoint,hasPlayed:!0,isAdmin:ne.isAdmin,hasBeenRefreshedToday:le.has(oe.studentId)}),me[oe.studentId].sessions.push({id:Z.id,timestamp:(ve=oe.startTime)!=null&&ve.toDate?oe.startTime.toDate():new Date(oe.clientStartTime),status:oe.status,completedTasks:Object.keys(oe.completedTasks||{}).length,finalScore:oe.finalScore||0,currentSemester:oe.currentSemester||1,timeElapsed:oe.timeElapsed||oe.totalTime||0})}}),Object.values(me).forEach(Z=>{var oe;Z.sessions.sort((ve,ne)=>ne.timestamp-ve.timestamp),Z.latestAccess=((oe=Z.sessions[0])==null?void 0:oe.timestamp)||null,Z.totalAccesses=Z.sessions.length});const fe=[];[...A,...S,...R,...M].forEach(Z=>{if(me[Z])fe.push(me[Z]);else{const oe=B(Z);fe.push({studentId:Z,sessions:[],latestAccess:null,totalAccesses:0,displayName:`Student ${Z}`,section:oe.section,hasCheckpoint:oe.hasCheckpoint,hasPlayed:!1,isAdmin:oe.isAdmin,hasBeenRefreshedToday:le.has(Z)})}}),fe.sort((Z,oe)=>Z.hasPlayed&&!oe.hasPlayed?-1:!Z.hasPlayed&&oe.hasPlayed?1:Z.latestAccess&&oe.latestAccess?oe.latestAccess-Z.latestAccess:Z.studentId.localeCompare(oe.studentId)),e(fe)}catch(x){console.error("Error loading student data:",x)}finally{r(!1)}},w=async x=>{l(!0);try{const U=new Date().toISOString().split("T")[0],J=`played_${x}_${U}`;localStorage.removeItem(J),await ff(Qn($e,"accessRefreshes"),{studentId:x,refreshedBy:"MASTER_ADMIN",refreshedAt:fn(),reason:"Manual refresh by admin"}),alert(`Access refreshed for student ${x}. They can now play again today.`),await L()}catch(N){console.error("Error refreshing access:",N),alert(`Failed to refresh access: ${N.message}`)}finally{l(!1)}},m=async()=>{if(confirm(` DANGER: This will permanently delete ALL student sessions, events, and access data.

This action cannot be undone. Are you absolutely sure?`)){l(!0);try{const x=to(Qn($e,"sessions")),N=await Bs(x),U=N.docs.map(Z=>uc(Z.ref)),J=to(Qn($e,"events")),ee=await Bs(J),le=ee.docs.map(Z=>uc(Z.ref)),me=to(Qn($e,"accessRefreshes")),fe=await Bs(me),pe=fe.docs.map(Z=>uc(Z.ref));Object.keys(localStorage).forEach(Z=>{Z.startsWith("played_")&&localStorage.removeItem(Z)}),await Promise.all([...U,...le,...pe]),alert(` All data reset complete!

Deleted:
- ${N.size} sessions
- ${ee.size} events
- ${fe.size} access refreshes
- All localStorage data`),await L()}catch(x){console.error("Error resetting all data:",x),alert("Failed to reset data. Please check console for details.")}finally{l(!1)}}},_=t.filter(x=>x.studentId.toLowerCase().includes(u.toLowerCase())),E=x=>x?new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}).format(x):"Never",k=x=>!x.sessions||x.sessions.length===0?0:Math.max(...x.sessions.map(N=>N.finalScore||0)),P=x=>!x.sessions||x.sessions.length===0?0:x.sessions.reduce((U,J)=>(J.finalScore||0)>(U.finalScore||0)?J:U,x.sessions[0]).timeElapsed||0,I=x=>{if(!x)return"N/A";const N=Math.floor(x/60),U=x%60;return`${N}:${U.toString().padStart(2,"0")}`},H=t.filter(x=>!x.section.includes("ADMIN")).length,Q=t.filter(x=>!x.section.includes("ADMIN")&&x.hasPlayed).length,K=t.filter(x=>!x.section.includes("ADMIN")).reduce((x,N)=>x+N.totalAccesses,0);t.filter(x=>!x.section.includes("ADMIN")&&x.hasPlayed).reduce((x,N)=>x+k(N),0)/(Q||1);const F=t.filter(x=>!x.section.includes("ADMIN")&&!x.hasPlayed).length;return c.jsxs("div",{style:{padding:"20px",maxWidth:"1400px",margin:"0 auto"},children:[c.jsx("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"30px",borderRadius:"12px",marginBottom:"30px",color:"white"},children:c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsxs("div",{children:[c.jsx("h1",{style:{margin:"0 0 10px 0"},children:" Master Admin Dashboard"}),c.jsx("p",{style:{margin:0,opacity:.9},children:"Manage student access and view activity logs"})]}),c.jsx("button",{onClick:m,disabled:a,style:{padding:"12px 20px",background:"#f44336",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",fontSize:"14px",opacity:a?.6:1},children:a?"Processing...":" Reset All Data"})]})}),c.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"25px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"30px",border:"2px solid #2196F3"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[c.jsxs("h2",{style:{margin:0,color:"#2196F3",fontSize:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("span",{children:""})," Game Configuration"]}),c.jsx("button",{onClick:O,disabled:y,style:{padding:"10px 20px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",opacity:y?.7:1},children:y?"Saving...":" Save Settings"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px"},children:[c.jsxs("div",{style:{background:"#f8f9fa",padding:"15px",borderRadius:"8px"},children:[c.jsx("h3",{style:{fontSize:"16px",marginTop:0,color:"#555"},children:" Time & Semesters"}),c.jsxs("div",{style:{marginBottom:"15px"},children:[c.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"bold"},children:"Semester Duration (minutes)"}),c.jsx("input",{type:"number",value:p.semesterDuration,onChange:x=>b("semesterDuration",parseInt(x.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"}})]}),c.jsxs("div",{style:{marginBottom:"15px"},children:[c.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"bold"},children:"Total Semesters"}),c.jsx("input",{type:"number",value:p.totalSemesters,onChange:x=>b("totalSemesters",parseInt(x.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"}})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("input",{type:"checkbox",checked:p.midtermEnabled,onChange:x=>b("midtermEnabled",x.target.checked),id:"midtermCheck"}),c.jsx("label",{htmlFor:"midtermCheck",style:{fontSize:"14px"},children:"Enable Midterm Checkpoint"})]})]}),c.jsxs("div",{style:{background:"#f8f9fa",padding:"15px",borderRadius:"8px"},children:[c.jsx("h3",{style:{fontSize:"16px",marginTop:0,color:"#555"},children:" Task Settings"}),c.jsxs("div",{style:{marginBottom:"15px"},children:[c.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"bold"},children:"Total Tasks per Semester"}),c.jsx("input",{type:"number",value:p.totalTasks,onChange:x=>b("totalTasks",parseInt(x.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"}})]}),c.jsxs("div",{style:{marginBottom:"15px"},children:[c.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"bold"},children:"Difficulty Configuration"}),c.jsxs("select",{value:p.difficultyMode||"fixed",onChange:x=>b("difficultyMode",x.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"},children:[c.jsx("option",{value:"fixed",children:"Fixed (50% Easy, 30% Medium, 20% Hard)"}),c.jsx("option",{value:"manual",children:"Manual (User chooses difficulty)"})]})]}),c.jsxs("div",{style:{marginBottom:"15px"},children:[c.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"bold"},children:"Task Order Strategy"}),c.jsxs("select",{value:p.taskOrderStrategy,onChange:x=>b("taskOrderStrategy",x.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"},children:[c.jsx("option",{value:"sequential_task",children:"Order by Task (Materials -> Research -> Engagement)"}),c.jsx("option",{value:"sequential_difficulty",children:"Order by Difficulty (Easy -> Medium -> Hard)"})]})]})]}),c.jsxs("div",{style:{background:"#f8f9fa",padding:"15px",borderRadius:"8px"},children:[c.jsx("h3",{style:{fontSize:"16px",marginTop:0,color:"#555"},children:" Penalties & Mechanics"}),c.jsxs("div",{style:{marginBottom:"15px"},children:[c.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"bold"},children:"AI Help Cost (Points)"}),c.jsx("input",{type:"number",value:p.aiCost,onChange:x=>b("aiCost",parseInt(x.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"}})]}),c.jsxs("div",{style:{marginBottom:"15px"},children:[c.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"bold"},children:"Unfinished Task Penalty (Points)"}),c.jsx("input",{type:"number",value:p.unfinishedTaskPenalty,onChange:x=>b("unfinishedTaskPenalty",parseInt(x.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"}})]}),c.jsxs("div",{style:{marginBottom:"15px"},children:[c.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",fontWeight:"bold"},children:"Freeze Penalty (Points)"}),c.jsx("input",{type:"number",value:p.freezePenalty,onChange:x=>b("freezePenalty",parseInt(x.target.value)),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"}})]})]})]})]}),c.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"25px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",marginBottom:"30px"},children:[c.jsx("h2",{style:{margin:"0 0 20px 0",color:"#333",fontSize:"20px"},children:" Admin Code Reference"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px"},children:[c.jsxs("div",{style:{border:"2px solid #2196F3",borderRadius:"8px",padding:"15px",background:"#f8fcff"},children:[c.jsx("h3",{style:{margin:"0 0 10px 0",color:"#2196F3",fontSize:"16px"},children:" Admin Access"}),c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px"},children:[c.jsxs("li",{children:[c.jsx("code",{children:"ADMIN"})," - Standard Game Mode"]}),c.jsx("li",{children:"12-minute duration (configurable)"}),c.jsx("li",{children:"AI enabled"}),c.jsx("li",{children:"Data tracked separately"})]})]}),c.jsxs("div",{style:{border:"2px solid #9C27B0",borderRadius:"8px",padding:"15px",background:"#fdf8ff"},children:[c.jsx("h3",{style:{margin:"0 0 10px 0",color:"#9C27B0",fontSize:"16px"},children:" Master Admin"}),c.jsxs("ul",{style:{margin:0,paddingLeft:"20px",fontSize:"14px"},children:[c.jsxs("li",{children:[c.jsx("code",{children:"ADMIN-MASTER"})," - Access to this interface"]}),c.jsx("li",{children:"Student data management and analysis"}),c.jsx("li",{children:"Access refresh and data reset capabilities"}),c.jsx("li",{children:"No gameplay, admin interface only"})]})]})]})]}),c.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"12px",marginBottom:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[c.jsxs("div",{style:{display:"flex",gap:"15px",alignItems:"center"},children:[c.jsx("input",{type:"text",placeholder:"Search by Student ID...",value:u,onChange:x=>h(x.target.value),style:{flex:1,padding:"10px 15px",border:"2px solid #e0e0e0",borderRadius:"8px",fontSize:"14px"}}),c.jsx("button",{onClick:L,disabled:n,style:{padding:"10px 20px",background:"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"bold"},children:" Refresh Data"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"15px",marginTop:"20px"},children:[c.jsxs("div",{style:{padding:"15px",background:"#e3f2fd",borderRadius:"8px",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#2196F3"},children:H}),c.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Students"})]}),c.jsxs("div",{style:{padding:"15px",background:"#e8f5e9",borderRadius:"8px",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#4CAF50"},children:Q}),c.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Have Played"})]}),c.jsxs("div",{style:{padding:"15px",background:"#fff3e0",borderRadius:"8px",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#ff9800"},children:K}),c.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Sessions"})]}),c.jsxs("div",{style:{padding:"15px",background:"#fce4ec",borderRadius:"8px",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#e91e63"},children:F}),c.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Never Played"})]}),c.jsxs("div",{style:{padding:"15px",background:"#f3e5f5",borderRadius:"8px",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#9c27b0"},children:F}),c.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Never Played"})]})]})]}),c.jsx("div",{style:{background:"white",borderRadius:"12px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:c.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[c.jsx("thead",{children:c.jsxs("tr",{style:{background:"#f5f5f5"},children:[c.jsx("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600"},children:"Student ID"}),c.jsx("th",{style:{padding:"15px",textAlign:"left",fontWeight:"600"},children:"Section"}),c.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Status"}),c.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Latest Access"}),c.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Highest Score"}),c.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Time Taken"}),c.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Total"}),c.jsx("th",{style:{padding:"15px",textAlign:"center",fontWeight:"600"},children:"Actions"})]})}),c.jsx("tbody",{children:n?c.jsx("tr",{children:c.jsx("td",{colSpan:"8",style:{padding:"40px",textAlign:"center"},children:"Loading student data..."})}):_.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:"8",style:{padding:"40px",textAlign:"center"},children:"No students found"})}):_.map(x=>{const N=k(x);return c.jsxs("tr",{style:{borderBottom:"1px solid #e0e0e0",background:s===x.studentId?"#f0f8ff":x.hasPlayed?x.isAdmin?"#fff9c4":"white":"#fafafa"},children:[c.jsx("td",{style:{padding:"15px",fontFamily:"monospace"},children:x.studentId}),c.jsx("td",{style:{padding:"15px"},children:c.jsx("span",{style:{padding:"4px 8px",background:x.isAdmin?"#ffeb3b":x.section.includes("01A")?"#e3f2fd":x.section.includes("02A")?"#f3e5f5":"#f5f5f5",borderRadius:"4px",fontSize:"12px",fontWeight:x.isAdmin?"bold":"normal",color:x.isAdmin?"#333":"inherit"},children:x.section})}),c.jsx("td",{style:{padding:"15px",textAlign:"center"},children:x.isAdmin?c.jsx("span",{style:{padding:"4px 8px",background:"#9C27B0",color:"white",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:"Unlimited"}):!x.hasPlayed||x.hasBeenRefreshedToday?c.jsx("span",{style:{padding:"4px 8px",background:"#e8f5e9",color:"#2e7d32",borderRadius:"12px",fontSize:"12px"},children:"Active"}):c.jsx("span",{style:{padding:"4px 8px",background:"#ffeb3b",color:"#f57c00",borderRadius:"12px",fontSize:"12px"},children:"Restricted"})}),c.jsx("td",{style:{padding:"15px",textAlign:"center"},children:E(x.latestAccess)}),c.jsx("td",{style:{padding:"15px",textAlign:"center"},children:c.jsx("span",{style:{padding:"4px 8px",background:N>=1e3?"#e8f5e9":N>0?"#fff3e0":"#f5f5f5",color:N>=1e3?"#2e7d32":N>0?"#f57c00":"#999",borderRadius:"12px",fontSize:"12px",fontWeight:"bold"},children:N})}),c.jsx("td",{style:{padding:"15px",textAlign:"center"},children:c.jsx("span",{style:{fontFamily:"monospace",fontSize:"12px",color:"#666",fontWeight:"bold"},children:I(P(x))})}),c.jsx("td",{style:{padding:"15px",textAlign:"center",fontWeight:"bold"},children:x.totalAccesses}),c.jsx("td",{style:{padding:"15px",textAlign:"center"},children:x.isAdmin?c.jsx("span",{style:{color:"#999",fontSize:"12px"},children:"N/A"}):c.jsx("button",{onClick:()=>{i(x.studentId),confirm(`Reset access for Student ${x.studentId} (${x.section})?

This will allow them to play again today.`)&&w(x.studentId)},disabled:a,style:{padding:"6px 12px",background:"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},children:" Reset"})})]},x.studentId)})})]})}),c.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#f5f5f5",borderRadius:"8px",fontSize:"12px",color:"#666",textAlign:"center"},children:["Daily automatic reset is disabled. Use refresh button to manually grant access to students who have already played.",c.jsx("br",{}),"Total roster: ",H," students across 4 conditions (01A-Checkpoint, 01A-No Checkpoint, 02A-Checkpoint, 02A-No Checkpoint)"]})]})}const II={notifyGameComplete(t={}){try{window.parent.postMessage({type:"gameComplete",status:"finished",timestamp:new Date().toISOString(),...t},"*");try{if(window.parent&&window.parent.document){const e=window.parent.document.querySelector("#NextButton");e&&(e.style.display="inline-block",e.style.visibility="visible",e.disabled=!1)}}catch{window.parent.postMessage({type:"showNextButton",action:"show"},"*")}console.log(" Game completion notification sent to Qualtrics")}catch(e){console.error("Failed to notify Qualtrics:",e)}},notifySemesterComplete(t,e,n={}){try{window.parent.postMessage({type:"semesterComplete",semester:t,totalSemesters:e,timestamp:new Date().toISOString(),...n},"*"),window.parent.postMessage({type:"keepNextButtonVisible",action:"maintain"},"*"),console.log(` Semester ${t} completion notification sent`)}catch(r){console.error("Failed to notify Qualtrics of semester completion:",r)}},ensureNextButtonVisible(){try{window.parent.postMessage({type:"ensureNextButton",action:"show",timestamp:new Date().toISOString()},"*")}catch(t){console.error("Failed to ensure Next button visibility:",t)}}};function AI({onStart:t,totalTasks:e=10,orderStrategy:n="sequential_task",durationMinutes:r=12,difficultyMode:s="fixed"}){const[i,a]=j.useState({g2:0,g1:0,g3:0}),[l,u]=j.useState({g2:{easy:0,medium:0,hard:0},g1:{easy:0,medium:0,hard:0},g3:{easy:0,medium:0,hard:0}}),[h,p]=j.useState([]),[g,y]=j.useState(0),[T,C]=j.useState(null),b=["It's generally smart to do roughly an even number of each task.","This is because the tasks that are worth more points take more time to do, so you don't want to only do the shorter tasks or only do the longer tasks.","Of course, you might prefer one task over another, so you could take that into account. Do you feel like you are particularly good at one of the tasks?"],O=()=>{g<b.length?(p(m=>[...m,{sender:"AI",text:b[g]}]),y(m=>m+1)):p(m=>[...m,{sender:"AI",text:"I've shared my best advice! It's up to you now."}])},A=(m,_)=>{const E=parseInt(_)||0;a(k=>({...k,[m]:Math.max(0,E)})),C(null)},S=(m,_,E)=>{const k=parseInt(E)||0;u(P=>({...P,[m]:{...P[m],[_]:Math.max(0,k)}})),C(null)},B=s==="manual"?(()=>{let m=0;return Object.values(l).forEach(_=>{m+=_.easy+_.medium+_.hard}),m})():Object.values(i).reduce((m,_)=>m+_,0),L=B===e,w=()=>{if(B!==e){C(`Total tasks must equal ${e}. Currently: ${B}`);return}let m=[];s==="fixed"?["g2","g1","g3"].forEach(H=>{const Q=i[H];if(Q>0){const K=Math.max(0,Math.round(Q*.5)),F=Math.max(0,Math.round(Q*.3)),x=Math.max(0,Q-K-F);for(let N=0;N<K;N++)m.push({type:H,difficulty:"easy"});for(let N=0;N<F;N++)m.push({type:H,difficulty:"medium"});for(let N=0;N<x;N++)m.push({type:H,difficulty:"hard"})}}):["g2","g1","g3"].forEach(H=>{const{easy:Q,medium:K,hard:F}=l[H];for(let x=0;x<Q;x++)m.push({type:H,difficulty:"easy"});for(let x=0;x<K;x++)m.push({type:H,difficulty:"medium"});for(let x=0;x<F;x++)m.push({type:H,difficulty:"hard"})});const _={g2:{easy:1,medium:6,hard:11},g1:{easy:1,medium:6,hard:11},g3:{easy:1,medium:6,hard:11}},E=m.map(H=>{const{type:Q,difficulty:K}=H,F=_[Q][K]++;return{...H,id:`${Q}t${F}`}});let k=[];if(n==="sequential_difficulty"){const H={easy:1,medium:2,hard:3},Q={g2:1,g1:2,g3:3};k=E.sort((K,F)=>H[K.difficulty]!==H[F.difficulty]?H[K.difficulty]-H[F.difficulty]:Q[K.type]-Q[F.type])}else{const H={g2:1,g1:2,g3:3},Q={easy:1,medium:2,hard:3};k=E.sort((K,F)=>H[K.type]!==H[F.type]?H[K.type]-H[F.type]:Q[K.difficulty]-Q[F.difficulty])}const P=k.map(H=>H.id),I=s==="fixed"?i:{g2:l.g2.easy+l.g2.medium+l.g2.hard,g1:l.g1.easy+l.g1.medium+l.g1.hard,g3:l.g3.easy+l.g3.medium+l.g3.hard};t(P,I)};return c.jsxs("div",{style:{maxWidth:"900px",margin:"40px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[c.jsx("h1",{style:{textAlign:"center",marginBottom:"30px",color:"#333"},children:"Task Allocation Strategy"}),c.jsxs("div",{style:{marginBottom:"30px",lineHeight:"1.6",color:"#555"},children:[c.jsxs("p",{children:["You have ",c.jsxs("strong",{children:[r," minutes"]})," to complete ",c.jsxs("strong",{children:[e," tasks"]}),"."]}),c.jsx("p",{children:"You must decide now how many of each task type you want to perform."}),c.jsxs("p",{children:["Total tasks must add up to ",c.jsx("strong",{children:e}),"."]}),s==="fixed"&&c.jsx("p",{style:{fontSize:"14px",fontStyle:"italic",color:"#666"},children:"* Tasks are automatically distributed as 50% Easy, 30% Medium, 20% Hard."})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"40px",marginBottom:"40px"},children:[c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[s==="fixed"?c.jsxs(c.Fragment,{children:[c.jsxs("div",{style:cc,children:[c.jsxs("label",{style:hc,children:[c.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 1: Slider (Materials)"]}),c.jsx("input",{type:"number",min:"0",max:e,value:i.g2,onChange:m=>A("g2",m.target.value),style:fc})]}),c.jsxs("div",{style:cc,children:[c.jsxs("label",{style:hc,children:[c.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 2: Counting (Research)"]}),c.jsx("input",{type:"number",min:"0",max:e,value:i.g1,onChange:m=>A("g1",m.target.value),style:fc})]}),c.jsxs("div",{style:cc,children:[c.jsxs("label",{style:hc,children:[c.jsx("span",{style:{fontSize:"24px",marginRight:"10px"},children:""}),"Task 3: Typing (Engagement)"]}),c.jsx("input",{type:"number",min:"0",max:e,value:i.g3,onChange:m=>A("g3",m.target.value),style:fc})]})]}):c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[c.jsxs("div",{style:dc,children:[c.jsxs("div",{style:{fontWeight:"bold",marginBottom:"10px",display:"flex",alignItems:"center"},children:[c.jsx("span",{style:{fontSize:"20px",marginRight:"10px"},children:""})," Materials (Slider)"]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[c.jsx(Hn,{label:"Easy",value:l.g2.easy,onChange:m=>S("g2","easy",m)}),c.jsx(Hn,{label:"Medium",value:l.g2.medium,onChange:m=>S("g2","medium",m)}),c.jsx(Hn,{label:"Hard",value:l.g2.hard,onChange:m=>S("g2","hard",m)})]})]}),c.jsxs("div",{style:dc,children:[c.jsxs("div",{style:{fontWeight:"bold",marginBottom:"10px",display:"flex",alignItems:"center"},children:[c.jsx("span",{style:{fontSize:"20px",marginRight:"10px"},children:""})," Research (Counting)"]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[c.jsx(Hn,{label:"Easy",value:l.g1.easy,onChange:m=>S("g1","easy",m)}),c.jsx(Hn,{label:"Medium",value:l.g1.medium,onChange:m=>S("g1","medium",m)}),c.jsx(Hn,{label:"Hard",value:l.g1.hard,onChange:m=>S("g1","hard",m)})]})]}),c.jsxs("div",{style:dc,children:[c.jsxs("div",{style:{fontWeight:"bold",marginBottom:"10px",display:"flex",alignItems:"center"},children:[c.jsx("span",{style:{fontSize:"20px",marginRight:"10px"},children:""})," Engagement (Typing)"]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px"},children:[c.jsx(Hn,{label:"Easy",value:l.g3.easy,onChange:m=>S("g3","easy",m)}),c.jsx(Hn,{label:"Medium",value:l.g3.medium,onChange:m=>S("g3","medium",m)}),c.jsx(Hn,{label:"Hard",value:l.g3.hard,onChange:m=>S("g3","hard",m)})]})]})]}),c.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:L?"#e8f5e9":"#ffebee",borderRadius:"8px",textAlign:"center",fontWeight:"bold",color:L?"#2e7d32":"#c62828"},children:["Total Allocated: ",B," / ",e]}),T&&c.jsx("div",{style:{color:"red",textAlign:"center",fontSize:"14px"},children:T})]}),c.jsxs("div",{style:{border:"1px solid #e0e0e0",borderRadius:"12px",padding:"20px",display:"flex",flexDirection:"column"},children:[c.jsxs("div",{style:{flex:1,marginBottom:"15px",overflowY:"auto",maxHeight:"300px",display:"flex",flexDirection:"column",gap:"10px"},children:[h.length===0&&c.jsx("div",{style:{color:"#999",fontStyle:"italic",textAlign:"center",marginTop:"40px"},children:"Need advice? Ask the AI helper."}),h.map((m,_)=>c.jsxs("div",{style:{background:"#f0f7ff",padding:"10px 15px",borderRadius:"12px 12px 12px 0",alignSelf:"flex-start",maxWidth:"90%"},children:[c.jsx("strong",{children:" AI:"})," ",m.text]},_))]}),c.jsxs("button",{onClick:O,style:{background:"#2196F3",color:"white",border:"none",padding:"12px",borderRadius:"8px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[c.jsx("span",{children:""})," Ask AI for Recommendation"]})]})]}),c.jsx("div",{style:{textAlign:"center"},children:c.jsx("button",{onClick:w,disabled:!L,style:{background:L?"#4CAF50":"#ccc",color:"white",border:"none",padding:"15px 40px",fontSize:"18px",borderRadius:"30px",cursor:L?"pointer":"not-allowed",fontWeight:"bold",boxShadow:L?"0 4px 15px rgba(76, 175, 80, 0.3)":"none",transition:"all 0.2s"},children:"Start Experiment"})})]})}const Hn=({label:t,value:e,onChange:n})=>c.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[c.jsx("label",{style:{fontSize:"12px",marginBottom:"4px",color:"#666"},children:t}),c.jsx("input",{type:"number",min:"0",value:e,onChange:r=>n(r.target.value),style:{width:"50px",padding:"8px",textAlign:"center",border:"1px solid #ddd",borderRadius:"4px"}})]}),cc={display:"flex",alignItems:"center",justifyContent:"space-between",background:"#f9f9f9",padding:"15px",borderRadius:"8px"},dc={background:"#f9f9f9",padding:"15px",borderRadius:"8px",border:"1px solid #eee"},hc={fontWeight:"bold",color:"#333",display:"flex",alignItems:"center"},fc={width:"60px",padding:"10px",fontSize:"18px",textAlign:"center",borderRadius:"6px",border:"1px solid #ddd"};function CI({currentTaskIndex:t,totalTasks:e,taskQueue:n,onSwitchTask:r,children:s,points:i,timeRemaining:a,onTimeUp:l,chatInterface:u}){const h=n[t],p=A=>A.startsWith("g1")?{name:"Research",icon:"",color:"#9C27B0"}:A.startsWith("g2")?{name:"Materials",icon:"",color:"#4CAF50"}:A.startsWith("g3")?{name:"Engagement",icon:"",color:"#f44336"}:{name:"Unknown",icon:"",color:"#333"},g=p(h),y=n.slice(t+1),T=y.some(A=>A.startsWith("g1")),C=y.some(A=>A.startsWith("g2")),b=y.some(A=>A.startsWith("g3")),O=t;return c.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",padding:"20px"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"white",padding:"15px 25px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginBottom:"20px"},children:[c.jsx("div",{style:{width:"200px"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("span",{style:{fontSize:"24px"},children:""}),c.jsx("div",{children:c.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:a<60?"#f44336":"#333",animation:a<60?"pulse 1s infinite":"none"},children:[Math.floor(a/60),":",(a%60).toString().padStart(2,"0")]})})]})}),c.jsxs("div",{style:{textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Total Points"}),c.jsx("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#2196F3"},children:i})]}),c.jsxs("div",{style:{textAlign:"right",width:"200px"},children:[c.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Task Progress"}),c.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[O," / ",e]})]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr 320px",gap:"20px",alignItems:"start"},children:[c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[c.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)"},children:[c.jsx("h3",{style:{marginTop:0,fontSize:"16px",color:"#555"},children:"Switch Task"}),c.jsx("p",{style:{fontSize:"13px",color:"#777",marginBottom:"15px"},children:"Pause current task and switch to another type. The current task will be moved to the end of the queue."}),c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[c.jsxs("button",{disabled:!C||h.startsWith("g2"),onClick:()=>r("g2"),style:pc(C&&!h.startsWith("g2"),"#4CAF50"),children:[c.jsx("span",{children:""})," Switch to Materials"]}),c.jsxs("button",{disabled:!T||h.startsWith("g1"),onClick:()=>r("g1"),style:pc(T&&!h.startsWith("g1"),"#9C27B0"),children:[c.jsx("span",{children:""})," Switch to Research"]}),c.jsxs("button",{disabled:!b||h.startsWith("g3"),onClick:()=>r("g3"),style:pc(b&&!h.startsWith("g3"),"#f44336"),children:[c.jsx("span",{children:""})," Switch to Engagement"]})]})]}),c.jsxs("div",{style:{background:"#f8f9fa",padding:"15px",borderRadius:"12px",fontSize:"12px",color:"#666"},children:[c.jsx("strong",{children:"Next up:"}),c.jsxs("div",{style:{marginTop:"10px",display:"flex",gap:"5px",flexWrap:"wrap"},children:[y.slice(0,5).map((A,S)=>c.jsx("span",{style:{background:p(A).color,color:"white",padding:"2px 6px",borderRadius:"4px",opacity:.7},children:p(A).icon},S)),y.length>5&&c.jsxs("span",{children:["+",y.length-5," more"]})]})]})]}),c.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 10px rgba(0,0,0,0.05)",minHeight:"500px"},children:[c.jsxs("div",{style:{marginBottom:"20px",paddingBottom:"15px",borderBottom:"1px solid #eee",display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("span",{style:{fontSize:"24px"},children:g.icon}),c.jsxs("h2",{style:{margin:0,color:g.color},children:["Current: ",g.name]})]}),s]}),c.jsx("div",{children:u&&c.jsx("div",{style:{position:"sticky",top:"20px"},children:u})})]}),c.jsx("style",{children:`
        @keyframes pulse {
          0% { opacity: 1; }
          50% { opacity: 0.5; }
          100% { opacity: 1; }
        }
      `})]})}const pc=(t,e)=>({display:"flex",alignItems:"center",gap:"10px",padding:"12px",border:`1px solid ${t?e:"#ddd"}`,borderRadius:"8px",background:t?"white":"#f5f5f5",color:t?e:"#999",cursor:t?"pointer":"not-allowed",fontWeight:"bold",transition:"all 0.2s",opacity:t?1:.7});function kI({timeRemaining:t,onSelectTask:e,onFinishEarly:n}){return c.jsxs("div",{style:{maxWidth:"800px",margin:"40px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[c.jsx("h1",{style:{color:"#2196F3",marginBottom:"20px"},children:" All Tasks Completed!"}),c.jsxs("div",{style:{fontSize:"18px",color:"#555",marginBottom:"30px",lineHeight:"1.6"},children:[c.jsx("p",{children:"You have finished all 10 allocated tasks with time to spare."}),c.jsxs("p",{children:["You currently have ",c.jsxs("strong",{children:[Math.floor(t/60)," minutes and ",t%60," seconds"]})," remaining."]}),c.jsxs("p",{children:["You can choose to do more tasks for ",c.jsx("strong",{children:"1/2 credit"})," to increase your score, or finish the experiment now."]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"20px",marginBottom:"40px"},children:[c.jsxs("button",{onClick:()=>e("g2"),style:mc("#4CAF50"),children:[c.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Materials Task",c.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),c.jsxs("button",{onClick:()=>e("g1"),style:mc("#9C27B0"),children:[c.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Research Task",c.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]}),c.jsxs("button",{onClick:()=>e("g3"),style:mc("#f44336"),children:[c.jsx("span",{style:{fontSize:"32px",display:"block",marginBottom:"10px"},children:""}),"Do Engagement Task",c.jsx("div",{style:{fontSize:"12px",opacity:.8,marginTop:"5px"},children:"(50% Points)"})]})]}),c.jsx("div",{style:{borderTop:"1px solid #eee",paddingTop:"30px"},children:c.jsx("button",{onClick:n,style:{background:"#f5f5f5",color:"#666",border:"1px solid #ddd",padding:"12px 30px",fontSize:"16px",borderRadius:"30px",cursor:"pointer",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:r=>r.target.style.background="#e0e0e0",onMouseLeave:r=>r.target.style.background="#f5f5f5",children:"No thanks, I'm done"})})]})}const mc=t=>({background:"white",border:`2px solid ${t}`,color:t,padding:"20px",borderRadius:"12px",cursor:"pointer",fontSize:"16px",fontWeight:"bold",transition:"all 0.2s",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"});function RI(t,e){const n=t.length,r=e.length,s=Array(n+1).fill(null).map(()=>Array(r+1).fill(0));for(let i=0;i<=n;i++)s[i][0]=i;for(let i=0;i<=r;i++)s[0][i]=i;for(let i=1;i<=n;i++)for(let a=1;a<=r;a++)t[i-1]===e[a-1]?s[i][a]=s[i-1][a-1]:s[i][a]=Math.min(s[i-1][a]+1,s[i][a-1]+1,s[i-1][a-1]+1);return s[n][r]}function PI(){const e=new URLSearchParams(window.location.search).get("admin")==="berkeley2024",[n,r]=j.useState("landing"),[s,i]=j.useState(null),[a,l]=j.useState(null),[u,h]=j.useState("g2t1"),[p,g]=j.useState({}),[y,T]=j.useState(0),[C,b]=j.useState(null),[O,A]=j.useState(!1),[S,R]=j.useState(""),[M,B]=j.useState(!0),[L,w]=j.useState(0),[m,_]=j.useState({}),[E,k]=j.useState(0),[P,I]=j.useState(0),[H,Q]=j.useState(!1),[K,F]=j.useState(null),[x,N]=j.useState(!1),[U,J]=j.useState(30),[ee,le]=j.useState(!1),[me,fe]=j.useState(5),[pe,Z]=j.useState(!1),[oe,ve]=j.useState(0),[ne,be]=j.useState(1),[Be]=j.useState(2),[De,xt]=j.useState([]),[Gt,Qt]=j.useState(null),[Kt,Yt]=j.useState(!1),[ur,cr]=j.useState(0),[Pn,dr]=j.useState(null),[Ne,Ri]=j.useState({g2t1:!1,g1t1:!1,g3t1:!1}),[ra,rt]=j.useState(720),[Ke,hr]=j.useState(720),[Es,sa]=j.useState(0),[Ie,vn]=j.useState({materials:0,research:0,engagement:0,bonus:0}),[qr,Ts]=j.useState({}),[ia,oa]=j.useState({}),[pf,Is]=j.useState({}),[_t,aa]=j.useState({semesterDuration:12,totalTasks:10,totalSemesters:2,midtermEnabled:!0,aiCost:0,unfinishedTaskPenalty:0,taskOrderStrategy:"sequential_task",freezePenalty:0,contextAdviceEnabled:!0,difficultyMode:"fixed"});j.useEffect(()=>{(async()=>{try{const W=Nt($e,"game_settings","global"),q=await hf(W);if(q.exists()){const se=q.data();if(aa(ge=>({...ge,...se})),se.semesterDuration){const ge=se.semesterDuration*60;rt(ge),hr(ge),Su.current=ge,Qr.current=ge}}}catch(W){console.error("Error loading global config:",W)}})()},[]);const[Xt,Gr]=j.useState([]),[bn,Dn]=j.useState(0),[_u,As]=j.useState(null),[wu,Cs]=j.useState(!1),ks=j.useRef(Date.now()),Ye=j.useRef(null);j.useRef(null),j.useRef(null);const Rs=j.useRef(null),fr=j.useRef(Date.now()),Qr=j.useRef(720),Su=j.useRef(720),Kr=()=>{const Y=(_t.semesterDuration||12)*60*1e3,W=Math.floor(Y/2e3);return Math.floor(W/60)};if(j.useEffect(()=>{(async()=>{try{const W=new URLSearchParams(window.location.search),q=W.has("code")||W.has("c");if((W.get("code")||W.get("c"))==="ADMIN-MASTER"){sessionStorage.setItem("gameConfig",JSON.stringify({role:"master_admin",section:"master_admin",hasAI:!1,isMasterInterface:!0,displayName:"Master Administrator"})),B(!1);return}if(e&&!sessionStorage.getItem("gameConfig")&&sessionStorage.setItem("gameConfig",JSON.stringify({role:"admin",section:"admin",hasAI:!0,checkpointSemester2:!0,displayName:"Admin User"})),!q){r("studentLogin"),B(!1);return}const{allowed:ge,reason:ke,resumeSession:Re,newSession:st,code:wt,codeData:bt}=await Qm.checkAccess();if(!ge){A(!0),R(ke),B(!1);return}if(Re)b(Re),localStorage.setItem("sessionId",Re);else if(st){const Ot=await Qm.createSession(wt,bt);b(Ot)}await Le.syncOfflineEvents(),B(!1)}catch{B(!1)}})()},[]),j.useEffect(()=>{n==="complete"&&ne>=Be&&II.notifyGameComplete({finalScore:Math.round(Jt())+(Ie.bonus||0),totalTime:L,semestersCompleted:ne,sessionId:C})},[n,ne,Be,L,Ie.bonus,C]),j.useEffect(()=>{localStorage.setItem("currentTask",u)},[u]),j.useEffect(()=>{localStorage.setItem("gameMode",JSON.stringify(s))},[s]),j.useEffect(()=>{localStorage.setItem("currentSemester",ne.toString())},[ne]),j.useEffect(()=>{localStorage.setItem("totalSemesters",Be.toString())},[Be]),j.useEffect(()=>{localStorage.setItem("completedTasksCount",Object.keys(p).length.toString())},[p]),j.useEffect(()=>{localStorage.setItem("completedLevels",y.toString())},[y]),j.useEffect(()=>{localStorage.setItem("totalSwitches",E.toString())},[E]),j.useEffect(()=>{localStorage.setItem("categoryPoints",JSON.stringify(Ie))},[Ie]),j.useEffect(()=>{localStorage.setItem("studentLearningScore",Es.toString())},[Es]),j.useEffect(()=>{const Y=Ne.g2t1&&Ne.g1t1&&Ne.g3t1;localStorage.setItem("practiceCompleted",Y.toString())},[Ne]),M)return c.jsx("div",{className:"app",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:c.jsx("h2",{children:"Loading..."})});if(window.location.search.includes("master=true")&&JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="master_admin")return c.jsx(TI,{});if(window.location.search.includes("admin=true"))return c.jsx(SI,{});const Jt=(Y=Ie,W=qr)=>{let q=0;Object.entries(W).forEach(([st,wt])=>{const Ot=1+parseInt(st)*.15;q+=wt*Ot});const se=parseFloat(localStorage.getItem("engagementInterest")||"0")||0,ge=q+se,ke=Y.materials||0,Re=Y.research||0;return console.log(` STUDENT LEARNING: ${ge.toFixed(1)} pts | Materials: ${ke} (with sequential multipliers) | Research: ${Re} | Interest: ${se.toFixed(1)} = ${ge.toFixed(1)}`),isNaN(ge)?0:ge},Eu=()=>{if(!(ne===2&&_t.midtermEnabled))return;Yt(!0),Jt()>=300?(cr(300),vn(se=>({...se,bonus:(se.bonus||0)+300}))):cr(0),Q(!0),F("checkpoint")},la=()=>{const Y=(_t.semesterDuration||12)*60*1e3,W=Math.floor(Y/1e3);rt(W),hr(W),ks.current=Date.now(),Ye.current=setInterval(()=>{const se=Date.now()-ks.current,ge=Math.floor(se/1e3);w(ge);const ke=Math.max(0,W-ge);if(hr(ke),ge%10===0&&C&&!C.startsWith("offline-")&&Kn(Nt($e,"sessions",C),{timeElapsed:ge,lastUpdated:fn()}).catch(st=>console.error("Failed to update session time:",st)),ne===2&&_t.midtermEnabled){const st=(_t.semesterDuration||12)*60*1e3,wt=Math.floor(st/2e3);ge===wt&&!Kt&&Eu()}ke<=0&&(clearInterval(Ye.current),Ye.current=null,pr("semester_complete"))},1e3)},Yr=Y=>{const q=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin",se=Ne.g2t1&&Ne.g1t1&&Ne.g3t1;l(Y),Le.logEvent("practice_choice",{choice:Y}),Y==="no"?!q&&!se?(Nn("You must complete all three practice tasks first!"),r("practice")):Pi():r("practice")},Pi=()=>{if(!Gt){const Y=Math.floor(Math.random()*1e6);Qt(Y),er.initializeSeed(Y),C&&!C.startsWith("offline-")&&Kn(Nt($e,"sessions",C),{randomSeed:Y,[`semesterSeeds.semester${ne}`]:Y})}localStorage.setItem("engagementInterest","0"),vn({materials:0,research:0,engagement:0,bonus:0}),Ts({}),r("allocation"),g({}),T(0),k(0),I(0),Yt(!1),oa({}),Is({})},bi=(Y,W)=>{Gr(Y),As(W),Dn(0),r("challenge");const se=`${Y[0]}t1`;h(se),_({[se]:Date.now()}),Le.setPageStartTime(se),la(),Le.logEvent("allocation_complete",{counts:W,queue:Y,timestamp:Date.now()})},Ps=Y=>{if(Xt[bn]===Y)return;const q=[...Xt],se=q.splice(bn,1)[0];q.push(se);const ge=q.findIndex((ke,Re)=>Re>=bn&&ke.startsWith(Y));if(ge!==-1){const ke=q.splice(ge,1)[0];q.splice(bn,0,ke),Gr(q),k(Ot=>Ot+1);const Re=ke,wt=Object.keys(p).filter(Ot=>Ot.startsWith(Re)).length+1,bt=`${Re}t${wt}`;bs(bt)}},un=async(Y,W)=>{fr.current=Date.now();let q=0;const se=Y.startsWith("g1")?"research":Y.startsWith("g2")?"materials":"engagement";if(se==="materials")if(W.points!==void 0)q=W.points;else{const ue=parseFloat(W.userAnswer||W.userValue||0),Xe=parseFloat(W.correctAnswer||W.targetValue||0),Zt=Math.abs(ue-Xe);Zt===0?q=2:Zt<=1?q=1:q=0}else if(se==="research")if(W.points!==void 0)q=W.points;else{const ue=parseInt(W.userAnswer||0),Xe=parseInt(W.correctAnswer||0),Zt=Math.abs(ue-Xe);Zt===0?q=2:Zt<=1?q=1:q=0}else if(se==="engagement")if(W.points!==void 0)q=W.points;else{const ue=W.userAnswer||"",Xe=W.correctAnswer||"";ue===Xe?q=2:RI(ue,Xe)===1?q=1:q=0}if(vn(ue=>{const Xe={...ue,[se]:ue[se]+q};return console.log(` Updated ${se}: +${q} (total: ${Xe[se]})`),Xe}),se==="materials"&&q>0){const ue=Ie.research;Ts(Xe=>{const Zt=Xe[ue]||0;return{...Xe,[ue]:Zt+q}})}const ke=.0015*(se==="engagement"?Ie.engagement+q:Ie.engagement),Re={...Ie,[se]:Ie[se]+q};let st=qr;if(se==="materials"&&q>0){const ue=Ie.research,Xe=qr[ue]||0;st={...qr,[ue]:Xe+q}}let wt=0;Object.entries(st).forEach(([ue,Xe])=>{const Ns=1+parseInt(ue)*.15;wt+=Xe*Ns});const Ot=parseFloat(localStorage.getItem("engagementInterest")||"0")+ke*wt;localStorage.setItem("engagementInterest",Ot.toString()),Is(ue=>({...ue,[Y]:q})),oa(ue=>({...ue,[Y]:(ue[Y]||0)+1}));const ca={...Ie,[se]:Ie[se]+q},Xr=Jt(ca,st);sa(Xr);let Ft="";if(se==="materials"){const ue=Math.abs((W.userValue||0)-(W.targetValue||0));ue===0?Ft="Perfect materials!":ue<=1?Ft=`Off by ${ue.toFixed(2)}`:Ft=`Off by ${ue.toFixed(2)}`}else if(se==="research"){const ue=Math.abs((W.userAnswer||0)-(W.correctAnswer||0));ue===0?Ft="Perfect research!":ue<=1?Ft=`Off by ${ue}`:Ft=`Off by ${ue}`}else se==="engagement"&&(q===2?Ft="Perfect engagement!":q===1?Ft="One typo":Ft="Multiple errors");Nn(`${Ft} | +${q} ${se} pts`),g(ue=>({...ue,[Y]:!0})),T(ue=>ue+1),I(ue=>ue+1),await Le.trackTaskComplete(Y,W.attempts,W.totalTime,W.accuracy||W.difference||0),await Le.logEvent("task_complete",{taskId:Y,...W,pointsEarned:q,categoryPoints:Re,studentLearningScore:Xr,engagementInterest:Ot,completionContext:{totalTasksCompleted:Object.keys(p).length+1,currentGameTime:L,switchesBeforeCompletion:E,bonusPromptsEarned:P+1,timeRemaining:Ke}}),C&&!C.startsWith("offline-")&&await Kn(Nt($e,"sessions",C),{[`completedTasks.${Y}`]:!0,[`taskPoints.${Y}`]:q,categoryPoints:Re,studentLearningScore:Xr,engagementInterest:Ot,bonusPrompts:P+1,lastActivity:fn()});const Ds=bn+1;if(Ds<Xt.length){Dn(Ds);const ue=Xt[Ds];let Xe=Object.keys(p).filter(da=>da.startsWith(ue)).length;ue===Y.substring(0,2)&&Y.startsWith(ue)&&(Xe+=1);const Zt=Xe+1,Ns=`${ue}t${Zt}`;bs(Ns,!0)}else Ke>0?r("bonus_round"):pr("all_tasks_done")},bs=async(Y,W=!1)=>{if(!H){if(p[Y]&&!W){Nn("Task already completed! Choose a different task.");return}if(W||await Le.logEvent("manual_tab_switch",{from:u,to:Y,reason:"user_clicked"}),fr.current=Date.now(),ee&&(le(!1),fe(5),Rs.current&&(clearInterval(Rs.current),Rs.current=null)),u!==Y&&!W&&k(q=>q+1),await Le.trackPageSwitch(u,Y,W),m[u]){const q=Date.now()-m[u];await Le.logEvent("task_time",{taskId:u,timeSpent:q,completed:p[u]||!1,leftForTask:Y})}h(Y),_(q=>({...q,[Y]:Date.now()})),Le.setPageStartTime(Y)}},Nn=Y=>{const W=document.createElement("div");W.className="notification-enter",W.style.cssText="position: fixed; bottom: 20px; left: 20px; background: #2196F3; color: white; padding: 15px 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000; max-width: 400px;",W.textContent=Y,document.body.appendChild(W),setTimeout(()=>{W.className="notification-exit",setTimeout(()=>{document.body.contains(W)&&document.body.removeChild(W)},500)},3e3)},pr=async(Y="semester_complete")=>{Ye.current&&clearInterval(Ye.current);const W=Math.floor((Date.now()-ks.current-oe)/1e3),q=Jt(),se=Ie.bonus||0,ge=Math.max(0,_t.totalTasks-Object.keys(p).length),ke=ge*(_t.unfinishedTaskPenalty||0),Re=Math.round(q)+se-ke;ke>0&&console.log(` Unfinished Penalty: -${ke} pts (${ge} tasks x ${_t.unfinishedTaskPenalty})`),await Le.logEvent("game_complete",{totalTime:W,totalSwitches:E,completedTasks:Object.keys(p).length,completedLevels:y,completionReason:Y,gameMode:s,currentSemester:ne,categoryPoints:Ie,studentLearningScore:q,totalBonus:se,finalScore:Re,finalContext:{practiceCompleted:a==="yes",totalPrompts:3+P,isAdminMode:e}}),C&&!C.startsWith("offline-")&&await Kn(Nt($e,"sessions",C),{status:"completed",completedAt:fn(),finalTime:W,timeElapsed:W,totalSwitches:E,completionReason:Y,currentSemester:ne,finalScore:Re,studentLearningScore:q}),r("complete")},xn=(Y,W)=>{if(W&&W.points&&W.points===2)Ri(q=>({...q,[Y]:!0})),Nn("Perfect! Practice task completed."),setTimeout(()=>{dr(null)},1500);else{const q=(W==null?void 0:W.points)||0;Nn(`Practice requires 100% accuracy. You scored ${q===1?"50%":"0%"}. Try again!`),setTimeout(()=>{dr(null)},2e3)}},ua=()=>{const Y=u[1],W=parseInt(u.substring(3)),q=n==="practice";return Y==="1"?c.jsx(bd,{taskNum:W,onComplete:q?xn:un,currentTaskId:u,isPractice:q}):Y==="2"?c.jsx(Dd,{taskNum:W,onComplete:q?xn:un,currentTaskId:u,isPractice:q}):c.jsx(Nd,{taskNum:W,onComplete:q?xn:un,currentTaskId:u,isPractice:q})};if(n==="studentLogin")return c.jsx(wI,{onLoginSuccess:Y=>{window.location.href=`${window.location.origin}?code=${Y}`}});if(O)return c.jsx("div",{className:"app",children:c.jsxs("div",{style:{maxWidth:"600px",margin:"50px auto",padding:"30px",background:"white",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[c.jsx("h2",{style:{color:"#f44336",marginBottom:"20px"},children:"Access Denied"}),c.jsx("p",{style:{fontSize:"18px",marginBottom:"20px"},children:S}),c.jsx("div",{style:{padding:"15px",background:"#ffebee",borderRadius:"8px",border:"1px solid #f44336"},children:c.jsx("p",{style:{color:"#c62828",margin:0},children:"If you believe this is an error, please contact your instructor."})})]})});if(n==="semesterBreak"){const Y=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),W=ne===2&&Y.checkpointSemester2;return c.jsx("div",{className:"app",children:c.jsxs("div",{style:{maxWidth:"700px",margin:"50px auto",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",textAlign:"center"},children:[c.jsxs("h1",{style:{color:"#2196F3",marginBottom:"30px"},children:[" Semester ",ne-1," Complete!"]}),c.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[c.jsx("h3",{style:{color:"#1976d2",marginBottom:"10px"},children:"Take a Break!"}),c.jsxs("p",{style:{fontSize:"16px",color:"#666",marginBottom:"0"},children:["Great job completing Semester ",ne-1,"! Take a moment to rest your eyes, stretch, or grab some water before continuing."]})]}),W&&c.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffebee 100%)",padding:"25px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #ff9800"},children:[c.jsx("h3",{style:{color:"#f57c00",marginBottom:"15px"},children:" Midterm Checkpoint Coming!"}),c.jsxs("div",{style:{fontSize:"16px",color:"#666",textAlign:"left"},children:[c.jsx("p",{style:{marginBottom:"10px"},children:c.jsxs("strong",{children:["Semester 2 includes a midterm exam at the"," ",Kr(),"-minute mark!"]})}),c.jsxs("ul",{style:{marginLeft:"20px",marginBottom:"10px"},children:[c.jsx("li",{children:"Your students will be tested at the midpoint"}),c.jsxs("li",{children:["If student learning  300 points:"," ",c.jsx("strong",{children:"+300 bonus points!"})]}),c.jsx("li",{children:"Build up your teaching effectiveness early to maximize the bonus"})]}),c.jsxs("p",{style:{background:"white",padding:"10px",borderRadius:"4px",textAlign:"center",fontWeight:"bold",color:"#f57c00"},children:["Goal: Reach 300+ Student Learning by minute"," ",Kr()]})]})]}),De.length>0&&c.jsxs("div",{style:{background:"#f5f5f5",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[c.jsx("h4",{style:{color:"#666",marginBottom:"10px"},children:"Your Performance So Far:"}),De.map((q,se)=>c.jsxs("div",{style:{marginBottom:"8px",fontSize:"16px"},children:["Semester ",se+1,":"," ",c.jsxs("strong",{children:[q.finalScore," points"]})]},se))]}),c.jsxs("div",{style:{marginTop:"30px"},children:[c.jsxs("button",{onClick:()=>{r("challenge"),la(),_({g2t1:Date.now()}),Le.setPageStartTime("g2t1"),Le.logEvent("semester_start",{semester:ne,timestamp:Date.now(),hasCheckpoint:W})},style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"all 0.3s"},onMouseOver:q=>{q.currentTarget.style.transform="translateY(-2px)",q.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:q=>{q.currentTarget.style.transform="translateY(0)",q.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.1)"},children:["I'm Ready - Start Semester ",ne]}),c.jsx("p",{style:{marginTop:"15px",fontSize:"14px",color:"#999"},children:"Click when you're ready to continue. The timer will start immediately."})]})]})})}if(n==="landing"){s||i({accuracy:"lenient",limit:"time"});const Y=JSON.parse(sessionStorage.getItem("gameConfig")||"{}"),W=Y.role==="admin";return c.jsx("div",{className:"app",children:c.jsx("div",{className:"landing-container",children:c.jsxs("div",{className:"landing-card",style:{padding:"40px",maxWidth:"900px"},children:[c.jsxs("h1",{style:{color:"#333",marginBottom:"30px",fontSize:"32px",textAlign:"left"},children:["Can you beat Park? - Semester ",ne,"/",Be]}),c.jsxs("div",{className:"game-info",style:{textAlign:"left"},children:[c.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[c.jsxs("h3",{style:{color:"#f44336",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("span",{style:{fontSize:"24px"},children:""})," Engagement"]}),c.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Build interest that compounds! Each point adds 0.15% interest after every task completion."})]}),c.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[c.jsxs("h3",{style:{color:"#9C27B0",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("span",{style:{fontSize:"24px"},children:""})," Research"]}),c.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Research amplifies your FUTURE materials! Each point adds +15% multiplier to materials earned after the research (order matters!)."})]}),c.jsxs("div",{style:{marginBottom:"35px",textAlign:"left"},children:[c.jsxs("h3",{style:{color:"#4CAF50",fontSize:"20px",marginBottom:"12px",display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("span",{style:{fontSize:"24px"},children:""})," Materials"]}),c.jsx("p",{style:{marginLeft:"34px",fontSize:"16px",lineHeight:"1.6",color:"#555"},children:"Create teaching materials - each point directly contributes to your goal points!"})]}),c.jsxs("div",{style:{background:"#f0f8ff",borderRadius:"8px",padding:"25px",marginBottom:"30px",border:"2px solid #2196F3"},children:[c.jsxs("h3",{style:{color:"#2196F3",fontSize:"20px",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[c.jsx("span",{style:{fontSize:"24px"},children:""})," Student Learning Formula"]}),c.jsxs("div",{style:{background:"white",padding:"18px",borderRadius:"6px",fontFamily:"monospace",fontSize:"18px",textAlign:"center",marginBottom:"20px",border:"1px solid #e0e0e0",lineHeight:"1.8"},children:["Goal ="," ",c.jsx("strong",{children:"Materials  (1 + Research0.15) + Engagement Interest"}),c.jsx("br",{}),c.jsxs("div",{style:{fontSize:"14px",marginTop:"10px",fontFamily:"sans-serif"},children:["Research multipliers apply only to materials earned"," ",c.jsx("em",{children:"after"})," the research"]})]}),c.jsxs("ul",{style:{color:"#333",lineHeight:"2",margin:"0",paddingLeft:"25px",fontSize:"15px",textAlign:"left"},children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Scoring:"})," Exact = 2 pts | Within 1 = 1 pt | Otherwise = 0 pts"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Timing:"})," Task completion order affects your final score"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Strategy:"})," Think carefully about when to complete each task type!"]}),ne===2&&c.jsxs("li",{children:["At minute ",Kr(),": Exam checkpoint with bonus opportunity (300+ Student Learning = 300 bonus)"]})]})]}),Y.hasAI&&c.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"1px solid #ffc107"},children:[c.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:"AI Assistant Available:"}),c.jsxs("ul",{style:{color:"#856404",lineHeight:"1.6",margin:"0",paddingLeft:"20px",fontSize:"14px"},children:[c.jsx("li",{children:"Click the help buttons below each task for AI assistance"}),c.jsx("li",{children:"Unlimited use but reliability varies"}),c.jsx("li",{children:'Type "strategy" or "order" in chat for strategic advice!'})]})]}),ne===2&&c.jsxs("div",{style:{background:"#fff3cd",borderRadius:"6px",padding:"15px",marginBottom:"20px",border:"2px solid #ffc107"},children:[c.jsx("h3",{style:{color:"#856404",fontSize:"16px",marginBottom:"10px"},children:" Semester 2: Midterm Checkpoint!"}),c.jsxs("p",{style:{color:"#856404",fontSize:"14px",margin:0},children:["At the ",Kr(),"-minute mark, if you have 300+ student learning points, you'll earn a 300-point bonus!"]})]})]}),!W&&c.jsxs("div",{style:{background:"linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)",borderRadius:"12px",padding:"20px",marginTop:"20px",marginBottom:"20px",border:"2px solid #d32f2f",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",marginBottom:"12px"},children:[c.jsx("span",{style:{fontSize:"24px"},children:""}),c.jsx("h3",{style:{color:"#b71c1c",margin:0,fontSize:"18px",fontWeight:"600"},children:"ONE ATTEMPT ONLY - NO RESTART"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"12px"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),c.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[c.jsx("strong",{children:"No refresh/close"})," - Session ends"]})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("span",{style:{color:"#d32f2f",fontSize:"18px"},children:""}),c.jsxs("span",{style:{fontSize:"14px",color:"#c62828"},children:[c.jsx("strong",{children:"No tab switching"})," - 30s warning"]})]})]}),c.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"6px",textAlign:"center",fontSize:"14px",color:"#b71c1c",fontWeight:"600"},children:" Ensure 40 minutes uninterrupted before starting"})]}),c.jsxs("button",{className:"start-button",onClick:()=>r("practiceChoice"),children:["Start Semester ",ne]}),e&&c.jsxs("div",{style:{marginTop:"20px",padding:"10px",background:"#ffcccb",borderRadius:"6px",border:"2px solid #ff0000",fontWeight:"bold",color:"#d00"},children:["ADMIN MODE: ",ra/60," minute timer, checkpoint at"," ",Kr(),"minute"]}),De.length>0&&c.jsxs("div",{style:{marginTop:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"6px",fontSize:"14px"},children:[c.jsx("strong",{children:"Previous Semesters:"}),De.map((q,se)=>c.jsxs("div",{style:{marginTop:"5px"},children:["Semester ",se+1,": ",q.finalScore," points"]},se))]})]})})})}if(n==="practiceChoice"){const W=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";return c.jsx("div",{className:"app",children:c.jsx("div",{className:"landing-container",children:c.jsxs("div",{className:"landing-card",children:[c.jsx("h2",{style:{color:"#333",marginBottom:"20px"},children:W?"Practice Mode (Optional for Admin)":"Practice Mode (Required)"}),c.jsx("p",{style:{color:"#666",marginBottom:"20px"},children:W?"As an admin, you can skip practice or try it first.":"You must complete all three practice tasks before starting the main game."}),c.jsx("p",{style:{color:"#888",fontSize:"14px",marginBottom:"30px",fontStyle:"italic"},children:"Practice lets you try each teaching task without time pressure."}),!W&&c.jsxs("div",{style:{background:"linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)",borderRadius:"12px",padding:"20px",marginBottom:"20px",border:"2px solid #1976d2",boxShadow:"0 4px 6px rgba(25, 118, 210, 0.1)"},children:[c.jsxs("h4",{style:{color:"#0d47a1",margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px"},children:[c.jsx("span",{style:{fontSize:"20px"},children:""}),"Required Practice Tasks (100% accuracy needed):"]}),c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Ne.g2t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Ne.g2t1?"#4CAF50":"#e0e0e0"}`},children:[c.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),c.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:c.jsx("strong",{children:"Materials"})}),Ne.g2t1?c.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):c.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Ne.g1t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Ne.g1t1?"#4CAF50":"#e0e0e0"}`},children:[c.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),c.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:c.jsx("strong",{children:"Research"})}),Ne.g1t1?c.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):c.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"12px 16px",background:Ne.g3t1?"#e8f5e9":"white",borderRadius:"8px",border:`1px solid ${Ne.g3t1?"#4CAF50":"#e0e0e0"}`},children:[c.jsx("span",{style:{fontSize:"24px",marginRight:"12px"},children:""}),c.jsx("span",{style:{flex:1,fontSize:"15px",color:"#424242"},children:c.jsx("strong",{children:"Engagement"})}),Ne.g3t1?c.jsx("span",{style:{color:"#4CAF50",fontSize:"20px",fontWeight:"bold"},children:""}):c.jsx("span",{style:{background:"#fff3cd",color:"#f57c00",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:"PENDING"})]})]}),c.jsx("div",{style:{marginTop:"16px",padding:"8px 12px",background:"rgba(255, 255, 255, 0.8)",borderRadius:"6px",fontSize:"13px",color:"#0d47a1",textAlign:"center",fontStyle:"italic"},children:" Each task must be completed perfectly to proceed"})]}),c.jsxs("div",{style:{display:"flex",gap:"20px",justifyContent:"center"},children:[c.jsx("button",{onClick:()=>Yr("yes"),style:{padding:"15px 30px",background:"#4CAF50",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:W?"Try Practice Mode":"Start Required Practice"}),W&&c.jsx("button",{onClick:()=>Yr("no"),style:{padding:"15px 30px",background:"#2196F3",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",cursor:"pointer"},children:"Skip Practice (Admin)"})]})]})})})}if(n==="practice"){const W=JSON.parse(sessionStorage.getItem("gameConfig")||"{}").role==="admin";if(!Pn)return c.jsxs("div",{className:"app",children:[c.jsx("h1",{children:"Teaching Simulation - Practice Mode"}),c.jsx(vI,{practiceCompleted:Ne,onPracticeComplete:xn,onSelectPractice:dr,onStartMainGame:()=>{const ge=Ne.g2t1&&Ne.g1t1&&Ne.g3t1;!W&&!ge?Nn("You must complete all three practice tasks first!"):Pi()},isAdmin:W})]});const q=Pn[1],se=1;return c.jsx("div",{className:"app",children:c.jsxs("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[c.jsx("button",{onClick:()=>dr(null),style:{marginBottom:"20px",padding:"10px 20px",background:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:" Back to Practice Menu"}),c.jsxs("div",{style:{textAlign:"center",padding:"10px",background:"#fff3cd",borderRadius:"6px",margin:"10px 0",fontSize:"14px",color:"#856404"},children:[c.jsx("strong",{children:"Practice Mode:"})," 100% accuracy required. Will auto-return after completion."]}),q==="1"&&c.jsx(bd,{taskNum:se,onComplete:xn,currentTaskId:Pn,isPractice:!0}),q==="2"&&c.jsx(Dd,{taskNum:se,onComplete:xn,currentTaskId:Pn,isPractice:!0}),q==="3"&&c.jsx(Nd,{taskNum:se,onComplete:xn,currentTaskId:Pn,isPractice:!0})]})})}if(n==="complete"){const Y=Math.floor(L/60),W=L%60,q=Math.round(Jt()),se=Ie.bonus||0,ge=q+se,ke={semester:ne,totalTime:L,completedLevels:y,categoryPoints:Ie,switches:E,gameMode:s,randomSeed:Gt,studentLearningScore:q,finalScore:ge},Re=async()=>{const wt=[...De,ke];xt(wt),localStorage.setItem("engagementInterest","0"),vn({materials:0,research:0,engagement:0,bonus:0}),Ts({}),C&&!C.startsWith("offline-")&&await Kn(Nt($e,"sessions",C),{[`semesterHistory.semester${ne}`]:ke,currentSemester:ne+1,lastActivity:fn()}),be(ne+1),Ct.resetForNewSemester(),r("semesterBreak"),g({}),T(0),k(0),I(0),w(0),ve(0),h("g2t1"),Yt(!1);const bt=Math.floor(Math.random()*1e6);Qt(bt),er.initializeSeed(bt)},st=ne>=Be;return c.jsxs("div",{className:"app",children:[c.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[c.jsx("div",{style:{textAlign:"center",marginBottom:"20px",padding:"15px",background:"#e3f2fd",borderRadius:"8px",border:"2px solid #2196F3"},children:c.jsxs("h2",{style:{color:"#2196F3",margin:0},children:["Semester ",ne," of ",Be," Complete!"]})}),st&&c.jsx(EI,{sessionId:C,completedLevels:y,totalTime:L,gameMode:s}),c.jsxs("div",{style:{textAlign:"center",padding:"40px",background:"white",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",marginTop:"20px"},children:[c.jsxs("h2",{style:{color:"#333",marginBottom:"20px"},children:[" Semester ",ne," Performance"]}),c.jsxs("div",{style:{fontSize:"36px",fontWeight:"bold",color:"#2196F3",marginBottom:"30px"},children:["Final Score: ",ge," points"]}),c.jsxs("div",{style:{background:"#e3f2fd",padding:"20px",borderRadius:"8px",marginBottom:"30px",border:"2px solid #2196F3"},children:[c.jsxs("h3",{style:{margin:"0 0 15px 0",color:"#1976d2"},children:["Student Learning Score: ",q]}),c.jsxs("div",{style:{fontSize:"16px",color:"#666"},children:["= ",Ie.materials||0," (Materials) "," ",(1+(Ie.research||0)*.15).toFixed(2)," ","(Research)",parseFloat(localStorage.getItem("engagementInterest")||"0")>0&&` + ${parseFloat(localStorage.getItem("engagementInterest")||"0").toFixed(2)} (Interest)`]}),se>0&&c.jsxs("div",{style:{marginTop:"10px",fontSize:"16px",color:"#1976d2"},children:["+ ",se," Checkpoint Bonus"]})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"30px"},children:[c.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Total Time"}),c.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:[Y,"m ",W,"s"]})]}),c.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Student Learning"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:q})]})]}),(ne===2||se>0)&&c.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Checkpoint Bonus"}),c.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:["+",se]})]}),c.jsxs("div",{style:{background:"#f8f9fa",padding:"20px",borderRadius:"8px",border:"2px solid #e0e0e0"},children:[c.jsx("div",{style:{fontSize:"14px",color:"#666",marginBottom:"5px"},children:"Tasks Completed"}),c.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",color:"#333"},children:y})]})]}),c.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:"Teaching Performance by Category"}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginBottom:"30px"},children:[c.jsxs("div",{style:{background:"#f0f8f0",padding:"15px",borderRadius:"6px",border:"2px solid #4CAF5020"},children:[c.jsx("div",{style:{color:"#4CAF50",fontWeight:"bold",marginBottom:"5px"},children:" Materials"}),c.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ie.materials||0}),c.jsx("div",{style:{fontSize:"12px",color:"#666"},children:"Base points"})]}),c.jsxs("div",{style:{background:"#f8f0ff",padding:"15px",borderRadius:"6px",border:"2px solid #9C27B020"},children:[c.jsx("div",{style:{color:"#9C27B0",fontWeight:"bold",marginBottom:"5px"},children:" Research"}),c.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ie.research||0}),c.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",(Ie.research||0)*15,"% to future materials"]})]}),c.jsxs("div",{style:{background:"#fff0f0",padding:"15px",borderRadius:"6px",border:"2px solid #f4433620"},children:[c.jsx("div",{style:{color:"#f44336",fontWeight:"bold",marginBottom:"5px"},children:" Engagement"}),c.jsx("div",{style:{fontSize:"20px",fontWeight:"bold"},children:Ie.engagement||0}),c.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["+",((Ie.engagement||0)*.15).toFixed(1),"% interest/task"]})]})]})]}),ne===2&&Ie.bonus>0&&c.jsxs("div",{style:{marginBottom:"20px",padding:"15px",background:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[c.jsxs("strong",{style:{color:"#856404"},children:[" Exam Season Bonus:"," "]}),c.jsxs("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#856404"},children:["+",Ie.bonus," points"]})]}),De.length>0&&c.jsxs("div",{style:{marginTop:"30px",padding:"20px",background:"#f8f9fa",borderRadius:"8px"},children:[c.jsx("h4",{style:{color:"#666",marginBottom:"15px"},children:"Progress Over Semesters"}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"10px"},children:[...De,ke].map((wt,bt)=>c.jsxs("div",{style:{padding:"10px",background:bt===De.length?"#e3f2fd":"white",borderRadius:"6px",border:"1px solid #e0e0e0",textAlign:"center"},children:[c.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["Semester ",bt+1]}),c.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:wt.finalScore})]},bt))})]}),c.jsx("div",{style:{marginTop:"30px",textAlign:"center"},children:st?c.jsxs("div",{style:{padding:"20px",background:"#fff3cd",border:"2px solid #ffc107",borderRadius:"8px",textAlign:"center"},children:[c.jsx("h3",{style:{color:"#856404",marginBottom:"10px"},children:" All semesters complete!"}),c.jsx("p",{style:{color:"#856404",marginBottom:"0"},children:"Return to the Qualtrics survey and enter your completion code to finish the study."})]}):c.jsxs("button",{onClick:Re,style:{padding:"15px 40px",background:"#4CAF50",color:"white",border:"none",borderRadius:"8px",fontSize:"18px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:["Start Semester ",ne+1," "]})})]})}return n==="allocation"?c.jsx(AI,{onStart:bi,totalTasks:_t.totalTasks,orderStrategy:_t.taskOrderStrategy,durationMinutes:_t.semesterDuration,difficultyMode:_t.difficultyMode}):n==="bonus_round"?c.jsx(kI,{timeRemaining:Ke,onSelectTask:Y=>{const W=[...Xt,Y];Gr(W);const q=Object.keys(p).filter(ge=>ge.startsWith(Y)).length,se=`${Y}t${q+1}`;r("challenge"),bs(se,!0)},onFinishEarly:()=>pr("finished_early")}):c.jsx("div",{className:"app",children:c.jsx(CI,{currentTaskIndex:bn,totalTasks:Xt.length,taskQueue:Xt,onSwitchTask:Ps,points:Math.round(Es),timeRemaining:Ke,onTimeUp:()=>pr("time_up"),chatInterface:c.jsx(_I,{bonusPrompts:P,currentTask:u,categoryPoints:Ie,timeRemaining:Ke,calculateStudentLearning:Jt,aiCost:_t.aiCost,onAiCost:Y=>{vn(W=>({...W,bonus:(W.bonus||0)-Y})),Nn(`AI Usage Penalty: -${Y} pts`)}}),children:ua()})})}a0(document.getElementById("root")).render(c.jsx(j.StrictMode,{children:c.jsx(PI,{})}));
//# sourceMappingURL=index-caoYmJHE.js.map
